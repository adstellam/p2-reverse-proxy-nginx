var Cce=Object.defineProperty,Sce=Object.defineProperties,Mce=Object.getOwnPropertyDescriptors,yU=Object.getOwnPropertySymbols,Tce=Object.prototype.hasOwnProperty,Dce=Object.prototype.propertyIsEnumerable,vU=(Zt,gt,Ue)=>gt in Zt?Cce(Zt,gt,{enumerable:!0,configurable:!0,writable:!0,value:Ue}):Zt[gt]=Ue,GA=(Zt,gt)=>{for(var Ue in gt||(gt={}))Tce.call(gt,Ue)&&vU(Zt,Ue,gt[Ue]);if(yU)for(var Ue of yU(gt))Dce.call(gt,Ue)&&vU(Zt,Ue,gt[Ue]);return Zt},$A=(Zt,gt)=>Sce(Zt,Mce(gt));(self.webpackChunkangular=self.webpackChunkangular||[]).push([[179],{8255:Zt=>{function gt(Ue){return Promise.resolve().then(()=>{var De=new Error("Cannot find module '"+Ue+"'");throw De.code="MODULE_NOT_FOUND",De})}gt.keys=()=>[],gt.resolve=gt,gt.id=8255,Zt.exports=gt},185:(Zt,gt,Ue)=>{"use strict";var Be=Ue(3033);function pt(x){var ut=[1/0,1/0,-1/0,-1/0];return Be.coordEach(x,function(qe){ut[0]>qe[0]&&(ut[0]=qe[0]),ut[1]>qe[1]&&(ut[1]=qe[1]),ut[2]<qe[0]&&(ut[2]=qe[0]),ut[3]<qe[1]&&(ut[3]=qe[1])}),ut}pt.default=pt,gt.Z=pt},8410:(Zt,gt)=>{"use strict";function Ue(ze,Oe,xe){void 0===xe&&(xe={});var jt={type:"Feature"};return(0===xe.id||xe.id)&&(jt.id=xe.id),xe.bbox&&(jt.bbox=xe.bbox),jt.properties=Oe||{},jt.geometry=ze,jt}function Be(ze,Oe,xe){if(void 0===xe&&(xe={}),!ze)throw new Error("coordinates is required");if(!Array.isArray(ze))throw new Error("coordinates must be an Array");if(ze.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!me(ze[0])||!me(ze[1]))throw new Error("coordinates must contain numbers");return Ue({type:"Point",coordinates:ze},Oe,xe)}function x(ze,Oe,xe){void 0===xe&&(xe={});for(var jt=0,Lt=ze;jt<Lt.length;jt++){var Ce=Lt[jt];if(Ce.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var ht=0;ht<Ce[Ce.length-1].length;ht++)if(Ce[Ce.length-1][ht]!==Ce[0][ht])throw new Error("First and last Position are not equivalent.")}return Ue({type:"Polygon",coordinates:ze},Oe,xe)}function qe(ze,Oe,xe){if(void 0===xe&&(xe={}),ze.length<2)throw new Error("coordinates must be an array of two or more positions");return Ue({type:"LineString",coordinates:ze},Oe,xe)}function Ge(ze,Oe){void 0===Oe&&(Oe={});var xe={type:"FeatureCollection"};return Oe.id&&(xe.id=Oe.id),Oe.bbox&&(xe.bbox=Oe.bbox),xe.features=ze,xe}function Qe(ze,Oe,xe){return void 0===xe&&(xe={}),Ue({type:"MultiLineString",coordinates:ze},Oe,xe)}function It(ze,Oe,xe){return void 0===xe&&(xe={}),Ue({type:"MultiPoint",coordinates:ze},Oe,xe)}function kt(ze,Oe,xe){return void 0===xe&&(xe={}),Ue({type:"MultiPolygon",coordinates:ze},Oe,xe)}function an(ze,Oe){void 0===Oe&&(Oe="kilometers");var xe=gt.factors[Oe];if(!xe)throw new Error(Oe+" units is invalid");return ze*xe}function fe(ze,Oe){void 0===Oe&&(Oe="kilometers");var xe=gt.factors[Oe];if(!xe)throw new Error(Oe+" units is invalid");return ze/xe}function pe(ze){return ze%(2*Math.PI)*180/Math.PI}function me(ze){return!isNaN(ze)&&null!==ze&&!Array.isArray(ze)}Object.defineProperty(gt,"__esModule",{value:!0}),gt.earthRadius=6371008.8,gt.factors={centimeters:100*gt.earthRadius,centimetres:100*gt.earthRadius,degrees:gt.earthRadius/111325,feet:3.28084*gt.earthRadius,inches:39.37*gt.earthRadius,kilometers:gt.earthRadius/1e3,kilometres:gt.earthRadius/1e3,meters:gt.earthRadius,metres:gt.earthRadius,miles:gt.earthRadius/1609.344,millimeters:1e3*gt.earthRadius,millimetres:1e3*gt.earthRadius,nauticalmiles:gt.earthRadius/1852,radians:1,yards:1.0936*gt.earthRadius},gt.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/gt.earthRadius,yards:1.0936133},gt.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046},gt.feature=Ue,gt.geometry=function(ze,Oe,xe){switch(void 0===xe&&(xe={}),ze){case"Point":return Be(Oe).geometry;case"LineString":return qe(Oe).geometry;case"Polygon":return x(Oe).geometry;case"MultiPoint":return It(Oe).geometry;case"MultiLineString":return Qe(Oe).geometry;case"MultiPolygon":return kt(Oe).geometry;default:throw new Error(ze+" is invalid")}},gt.point=Be,gt.points=function(ze,Oe,xe){return void 0===xe&&(xe={}),Ge(ze.map(function(jt){return Be(jt,Oe)}),xe)},gt.polygon=x,gt.polygons=function(ze,Oe,xe){return void 0===xe&&(xe={}),Ge(ze.map(function(jt){return x(jt,Oe)}),xe)},gt.lineString=qe,gt.lineStrings=function(ze,Oe,xe){return void 0===xe&&(xe={}),Ge(ze.map(function(jt){return qe(jt,Oe)}),xe)},gt.featureCollection=Ge,gt.multiLineString=Qe,gt.multiPoint=It,gt.multiPolygon=kt,gt.geometryCollection=function(ze,Oe,xe){return void 0===xe&&(xe={}),Ue({type:"GeometryCollection",geometries:ze},Oe,xe)},gt.round=function(ze,Oe){if(void 0===Oe&&(Oe=0),Oe&&!(Oe>=0))throw new Error("precision must be a positive number");var xe=Math.pow(10,Oe||0);return Math.round(ze*xe)/xe},gt.radiansToLength=an,gt.lengthToRadians=fe,gt.lengthToDegrees=function(ze,Oe){return pe(fe(ze,Oe))},gt.bearingToAzimuth=function(ze){var Oe=ze%360;return Oe<0&&(Oe+=360),Oe},gt.radiansToDegrees=pe,gt.degreesToRadians=function(ze){return ze%360*Math.PI/180},gt.convertLength=function(ze,Oe,xe){if(void 0===Oe&&(Oe="kilometers"),void 0===xe&&(xe="kilometers"),!(ze>=0))throw new Error("length must be a positive number");return an(fe(ze,Oe),xe)},gt.convertArea=function(ze,Oe,xe){if(void 0===Oe&&(Oe="meters"),void 0===xe&&(xe="kilometers"),!(ze>=0))throw new Error("area must be a positive number");var jt=gt.areaFactors[Oe];if(!jt)throw new Error("invalid original units");var Lt=gt.areaFactors[xe];if(!Lt)throw new Error("invalid final units");return ze/jt*Lt},gt.isNumber=me,gt.isObject=function(ze){return!!ze&&ze.constructor===Object},gt.validateBBox=function(ze){if(!ze)throw new Error("bbox is required");if(!Array.isArray(ze))throw new Error("bbox must be an Array");if(4!==ze.length&&6!==ze.length)throw new Error("bbox must be an Array of 4 or 6 numbers");ze.forEach(function(Oe){if(!me(Oe))throw new Error("bbox must only contain numbers")})},gt.validateId=function(ze){if(!ze)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof ze))throw new Error("id must be a number or a string")}},3033:(Zt,gt,Ue)=>{"use strict";Object.defineProperty(gt,"__esModule",{value:!0});var De=Ue(8410);function Be(le,Ne,he){if(null!==le)for(var me,be,re,mt,ze,Oe,xe,Ce,jt=0,Lt=0,ht=le.type,Pe="FeatureCollection"===ht,lt="Feature"===ht,Ke=Pe?le.features.length:1,Me=0;Me<Ke;Me++){ze=(Ce=!!(xe=Pe?le.features[Me].geometry:lt?le.geometry:le)&&"GeometryCollection"===xe.type)?xe.geometries.length:1;for(var Ft=0;Ft<ze;Ft++){var Ut=0,Sn=0;if(null!==(mt=Ce?xe.geometries[Ft]:xe)){Oe=mt.coordinates;var Gt=mt.type;switch(jt=!he||"Polygon"!==Gt&&"MultiPolygon"!==Gt?0:1,Gt){case null:break;case"Point":if(!1===Ne(Oe,Lt,Me,Ut,Sn))return!1;Lt++,Ut++;break;case"LineString":case"MultiPoint":for(me=0;me<Oe.length;me++){if(!1===Ne(Oe[me],Lt,Me,Ut,Sn))return!1;Lt++,"MultiPoint"===Gt&&Ut++}"LineString"===Gt&&Ut++;break;case"Polygon":case"MultiLineString":for(me=0;me<Oe.length;me++){for(be=0;be<Oe[me].length-jt;be++){if(!1===Ne(Oe[me][be],Lt,Me,Ut,Sn))return!1;Lt++}"MultiLineString"===Gt&&Ut++,"Polygon"===Gt&&Sn++}"Polygon"===Gt&&Ut++;break;case"MultiPolygon":for(me=0;me<Oe.length;me++){for(Sn=0,be=0;be<Oe[me].length;be++){for(re=0;re<Oe[me][be].length-jt;re++){if(!1===Ne(Oe[me][be][re],Lt,Me,Ut,Sn))return!1;Lt++}Sn++}Ut++}break;case"GeometryCollection":for(me=0;me<mt.geometries.length;me++)if(!1===Be(mt.geometries[me],Ne,he))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function x(le,Ne){var he;switch(le.type){case"FeatureCollection":for(he=0;he<le.features.length&&!1!==Ne(le.features[he].properties,he);he++);break;case"Feature":Ne(le.properties,0)}}function qe(le,Ne){if("Feature"===le.type)Ne(le,0);else if("FeatureCollection"===le.type)for(var he=0;he<le.features.length&&!1!==Ne(le.features[he],he);he++);}function Qe(le,Ne){var he,me,be,re,mt,ze,Oe,xe,jt,Lt,Ce=0,ht="FeatureCollection"===le.type,Pe="Feature"===le.type,lt=ht?le.features.length:1;for(he=0;he<lt;he++){for(xe=ht?le.features[he].properties:Pe?le.properties:{},jt=ht?le.features[he].bbox:Pe?le.bbox:void 0,Lt=ht?le.features[he].id:Pe?le.id:void 0,mt=(Oe=!!(ze=ht?le.features[he].geometry:Pe?le.geometry:le)&&"GeometryCollection"===ze.type)?ze.geometries.length:1,be=0;be<mt;be++)if(null!==(re=Oe?ze.geometries[be]:ze))switch(re.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===Ne(re,Ce,xe,jt,Lt))return!1;break;case"GeometryCollection":for(me=0;me<re.geometries.length;me++)if(!1===Ne(re.geometries[me],Ce,xe,jt,Lt))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===Ne(null,Ce,xe,jt,Lt))return!1;Ce++}}function kt(le,Ne){Qe(le,function(he,me,be,re,mt){var Oe,ze=null===he?null:he.type;switch(ze){case null:case"Point":case"LineString":case"Polygon":return!1!==Ne(De.feature(he,be,{bbox:re,id:mt}),me,0)&&void 0}switch(ze){case"MultiPoint":Oe="Point";break;case"MultiLineString":Oe="LineString";break;case"MultiPolygon":Oe="Polygon"}for(var xe=0;xe<he.coordinates.length;xe++)if(!1===Ne(De.feature({type:Oe,coordinates:he.coordinates[xe]},be),me,xe))return!1})}function At(le,Ne){kt(le,function(he,me,be){var re=0;if(he.geometry){var mt=he.geometry.type;if("Point"!==mt&&"MultiPoint"!==mt){var ze,Oe=0,xe=0,jt=0;if(!1===Be(he,function(Lt,Ce,ht,Pe,lt){if(void 0===ze||me>Oe||Pe>xe||lt>jt)return ze=Lt,Oe=me,xe=Pe,jt=lt,void(re=0);var Ke=De.lineString([ze,Lt],he.properties);if(!1===Ne(Ke,me,be,lt,re))return!1;re++,ze=Lt}))return!1}}})}function fe(le,Ne){if(!le)throw new Error("geojson is required");kt(le,function(he,me,be){if(null!==he.geometry){var mt=he.geometry.coordinates;switch(he.geometry.type){case"LineString":if(!1===Ne(he,me,be,0,0))return!1;break;case"Polygon":for(var ze=0;ze<mt.length;ze++)if(!1===Ne(De.lineString(mt[ze],he.properties),me,be,ze))return!1}}})}gt.coordAll=function(le){var Ne=[];return Be(le,function(he){Ne.push(he)}),Ne},gt.coordEach=Be,gt.coordReduce=function(le,Ne,he,me){var be=he;return Be(le,function(re,mt,ze,Oe,xe){be=0===mt&&void 0===he?re:Ne(be,re,mt,ze,Oe,xe)},me),be},gt.featureEach=qe,gt.featureReduce=function(le,Ne,he){var me=he;return qe(le,function(be,re){me=0===re&&void 0===he?be:Ne(me,be,re)}),me},gt.findPoint=function(le,Ne){if(!De.isObject(Ne=Ne||{}))throw new Error("options is invalid");var ze,he=Ne.featureIndex||0,me=Ne.multiFeatureIndex||0,be=Ne.geometryIndex||0,re=Ne.coordIndex||0,mt=Ne.properties;switch(le.type){case"FeatureCollection":he<0&&(he=le.features.length+he),mt=mt||le.features[he].properties,ze=le.features[he].geometry;break;case"Feature":mt=mt||le.properties,ze=le.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":ze=le;break;default:throw new Error("geojson is invalid")}if(null===ze)return null;var Oe=ze.coordinates;switch(ze.type){case"Point":return De.point(Oe,mt,Ne);case"MultiPoint":return me<0&&(me=Oe.length+me),De.point(Oe[me],mt,Ne);case"LineString":return re<0&&(re=Oe.length+re),De.point(Oe[re],mt,Ne);case"Polygon":return be<0&&(be=Oe.length+be),re<0&&(re=Oe[be].length+re),De.point(Oe[be][re],mt,Ne);case"MultiLineString":return me<0&&(me=Oe.length+me),re<0&&(re=Oe[me].length+re),De.point(Oe[me][re],mt,Ne);case"MultiPolygon":return me<0&&(me=Oe.length+me),be<0&&(be=Oe[me].length+be),re<0&&(re=Oe[me][be].length-re),De.point(Oe[me][be][re],mt,Ne)}throw new Error("geojson is invalid")},gt.findSegment=function(le,Ne){if(!De.isObject(Ne=Ne||{}))throw new Error("options is invalid");var ze,he=Ne.featureIndex||0,me=Ne.multiFeatureIndex||0,be=Ne.geometryIndex||0,re=Ne.segmentIndex||0,mt=Ne.properties;switch(le.type){case"FeatureCollection":he<0&&(he=le.features.length+he),mt=mt||le.features[he].properties,ze=le.features[he].geometry;break;case"Feature":mt=mt||le.properties,ze=le.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":ze=le;break;default:throw new Error("geojson is invalid")}if(null===ze)return null;var Oe=ze.coordinates;switch(ze.type){case"Point":case"MultiPoint":return null;case"LineString":return re<0&&(re=Oe.length+re-1),De.lineString([Oe[re],Oe[re+1]],mt,Ne);case"Polygon":return be<0&&(be=Oe.length+be),re<0&&(re=Oe[be].length+re-1),De.lineString([Oe[be][re],Oe[be][re+1]],mt,Ne);case"MultiLineString":return me<0&&(me=Oe.length+me),re<0&&(re=Oe[me].length+re-1),De.lineString([Oe[me][re],Oe[me][re+1]],mt,Ne);case"MultiPolygon":return me<0&&(me=Oe.length+me),be<0&&(be=Oe[me].length+be),re<0&&(re=Oe[me][be].length-re-1),De.lineString([Oe[me][be][re],Oe[me][be][re+1]],mt,Ne)}throw new Error("geojson is invalid")},gt.flattenEach=kt,gt.flattenReduce=function(le,Ne,he){var me=he;return kt(le,function(be,re,mt){me=0===re&&0===mt&&void 0===he?be:Ne(me,be,re,mt)}),me},gt.geomEach=Qe,gt.geomReduce=function(le,Ne,he){var me=he;return Qe(le,function(be,re,mt,ze,Oe){me=0===re&&void 0===he?be:Ne(me,be,re,mt,ze,Oe)}),me},gt.lineEach=fe,gt.lineReduce=function(le,Ne,he){var me=he;return fe(le,function(be,re,mt,ze){me=0===re&&void 0===he?be:Ne(me,be,re,mt,ze)}),me},gt.propEach=x,gt.propReduce=function(le,Ne,he){var me=he;return x(le,function(be,re){me=0===re&&void 0===he?be:Ne(me,be,re)}),me},gt.segmentEach=At,gt.segmentReduce=function(le,Ne,he){var me=he,be=!1;return At(le,function(re,mt,ze,Oe,xe){me=!1===be&&void 0===he?re:Ne(me,re,mt,ze,Oe,xe),be=!0}),me}},9568:(Zt,gt,Ue)=>{"use strict";var De=Ue(8540),Be=Ue(44),pt=Be(De("String.prototype.indexOf"));Zt.exports=function(ut,qe){var dt=De(ut,!!qe);return"function"==typeof dt&&pt(ut,".prototype.")>-1?Be(dt):dt}},44:(Zt,gt,Ue)=>{"use strict";var De=Ue(5396),Be=Ue(8540),pt=Be("%Function.prototype.apply%"),x=Be("%Function.prototype.call%"),ut=Be("%Reflect.apply%",!0)||De.call(x,pt),qe=Be("%Object.getOwnPropertyDescriptor%",!0),dt=Be("%Object.defineProperty%",!0),Ge=Be("%Math.max%");if(dt)try{dt({},"a",{value:1})}catch(It){dt=null}Zt.exports=function(kt){var vt=ut(De,x,arguments);if(qe&&dt){var At=qe(vt,"length");At.configurable&&dt(vt,"length",{value:1+Ge(0,kt.length-(arguments.length-1))})}return vt};var Qe=function(){return ut(De,pt,arguments)};dt?dt(Zt.exports,"apply",{value:Qe}):Zt.exports.apply=Qe},6896:(Zt,gt,Ue)=>{"use strict";var De=Ue(6369),Be=Ue(54),pt=Ue(5503),x=Ue(5322).orient2d;function ut(he,me,be){me=Math.max(0,void 0===me?2:me),be=be||0;var re=function(he){for(var me=he[0],be=he[0],re=he[0],mt=he[0],ze=0;ze<he.length;ze++){var Oe=he[ze];Oe[0]<me[0]&&(me=Oe),Oe[0]>re[0]&&(re=Oe),Oe[1]<be[1]&&(be=Oe),Oe[1]>mt[1]&&(mt=Oe)}var xe=[me,be,re,mt],jt=xe.slice();for(ze=0;ze<he.length;ze++)pt(he[ze],xe)||jt.push(he[ze]);return function(he){he.sort(le);for(var me=[],be=0;be<he.length;be++){for(;me.length>=2&&kt(me[me.length-2],me[me.length-1],he[be])<=0;)me.pop();me.push(he[be])}for(var re=[],mt=he.length-1;mt>=0;mt--){for(;re.length>=2&&kt(re[re.length-2],re[re.length-1],he[mt])<=0;)re.pop();re.push(he[mt])}return re.pop(),me.pop(),me.concat(re)}(jt)}(he),mt=new De(16);mt.toBBox=function(Sn){return{minX:Sn[0],minY:Sn[1],maxX:Sn[0],maxY:Sn[1]}},mt.compareMinX=function(Sn,Gt){return Sn[0]-Gt[0]},mt.compareMinY=function(Sn,Gt){return Sn[1]-Gt[1]},mt.load(he);for(var xe,ze=[],Oe=0;Oe<re.length;Oe++){var jt=re[Oe];mt.remove(jt),xe=fe(jt,xe),ze.push(xe)}var Lt=new De(16);for(Oe=0;Oe<ze.length;Oe++)Lt.insert(At(ze[Oe]));for(var Ce=me*me,ht=be*be;ze.length;){var Pe=ze.shift(),lt=Pe.p,Ke=Pe.next.p,Me=Se(lt,Ke);if(!(Me<ht)){var Ft=Me/Ce;(jt=qe(mt,Pe.prev.p,lt,Ke,Pe.next.next.p,Ft,Lt))&&Math.min(Se(jt,lt),Se(jt,Ke))<=Ft&&(ze.push(Pe),ze.push(fe(jt,Pe)),mt.remove(jt),Lt.remove(Pe),Lt.insert(At(Pe)),Lt.insert(At(Pe.next)))}}Pe=xe;var Ut=[];do{Ut.push(Pe.p),Pe=Pe.next}while(Pe!==xe);return Ut.push(Pe.p),Ut}function qe(he,me,be,re,mt,ze,Oe){for(var xe=new Be([],dt),jt=he.data;jt;){for(var Lt=0;Lt<jt.children.length;Lt++){var Ce=jt.children[Lt],ht=jt.leaf?ue(Ce,be,re):Ge(be,re,Ce);ht>ze||xe.push({node:Ce,dist:ht})}for(;xe.length&&!xe.peek().node.children;){var Pe=xe.pop(),lt=Pe.node,Ke=ue(lt,me,be),Me=ue(lt,re,mt);if(Pe.dist<Ke&&Pe.dist<Me&&It(be,lt,Oe)&&It(re,lt,Oe))return lt}(jt=xe.pop())&&(jt=jt.node)}return null}function dt(he,me){return he.dist-me.dist}function Ge(he,me,be){if(Qe(he,be)||Qe(me,be))return 0;var re=pe(he[0],he[1],me[0],me[1],be.minX,be.minY,be.maxX,be.minY);if(0===re)return 0;var mt=pe(he[0],he[1],me[0],me[1],be.minX,be.minY,be.minX,be.maxY);if(0===mt)return 0;var ze=pe(he[0],he[1],me[0],me[1],be.maxX,be.minY,be.maxX,be.maxY);if(0===ze)return 0;var Oe=pe(he[0],he[1],me[0],me[1],be.minX,be.maxY,be.maxX,be.maxY);return 0===Oe?0:Math.min(re,mt,ze,Oe)}function Qe(he,me){return he[0]>=me.minX&&he[0]<=me.maxX&&he[1]>=me.minY&&he[1]<=me.maxY}function It(he,me,be){for(var re=Math.min(he[0],me[0]),mt=Math.min(he[1],me[1]),ze=Math.max(he[0],me[0]),Oe=Math.max(he[1],me[1]),xe=be.search({minX:re,minY:mt,maxX:ze,maxY:Oe}),jt=0;jt<xe.length;jt++)if(vt(xe[jt].p,xe[jt].next.p,he,me))return!1;return!0}function kt(he,me,be){return x(he[0],he[1],me[0],me[1],be[0],be[1])}function vt(he,me,be,re){return he!==re&&me!==be&&kt(he,me,be)>0!=kt(he,me,re)>0&&kt(be,re,he)>0!=kt(be,re,me)>0}function At(he){var me=he.p,be=he.next.p;return he.minX=Math.min(me[0],be[0]),he.minY=Math.min(me[1],be[1]),he.maxX=Math.max(me[0],be[0]),he.maxY=Math.max(me[1],be[1]),he}function fe(he,me){var be={p:he,prev:null,next:null,minX:0,minY:0,maxX:0,maxY:0};return me?(be.next=me.next,be.prev=me,me.next.prev=be,me.next=be):(be.prev=be,be.next=be),be}function Se(he,me){var be=he[0]-me[0],re=he[1]-me[1];return be*be+re*re}function ue(he,me,be){var re=me[0],mt=me[1],ze=be[0]-re,Oe=be[1]-mt;if(0!==ze||0!==Oe){var xe=((he[0]-re)*ze+(he[1]-mt)*Oe)/(ze*ze+Oe*Oe);xe>1?(re=be[0],mt=be[1]):xe>0&&(re+=ze*xe,mt+=Oe*xe)}return(ze=he[0]-re)*ze+(Oe=he[1]-mt)*Oe}function pe(he,me,be,re,mt,ze,Oe,xe){var Mn,hr,sr,In,jt=be-he,Lt=re-me,Ce=Oe-mt,ht=xe-ze,Pe=he-mt,lt=me-ze,Ke=jt*jt+Lt*Lt,Me=jt*Ce+Lt*ht,Ft=Ce*Ce+ht*ht,Ut=jt*Pe+Lt*lt,Sn=Ce*Pe+ht*lt,Gt=Ke*Ft-Me*Me,Vn=Gt,rn=Gt;0===Gt?(hr=0,Vn=1,In=Sn,rn=Ft):(In=Ke*Sn-Me*Ut,(hr=Me*Sn-Ft*Ut)<0?(hr=0,In=Sn,rn=Ft):hr>Vn&&(hr=Vn,In=Sn+Me,rn=Ft)),In<0?(In=0,-Ut<0?hr=0:-Ut>Ke?hr=Vn:(hr=-Ut,Vn=Ke)):In>rn&&(In=rn,-Ut+Me<0?hr=0:-Ut+Me>Ke?hr=Vn:(hr=-Ut+Me,Vn=Ke));var eo=(1-(sr=0===In?0:In/rn))*mt+sr*Oe-((1-(Mn=0===hr?0:hr/Vn))*he+Mn*be),_t=(1-sr)*ze+sr*xe-((1-Mn)*me+Mn*re);return eo*eo+_t*_t}function le(he,me){return he[0]===me[0]?he[1]-me[1]:he[0]-me[0]}Be.default&&(Be=Be.default),Zt.exports=ut,Zt.exports.default=ut},6369:function(Zt){Zt.exports=function(){"use strict";function gt(fe,Se,ue,pe,le){!function Ne(he,me,be,re,mt){for(;re>be;){if(re-be>600){var ze=re-be+1,Oe=me-be+1,xe=Math.log(ze),jt=.5*Math.exp(2*xe/3),Lt=.5*Math.sqrt(xe*jt*(ze-jt)/ze)*(Oe-ze/2<0?-1:1);Ne(he,me,Math.max(be,Math.floor(me-Oe*jt/ze+Lt)),Math.min(re,Math.floor(me+(ze-Oe)*jt/ze+Lt)),mt)}var Pe=he[me],lt=be,Ke=re;for(Ue(he,be,me),mt(he[re],Pe)>0&&Ue(he,be,re);lt<Ke;){for(Ue(he,lt,Ke),lt++,Ke--;mt(he[lt],Pe)<0;)lt++;for(;mt(he[Ke],Pe)>0;)Ke--}0===mt(he[be],Pe)?Ue(he,be,Ke):Ue(he,++Ke,re),Ke<=me&&(be=Ke+1),me<=Ke&&(re=Ke-1)}}(fe,Se,ue||0,pe||fe.length-1,le||De)}function Ue(fe,Se,ue){var pe=fe[Se];fe[Se]=fe[ue],fe[ue]=pe}function De(fe,Se){return fe<Se?-1:fe>Se?1:0}var Be=function(fe){void 0===fe&&(fe=9),this._maxEntries=Math.max(4,fe),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function pt(fe,Se,ue){if(!ue)return Se.indexOf(fe);for(var pe=0;pe<Se.length;pe++)if(ue(fe,Se[pe]))return pe;return-1}function x(fe,Se){ut(fe,0,fe.children.length,Se,fe)}function ut(fe,Se,ue,pe,le){le||(le=At(null)),le.minX=1/0,le.minY=1/0,le.maxX=-1/0,le.maxY=-1/0;for(var Ne=Se;Ne<ue;Ne++){var he=fe.children[Ne];qe(le,fe.leaf?pe(he):he)}return le}function qe(fe,Se){return fe.minX=Math.min(fe.minX,Se.minX),fe.minY=Math.min(fe.minY,Se.minY),fe.maxX=Math.max(fe.maxX,Se.maxX),fe.maxY=Math.max(fe.maxY,Se.maxY),fe}function dt(fe,Se){return fe.minX-Se.minX}function Ge(fe,Se){return fe.minY-Se.minY}function Qe(fe){return(fe.maxX-fe.minX)*(fe.maxY-fe.minY)}function It(fe){return fe.maxX-fe.minX+(fe.maxY-fe.minY)}function kt(fe,Se){return fe.minX<=Se.minX&&fe.minY<=Se.minY&&Se.maxX<=fe.maxX&&Se.maxY<=fe.maxY}function vt(fe,Se){return Se.minX<=fe.maxX&&Se.minY<=fe.maxY&&Se.maxX>=fe.minX&&Se.maxY>=fe.minY}function At(fe){return{children:fe,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function an(fe,Se,ue,pe,le){for(var Ne=[Se,ue];Ne.length;)if(!((ue=Ne.pop())-(Se=Ne.pop())<=pe)){var he=Se+Math.ceil((ue-Se)/pe/2)*pe;gt(fe,he,Se,ue,le),Ne.push(Se,he,he,ue)}}return Be.prototype.all=function(){return this._all(this.data,[])},Be.prototype.search=function(fe){var Se=this.data,ue=[];if(!vt(fe,Se))return ue;for(var pe=this.toBBox,le=[];Se;){for(var Ne=0;Ne<Se.children.length;Ne++){var he=Se.children[Ne],me=Se.leaf?pe(he):he;vt(fe,me)&&(Se.leaf?ue.push(he):kt(fe,me)?this._all(he,ue):le.push(he))}Se=le.pop()}return ue},Be.prototype.collides=function(fe){var Se=this.data;if(!vt(fe,Se))return!1;for(var ue=[];Se;){for(var pe=0;pe<Se.children.length;pe++){var le=Se.children[pe],Ne=Se.leaf?this.toBBox(le):le;if(vt(fe,Ne)){if(Se.leaf||kt(fe,Ne))return!0;ue.push(le)}}Se=ue.pop()}return!1},Be.prototype.load=function(fe){if(!fe||!fe.length)return this;if(fe.length<this._minEntries){for(var Se=0;Se<fe.length;Se++)this.insert(fe[Se]);return this}var ue=this._build(fe.slice(),0,fe.length-1,0);if(this.data.children.length)if(this.data.height===ue.height)this._splitRoot(this.data,ue);else{if(this.data.height<ue.height){var pe=this.data;this.data=ue,ue=pe}this._insert(ue,this.data.height-ue.height-1,!0)}else this.data=ue;return this},Be.prototype.insert=function(fe){return fe&&this._insert(fe,this.data.height-1),this},Be.prototype.clear=function(){return this.data=At([]),this},Be.prototype.remove=function(fe,Se){if(!fe)return this;for(var ue,pe,le,Ne=this.data,he=this.toBBox(fe),me=[],be=[];Ne||me.length;){if(Ne||(Ne=me.pop(),pe=me[me.length-1],ue=be.pop(),le=!0),Ne.leaf){var re=pt(fe,Ne.children,Se);if(-1!==re)return Ne.children.splice(re,1),me.push(Ne),this._condense(me),this}le||Ne.leaf||!kt(Ne,he)?pe?(ue++,Ne=pe.children[ue],le=!1):Ne=null:(me.push(Ne),be.push(ue),ue=0,pe=Ne,Ne=Ne.children[0])}return this},Be.prototype.toBBox=function(fe){return fe},Be.prototype.compareMinX=function(fe,Se){return fe.minX-Se.minX},Be.prototype.compareMinY=function(fe,Se){return fe.minY-Se.minY},Be.prototype.toJSON=function(){return this.data},Be.prototype.fromJSON=function(fe){return this.data=fe,this},Be.prototype._all=function(fe,Se){for(var ue=[];fe;)fe.leaf?Se.push.apply(Se,fe.children):ue.push.apply(ue,fe.children),fe=ue.pop();return Se},Be.prototype._build=function(fe,Se,ue,pe){var le,Ne=ue-Se+1,he=this._maxEntries;if(Ne<=he)return x(le=At(fe.slice(Se,ue+1)),this.toBBox),le;pe||(pe=Math.ceil(Math.log(Ne)/Math.log(he)),he=Math.ceil(Ne/Math.pow(he,pe-1))),(le=At([])).leaf=!1,le.height=pe;var me=Math.ceil(Ne/he),be=me*Math.ceil(Math.sqrt(he));an(fe,Se,ue,be,this.compareMinX);for(var re=Se;re<=ue;re+=be){var mt=Math.min(re+be-1,ue);an(fe,re,mt,me,this.compareMinY);for(var ze=re;ze<=mt;ze+=me){var Oe=Math.min(ze+me-1,mt);le.children.push(this._build(fe,ze,Oe,pe-1))}}return x(le,this.toBBox),le},Be.prototype._chooseSubtree=function(fe,Se,ue,pe){for(;pe.push(Se),!Se.leaf&&pe.length-1!==ue;){for(var le=1/0,Ne=1/0,he=void 0,me=0;me<Se.children.length;me++){var be=Se.children[me],re=Qe(be),mt=(ze=fe,Oe=be,(Math.max(Oe.maxX,ze.maxX)-Math.min(Oe.minX,ze.minX))*(Math.max(Oe.maxY,ze.maxY)-Math.min(Oe.minY,ze.minY))-re);mt<Ne?(Ne=mt,le=re<le?re:le,he=be):mt===Ne&&re<le&&(le=re,he=be)}Se=he||Se.children[0]}var ze,Oe;return Se},Be.prototype._insert=function(fe,Se,ue){var pe=ue?fe:this.toBBox(fe),le=[],Ne=this._chooseSubtree(pe,this.data,Se,le);for(Ne.children.push(fe),qe(Ne,pe);Se>=0&&le[Se].children.length>this._maxEntries;)this._split(le,Se),Se--;this._adjustParentBBoxes(pe,le,Se)},Be.prototype._split=function(fe,Se){var ue=fe[Se],pe=ue.children.length,le=this._minEntries;this._chooseSplitAxis(ue,le,pe);var Ne=this._chooseSplitIndex(ue,le,pe),he=At(ue.children.splice(Ne,ue.children.length-Ne));he.height=ue.height,he.leaf=ue.leaf,x(ue,this.toBBox),x(he,this.toBBox),Se?fe[Se-1].children.push(he):this._splitRoot(ue,he)},Be.prototype._splitRoot=function(fe,Se){this.data=At([fe,Se]),this.data.height=fe.height+1,this.data.leaf=!1,x(this.data,this.toBBox)},Be.prototype._chooseSplitIndex=function(fe,Se,ue){for(var pe,le,Ne,he,me,be,re,mt=1/0,ze=1/0,Oe=Se;Oe<=ue-Se;Oe++){var xe=ut(fe,0,Oe,this.toBBox),jt=ut(fe,Oe,ue,this.toBBox),Lt=(le=xe,Ne=jt,void 0,void 0,void 0,void 0,he=Math.max(le.minX,Ne.minX),me=Math.max(le.minY,Ne.minY),be=Math.min(le.maxX,Ne.maxX),re=Math.min(le.maxY,Ne.maxY),Math.max(0,be-he)*Math.max(0,re-me)),Ce=Qe(xe)+Qe(jt);Lt<mt?(mt=Lt,pe=Oe,ze=Ce<ze?Ce:ze):Lt===mt&&Ce<ze&&(ze=Ce,pe=Oe)}return pe||ue-Se},Be.prototype._chooseSplitAxis=function(fe,Se,ue){var pe=fe.leaf?this.compareMinX:dt,le=fe.leaf?this.compareMinY:Ge;this._allDistMargin(fe,Se,ue,pe)<this._allDistMargin(fe,Se,ue,le)&&fe.children.sort(pe)},Be.prototype._allDistMargin=function(fe,Se,ue,pe){fe.children.sort(pe);for(var le=this.toBBox,Ne=ut(fe,0,Se,le),he=ut(fe,ue-Se,ue,le),me=It(Ne)+It(he),be=Se;be<ue-Se;be++){var re=fe.children[be];qe(Ne,fe.leaf?le(re):re),me+=It(Ne)}for(var mt=ue-Se-1;mt>=Se;mt--){var ze=fe.children[mt];qe(he,fe.leaf?le(ze):ze),me+=It(he)}return me},Be.prototype._adjustParentBBoxes=function(fe,Se,ue){for(var pe=ue;pe>=0;pe--)qe(Se[pe],fe)},Be.prototype._condense=function(fe){for(var Se=fe.length-1,ue=void 0;Se>=0;Se--)0===fe[Se].children.length?Se>0?(ue=fe[Se-1].children).splice(ue.indexOf(fe[Se]),1):this.clear():x(fe[Se],this.toBBox)},Be}()},2978:(Zt,gt,Ue)=>{var De=Ue(8507),Be=Ue(7316),pt=Ue(4269),x=Ue(5544),ut=Ue(437),qe=Ue(3105),dt=Date.prototype.getTime;function Qe(vt){return null==vt}function It(vt){return!(!vt||"object"!=typeof vt||"number"!=typeof vt.length||"function"!=typeof vt.copy||"function"!=typeof vt.slice||vt.length>0&&"number"!=typeof vt[0])}Zt.exports=function Ge(vt,At,an){var fe=an||{};return!!(fe.strict?pt(vt,At):vt===At)||(!vt||!At||"object"!=typeof vt&&"object"!=typeof At?fe.strict?pt(vt,At):vt==At:function(vt,At,an){var fe,Se;if(typeof vt!=typeof At||Qe(vt)||Qe(At)||vt.prototype!==At.prototype||Be(vt)!==Be(At))return!1;var ue=x(vt),pe=x(At);if(ue!==pe)return!1;if(ue||pe)return vt.source===At.source&&ut(vt)===ut(At);if(qe(vt)&&qe(At))return dt.call(vt)===dt.call(At);var le=It(vt),Ne=It(At);if(le!==Ne)return!1;if(le||Ne){if(vt.length!==At.length)return!1;for(fe=0;fe<vt.length;fe++)if(vt[fe]!==At[fe])return!1;return!0}if(typeof vt!=typeof At)return!1;try{var he=De(vt),me=De(At)}catch(be){return!1}if(he.length!==me.length)return!1;for(he.sort(),me.sort(),fe=he.length-1;fe>=0;fe--)if(he[fe]!=me[fe])return!1;for(fe=he.length-1;fe>=0;fe--)if(!Ge(vt[Se=he[fe]],At[Se],an))return!1;return!0}(vt,At,fe))}},6886:(Zt,gt,Ue)=>{"use strict";var De=Ue(8507),Be="function"==typeof Symbol&&"symbol"==typeof Symbol("foo"),pt=Object.prototype.toString,x=Array.prototype.concat,ut=Object.defineProperty,Ge=ut&&function(){var kt={};try{for(var vt in ut(kt,"x",{enumerable:!1,value:kt}),kt)return!1;return kt.x===kt}catch(At){return!1}}(),Qe=function(kt,vt,At,an){vt in kt&&(!function(kt){return"function"==typeof kt&&"[object Function]"===pt.call(kt)}(an)||!an())||(Ge?ut(kt,vt,{configurable:!0,enumerable:!1,value:At,writable:!0}):kt[vt]=At)},It=function(kt,vt){var At=arguments.length>2?arguments[2]:{},an=De(vt);Be&&(an=x.call(an,Object.getOwnPropertySymbols(vt)));for(var fe=0;fe<an.length;fe+=1)Qe(kt,an[fe],vt[an[fe]],At[an[fe]])};It.supportsDescriptors=!!Ge,Zt.exports=It},5810:Zt=>{function gt(Ue,De,Be,pt){this.dataset=[],this.epsilon=1,this.minPts=2,this.distance=this._euclideanDistance,this.clusters=[],this.noise=[],this._visited=[],this._assigned=[],this._datasetLength=0,this._init(Ue,De,Be,pt)}gt.prototype.run=function(Ue,De,Be,pt){this._init(Ue,De,Be,pt);for(var x=0;x<this._datasetLength;x++)if(1!==this._visited[x]){this._visited[x]=1;var ut=this._regionQuery(x);if(ut.length<this.minPts)this.noise.push(x);else{var qe=this.clusters.length;this.clusters.push([]),this._addToCluster(x,qe),this._expandCluster(qe,ut)}}return this.clusters},gt.prototype._init=function(Ue,De,Be,pt){if(Ue){if(!(Ue instanceof Array))throw Error("Dataset must be of type array, "+typeof Ue+" given");this.dataset=Ue,this.clusters=[],this.noise=[],this._datasetLength=Ue.length,this._visited=new Array(this._datasetLength),this._assigned=new Array(this._datasetLength)}De&&(this.epsilon=De),Be&&(this.minPts=Be),pt&&(this.distance=pt)},gt.prototype._expandCluster=function(Ue,De){for(var Be=0;Be<De.length;Be++){var pt=De[Be];if(1!==this._visited[pt]){this._visited[pt]=1;var x=this._regionQuery(pt);x.length>=this.minPts&&(De=this._mergeArrays(De,x))}1!==this._assigned[pt]&&this._addToCluster(pt,Ue)}},gt.prototype._addToCluster=function(Ue,De){this.clusters[De].push(Ue),this._assigned[Ue]=1},gt.prototype._regionQuery=function(Ue){for(var De=[],Be=0;Be<this._datasetLength;Be++)this.distance(this.dataset[Ue],this.dataset[Be])<this.epsilon&&De.push(Be);return De},gt.prototype._mergeArrays=function(Ue,De){for(var Be=De.length,pt=0;pt<Be;pt++){var x=De[pt];Ue.indexOf(x)<0&&Ue.push(x)}return Ue},gt.prototype._euclideanDistance=function(Ue,De){for(var Be=0,pt=Math.min(Ue.length,De.length);pt--;)Be+=(Ue[pt]-De[pt])*(Ue[pt]-De[pt]);return Math.sqrt(Be)},Zt.exports&&(Zt.exports=gt)},1955:Zt=>{function gt(Ue,De,Be){this.k=3,this.dataset=[],this.assignments=[],this.centroids=[],this.init(Ue,De,Be)}gt.prototype.init=function(Ue,De,Be){this.assignments=[],this.centroids=[],void 0!==Ue&&(this.dataset=Ue),void 0!==De&&(this.k=De),void 0!==Be&&(this.distance=Be)},gt.prototype.run=function(Ue,De){this.init(Ue,De);for(var Be=this.dataset.length,pt=0;pt<this.k;pt++)this.centroids[pt]=this.randomCentroid();for(var x=!0;x;){x=this.assign();for(var ut=0;ut<this.k;ut++){for(var qe=new Array(It),dt=0,Ge=0;Ge<It;Ge++)qe[Ge]=0;for(var Qe=0;Qe<Be;Qe++){var It=this.dataset[Qe].length;if(ut===this.assignments[Qe]){for(Ge=0;Ge<It;Ge++)qe[Ge]+=this.dataset[Qe][Ge];dt++}}if(dt>0){for(Ge=0;Ge<It;Ge++)qe[Ge]/=dt;this.centroids[ut]=qe}else this.centroids[ut]=this.randomCentroid(),x=!0}}return this.getClusters()},gt.prototype.randomCentroid=function(){var De,Be,Ue=this.dataset.length-1;do{Be=Math.round(Math.random()*Ue),De=this.dataset[Be]}while(this.centroids.indexOf(De)>=0);return De},gt.prototype.assign=function(){for(var Be,Ue=!1,De=this.dataset.length,pt=0;pt<De;pt++)(Be=this.argmin(this.dataset[pt],this.centroids,this.distance))!=this.assignments[pt]&&(this.assignments[pt]=Be,Ue=!0);return Ue},gt.prototype.getClusters=function(){for(var De,Ue=new Array(this.k),Be=0;Be<this.assignments.length;Be++)void 0===Ue[De=this.assignments[Be]]&&(Ue[De]=[]),Ue[De].push(Be);return Ue},gt.prototype.argmin=function(Ue,De,Be){for(var qe,pt=Number.MAX_VALUE,x=0,ut=De.length,dt=0;dt<ut;dt++)(qe=Be(Ue,De[dt]))<pt&&(pt=qe,x=dt);return x},gt.prototype.distance=function(Ue,De){for(var Be=0,pt=Math.min(Ue.length,De.length);pt--;){var x=Ue[pt]-De[pt];Be+=x*x}return Math.sqrt(Be)},Zt.exports&&(Zt.exports=gt)},5e3:(Zt,gt,Ue)=>{if(Zt.exports)var De=Ue(571);function Be(pt,x,ut,qe){this.epsilon=1,this.minPts=1,this.distance=this._euclideanDistance,this._reachability=[],this._processed=[],this._coreDistance=0,this._orderedList=[],this._init(pt,x,ut,qe)}Be.prototype.run=function(pt,x,ut,qe){this._init(pt,x,ut,qe);for(var dt=0,Ge=this.dataset.length;dt<Ge;dt++)if(1!==this._processed[dt]){this._processed[dt]=1,this.clusters.push([dt]);var Qe=this.clusters.length-1;this._orderedList.push(dt);var It=new De(null,null,"asc"),kt=this._regionQuery(dt);void 0!==this._distanceToCore(dt)&&(this._updateQueue(dt,kt,It),this._expandCluster(Qe,It))}return this.clusters},Be.prototype.getReachabilityPlot=function(){for(var pt=[],x=0,ut=this._orderedList.length;x<ut;x++){var qe=this._orderedList[x];pt.push([qe,this._reachability[qe]])}return pt},Be.prototype._init=function(pt,x,ut,qe){if(pt){if(!(pt instanceof Array))throw Error("Dataset must be of type array, "+typeof pt+" given");this.dataset=pt,this.clusters=[],this._reachability=new Array(this.dataset.length),this._processed=new Array(this.dataset.length),this._coreDistance=0,this._orderedList=[]}x&&(this.epsilon=x),ut&&(this.minPts=ut),qe&&(this.distance=qe)},Be.prototype._updateQueue=function(pt,x,ut){var qe=this;this._coreDistance=this._distanceToCore(pt),x.forEach(function(dt){if(void 0===qe._processed[dt]){var Ge=qe.distance(qe.dataset[pt],qe.dataset[dt]),Qe=Math.max(qe._coreDistance,Ge);void 0===qe._reachability[dt]?(qe._reachability[dt]=Qe,ut.insert(dt,Qe)):Qe<qe._reachability[dt]&&(qe._reachability[dt]=Qe,ut.remove(dt),ut.insert(dt,Qe))}})},Be.prototype._expandCluster=function(pt,x){for(var ut=x.getElements(),qe=0,dt=ut.length;qe<dt;qe++){var Ge=ut[qe];if(void 0===this._processed[Ge]){var Qe=this._regionQuery(Ge);this._processed[Ge]=1,this.clusters[pt].push(Ge),this._orderedList.push(Ge),void 0!==this._distanceToCore(Ge)&&(this._updateQueue(Ge,Qe,x),this._expandCluster(pt,x))}}},Be.prototype._distanceToCore=function(pt){for(var x=this.epsilon,ut=0;ut<x;ut++)if(this._regionQuery(pt,ut).length>=this.minPts)return ut},Be.prototype._regionQuery=function(pt,x){x=x||this.epsilon;for(var ut=[],qe=0,dt=this.dataset.length;qe<dt;qe++)this.distance(this.dataset[pt],this.dataset[qe])<x&&ut.push(qe);return ut},Be.prototype._euclideanDistance=function(pt,x){for(var ut=0,qe=Math.min(pt.length,x.length);qe--;)ut+=(pt[qe]-x[qe])*(pt[qe]-x[qe]);return Math.sqrt(ut)},Zt.exports&&(Zt.exports=Be)},571:Zt=>{function gt(Ue,De,Be){this._queue=[],this._priorities=[],this._sorting="desc",this._init(Ue,De,Be)}gt.prototype.insert=function(Ue,De){for(var Be=this._queue.length,pt=Be;pt--;){var x=this._priorities[pt];"desc"===this._sorting?De>x&&(Be=pt):De<x&&(Be=pt)}this._insertAt(Ue,De,Be)},gt.prototype.remove=function(Ue){for(var De=this._queue.length;De--;)if(Ue===this._queue[De]){this._queue.splice(De,1),this._priorities.splice(De,1);break}},gt.prototype.forEach=function(Ue){this._queue.forEach(Ue)},gt.prototype.getElements=function(){return this._queue},gt.prototype.getElementPriority=function(Ue){return this._priorities[Ue]},gt.prototype.getPriorities=function(){return this._priorities},gt.prototype.getElementsWithPriorities=function(){for(var Ue=[],De=0,Be=this._queue.length;De<Be;De++)Ue.push([this._queue[De],this._priorities[De]]);return Ue},gt.prototype._init=function(Ue,De,Be){if(Ue&&De){if(this._queue=[],this._priorities=[],Ue.length!==De.length)throw new Error("Arrays must have the same length");for(var pt=0;pt<Ue.length;pt++)this.insert(Ue[pt],De[pt])}Be&&(this._sorting=Be)},gt.prototype._insertAt=function(Ue,De,Be){this._queue.length===Be?(this._queue.push(Ue),this._priorities.push(De)):(this._queue.splice(Be,0,Ue),this._priorities.splice(Be,0,De))},Zt.exports&&(Zt.exports=gt)},6882:(Zt,gt,Ue)=>{Zt.exports&&(Zt.exports={DBSCAN:Ue(5810),KMEANS:Ue(1955),OPTICS:Ue(5e3),PriorityQueue:Ue(571)})},1604:Zt=>{"use strict";function gt(Ce,ht,Pe){Pe=Pe||2;var Ut,Sn,Gt,Mn,hr,sr,In,lt=ht&&ht.length,Ke=lt?ht[0]*Pe:Ce.length,Me=Ue(Ce,0,Ke,Pe,!0),Ft=[];if(!Me||Me.next===Me.prev)return Ft;if(lt&&(Me=function(Ce,ht,Pe,lt){var Me,Ft,Gt,Ke=[];for(Me=0,Ft=ht.length;Me<Ft;Me++)(Gt=Ue(Ce,ht[Me]*lt,Me<Ft-1?ht[Me+1]*lt:Ce.length,lt,!1))===Gt.next&&(Gt.steiner=!0),Ke.push(fe(Gt));for(Ke.sort(Ge),Me=0;Me<Ke.length;Me++)Pe=De(Pe=Qe(Ke[Me],Pe),Pe.next);return Pe}(Ce,ht,Me,Pe)),Ce.length>80*Pe){Ut=Gt=Ce[0],Sn=Mn=Ce[1];for(var Vn=Pe;Vn<Ke;Vn+=Pe)(hr=Ce[Vn])<Ut&&(Ut=hr),(sr=Ce[Vn+1])<Sn&&(Sn=sr),hr>Gt&&(Gt=hr),sr>Mn&&(Mn=sr);In=0!==(In=Math.max(Gt-Ut,Mn-Sn))?1/In:0}return Be(Me,Ft,Pe,Ut,Sn,In),Ft}function Ue(Ce,ht,Pe,lt,Ke){var Me,Ft;if(Ke===Lt(Ce,ht,Pe,lt)>0)for(Me=ht;Me<Pe;Me+=lt)Ft=Oe(Me,Ce[Me],Ce[Me+1],Ft);else for(Me=Pe-lt;Me>=ht;Me-=lt)Ft=Oe(Me,Ce[Me],Ce[Me+1],Ft);return Ft&&le(Ft,Ft.next)&&(xe(Ft),Ft=Ft.next),Ft}function De(Ce,ht){if(!Ce)return Ce;ht||(ht=Ce);var lt,Pe=Ce;do{if(lt=!1,Pe.steiner||!le(Pe,Pe.next)&&0!==pe(Pe.prev,Pe,Pe.next))Pe=Pe.next;else{if(xe(Pe),(Pe=ht=Pe.prev)===Pe.next)break;lt=!0}}while(lt||Pe!==ht);return ht}function Be(Ce,ht,Pe,lt,Ke,Me,Ft){if(Ce){!Ft&&Me&&function(Ce,ht,Pe,lt){var Ke=Ce;do{null===Ke.z&&(Ke.z=an(Ke.x,Ke.y,ht,Pe,lt)),Ke.prevZ=Ke.prev,Ke.nextZ=Ke.next,Ke=Ke.next}while(Ke!==Ce);Ke.prevZ.nextZ=null,Ke.prevZ=null,function(Ce){var ht,Pe,lt,Ke,Me,Ft,Ut,Sn,Gt=1;do{for(Pe=Ce,Ce=null,Me=null,Ft=0;Pe;){for(Ft++,lt=Pe,Ut=0,ht=0;ht<Gt&&(Ut++,lt=lt.nextZ);ht++);for(Sn=Gt;Ut>0||Sn>0&&lt;)0!==Ut&&(0===Sn||!lt||Pe.z<=lt.z)?(Ke=Pe,Pe=Pe.nextZ,Ut--):(Ke=lt,lt=lt.nextZ,Sn--),Me?Me.nextZ=Ke:Ce=Ke,Ke.prevZ=Me,Me=Ke;Pe=lt}Me.nextZ=null,Gt*=2}while(Ft>1)}(Ke)}(Ce,lt,Ke,Me);for(var Sn,Gt,Ut=Ce;Ce.prev!==Ce.next;)if(Sn=Ce.prev,Gt=Ce.next,Me?x(Ce,lt,Ke,Me):pt(Ce))ht.push(Sn.i/Pe),ht.push(Ce.i/Pe),ht.push(Gt.i/Pe),xe(Ce),Ce=Gt.next,Ut=Gt.next;else if((Ce=Gt)===Ut){Ft?1===Ft?Be(Ce=ut(De(Ce),ht,Pe),ht,Pe,lt,Ke,Me,2):2===Ft&&qe(Ce,ht,Pe,lt,Ke,Me):Be(De(Ce),ht,Pe,lt,Ke,Me,1);break}}}function pt(Ce){var ht=Ce.prev,Pe=Ce,lt=Ce.next;if(pe(ht,Pe,lt)>=0)return!1;for(var Ke=Ce.next.next;Ke!==Ce.prev;){if(Se(ht.x,ht.y,Pe.x,Pe.y,lt.x,lt.y,Ke.x,Ke.y)&&pe(Ke.prev,Ke,Ke.next)>=0)return!1;Ke=Ke.next}return!0}function x(Ce,ht,Pe,lt){var Ke=Ce.prev,Me=Ce,Ft=Ce.next;if(pe(Ke,Me,Ft)>=0)return!1;for(var Gt=Ke.x>Me.x?Ke.x>Ft.x?Ke.x:Ft.x:Me.x>Ft.x?Me.x:Ft.x,Mn=Ke.y>Me.y?Ke.y>Ft.y?Ke.y:Ft.y:Me.y>Ft.y?Me.y:Ft.y,hr=an(Ke.x<Me.x?Ke.x<Ft.x?Ke.x:Ft.x:Me.x<Ft.x?Me.x:Ft.x,Ke.y<Me.y?Ke.y<Ft.y?Ke.y:Ft.y:Me.y<Ft.y?Me.y:Ft.y,ht,Pe,lt),sr=an(Gt,Mn,ht,Pe,lt),In=Ce.prevZ,Vn=Ce.nextZ;In&&In.z>=hr&&Vn&&Vn.z<=sr;){if(In!==Ce.prev&&In!==Ce.next&&Se(Ke.x,Ke.y,Me.x,Me.y,Ft.x,Ft.y,In.x,In.y)&&pe(In.prev,In,In.next)>=0||(In=In.prevZ,Vn!==Ce.prev&&Vn!==Ce.next&&Se(Ke.x,Ke.y,Me.x,Me.y,Ft.x,Ft.y,Vn.x,Vn.y)&&pe(Vn.prev,Vn,Vn.next)>=0))return!1;Vn=Vn.nextZ}for(;In&&In.z>=hr;){if(In!==Ce.prev&&In!==Ce.next&&Se(Ke.x,Ke.y,Me.x,Me.y,Ft.x,Ft.y,In.x,In.y)&&pe(In.prev,In,In.next)>=0)return!1;In=In.prevZ}for(;Vn&&Vn.z<=sr;){if(Vn!==Ce.prev&&Vn!==Ce.next&&Se(Ke.x,Ke.y,Me.x,Me.y,Ft.x,Ft.y,Vn.x,Vn.y)&&pe(Vn.prev,Vn,Vn.next)>=0)return!1;Vn=Vn.nextZ}return!0}function ut(Ce,ht,Pe){var lt=Ce;do{var Ke=lt.prev,Me=lt.next.next;!le(Ke,Me)&&Ne(Ke,lt,lt.next,Me)&&re(Ke,Me)&&re(Me,Ke)&&(ht.push(Ke.i/Pe),ht.push(lt.i/Pe),ht.push(Me.i/Pe),xe(lt),xe(lt.next),lt=Ce=Me),lt=lt.next}while(lt!==Ce);return De(lt)}function qe(Ce,ht,Pe,lt,Ke,Me){var Ft=Ce;do{for(var Ut=Ft.next.next;Ut!==Ft.prev;){if(Ft.i!==Ut.i&&ue(Ft,Ut)){var Sn=ze(Ft,Ut);return Ft=De(Ft,Ft.next),Sn=De(Sn,Sn.next),Be(Ft,ht,Pe,lt,Ke,Me),void Be(Sn,ht,Pe,lt,Ke,Me)}Ut=Ut.next}Ft=Ft.next}while(Ft!==Ce)}function Ge(Ce,ht){return Ce.x-ht.x}function Qe(Ce,ht){var Pe=function(Ce,ht){var Ft,Pe=ht,lt=Ce.x,Ke=Ce.y,Me=-1/0;do{if(Ke<=Pe.y&&Ke>=Pe.next.y&&Pe.next.y!==Pe.y){var Ut=Pe.x+(Ke-Pe.y)*(Pe.next.x-Pe.x)/(Pe.next.y-Pe.y);if(Ut<=lt&&Ut>Me){if(Me=Ut,Ut===lt){if(Ke===Pe.y)return Pe;if(Ke===Pe.next.y)return Pe.next}Ft=Pe.x<Pe.next.x?Pe:Pe.next}}Pe=Pe.next}while(Pe!==ht);if(!Ft)return null;if(lt===Me)return Ft;var sr,Sn=Ft,Gt=Ft.x,Mn=Ft.y,hr=1/0;Pe=Ft;do{lt>=Pe.x&&Pe.x>=Gt&&lt!==Pe.x&&Se(Ke<Mn?lt:Me,Ke,Gt,Mn,Ke<Mn?Me:lt,Ke,Pe.x,Pe.y)&&(sr=Math.abs(Ke-Pe.y)/(lt-Pe.x),re(Pe,Ce)&&(sr<hr||sr===hr&&(Pe.x>Ft.x||Pe.x===Ft.x&&kt(Ft,Pe)))&&(Ft=Pe,hr=sr)),Pe=Pe.next}while(Pe!==Sn);return Ft}(Ce,ht);if(!Pe)return ht;var lt=ze(Pe,Ce),Ke=De(Pe,Pe.next);return De(lt,lt.next),ht===Pe?Ke:ht}function kt(Ce,ht){return pe(Ce.prev,Ce,ht.prev)<0&&pe(ht.next,Ce,Ce.next)<0}function an(Ce,ht,Pe,lt,Ke){return(Ce=1431655765&((Ce=858993459&((Ce=252645135&((Ce=16711935&((Ce=32767*(Ce-Pe)*Ke)|Ce<<8))|Ce<<4))|Ce<<2))|Ce<<1))|(ht=1431655765&((ht=858993459&((ht=252645135&((ht=16711935&((ht=32767*(ht-lt)*Ke)|ht<<8))|ht<<4))|ht<<2))|ht<<1))<<1}function fe(Ce){var ht=Ce,Pe=Ce;do{(ht.x<Pe.x||ht.x===Pe.x&&ht.y<Pe.y)&&(Pe=ht),ht=ht.next}while(ht!==Ce);return Pe}function Se(Ce,ht,Pe,lt,Ke,Me,Ft,Ut){return(Ke-Ft)*(ht-Ut)-(Ce-Ft)*(Me-Ut)>=0&&(Ce-Ft)*(lt-Ut)-(Pe-Ft)*(ht-Ut)>=0&&(Pe-Ft)*(Me-Ut)-(Ke-Ft)*(lt-Ut)>=0}function ue(Ce,ht){return Ce.next.i!==ht.i&&Ce.prev.i!==ht.i&&!function(Ce,ht){var Pe=Ce;do{if(Pe.i!==Ce.i&&Pe.next.i!==Ce.i&&Pe.i!==ht.i&&Pe.next.i!==ht.i&&Ne(Pe,Pe.next,Ce,ht))return!0;Pe=Pe.next}while(Pe!==Ce);return!1}(Ce,ht)&&(re(Ce,ht)&&re(ht,Ce)&&function(Ce,ht){var Pe=Ce,lt=!1,Ke=(Ce.x+ht.x)/2,Me=(Ce.y+ht.y)/2;do{Pe.y>Me!=Pe.next.y>Me&&Pe.next.y!==Pe.y&&Ke<(Pe.next.x-Pe.x)*(Me-Pe.y)/(Pe.next.y-Pe.y)+Pe.x&&(lt=!lt),Pe=Pe.next}while(Pe!==Ce);return lt}(Ce,ht)&&(pe(Ce.prev,Ce,ht.prev)||pe(Ce,ht.prev,ht))||le(Ce,ht)&&pe(Ce.prev,Ce,Ce.next)>0&&pe(ht.prev,ht,ht.next)>0)}function pe(Ce,ht,Pe){return(ht.y-Ce.y)*(Pe.x-ht.x)-(ht.x-Ce.x)*(Pe.y-ht.y)}function le(Ce,ht){return Ce.x===ht.x&&Ce.y===ht.y}function Ne(Ce,ht,Pe,lt){var Ke=me(pe(Ce,ht,Pe)),Me=me(pe(Ce,ht,lt)),Ft=me(pe(Pe,lt,Ce)),Ut=me(pe(Pe,lt,ht));return!!(Ke!==Me&&Ft!==Ut||0===Ke&&he(Ce,Pe,ht)||0===Me&&he(Ce,lt,ht)||0===Ft&&he(Pe,Ce,lt)||0===Ut&&he(Pe,ht,lt))}function he(Ce,ht,Pe){return ht.x<=Math.max(Ce.x,Pe.x)&&ht.x>=Math.min(Ce.x,Pe.x)&&ht.y<=Math.max(Ce.y,Pe.y)&&ht.y>=Math.min(Ce.y,Pe.y)}function me(Ce){return Ce>0?1:Ce<0?-1:0}function re(Ce,ht){return pe(Ce.prev,Ce,Ce.next)<0?pe(Ce,ht,Ce.next)>=0&&pe(Ce,Ce.prev,ht)>=0:pe(Ce,ht,Ce.prev)<0||pe(Ce,Ce.next,ht)<0}function ze(Ce,ht){var Pe=new jt(Ce.i,Ce.x,Ce.y),lt=new jt(ht.i,ht.x,ht.y),Ke=Ce.next,Me=ht.prev;return Ce.next=ht,ht.prev=Ce,Pe.next=Ke,Ke.prev=Pe,lt.next=Pe,Pe.prev=lt,Me.next=lt,lt.prev=Me,lt}function Oe(Ce,ht,Pe,lt){var Ke=new jt(Ce,ht,Pe);return lt?(Ke.next=lt.next,Ke.prev=lt,lt.next.prev=Ke,lt.next=Ke):(Ke.prev=Ke,Ke.next=Ke),Ke}function xe(Ce){Ce.next.prev=Ce.prev,Ce.prev.next=Ce.next,Ce.prevZ&&(Ce.prevZ.nextZ=Ce.nextZ),Ce.nextZ&&(Ce.nextZ.prevZ=Ce.prevZ)}function jt(Ce,ht,Pe){this.i=Ce,this.x=ht,this.y=Pe,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Lt(Ce,ht,Pe,lt){for(var Ke=0,Me=ht,Ft=Pe-lt;Me<Pe;Me+=lt)Ke+=(Ce[Ft]-Ce[Me])*(Ce[Me+1]+Ce[Ft+1]),Ft=Me;return Ke}Zt.exports=gt,Zt.exports.default=gt,gt.deviation=function(Ce,ht,Pe,lt){var Ke=ht&&ht.length,Ft=Math.abs(Lt(Ce,0,Ke?ht[0]*Pe:Ce.length,Pe));if(Ke)for(var Ut=0,Sn=ht.length;Ut<Sn;Ut++)Ft-=Math.abs(Lt(Ce,ht[Ut]*Pe,Ut<Sn-1?ht[Ut+1]*Pe:Ce.length,Pe));var hr=0;for(Ut=0;Ut<lt.length;Ut+=3){var sr=lt[Ut]*Pe,In=lt[Ut+1]*Pe,Vn=lt[Ut+2]*Pe;hr+=Math.abs((Ce[sr]-Ce[Vn])*(Ce[In+1]-Ce[sr+1])-(Ce[sr]-Ce[In])*(Ce[Vn+1]-Ce[sr+1]))}return 0===Ft&&0===hr?0:Math.abs((hr-Ft)/Ft)},gt.flatten=function(Ce){for(var ht=Ce[0][0].length,Pe={vertices:[],holes:[],dimensions:ht},lt=0,Ke=0;Ke<Ce.length;Ke++){for(var Me=0;Me<Ce[Ke].length;Me++)for(var Ft=0;Ft<ht;Ft++)Pe.vertices.push(Ce[Ke][Me][Ft]);Ke>0&&Pe.holes.push(lt+=Ce[Ke-1].length)}return Pe}},1609:Zt=>{"use strict";var gt="Function.prototype.bind called on incompatible ",Ue=Array.prototype.slice,De=Object.prototype.toString,Be="[object Function]";Zt.exports=function(x){var ut=this;if("function"!=typeof ut||De.call(ut)!==Be)throw new TypeError(gt+ut);for(var dt,qe=Ue.call(arguments,1),Ge=function(){if(this instanceof dt){var At=ut.apply(this,qe.concat(Ue.call(arguments)));return Object(At)===At?At:this}return ut.apply(x,qe.concat(Ue.call(arguments)))},Qe=Math.max(0,ut.length-qe.length),It=[],kt=0;kt<Qe;kt++)It.push("$"+kt);if(dt=Function("binder","return function ("+It.join(",")+"){ return binder.apply(this,arguments); }")(Ge),ut.prototype){var vt=function(){};vt.prototype=ut.prototype,dt.prototype=new vt,vt.prototype=null}return dt}},5396:(Zt,gt,Ue)=>{"use strict";var De=Ue(1609);Zt.exports=Function.prototype.bind||De},9331:(Zt,gt,Ue)=>{var De=Ue(2978),Be=function(qe){this.precision=qe&&qe.precision?qe.precision:17,this.direction=!(!qe||!qe.direction)&&qe.direction,this.pseudoNode=!(!qe||!qe.pseudoNode)&&qe.pseudoNode,this.objectComparator=qe&&qe.objectComparator?qe.objectComparator:ut};function pt(qe){return qe.coordinates.map(function(dt){return{type:qe.type.replace("Multi",""),coordinates:dt}})}function x(qe,dt){return qe.hasOwnProperty("coordinates")?qe.coordinates.length===dt.coordinates.length:qe.length===dt.length}function ut(qe,dt){return De(qe,dt,{strict:!0})}Be.prototype.compare=function(qe,dt){if(qe.type!==dt.type||!x(qe,dt))return!1;switch(qe.type){case"Point":return this.compareCoord(qe.coordinates,dt.coordinates);case"LineString":return this.compareLine(qe.coordinates,dt.coordinates,0,!1);case"Polygon":return this.comparePolygon(qe,dt);case"Feature":return this.compareFeature(qe,dt);default:if(0===qe.type.indexOf("Multi")){var Ge=this,Qe=pt(qe),It=pt(dt);return Qe.every(function(kt){return this.some(function(vt){return Ge.compare(kt,vt)})},It)}}return!1},Be.prototype.compareCoord=function(qe,dt){if(qe.length!==dt.length)return!1;for(var Ge=0;Ge<qe.length;Ge++)if(qe[Ge].toFixed(this.precision)!==dt[Ge].toFixed(this.precision))return!1;return!0},Be.prototype.compareLine=function(qe,dt,Ge,Qe){if(!x(qe,dt))return!1;var It=this.pseudoNode?qe:this.removePseudo(qe),kt=this.pseudoNode?dt:this.removePseudo(dt);if(!Qe||this.compareCoord(It[0],kt[0])||(kt=this.fixStartIndex(kt,It))){var vt=this.compareCoord(It[Ge],kt[Ge]);return this.direction||vt?this.comparePath(It,kt):!!this.compareCoord(It[Ge],kt[kt.length-(1+Ge)])&&this.comparePath(It.slice().reverse(),kt)}},Be.prototype.fixStartIndex=function(qe,dt){for(var Ge,Qe=-1,It=0;It<qe.length;It++)if(this.compareCoord(qe[It],dt[0])){Qe=It;break}return Qe>=0&&(Ge=[].concat(qe.slice(Qe,qe.length),qe.slice(1,Qe+1))),Ge},Be.prototype.comparePath=function(qe,dt){var Ge=this;return qe.every(function(Qe,It){return Ge.compareCoord(Qe,this[It])},dt)},Be.prototype.comparePolygon=function(qe,dt){if(this.compareLine(qe.coordinates[0],dt.coordinates[0],1,!0)){var Ge=qe.coordinates.slice(1,qe.coordinates.length),Qe=dt.coordinates.slice(1,dt.coordinates.length),It=this;return Ge.every(function(kt){return this.some(function(vt){return It.compareLine(kt,vt,1,!0)})},Qe)}return!1},Be.prototype.compareFeature=function(qe,dt){return!(qe.id!==dt.id||!this.objectComparator(qe.properties,dt.properties)||!this.compareBBox(qe,dt))&&this.compare(qe.geometry,dt.geometry)},Be.prototype.compareBBox=function(qe,dt){return!!(!qe.bbox&&!dt.bbox||qe.bbox&&dt.bbox&&this.compareCoord(qe.bbox,dt.bbox))},Be.prototype.removePseudo=function(qe){return qe},Zt.exports=Be},2689:(Zt,gt,Ue)=>{var De=Ue(5754),Be=Ue(8410),pt=Ue(3033),x=Ue(185).Z,ut=pt.featureEach,Ge=Be.featureCollection;function Qe(It){var kt=new De(It);return kt.insert=function(vt){if("Feature"!==vt.type)throw new Error("invalid feature");return vt.bbox=vt.bbox?vt.bbox:x(vt),De.prototype.insert.call(this,vt)},kt.load=function(vt){var At=[];return Array.isArray(vt)?vt.forEach(function(an){if("Feature"!==an.type)throw new Error("invalid features");an.bbox=an.bbox?an.bbox:x(an),At.push(an)}):ut(vt,function(an){if("Feature"!==an.type)throw new Error("invalid features");an.bbox=an.bbox?an.bbox:x(an),At.push(an)}),De.prototype.load.call(this,At)},kt.remove=function(vt,At){if("Feature"!==vt.type)throw new Error("invalid feature");return vt.bbox=vt.bbox?vt.bbox:x(vt),De.prototype.remove.call(this,vt,At)},kt.clear=function(){return De.prototype.clear.call(this)},kt.search=function(vt){var At=De.prototype.search.call(this,this.toBBox(vt));return Ge(At)},kt.collides=function(vt){return De.prototype.collides.call(this,this.toBBox(vt))},kt.all=function(){var vt=De.prototype.all.call(this);return Ge(vt)},kt.toJSON=function(){return De.prototype.toJSON.call(this)},kt.fromJSON=function(vt){return De.prototype.fromJSON.call(this,vt)},kt.toBBox=function(vt){var At;if(vt.bbox)At=vt.bbox;else if(Array.isArray(vt)&&4===vt.length)At=vt;else if(Array.isArray(vt)&&6===vt.length)At=[vt[0],vt[1],vt[3],vt[4]];else if("Feature"===vt.type)At=x(vt);else{if("FeatureCollection"!==vt.type)throw new Error("invalid geojson");At=x(vt)}return{minX:At[0],minY:At[1],maxX:At[2],maxY:At[3]}},kt}Zt.exports=Qe,Zt.exports.default=Qe},5754:function(Zt){Zt.exports=function(){"use strict";function gt(fe,Se,ue,pe,le){!function Ne(he,me,be,re,mt){for(;re>be;){if(re-be>600){var ze=re-be+1,Oe=me-be+1,xe=Math.log(ze),jt=.5*Math.exp(2*xe/3),Lt=.5*Math.sqrt(xe*jt*(ze-jt)/ze)*(Oe-ze/2<0?-1:1);Ne(he,me,Math.max(be,Math.floor(me-Oe*jt/ze+Lt)),Math.min(re,Math.floor(me+(ze-Oe)*jt/ze+Lt)),mt)}var Pe=he[me],lt=be,Ke=re;for(Ue(he,be,me),mt(he[re],Pe)>0&&Ue(he,be,re);lt<Ke;){for(Ue(he,lt,Ke),lt++,Ke--;mt(he[lt],Pe)<0;)lt++;for(;mt(he[Ke],Pe)>0;)Ke--}0===mt(he[be],Pe)?Ue(he,be,Ke):Ue(he,++Ke,re),Ke<=me&&(be=Ke+1),me<=Ke&&(re=Ke-1)}}(fe,Se,ue||0,pe||fe.length-1,le||De)}function Ue(fe,Se,ue){var pe=fe[Se];fe[Se]=fe[ue],fe[ue]=pe}function De(fe,Se){return fe<Se?-1:fe>Se?1:0}var Be=function(fe){void 0===fe&&(fe=9),this._maxEntries=Math.max(4,fe),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function pt(fe,Se,ue){if(!ue)return Se.indexOf(fe);for(var pe=0;pe<Se.length;pe++)if(ue(fe,Se[pe]))return pe;return-1}function x(fe,Se){ut(fe,0,fe.children.length,Se,fe)}function ut(fe,Se,ue,pe,le){le||(le=At(null)),le.minX=1/0,le.minY=1/0,le.maxX=-1/0,le.maxY=-1/0;for(var Ne=Se;Ne<ue;Ne++){var he=fe.children[Ne];qe(le,fe.leaf?pe(he):he)}return le}function qe(fe,Se){return fe.minX=Math.min(fe.minX,Se.minX),fe.minY=Math.min(fe.minY,Se.minY),fe.maxX=Math.max(fe.maxX,Se.maxX),fe.maxY=Math.max(fe.maxY,Se.maxY),fe}function dt(fe,Se){return fe.minX-Se.minX}function Ge(fe,Se){return fe.minY-Se.minY}function Qe(fe){return(fe.maxX-fe.minX)*(fe.maxY-fe.minY)}function It(fe){return fe.maxX-fe.minX+(fe.maxY-fe.minY)}function kt(fe,Se){return fe.minX<=Se.minX&&fe.minY<=Se.minY&&Se.maxX<=fe.maxX&&Se.maxY<=fe.maxY}function vt(fe,Se){return Se.minX<=fe.maxX&&Se.minY<=fe.maxY&&Se.maxX>=fe.minX&&Se.maxY>=fe.minY}function At(fe){return{children:fe,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function an(fe,Se,ue,pe,le){for(var Ne=[Se,ue];Ne.length;)if(!((ue=Ne.pop())-(Se=Ne.pop())<=pe)){var he=Se+Math.ceil((ue-Se)/pe/2)*pe;gt(fe,he,Se,ue,le),Ne.push(Se,he,he,ue)}}return Be.prototype.all=function(){return this._all(this.data,[])},Be.prototype.search=function(fe){var Se=this.data,ue=[];if(!vt(fe,Se))return ue;for(var pe=this.toBBox,le=[];Se;){for(var Ne=0;Ne<Se.children.length;Ne++){var he=Se.children[Ne],me=Se.leaf?pe(he):he;vt(fe,me)&&(Se.leaf?ue.push(he):kt(fe,me)?this._all(he,ue):le.push(he))}Se=le.pop()}return ue},Be.prototype.collides=function(fe){var Se=this.data;if(!vt(fe,Se))return!1;for(var ue=[];Se;){for(var pe=0;pe<Se.children.length;pe++){var le=Se.children[pe],Ne=Se.leaf?this.toBBox(le):le;if(vt(fe,Ne)){if(Se.leaf||kt(fe,Ne))return!0;ue.push(le)}}Se=ue.pop()}return!1},Be.prototype.load=function(fe){if(!fe||!fe.length)return this;if(fe.length<this._minEntries){for(var Se=0;Se<fe.length;Se++)this.insert(fe[Se]);return this}var ue=this._build(fe.slice(),0,fe.length-1,0);if(this.data.children.length)if(this.data.height===ue.height)this._splitRoot(this.data,ue);else{if(this.data.height<ue.height){var pe=this.data;this.data=ue,ue=pe}this._insert(ue,this.data.height-ue.height-1,!0)}else this.data=ue;return this},Be.prototype.insert=function(fe){return fe&&this._insert(fe,this.data.height-1),this},Be.prototype.clear=function(){return this.data=At([]),this},Be.prototype.remove=function(fe,Se){if(!fe)return this;for(var ue,pe,le,Ne=this.data,he=this.toBBox(fe),me=[],be=[];Ne||me.length;){if(Ne||(Ne=me.pop(),pe=me[me.length-1],ue=be.pop(),le=!0),Ne.leaf){var re=pt(fe,Ne.children,Se);if(-1!==re)return Ne.children.splice(re,1),me.push(Ne),this._condense(me),this}le||Ne.leaf||!kt(Ne,he)?pe?(ue++,Ne=pe.children[ue],le=!1):Ne=null:(me.push(Ne),be.push(ue),ue=0,pe=Ne,Ne=Ne.children[0])}return this},Be.prototype.toBBox=function(fe){return fe},Be.prototype.compareMinX=function(fe,Se){return fe.minX-Se.minX},Be.prototype.compareMinY=function(fe,Se){return fe.minY-Se.minY},Be.prototype.toJSON=function(){return this.data},Be.prototype.fromJSON=function(fe){return this.data=fe,this},Be.prototype._all=function(fe,Se){for(var ue=[];fe;)fe.leaf?Se.push.apply(Se,fe.children):ue.push.apply(ue,fe.children),fe=ue.pop();return Se},Be.prototype._build=function(fe,Se,ue,pe){var le,Ne=ue-Se+1,he=this._maxEntries;if(Ne<=he)return x(le=At(fe.slice(Se,ue+1)),this.toBBox),le;pe||(pe=Math.ceil(Math.log(Ne)/Math.log(he)),he=Math.ceil(Ne/Math.pow(he,pe-1))),(le=At([])).leaf=!1,le.height=pe;var me=Math.ceil(Ne/he),be=me*Math.ceil(Math.sqrt(he));an(fe,Se,ue,be,this.compareMinX);for(var re=Se;re<=ue;re+=be){var mt=Math.min(re+be-1,ue);an(fe,re,mt,me,this.compareMinY);for(var ze=re;ze<=mt;ze+=me){var Oe=Math.min(ze+me-1,mt);le.children.push(this._build(fe,ze,Oe,pe-1))}}return x(le,this.toBBox),le},Be.prototype._chooseSubtree=function(fe,Se,ue,pe){for(;pe.push(Se),!Se.leaf&&pe.length-1!==ue;){for(var le=1/0,Ne=1/0,he=void 0,me=0;me<Se.children.length;me++){var be=Se.children[me],re=Qe(be),mt=(ze=fe,Oe=be,(Math.max(Oe.maxX,ze.maxX)-Math.min(Oe.minX,ze.minX))*(Math.max(Oe.maxY,ze.maxY)-Math.min(Oe.minY,ze.minY))-re);mt<Ne?(Ne=mt,le=re<le?re:le,he=be):mt===Ne&&re<le&&(le=re,he=be)}Se=he||Se.children[0]}var ze,Oe;return Se},Be.prototype._insert=function(fe,Se,ue){var pe=ue?fe:this.toBBox(fe),le=[],Ne=this._chooseSubtree(pe,this.data,Se,le);for(Ne.children.push(fe),qe(Ne,pe);Se>=0&&le[Se].children.length>this._maxEntries;)this._split(le,Se),Se--;this._adjustParentBBoxes(pe,le,Se)},Be.prototype._split=function(fe,Se){var ue=fe[Se],pe=ue.children.length,le=this._minEntries;this._chooseSplitAxis(ue,le,pe);var Ne=this._chooseSplitIndex(ue,le,pe),he=At(ue.children.splice(Ne,ue.children.length-Ne));he.height=ue.height,he.leaf=ue.leaf,x(ue,this.toBBox),x(he,this.toBBox),Se?fe[Se-1].children.push(he):this._splitRoot(ue,he)},Be.prototype._splitRoot=function(fe,Se){this.data=At([fe,Se]),this.data.height=fe.height+1,this.data.leaf=!1,x(this.data,this.toBBox)},Be.prototype._chooseSplitIndex=function(fe,Se,ue){for(var pe,le,Ne,he,me,be,re,mt=1/0,ze=1/0,Oe=Se;Oe<=ue-Se;Oe++){var xe=ut(fe,0,Oe,this.toBBox),jt=ut(fe,Oe,ue,this.toBBox),Lt=(le=xe,Ne=jt,void 0,void 0,void 0,void 0,he=Math.max(le.minX,Ne.minX),me=Math.max(le.minY,Ne.minY),be=Math.min(le.maxX,Ne.maxX),re=Math.min(le.maxY,Ne.maxY),Math.max(0,be-he)*Math.max(0,re-me)),Ce=Qe(xe)+Qe(jt);Lt<mt?(mt=Lt,pe=Oe,ze=Ce<ze?Ce:ze):Lt===mt&&Ce<ze&&(ze=Ce,pe=Oe)}return pe||ue-Se},Be.prototype._chooseSplitAxis=function(fe,Se,ue){var pe=fe.leaf?this.compareMinX:dt,le=fe.leaf?this.compareMinY:Ge;this._allDistMargin(fe,Se,ue,pe)<this._allDistMargin(fe,Se,ue,le)&&fe.children.sort(pe)},Be.prototype._allDistMargin=function(fe,Se,ue,pe){fe.children.sort(pe);for(var le=this.toBBox,Ne=ut(fe,0,Se,le),he=ut(fe,ue-Se,ue,le),me=It(Ne)+It(he),be=Se;be<ue-Se;be++){var re=fe.children[be];qe(Ne,fe.leaf?le(re):re),me+=It(Ne)}for(var mt=ue-Se-1;mt>=Se;mt--){var ze=fe.children[mt];qe(he,fe.leaf?le(ze):ze),me+=It(he)}return me},Be.prototype._adjustParentBBoxes=function(fe,Se,ue){for(var pe=ue;pe>=0;pe--)qe(Se[pe],fe)},Be.prototype._condense=function(fe){for(var Se=fe.length-1,ue=void 0;Se>=0;Se--)0===fe[Se].children.length?Se>0?(ue=fe[Se-1].children).splice(ue.indexOf(fe[Se]),1):this.clear():x(fe[Se],this.toBBox)},Be}()},8540:(Zt,gt,Ue)=>{"use strict";var De,Be=SyntaxError,pt=Function,x=TypeError,ut=function(ze){try{return pt('"use strict"; return ('+ze+").constructor;")()}catch(Oe){}},qe=Object.getOwnPropertyDescriptor;if(qe)try{qe({},"")}catch(ze){qe=null}var dt=function(){throw new x},Ge=qe?function(){try{return dt}catch(ze){try{return qe(arguments,"callee").get}catch(Oe){return dt}}}():dt,Qe=Ue(9326)(),It=Object.getPrototypeOf||function(ze){return ze.__proto__},kt={},vt="undefined"==typeof Uint8Array?De:It(Uint8Array),At={"%AggregateError%":"undefined"==typeof AggregateError?De:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?De:ArrayBuffer,"%ArrayIteratorPrototype%":Qe?It([][Symbol.iterator]()):De,"%AsyncFromSyncIteratorPrototype%":De,"%AsyncFunction%":kt,"%AsyncGenerator%":kt,"%AsyncGeneratorFunction%":kt,"%AsyncIteratorPrototype%":kt,"%Atomics%":"undefined"==typeof Atomics?De:Atomics,"%BigInt%":"undefined"==typeof BigInt?De:BigInt,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?De:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":"undefined"==typeof Float32Array?De:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?De:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?De:FinalizationRegistry,"%Function%":pt,"%GeneratorFunction%":kt,"%Int8Array%":"undefined"==typeof Int8Array?De:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?De:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?De:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":Qe?It(It([][Symbol.iterator]())):De,"%JSON%":"object"==typeof JSON?JSON:De,"%Map%":"undefined"==typeof Map?De:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&Qe?It((new Map)[Symbol.iterator]()):De,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?De:Promise,"%Proxy%":"undefined"==typeof Proxy?De:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":"undefined"==typeof Reflect?De:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?De:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&Qe?It((new Set)[Symbol.iterator]()):De,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?De:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":Qe?It(""[Symbol.iterator]()):De,"%Symbol%":Qe?Symbol:De,"%SyntaxError%":Be,"%ThrowTypeError%":Ge,"%TypedArray%":vt,"%TypeError%":x,"%Uint8Array%":"undefined"==typeof Uint8Array?De:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?De:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?De:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?De:Uint32Array,"%URIError%":URIError,"%WeakMap%":"undefined"==typeof WeakMap?De:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?De:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?De:WeakSet},an=function ze(Oe){var xe;if("%AsyncFunction%"===Oe)xe=ut("async function () {}");else if("%GeneratorFunction%"===Oe)xe=ut("function* () {}");else if("%AsyncGeneratorFunction%"===Oe)xe=ut("async function* () {}");else if("%AsyncGenerator%"===Oe){var jt=ze("%AsyncGeneratorFunction%");jt&&(xe=jt.prototype)}else if("%AsyncIteratorPrototype%"===Oe){var Lt=ze("%AsyncGenerator%");Lt&&(xe=It(Lt.prototype))}return At[Oe]=xe,xe},fe={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},Se=Ue(5396),ue=Ue(7709),pe=Se.call(Function.call,Array.prototype.concat),le=Se.call(Function.apply,Array.prototype.splice),Ne=Se.call(Function.call,String.prototype.replace),he=Se.call(Function.call,String.prototype.slice),me=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,be=/\\(\\)?/g,re=function(Oe){var xe=he(Oe,0,1),jt=he(Oe,-1);if("%"===xe&&"%"!==jt)throw new Be("invalid intrinsic syntax, expected closing `%`");if("%"===jt&&"%"!==xe)throw new Be("invalid intrinsic syntax, expected opening `%`");var Lt=[];return Ne(Oe,me,function(Ce,ht,Pe,lt){Lt[Lt.length]=Pe?Ne(lt,be,"$1"):ht||Ce}),Lt},mt=function(Oe,xe){var Lt,jt=Oe;if(ue(fe,jt)&&(jt="%"+(Lt=fe[jt])[0]+"%"),ue(At,jt)){var Ce=At[jt];if(Ce===kt&&(Ce=an(jt)),void 0===Ce&&!xe)throw new x("intrinsic "+Oe+" exists, but is not available. Please file an issue!");return{alias:Lt,name:jt,value:Ce}}throw new Be("intrinsic "+Oe+" does not exist!")};Zt.exports=function(Oe,xe){if("string"!=typeof Oe||0===Oe.length)throw new x("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof xe)throw new x('"allowMissing" argument must be a boolean');var jt=re(Oe),Lt=jt.length>0?jt[0]:"",Ce=mt("%"+Lt+"%",xe),ht=Ce.name,Pe=Ce.value,lt=!1,Ke=Ce.alias;Ke&&(Lt=Ke[0],le(jt,pe([0,1],Ke)));for(var Me=1,Ft=!0;Me<jt.length;Me+=1){var Ut=jt[Me],Sn=he(Ut,0,1),Gt=he(Ut,-1);if(('"'===Sn||"'"===Sn||"`"===Sn||'"'===Gt||"'"===Gt||"`"===Gt)&&Sn!==Gt)throw new Be("property names with quotes must have matching quotes");if(("constructor"===Ut||!Ft)&&(lt=!0),ue(At,ht="%"+(Lt+="."+Ut)+"%"))Pe=At[ht];else if(null!=Pe){if(!(Ut in Pe)){if(!xe)throw new x("base intrinsic for "+Oe+" exists, but the property is not available.");return}if(qe&&Me+1>=jt.length){var Mn=qe(Pe,Ut);Pe=(Ft=!!Mn)&&"get"in Mn&&!("originalValue"in Mn.get)?Mn.get:Pe[Ut]}else Ft=ue(Pe,Ut),Pe=Pe[Ut];Ft&&!lt&&(At[ht]=Pe)}}return Pe}},9326:(Zt,gt,Ue)=>{"use strict";var De="undefined"!=typeof Symbol&&Symbol,Be=Ue(9045);Zt.exports=function(){return"function"==typeof De&&"function"==typeof Symbol&&"symbol"==typeof De("foo")&&"symbol"==typeof Symbol("bar")&&Be()}},9045:Zt=>{"use strict";Zt.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var Ue={},De=Symbol("test"),Be=Object(De);if("string"==typeof De||"[object Symbol]"!==Object.prototype.toString.call(De)||"[object Symbol]"!==Object.prototype.toString.call(Be))return!1;for(De in Ue[De]=42,Ue)return!1;if("function"==typeof Object.keys&&0!==Object.keys(Ue).length||"function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(Ue).length)return!1;var x=Object.getOwnPropertySymbols(Ue);if(1!==x.length||x[0]!==De||!Object.prototype.propertyIsEnumerable.call(Ue,De))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var ut=Object.getOwnPropertyDescriptor(Ue,De);if(42!==ut.value||!0!==ut.enumerable)return!1}return!0}},1407:(Zt,gt,Ue)=>{"use strict";var De=Ue(9045);Zt.exports=function(){return De()&&!!Symbol.toStringTag}},7709:(Zt,gt,Ue)=>{"use strict";var De=Ue(5396);Zt.exports=De.call(Function.call,Object.prototype.hasOwnProperty)},7316:(Zt,gt,Ue)=>{"use strict";var De=Ue(1407)(),pt=Ue(9568)("Object.prototype.toString"),x=function(Ge){return!(De&&Ge&&"object"==typeof Ge&&Symbol.toStringTag in Ge)&&"[object Arguments]"===pt(Ge)},ut=function(Ge){return!!x(Ge)||null!==Ge&&"object"==typeof Ge&&"number"==typeof Ge.length&&Ge.length>=0&&"[object Array]"!==pt(Ge)&&"[object Function]"===pt(Ge.callee)},qe=function(){return x(arguments)}();x.isLegacyArguments=ut,Zt.exports=qe?x:ut},3105:(Zt,gt,Ue)=>{"use strict";var De=Date.prototype.getDay,pt=Object.prototype.toString,ut=Ue(1407)();Zt.exports=function(dt){return"object"==typeof dt&&null!==dt&&(ut?function(dt){try{return De.call(dt),!0}catch(Ge){return!1}}(dt):"[object Date]"===pt.call(dt))}},5544:(Zt,gt,Ue)=>{"use strict";var pt,x,ut,qe,De=Ue(9568),Be=Ue(1407)();if(Be){pt=De("Object.prototype.hasOwnProperty"),x=De("RegExp.prototype.exec"),ut={};var dt=function(){throw ut};qe={toString:dt,valueOf:dt},"symbol"==typeof Symbol.toPrimitive&&(qe[Symbol.toPrimitive]=dt)}var Ge=De("Object.prototype.toString"),Qe=Object.getOwnPropertyDescriptor;Zt.exports=Be?function(vt){if(!vt||"object"!=typeof vt)return!1;var At=Qe(vt,"lastIndex");if(!At||!pt(At,"value"))return!1;try{x(vt,qe)}catch(fe){return fe===ut}}:function(vt){return!(!vt||"object"!=typeof vt&&"function"!=typeof vt)&&"[object RegExp]"===Ge(vt)}},2958:function(Zt){Zt.exports=function(){"use strict";var gt,Ue,De;function Be(x,ut){if(gt)if(Ue){var qe="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/api/#transpiling-v2'); }; var sharedChunk = {}; ("+gt+")(sharedChunk); ("+Ue+")(sharedChunk); self.onerror = null;",dt={};gt(dt),De=ut(dt),"undefined"!=typeof window&&(De.workerUrl=window.URL.createObjectURL(new Blob([qe],{type:"text/javascript"})))}else Ue=ut;else gt=ut}return Be(0,function(x){var qe=dt;function dt(h,a,p,m){this.cx=3*h,this.bx=3*(p-h)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*a,this.by=3*(m-a)-this.cy,this.ay=1-this.cy-this.by,this.p1x=h,this.p1y=m,this.p2x=p,this.p2y=m}dt.prototype.sampleCurveX=function(h){return((this.ax*h+this.bx)*h+this.cx)*h},dt.prototype.sampleCurveY=function(h){return((this.ay*h+this.by)*h+this.cy)*h},dt.prototype.sampleCurveDerivativeX=function(h){return(3*this.ax*h+2*this.bx)*h+this.cx},dt.prototype.solveCurveX=function(h,a){var p,m,w,M,D;for(void 0===a&&(a=1e-6),w=h,D=0;D<8;D++){if(M=this.sampleCurveX(w)-h,Math.abs(M)<a)return w;var k=this.sampleCurveDerivativeX(w);if(Math.abs(k)<1e-6)break;w-=M/k}if((w=h)<(p=0))return p;if(w>(m=1))return m;for(;p<m;){if(M=this.sampleCurveX(w),Math.abs(M-h)<a)return w;h>M?p=w:m=w,w=.5*(m-p)+p}return w},dt.prototype.solve=function(h,a){return this.sampleCurveY(this.solveCurveX(h,a))};var Ge=Qe;function Qe(h,a){this.x=h,this.y=a}Qe.prototype={clone:function(){return new Qe(this.x,this.y)},add:function(h){return this.clone()._add(h)},sub:function(h){return this.clone()._sub(h)},multByPoint:function(h){return this.clone()._multByPoint(h)},divByPoint:function(h){return this.clone()._divByPoint(h)},mult:function(h){return this.clone()._mult(h)},div:function(h){return this.clone()._div(h)},rotate:function(h){return this.clone()._rotate(h)},rotateAround:function(h,a){return this.clone()._rotateAround(h,a)},matMult:function(h){return this.clone()._matMult(h)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(h){return this.x===h.x&&this.y===h.y},dist:function(h){return Math.sqrt(this.distSqr(h))},distSqr:function(h){var a=h.x-this.x,p=h.y-this.y;return a*a+p*p},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(h){return Math.atan2(this.y-h.y,this.x-h.x)},angleWith:function(h){return this.angleWithSep(h.x,h.y)},angleWithSep:function(h,a){return Math.atan2(this.x*a-this.y*h,this.x*h+this.y*a)},_matMult:function(h){var a=h[2]*this.x+h[3]*this.y;return this.x=h[0]*this.x+h[1]*this.y,this.y=a,this},_add:function(h){return this.x+=h.x,this.y+=h.y,this},_sub:function(h){return this.x-=h.x,this.y-=h.y,this},_mult:function(h){return this.x*=h,this.y*=h,this},_div:function(h){return this.x/=h,this.y/=h,this},_multByPoint:function(h){return this.x*=h.x,this.y*=h.y,this},_divByPoint:function(h){return this.x/=h.x,this.y/=h.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var h=this.y;return this.y=this.x,this.x=-h,this},_rotate:function(h){var a=Math.cos(h),p=Math.sin(h),m=p*this.x+a*this.y;return this.x=a*this.x-p*this.y,this.y=m,this},_rotateAround:function(h,a){var p=Math.cos(h),m=Math.sin(h),w=a.y+m*(this.x-a.x)+p*(this.y-a.y);return this.x=a.x+p*(this.x-a.x)-m*(this.y-a.y),this.y=w,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Qe.convert=function(h){return h instanceof Qe?h:Array.isArray(h)?new Qe(h[0],h[1]):h};var It="undefined"!=typeof self?self:{};const kt=Math.pow(2,53)-1,vt=Math.PI/180,At=180/Math.PI;function an(h){return h*vt}const fe=[[0,0],[1,0],[1,1],[0,1]];function Se(h){if(h<=0)return 0;if(h>=1)return 1;const a=h*h,p=a*h;return 4*(h<.5?p:3*(h-a)+p-.75)}function ue(h,a,p,m){const w=new qe(h,a,p,m);return function(M){return w.solve(M)}}const pe=ue(.25,.1,.25,1);function le(h,a,p){return Math.min(p,Math.max(a,h))}function Ne(h,a,p){const m=p-a,w=((h-a)%m+m)%m+a;return w===a?p:w}function he(h,a,p){if(!h.length)return p(null,[]);let m=h.length;const w=new Array(h.length);let M=null;h.forEach((D,k)=>{a(D,(L,V)=>{L&&(M=L),w[k]=V,0==--m&&p(M,w)})})}function me(h){const a=[];for(const p in h)a.push(h[p]);return a}function be(h,...a){for(const p of a)for(const m in p)h[m]=p[m];return h}let re=1;function mt(){return re++}function ze(){return function h(a){return a?(a^16*Math.random()>>a/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,h)}()}function Oe(h){return h<=1?1:Math.pow(2,Math.ceil(Math.log(h)/Math.LN2))}function xe(h){return!!h&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(h)}function jt(h,a){h.forEach(p=>{a[p]&&(a[p]=a[p].bind(a))})}function Lt(h,a){return-1!==h.indexOf(a,h.length-a.length)}function Ce(h,a,p){const m={};for(const w in h)m[w]=a.call(p||this,h[w],w,h);return m}function ht(h,a,p){const m={};for(const w in h)a.call(p||this,h[w],w,h)&&(m[w]=h[w]);return m}function Pe(h){return Array.isArray(h)?h.map(Pe):"object"==typeof h&&h?Ce(h,Pe):h}const lt={};function Ke(h){lt[h]||("undefined"!=typeof console&&console.warn(h),lt[h]=!0)}function Me(h,a,p){return(p.y-h.y)*(a.x-h.x)>(a.y-h.y)*(p.x-h.x)}function Ft(h){let a=0;for(let p,m,w=0,M=h.length,D=M-1;w<M;D=w++)p=h[w],m=h[D],a+=(m.x-p.x)*(p.y+m.y);return a}function Ut(){return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope}function Sn(h){const a={};if(h.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(p,m,w,M)=>{const D=w||M;return a[m]=!D||D.toLowerCase(),""}),a["max-age"]){const p=parseInt(a["max-age"],10);isNaN(p)?delete a["max-age"]:a["max-age"]=p}return a}let Gt,Mn,hr,sr=null;function In(h){if(null==sr){const a=h.navigator?h.navigator.userAgent:null;sr=!!h.safari||!(!a||!(/\b(iPad|iPhone|iPod)\b/.test(a)||a.match("Safari")&&!a.match("Chrome")))}return sr}function Vn(h){try{const a=It[h];return a.setItem("_mapbox_test_",1),a.removeItem("_mapbox_test_"),!0}catch(a){return!1}}const rn={now:()=>void 0!==hr?hr:It.performance.now(),setNow(h){hr=h},restoreNow(){hr=void 0},frame(h){const a=It.requestAnimationFrame(h);return{cancel:()=>It.cancelAnimationFrame(a)}},getImageData(h,a=0){const p=It.document.createElement("canvas"),m=p.getContext("2d");if(!m)throw new Error("failed to create canvas 2d context");return p.width=h.width,p.height=h.height,m.drawImage(h,0,0,h.width,h.height),m.getImageData(-a,-a,h.width+2*a,h.height+2*a)},resolveURL:h=>(Gt||(Gt=It.document.createElement("a")),Gt.href=h,Gt.href),get devicePixelRatio(){return It.devicePixelRatio},get prefersReducedMotion(){return!!It.matchMedia&&(null==Mn&&(Mn=It.matchMedia("(prefers-reduced-motion: reduce)")),Mn.matches)}};let hi;const nr={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(null==hi){const h=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{hi=null!=process.env.API_URL_REGEX?new RegExp(process.env.API_URL_REGEX):h}catch(a){hi=h}}return hi},get EVENTS_URL(){return this.API_URL?0===this.API_URL.indexOf("https://api.mapbox.cn")?"https://events.mapbox.cn/events/v2":0===this.API_URL.indexOf("https://api.mapbox.com")?"https://events.mapbox.com/events/v2":null:null},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},ai={supported:!1,testSupport:function(h){!_t&&eo&&(ve?ce(h):Qr=h)}};let Qr,eo,_t=!1,ve=!1;function ce(h){const a=h.createTexture();h.bindTexture(h.TEXTURE_2D,a);try{if(h.texImage2D(h.TEXTURE_2D,0,h.RGBA,h.RGBA,h.UNSIGNED_BYTE,eo),h.isContextLost())return;ai.supported=!0}catch(p){}h.deleteTexture(a),_t=!0}It.document&&(eo=It.document.createElement("img"),eo.onload=function(){Qr&&ce(Qr),Qr=null,ve=!0},eo.onerror=function(){_t=!0,Qr=null},eo.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const ae="01",Ie="NO_ACCESS_TOKEN";function ct(h){return 0===h.indexOf("mapbox:")}function Ot(h){return nr.API_URL_REGEX.test(h)}const Kt=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Yt(h){const a=h.match(Kt);if(!a)throw new Error("Unable to parse URL object");return{protocol:a[1],authority:a[2],path:a[3]||"/",params:a[4]?a[4].split("&"):[]}}function wt(h){const a=h.params.length?`?${h.params.join("&")}`:"";return`${h.protocol}://${h.authority}${h.path}${a}`}function Qn(h){if(!h)return null;const a=h.split(".");if(!a||3!==a.length)return null;try{return JSON.parse(decodeURIComponent(It.atob(a[1]).split("").map(p=>"%"+("00"+p.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch(p){return null}}class Er{constructor(a){this.type=a,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(a){const p=Qn(nr.ACCESS_TOKEN);let m="";return m=p&&p.u?It.btoa(encodeURIComponent(p.u).replace(/%([0-9A-F]{2})/g,(w,M)=>String.fromCharCode(Number("0x"+M)))):nr.ACCESS_TOKEN||"",a?`mapbox.eventData.${a}:${m}`:`mapbox.eventData:${m}`}fetchEventData(){const a=Vn("localStorage"),p=this.getStorageKey(),m=this.getStorageKey("uuid");if(a)try{const w=It.localStorage.getItem(p);w&&(this.eventData=JSON.parse(w));const M=It.localStorage.getItem(m);M&&(this.anonId=M)}catch(w){Ke("Unable to read from LocalStorage")}}saveEventData(){const a=Vn("localStorage"),p=this.getStorageKey(),m=this.getStorageKey("uuid");if(a)try{It.localStorage.setItem(m,this.anonId),Object.keys(this.eventData).length>=1&&It.localStorage.setItem(p,JSON.stringify(this.eventData))}catch(w){Ke("Unable to write to LocalStorage")}}processRequests(a){}postEvent(a,p,m,w){if(!nr.EVENTS_URL)return;const M=Yt(nr.EVENTS_URL);M.params.push(`access_token=${w||nr.ACCESS_TOKEN||""}`);const D={event:this.type,created:new Date(a).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"2.4.1",skuId:ae,userId:this.anonId},k=p?be(D,p):D,L={url:wt(M),headers:{"Content-Type":"text/plain"},body:JSON.stringify([k])};this.pendingRequest=oe(L,V=>{this.pendingRequest=null,m(V),this.saveEventData(),this.processRequests(w)})}queueRequest(a,p){this.queue.push(a),this.processRequests(p)}}const Qt=new class extends Er{constructor(h){super("appUserTurnstile"),this._customAccessToken=h}postTurnstileEvent(h,a){nr.EVENTS_URL&&nr.ACCESS_TOKEN&&Array.isArray(h)&&h.some(p=>ct(p)||Ot(p))&&this.queueRequest(Date.now(),a)}processRequests(h){if(this.pendingRequest||0===this.queue.length)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const a=Qn(nr.ACCESS_TOKEN),p=a?a.u:nr.ACCESS_TOKEN;let m=p!==this.eventData.tokenU;xe(this.anonId)||(this.anonId=ze(),m=!0);const w=this.queue.shift();if(this.eventData.lastSuccess){const M=new Date(this.eventData.lastSuccess),D=new Date(w),k=(w-this.eventData.lastSuccess)/864e5;m=m||k>=1||k<-1||M.getDate()!==D.getDate()}else m=!0;if(!m)return this.processRequests();this.postEvent(w,{"enabled.telemetry":!1},M=>{M||(this.eventData.lastSuccess=w,this.eventData.tokenU=p)},h)}},jn=Qt.postTurnstileEvent.bind(Qt),ar=new class extends Er{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(h,a,p,m){this.skuToken=a,this.errorCb=m,nr.EVENTS_URL&&(p||nr.ACCESS_TOKEN?this.queueRequest({id:h,timestamp:Date.now()},p):this.errorCb(new Error(Ie)))}processRequests(h){if(this.pendingRequest||0===this.queue.length)return;const{id:a,timestamp:p}=this.queue.shift();a&&this.success[a]||(this.anonId||this.fetchEventData(),xe(this.anonId)||(this.anonId=ze()),this.postEvent(p,{skuToken:this.skuToken},m=>{m?this.errorCb(m):a&&(this.success[a]=!0)},h))}},Vr=ar.postMapLoadEvent.bind(ar),ei=new class extends Er{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(h,a,p,m){if(!nr.API_URL||!nr.SESSION_PATH)return;const w=Yt(nr.API_URL+nr.SESSION_PATH);w.params.push(`sku=${a||""}`),w.params.push(`access_token=${m||nr.ACCESS_TOKEN||""}`);const M={url:wt(w),headers:{"Content-Type":"text/plain"}};this.pendingRequest=Ae(M,D=>{this.pendingRequest=null,p(D),this.saveEventData(),this.processRequests(m)})}getSessionAPI(h,a,p,m){this.skuToken=a,this.errorCb=m,nr.SESSION_PATH&&nr.API_URL&&(p||nr.ACCESS_TOKEN?this.queueRequest({id:h,timestamp:Date.now()},p):this.errorCb(new Error(Ie)))}processRequests(h){if(this.pendingRequest||0===this.queue.length)return;const{id:a,timestamp:p}=this.queue.shift();a&&this.success[a]||this.getSession(p,this.skuToken,m=>{m?this.errorCb(m):a&&(this.success[a]=!0)},h)}},So=ei.getSessionAPI.bind(ei),Mo=new Set,jo="mapbox-tiles";let fi,Xo,qi=500,fa=50;function fo(){It.caches&&!fi&&(fi=It.caches.open(jo))}function ln(h){const a=h.indexOf("?");return a<0?h:h.slice(0,a)}let al=1/0;const Fs={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(Fs);class yr extends Error{constructor(a,p,m){401===p&&Ot(m)&&(a+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),super(a),this.status=p,this.url=m}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const Bs=Ut()?()=>self.worker&&self.worker.referrer:()=>("blob:"===It.location.protocol?It.parent:It).location.href,Re=function(h,a){if(!(/^file:/.test(p=h.url)||/^file:/.test(Bs())&&!/^\w+:/.test(p))){if(It.fetch&&It.Request&&It.AbortController&&It.Request.prototype.hasOwnProperty("signal"))return function(m,w){const M=new It.AbortController,D=new It.Request(m.url,{method:m.method||"GET",body:m.body,credentials:m.credentials,headers:m.headers,referrer:Bs(),signal:M.signal});let k=!1,L=!1;const V=($=D.url).indexOf("sku=")>0&&Ot($);var $;"json"===m.type&&D.headers.set("Accept","application/json");const X=(J,ge,Le)=>{if(L)return;if(J&&"SecurityError"!==J.message&&Ke(J),ge&&Le)return K(ge);const Ze=Date.now();It.fetch(D).then(st=>{if(st.ok){const xt=V?st.clone():null;return K(st,xt,Ze)}return w(new yr(st.statusText,st.status,m.url))}).catch(st=>{20!==st.code&&w(new Error(st.message))})},K=(J,ge,Le)=>{("arrayBuffer"===m.type?J.arrayBuffer():"json"===m.type?J.json():J.text()).then(Ze=>{L||(ge&&Le&&function(st,xt,St){if(fo(),!fi)return;const Dt={status:xt.status,statusText:xt.statusText,headers:new It.Headers};xt.headers.forEach((Pt,tn)=>Dt.headers.set(tn,Pt));const Rt=Sn(xt.headers.get("Cache-Control")||"");Rt["no-store"]||(Rt["max-age"]&&Dt.headers.set("Expires",new Date(St+1e3*Rt["max-age"]).toUTCString()),new Date(Dt.headers.get("Expires")).getTime()-St<42e4||function(Pt,tn){if(void 0===Xo)try{new Response(new ReadableStream),Xo=!0}catch(dn){Xo=!1}Xo?tn(Pt.body):Pt.blob().then(tn)}(xt,Pt=>{const tn=new It.Response(Pt,Dt);fo(),fi&&fi.then(dn=>dn.put(ln(st.url),tn)).catch(dn=>Ke(dn.message))}))}(D,ge,Le),k=!0,w(null,Ze,J.headers.get("Cache-Control"),J.headers.get("Expires")))}).catch(Ze=>{L||w(new Error(Ze.message))})};return V?function(J,ge){if(fo(),!fi)return ge(null);const Le=ln(J.url);fi.then(Ze=>{Ze.match(Le).then(st=>{const xt=function(St){if(!St)return!1;const Dt=new Date(St.headers.get("Expires")||0),Rt=Sn(St.headers.get("Cache-Control")||"");return Dt>Date.now()&&!Rt["no-cache"]}(st);Ze.delete(Le),xt&&Ze.put(Le,st.clone()),ge(null,st,xt)}).catch(ge)}).catch(ge)}(D,X):X(null,null),{cancel:()=>{L=!0,k||M.abort()}}}(h,a);if(Ut()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",h,a,void 0,!0)}var p;return function(m,w){const M=new It.XMLHttpRequest;M.open(m.method||"GET",m.url,!0),"arrayBuffer"===m.type&&(M.responseType="arraybuffer");for(const D in m.headers)M.setRequestHeader(D,m.headers[D]);return"json"===m.type&&(M.responseType="text",M.setRequestHeader("Accept","application/json")),M.withCredentials="include"===m.credentials,M.onerror=()=>{w(new Error(M.statusText))},M.onload=()=>{if((M.status>=200&&M.status<300||0===M.status)&&null!==M.response){let D=M.response;if("json"===m.type)try{D=JSON.parse(M.response)}catch(k){return w(k)}w(null,D,M.getResponseHeader("Cache-Control"),M.getResponseHeader("Expires"))}else w(new yr(M.statusText,M.status,m.url))},M.send(m.body),{cancel:()=>M.abort()}}(h,a)},Q=function(h,a){return Re(be(h,{type:"arrayBuffer"}),a)},oe=function(h,a){return Re(be(h,{method:"POST"}),a)},Ae=function(h,a){return Re(be(h,{method:"GET"}),a)};function je(h){const a=It.document.createElement("a");return a.href=h,a.protocol===It.document.location.protocol&&a.host===It.document.location.host}const at="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let bt,Ct;bt=[],Ct=0;const ft=function(h,a){if(ai.supported&&(h.headers||(h.headers={}),h.headers.accept="image/webp,*/*"),Ct>=nr.MAX_PARALLEL_IMAGE_REQUESTS){const M={requestParameters:h,callback:a,cancelled:!1,cancel(){this.cancelled=!0}};return bt.push(M),M}Ct++;let p=!1;const m=()=>{if(!p)for(p=!0,Ct--;bt.length&&Ct<nr.MAX_PARALLEL_IMAGE_REQUESTS;){const M=bt.shift(),{requestParameters:D,callback:k,cancelled:L}=M;L||(M.cancel=ft(D,k).cancel)}},w=Q(h,(M,D,k,L)=>{m(),M?a(M):D&&(It.createImageBitmap?function(V,$){const X=new It.Blob([new Uint8Array(V)],{type:"image/png"});It.createImageBitmap(X).then(K=>{$(null,K)}).catch(K=>{$(new Error(`Could not load image because of ${K.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(D,(V,$)=>a(V,$,k,L)):function(V,$){const X=new It.Image,K=It.URL;X.onload=()=>{$(null,X),K.revokeObjectURL(X.src),X.onload=null,It.requestAnimationFrame(()=>{X.src=at})},X.onerror=()=>$(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const J=new It.Blob([new Uint8Array(V)],{type:"image/png"});X.src=V.byteLength?K.createObjectURL(J):at}(D,(V,$)=>a(V,$,k,L)))});return{cancel:()=>{w.cancel(),m()}}};function Et(h,a,p){p[h]&&-1!==p[h].indexOf(a)||(p[h]=p[h]||[],p[h].push(a))}function Nt(h,a,p){if(p&&p[h]){const m=p[h].indexOf(a);-1!==m&&p[h].splice(m,1)}}class fn{constructor(a,p={}){be(this,p),this.type=a}}class Wt extends fn{constructor(a,p={}){super("error",be({error:a},p))}}class bn{on(a,p){return this._listeners=this._listeners||{},Et(a,p,this._listeners),this}off(a,p){return Nt(a,p,this._listeners),Nt(a,p,this._oneTimeListeners),this}once(a,p){return p?(this._oneTimeListeners=this._oneTimeListeners||{},Et(a,p,this._oneTimeListeners),this):new Promise(m=>this.once(a,m))}fire(a,p){"string"==typeof a&&(a=new fn(a,p||{}));const m=a.type;if(this.listens(m)){a.target=this;const w=this._listeners&&this._listeners[m]?this._listeners[m].slice():[];for(const k of w)k.call(this,a);const M=this._oneTimeListeners&&this._oneTimeListeners[m]?this._oneTimeListeners[m].slice():[];for(const k of M)Nt(m,k,this._oneTimeListeners),k.call(this,a);const D=this._eventedParent;D&&(be(a,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),D.fire(a))}else a instanceof Wt&&console.error(a.error);return this}listens(a){return!!(this._listeners&&this._listeners[a]&&this._listeners[a].length>0||this._oneTimeListeners&&this._oneTimeListeners[a]&&this._oneTimeListeners[a].length>0||this._eventedParent&&this._eventedParent.listens(a))}setEventedParent(a,p){return this._eventedParent=a,this._eventedParentData=p,this}}var tt={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},fog:{type:"fog"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{},sky:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_sky:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},fog:{range:{type:"array",default:[.5,10],minimum:-20,maximum:20,length:2,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-blend":{type:"number","property-type":"data-constant",default:.1,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number","property-type":"data-constant",default:1,minimum:0,maximum:1e3,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_sky:{"sky-type":{type:"enum",values:{gradient:{},atmosphere:{}},default:"atmosphere",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{type:"array",value:"number",length:2,units:"degrees",minimum:[0,0],maximum:[360,180],transition:!1,requires:[{"sky-type":"atmosphere"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{type:"number",requires:[{"sky-type":"atmosphere"}],default:10,minimum:0,maximum:100,transition:!1,"property-type":"data-constant"},"sky-gradient-center":{type:"array",requires:[{"sky-type":"gradient"}],value:"number",default:[0,0],length:2,units:"degrees",minimum:[0,0],maximum:[360,180],transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{type:"number",requires:[{"sky-type":"gradient"}],default:90,minimum:0,maximum:180,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-gradient":{type:"color",default:["interpolate",["linear"],["sky-radial-progress"],.8,"#87ceeb",1,"white"],transition:!1,requires:[{"sky-type":"gradient"}],expression:{interpolated:!0,parameters:["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{type:"color",default:"white",transition:!1,requires:[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{type:"color",default:"white",transition:!1,requires:[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};class Vt{constructor(a,p,m,w){this.message=(a?`${a}: `:"")+m,w&&(this.identifier=w),null!=p&&p.__line__&&(this.line=p.__line__)}}function Wn(h){const a=h.value;return a?[new Vt(h.key,a,"constants have been deprecated as of v8")]:[]}function zr(h,...a){for(const p of a)for(const m in p)h[m]=p[m];return h}function lr(h){return h instanceof Number||h instanceof String||h instanceof Boolean?h.valueOf():h}function oi(h){if(Array.isArray(h))return h.map(oi);if(h instanceof Object&&!(h instanceof Number||h instanceof String||h instanceof Boolean)){const a={};for(const p in h)a[p]=oi(h[p]);return a}return lr(h)}class ir extends Error{constructor(a,p){super(p),this.message=p,this.key=a}}class vr{constructor(a,p=[]){this.parent=a,this.bindings={};for(const[m,w]of p)this.bindings[m]=w}concat(a){return new vr(this,a)}get(a){if(this.bindings[a])return this.bindings[a];if(this.parent)return this.parent.get(a);throw new Error(`${a} not found in scope.`)}has(a){return!!this.bindings[a]||!!this.parent&&this.parent.has(a)}}const ba={kind:"null"},gn={kind:"number"},Tr={kind:"string"},Xn={kind:"boolean"},wa={kind:"color"},po={kind:"object"},Rn={kind:"value"},Js={kind:"collator"},Nr={kind:"formatted"},Gl={kind:"resolvedImage"};function Ea(h,a){return{kind:"array",itemType:h,N:a}}function _r(h){if("array"===h.kind){const a=_r(h.itemType);return"number"==typeof h.N?`array<${a}, ${h.N}>`:"value"===h.itemType.kind?"array":`array<${a}>`}return h.kind}const Ln=[ba,gn,Tr,Xn,wa,Nr,po,Ea(Rn),Gl];function wu(h,a){if("error"===a.kind)return null;if("array"===h.kind){if("array"===a.kind&&(0===a.N&&"value"===a.itemType.kind||!wu(h.itemType,a.itemType))&&("number"!=typeof h.N||h.N===a.N))return null}else{if(h.kind===a.kind)return null;if("value"===h.kind)for(const p of Ln)if(!wu(p,a))return null}return`Expected ${_r(h)} but found ${_r(a)} instead.`}function $l(h,a){return a.some(p=>p.kind===h.kind)}function Qs(h,a){return a.some(p=>"null"===p?null===h:"array"===p?Array.isArray(h):"object"===p?h&&!Array.isArray(h)&&"object"==typeof h:p===typeof h)}function pd(h){var a={exports:{}};return h(a,a.exports),a.exports}var Or=pd(function(h,a){var p={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function m(k){return(k=Math.round(k))<0?0:k>255?255:k}function w(k){return m("%"===k[k.length-1]?parseFloat(k)/100*255:parseInt(k))}function M(k){return(L="%"===k[k.length-1]?parseFloat(k)/100:parseFloat(k))<0?0:L>1?1:L;var L}function D(k,L,V){return V<0?V+=1:V>1&&(V-=1),6*V<1?k+(L-k)*V*6:2*V<1?L:3*V<2?k+(L-k)*(2/3-V)*6:k}try{a.parseCSSColor=function(k){var L,V=k.replace(/ /g,"").toLowerCase();if(V in p)return p[V].slice();if("#"===V[0])return 4===V.length?(L=parseInt(V.substr(1),16))>=0&&L<=4095?[(3840&L)>>4|(3840&L)>>8,240&L|(240&L)>>4,15&L|(15&L)<<4,1]:null:7===V.length&&(L=parseInt(V.substr(1),16))>=0&&L<=16777215?[(16711680&L)>>16,(65280&L)>>8,255&L,1]:null;var $=V.indexOf("("),X=V.indexOf(")");if(-1!==$&&X+1===V.length){var K=V.substr(0,$),J=V.substr($+1,X-($+1)).split(","),ge=1;switch(K){case"rgba":if(4!==J.length)return null;ge=M(J.pop());case"rgb":return 3!==J.length?null:[w(J[0]),w(J[1]),w(J[2]),ge];case"hsla":if(4!==J.length)return null;ge=M(J.pop());case"hsl":if(3!==J.length)return null;var Le=(parseFloat(J[0])%360+360)%360/360,Ze=M(J[1]),st=M(J[2]),xt=st<=.5?st*(Ze+1):st+Ze-st*Ze,St=2*st-xt;return[m(255*D(St,xt,Le+1/3)),m(255*D(St,xt,Le)),m(255*D(St,xt,Le-1/3)),ge];default:return null}}return null}}catch(k){}});class Nn{constructor(a,p,m,w=1){this.r=a,this.g=p,this.b=m,this.a=w}static parse(a){if(!a)return;if(a instanceof Nn)return a;if("string"!=typeof a)return;const p=Or.parseCSSColor(a);return p?new Nn(p[0]/255*p[3],p[1]/255*p[3],p[2]/255*p[3],p[3]):void 0}toString(){const[a,p,m,w]=this.toArray();return`rgba(${Math.round(a)},${Math.round(p)},${Math.round(m)},${w})`}toArray(){const{r:a,g:p,b:m,a:w}=this;return 0===w?[0,0,0,0]:[255*a/w,255*p/w,255*m/w,w]}}Nn.black=new Nn(0,0,0,1),Nn.white=new Nn(1,1,1,1),Nn.transparent=new Nn(0,0,0,0),Nn.red=new Nn(1,0,0,1),Nn.blue=new Nn(0,0,1,1);class go{constructor(a,p,m){this.sensitivity=a?p?"variant":"case":p?"accent":"base",this.locale=m,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(a,p){return this.collator.compare(a,p)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Gu{constructor(a,p,m,w,M){this.text=a,this.image=p,this.scale=m,this.fontStack=w,this.textColor=M}}class fr{constructor(a){this.sections=a}static fromString(a){return new fr([new Gu(a,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some(a=>0!==a.text.length||a.image&&0!==a.image.name.length)}static factory(a){return a instanceof fr?a:fr.fromString(a)}toString(){return 0===this.sections.length?"":this.sections.map(a=>a.text).join("")}serialize(){const a=["format"];for(const p of this.sections){if(p.image){a.push(["image",p.image.name]);continue}a.push(p.text);const m={};p.fontStack&&(m["text-font"]=["literal",p.fontStack.split(",")]),p.scale&&(m["font-scale"]=p.scale),p.textColor&&(m["text-color"]=["rgba"].concat(p.textColor.toArray())),a.push(m)}return a}}class Hl{constructor(a){this.name=a.name,this.available=a.available}toString(){return this.name}static fromString(a){return a?new Hl({name:a,available:!1}):null}serialize(){return["image",this.name]}}function Oh(h,a,p,m){return"number"==typeof h&&h>=0&&h<=255&&"number"==typeof a&&a>=0&&a<=255&&"number"==typeof p&&p>=0&&p<=255?void 0===m||"number"==typeof m&&m>=0&&m<=1?null:`Invalid rgba value [${[h,a,p,m].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof m?[h,a,p,m]:[h,a,p]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function ea(h){if(null===h||"string"==typeof h||"boolean"==typeof h||"number"==typeof h||h instanceof Nn||h instanceof go||h instanceof fr||h instanceof Hl)return!0;if(Array.isArray(h)){for(const a of h)if(!ea(a))return!1;return!0}if("object"==typeof h){for(const a in h)if(!ea(h[a]))return!1;return!0}return!1}function to(h){if(null===h)return ba;if("string"==typeof h)return Tr;if("boolean"==typeof h)return Xn;if("number"==typeof h)return gn;if(h instanceof Nn)return wa;if(h instanceof go)return Js;if(h instanceof fr)return Nr;if(h instanceof Hl)return Gl;if(Array.isArray(h)){const a=h.length;let p;for(const m of h){const w=to(m);if(p){if(p===w)continue;p=Rn;break}p=w}return Ea(p||Rn,a)}return po}function za(h){const a=typeof h;return null===h?"":"string"===a||"number"===a||"boolean"===a?String(h):h instanceof Nn||h instanceof fr||h instanceof Hl?h.toString():JSON.stringify(h)}class fc{constructor(a,p){this.type=a,this.value=p}static parse(a,p){if(2!==a.length)return p.error(`'literal' expression requires exactly one argument, but found ${a.length-1} instead.`);if(!ea(a[1]))return p.error("invalid value");const m=a[1];let w=to(m);const M=p.expectedType;return"array"!==w.kind||0!==w.N||!M||"array"!==M.kind||"number"==typeof M.N&&0!==M.N||(w=M),new fc(w,m)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof Nn?["rgba"].concat(this.value.toArray()):this.value instanceof fr?this.value.serialize():this.value}}class mo{constructor(a){this.name="ExpressionEvaluationError",this.message=a}toJSON(){return this.message}}const mn={string:Tr,number:gn,boolean:Xn,object:po};class xl{constructor(a,p){this.type=a,this.args=p}static parse(a,p){if(a.length<2)return p.error("Expected at least one argument.");let m,w=1;const M=a[0];if("array"===M){let k,L;if(a.length>2){const V=a[1];if("string"!=typeof V||!(V in mn)||"object"===V)return p.error('The item type argument of "array" must be one of string, number, boolean',1);k=mn[V],w++}else k=Rn;if(a.length>3){if(null!==a[2]&&("number"!=typeof a[2]||a[2]<0||a[2]!==Math.floor(a[2])))return p.error('The length argument to "array" must be a positive integer literal',2);L=a[2],w++}m=Ea(k,L)}else m=mn[M];const D=[];for(;w<a.length;w++){const k=p.parse(a[w],w,Rn);if(!k)return null;D.push(k)}return new xl(m,D)}evaluate(a){for(let p=0;p<this.args.length;p++){const m=this.args[p].evaluate(a);if(!wu(this.type,to(m)))return m;if(p===this.args.length-1)throw new mo(`Expected value to be of type ${_r(this.type)}, but found ${_r(to(m))} instead.`)}return null}eachChild(a){this.args.forEach(a)}outputDefined(){return this.args.every(a=>a.outputDefined())}serialize(){const a=this.type,p=[a.kind];if("array"===a.kind){const m=a.itemType;if("string"===m.kind||"number"===m.kind||"boolean"===m.kind){p.push(m.kind);const w=a.N;("number"==typeof w||this.args.length>1)&&p.push(w)}}return p.concat(this.args.map(m=>m.serialize()))}}class Za{constructor(a){this.type=Nr,this.sections=a}static parse(a,p){if(a.length<2)return p.error("Expected at least one argument.");const m=a[1];if(!Array.isArray(m)&&"object"==typeof m)return p.error("First argument must be an image or text section.");const w=[];let M=!1;for(let D=1;D<=a.length-1;++D){const k=a[D];if(M&&"object"==typeof k&&!Array.isArray(k)){M=!1;let L=null;if(k["font-scale"]&&(L=p.parse(k["font-scale"],1,gn),!L))return null;let V=null;if(k["text-font"]&&(V=p.parse(k["text-font"],1,Ea(Tr)),!V))return null;let $=null;if(k["text-color"]&&($=p.parse(k["text-color"],1,wa),!$))return null;const X=w[w.length-1];X.scale=L,X.font=V,X.textColor=$}else{const L=p.parse(a[D],1,Rn);if(!L)return null;const V=L.type.kind;if("string"!==V&&"value"!==V&&"null"!==V&&"resolvedImage"!==V)return p.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");M=!0,w.push({content:L,scale:null,font:null,textColor:null})}}return new Za(w)}evaluate(a){return new fr(this.sections.map(p=>{const m=p.content.evaluate(a);return to(m)===Gl?new Gu("",m,null,null,null):new Gu(za(m),null,p.scale?p.scale.evaluate(a):null,p.font?p.font.evaluate(a).join(","):null,p.textColor?p.textColor.evaluate(a):null)}))}eachChild(a){for(const p of this.sections)a(p.content),p.scale&&a(p.scale),p.font&&a(p.font),p.textColor&&a(p.textColor)}outputDefined(){return!1}serialize(){const a=["format"];for(const p of this.sections){a.push(p.content.serialize());const m={};p.scale&&(m["font-scale"]=p.scale.serialize()),p.font&&(m["text-font"]=p.font.serialize()),p.textColor&&(m["text-color"]=p.textColor.serialize()),a.push(m)}return a}}class ql{constructor(a){this.type=Gl,this.input=a}static parse(a,p){if(2!==a.length)return p.error("Expected two arguments.");const m=p.parse(a[1],1,Tr);return m?new ql(m):p.error("No image name provided.")}evaluate(a){const p=this.input.evaluate(a),m=Hl.fromString(p);return m&&a.availableImages&&(m.available=a.availableImages.indexOf(p)>-1),m}eachChild(a){a(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const gd={"to-boolean":Xn,"to-color":wa,"to-number":gn,"to-string":Tr};class os{constructor(a,p){this.type=a,this.args=p}static parse(a,p){if(a.length<2)return p.error("Expected at least one argument.");const m=a[0];if(("to-boolean"===m||"to-string"===m)&&2!==a.length)return p.error("Expected one argument.");const w=gd[m],M=[];for(let D=1;D<a.length;D++){const k=p.parse(a[D],D,Rn);if(!k)return null;M.push(k)}return new os(w,M)}evaluate(a){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(a));if("color"===this.type.kind){let p,m;for(const w of this.args){if(p=w.evaluate(a),m=null,p instanceof Nn)return p;if("string"==typeof p){const M=a.parseColor(p);if(M)return M}else if(Array.isArray(p)&&(m=p.length<3||p.length>4?`Invalid rbga value ${JSON.stringify(p)}: expected an array containing either three or four numeric values.`:Oh(p[0],p[1],p[2],p[3]),!m))return new Nn(p[0]/255,p[1]/255,p[2]/255,p[3])}throw new mo(m||`Could not parse color from value '${"string"==typeof p?p:String(JSON.stringify(p))}'`)}if("number"===this.type.kind){let p=null;for(const m of this.args){if(p=m.evaluate(a),null===p)return 0;const w=Number(p);if(!isNaN(w))return w}throw new mo(`Could not convert ${JSON.stringify(p)} to number.`)}return"formatted"===this.type.kind?fr.fromString(za(this.args[0].evaluate(a))):"resolvedImage"===this.type.kind?Hl.fromString(za(this.args[0].evaluate(a))):za(this.args[0].evaluate(a))}eachChild(a){this.args.forEach(a)}outputDefined(){return this.args.every(a=>a.outputDefined())}serialize(){if("formatted"===this.type.kind)return new Za([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new ql(this.args[0]).serialize();const a=[`to-${this.type.kind}`];return this.eachChild(p=>{a.push(p.serialize())}),a}}const no=["Unknown","Point","LineString","Polygon"];class li{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?no[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(a){let p=this._parseColorCache[a];return p||(p=this._parseColorCache[a]=Nn.parse(a)),p}}class Pr{constructor(a,p,m,w){this.name=a,this.type=p,this._evaluate=m,this.args=w}evaluate(a){return this._evaluate(a,this.args)}eachChild(a){this.args.forEach(a)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(a=>a.serialize()))}static parse(a,p){const m=a[0],w=Pr.definitions[m];if(!w)return p.error(`Unknown expression "${m}". If you wanted a literal array, use ["literal", [...]].`,0);const M=Array.isArray(w)?w[0]:w.type,D=Array.isArray(w)?[[w[1],w[2]]]:w.overloads,k=D.filter(([V])=>!Array.isArray(V)||V.length===a.length-1);let L=null;for(const[V,$]of k){L=new ll(p.registry,p.path,null,p.scope);const X=[];let K=!1;for(let J=1;J<a.length;J++){const ge=a[J],Le=Array.isArray(V)?V[J-1]:V.type,Ze=L.parse(ge,1+X.length,Le);if(!Ze){K=!0;break}X.push(Ze)}if(!K)if(Array.isArray(V)&&V.length!==X.length)L.error(`Expected ${V.length} arguments, but found ${X.length} instead.`);else{for(let J=0;J<X.length;J++){const ge=Array.isArray(V)?V[J]:V.type,Le=X[J];L.concat(J+1).checkSubtype(ge,Le.type)}if(0===L.errors.length)return new Pr(m,M,$,X)}}if(1===k.length)p.errors.push(...L.errors);else{const V=(k.length?k:D).map(([X])=>{return K=X,Array.isArray(K)?`(${K.map(_r).join(", ")})`:`(${_r(K.type)}...)`;var K}).join(" | "),$=[];for(let X=1;X<a.length;X++){const K=p.parse(a[X],1+$.length);if(!K)return null;$.push(_r(K.type))}p.error(`Expected arguments of type ${V}, but found (${$.join(", ")}) instead.`)}return null}static register(a,p){Pr.definitions=p;for(const m in p)a[m]=Pr}}class To{constructor(a,p,m){this.type=Js,this.locale=m,this.caseSensitive=a,this.diacriticSensitive=p}static parse(a,p){if(2!==a.length)return p.error("Expected one argument.");const m=a[1];if("object"!=typeof m||Array.isArray(m))return p.error("Collator options argument must be an object.");const w=p.parse(void 0!==m["case-sensitive"]&&m["case-sensitive"],1,Xn);if(!w)return null;const M=p.parse(void 0!==m["diacritic-sensitive"]&&m["diacritic-sensitive"],1,Xn);if(!M)return null;let D=null;return m.locale&&(D=p.parse(m.locale,1,Tr),!D)?null:new To(w,M,D)}evaluate(a){return new go(this.caseSensitive.evaluate(a),this.diacriticSensitive.evaluate(a),this.locale?this.locale.evaluate(a):null)}eachChild(a){a(this.caseSensitive),a(this.diacriticSensitive),this.locale&&a(this.locale)}outputDefined(){return!1}serialize(){const a={};return a["case-sensitive"]=this.caseSensitive.serialize(),a["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(a.locale=this.locale.serialize()),["collator",a]}}const Ic=8192;function Va(h,a){h[0]=Math.min(h[0],a[0]),h[1]=Math.min(h[1],a[1]),h[2]=Math.max(h[2],a[0]),h[3]=Math.max(h[3],a[1])}function Xc(h,a){return!(h[0]<=a[0]||h[2]>=a[2]||h[1]<=a[1]||h[3]>=a[3])}function Dn(h,a){const p=(180+h[0])/360,m=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+h[1]*Math.PI/360)))/360,w=Math.pow(2,a.z);return[Math.round(p*w*Ic),Math.round(m*w*Ic)]}function Wi(h,a,p){const m=h[0]-a[0],w=h[1]-a[1],M=h[0]-p[0],D=h[1]-p[1];return m*D-M*w==0&&m*M<=0&&w*D<=0}function Gr(h,a){let p=!1;for(let D=0,k=a.length;D<k;D++){const L=a[D];for(let V=0,$=L.length;V<$-1;V++){if(Wi(h,L[V],L[V+1]))return!1;(w=L[V])[1]>(m=h)[1]!=(M=L[V+1])[1]>m[1]&&m[0]<(M[0]-w[0])*(m[1]-w[1])/(M[1]-w[1])+w[0]&&(p=!p)}}var m,w,M;return p}function so(h,a){for(let p=0;p<a.length;p++)if(Gr(h,a[p]))return!0;return!1}function kh(h,a,p,m){const w=m[0]-p[0],M=m[1]-p[1],D=(h[0]-p[0])*M-w*(h[1]-p[1]),k=(a[0]-p[0])*M-w*(a[1]-p[1]);return D>0&&k<0||D<0&&k>0}function Yc(h,a,p){for(const V of p)for(let $=0;$<V.length-1;++$)if((k=[(D=V[$+1])[0]-(M=V[$])[0],D[1]-M[1]])[0]*(L=[(w=a)[0]-(m=h)[0],w[1]-m[1]])[1]-k[1]*L[0]!=0&&kh(m,w,M,D)&&kh(M,D,m,w))return!0;var m,w,M,D,k,L;return!1}function Do(h,a){for(let p=0;p<h.length;++p)if(!Gr(h[p],a))return!1;for(let p=0;p<h.length-1;++p)if(Yc(h[p],h[p+1],a))return!1;return!0}function Ca(h,a){for(let p=0;p<a.length;p++)if(Do(h,a[p]))return!0;return!1}function zs(h,a,p){const m=[];for(let w=0;w<h.length;w++){const M=[];for(let D=0;D<h[w].length;D++){const k=Dn(h[w][D],p);Va(a,k),M.push(k)}m.push(M)}return m}function Sa(h,a,p){const m=[];for(let w=0;w<h.length;w++){const M=zs(h[w],a,p);m.push(M)}return m}function bl(h,a,p,m){if(h[0]<p[0]||h[0]>p[2]){const w=.5*m;let M=h[0]-p[0]>w?-m:p[0]-h[0]>w?m:0;0===M&&(M=h[0]-p[2]>w?-m:p[2]-h[0]>w?m:0),h[0]+=M}Va(a,h)}function wl(h,a,p,m){const w=Math.pow(2,m.z)*Ic,M=[m.x*Ic,m.y*Ic],D=[];for(const k of h)for(const L of k){const V=[L.x+M[0],L.y+M[1]];bl(V,a,p,w),D.push(V)}return D}function or(h,a,p,m){const w=Math.pow(2,m.z)*Ic,M=[m.x*Ic,m.y*Ic],D=[];for(const L of h){const V=[];for(const $ of L){const X=[$.x+M[0],$.y+M[1]];Va(a,X),V.push(X)}D.push(V)}if(a[2]-a[0]<=w/2){(k=a)[0]=k[1]=1/0,k[2]=k[3]=-1/0;for(const L of D)for(const V of L)bl(V,a,p,w)}var k;return D}class Xi{constructor(a,p){this.type=Xn,this.geojson=a,this.geometries=p}static parse(a,p){if(2!==a.length)return p.error(`'within' expression requires exactly one argument, but found ${a.length-1} instead.`);if(ea(a[1])){const m=a[1];if("FeatureCollection"===m.type)for(let w=0;w<m.features.length;++w){const M=m.features[w].geometry.type;if("Polygon"===M||"MultiPolygon"===M)return new Xi(m,m.features[w].geometry)}else if("Feature"===m.type){const w=m.geometry.type;if("Polygon"===w||"MultiPolygon"===w)return new Xi(m,m.geometry)}else if("Polygon"===m.type||"MultiPolygon"===m.type)return new Xi(m,m)}return p.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(a){if(null!=a.geometry()&&null!=a.canonicalID()){if("Point"===a.geometryType())return function(p,m){const w=[1/0,1/0,-1/0,-1/0],M=[1/0,1/0,-1/0,-1/0],D=p.canonicalID();if("Polygon"===m.type){const k=zs(m.coordinates,M,D),L=wl(p.geometry(),w,M,D);if(!Xc(w,M))return!1;for(const V of L)if(!Gr(V,k))return!1}if("MultiPolygon"===m.type){const k=Sa(m.coordinates,M,D),L=wl(p.geometry(),w,M,D);if(!Xc(w,M))return!1;for(const V of L)if(!so(V,k))return!1}return!0}(a,this.geometries);if("LineString"===a.geometryType())return function(p,m){const w=[1/0,1/0,-1/0,-1/0],M=[1/0,1/0,-1/0,-1/0],D=p.canonicalID();if("Polygon"===m.type){const k=zs(m.coordinates,M,D),L=or(p.geometry(),w,M,D);if(!Xc(w,M))return!1;for(const V of L)if(!Do(V,k))return!1}if("MultiPolygon"===m.type){const k=Sa(m.coordinates,M,D),L=or(p.geometry(),w,M,D);if(!Xc(w,M))return!1;for(const V of L)if(!Ca(V,k))return!1}return!0}(a,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}function Zc(h){if(h instanceof Pr&&("get"===h.name&&1===h.args.length||"feature-state"===h.name||"has"===h.name&&1===h.args.length||"properties"===h.name||"geometry-type"===h.name||"id"===h.name||/^filter-/.test(h.name))||h instanceof Xi)return!1;let a=!0;return h.eachChild(p=>{a&&!Zc(p)&&(a=!1)}),a}function ss(h){if(h instanceof Pr&&"feature-state"===h.name)return!1;let a=!0;return h.eachChild(p=>{a&&!ss(p)&&(a=!1)}),a}function ur(h,a){if(h instanceof Pr&&a.indexOf(h.name)>=0)return!1;let p=!0;return h.eachChild(m=>{p&&!ur(m,a)&&(p=!1)}),p}class hs{constructor(a,p){this.type=p.type,this.name=a,this.boundExpression=p}static parse(a,p){if(2!==a.length||"string"!=typeof a[1])return p.error("'var' expression requires exactly one string literal argument.");const m=a[1];return p.scope.has(m)?new hs(m,p.scope.get(m)):p.error(`Unknown variable "${m}". Make sure "${m}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(a){return this.boundExpression.evaluate(a)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class ll{constructor(a,p=[],m,w=new vr,M=[]){this.registry=a,this.path=p,this.key=p.map(D=>`[${D}]`).join(""),this.scope=w,this.errors=M,this.expectedType=m}parse(a,p,m,w,M={}){return p?this.concat(p,m,w)._parse(a,M):this._parse(a,M)}_parse(a,p){function m(w,M,D){return"assert"===D?new xl(M,[w]):"coerce"===D?new os(M,[w]):w}if(null!==a&&"string"!=typeof a&&"boolean"!=typeof a&&"number"!=typeof a||(a=["literal",a]),Array.isArray(a)){if(0===a.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const w=a[0];if("string"!=typeof w)return this.error(`Expression name must be a string, but found ${typeof w} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const M=this.registry[w];if(M){let D=M.parse(a,this);if(!D)return null;if(this.expectedType){const k=this.expectedType,L=D.type;if("string"!==k.kind&&"number"!==k.kind&&"boolean"!==k.kind&&"object"!==k.kind&&"array"!==k.kind||"value"!==L.kind)if("color"!==k.kind&&"formatted"!==k.kind&&"resolvedImage"!==k.kind||"value"!==L.kind&&"string"!==L.kind){if(this.checkSubtype(k,L))return null}else D=m(D,k,p.typeAnnotation||"coerce");else D=m(D,k,p.typeAnnotation||"assert")}if(!(D instanceof fc)&&"resolvedImage"!==D.type.kind&&ul(D)){const k=new li;try{D=new fc(D.type,D.evaluate(k))}catch(L){return this.error(L.message),null}}return D}return this.error(`Unknown expression "${w}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(void 0===a?"'undefined' value invalid. Use null instead.":"object"==typeof a?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof a} instead.`)}concat(a,p,m){const w="number"==typeof a?this.path.concat(a):this.path,M=m?this.scope.concat(m):this.scope;return new ll(this.registry,w,p||null,M,this.errors)}error(a,...p){const m=`${this.key}${p.map(w=>`[${w}]`).join("")}`;this.errors.push(new ir(m,a))}checkSubtype(a,p){const m=wu(a,p);return m&&this.error(m),m}}function ul(h){if(h instanceof hs)return ul(h.boundExpression);if(h instanceof Pr&&"error"===h.name||h instanceof To||h instanceof Xi)return!1;const a=h instanceof os||h instanceof xl;let p=!0;return h.eachChild(m=>{p=a?p&&ul(m):p&&m instanceof fc}),!!p&&Zc(h)&&ur(h,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script"])}function $u(h,a){const p=h.length-1;let m,w,M=0,D=p,k=0;for(;M<=D;)if(k=Math.floor((M+D)/2),m=h[k],w=h[k+1],m<=a){if(k===p||a<w)return k;M=k+1}else{if(!(m>a))throw new mo("Input is not a number.");D=k-1}return 0}class Lh{constructor(a,p,m){this.type=a,this.input=p,this.labels=[],this.outputs=[];for(const[w,M]of m)this.labels.push(w),this.outputs.push(M)}static parse(a,p){if(a.length-1<4)return p.error(`Expected at least 4 arguments, but found only ${a.length-1}.`);if((a.length-1)%2!=0)return p.error("Expected an even number of arguments.");const m=p.parse(a[1],1,gn);if(!m)return null;const w=[];let M=null;p.expectedType&&"value"!==p.expectedType.kind&&(M=p.expectedType);for(let D=1;D<a.length;D+=2){const k=1===D?-1/0:a[D],L=a[D+1],V=D,$=D+1;if("number"!=typeof k)return p.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',V);if(w.length&&w[w.length-1][0]>=k)return p.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',V);const X=p.parse(L,$,M);if(!X)return null;M=M||X.type,w.push([k,X])}return new Lh(M,m,w)}evaluate(a){const p=this.labels,m=this.outputs;if(1===p.length)return m[0].evaluate(a);const w=this.input.evaluate(a);if(w<=p[0])return m[0].evaluate(a);const M=p.length;return w>=p[M-1]?m[M-1].evaluate(a):m[$u(p,w)].evaluate(a)}eachChild(a){a(this.input);for(const p of this.outputs)a(p)}outputDefined(){return this.outputs.every(a=>a.outputDefined())}serialize(){const a=["step",this.input.serialize()];for(let p=0;p<this.labels.length;p++)p>0&&a.push(this.labels[p]),a.push(this.outputs[p].serialize());return a}}function xr(h,a,p){return h*(1-p)+a*p}var Ts=Object.freeze({__proto__:null,number:xr,color:function(h,a,p){return new Nn(xr(h.r,a.r,p),xr(h.g,a.g,p),xr(h.b,a.b,p),xr(h.a,a.a,p))},array:function(h,a,p){return h.map((m,w)=>xr(m,a[w],p))}});const pc=4/29,jr=6/29,Kc=3*jr*jr,as=Math.PI/180,Yn=180/Math.PI;function ro(h){return h>.008856451679035631?Math.pow(h,1/3):h/Kc+pc}function au(h){return h>jr?h*h*h:Kc*(h-pc)}function Ds(h){return 255*(h<=.0031308?12.92*h:1.055*Math.pow(h,1/2.4)-.055)}function Ma(h){return(h/=255)<=.04045?h/12.92:Math.pow((h+.055)/1.055,2.4)}function lu(h){const a=Ma(h.r),p=Ma(h.g),m=Ma(h.b),w=ro((.4124564*a+.3575761*p+.1804375*m)/.95047),M=ro((.2126729*a+.7151522*p+.072175*m)/1);return{l:116*M-16,a:500*(w-M),b:200*(M-ro((.0193339*a+.119192*p+.9503041*m)/1.08883)),alpha:h.a}}function Jc(h){let a=(h.l+16)/116,p=isNaN(h.a)?a:a+h.a/500,m=isNaN(h.b)?a:a-h.b/200;return a=1*au(a),p=.95047*au(p),m=1.08883*au(m),new Nn(Ds(3.2404542*p-1.5371385*a-.4985314*m),Ds(-.969266*p+1.8760108*a+.041556*m),Ds(.0556434*p-.2040259*a+1.0572252*m),h.alpha)}function Xl(h,a,p){const m=a-h;return h+p*(m>180||m<-180?m-360*Math.round(m/360):m)}const uu={forward:lu,reverse:Jc,interpolate:function(h,a,p){return{l:xr(h.l,a.l,p),a:xr(h.a,a.a,p),b:xr(h.b,a.b,p),alpha:xr(h.alpha,a.alpha,p)}}},Yr={forward:function(h){const{l:a,a:p,b:m}=lu(h),w=Math.atan2(m,p)*Yn;return{h:w<0?w+360:w,c:Math.sqrt(p*p+m*m),l:a,alpha:h.a}},reverse:function(h){const a=h.h*as,p=h.c;return Jc({l:h.l,a:Math.cos(a)*p,b:Math.sin(a)*p,alpha:h.alpha})},interpolate:function(h,a,p){return{h:Xl(h.h,a.h,p),c:xr(h.c,a.c,p),l:xr(h.l,a.l,p),alpha:xr(h.alpha,a.alpha,p)}}};var ao=Object.freeze({__proto__:null,lab:uu,hcl:Yr});class ii{constructor(a,p,m,w,M){this.type=a,this.operator=p,this.interpolation=m,this.input=w,this.labels=[],this.outputs=[];for(const[D,k]of M)this.labels.push(D),this.outputs.push(k)}static interpolationFactor(a,p,m,w){let M=0;if("exponential"===a.name)M=gc(p,a.base,m,w);else if("linear"===a.name)M=gc(p,1,m,w);else if("cubic-bezier"===a.name){const D=a.controlPoints;M=new qe(D[0],D[1],D[2],D[3]).solve(gc(p,1,m,w))}return M}static parse(a,p){let[m,w,M,...D]=a;if(!Array.isArray(w)||0===w.length)return p.error("Expected an interpolation type expression.",1);if("linear"===w[0])w={name:"linear"};else if("exponential"===w[0]){const V=w[1];if("number"!=typeof V)return p.error("Exponential interpolation requires a numeric base.",1,1);w={name:"exponential",base:V}}else{if("cubic-bezier"!==w[0])return p.error(`Unknown interpolation type ${String(w[0])}`,1,0);{const V=w.slice(1);if(4!==V.length||V.some($=>"number"!=typeof $||$<0||$>1))return p.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);w={name:"cubic-bezier",controlPoints:V}}}if(a.length-1<4)return p.error(`Expected at least 4 arguments, but found only ${a.length-1}.`);if((a.length-1)%2!=0)return p.error("Expected an even number of arguments.");if(M=p.parse(M,2,gn),!M)return null;const k=[];let L=null;"interpolate-hcl"===m||"interpolate-lab"===m?L=wa:p.expectedType&&"value"!==p.expectedType.kind&&(L=p.expectedType);for(let V=0;V<D.length;V+=2){const $=D[V],X=D[V+1],K=V+3,J=V+4;if("number"!=typeof $)return p.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',K);if(k.length&&k[k.length-1][0]>=$)return p.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',K);const ge=p.parse(X,J,L);if(!ge)return null;L=L||ge.type,k.push([$,ge])}return"number"===L.kind||"color"===L.kind||"array"===L.kind&&"number"===L.itemType.kind&&"number"==typeof L.N?new ii(L,m,w,M,k):p.error(`Type ${_r(L)} is not interpolatable.`)}evaluate(a){const p=this.labels,m=this.outputs;if(1===p.length)return m[0].evaluate(a);const w=this.input.evaluate(a);if(w<=p[0])return m[0].evaluate(a);const M=p.length;if(w>=p[M-1])return m[M-1].evaluate(a);const D=$u(p,w),k=ii.interpolationFactor(this.interpolation,w,p[D],p[D+1]),L=m[D].evaluate(a),V=m[D+1].evaluate(a);return"interpolate"===this.operator?Ts[this.type.kind.toLowerCase()](L,V,k):"interpolate-hcl"===this.operator?Yr.reverse(Yr.interpolate(Yr.forward(L),Yr.forward(V),k)):uu.reverse(uu.interpolate(uu.forward(L),uu.forward(V),k))}eachChild(a){a(this.input);for(const p of this.outputs)a(p)}outputDefined(){return this.outputs.every(a=>a.outputDefined())}serialize(){let a;a="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const p=[this.operator,a,this.input.serialize()];for(let m=0;m<this.labels.length;m++)p.push(this.labels[m],this.outputs[m].serialize());return p}}function gc(h,a,p,m){const w=m-p,M=h-p;return 0===w?0:1===a?M/w:(Math.pow(a,M)-1)/(Math.pow(a,w)-1)}class ta{constructor(a,p){this.type=a,this.args=p}static parse(a,p){if(a.length<2)return p.error("Expectected at least one argument.");let m=null;const w=p.expectedType;w&&"value"!==w.kind&&(m=w);const M=[];for(const k of a.slice(1)){const L=p.parse(k,1+M.length,m,void 0,{typeAnnotation:"omit"});if(!L)return null;m=m||L.type,M.push(L)}const D=w&&M.some(k=>wu(w,k.type));return new ta(D?Rn:m,M)}evaluate(a){let p,m=null,w=0;for(const M of this.args)if(w++,m=M.evaluate(a),m&&m instanceof Hl&&!m.available&&(p||(p=m.name),m=null,w===this.args.length&&(m=p)),null!==m)break;return m}eachChild(a){this.args.forEach(a)}outputDefined(){return this.args.every(a=>a.outputDefined())}serialize(){const a=["coalesce"];return this.eachChild(p=>{a.push(p.serialize())}),a}}class Ac{constructor(a,p){this.type=p.type,this.bindings=[].concat(a),this.result=p}evaluate(a){return this.result.evaluate(a)}eachChild(a){for(const p of this.bindings)a(p[1]);a(this.result)}static parse(a,p){if(a.length<4)return p.error(`Expected at least 3 arguments, but found ${a.length-1} instead.`);const m=[];for(let M=1;M<a.length-1;M+=2){const D=a[M];if("string"!=typeof D)return p.error(`Expected string, but found ${typeof D} instead.`,M);if(/[^a-zA-Z0-9_]/.test(D))return p.error("Variable names must contain only alphanumeric characters or '_'.",M);const k=p.parse(a[M+1],M+1);if(!k)return null;m.push([D,k])}const w=p.parse(a[a.length-1],a.length-1,p.expectedType,m);return w?new Ac(m,w):null}outputDefined(){return this.result.outputDefined()}serialize(){const a=["let"];for(const[p,m]of this.bindings)a.push(p,m.serialize());return a.push(this.result.serialize()),a}}class Gn{constructor(a,p,m){this.type=a,this.index=p,this.input=m}static parse(a,p){if(3!==a.length)return p.error(`Expected 2 arguments, but found ${a.length-1} instead.`);const m=p.parse(a[1],1,gn),w=p.parse(a[2],2,Ea(p.expectedType||Rn));return m&&w?new Gn(w.type.itemType,m,w):null}evaluate(a){const p=this.index.evaluate(a),m=this.input.evaluate(a);if(p<0)throw new mo(`Array index out of bounds: ${p} < 0.`);if(p>=m.length)throw new mo(`Array index out of bounds: ${p} > ${m.length-1}.`);if(p!==Math.floor(p))throw new mo(`Array index must be an integer, but found ${p} instead.`);return m[p]}eachChild(a){a(this.index),a(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class cu{constructor(a,p){this.type=Xn,this.needle=a,this.haystack=p}static parse(a,p){if(3!==a.length)return p.error(`Expected 2 arguments, but found ${a.length-1} instead.`);const m=p.parse(a[1],1,Rn),w=p.parse(a[2],2,Rn);return m&&w?$l(m.type,[Xn,Tr,gn,ba,Rn])?new cu(m,w):p.error(`Expected first argument to be of type boolean, string, number or null, but found ${_r(m.type)} instead`):null}evaluate(a){const p=this.needle.evaluate(a),m=this.haystack.evaluate(a);if(!m)return!1;if(!Qs(p,["boolean","string","number","null"]))throw new mo(`Expected first argument to be of type boolean, string, number or null, but found ${_r(to(p))} instead.`);if(!Qs(m,["string","array"]))throw new mo(`Expected second argument to be of type array or string, but found ${_r(to(m))} instead.`);return m.indexOf(p)>=0}eachChild(a){a(this.needle),a(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class _i{constructor(a,p,m){this.type=gn,this.needle=a,this.haystack=p,this.fromIndex=m}static parse(a,p){if(a.length<=2||a.length>=5)return p.error(`Expected 3 or 4 arguments, but found ${a.length-1} instead.`);const m=p.parse(a[1],1,Rn),w=p.parse(a[2],2,Rn);if(!m||!w)return null;if(!$l(m.type,[Xn,Tr,gn,ba,Rn]))return p.error(`Expected first argument to be of type boolean, string, number or null, but found ${_r(m.type)} instead`);if(4===a.length){const M=p.parse(a[3],3,gn);return M?new _i(m,w,M):null}return new _i(m,w)}evaluate(a){const p=this.needle.evaluate(a),m=this.haystack.evaluate(a);if(!Qs(p,["boolean","string","number","null"]))throw new mo(`Expected first argument to be of type boolean, string, number or null, but found ${_r(to(p))} instead.`);if(!Qs(m,["string","array"]))throw new mo(`Expected second argument to be of type array or string, but found ${_r(to(m))} instead.`);if(this.fromIndex){const w=this.fromIndex.evaluate(a);return m.indexOf(p,w)}return m.indexOf(p)}eachChild(a){a(this.needle),a(this.haystack),this.fromIndex&&a(this.fromIndex)}outputDefined(){return!1}serialize(){if(null!=this.fromIndex&&void 0!==this.fromIndex){const a=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),a]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class Fn{constructor(a,p,m,w,M,D){this.inputType=a,this.type=p,this.input=m,this.cases=w,this.outputs=M,this.otherwise=D}static parse(a,p){if(a.length<5)return p.error(`Expected at least 4 arguments, but found only ${a.length-1}.`);if(a.length%2!=1)return p.error("Expected an even number of arguments.");let m,w;p.expectedType&&"value"!==p.expectedType.kind&&(w=p.expectedType);const M={},D=[];for(let V=2;V<a.length-1;V+=2){let $=a[V];const X=a[V+1];Array.isArray($)||($=[$]);const K=p.concat(V);if(0===$.length)return K.error("Expected at least one branch label.");for(const ge of $){if("number"!=typeof ge&&"string"!=typeof ge)return K.error("Branch labels must be numbers or strings.");if("number"==typeof ge&&Math.abs(ge)>Number.MAX_SAFE_INTEGER)return K.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof ge&&Math.floor(ge)!==ge)return K.error("Numeric branch labels must be integer values.");if(m){if(K.checkSubtype(m,to(ge)))return null}else m=to(ge);if(void 0!==M[String(ge)])return K.error("Branch labels must be unique.");M[String(ge)]=D.length}const J=p.parse(X,V,w);if(!J)return null;w=w||J.type,D.push(J)}const k=p.parse(a[1],1,Rn);if(!k)return null;const L=p.parse(a[a.length-1],a.length-1,w);return L?"value"!==k.type.kind&&p.concat(1).checkSubtype(m,k.type)?null:new Fn(m,w,k,M,D,L):null}evaluate(a){const p=this.input.evaluate(a);return(to(p)===this.inputType&&this.outputs[this.cases[p]]||this.otherwise).evaluate(a)}eachChild(a){a(this.input),this.outputs.forEach(a),a(this.otherwise)}outputDefined(){return this.outputs.every(a=>a.outputDefined())&&this.otherwise.outputDefined()}serialize(){const a=["match",this.input.serialize()],p=Object.keys(this.cases).sort(),m=[],w={};for(const D of p){const k=w[this.cases[D]];void 0===k?(w[this.cases[D]]=m.length,m.push([this.cases[D],[D]])):m[k][1].push(D)}const M=D=>"number"===this.inputType.kind?Number(D):D;for(const[D,k]of m)a.push(1===k.length?M(k[0]):k.map(M)),a.push(this.outputs[D].serialize());return a.push(this.otherwise.serialize()),a}}class Yi{constructor(a,p,m){this.type=a,this.branches=p,this.otherwise=m}static parse(a,p){if(a.length<4)return p.error(`Expected at least 3 arguments, but found only ${a.length-1}.`);if(a.length%2!=0)return p.error("Expected an odd number of arguments.");let m;p.expectedType&&"value"!==p.expectedType.kind&&(m=p.expectedType);const w=[];for(let D=1;D<a.length-1;D+=2){const k=p.parse(a[D],D,Xn);if(!k)return null;const L=p.parse(a[D+1],D+1,m);if(!L)return null;w.push([k,L]),m=m||L.type}const M=p.parse(a[a.length-1],a.length-1,m);return M?new Yi(m,w,M):null}evaluate(a){for(const[p,m]of this.branches)if(p.evaluate(a))return m.evaluate(a);return this.otherwise.evaluate(a)}eachChild(a){for(const[p,m]of this.branches)a(p),a(m);a(this.otherwise)}outputDefined(){return this.branches.every(([a,p])=>p.outputDefined())&&this.otherwise.outputDefined()}serialize(){const a=["case"];return this.eachChild(p=>{a.push(p.serialize())}),a}}class Yo{constructor(a,p,m,w){this.type=a,this.input=p,this.beginIndex=m,this.endIndex=w}static parse(a,p){if(a.length<=2||a.length>=5)return p.error(`Expected 3 or 4 arguments, but found ${a.length-1} instead.`);const m=p.parse(a[1],1,Rn),w=p.parse(a[2],2,gn);if(!m||!w)return null;if(!$l(m.type,[Ea(Rn),Tr,Rn]))return p.error(`Expected first argument to be of type array or string, but found ${_r(m.type)} instead`);if(4===a.length){const M=p.parse(a[3],3,gn);return M?new Yo(m.type,m,w,M):null}return new Yo(m.type,m,w)}evaluate(a){const p=this.input.evaluate(a),m=this.beginIndex.evaluate(a);if(!Qs(p,["string","array"]))throw new mo(`Expected first argument to be of type array or string, but found ${_r(to(p))} instead.`);if(this.endIndex){const w=this.endIndex.evaluate(a);return p.slice(m,w)}return p.slice(m)}eachChild(a){a(this.input),a(this.beginIndex),this.endIndex&&a(this.endIndex)}outputDefined(){return!1}serialize(){if(null!=this.endIndex&&void 0!==this.endIndex){const a=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),a]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}function hu(h,a){return"=="===h||"!="===h?"boolean"===a.kind||"string"===a.kind||"number"===a.kind||"null"===a.kind||"value"===a.kind:"string"===a.kind||"number"===a.kind||"value"===a.kind}function Ka(h,a,p,m){return 0===m.compare(a,p)}function Cr(h,a,p){const m="=="!==h&&"!="!==h;return class xU{constructor(M,D,k){this.type=Xn,this.lhs=M,this.rhs=D,this.collator=k,this.hasUntypedArgument="value"===M.type.kind||"value"===D.type.kind}static parse(M,D){if(3!==M.length&&4!==M.length)return D.error("Expected two or three arguments.");const k=M[0];let L=D.parse(M[1],1,Rn);if(!L)return null;if(!hu(k,L.type))return D.concat(1).error(`"${k}" comparisons are not supported for type '${_r(L.type)}'.`);let V=D.parse(M[2],2,Rn);if(!V)return null;if(!hu(k,V.type))return D.concat(2).error(`"${k}" comparisons are not supported for type '${_r(V.type)}'.`);if(L.type.kind!==V.type.kind&&"value"!==L.type.kind&&"value"!==V.type.kind)return D.error(`Cannot compare types '${_r(L.type)}' and '${_r(V.type)}'.`);m&&("value"===L.type.kind&&"value"!==V.type.kind?L=new xl(V.type,[L]):"value"!==L.type.kind&&"value"===V.type.kind&&(V=new xl(L.type,[V])));let $=null;if(4===M.length){if("string"!==L.type.kind&&"string"!==V.type.kind&&"value"!==L.type.kind&&"value"!==V.type.kind)return D.error("Cannot use collator to compare non-string types.");if($=D.parse(M[3],3,Js),!$)return null}return new xU(L,V,$)}evaluate(M){const D=this.lhs.evaluate(M),k=this.rhs.evaluate(M);if(m&&this.hasUntypedArgument){const L=to(D),V=to(k);if(L.kind!==V.kind||"string"!==L.kind&&"number"!==L.kind)throw new mo(`Expected arguments for "${h}" to be (string, string) or (number, number), but found (${L.kind}, ${V.kind}) instead.`)}if(this.collator&&!m&&this.hasUntypedArgument){const L=to(D),V=to(k);if("string"!==L.kind||"string"!==V.kind)return a(M,D,k)}return this.collator?p(M,D,k,this.collator.evaluate(M)):a(M,D,k)}eachChild(M){M(this.lhs),M(this.rhs),this.collator&&M(this.collator)}outputDefined(){return!0}serialize(){const M=[h];return this.eachChild(D=>{M.push(D.serialize())}),M}}}const Ja=Cr("==",function(h,a,p){return a===p},Ka),pa=Cr("!=",function(h,a,p){return a!==p},function(h,a,p,m){return!Ka(0,a,p,m)}),On=Cr("<",function(h,a,p){return a<p},function(h,a,p,m){return m.compare(a,p)<0}),Dr=Cr(">",function(h,a,p){return a>p},function(h,a,p,m){return m.compare(a,p)>0}),Wr=Cr("<=",function(h,a,p){return a<=p},function(h,a,p,m){return m.compare(a,p)<=0}),El=Cr(">=",function(h,a,p){return a>=p},function(h,a,p,m){return m.compare(a,p)>=0});class Cl{constructor(a,p,m,w,M){this.type=Tr,this.number=a,this.locale=p,this.currency=m,this.minFractionDigits=w,this.maxFractionDigits=M}static parse(a,p){if(3!==a.length)return p.error("Expected two arguments.");const m=p.parse(a[1],1,gn);if(!m)return null;const w=a[2];if("object"!=typeof w||Array.isArray(w))return p.error("NumberFormat options argument must be an object.");let M=null;if(w.locale&&(M=p.parse(w.locale,1,Tr),!M))return null;let D=null;if(w.currency&&(D=p.parse(w.currency,1,Tr),!D))return null;let k=null;if(w["min-fraction-digits"]&&(k=p.parse(w["min-fraction-digits"],1,gn),!k))return null;let L=null;return w["max-fraction-digits"]&&(L=p.parse(w["max-fraction-digits"],1,gn),!L)?null:new Cl(m,M,D,k,L)}evaluate(a){return new Intl.NumberFormat(this.locale?this.locale.evaluate(a):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(a):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(a):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(a):void 0}).format(this.number.evaluate(a))}eachChild(a){a(this.number),this.locale&&a(this.locale),this.currency&&a(this.currency),this.minFractionDigits&&a(this.minFractionDigits),this.maxFractionDigits&&a(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const a={};return this.locale&&(a.locale=this.locale.serialize()),this.currency&&(a.currency=this.currency.serialize()),this.minFractionDigits&&(a["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(a["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),a]}}class _o{constructor(a){this.type=gn,this.input=a}static parse(a,p){if(2!==a.length)return p.error(`Expected 1 argument, but found ${a.length-1} instead.`);const m=p.parse(a[1],1);return m?"array"!==m.type.kind&&"string"!==m.type.kind&&"value"!==m.type.kind?p.error(`Expected argument of type string or array, but found ${_r(m.type)} instead.`):new _o(m):null}evaluate(a){const p=this.input.evaluate(a);if("string"==typeof p||Array.isArray(p))return p.length;throw new mo(`Expected value to be of type string or array, but found ${_r(to(p))} instead.`)}eachChild(a){a(this.input)}outputDefined(){return!1}serialize(){const a=["length"];return this.eachChild(p=>{a.push(p.serialize())}),a}}const Zo={"==":Ja,"!=":pa,">":Dr,"<":On,">=":El,"<=":Wr,array:xl,at:Gn,boolean:xl,case:Yi,coalesce:ta,collator:To,format:Za,image:ql,in:cu,"index-of":_i,interpolate:ii,"interpolate-hcl":ii,"interpolate-lab":ii,length:_o,let:Ac,literal:fc,match:Fn,number:xl,"number-format":Cl,object:xl,slice:Yo,step:Lh,string:xl,"to-boolean":os,"to-color":os,"to-number":os,"to-string":os,var:hs,within:Xi};function yo(h,[a,p,m,w]){a=a.evaluate(h),p=p.evaluate(h),m=m.evaluate(h);const M=w?w.evaluate(h):1,D=Oh(a,p,m,M);if(D)throw new mo(D);return new Nn(a/255*M,p/255*M,m/255*M,M)}function Us(h,a){return h in a}function na(h,a){const p=a[h];return void 0===p?null:p}function dr(h){return{type:h}}function Sl(h){return{result:"success",value:h}}function Is(h){return{result:"error",value:h}}function vo(h){return"data-driven"===h["property-type"]||"cross-faded-data-driven"===h["property-type"]}function mc(h){return!!h.expression&&h.expression.parameters.indexOf("zoom")>-1}function ra(h){return!!h.expression&&h.expression.interpolated}function br(h){return h instanceof Number?"number":h instanceof String?"string":h instanceof Boolean?"boolean":Array.isArray(h)?"array":null===h?"null":typeof h}function Ta(h){return"object"==typeof h&&null!==h&&!Array.isArray(h)}function ws(h){return h}function Io(h,a){const p="color"===a.type,m=h.stops&&"object"==typeof h.stops[0][0],w=m||!(m||void 0!==h.property),M=h.type||(ra(a)?"exponential":"interval");if(p&&((h=zr({},h)).stops&&(h.stops=h.stops.map(V=>[V[0],Nn.parse(V[1])])),h.default=Nn.parse(h.default?h.default:a.default)),h.colorSpace&&"rgb"!==h.colorSpace&&!ao[h.colorSpace])throw new Error(`Unknown color space: ${h.colorSpace}`);let D,k,L;if("exponential"===M)D=Hu;else if("interval"===M)D=du;else if("categorical"===M){D=Wd,k=Object.create(null);for(const V of h.stops)k[V[0]]=V[1];L=typeof h.stops[0][0]}else{if("identity"!==M)throw new Error(`Unknown function type "${M}"`);D=Qc}if(m){const V={},$=[];for(let J=0;J<h.stops.length;J++){const ge=h.stops[J],Le=ge[0].zoom;void 0===V[Le]&&(V[Le]={zoom:Le,type:h.type,property:h.property,default:h.default,stops:[]},$.push(Le)),V[Le].stops.push([ge[0].value,ge[1]])}const X=[];for(const J of $)X.push([V[J].zoom,Io(V[J],a)]);const K={name:"linear"};return{kind:"composite",interpolationType:K,interpolationFactor:ii.interpolationFactor.bind(void 0,K),zoomStops:X.map(J=>J[0]),evaluate:({zoom:J},ge)=>Hu({stops:X,base:h.base},a,J).evaluate(J,ge)}}if(w){const V="exponential"===M?{name:"exponential",base:void 0!==h.base?h.base:1}:null;return{kind:"camera",interpolationType:V,interpolationFactor:ii.interpolationFactor.bind(void 0,V),zoomStops:h.stops.map($=>$[0]),evaluate:({zoom:$})=>D(h,a,$,k,L)}}return{kind:"source",evaluate(V,$){const X=$&&$.properties?$.properties[h.property]:void 0;return void 0===X?Es(h.default,a.default):D(h,a,X,k,L)}}}function Es(h,a,p){return void 0!==h?h:void 0!==a?a:void 0!==p?p:void 0}function Wd(h,a,p,m,w){return Es(typeof p===w?m[p]:void 0,h.default,a.default)}function du(h,a,p){if("number"!==br(p))return Es(h.default,a.default);const m=h.stops.length;if(1===m||p<=h.stops[0][0])return h.stops[0][1];if(p>=h.stops[m-1][0])return h.stops[m-1][1];const w=$u(h.stops.map(M=>M[0]),p);return h.stops[w][1]}function Hu(h,a,p){const m=void 0!==h.base?h.base:1;if("number"!==br(p))return Es(h.default,a.default);const w=h.stops.length;if(1===w||p<=h.stops[0][0])return h.stops[0][1];if(p>=h.stops[w-1][0])return h.stops[w-1][1];const M=$u(h.stops.map($=>$[0]),p),D=function($,X,K,J){const ge=J-K,Le=$-K;return 0===ge?0:1===X?Le/ge:(Math.pow(X,Le)-1)/(Math.pow(X,ge)-1)}(p,m,h.stops[M][0],h.stops[M+1][0]),k=h.stops[M][1],L=h.stops[M+1][1];let V=Ts[a.type]||ws;if(h.colorSpace&&"rgb"!==h.colorSpace){const $=ao[h.colorSpace];V=(X,K)=>$.reverse($.interpolate($.forward(X),$.forward(K),D))}return"function"==typeof k.evaluate?{evaluate(...$){const X=k.evaluate.apply(void 0,$),K=L.evaluate.apply(void 0,$);if(void 0!==X&&void 0!==K)return V(X,K,D)}}:V(k,L,D)}function Qc(h,a,p){return"color"===a.type?p=Nn.parse(p):"formatted"===a.type?p=fr.fromString(p.toString()):"resolvedImage"===a.type?p=Hl.fromString(p.toString()):br(p)===a.type||"enum"===a.type&&a.values[p]||(p=void 0),Es(p,h.default,a.default)}Pr.register(Zo,{error:[{kind:"error"},[Tr],(h,[a])=>{throw new mo(a.evaluate(h))}],typeof:[Tr,[Rn],(h,[a])=>_r(to(a.evaluate(h)))],"to-rgba":[Ea(gn,4),[wa],(h,[a])=>a.evaluate(h).toArray()],rgb:[wa,[gn,gn,gn],yo],rgba:[wa,[gn,gn,gn,gn],yo],has:{type:Xn,overloads:[[[Tr],(h,[a])=>Us(a.evaluate(h),h.properties())],[[Tr,po],(h,[a,p])=>Us(a.evaluate(h),p.evaluate(h))]]},get:{type:Rn,overloads:[[[Tr],(h,[a])=>na(a.evaluate(h),h.properties())],[[Tr,po],(h,[a,p])=>na(a.evaluate(h),p.evaluate(h))]]},"feature-state":[Rn,[Tr],(h,[a])=>na(a.evaluate(h),h.featureState||{})],properties:[po,[],h=>h.properties()],"geometry-type":[Tr,[],h=>h.geometryType()],id:[Rn,[],h=>h.id()],zoom:[gn,[],h=>h.globals.zoom],"heatmap-density":[gn,[],h=>h.globals.heatmapDensity||0],"line-progress":[gn,[],h=>h.globals.lineProgress||0],"sky-radial-progress":[gn,[],h=>h.globals.skyRadialProgress||0],accumulated:[Rn,[],h=>void 0===h.globals.accumulated?null:h.globals.accumulated],"+":[gn,dr(gn),(h,a)=>{let p=0;for(const m of a)p+=m.evaluate(h);return p}],"*":[gn,dr(gn),(h,a)=>{let p=1;for(const m of a)p*=m.evaluate(h);return p}],"-":{type:gn,overloads:[[[gn,gn],(h,[a,p])=>a.evaluate(h)-p.evaluate(h)],[[gn],(h,[a])=>-a.evaluate(h)]]},"/":[gn,[gn,gn],(h,[a,p])=>a.evaluate(h)/p.evaluate(h)],"%":[gn,[gn,gn],(h,[a,p])=>a.evaluate(h)%p.evaluate(h)],ln2:[gn,[],()=>Math.LN2],pi:[gn,[],()=>Math.PI],e:[gn,[],()=>Math.E],"^":[gn,[gn,gn],(h,[a,p])=>Math.pow(a.evaluate(h),p.evaluate(h))],sqrt:[gn,[gn],(h,[a])=>Math.sqrt(a.evaluate(h))],log10:[gn,[gn],(h,[a])=>Math.log(a.evaluate(h))/Math.LN10],ln:[gn,[gn],(h,[a])=>Math.log(a.evaluate(h))],log2:[gn,[gn],(h,[a])=>Math.log(a.evaluate(h))/Math.LN2],sin:[gn,[gn],(h,[a])=>Math.sin(a.evaluate(h))],cos:[gn,[gn],(h,[a])=>Math.cos(a.evaluate(h))],tan:[gn,[gn],(h,[a])=>Math.tan(a.evaluate(h))],asin:[gn,[gn],(h,[a])=>Math.asin(a.evaluate(h))],acos:[gn,[gn],(h,[a])=>Math.acos(a.evaluate(h))],atan:[gn,[gn],(h,[a])=>Math.atan(a.evaluate(h))],min:[gn,dr(gn),(h,a)=>Math.min(...a.map(p=>p.evaluate(h)))],max:[gn,dr(gn),(h,a)=>Math.max(...a.map(p=>p.evaluate(h)))],abs:[gn,[gn],(h,[a])=>Math.abs(a.evaluate(h))],round:[gn,[gn],(h,[a])=>{const p=a.evaluate(h);return p<0?-Math.round(-p):Math.round(p)}],floor:[gn,[gn],(h,[a])=>Math.floor(a.evaluate(h))],ceil:[gn,[gn],(h,[a])=>Math.ceil(a.evaluate(h))],"filter-==":[Xn,[Tr,Rn],(h,[a,p])=>h.properties()[a.value]===p.value],"filter-id-==":[Xn,[Rn],(h,[a])=>h.id()===a.value],"filter-type-==":[Xn,[Tr],(h,[a])=>h.geometryType()===a.value],"filter-<":[Xn,[Tr,Rn],(h,[a,p])=>{const m=h.properties()[a.value],w=p.value;return typeof m==typeof w&&m<w}],"filter-id-<":[Xn,[Rn],(h,[a])=>{const p=h.id(),m=a.value;return typeof p==typeof m&&p<m}],"filter->":[Xn,[Tr,Rn],(h,[a,p])=>{const m=h.properties()[a.value],w=p.value;return typeof m==typeof w&&m>w}],"filter-id->":[Xn,[Rn],(h,[a])=>{const p=h.id(),m=a.value;return typeof p==typeof m&&p>m}],"filter-<=":[Xn,[Tr,Rn],(h,[a,p])=>{const m=h.properties()[a.value],w=p.value;return typeof m==typeof w&&m<=w}],"filter-id-<=":[Xn,[Rn],(h,[a])=>{const p=h.id(),m=a.value;return typeof p==typeof m&&p<=m}],"filter->=":[Xn,[Tr,Rn],(h,[a,p])=>{const m=h.properties()[a.value],w=p.value;return typeof m==typeof w&&m>=w}],"filter-id->=":[Xn,[Rn],(h,[a])=>{const p=h.id(),m=a.value;return typeof p==typeof m&&p>=m}],"filter-has":[Xn,[Rn],(h,[a])=>a.value in h.properties()],"filter-has-id":[Xn,[],h=>null!==h.id()&&void 0!==h.id()],"filter-type-in":[Xn,[Ea(Tr)],(h,[a])=>a.value.indexOf(h.geometryType())>=0],"filter-id-in":[Xn,[Ea(Rn)],(h,[a])=>a.value.indexOf(h.id())>=0],"filter-in-small":[Xn,[Tr,Ea(Rn)],(h,[a,p])=>p.value.indexOf(h.properties()[a.value])>=0],"filter-in-large":[Xn,[Tr,Ea(Rn)],(h,[a,p])=>function(m,w,M,D){for(;M<=D;){const k=M+D>>1;if(w[k]===m)return!0;w[k]>m?D=k-1:M=k+1}return!1}(h.properties()[a.value],p.value,0,p.value.length-1)],all:{type:Xn,overloads:[[[Xn,Xn],(h,[a,p])=>a.evaluate(h)&&p.evaluate(h)],[dr(Xn),(h,a)=>{for(const p of a)if(!p.evaluate(h))return!1;return!0}]]},any:{type:Xn,overloads:[[[Xn,Xn],(h,[a,p])=>a.evaluate(h)||p.evaluate(h)],[dr(Xn),(h,a)=>{for(const p of a)if(p.evaluate(h))return!0;return!1}]]},"!":[Xn,[Xn],(h,[a])=>!a.evaluate(h)],"is-supported-script":[Xn,[Tr],(h,[a])=>{const p=h.globals&&h.globals.isSupportedScript;return!p||p(a.evaluate(h))}],upcase:[Tr,[Tr],(h,[a])=>a.evaluate(h).toUpperCase()],downcase:[Tr,[Tr],(h,[a])=>a.evaluate(h).toLowerCase()],concat:[Tr,dr(Rn),(h,a)=>a.map(p=>za(p.evaluate(h))).join("")],"resolved-locale":[Tr,[Js],(h,[a])=>a.evaluate(h).resolvedLocale()]});class Pc{constructor(a,p){var m;this.expression=a,this._warningHistory={},this._evaluator=new li,this._defaultValue=p?"color"===(m=p).type&&Ta(m.default)?new Nn(0,0,0,0):"color"===m.type?Nn.parse(m.default)||null:void 0===m.default?null:m.default:null,this._enumValues=p&&"enum"===p.type?p.values:null}evaluateWithoutErrorHandling(a,p,m,w,M,D){return this._evaluator.globals=a,this._evaluator.feature=p,this._evaluator.featureState=m,this._evaluator.canonical=w,this._evaluator.availableImages=M||null,this._evaluator.formattedSection=D,this.expression.evaluate(this._evaluator)}evaluate(a,p,m,w,M,D){this._evaluator.globals=a,this._evaluator.feature=p||null,this._evaluator.featureState=m||null,this._evaluator.canonical=w,this._evaluator.availableImages=M||null,this._evaluator.formattedSection=D||null;try{const k=this.expression.evaluate(this._evaluator);if(null==k||"number"==typeof k&&k!=k)return this._defaultValue;if(this._enumValues&&!(k in this._enumValues))throw new mo(`Expected value to be one of ${Object.keys(this._enumValues).map(L=>JSON.stringify(L)).join(", ")}, but found ${JSON.stringify(k)} instead.`);return k}catch(k){return this._warningHistory[k.message]||(this._warningHistory[k.message]=!0,"undefined"!=typeof console&&console.warn(k.message)),this._defaultValue}}}function ds(h){return Array.isArray(h)&&h.length>0&&"string"==typeof h[0]&&h[0]in Zo}function lo(h,a){const p=new ll(Zo,[],a?function(w){const M={color:wa,string:Tr,number:gn,enum:Tr,boolean:Xn,formatted:Nr,resolvedImage:Gl};return"array"===w.type?Ea(M[w.value]||Rn,w.length):M[w.type]}(a):void 0),m=p.parse(h,void 0,void 0,void 0,a&&"string"===a.type?{typeAnnotation:"coerce"}:void 0);return m?Sl(new Pc(m,a)):Is(p.errors)}class Oo{constructor(a,p){this.kind=a,this._styleExpression=p,this.isStateDependent="constant"!==a&&!ss(p.expression)}evaluateWithoutErrorHandling(a,p,m,w,M,D){return this._styleExpression.evaluateWithoutErrorHandling(a,p,m,w,M,D)}evaluate(a,p,m,w,M,D){return this._styleExpression.evaluate(a,p,m,w,M,D)}}class ga{constructor(a,p,m,w){this.kind=a,this.zoomStops=m,this._styleExpression=p,this.isStateDependent="camera"!==a&&!ss(p.expression),this.interpolationType=w}evaluateWithoutErrorHandling(a,p,m,w,M,D){return this._styleExpression.evaluateWithoutErrorHandling(a,p,m,w,M,D)}evaluate(a,p,m,w,M,D){return this._styleExpression.evaluate(a,p,m,w,M,D)}interpolationFactor(a,p,m){return this.interpolationType?ii.interpolationFactor(this.interpolationType,a,p,m):0}}function xo(h,a){if("error"===(h=lo(h,a)).result)return h;const p=h.value.expression,m=Zc(p);if(!m&&!vo(a))return Is([new ir("","data expressions not supported")]);const w=ur(p,["zoom"]);if(!w&&!mc(a))return Is([new ir("","zoom expressions not supported")]);const M=_a(p);return M||w?M instanceof ir?Is([M]):M instanceof ii&&!ra(a)?Is([new ir("",'"interpolate" expressions cannot be used with this property')]):Sl(M?new ga(m?"camera":"composite",h.value,M.labels,M instanceof ii?M.interpolation:void 0):new Oo(m?"constant":"source",h.value)):Is([new ir("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class ma{constructor(a,p){this._parameters=a,this._specification=p,zr(this,Io(this._parameters,this._specification))}static deserialize(a){return new ma(a._parameters,a._specification)}static serialize(a){return{_parameters:a._parameters,_specification:a._specification}}}function _a(h){let a=null;if(h instanceof Ac)a=_a(h.result);else if(h instanceof ta){for(const p of h.args)if(a=_a(p),a)break}else(h instanceof Lh||h instanceof ii)&&h.input instanceof Pr&&"zoom"===h.input.name&&(a=h);return a instanceof ir||h.eachChild(p=>{const m=_a(p);m instanceof ir?a=m:!a&&m?a=new ir("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):a&&m&&a!==m&&(a=new ir("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),a}function Da(h){const a=h.key,p=h.value,m=h.valueSpec||{},w=h.objectElementValidators||{},M=h.style,D=h.styleSpec;let k=[];const L=br(p);if("object"!==L)return[new Vt(a,p,`object expected, ${L} found`)];for(const V in p){const $=V.split(".")[0],X=m[$]||m["*"];let K;if(w[$])K=w[$];else if(m[$])K=No;else if(w["*"])K=w["*"];else{if(!m["*"]){k.push(new Vt(a,p[V],`unknown property "${V}"`));continue}K=No}k=k.concat(K({key:(a&&`${a}.`)+V,value:p[V],valueSpec:X,style:M,styleSpec:D,object:p,objectKey:V},p))}for(const V in m)w[V]||m[V].required&&void 0===m[V].default&&void 0===p[V]&&k.push(new Vt(a,p,`missing required property "${V}"`));return k}function js(h){const a=h.value,p=h.valueSpec,m=h.style,w=h.styleSpec,M=h.key,D=h.arrayElementValidator||No;if("array"!==br(a))return[new Vt(M,a,`array expected, ${br(a)} found`)];if(p.length&&a.length!==p.length)return[new Vt(M,a,`array length ${p.length} expected, length ${a.length} found`)];if(p["min-length"]&&a.length<p["min-length"])return[new Vt(M,a,`array length at least ${p["min-length"]} expected, length ${a.length} found`)];let k={type:p.value,values:p.values,minimum:p.minimum,maximum:p.maximum};w.$version<7&&(k.function=p.function),"object"===br(p.value)&&(k=p.value);let L=[];for(let V=0;V<a.length;V++)L=L.concat(D({array:a,arrayIndex:V,value:a[V],valueSpec:k,style:m,styleSpec:w,key:`${M}[${V}]`}));return L}function fu(h){const a=h.key,p=h.value,m=h.valueSpec;let w=br(p);if("number"===w&&p!=p&&(w="NaN"),"number"!==w)return[new Vt(a,p,`number expected, ${w} found`)];if("minimum"in m){let M=m.minimum;if("array"===br(m.minimum)&&(M=m.minimum[h.arrayIndex]),p<M)return[new Vt(a,p,`${p} is less than the minimum value ${M}`)]}if("maximum"in m){let M=m.maximum;if("array"===br(m.maximum)&&(M=m.maximum[h.arrayIndex]),p>M)return[new Vt(a,p,`${p} is greater than the maximum value ${M}`)]}return[]}function Yl(h){const a=h.valueSpec,p=lr(h.value.type);let m,w,M,D={};const k="categorical"!==p&&void 0===h.value.property,L=!k,V="array"===br(h.value.stops)&&"array"===br(h.value.stops[0])&&"object"===br(h.value.stops[0][0]),$=Da({key:h.key,value:h.value,valueSpec:h.styleSpec.function,style:h.style,styleSpec:h.styleSpec,objectElementValidators:{stops:function(J){if("identity"===p)return[new Vt(J.key,J.value,'identity function may not have a "stops" property')];let ge=[];const Le=J.value;return ge=ge.concat(js({key:J.key,value:Le,valueSpec:J.valueSpec,style:J.style,styleSpec:J.styleSpec,arrayElementValidator:X})),"array"===br(Le)&&0===Le.length&&ge.push(new Vt(J.key,Le,"array must have at least one stop")),ge},default:function(J){return No({key:J.key,value:J.value,valueSpec:a,style:J.style,styleSpec:J.styleSpec})}}});return"identity"===p&&k&&$.push(new Vt(h.key,h.value,'missing required property "property"')),"identity"===p||h.value.stops||$.push(new Vt(h.key,h.value,'missing required property "stops"')),"exponential"===p&&h.valueSpec.expression&&!ra(h.valueSpec)&&$.push(new Vt(h.key,h.value,"exponential functions not supported")),h.styleSpec.$version>=8&&(L&&!vo(h.valueSpec)?$.push(new Vt(h.key,h.value,"property functions not supported")):k&&!mc(h.valueSpec)&&$.push(new Vt(h.key,h.value,"zoom functions not supported"))),"categorical"!==p&&!V||void 0!==h.value.property||$.push(new Vt(h.key,h.value,'"property" property is required')),$;function X(J){let ge=[];const Le=J.value,Ze=J.key;if("array"!==br(Le))return[new Vt(Ze,Le,`array expected, ${br(Le)} found`)];if(2!==Le.length)return[new Vt(Ze,Le,`array length 2 expected, length ${Le.length} found`)];if(V){if("object"!==br(Le[0]))return[new Vt(Ze,Le,`object expected, ${br(Le[0])} found`)];if(void 0===Le[0].zoom)return[new Vt(Ze,Le,"object stop key must have zoom")];if(void 0===Le[0].value)return[new Vt(Ze,Le,"object stop key must have value")];if(M&&M>lr(Le[0].zoom))return[new Vt(Ze,Le[0].zoom,"stop zoom values must appear in ascending order")];lr(Le[0].zoom)!==M&&(M=lr(Le[0].zoom),w=void 0,D={}),ge=ge.concat(Da({key:`${Ze}[0]`,value:Le[0],valueSpec:{zoom:{}},style:J.style,styleSpec:J.styleSpec,objectElementValidators:{zoom:fu,value:K}}))}else ge=ge.concat(K({key:`${Ze}[0]`,value:Le[0],valueSpec:{},style:J.style,styleSpec:J.styleSpec},Le));return ds(oi(Le[1]))?ge.concat([new Vt(`${Ze}[1]`,Le[1],"expressions are not allowed in function stops.")]):ge.concat(No({key:`${Ze}[1]`,value:Le[1],valueSpec:a,style:J.style,styleSpec:J.styleSpec}))}function K(J,ge){const Le=br(J.value),Ze=lr(J.value),st=null!==J.value?J.value:ge;if(m){if(Le!==m)return[new Vt(J.key,st,`${Le} stop domain type must match previous stop domain type ${m}`)]}else m=Le;if("number"!==Le&&"string"!==Le&&"boolean"!==Le)return[new Vt(J.key,st,"stop domain value must be a number, string, or boolean")];if("number"!==Le&&"categorical"!==p){let xt=`number expected, ${Le} found`;return vo(a)&&void 0===p&&(xt+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Vt(J.key,st,xt)]}return"categorical"!==p||"number"!==Le||isFinite(Ze)&&Math.floor(Ze)===Ze?"categorical"!==p&&"number"===Le&&void 0!==w&&Ze<w?[new Vt(J.key,st,"stop domain values must appear in ascending order")]:(w=Ze,"categorical"===p&&Ze in D?[new Vt(J.key,st,"stop domain values must be unique")]:(D[Ze]=!0,[])):[new Vt(J.key,st,`integer expected, found ${Ze}`)]}}function ko(h){const a=("property"===h.expressionContext?xo:lo)(oi(h.value),h.valueSpec);if("error"===a.result)return a.value.map(m=>new Vt(`${h.key}${m.key}`,h.value,m.message));const p=a.value.expression||a.value._styleExpression.expression;if("property"===h.expressionContext&&"text-font"===h.propertyKey&&!p.outputDefined())return[new Vt(h.key,h.value,`Invalid data expression for "${h.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===h.expressionContext&&"layout"===h.propertyType&&!ss(p))return[new Vt(h.key,h.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===h.expressionContext&&!ss(p))return[new Vt(h.key,h.value,'"feature-state" data expressions are not supported with filters.')];if(h.expressionContext&&0===h.expressionContext.indexOf("cluster")){if(!ur(p,["zoom","feature-state"]))return[new Vt(h.key,h.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===h.expressionContext&&!Zc(p))return[new Vt(h.key,h.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Ia(h){const a=h.key,p=h.value,m=h.valueSpec,w=[];return Array.isArray(m.values)?-1===m.values.indexOf(lr(p))&&w.push(new Vt(a,p,`expected one of [${m.values.join(", ")}], ${JSON.stringify(p)} found`)):-1===Object.keys(m.values).indexOf(lr(p))&&w.push(new Vt(a,p,`expected one of [${Object.keys(m.values).join(", ")}], ${JSON.stringify(p)} found`)),w}function As(h){if(!0===h||!1===h)return!0;if(!Array.isArray(h)||0===h.length)return!1;switch(h[0]){case"has":return h.length>=2&&"$id"!==h[1]&&"$type"!==h[1];case"in":return h.length>=3&&("string"!=typeof h[1]||Array.isArray(h[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==h.length||Array.isArray(h[1])||Array.isArray(h[2]);case"any":case"all":for(const a of h.slice(1))if(!As(a)&&"boolean"!=typeof a)return!1;return!0;default:return!0}}const Xd={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Zl(h){if(null==h)return{filter:()=>!0,needGeometry:!1};As(h)||(h=Ps(h));const a=lo(h,Xd);if("error"===a.result)throw new Error(a.value.map(p=>`${p.key}: ${p.message}`).join(", "));return{filter:(p,m,w)=>a.value.evaluate(p,m,{},w),needGeometry:fs(h)}}function eh(h,a){return h<a?-1:h>a?1:0}function fs(h){if(!Array.isArray(h))return!1;if("within"===h[0])return!0;for(let a=1;a<h.length;a++)if(fs(h[a]))return!0;return!1}function Ps(h){if(!h)return!0;const a=h[0];return h.length<=1?"any"!==a:"=="===a?Ml(h[1],h[2],"=="):"!="===a?qu(Ml(h[1],h[2],"==")):"<"===a||">"===a||"<="===a||">="===a?Ml(h[1],h[2],a):"any"===a?(p=h.slice(1),["any"].concat(p.map(Ps))):"all"===a?["all"].concat(h.slice(1).map(Ps)):"none"===a?["all"].concat(h.slice(1).map(Ps).map(qu)):"in"===a?cl(h[1],h.slice(2)):"!in"===a?qu(cl(h[1],h.slice(2))):"has"===a?Yd(h[1]):"!has"===a?qu(Yd(h[1])):"within"!==a||h;var p}function Ml(h,a,p){switch(h){case"$type":return[`filter-type-${p}`,a];case"$id":return[`filter-id-${p}`,a];default:return[`filter-${p}`,h,a]}}function cl(h,a){if(0===a.length)return!1;switch(h){case"$type":return["filter-type-in",["literal",a]];case"$id":return["filter-id-in",["literal",a]];default:return a.length>200&&!a.some(p=>typeof p!=typeof a[0])?["filter-in-large",h,["literal",a.sort(eh)]]:["filter-in-small",h,["literal",a]]}}function Yd(h){switch(h){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",h]}}function qu(h){return["!",h]}function Tl(h){return As(oi(h.value))?ko(zr({},h,{expressionContext:"filter",valueSpec:{value:"boolean"}})):ia(h)}function ia(h){const a=h.value,p=h.key;if("array"!==br(a))return[new Vt(p,a,`array expected, ${br(a)} found`)];const m=h.styleSpec;let w,M=[];if(a.length<1)return[new Vt(p,a,"filter array must have at least 1 element")];switch(M=M.concat(Ia({key:`${p}[0]`,value:a[0],valueSpec:m.filter_operator,style:h.style,styleSpec:h.styleSpec})),lr(a[0])){case"<":case"<=":case">":case">=":a.length>=2&&"$type"===lr(a[1])&&M.push(new Vt(p,a,`"$type" cannot be use with operator "${a[0]}"`));case"==":case"!=":3!==a.length&&M.push(new Vt(p,a,`filter array for operator "${a[0]}" must have 3 elements`));case"in":case"!in":a.length>=2&&(w=br(a[1]),"string"!==w&&M.push(new Vt(`${p}[1]`,a[1],`string expected, ${w} found`)));for(let D=2;D<a.length;D++)w=br(a[D]),"$type"===lr(a[1])?M=M.concat(Ia({key:`${p}[${D}]`,value:a[D],valueSpec:m.geometry_type,style:h.style,styleSpec:h.styleSpec})):"string"!==w&&"number"!==w&&"boolean"!==w&&M.push(new Vt(`${p}[${D}]`,a[D],`string, number, or boolean expected, ${w} found`));break;case"any":case"all":case"none":for(let D=1;D<a.length;D++)M=M.concat(ia({key:`${p}[${D}]`,value:a[D],style:h.style,styleSpec:h.styleSpec}));break;case"has":case"!has":w=br(a[1]),2!==a.length?M.push(new Vt(p,a,`filter array for "${a[0]}" operator must have 2 elements`)):"string"!==w&&M.push(new Vt(`${p}[1]`,a[1],`string expected, ${w} found`));break;case"within":w=br(a[1]),2!==a.length?M.push(new Vt(p,a,`filter array for "${a[0]}" operator must have 2 elements`)):"object"!==w&&M.push(new Vt(`${p}[1]`,a[1],`object expected, ${w} found`))}return M}function hl(h,a){const p=h.key,m=h.style,w=h.styleSpec,M=h.value,D=h.objectKey,k=w[`${a}_${h.layerType}`];if(!k)return[];const L=D.match(/^(.*)-transition$/);if("paint"===a&&L&&k[L[1]]&&k[L[1]].transition)return No({key:p,value:M,valueSpec:w.transition,style:m,styleSpec:w});const V=h.valueSpec||k[D];if(!V)return[new Vt(p,M,`unknown property "${D}"`)];let $;if("string"===br(M)&&vo(V)&&!V.tokens&&($=/^{([^}]+)}$/.exec(M)))return[new Vt(p,M,`"${D}" does not support interpolation syntax\nUse an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify($[1])} }\`.`)];const X=[];return"symbol"===h.layerType&&("text-field"===D&&m&&!m.glyphs&&X.push(new Vt(p,M,'use of "text-field" requires a style "glyphs" property')),"text-font"===D&&Ta(oi(M))&&"identity"===lr(M.type)&&X.push(new Vt(p,M,'"text-font" does not support identity functions'))),X.concat(No({key:h.key,value:M,valueSpec:V,style:m,styleSpec:w,expressionContext:"property",propertyType:a,propertyKey:D}))}function ps(h){return hl(h,"paint")}function Nh(h){return hl(h,"layout")}function Qa(h){let a=[];const p=h.value,m=h.key,w=h.style,M=h.styleSpec;p.type||p.ref||a.push(new Vt(m,p,'either "type" or "ref" is required'));let D=lr(p.type);const k=lr(p.ref);if(p.id){const L=lr(p.id);for(let V=0;V<h.arrayIndex;V++){const $=w.layers[V];lr($.id)===L&&a.push(new Vt(m,p.id,`duplicate layer id "${p.id}", previously used at line ${$.id.__line__}`))}}if("ref"in p){let L;["type","source","source-layer","filter","layout"].forEach(V=>{V in p&&a.push(new Vt(m,p[V],`"${V}" is prohibited for ref layers`))}),w.layers.forEach(V=>{lr(V.id)===k&&(L=V)}),L?L.ref?a.push(new Vt(m,p.ref,"ref cannot reference another ref layer")):D=lr(L.type):a.push(new Vt(m,p.ref,`ref layer "${k}" not found`))}else if("background"!==D&&"sky"!==D)if(p.source){const L=w.sources&&w.sources[p.source],V=L&&lr(L.type);L?"vector"===V&&"raster"===D?a.push(new Vt(m,p.source,`layer "${p.id}" requires a raster source`)):"raster"===V&&"raster"!==D?a.push(new Vt(m,p.source,`layer "${p.id}" requires a vector source`)):"vector"!==V||p["source-layer"]?"raster-dem"===V&&"hillshade"!==D?a.push(new Vt(m,p.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==D||!p.paint||!p.paint["line-gradient"]||"geojson"===V&&L.lineMetrics||a.push(new Vt(m,p,`layer "${p.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):a.push(new Vt(m,p,`layer "${p.id}" must specify a "source-layer"`)):a.push(new Vt(m,p.source,`source "${p.source}" not found`))}else a.push(new Vt(m,p,'missing required property "source"'));return a=a.concat(Da({key:m,value:p,valueSpec:M.layer,style:h.style,styleSpec:h.styleSpec,objectElementValidators:{"*":()=>[],type:()=>No({key:`${m}.type`,value:p.type,valueSpec:M.layer.type,style:h.style,styleSpec:h.styleSpec,object:p,objectKey:"type"}),filter:Tl,layout:L=>Da({layer:p,key:L.key,value:L.value,style:L.style,styleSpec:L.styleSpec,objectElementValidators:{"*":V=>Nh(zr({layerType:D},V))}}),paint:L=>Da({layer:p,key:L.key,value:L.value,style:L.style,styleSpec:L.styleSpec,objectElementValidators:{"*":V=>ps(zr({layerType:D},V))}})}})),a}function Ko(h){const a=h.value,p=h.key,m=br(a);return"string"!==m?[new Vt(p,a,`string expected, ${m} found`)]:[]}const Dl={promoteId:function({key:h,value:a}){if("string"===br(a))return Ko({key:h,value:a});{const p=[];for(const m in a)p.push(...Ko({key:`${h}.${m}`,value:a[m]}));return p}}};function Eu(h){const a=h.value,p=h.key,m=h.styleSpec,w=h.style;if(!a.type)return[new Vt(p,a,'"type" is required')];const M=lr(a.type);let D;switch(M){case"vector":case"raster":case"raster-dem":return D=Da({key:p,value:a,valueSpec:m[`source_${M.replace("-","_")}`],style:h.style,styleSpec:m,objectElementValidators:Dl}),D;case"geojson":if(D=Da({key:p,value:a,valueSpec:m.source_geojson,style:w,styleSpec:m,objectElementValidators:Dl}),a.cluster)for(const k in a.clusterProperties){const[L,V]=a.clusterProperties[k],$="string"==typeof L?[L,["accumulated"],["get",k]]:L;D.push(...ko({key:`${p}.${k}.map`,value:V,expressionContext:"cluster-map"})),D.push(...ko({key:`${p}.${k}.reduce`,value:$,expressionContext:"cluster-reduce"}))}return D;case"video":return Da({key:p,value:a,valueSpec:m.source_video,style:w,styleSpec:m});case"image":return Da({key:p,value:a,valueSpec:m.source_image,style:w,styleSpec:m});case"canvas":return[new Vt(p,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Ia({key:`${p}.type`,value:a.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:w,styleSpec:m})}}function dl(h){const a=h.value,p=h.styleSpec,m=p.light,w=h.style;let M=[];const D=br(a);if(void 0===a)return M;if("object"!==D)return M=M.concat([new Vt("light",a,`object expected, ${D} found`)]),M;for(const k in a){const L=k.match(/^(.*)-transition$/);M=M.concat(L&&m[L[1]]&&m[L[1]].transition?No({key:k,value:a[k],valueSpec:p.transition,style:w,styleSpec:p}):m[k]?No({key:k,value:a[k],valueSpec:m[k],style:w,styleSpec:p}):[new Vt(k,a[k],`unknown property "${k}"`)])}return M}function Ua(h){const a=h.value,p=h.key,m=h.style,w=h.styleSpec,M=w.terrain;let D=[];const k=br(a);if(void 0===a)return D;if("object"!==k)return D=D.concat([new Vt("terrain",a,`object expected, ${k} found`)]),D;for(const L in a){const V=L.match(/^(.*)-transition$/);D=D.concat(V&&M[V[1]]&&M[V[1]].transition?No({key:L,value:a[L],valueSpec:w.transition,style:m,styleSpec:w}):M[L]?No({key:L,value:a[L],valueSpec:M[L],style:m,styleSpec:w}):[new Vt(L,a[L],`unknown property "${L}"`)])}if(a.source){const L=m.sources&&m.sources[a.source],V=L&&lr(L.type);L?"raster-dem"!==V&&D.push(new Vt(p,a.source,`terrain cannot be used with a source of type ${V}, it only be used with a "raster-dem" source type`)):D.push(new Vt(p,a.source,`source "${a.source}" not found`))}else D.push(new Vt(p,a,'terrain is missing required property "source"'));return D}function Lo(h){const a=h.value,p=h.style,m=h.styleSpec,w=m.fog;let M=[];const D=br(a);if(void 0===a)return M;if("object"!==D)return M=M.concat([new Vt("fog",a,`object expected, ${D} found`)]),M;for(const k in a){const L=k.match(/^(.*)-transition$/);M=M.concat(L&&w[L[1]]&&w[L[1]].transition?No({key:k,value:a[k],valueSpec:m.transition,style:p,styleSpec:m}):w[k]?No({key:k,value:a[k],valueSpec:w[k],style:p,styleSpec:m}):[new Vt(k,a[k],`unknown property "${k}"`)])}return M}const oa={"*":()=>[],array:js,boolean:function(h){const a=h.value,p=h.key,m=br(a);return"boolean"!==m?[new Vt(p,a,`boolean expected, ${m} found`)]:[]},number:fu,color:function(h){const a=h.key,p=h.value,m=br(p);return"string"!==m?[new Vt(a,p,`color expected, ${m} found`)]:null===Or.parseCSSColor(p)?[new Vt(a,p,`color expected, "${p}" found`)]:[]},constants:Wn,enum:Ia,filter:Tl,function:Yl,layer:Qa,object:Da,source:Eu,light:dl,terrain:Ua,fog:Lo,string:Ko,formatted:function(h){return 0===Ko(h).length?[]:ko(h)},resolvedImage:function(h){return 0===Ko(h).length?[]:ko(h)}};function No(h){const a=h.value,p=h.valueSpec,m=h.styleSpec;return p.expression&&Ta(lr(a))?Yl(h):p.expression&&ds(oi(a))?ko(h):p.type&&oa[p.type]?oa[p.type](h):Da(zr({},h,{valueSpec:p.type?m[p.type]:p}))}function Jo(h){const a=h.value,p=h.key,m=Ko(h);return m.length||(-1===a.indexOf("{fontstack}")&&m.push(new Vt(p,a,'"glyphs" url must include a "{fontstack}" token')),-1===a.indexOf("{range}")&&m.push(new Vt(p,a,'"glyphs" url must include a "{range}" token'))),m}function Kl(h,a=tt){let p=[];return p=p.concat(No({key:"",value:h,valueSpec:a.$root,styleSpec:a,style:h,objectElementValidators:{glyphs:Jo,"*":()=>[]}})),h.constants&&(p=p.concat(Wn({key:"constants",value:h.constants,style:h,styleSpec:a}))),Fh(p)}function Fh(h){return[].concat(h).sort((a,p)=>a.line-p.line)}function Qo(h){return function(...a){return Fh(h.apply(this,a))}}Kl.source=Qo(Eu),Kl.light=Qo(dl),Kl.terrain=Qo(Ua),Kl.fog=Qo(Lo),Kl.layer=Qo(Qa),Kl.filter=Qo(Tl),Kl.paintProperty=Qo(ps),Kl.layoutProperty=Qo(Nh);const ya=Kl,th=ya.light,sa=ya.fog,Cu=ya.paintProperty,gs=ya.layoutProperty;function Rs(h,a){let p=!1;if(a&&a.length)for(const m of a)h.fire(new Wt(new Error(m.message))),p=!0;return p}var pu=Fo;function Fo(h,a,p){var m=this.cells=[];if(h instanceof ArrayBuffer){this.arrayBuffer=h;var w=new Int32Array(this.arrayBuffer);h=w[0],this.d=(a=w[1])+2*(p=w[2]);for(var M=0;M<this.d*this.d;M++){var D=w[3+M],k=w[3+M+1];m.push(D===k?null:w.subarray(D,k))}var L=w[3+m.length+1];this.keys=w.subarray(w[3+m.length],L),this.bboxes=w.subarray(L),this.insert=this._insertReadonly}else{this.d=a+2*p;for(var V=0;V<this.d*this.d;V++)m.push([]);this.keys=[],this.bboxes=[]}this.n=a,this.extent=h,this.padding=p,this.scale=a/h,this.uid=0;var $=p/a*h;this.min=-$,this.max=h+$}Fo.prototype.insert=function(h,a,p,m,w){this._forEachCell(a,p,m,w,this._insertCell,this.uid++),this.keys.push(h),this.bboxes.push(a),this.bboxes.push(p),this.bboxes.push(m),this.bboxes.push(w)},Fo.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Fo.prototype._insertCell=function(h,a,p,m,w,M){this.cells[w].push(M)},Fo.prototype.query=function(h,a,p,m,w){var M=this.min,D=this.max;if(h<=M&&a<=M&&D<=p&&D<=m&&!w)return Array.prototype.slice.call(this.keys);var k=[];return this._forEachCell(h,a,p,m,this._queryCell,k,{},w),k},Fo.prototype._queryCell=function(h,a,p,m,w,M,D,k){var L=this.cells[w];if(null!==L)for(var V=this.keys,$=this.bboxes,X=0;X<L.length;X++){var K=L[X];if(void 0===D[K]){var J=4*K;(k?k($[J+0],$[J+1],$[J+2],$[J+3]):h<=$[J+2]&&a<=$[J+3]&&p>=$[J+0]&&m>=$[J+1])?(D[K]=!0,M.push(V[K])):D[K]=!1}}},Fo.prototype._forEachCell=function(h,a,p,m,w,M,D,k){for(var L=this._convertToCellCoord(h),V=this._convertToCellCoord(a),$=this._convertToCellCoord(p),X=this._convertToCellCoord(m),K=L;K<=$;K++)for(var J=V;J<=X;J++){var ge=this.d*J+K;if((!k||k(this._convertFromCellCoord(K),this._convertFromCellCoord(J),this._convertFromCellCoord(K+1),this._convertFromCellCoord(J+1)))&&w.call(this,h,a,p,m,ge,M,D,k))return}},Fo.prototype._convertFromCellCoord=function(h){return(h-this.padding)/this.scale},Fo.prototype._convertToCellCoord=function(h){return Math.max(0,Math.min(this.d-1,Math.floor(h*this.scale)+this.padding))},Fo.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var h=this.cells,a=3+this.cells.length+1+1,p=0,m=0;m<this.cells.length;m++)p+=this.cells[m].length;var w=new Int32Array(a+p+this.keys.length+this.bboxes.length);w[0]=this.extent,w[1]=this.n,w[2]=this.padding;for(var M=a,D=0;D<h.length;D++){var k=h[D];w[3+D]=M,w.set(k,M),M+=k.length}return w[3+h.length]=M,w.set(this.keys,M),w[3+h.length+1]=M+=this.keys.length,w.set(this.bboxes,M),M+=this.bboxes.length,w.buffer};const{ImageData:Zd,ImageBitmap:Go}=It,ms={};function Bn(h,a,p={}){Object.defineProperty(a,"_classRegistryKey",{value:h,writeable:!1}),ms[h]={klass:a,omit:p.omit||[],shallow:p.shallow||[]}}Bn("Object",Object),pu.serialize=function(h,a){const p=h.toArrayBuffer();return a&&a.push(p),{buffer:p}},pu.deserialize=function(h){return new pu(h.buffer)},Bn("Grid",pu),Bn("Color",Nn),Bn("Error",Error),Bn("ResolvedImage",Hl),Bn("StylePropertyFunction",ma),Bn("StyleExpression",Pc,{omit:["_evaluator"]}),Bn("ZoomDependentExpression",ga),Bn("ZoomConstantExpression",Oo),Bn("CompoundExpression",Pr,{omit:["_evaluate"]});for(const h in Zo)Zo[h]._classRegistryKey||Bn(`Expression_${h}`,Zo[h]);function Jl(h){return h&&"undefined"!=typeof ArrayBuffer&&(h instanceof ArrayBuffer||h.constructor&&"ArrayBuffer"===h.constructor.name)}function Cs(h){return Go&&h instanceof Go}function Wu(h,a){if(null==h||"boolean"==typeof h||"number"==typeof h||"string"==typeof h||h instanceof Boolean||h instanceof Number||h instanceof String||h instanceof Date||h instanceof RegExp)return h;if(Jl(h)||Cs(h))return a&&a.push(h),h;if(ArrayBuffer.isView(h)){const p=h;return a&&a.push(p.buffer),p}if(h instanceof Zd)return a&&a.push(h.data.buffer),h;if(Array.isArray(h)){const p=[];for(const m of h)p.push(Wu(m,a));return p}if("object"==typeof h){const p=h.constructor,m=p._classRegistryKey;if(!m)throw new Error("can't serialize object of unregistered class");const w=p.serialize?p.serialize(h,a):{};if(!p.serialize){for(const M in h){if(!h.hasOwnProperty(M)||ms[m].omit.indexOf(M)>=0)continue;const D=h[M];w[M]=ms[m].shallow.indexOf(M)>=0?D:Wu(D,a)}h instanceof Error&&(w.message=h.message)}if(w.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==m&&(w.$name=m),w}throw new Error("can't serialize object of type "+typeof h)}function md(h){if(null==h||"boolean"==typeof h||"number"==typeof h||"string"==typeof h||h instanceof Boolean||h instanceof Number||h instanceof String||h instanceof Date||h instanceof RegExp||Jl(h)||Cs(h)||ArrayBuffer.isView(h)||h instanceof Zd)return h;if(Array.isArray(h))return h.map(md);if("object"==typeof h){const a=h.$name||"Object",{klass:p}=ms[a];if(!p)throw new Error(`can't deserialize unregistered class ${a}`);if(p.deserialize)return p.deserialize(h);const m=Object.create(p.prototype);for(const w of Object.keys(h)){if("$name"===w)continue;const M=h[w];m[w]=ms[a].shallow.indexOf(w)>=0?M:md(M)}return m}throw new Error("can't deserialize object of type "+typeof h)}class Bh{constructor(){this.first=!0}update(a,p){const m=Math.floor(a);return this.first?(this.first=!1,this.lastIntegerZoom=m,this.lastIntegerZoomTime=0,this.lastZoom=a,this.lastFloorZoom=m,!0):(this.lastFloorZoom>m?(this.lastIntegerZoom=m+1,this.lastIntegerZoomTime=p):this.lastFloorZoom<m&&(this.lastIntegerZoom=m,this.lastIntegerZoomTime=p),a!==this.lastZoom&&(this.lastZoom=a,this.lastFloorZoom=m,!0))}}const _s=h=>h>=1536&&h<=1791,Rc=h=>h>=1872&&h<=1919,Ql=h=>h>=2208&&h<=2303,Xu=h=>h>=11904&&h<=12031,aa=h=>h>=12032&&h<=12255,Il=h=>h>=12272&&h<=12287,Su=h=>h>=12288&&h<=12351,_c=h=>h>=12352&&h<=12447,la=h=>h>=12448&&h<=12543,wr=h=>h>=12544&&h<=12591,Al=h=>h>=12704&&h<=12735,Sr=h=>h>=12736&&h<=12783,Mu=h=>h>=12784&&h<=12799,Aa=h=>h>=12800&&h<=13055,zh=h=>h>=13056&&h<=13311,ja=h=>h>=13312&&h<=19903,Bo=h=>h>=19968&&h<=40959,nh=h=>h>=40960&&h<=42127,rh=h=>h>=42128&&h<=42191,l=h=>h>=44032&&h<=55215,d=h=>h>=63744&&h<=64255,_=h=>h>=64336&&h<=65023,b=h=>h>=65040&&h<=65055,I=h=>h>=65072&&h<=65103,N=h=>h>=65104&&h<=65135,j=h=>h>=65136&&h<=65279,ne=h=>h>=65280&&h<=65519;function Ee(h){for(const a of h)if(zt(a.charCodeAt(0)))return!0;return!1}function it(h){for(const a of h)if(!Bt(a.charCodeAt(0)))return!1;return!0}function Bt(h){return!(_s(h)||Rc(h)||Ql(h)||_(h)||j(h))}function zt(h){return!(746!==h&&747!==h&&(h<4352||!(Al(h)||wr(h)||I(h)&&!(h>=65097&&h<=65103)||d(h)||zh(h)||Xu(h)||Sr(h)||!(!Su(h)||h>=12296&&h<=12305||h>=12308&&h<=12319||12336===h)||ja(h)||Bo(h)||Aa(h)||(a=h,a>=12592&&a<=12687)||(a=>a>=43360&&a<=43391)(h)||(a=>a>=55216&&a<=55295)(h)||(a=>a>=4352&&a<=4607)(h)||l(h)||_c(h)||Il(h)||(a=>a>=12688&&a<=12703)(h)||aa(h)||Mu(h)||la(h)&&12540!==h||!(!ne(h)||65288===h||65289===h||65293===h||h>=65306&&h<=65310||65339===h||65341===h||65343===h||h>=65371&&h<=65503||65507===h||h>=65512&&h<=65519)||!(!N(h)||h>=65112&&h<=65118||h>=65123&&h<=65126)||(a=>a>=5120&&a<=5759)(h)||(a=>a>=6320&&a<=6399)(h)||b(h)||(a=>a>=19904&&a<=19967)(h)||nh(h)||rh(h))));var a}function vn(h){return!(zt(h)||(a=h,(p=a)>=128&&p<=255&&(167===a||169===a||174===a||177===a||188===a||189===a||190===a||215===a||247===a)||(p=>p>=8192&&p<=8303)(a)&&(8214===a||8224===a||8225===a||8240===a||8241===a||8251===a||8252===a||8258===a||8263===a||8264===a||8265===a||8273===a)||(p=>p>=8448&&p<=8527)(a)||(p=>p>=8528&&p<=8591)(a)||(p=>p>=8960&&p<=9215)(a)&&(a>=8960&&a<=8967||a>=8972&&a<=8991||a>=8996&&a<=9e3||9003===a||a>=9085&&a<=9114||a>=9150&&a<=9165||9167===a||a>=9169&&a<=9179||a>=9186&&a<=9215)||(p=>p>=9216&&p<=9279)(a)&&9251!==a||(p=>p>=9280&&p<=9311)(a)||(p=>p>=9312&&p<=9471)(a)||(p=>p>=9632&&p<=9727)(a)||(p=>p>=9728&&p<=9983)(a)&&!(a>=9754&&a<=9759)||(p=>p>=11008&&p<=11263)(a)&&(a>=11026&&a<=11055||a>=11088&&a<=11097||a>=11192&&a<=11243)||Su(a)||la(a)||(p=>p>=57344&&p<=63743)(a)||I(a)||N(a)||ne(a)||8734===a||8756===a||8757===a||a>=9984&&a<=10087||a>=10102&&a<=10131||65532===a||65533===a));var a,p}function pn(h){return h>=1424&&h<=2303||_(h)||j(h)}function Pn(h,a){return!(!a&&pn(h)||h>=2304&&h<=3583||h>=3840&&h<=4255||(p=h,p>=6016&&p<=6143));var p}function rr(h){for(const a of h)if(pn(a.charCodeAt(0)))return!0;return!1}const C="deferred",c="loading",y="loaded";let S=null,P="unavailable",O=null;const F=function(h){h&&"string"==typeof h&&h.indexOf("NetworkError")>-1&&(P="error"),S&&S(h)};function U(){q.fire(new fn("pluginStateChange",{pluginStatus:P,pluginURL:O}))}const q=new bn,Y=function(){return P},te=function(){if(P!==C||!O)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");P=c,U(),O&&Q({url:O},h=>{h?F(h):(P=y,U())})},ie={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>P===y||null!=ie.applyArabicShaping,isLoading:()=>P===c,setState(h){P=h.pluginStatus,O=h.pluginURL},isParsed:()=>null!=ie.applyArabicShaping&&null!=ie.processBidirectionalText&&null!=ie.processStyledBidirectionalText,getPluginURL:()=>O};class se{constructor(a,p){this.zoom=a,p?(this.now=p.now,this.fadeDuration=p.fadeDuration,this.zoomHistory=p.zoomHistory,this.transition=p.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Bh,this.transition={})}isSupportedScript(a){return function(p,m){for(const w of p)if(!Pn(w.charCodeAt(0),m))return!1;return!0}(a,ie.isLoaded())}crossFadingFactor(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const a=this.zoom,p=a-Math.floor(a),m=this.crossFadingFactor();return a>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:p+(1-p)*m}:{fromScale:.5,toScale:1,t:1-(1-m)*p}}}class we{constructor(a,p){this.property=a,this.value=p,this.expression=function(m,w){if(Ta(m))return new ma(m,w);if(ds(m)){const M=xo(m,w);if("error"===M.result)throw new Error(M.value.map(D=>`${D.key}: ${D.message}`).join(", "));return M.value}{let M=m;return"string"==typeof m&&"color"===w.type&&(M=Nn.parse(m)),{kind:"constant",evaluate:()=>M}}}(void 0===p?a.specification.default:p,a.specification)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}possiblyEvaluate(a,p,m){return this.property.possiblyEvaluate(this,a,p,m)}}class Fe{constructor(a){this.property=a,this.value=new we(a,void 0)}transitioned(a,p){return new nt(this.property,this.value,p,be({},a.transition,this.transition),a.now)}untransitioned(){return new nt(this.property,this.value,null,{},0)}}class Ve{constructor(a){this._properties=a,this._values=Object.create(a.defaultTransitionablePropertyValues)}getValue(a){return Pe(this._values[a].value.value)}setValue(a,p){this._values.hasOwnProperty(a)||(this._values[a]=new Fe(this._values[a].property)),this._values[a].value=new we(this._values[a].property,null===p?void 0:Pe(p))}getTransition(a){return Pe(this._values[a].transition)}setTransition(a,p){this._values.hasOwnProperty(a)||(this._values[a]=new Fe(this._values[a].property)),this._values[a].transition=Pe(p)||void 0}serialize(){const a={};for(const p of Object.keys(this._values)){const m=this.getValue(p);void 0!==m&&(a[p]=m);const w=this.getTransition(p);void 0!==w&&(a[`${p}-transition`]=w)}return a}transitioned(a,p){const m=new Te(this._properties);for(const w of Object.keys(this._values))m._values[w]=this._values[w].transitioned(a,p._values[w]);return m}untransitioned(){const a=new Te(this._properties);for(const p of Object.keys(this._values))a._values[p]=this._values[p].untransitioned();return a}}class nt{constructor(a,p,m,w,M){const D=w.delay||0,k=w.duration||0;M=M||0,this.property=a,this.value=p,this.begin=M+D,this.end=this.begin+k,a.specification.transition&&(w.delay||w.duration)&&(this.prior=m)}possiblyEvaluate(a,p,m){const w=a.now||0,M=this.value.possiblyEvaluate(a,p,m),D=this.prior;if(D){if(w>this.end)return this.prior=null,M;if(this.value.isDataDriven())return this.prior=null,M;if(w<this.begin)return D.possiblyEvaluate(a,p,m);{const k=(w-this.begin)/(this.end-this.begin);return this.property.interpolate(D.possiblyEvaluate(a,p,m),M,Se(k))}}return M}}class Te{constructor(a){this._properties=a,this._values=Object.create(a.defaultTransitioningPropertyValues)}possiblyEvaluate(a,p,m){const w=new ot(this._properties);for(const M of Object.keys(this._values))w._values[M]=this._values[M].possiblyEvaluate(a,p,m);return w}hasTransition(){for(const a of Object.keys(this._values))if(this._values[a].prior)return!0;return!1}}class He{constructor(a){this._properties=a,this._values=Object.create(a.defaultPropertyValues)}getValue(a){return Pe(this._values[a].value)}setValue(a,p){this._values[a]=new we(this._values[a].property,null===p?void 0:Pe(p))}serialize(){const a={};for(const p of Object.keys(this._values)){const m=this.getValue(p);void 0!==m&&(a[p]=m)}return a}possiblyEvaluate(a,p,m){const w=new ot(this._properties);for(const M of Object.keys(this._values))w._values[M]=this._values[M].possiblyEvaluate(a,p,m);return w}}class Je{constructor(a,p,m){this.property=a,this.value=p,this.parameters=m}isConstant(){return"constant"===this.value.kind}constantOr(a){return"constant"===this.value.kind?this.value.value:a}evaluate(a,p,m,w){return this.property.evaluate(this.value,this.parameters,a,p,m,w)}}class ot{constructor(a){this._properties=a,this._values=Object.create(a.defaultPossiblyEvaluatedValues)}get(a){return this._values[a]}}class Xe{constructor(a){this.specification=a}possiblyEvaluate(a,p){return a.expression.evaluate(p)}interpolate(a,p,m){const w=Ts[this.specification.type];return w?w(a,p,m):a}}class Ye{constructor(a,p){this.specification=a,this.overrides=p}possiblyEvaluate(a,p,m,w){return new Je(this,"constant"===a.expression.kind||"camera"===a.expression.kind?{kind:"constant",value:a.expression.evaluate(p,null,{},m,w)}:a.expression,p)}interpolate(a,p,m){if("constant"!==a.value.kind||"constant"!==p.value.kind)return a;if(void 0===a.value.value||void 0===p.value.value)return new Je(this,{kind:"constant",value:void 0},a.parameters);const w=Ts[this.specification.type];return w?new Je(this,{kind:"constant",value:w(a.value.value,p.value.value,m)},a.parameters):a}evaluate(a,p,m,w,M,D){return"constant"===a.kind?a.value:a.evaluate(p,m,w,M,D)}}class $t extends Ye{possiblyEvaluate(a,p,m,w){if(void 0===a.value)return new Je(this,{kind:"constant",value:void 0},p);if("constant"===a.expression.kind){const M=a.expression.evaluate(p,null,{},m,w),D="resolvedImage"===a.property.specification.type&&"string"!=typeof M?M.name:M,k=this._calculate(D,D,D,p);return new Je(this,{kind:"constant",value:k},p)}if("camera"===a.expression.kind){const M=this._calculate(a.expression.evaluate({zoom:p.zoom-1}),a.expression.evaluate({zoom:p.zoom}),a.expression.evaluate({zoom:p.zoom+1}),p);return new Je(this,{kind:"constant",value:M},p)}return new Je(this,a.expression,p)}evaluate(a,p,m,w,M,D){if("source"===a.kind){const k=a.evaluate(p,m,w,M,D);return this._calculate(k,k,k,p)}return"composite"===a.kind?this._calculate(a.evaluate({zoom:Math.floor(p.zoom)-1},m,w),a.evaluate({zoom:Math.floor(p.zoom)},m,w),a.evaluate({zoom:Math.floor(p.zoom)+1},m,w),p):a.value}_calculate(a,p,m,w){return w.zoom>w.zoomHistory.lastIntegerZoom?{from:a,to:p,other:m}:{from:m,to:p,other:a}}interpolate(a){return a}}class qt{constructor(a){this.specification=a}possiblyEvaluate(a,p,m,w){if(void 0!==a.value){if("constant"===a.expression.kind){const M=a.expression.evaluate(p,null,{},m,w);return this._calculate(M,M,M,p)}return this._calculate(a.expression.evaluate(new se(Math.floor(p.zoom-1),p)),a.expression.evaluate(new se(Math.floor(p.zoom),p)),a.expression.evaluate(new se(Math.floor(p.zoom+1),p)),p)}}_calculate(a,p,m,w){return w.zoom>w.zoomHistory.lastIntegerZoom?{from:a,to:p}:{from:m,to:p}}interpolate(a){return a}}class Jt{constructor(a){this.specification=a}possiblyEvaluate(a,p,m,w){return!!a.expression.evaluate(p,null,{},m,w)}interpolate(){return!1}}class et{constructor(a){this.properties=a,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const p in a){const m=a[p];m.specification.overridable&&this.overridableProperties.push(p);const w=this.defaultPropertyValues[p]=new we(m,void 0),M=this.defaultTransitionablePropertyValues[p]=new Fe(m);this.defaultTransitioningPropertyValues[p]=M.untransitioned(),this.defaultPossiblyEvaluatedValues[p]=w.possiblyEvaluate({})}}}function xn(h,a){return 256*(h=le(Math.floor(h),0,255))+le(Math.floor(a),0,255)}Bn("DataDrivenProperty",Ye),Bn("DataConstantProperty",Xe),Bn("CrossFadedDataDrivenProperty",$t),Bn("CrossFadedProperty",qt),Bn("ColorRampProperty",Jt);const un={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Kn{constructor(a,p){this._structArray=a,this._pos1=p*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class En{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(a,p){return a._trim(),p&&(a.isTransferred=!0,p.push(a.arrayBuffer)),{length:a.length,arrayBuffer:a.arrayBuffer}}static deserialize(a){const p=Object.create(this.prototype);return p.arrayBuffer=a.arrayBuffer,p.length=a.length,p.capacity=a.arrayBuffer.byteLength/p.bytesPerElement,p._refreshViews(),p}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(a){this.reserve(a),this.length=a}reserve(a){if(a>this.capacity){this.capacity=Math.max(a,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const p=this.uint8;this._refreshViews(),p&&this.uint8.set(p)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function wn(h,a=1){let p=0,m=0;return{members:h.map(w=>{const M=un[w.type].BYTES_PER_ELEMENT,D=p=Ir(p,Math.max(a,M)),k=w.components||1;return m=Math.max(m,M),p+=M*k,{name:w.name,type:w.type,components:k,offset:D}}),size:Ir(p,Math.max(m,a)),alignment:a}}function Ir(h,a){return Math.ceil(h/a)*a}class pr extends En{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,p){const m=this.length;return this.resize(m+1),this.emplace(m,a,p)}emplace(a,p,m){const w=2*a;return this.int16[w+0]=p,this.int16[w+1]=m,a}}pr.prototype.bytesPerElement=4,Bn("StructArrayLayout2i4",pr);class gi extends En{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,p,m,w){const M=this.length;return this.resize(M+1),this.emplace(M,a,p,m,w)}emplace(a,p,m,w,M){const D=4*a;return this.int16[D+0]=p,this.int16[D+1]=m,this.int16[D+2]=w,this.int16[D+3]=M,a}}gi.prototype.bytesPerElement=8,Bn("StructArrayLayout4i8",gi);class yi extends En{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,p,m,w,M,D,k){const L=this.length;return this.resize(L+1),this.emplace(L,a,p,m,w,M,D,k)}emplace(a,p,m,w,M,D,k,L){const V=6*a,$=12*a,X=3*a;return this.int16[V+0]=p,this.int16[V+1]=m,this.uint8[$+4]=w,this.uint8[$+5]=M,this.uint8[$+6]=D,this.uint8[$+7]=k,this.float32[X+2]=L,a}}yi.prototype.bytesPerElement=12,Bn("StructArrayLayout2i4ub1f12",yi);class uo extends En{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,p){const m=this.length;return this.resize(m+1),this.emplace(m,a,p)}emplace(a,p,m){const w=2*a;return this.float32[w+0]=p,this.float32[w+1]=m,a}}uo.prototype.bytesPerElement=8,Bn("StructArrayLayout2f8",uo);class Xr extends En{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,p,m,w,M,D,k,L,V,$){const X=this.length;return this.resize(X+1),this.emplace(X,a,p,m,w,M,D,k,L,V,$)}emplace(a,p,m,w,M,D,k,L,V,$,X){const K=10*a;return this.uint16[K+0]=p,this.uint16[K+1]=m,this.uint16[K+2]=w,this.uint16[K+3]=M,this.uint16[K+4]=D,this.uint16[K+5]=k,this.uint16[K+6]=L,this.uint16[K+7]=V,this.uint16[K+8]=$,this.uint16[K+9]=X,a}}Xr.prototype.bytesPerElement=20,Bn("StructArrayLayout10ui20",Xr);class bo extends En{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,p,m,w,M,D,k,L){const V=this.length;return this.resize(V+1),this.emplace(V,a,p,m,w,M,D,k,L)}emplace(a,p,m,w,M,D,k,L,V){const $=8*a;return this.uint16[$+0]=p,this.uint16[$+1]=m,this.uint16[$+2]=w,this.uint16[$+3]=M,this.uint16[$+4]=D,this.uint16[$+5]=k,this.uint16[$+6]=L,this.uint16[$+7]=V,a}}bo.prototype.bytesPerElement=16,Bn("StructArrayLayout8ui16",bo);class es extends En{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,p,m,w,M,D,k,L,V,$,X,K){const J=this.length;return this.resize(J+1),this.emplace(J,a,p,m,w,M,D,k,L,V,$,X,K)}emplace(a,p,m,w,M,D,k,L,V,$,X,K,J){const ge=12*a;return this.int16[ge+0]=p,this.int16[ge+1]=m,this.int16[ge+2]=w,this.int16[ge+3]=M,this.uint16[ge+4]=D,this.uint16[ge+5]=k,this.uint16[ge+6]=L,this.uint16[ge+7]=V,this.int16[ge+8]=$,this.int16[ge+9]=X,this.int16[ge+10]=K,this.int16[ge+11]=J,a}}es.prototype.bytesPerElement=24,Bn("StructArrayLayout4i4ui4i24",es);class Pl extends En{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,p,m){const w=this.length;return this.resize(w+1),this.emplace(w,a,p,m)}emplace(a,p,m,w){const M=3*a;return this.float32[M+0]=p,this.float32[M+1]=m,this.float32[M+2]=w,a}}Pl.prototype.bytesPerElement=12,Bn("StructArrayLayout3f12",Pl);class gu extends En{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(a){const p=this.length;return this.resize(p+1),this.emplace(p,a)}emplace(a,p){return this.uint32[1*a+0]=p,a}}gu.prototype.bytesPerElement=4,Bn("StructArrayLayout1ul4",gu);class Rl extends En{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,p,m,w,M,D,k,L,V,$){const X=this.length;return this.resize(X+1),this.emplace(X,a,p,m,w,M,D,k,L,V,$)}emplace(a,p,m,w,M,D,k,L,V,$,X){const K=16*a,J=8*a;return this.int16[K+0]=p,this.int16[K+1]=m,this.float32[J+1]=w,this.float32[J+2]=M,this.float32[J+3]=D,this.float32[J+4]=k,this.int16[K+10]=L,this.uint32[J+6]=V,this.uint16[K+14]=$,this.uint16[K+15]=X,a}}Rl.prototype.bytesPerElement=32,Bn("StructArrayLayout2i4f1i1ul2ui32",Rl);class Yu extends En{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,p,m,w,M,D){const k=this.length;return this.resize(k+1),this.emplace(k,a,p,m,w,M,D)}emplace(a,p,m,w,M,D,k){const L=6*a;return this.int16[L+0]=p,this.int16[L+1]=m,this.int16[L+2]=w,this.int16[L+3]=M,this.int16[L+4]=D,this.int16[L+5]=k,a}}Yu.prototype.bytesPerElement=12,Bn("StructArrayLayout2i2i2i12",Yu);class Oc extends En{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,p,m,w,M){const D=this.length;return this.resize(D+1),this.emplace(D,a,p,m,w,M)}emplace(a,p,m,w,M,D){const k=4*a,L=8*a;return this.float32[k+0]=p,this.float32[k+1]=m,this.float32[k+2]=w,this.int16[L+6]=M,this.int16[L+7]=D,a}}Oc.prototype.bytesPerElement=16,Bn("StructArrayLayout2f1f2i16",Oc);class ts extends En{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,p,m,w){const M=this.length;return this.resize(M+1),this.emplace(M,a,p,m,w)}emplace(a,p,m,w,M){const D=12*a,k=3*a;return this.uint8[D+0]=p,this.uint8[D+1]=m,this.float32[k+1]=w,this.float32[k+2]=M,a}}ts.prototype.bytesPerElement=12,Bn("StructArrayLayout2ub2f12",ts);class ns extends En{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,p,m){const w=this.length;return this.resize(w+1),this.emplace(w,a,p,m)}emplace(a,p,m,w){const M=3*a;return this.uint16[M+0]=p,this.uint16[M+1]=m,this.uint16[M+2]=w,a}}ns.prototype.bytesPerElement=6,Bn("StructArrayLayout3ui6",ns);class ui extends En{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,p,m,w,M,D,k,L,V,$,X,K,J,ge,Le,Ze,st,xt){const St=this.length;return this.resize(St+1),this.emplace(St,a,p,m,w,M,D,k,L,V,$,X,K,J,ge,Le,Ze,st,xt)}emplace(a,p,m,w,M,D,k,L,V,$,X,K,J,ge,Le,Ze,st,xt,St){const Dt=13*a,Rt=26*a,Pt=52*a;return this.float32[Dt+0]=p,this.float32[Dt+1]=m,this.uint16[Rt+4]=w,this.uint16[Rt+5]=M,this.uint32[Dt+3]=D,this.uint32[Dt+4]=k,this.uint32[Dt+5]=L,this.uint16[Rt+12]=V,this.uint16[Rt+13]=$,this.uint16[Rt+14]=X,this.float32[Dt+8]=K,this.float32[Dt+9]=J,this.uint8[Pt+40]=ge,this.uint8[Pt+41]=Le,this.uint8[Pt+42]=Ze,this.uint32[Dt+11]=st,this.int16[Rt+24]=xt,this.uint8[Pt+50]=St,a}}ui.prototype.bytesPerElement=52,Bn("StructArrayLayout2f2ui3ul3ui2f3ub1ul1i1ub52",ui);class ys extends En{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(a,p,m,w,M,D,k,L,V,$,X,K,J,ge,Le,Ze,st,xt,St,Dt,Rt,Pt,tn,dn,en,Tn,Xt){const nn=this.length;return this.resize(nn+1),this.emplace(nn,a,p,m,w,M,D,k,L,V,$,X,K,J,ge,Le,Ze,st,xt,St,Dt,Rt,Pt,tn,dn,en,Tn,Xt)}emplace(a,p,m,w,M,D,k,L,V,$,X,K,J,ge,Le,Ze,st,xt,St,Dt,Rt,Pt,tn,dn,en,Tn,Xt,nn){const Cn=17*a,Ht=34*a;return this.float32[Cn+0]=p,this.float32[Cn+1]=m,this.int16[Ht+4]=w,this.int16[Ht+5]=M,this.int16[Ht+6]=D,this.int16[Ht+7]=k,this.int16[Ht+8]=L,this.int16[Ht+9]=V,this.uint16[Ht+10]=$,this.uint16[Ht+11]=X,this.uint16[Ht+12]=K,this.uint16[Ht+13]=J,this.uint16[Ht+14]=ge,this.uint16[Ht+15]=Le,this.uint16[Ht+16]=Ze,this.uint16[Ht+17]=st,this.uint16[Ht+18]=xt,this.uint16[Ht+19]=St,this.uint16[Ht+20]=Dt,this.uint16[Ht+21]=Rt,this.uint16[Ht+22]=Pt,this.uint16[Ht+23]=tn,this.uint16[Ht+24]=dn,this.uint32[Cn+13]=en,this.float32[Cn+14]=Tn,this.float32[Cn+15]=Xt,this.float32[Cn+16]=nn,a}}ys.prototype.bytesPerElement=68,Bn("StructArrayLayout2f6i15ui1ul3f68",ys);class Ga extends En{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a){const p=this.length;return this.resize(p+1),this.emplace(p,a)}emplace(a,p){return this.float32[1*a+0]=p,a}}Ga.prototype.bytesPerElement=4,Bn("StructArrayLayout1f4",Ga);class rs extends En{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,p,m){const w=this.length;return this.resize(w+1),this.emplace(w,a,p,m)}emplace(a,p,m,w){const M=3*a;return this.int16[M+0]=p,this.int16[M+1]=m,this.int16[M+2]=w,a}}rs.prototype.bytesPerElement=6,Bn("StructArrayLayout3i6",rs);class $a extends En{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,p,m,w){const M=this.length;return this.resize(M+1),this.emplace(M,a,p,m,w)}emplace(a,p,m,w,M){const D=6*a;return this.uint32[3*a+0]=p,this.uint16[D+2]=m,this.uint16[D+3]=w,this.uint16[D+4]=M,a}}$a.prototype.bytesPerElement=12,Bn("StructArrayLayout1ul3ui12",$a);class yc extends En{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,p){const m=this.length;return this.resize(m+1),this.emplace(m,a,p)}emplace(a,p,m){const w=2*a;return this.uint16[w+0]=p,this.uint16[w+1]=m,a}}yc.prototype.bytesPerElement=4,Bn("StructArrayLayout2ui4",yc);class Pa extends En{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a){const p=this.length;return this.resize(p+1),this.emplace(p,a)}emplace(a,p){return this.uint16[1*a+0]=p,a}}Pa.prototype.bytesPerElement=2,Bn("StructArrayLayout1ui2",Pa);class Zu extends En{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,p,m,w){const M=this.length;return this.resize(M+1),this.emplace(M,a,p,m,w)}emplace(a,p,m,w,M){const D=4*a;return this.float32[D+0]=p,this.float32[D+1]=m,this.float32[D+2]=w,this.float32[D+3]=M,a}}Zu.prototype.bytesPerElement=16,Bn("StructArrayLayout4f16",Zu);class Kd extends Kn{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.float32[this._pos4+1]}get y1(){return this._structArray.float32[this._pos4+2]}get x2(){return this._structArray.float32[this._pos4+3]}get y2(){return this._structArray.float32[this._pos4+4]}get padding(){return this._structArray.int16[this._pos2+10]}get featureIndex(){return this._structArray.uint32[this._pos4+6]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+14]}get bucketIndex(){return this._structArray.uint16[this._pos2+15]}get anchorPoint(){return new Ge(this.anchorPointX,this.anchorPointY)}}Kd.prototype.size=32;class Vf extends Rl{get(a){return new Kd(this,a)}}Bn("CollisionBoxArray",Vf);class Vh extends Kn{get anchorX(){return this._structArray.float32[this._pos4+0]}get anchorY(){return this._structArray.float32[this._pos4+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+4]}get numGlyphs(){return this._structArray.uint16[this._pos2+5]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineStartIndex(){return this._structArray.uint32[this._pos4+4]}get lineLength(){return this._structArray.uint32[this._pos4+5]}get segment(){return this._structArray.uint16[this._pos2+12]}get lowerSize(){return this._structArray.uint16[this._pos2+13]}get upperSize(){return this._structArray.uint16[this._pos2+14]}get lineOffsetX(){return this._structArray.float32[this._pos4+8]}get lineOffsetY(){return this._structArray.float32[this._pos4+9]}get writingMode(){return this._structArray.uint8[this._pos1+40]}get placedOrientation(){return this._structArray.uint8[this._pos1+41]}set placedOrientation(a){this._structArray.uint8[this._pos1+41]=a}get hidden(){return this._structArray.uint8[this._pos1+42]}set hidden(a){this._structArray.uint8[this._pos1+42]=a}get crossTileID(){return this._structArray.uint32[this._pos4+11]}set crossTileID(a){this._structArray.uint32[this._pos4+11]=a}get associatedIconIndex(){return this._structArray.int16[this._pos2+24]}get flipState(){return this._structArray.uint8[this._pos1+50]}set flipState(a){this._structArray.uint8[this._pos1+50]=a}}Vh.prototype.size=52;class Fp extends ui{get(a){return new Vh(this,a)}}Bn("PlacedSymbolArray",Fp);class Jd extends Kn{get anchorX(){return this._structArray.float32[this._pos4+0]}get anchorY(){return this._structArray.float32[this._pos4+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+7]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+8]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+9]}get key(){return this._structArray.uint16[this._pos2+10]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get featureIndex(){return this._structArray.uint16[this._pos2+19]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+21]}get numIconVertices(){return this._structArray.uint16[this._pos2+22]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+23]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+24]}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(a){this._structArray.uint32[this._pos4+13]=a}get textOffset0(){return this._structArray.float32[this._pos4+14]}get textOffset1(){return this._structArray.float32[this._pos4+15]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+16]}}Jd.prototype.size=68;class Uf extends ys{get(a){return new Jd(this,a)}}Bn("SymbolInstanceArray",Uf);class jf extends Ga{getoffsetX(a){return this.float32[1*a+0]}}Bn("GlyphOffsetArray",jf);class Kg extends rs{getx(a){return this.int16[3*a+0]}gety(a){return this.int16[3*a+1]}gettileUnitDistanceFromAnchor(a){return this.int16[3*a+2]}}Bn("SymbolLineVertexArray",Kg);class Jg extends Kn{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}Jg.prototype.size=12;class Bp extends $a{get(a){return new Jg(this,a)}}Bn("FeatureIndexArray",Bp);class zp extends Kn{get a_centroid_pos0(){return this._structArray.uint16[this._pos2+0]}get a_centroid_pos1(){return this._structArray.uint16[this._pos2+1]}}zp.prototype.size=4;class c1 extends yc{get(a){return new zp(this,a)}}Bn("FillExtrusionCentroidArray",c1);const h1=wn([{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"}]),d1=wn([{name:"a_dash_to",components:4,type:"Uint16"},{name:"a_dash_from",components:4,type:"Uint16"}]);var iy=pd(function(h){h.exports=function(a,p){var m,w,M,D,k,L,V,$;for(w=a.length-(m=3&a.length),M=p,k=3432918353,L=461845907,$=0;$<w;)V=255&a.charCodeAt($)|(255&a.charCodeAt(++$))<<8|(255&a.charCodeAt(++$))<<16|(255&a.charCodeAt(++$))<<24,++$,M=27492+(65535&(D=5*(65535&(M=(M^=V=(65535&(V=(V=(65535&V)*k+(((V>>>16)*k&65535)<<16)&4294967295)<<15|V>>>17))*L+(((V>>>16)*L&65535)<<16)&4294967295)<<13|M>>>19))+((5*(M>>>16)&65535)<<16)&4294967295))+((58964+(D>>>16)&65535)<<16);switch(V=0,m){case 3:V^=(255&a.charCodeAt($+2))<<16;case 2:V^=(255&a.charCodeAt($+1))<<8;case 1:M^=V=(65535&(V=(V=(65535&(V^=255&a.charCodeAt($)))*k+(((V>>>16)*k&65535)<<16)&4294967295)<<15|V>>>17))*L+(((V>>>16)*L&65535)<<16)&4294967295}return M^=a.length,M=2246822507*(65535&(M^=M>>>16))+((2246822507*(M>>>16)&65535)<<16)&4294967295,M=3266489909*(65535&(M^=M>>>13))+((3266489909*(M>>>16)&65535)<<16)&4294967295,(M^=M>>>16)>>>0}}),f1=pd(function(h){h.exports=function(a,p){for(var m,w=a.length,M=p^w,D=0;w>=4;)m=1540483477*(65535&(m=255&a.charCodeAt(D)|(255&a.charCodeAt(++D))<<8|(255&a.charCodeAt(++D))<<16|(255&a.charCodeAt(++D))<<24))+((1540483477*(m>>>16)&65535)<<16),M=1540483477*(65535&M)+((1540483477*(M>>>16)&65535)<<16)^(m=1540483477*(65535&(m^=m>>>24))+((1540483477*(m>>>16)&65535)<<16)),w-=4,++D;switch(w){case 3:M^=(255&a.charCodeAt(D+2))<<16;case 2:M^=(255&a.charCodeAt(D+1))<<8;case 1:M=1540483477*(65535&(M^=255&a.charCodeAt(D)))+((1540483477*(M>>>16)&65535)<<16)}return M=1540483477*(65535&(M^=M>>>13))+((1540483477*(M>>>16)&65535)<<16),(M^=M>>>15)>>>0}}),Vp=iy,kE=f1;Vp.murmur3=iy,Vp.murmur2=kE;class Qd{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(a,p,m,w){this.ids.push(Gf(a)),this.positions.push(p,m,w)}getPositions(a){const p=Gf(a);let m=0,w=this.ids.length-1;for(;m<w;){const D=m+w>>1;this.ids[D]>=p?w=D:m=D+1}const M=[];for(;this.ids[m]===p;)M.push({index:this.positions[3*m],start:this.positions[3*m+1],end:this.positions[3*m+2]}),m++;return M}static serialize(a,p){const m=new Float64Array(a.ids),w=new Uint32Array(a.positions);return oy(m,w,0,m.length-1),p&&p.push(m.buffer,w.buffer),{ids:m,positions:w}}static deserialize(a){const p=new Qd;return p.ids=a.ids,p.positions=a.positions,p.indexed=!0,p}}function Gf(h){const a=+h;return!isNaN(a)&&a<=kt?a:Vp(String(h))}function oy(h,a,p,m){for(;p<m;){const w=h[p+m>>1];let M=p-1,D=m+1;for(;;){do{M++}while(h[M]<w);do{D--}while(h[D]>w);if(M>=D)break;Up(h,M,D),Up(a,3*M,3*D),Up(a,3*M+1,3*D+1),Up(a,3*M+2,3*D+2)}D-p<m-D?(oy(h,a,p,D),p=D+1):(oy(h,a,D+1,m),m=D)}}function Up(h,a,p){const m=h[a];h[a]=h[p],h[p]=m}Bn("FeaturePositionMap",Qd);class Uh{constructor(a,p){this.gl=a.gl,this.location=p}}class jh extends Uh{constructor(a,p){super(a,p),this.current=0}set(a){this.current!==a&&(this.current=a,this.gl.uniform1f(this.location,a))}}class Ol extends Uh{constructor(a,p){super(a,p),this.current=[0,0,0,0]}set(a){a[0]===this.current[0]&&a[1]===this.current[1]&&a[2]===this.current[2]&&a[3]===this.current[3]||(this.current=a,this.gl.uniform4f(this.location,a[0],a[1],a[2],a[3]))}}class Qg extends Uh{constructor(a,p){super(a,p),this.current=Nn.transparent}set(a){a.r===this.current.r&&a.g===this.current.g&&a.b===this.current.b&&a.a===this.current.a||(this.current=a,this.gl.uniform4f(this.location,a.r,a.g,a.b,a.a))}}const jp=new Float32Array(16),$f=new Float32Array(9);function _d(h){return[xn(255*h.r,255*h.g),xn(255*h.b,255*h.a)]}class ih{constructor(a,p,m){this.value=a,this.uniformNames=p.map(w=>`u_${w}`),this.type=m}setUniform(a,p,m){a.set(m.constantOr(this.value))}getBinding(a,p,m){return"color"===this.type?new Qg(a,p):new jh(a,p)}}class oh{constructor(a,p){this.uniformNames=p.map(m=>`u_${m}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(a,p){this.pixelRatioFrom=p.pixelRatio,this.pixelRatioTo=a.pixelRatio,this.patternFrom=p.tl.concat(p.br),this.patternTo=a.tl.concat(a.br)}setUniform(a,p,m,w){const M="u_pattern_to"===w||"u_dash_to"===w?this.patternTo:"u_pattern_from"===w||"u_dash_from"===w?this.patternFrom:"u_pixel_ratio_to"===w?this.pixelRatioTo:"u_pixel_ratio_from"===w?this.pixelRatioFrom:null;M&&a.set(M)}getBinding(a,p,m){return"u_pattern_from"===m||"u_pattern_to"===m||"u_dash_from"===m||"u_dash_to"===m?new Ol(a,p):new jh(a,p)}}class kc{constructor(a,p,m,w){this.expression=a,this.type=m,this.maxValue=0,this.paintVertexAttributes=p.map(M=>({name:`a_${M}`,type:"Float32",components:"color"===m?2:1,offset:0})),this.paintVertexArray=new w}populatePaintArray(a,p,m,w,M){const D=this.paintVertexArray.length,k=this.expression.evaluate(new se(0),p,{},w,[],M);this.paintVertexArray.resize(a),this._setPaintValue(D,a,k)}updatePaintArray(a,p,m,w){const M=this.expression.evaluate({zoom:0},m,w);this._setPaintValue(a,p,M)}_setPaintValue(a,p,m){if("color"===this.type){const w=_d(m);for(let M=a;M<p;M++)this.paintVertexArray.emplace(M,w[0],w[1])}else{for(let w=a;w<p;w++)this.paintVertexArray.emplace(w,m);this.maxValue=Math.max(this.maxValue,Math.abs(m))}}upload(a){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=a.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class kl{constructor(a,p,m,w,M,D){this.expression=a,this.uniformNames=p.map(k=>`u_${k}_t`),this.type=m,this.useIntegerZoom=w,this.zoom=M,this.maxValue=0,this.paintVertexAttributes=p.map(k=>({name:`a_${k}`,type:"Float32",components:"color"===m?4:2,offset:0})),this.paintVertexArray=new D}populatePaintArray(a,p,m,w,M){const D=this.expression.evaluate(new se(this.zoom),p,{},w,[],M),k=this.expression.evaluate(new se(this.zoom+1),p,{},w,[],M),L=this.paintVertexArray.length;this.paintVertexArray.resize(a),this._setPaintValue(L,a,D,k)}updatePaintArray(a,p,m,w){const M=this.expression.evaluate({zoom:this.zoom},m,w),D=this.expression.evaluate({zoom:this.zoom+1},m,w);this._setPaintValue(a,p,M,D)}_setPaintValue(a,p,m,w){if("color"===this.type){const M=_d(m),D=_d(w);for(let k=a;k<p;k++)this.paintVertexArray.emplace(k,M[0],M[1],D[0],D[1])}else{for(let M=a;M<p;M++)this.paintVertexArray.emplace(M,m,w);this.maxValue=Math.max(this.maxValue,Math.abs(m),Math.abs(w))}}upload(a){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=a.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(a,p){const m=this.useIntegerZoom?Math.floor(p.zoom):p.zoom,w=le(this.expression.interpolationFactor(m,this.zoom,this.zoom+1),0,1);a.set(w)}getBinding(a,p,m){return new jh(a,p)}}class ef{constructor(a,p,m,w,M,D,k){this.expression=a,this.type=m,this.useIntegerZoom=w,this.zoom=M,this.layerId=k,this.paintVertexAttributes=("array"===m?d1:h1).members;for(let L=0;L<p.length;++L);this.zoomInPaintVertexArray=new D,this.zoomOutPaintVertexArray=new D}populatePaintArray(a,p,m){const w=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(a),this.zoomOutPaintVertexArray.resize(a),this._setPaintValues(w,a,p.patterns&&p.patterns[this.layerId],m)}updatePaintArray(a,p,m,w,M){this._setPaintValues(a,p,m.patterns&&m.patterns[this.layerId],M)}_setPaintValues(a,p,m,w){if(!w||!m)return;const{min:M,mid:D,max:k}=m,L=w[M],V=w[D],$=w[k];if(L&&V&&$)for(let X=a;X<p;X++)this._setPaintValue(this.zoomInPaintVertexArray,X,V,L),this._setPaintValue(this.zoomOutPaintVertexArray,X,V,$)}_setPaintValue(a,p,m,w){a.emplace(p,m.tl[0],m.tl[1],m.br[0],m.br[1],w.tl[0],w.tl[1],w.br[0],w.br[1],m.pixelRatio,w.pixelRatio)}upload(a){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=a.createVertexBuffer(this.zoomInPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=a.createVertexBuffer(this.zoomOutPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class yd{constructor(a,p,m=(()=>!0)){this.binders={},this._buffers=[];const w=[];for(const M in a.paint._values){if(!m(M))continue;const D=a.paint.get(M);if(!(D instanceof Je&&vo(D.property.specification)))continue;const k=LE(M,a.type),L=D.value,V=D.property.specification.type,$=D.property.useIntegerZoom,X=D.property.specification["property-type"],K="cross-faded"===X||"cross-faded-data-driven"===X,J="line-dasharray"===String(M)&&"constant"!==a.layout.get("line-cap").value.kind;if("constant"!==L.kind||J)if("source"===L.kind||J||K){const ge=sy(M,V,"source");this.binders[M]=K?new ef(L,k,V,$,p,ge,a.id):new kc(L,k,V,ge),w.push(`/a_${M}`)}else{const ge=sy(M,V,"composite");this.binders[M]=new kl(L,k,V,$,p,ge),w.push(`/z_${M}`)}else this.binders[M]=K?new oh(L.value,k):new ih(L.value,k,V),w.push(`/u_${M}`)}this.cacheKey=w.sort().join("")}getMaxValue(a){const p=this.binders[a];return p instanceof kc||p instanceof kl?p.maxValue:0}populatePaintArrays(a,p,m,w,M){for(const D in this.binders){const k=this.binders[D];(k instanceof kc||k instanceof kl||k instanceof ef)&&k.populatePaintArray(a,p,m,w,M)}}setConstantPatternPositions(a,p){for(const m in this.binders){const w=this.binders[m];w instanceof oh&&w.setConstantPatternPositions(a,p)}}updatePaintArrays(a,p,m,w,M){let D=!1;for(const k in a){const L=p.getPositions(k);for(const V of L){const $=m.feature(V.index);for(const X in this.binders){const K=this.binders[X];if((K instanceof kc||K instanceof kl||K instanceof ef)&&!0===K.expression.isStateDependent){const J=w.paint.get(X);K.expression=J.value,K.updatePaintArray(V.start,V.end,$,a[k],M),D=!0}}}}return D}defines(){const a=[];for(const p in this.binders){const m=this.binders[p];(m instanceof ih||m instanceof oh)&&a.push(...m.uniformNames.map(w=>`#define HAS_UNIFORM_${w}`))}return a}getBinderAttributes(){const a=[];for(const p in this.binders){const m=this.binders[p];if(m instanceof kc||m instanceof kl||m instanceof ef)for(let w=0;w<m.paintVertexAttributes.length;w++)a.push(m.paintVertexAttributes[w].name)}return a}getBinderUniforms(){const a=[];for(const p in this.binders){const m=this.binders[p];if(m instanceof ih||m instanceof oh||m instanceof kl)for(const w of m.uniformNames)a.push(w)}return a}getPaintVertexBuffers(){return this._buffers}getUniforms(a,p){const m=[];for(const w in this.binders){const M=this.binders[w];if(M instanceof ih||M instanceof oh||M instanceof kl)for(const D of M.uniformNames)if(p[D]){const k=M.getBinding(a,p[D],D);m.push({name:D,property:w,binding:k})}}return m}setUniforms(a,p,m,w){for(const{name:M,property:D,binding:k}of p)this.binders[D].setUniform(k,w,m.get(D),M)}updatePaintBuffers(a){this._buffers=[];for(const p in this.binders){const m=this.binders[p];if(a&&m instanceof ef){const w=2===a.fromScale?m.zoomInPaintVertexBuffer:m.zoomOutPaintVertexBuffer;w&&this._buffers.push(w)}else(m instanceof kc||m instanceof kl)&&m.paintVertexBuffer&&this._buffers.push(m.paintVertexBuffer)}}upload(a){for(const p in this.binders){const m=this.binders[p];(m instanceof kc||m instanceof kl||m instanceof ef)&&m.upload(a)}this.updatePaintBuffers()}destroy(){for(const a in this.binders){const p=this.binders[a];(p instanceof kc||p instanceof kl||p instanceof ef)&&p.destroy()}}}class tf{constructor(a,p,m=(()=>!0)){this.programConfigurations={};for(const w of a)this.programConfigurations[w.id]=new yd(w,p,m);this.needsUpload=!1,this._featureMap=new Qd,this._bufferOffset=0}populatePaintArrays(a,p,m,w,M,D){for(const k in this.programConfigurations)this.programConfigurations[k].populatePaintArrays(a,p,w,M,D);void 0!==p.id&&this._featureMap.add(p.id,m,this._bufferOffset,a),this._bufferOffset=a,this.needsUpload=!0}updatePaintArrays(a,p,m,w){for(const M of m)this.needsUpload=this.programConfigurations[M.id].updatePaintArrays(a,this._featureMap,p,M,w)||this.needsUpload}get(a){return this.programConfigurations[a]}upload(a){if(this.needsUpload){for(const p in this.programConfigurations)this.programConfigurations[p].upload(a);this.needsUpload=!1}}destroy(){for(const a in this.programConfigurations)this.programConfigurations[a].destroy()}}const HA={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"line-dasharray":["dash_to","dash_from"]};function LE(h,a){return HA[h]||[h.replace(`${a}-`,"").replace(/-/g,"_")]}const gr={"line-pattern":{source:Xr,composite:Xr},"fill-pattern":{source:Xr,composite:Xr},"fill-extrusion-pattern":{source:Xr,composite:Xr},"line-dasharray":{source:bo,composite:bo}},NE={color:{source:uo,composite:Zu},number:{source:Ga,composite:uo}};function sy(h,a,p){const m=gr[h];return m&&m[p]||NE[a][p]}Bn("ConstantBinder",ih),Bn("CrossFadedConstantBinder",oh),Bn("SourceExpressionBinder",kc),Bn("CrossFadedCompositeBinder",ef),Bn("CompositeExpressionBinder",kl),Bn("ProgramConfiguration",yd,{omit:["_buffers"]}),Bn("ProgramConfigurationSet",tf);const ay="-transition";class sh extends bn{constructor(a,p){if(super(),this.id=a.id,this.type=a.type,this._featureFilter={filter:()=>!0,needGeometry:!1},"custom"!==a.type&&(this.metadata=(a=a).metadata,this.minzoom=a.minzoom,this.maxzoom=a.maxzoom,"background"!==a.type&&"sky"!==a.type&&(this.source=a.source,this.sourceLayer=a["source-layer"],this.filter=a.filter),p.layout&&(this._unevaluatedLayout=new He(p.layout)),p.paint)){this._transitionablePaint=new Ve(p.paint);for(const m in a.paint)this.setPaintProperty(m,a.paint[m],{validate:!1});for(const m in a.layout)this.setLayoutProperty(m,a.layout[m],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new ot(p.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(a){return"visibility"===a?this.visibility:this._unevaluatedLayout.getValue(a)}setLayoutProperty(a,p,m={}){null!=p&&this._validate(gs,`layers.${this.id}.layout.${a}`,a,p,m)||("visibility"!==a?this._unevaluatedLayout.setValue(a,p):this.visibility=p)}getPaintProperty(a){return Lt(a,ay)?this._transitionablePaint.getTransition(a.slice(0,-ay.length)):this._transitionablePaint.getValue(a)}setPaintProperty(a,p,m={}){if(null!=p&&this._validate(Cu,`layers.${this.id}.paint.${a}`,a,p,m))return!1;if(Lt(a,ay))return this._transitionablePaint.setTransition(a.slice(0,-ay.length),p||void 0),!1;{const w=this._transitionablePaint._values[a],M="cross-faded-data-driven"===w.property.specification["property-type"],D=w.value.isDataDriven(),k=w.value;this._transitionablePaint.setValue(a,p),this._handleSpecialPaintPropertyUpdate(a);const L=this._transitionablePaint._values[a].value;return L.isDataDriven()||D||M||this._handleOverridablePaintPropertyUpdate(a,k,L)}}_handleSpecialPaintPropertyUpdate(a){}getProgramIds(){return null}getProgramConfiguration(a){return null}_handleOverridablePaintPropertyUpdate(a,p,m){return!1}isHidden(a){return!!(this.minzoom&&a<this.minzoom)||!!(this.maxzoom&&a>=this.maxzoom)||"none"===this.visibility}updateTransitions(a){this._transitioningPaint=this._transitionablePaint.transitioned(a,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(a,p){a.getCrossfadeParameters&&(this._crossfadeParameters=a.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(a,void 0,p)),this.paint=this._transitioningPaint.possiblyEvaluate(a,void 0,p)}serialize(){const a={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(a.layout=a.layout||{},a.layout.visibility=this.visibility),ht(a,(p,m)=>!(void 0===p||"layout"===m&&!Object.keys(p).length||"paint"===m&&!Object.keys(p).length))}_validate(a,p,m,w,M={}){return(!M||!1!==M.validate)&&Rs(this,a.call(ya,{key:p,layerType:this.type,objectKey:m,value:w,styleSpec:tt,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const a in this.paint._values){const p=this.paint.get(a);if(p instanceof Je&&vo(p.property.specification)&&("source"===p.value.kind||"composite"===p.value.kind)&&p.value.isStateDependent)return!0}return!1}}const qA=wn([{name:"a_pos",components:2,type:"Int16"}],4),{members:WA}=qA;class eu{constructor(a=[]){this.segments=a}prepareSegment(a,p,m,w){let M=this.segments[this.segments.length-1];return a>eu.MAX_VERTEX_ARRAY_LENGTH&&Ke(`Max vertices per segment is ${eu.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${a}`),(!M||M.vertexLength+a>eu.MAX_VERTEX_ARRAY_LENGTH||M.sortKey!==w)&&(M={vertexOffset:p.length,primitiveOffset:m.length,vertexLength:0,primitiveLength:0},void 0!==w&&(M.sortKey=w),this.segments.push(M)),M}get(){return this.segments}destroy(){for(const a of this.segments)for(const p in a.vaos)a.vaos[p].destroy()}static simpleSegment(a,p,m,w){return new eu([{vertexOffset:a,primitiveOffset:p,vertexLength:m,primitiveLength:w,vaos:{},sortKey:0}])}}eu.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Bn("SegmentVector",eu);var Ao=8192;const p1=Math.pow(2,14)-1,FE=-p1-1;function Hf(h){const a=Ao/h.extent,p=h.loadGeometry();for(let m=0;m<p.length;m++){const w=p[m];for(let M=0;M<w.length;M++){const D=w[M],k=Math.round(D.x*a),L=Math.round(D.y*a);D.x=le(k,FE,p1),D.y=le(L,FE,p1),(k<D.x||k>D.x+1||L<D.y||L>D.y+1)&&Ke("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return p}function Lc(h,a){return{type:h.type,id:h.id,properties:h.properties,geometry:a?Hf(h):[]}}function ly(h,a,p,m,w){h.emplaceBack(2*a+(m+1)/2,2*p+(w+1)/2)}class Ra{constructor(a){this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(p=>p.id),this.index=a.index,this.hasPattern=!1,this.layoutVertexArray=new pr,this.indexArray=new ns,this.segments=new eu,this.programConfigurations=new tf(a.layers,a.zoom),this.stateDependentLayerIds=this.layers.filter(p=>p.isStateDependent()).map(p=>p.id)}populate(a,p,m){const w=this.layers[0],M=[];let D=null;"circle"===w.type&&(D=w.layout.get("circle-sort-key"));for(const{feature:k,id:L,index:V,sourceLayerIndex:$}of a){const X=this.layers[0]._featureFilter.needGeometry,K=Lc(k,X);if(!this.layers[0]._featureFilter.filter(new se(this.zoom),K,m))continue;const J=D?D.evaluate(K,{},m):void 0,ge={id:L,properties:k.properties,type:k.type,sourceLayerIndex:$,index:V,geometry:X?K.geometry:Hf(k),patterns:{},sortKey:J};M.push(ge)}D&&M.sort((k,L)=>k.sortKey-L.sortKey);for(const k of M){const{geometry:L,index:V,sourceLayerIndex:$}=k,X=a[V].feature;this.addFeature(k,L,V,m),p.featureIndex.insert(X,L,V,$,this.index)}}update(a,p,m){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,p,this.stateDependentLayers,m)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,WA),this.indexBuffer=a.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(a),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(a,p,m,w){for(const M of p)for(const D of M){const k=D.x,L=D.y;if(k<0||k>=Ao||L<0||L>=Ao)continue;const V=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,a.sortKey),$=V.vertexLength;ly(this.layoutVertexArray,k,L,-1,-1),ly(this.layoutVertexArray,k,L,1,-1),ly(this.layoutVertexArray,k,L,1,1),ly(this.layoutVertexArray,k,L,-1,1),this.indexArray.emplaceBack($,$+1,$+2),this.indexArray.emplaceBack($,$+3,$+2),V.vertexLength+=4,V.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,m,{},w)}}function nf(h,a){for(let p=0;p<h.length;p++)if(rf(a,h[p]))return!0;for(let p=0;p<a.length;p++)if(rf(h,a[p]))return!0;return!!Tu(h,a)}function em(h,a,p){return!!rf(h,a)||!!qf(a,h,p)}function BE(h,a){if(1===h.length)return Gh(a,h[0]);for(let p=0;p<a.length;p++){const m=a[p];for(let w=0;w<m.length;w++)if(rf(h,m[w]))return!0}for(let p=0;p<h.length;p++)if(Gh(a,h[p]))return!0;for(let p=0;p<a.length;p++)if(Tu(h,a[p]))return!0;return!1}function zE(h,a,p){if(h.length>1){if(Tu(h,a))return!0;for(let m=0;m<a.length;m++)if(qf(a[m],h,p))return!0}for(let m=0;m<h.length;m++)if(qf(h[m],a,p))return!0;return!1}function Tu(h,a){if(0===h.length||0===a.length)return!1;for(let p=0;p<h.length-1;p++){const m=h[p],w=h[p+1];for(let M=0;M<a.length-1;M++)if(ah(m,w,a[M],a[M+1]))return!0}return!1}function ah(h,a,p,m){return Me(h,p,m)!==Me(a,p,m)&&Me(h,a,p)!==Me(h,a,m)}function qf(h,a,p){const m=p*p;if(1===a.length)return h.distSqr(a[0])<m;for(let w=1;w<a.length;w++)if(vd(h,a[w-1],a[w])<m)return!0;return!1}function vd(h,a,p){const m=a.distSqr(p);if(0===m)return h.distSqr(a);const w=((h.x-a.x)*(p.x-a.x)+(h.y-a.y)*(p.y-a.y))/m;return h.distSqr(w<0?a:w>1?p:p.sub(a)._mult(w)._add(a))}function Gh(h,a){let p,m,w,M=!1;for(let D=0;D<h.length;D++){p=h[D];for(let k=0,L=p.length-1;k<p.length;L=k++)m=p[k],w=p[L],m.y>a.y!=w.y>a.y&&a.x<(w.x-m.x)*(a.y-m.y)/(w.y-m.y)+m.x&&(M=!M)}return M}function rf(h,a){let p=!1;for(let m=0,w=h.length-1;m<h.length;w=m++){const M=h[m],D=h[w];M.y>a.y!=D.y>a.y&&a.x<(D.x-M.x)*(a.y-M.y)/(D.y-M.y)+M.x&&(p=!p)}return p}function g1(h,a,p,m,w){for(const D of h)if(a<=D.x&&p<=D.y&&m>=D.x&&w>=D.y)return!0;const M=[new Ge(a,p),new Ge(a,w),new Ge(m,w),new Ge(m,p)];if(h.length>2)for(const D of M)if(rf(h,D))return!0;for(let D=0;D<h.length-1;D++)if(VE(h[D],h[D+1],M))return!0;return!1}function VE(h,a,p){const m=p[0],w=p[2];if(h.x<m.x&&a.x<m.x||h.x>w.x&&a.x>w.x||h.y<m.y&&a.y<m.y||h.y>w.y&&a.y>w.y)return!1;const M=Me(h,a,p[0]);return M!==Me(h,a,p[1])||M!==Me(h,a,p[2])||M!==Me(h,a,p[3])}function tm(h,a,p){const m=a.paint.get(h).value;return"constant"===m.kind?m.value:p.programConfigurations.get(a.id).getMaxValue(h)}function uy(h){return Math.sqrt(h[0]*h[0]+h[1]*h[1])}function cy(h,a,p,m,w){if(!a[0]&&!a[1])return h;const M=Ge.convert(a)._mult(w);"viewport"===p&&M._rotate(-m);const D=[];for(let k=0;k<h.length;k++)D.push(h[k].sub(M));return D}function Du(h,a,p,m){const w=Ge.convert(h)._mult(m);return"viewport"===a&&w._rotate(-p),w}Bn("CircleBucket",Ra,{omit:["layers"]});const hy=new et({"circle-sort-key":new Ye(tt.layout_circle["circle-sort-key"])});var Wf={paint:new et({"circle-radius":new Ye(tt.paint_circle["circle-radius"]),"circle-color":new Ye(tt.paint_circle["circle-color"]),"circle-blur":new Ye(tt.paint_circle["circle-blur"]),"circle-opacity":new Ye(tt.paint_circle["circle-opacity"]),"circle-translate":new Xe(tt.paint_circle["circle-translate"]),"circle-translate-anchor":new Xe(tt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Xe(tt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Xe(tt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Ye(tt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Ye(tt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Ye(tt.paint_circle["circle-stroke-opacity"])}),layout:hy},Ku="undefined"!=typeof Float32Array?Float32Array:Array;function dy(){var h=new Ku(9);return Ku!=Float32Array&&(h[1]=0,h[2]=0,h[3]=0,h[5]=0,h[6]=0,h[7]=0),h[0]=1,h[4]=1,h[8]=1,h}function fy(h){return h[0]=1,h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[5]=1,h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[10]=1,h[11]=0,h[12]=0,h[13]=0,h[14]=0,h[15]=1,h}function m1(h,a,p){var m=a[0],w=a[1],M=a[2],D=a[3],k=a[4],L=a[5],V=a[6],$=a[7],X=a[8],K=a[9],J=a[10],ge=a[11],Le=a[12],Ze=a[13],st=a[14],xt=a[15],St=p[0],Dt=p[1],Rt=p[2],Pt=p[3];return h[0]=St*m+Dt*k+Rt*X+Pt*Le,h[1]=St*w+Dt*L+Rt*K+Pt*Ze,h[2]=St*M+Dt*V+Rt*J+Pt*st,h[3]=St*D+Dt*$+Rt*ge+Pt*xt,h[4]=(St=p[4])*m+(Dt=p[5])*k+(Rt=p[6])*X+(Pt=p[7])*Le,h[5]=St*w+Dt*L+Rt*K+Pt*Ze,h[6]=St*M+Dt*V+Rt*J+Pt*st,h[7]=St*D+Dt*$+Rt*ge+Pt*xt,h[8]=(St=p[8])*m+(Dt=p[9])*k+(Rt=p[10])*X+(Pt=p[11])*Le,h[9]=St*w+Dt*L+Rt*K+Pt*Ze,h[10]=St*M+Dt*V+Rt*J+Pt*st,h[11]=St*D+Dt*$+Rt*ge+Pt*xt,h[12]=(St=p[12])*m+(Dt=p[13])*k+(Rt=p[14])*X+(Pt=p[15])*Le,h[13]=St*w+Dt*L+Rt*K+Pt*Ze,h[14]=St*M+Dt*V+Rt*J+Pt*st,h[15]=St*D+Dt*$+Rt*ge+Pt*xt,h}Math.hypot||(Math.hypot=function(){for(var h=0,a=arguments.length;a--;)h+=arguments[a]*arguments[a];return Math.sqrt(h)});var UE=m1;function nm(){var h=new Ku(3);return Ku!=Float32Array&&(h[0]=0,h[1]=0,h[2]=0),h}function _1(h){return Math.hypot(h[0],h[1],h[2])}function lh(h,a,p){var m=new Ku(3);return m[0]=h,m[1]=a,m[2]=p,m}function rm(h,a,p){return h[0]=a[0]-p[0],h[1]=a[1]-p[1],h[2]=a[2]-p[2],h}function Gp(h,a,p){return h[0]=a[0]*p[0],h[1]=a[1]*p[1],h[2]=a[2]*p[2],h}function jE(h,a,p,m){return h[0]=a[0]+p[0]*m,h[1]=a[1]+p[1]*m,h[2]=a[2]+p[2]*m,h}function Xf(h,a){var p=a[0],m=a[1],w=a[2],M=p*p+m*m+w*w;return M>0&&(M=1/Math.sqrt(M)),h[0]=a[0]*M,h[1]=a[1]*M,h[2]=a[2]*M,h}function im(h,a,p){var m=p[0],w=p[1],M=p[2],D=a[0],k=a[1],L=a[2],V=w*L-M*k,$=M*D-m*L,X=m*k-w*D,K=w*X-M*$,J=M*V-m*X,ge=m*$-w*V,Le=2*p[3];return $*=Le,X*=Le,J*=2,ge*=2,h[0]=D+(V*=Le)+(K*=2),h[1]=k+$+J,h[2]=L+X+ge,h}var uh,GE=rm,$E=Gp,HE=_1;function of(h,a,p){var m=a[0],w=a[1],M=a[2],D=a[3];return h[0]=p[0]*m+p[4]*w+p[8]*M+p[12]*D,h[1]=p[1]*m+p[5]*w+p[9]*M+p[13]*D,h[2]=p[2]*m+p[6]*w+p[10]*M+p[14]*D,h[3]=p[3]*m+p[7]*w+p[11]*M+p[15]*D,h}function y1(){var h=new Ku(4);return Ku!=Float32Array&&(h[0]=0,h[1]=0,h[2]=0),h[3]=1,h}function om(h){return h[0]=0,h[1]=0,h[2]=0,h[3]=1,h}function Yf(h,a,p){p*=.5;var m=a[0],w=a[1],M=a[2],D=a[3],k=Math.sin(p),L=Math.cos(p);return h[0]=m*L+D*k,h[1]=w*L+M*k,h[2]=M*L-w*k,h[3]=D*L-m*k,h}function Zf(h,a,p){const m=of([],[h.x,h.y,a,1],p);return new Ge(m[0]/m[3],m[1]/m[3])}nm(),uh=new Ku(4),Ku!=Float32Array&&(uh[0]=0,uh[1]=0,uh[2]=0,uh[3]=0),nm(),lh(1,0,0),lh(0,1,0),y1(),y1(),dy();const v1=lh(0,0,0),yt=lh(0,0,1);function x1(h,a){const p=nm();return v1[2]=a,h.intersectsPlane(v1,yt,p),new Ge(p[0],p[1])}class py extends Ra{}function $h(h,{width:a,height:p},m,w){if(w){if(w instanceof Uint8ClampedArray)w=new Uint8Array(w.buffer);else if(w.length!==a*p*m)throw new RangeError("mismatched image size")}else w=new Uint8Array(a*p*m);return h.width=a,h.height=p,h.data=w,h}function Kf(h,{width:a,height:p},m){if(a===h.width&&p===h.height)return;const w=$h({},{width:a,height:p},m);gy(h,w,{x:0,y:0},{x:0,y:0},{width:Math.min(h.width,a),height:Math.min(h.height,p)},m),h.width=a,h.height=p,h.data=w.data}function gy(h,a,p,m,w,M){if(0===w.width||0===w.height)return a;if(w.width>h.width||w.height>h.height||p.x>h.width-w.width||p.y>h.height-w.height)throw new RangeError("out of range source coordinates for image copy");if(w.width>a.width||w.height>a.height||m.x>a.width-w.width||m.y>a.height-w.height)throw new RangeError("out of range destination coordinates for image copy");const D=h.data,k=a.data;for(let L=0;L<w.height;L++){const V=((p.y+L)*h.width+p.x)*M,$=((m.y+L)*a.width+m.x)*M;for(let X=0;X<w.width*M;X++)k[$+X]=D[V+X]}return a}Bn("HeatmapBucket",py,{omit:["layers"]});class Hh{constructor(a,p){$h(this,a,1,p)}resize(a){Kf(this,a,1)}clone(){return new Hh({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(a,p,m,w,M){gy(a,p,m,w,M,1)}}class Iu{constructor(a,p){$h(this,a,4,p)}resize(a){Kf(this,a,4)}replace(a,p){p?this.data.set(a):this.data=a instanceof Uint8ClampedArray?new Uint8Array(a.buffer):a}clone(){return new Iu({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(a,p,m,w,M){gy(a,p,m,w,M,4)}}Bn("AlphaImage",Hh),Bn("RGBAImage",Iu);var XA={paint:new et({"heatmap-radius":new Ye(tt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Ye(tt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Xe(tt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Jt(tt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Xe(tt.paint_heatmap["heatmap-opacity"])})};function xd(h){const a={},p=h.resolution||256,m=h.clips?h.clips.length:1,w=h.image||new Iu({width:p,height:m}),M=(D,k,L)=>{a[h.evaluationKey]=L;const V=h.expression.evaluate(a);w.data[D+k+0]=Math.floor(255*V.r/V.a),w.data[D+k+1]=Math.floor(255*V.g/V.a),w.data[D+k+2]=Math.floor(255*V.b/V.a),w.data[D+k+3]=Math.floor(255*V.a)};if(h.clips)for(let D=0,k=0;D<m;++D,k+=4*p)for(let L=0,V=0;L<p;L++,V+=4){const $=L/(p-1),{start:X,end:K}=h.clips[D];M(k,V,X*(1-$)+K*$)}else for(let D=0,k=0;D<p;D++,k+=4)M(0,k,D/(p-1));return w}var Au={paint:new et({"hillshade-illumination-direction":new Xe(tt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Xe(tt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Xe(tt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Xe(tt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Xe(tt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Xe(tt.paint_hillshade["hillshade-accent-color"])})};const sm=wn([{name:"a_pos",components:2,type:"Int16"}],4),{members:bd}=sm;var my=Jf,b1=Jf;function Jf(h,a,p){p=p||2;var m,w,M,D,k,L,V,$=a&&a.length,X=$?a[0]*p:h.length,K=$p(h,0,X,p,!0),J=[];if(!K||K.next===K.prev)return J;if($&&(K=function(Le,Ze,st,xt){var St,Dt,Rt,Pt=[];for(St=0,Dt=Ze.length;St<Dt;St++)(Rt=$p(Le,Ze[St]*xt,St<Dt-1?Ze[St+1]*xt:Le.length,xt,!1))===Rt.next&&(Rt.steiner=!0),Pt.push(YE(Rt));for(Pt.sort(YA),St=0;St<Pt.length;St++)w1(Pt[St],st),st=qh(st,st.next);return st}(h,a,K,p)),h.length>80*p){m=M=h[0],w=D=h[1];for(var ge=p;ge<X;ge+=p)(k=h[ge])<m&&(m=k),(L=h[ge+1])<w&&(w=L),k>M&&(M=k),L>D&&(D=L);V=0!==(V=Math.max(M-m,D-w))?1/V:0}return Hp(K,J,p,m,w,V),J}function $p(h,a,p,m,w){var M,D;if(w===dm(h,a,p,m)>0)for(M=a;M<p;M+=m)D=cm(M,h[M],h[M+1],D);else for(M=p-m;M>=a;M-=m)D=cm(M,h[M],h[M+1],D);return D&&tp(D,D.next)&&(np(D),D=D.next),D}function qh(h,a){if(!h)return h;a||(a=h);var p,m=h;do{if(p=!1,m.steiner||!tp(m,m.next)&&0!==Ss(m.prev,m,m.next))m=m.next;else{if(np(m),(m=a=m.prev)===m.next)break;p=!0}}while(p||m!==a);return a}function Hp(h,a,p,m,w,M,D){if(h){!D&&M&&function($,X,K,J){var ge=$;do{null===ge.z&&(ge.z=E1(ge.x,ge.y,X,K,J)),ge.prevZ=ge.prev,ge.nextZ=ge.next,ge=ge.next}while(ge!==$);ge.prevZ.nextZ=null,ge.prevZ=null,function(Le){var Ze,st,xt,St,Dt,Rt,Pt,tn,dn=1;do{for(st=Le,Le=null,Dt=null,Rt=0;st;){for(Rt++,xt=st,Pt=0,Ze=0;Ze<dn&&(Pt++,xt=xt.nextZ);Ze++);for(tn=dn;Pt>0||tn>0&&xt;)0!==Pt&&(0===tn||!xt||st.z<=xt.z)?(St=st,st=st.nextZ,Pt--):(St=xt,xt=xt.nextZ,tn--),Dt?Dt.nextZ=St:Le=St,St.prevZ=Dt,Dt=St;st=xt}Dt.nextZ=null,dn*=2}while(Rt>1)}(ge)}(h,m,w,M);for(var k,L,V=h;h.prev!==h.next;)if(k=h.prev,L=h.next,M?Qf(h,m,w,M):qE(h))a.push(k.i/p),a.push(h.i/p),a.push(L.i/p),np(h),h=L.next,V=L.next;else if((h=L)===V){D?1===D?Hp(h=qp(qh(h),a,p),a,p,m,w,M,2):2===D&&WE(h,a,p,m,w,M):Hp(qh(h),a,p,m,w,M,1);break}}}function qE(h){var a=h.prev,p=h,m=h.next;if(Ss(a,p,m)>=0)return!1;for(var w=h.next.next;w!==h.prev;){if(ep(a.x,a.y,p.x,p.y,m.x,m.y,w.x,w.y)&&Ss(w.prev,w,w.next)>=0)return!1;w=w.next}return!0}function Qf(h,a,p,m){var w=h.prev,M=h,D=h.next;if(Ss(w,M,D)>=0)return!1;for(var k=w.x>M.x?w.x>D.x?w.x:D.x:M.x>D.x?M.x:D.x,L=w.y>M.y?w.y>D.y?w.y:D.y:M.y>D.y?M.y:D.y,V=E1(w.x<M.x?w.x<D.x?w.x:D.x:M.x<D.x?M.x:D.x,w.y<M.y?w.y<D.y?w.y:D.y:M.y<D.y?M.y:D.y,a,p,m),$=E1(k,L,a,p,m),X=h.prevZ,K=h.nextZ;X&&X.z>=V&&K&&K.z<=$;){if(X!==h.prev&&X!==h.next&&ep(w.x,w.y,M.x,M.y,D.x,D.y,X.x,X.y)&&Ss(X.prev,X,X.next)>=0||(X=X.prevZ,K!==h.prev&&K!==h.next&&ep(w.x,w.y,M.x,M.y,D.x,D.y,K.x,K.y)&&Ss(K.prev,K,K.next)>=0))return!1;K=K.nextZ}for(;X&&X.z>=V;){if(X!==h.prev&&X!==h.next&&ep(w.x,w.y,M.x,M.y,D.x,D.y,X.x,X.y)&&Ss(X.prev,X,X.next)>=0)return!1;X=X.prevZ}for(;K&&K.z<=$;){if(K!==h.prev&&K!==h.next&&ep(w.x,w.y,M.x,M.y,D.x,D.y,K.x,K.y)&&Ss(K.prev,K,K.next)>=0)return!1;K=K.nextZ}return!0}function qp(h,a,p){var m=h;do{var w=m.prev,M=m.next.next;!tp(w,M)&&sf(w,m,m.next,M)&&um(w,M)&&um(M,w)&&(a.push(w.i/p),a.push(m.i/p),a.push(M.i/p),np(m),np(m.next),m=h=M),m=m.next}while(m!==h);return qh(m)}function WE(h,a,p,m,w,M){var D=h;do{for(var k=D.next.next;k!==D.prev;){if(D.i!==k.i&&ZE(D,k)){var L=Wp(D,k);return D=qh(D,D.next),L=qh(L,L.next),Hp(D,a,p,m,w,M),void Hp(L,a,p,m,w,M)}k=k.next}D=D.next}while(D!==h)}function YA(h,a){return h.x-a.x}function w1(h,a){if(a=function(m,w){var M,D=w,k=m.x,L=m.y,V=-1/0;do{if(L<=D.y&&L>=D.next.y&&D.next.y!==D.y){var $=D.x+(L-D.y)*(D.next.x-D.x)/(D.next.y-D.y);if($<=k&&$>V){if(V=$,$===k){if(L===D.y)return D;if(L===D.next.y)return D.next}M=D.x<D.next.x?D:D.next}}D=D.next}while(D!==w);if(!M)return null;if(k===V)return M;var X,K=M,J=M.x,ge=M.y,Le=1/0;D=M;do{k>=D.x&&D.x>=J&&k!==D.x&&ep(L<ge?k:V,L,J,ge,L<ge?V:k,L,D.x,D.y)&&(X=Math.abs(L-D.y)/(k-D.x),um(D,m)&&(X<Le||X===Le&&(D.x>M.x||D.x===M.x&&XE(M,D)))&&(M=D,Le=X)),D=D.next}while(D!==K);return M}(h,a)){var p=Wp(a,h);qh(a,a.next),qh(p,p.next)}}function XE(h,a){return Ss(h.prev,h,a.prev)<0&&Ss(a.next,h,h.next)<0}function E1(h,a,p,m,w){return(h=1431655765&((h=858993459&((h=252645135&((h=16711935&((h=32767*(h-p)*w)|h<<8))|h<<4))|h<<2))|h<<1))|(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=32767*(a-m)*w)|a<<8))|a<<4))|a<<2))|a<<1))<<1}function YE(h){var a=h,p=h;do{(a.x<p.x||a.x===p.x&&a.y<p.y)&&(p=a),a=a.next}while(a!==h);return p}function ep(h,a,p,m,w,M,D,k){return(w-D)*(a-k)-(h-D)*(M-k)>=0&&(h-D)*(m-k)-(p-D)*(a-k)>=0&&(p-D)*(M-k)-(w-D)*(m-k)>=0}function ZE(h,a){return h.next.i!==a.i&&h.prev.i!==a.i&&!function(p,m){var w=p;do{if(w.i!==p.i&&w.next.i!==p.i&&w.i!==m.i&&w.next.i!==m.i&&sf(w,w.next,p,m))return!0;w=w.next}while(w!==p);return!1}(h,a)&&(um(h,a)&&um(a,h)&&function(p,m){var w=p,M=!1,D=(p.x+m.x)/2,k=(p.y+m.y)/2;do{w.y>k!=w.next.y>k&&w.next.y!==w.y&&D<(w.next.x-w.x)*(k-w.y)/(w.next.y-w.y)+w.x&&(M=!M),w=w.next}while(w!==p);return M}(h,a)&&(Ss(h.prev,h,a.prev)||Ss(h,a.prev,a))||tp(h,a)&&Ss(h.prev,h,h.next)>0&&Ss(a.prev,a,a.next)>0)}function Ss(h,a,p){return(a.y-h.y)*(p.x-a.x)-(a.x-h.x)*(p.y-a.y)}function tp(h,a){return h.x===a.x&&h.y===a.y}function sf(h,a,p,m){var w=lm(Ss(h,a,p)),M=lm(Ss(h,a,m)),D=lm(Ss(p,m,h)),k=lm(Ss(p,m,a));return w!==M&&D!==k||!(0!==w||!am(h,p,a))||!(0!==M||!am(h,m,a))||!(0!==D||!am(p,h,m))||!(0!==k||!am(p,a,m))}function am(h,a,p){return a.x<=Math.max(h.x,p.x)&&a.x>=Math.min(h.x,p.x)&&a.y<=Math.max(h.y,p.y)&&a.y>=Math.min(h.y,p.y)}function lm(h){return h>0?1:h<0?-1:0}function um(h,a){return Ss(h.prev,h,h.next)<0?Ss(h,a,h.next)>=0&&Ss(h,h.prev,a)>=0:Ss(h,a,h.prev)<0||Ss(h,h.next,a)<0}function Wp(h,a){var p=new hm(h.i,h.x,h.y),m=new hm(a.i,a.x,a.y),w=h.next,M=a.prev;return h.next=a,a.prev=h,p.next=w,w.prev=p,m.next=p,p.prev=m,M.next=m,m.prev=M,m}function cm(h,a,p,m){var w=new hm(h,a,p);return m?(w.next=m.next,w.prev=m,m.next.prev=w,m.next=w):(w.prev=w,w.next=w),w}function np(h){h.next.prev=h.prev,h.prev.next=h.next,h.prevZ&&(h.prevZ.nextZ=h.nextZ),h.nextZ&&(h.nextZ.prevZ=h.prevZ)}function hm(h,a,p){this.i=h,this.x=a,this.y=p,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function dm(h,a,p,m){for(var w=0,M=a,D=p-m;M<p;M+=m)w+=(h[D]-h[M])*(h[M+1]+h[D+1]),D=M;return w}function af(h,a,p,m,w){C1(h,a,p||0,m||h.length-1,w||KE)}function C1(h,a,p,m,w){for(;m>p;){if(m-p>600){var M=m-p+1,D=a-p+1,k=Math.log(M),L=.5*Math.exp(2*k/3),V=.5*Math.sqrt(k*L*(M-L)/M)*(D-M/2<0?-1:1);C1(h,a,Math.max(p,Math.floor(a-D*L/M+V)),Math.min(m,Math.floor(a+(M-D)*L/M+V)),w)}var $=h[a],X=p,K=m;for(Xp(h,p,a),w(h[m],$)>0&&Xp(h,p,m);X<K;){for(Xp(h,X,K),X++,K--;w(h[X],$)<0;)X++;for(;w(h[K],$)>0;)K--}0===w(h[p],$)?Xp(h,p,K):Xp(h,++K,m),K<=a&&(p=K+1),a<=K&&(m=K-1)}}function Xp(h,a,p){var m=h[a];h[a]=h[p],h[p]=m}function KE(h,a){return h<a?-1:h>a?1:0}function _y(h,a){const p=h.length;if(p<=1)return[h];const m=[];let w,M;for(let D=0;D<p;D++){const k=Ft(h[D]);0!==k&&(h[D].area=Math.abs(k),void 0===M&&(M=k<0),M===k<0?(w&&m.push(w),w=[h[D]]):w.push(h[D]))}if(w&&m.push(w),a>1)for(let D=0;D<m.length;D++)m[D].length<=a||(af(m[D],a,1,m[D].length-1,JE),m[D]=m[D].slice(0,a));return m}function JE(h,a){return a.area-h.area}function mu(h,a,p){const m=p.patternDependencies;let w=!1;for(const M of a){const D=M.paint.get(`${h}-pattern`);D.isConstant()||(w=!0);const k=D.constantOr(null);k&&(w=!0,m[k.to]=!0,m[k.from]=!0)}return w}function vc(h,a,p,m,w){const M=w.patternDependencies;for(const D of a){const k=D.paint.get(`${h}-pattern`).value;if("constant"!==k.kind){let L=k.evaluate({zoom:m-1},p,{},w.availableImages),V=k.evaluate({zoom:m},p,{},w.availableImages),$=k.evaluate({zoom:m+1},p,{},w.availableImages);L=L&&L.name?L.name:L,V=V&&V.name?V.name:V,$=$&&$.name?$.name:$,M[L]=!0,M[V]=!0,M[$]=!0,p.patterns[D.id]={min:L,mid:V,max:$}}}return p}Jf.deviation=function(h,a,p,m){var w=a&&a.length,M=Math.abs(dm(h,0,w?a[0]*p:h.length,p));if(w)for(var D=0,k=a.length;D<k;D++)M-=Math.abs(dm(h,a[D]*p,D<k-1?a[D+1]*p:h.length,p));var L=0;for(D=0;D<m.length;D+=3){var V=m[D]*p,$=m[D+1]*p,X=m[D+2]*p;L+=Math.abs((h[V]-h[X])*(h[$+1]-h[V+1])-(h[V]-h[$])*(h[X+1]-h[V+1]))}return 0===M&&0===L?0:Math.abs((L-M)/M)},Jf.flatten=function(h){for(var a=h[0][0].length,p={vertices:[],holes:[],dimensions:a},m=0,w=0;w<h.length;w++){for(var M=0;M<h[w].length;M++)for(var D=0;D<a;D++)p.vertices.push(h[w][M][D]);w>0&&p.holes.push(m+=h[w-1].length)}return p},my.default=b1;class fm{constructor(a){this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(p=>p.id),this.index=a.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new pr,this.indexArray=new ns,this.indexArray2=new yc,this.programConfigurations=new tf(a.layers,a.zoom),this.segments=new eu,this.segments2=new eu,this.stateDependentLayerIds=this.layers.filter(p=>p.isStateDependent()).map(p=>p.id)}populate(a,p,m){this.hasPattern=mu("fill",this.layers,p);const w=this.layers[0].layout.get("fill-sort-key"),M=[];for(const{feature:D,id:k,index:L,sourceLayerIndex:V}of a){const $=this.layers[0]._featureFilter.needGeometry,X=Lc(D,$);if(!this.layers[0]._featureFilter.filter(new se(this.zoom),X,m))continue;const K=w?w.evaluate(X,{},m,p.availableImages):void 0,J={id:k,properties:D.properties,type:D.type,sourceLayerIndex:V,index:L,geometry:$?X.geometry:Hf(D),patterns:{},sortKey:K};M.push(J)}w&&M.sort((D,k)=>D.sortKey-k.sortKey);for(const D of M){const{geometry:k,index:L,sourceLayerIndex:V}=D;if(this.hasPattern){const $=vc("fill",this.layers,D,this.zoom,p);this.patternFeatures.push($)}else this.addFeature(D,k,L,m,{});p.featureIndex.insert(a[L].feature,k,L,V,this.index)}}update(a,p,m){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,p,this.stateDependentLayers,m)}addFeatures(a,p,m){for(const w of this.patternFeatures)this.addFeature(w,w.geometry,w.index,p,m)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,bd),this.indexBuffer=a.createIndexBuffer(this.indexArray),this.indexBuffer2=a.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(a),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(a,p,m,w,M){for(const D of _y(p,500)){let k=0;for(const J of D)k+=J.length;const L=this.segments.prepareSegment(k,this.layoutVertexArray,this.indexArray),V=L.vertexLength,$=[],X=[];for(const J of D){if(0===J.length)continue;J!==D[0]&&X.push($.length/2);const ge=this.segments2.prepareSegment(J.length,this.layoutVertexArray,this.indexArray2),Le=ge.vertexLength;this.layoutVertexArray.emplaceBack(J[0].x,J[0].y),this.indexArray2.emplaceBack(Le+J.length-1,Le),$.push(J[0].x),$.push(J[0].y);for(let Ze=1;Ze<J.length;Ze++)this.layoutVertexArray.emplaceBack(J[Ze].x,J[Ze].y),this.indexArray2.emplaceBack(Le+Ze-1,Le+Ze),$.push(J[Ze].x),$.push(J[Ze].y);ge.vertexLength+=J.length,ge.primitiveLength+=J.length}const K=my($,X);for(let J=0;J<K.length;J+=3)this.indexArray.emplaceBack(V+K[J],V+K[J+1],V+K[J+2]);L.vertexLength+=k,L.primitiveLength+=K.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,m,M,w)}}Bn("FillBucket",fm,{omit:["layers","patternFeatures"]});const QE=new et({"fill-sort-key":new Ye(tt.layout_fill["fill-sort-key"])});var eC={paint:new et({"fill-antialias":new Xe(tt.paint_fill["fill-antialias"]),"fill-opacity":new Ye(tt.paint_fill["fill-opacity"]),"fill-color":new Ye(tt.paint_fill["fill-color"]),"fill-outline-color":new Ye(tt.paint_fill["fill-outline-color"]),"fill-translate":new Xe(tt.paint_fill["fill-translate"]),"fill-translate-anchor":new Xe(tt.paint_fill["fill-translate-anchor"]),"fill-pattern":new $t(tt.paint_fill["fill-pattern"])}),layout:QE};const tC=wn([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),nC=wn([{name:"a_centroid_pos",components:2,type:"Uint16"}]),{members:rC}=tC;var yy=rp;function rp(h,a,p,m,w){this.properties={},this.extent=p,this.type=0,this._pbf=h,this._geometry=-1,this._keys=m,this._values=w,h.readFields(iC,this,a)}function iC(h,a,p){1==h?a.id=p.readVarint():2==h?function(m,w){for(var M=m.readVarint()+m.pos;m.pos<M;){var D=w._keys[m.readVarint()],k=w._values[m.readVarint()];w.properties[D]=k}}(p,a):3==h?a.type=p.readVarint():4==h&&(a._geometry=p.pos)}function oC(h){for(var a,p,m=0,w=0,M=h.length,D=M-1;w<M;D=w++)m+=((p=h[D]).x-(a=h[w]).x)*(a.y+p.y);return m}rp.types=["Unknown","Point","LineString","Polygon"],rp.prototype.loadGeometry=function(){var h=this._pbf;h.pos=this._geometry;for(var a,p=h.readVarint()+h.pos,m=1,w=0,M=0,D=0,k=[];h.pos<p;){if(w<=0){var L=h.readVarint();m=7&L,w=L>>3}if(w--,1===m||2===m)M+=h.readSVarint(),D+=h.readSVarint(),1===m&&(a&&k.push(a),a=[]),a.push(new Ge(M,D));else{if(7!==m)throw new Error("unknown command "+m);a&&a.push(a[0].clone())}}return a&&k.push(a),k},rp.prototype.bbox=function(){var h=this._pbf;h.pos=this._geometry;for(var a=h.readVarint()+h.pos,p=1,m=0,w=0,M=0,D=1/0,k=-1/0,L=1/0,V=-1/0;h.pos<a;){if(m<=0){var $=h.readVarint();p=7&$,m=$>>3}if(m--,1===p||2===p)(w+=h.readSVarint())<D&&(D=w),w>k&&(k=w),(M+=h.readSVarint())<L&&(L=M),M>V&&(V=M);else if(7!==p)throw new Error("unknown command "+p)}return[D,L,k,V]},rp.prototype.toGeoJSON=function(h,a,p){var m,w,M=this.extent*Math.pow(2,p),D=this.extent*h,k=this.extent*a,L=this.loadGeometry(),V=rp.types[this.type];function $(J){for(var ge=0;ge<J.length;ge++){var Le=J[ge];J[ge]=[360*(Le.x+D)/M-180,360/Math.PI*Math.atan(Math.exp((180-360*(Le.y+k)/M)*Math.PI/180))-90]}}switch(this.type){case 1:var X=[];for(m=0;m<L.length;m++)X[m]=L[m][0];$(L=X);break;case 2:for(m=0;m<L.length;m++)$(L[m]);break;case 3:for(L=function(J){var ge=J.length;if(ge<=1)return[J];for(var Le,Ze,st=[],xt=0;xt<ge;xt++){var St=oC(J[xt]);0!==St&&(void 0===Ze&&(Ze=St<0),Ze===St<0?(Le&&st.push(Le),Le=[J[xt]]):Le.push(J[xt]))}return Le&&st.push(Le),st}(L),m=0;m<L.length;m++)for(w=0;w<L[m].length;w++)$(L[m][w])}1===L.length?L=L[0]:V="Multi"+V;var K={type:"Feature",geometry:{type:V,coordinates:L},properties:this.properties};return"id"in this&&(K.id=this.id),K};var S1=sC;function sC(h,a){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=h,this._keys=[],this._values=[],this._features=[],h.readFields(aC,this,a),this.length=this._features.length}function aC(h,a,p){15===h?a.version=p.readVarint():1===h?a.name=p.readString():5===h?a.extent=p.readVarint():2===h?a._features.push(p.pos):3===h?a._keys.push(p.readString()):4===h&&a._values.push(function(m){for(var w=null,M=m.readVarint()+m.pos;m.pos<M;){var D=m.readVarint()>>3;w=1===D?m.readString():2===D?m.readFloat():3===D?m.readDouble():4===D?m.readVarint64():5===D?m.readVarint():6===D?m.readSVarint():7===D?m.readBoolean():null}return w}(p))}function Yp(h,a,p){if(3===h){var m=new S1(p,p.readVarint()+p.pos);m.length&&(a[m.name]=m)}}sC.prototype.feature=function(h){if(h<0||h>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[h];var a=this._pbf.readVarint()+this._pbf.pos;return new yy(this._pbf,a,this.extent,this._keys,this._values)};var wd={VectorTile:function(h,a){this.layers=h.readFields(Yp,{},a)},VectorTileFeature:yy,VectorTileLayer:S1};const ch=wd.VectorTileFeature.types,Zp=Math.pow(2,13);function ip(h,a,p,m,w,M,D,k){h.emplaceBack((a<<1)+D,(p<<1)+M,(Math.floor(m*Zp)<<1)+w,Math.round(k))}class vy{constructor(){this.acc=new Ge(0,0),this.polyCount=[]}startRing(a){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new Ge(a.x,a.y),this.max=new Ge(a.x,a.y))}append(a,p){this.currentPolyCount.edges++,this.acc._add(a);let m=!!this.borders;const w=this.min,M=this.max;a.x<w.x?(w.x=a.x,m=!0):a.x>M.x&&(M.x=a.x,m=!0),a.y<w.y?(w.y=a.y,m=!0):a.y>M.y&&(M.y=a.y,m=!0),((0===a.x||a.x===Ao)&&a.x===p.x)!=((0===a.y||a.y===Ao)&&a.y===p.y)&&this.processBorderOverlap(a,p),m&&this.checkBorderIntersection(a,p)}checkBorderIntersection(a,p){p.x<0!=a.x<0&&this.addBorderIntersection(0,xr(p.y,a.y,(0-p.x)/(a.x-p.x))),p.x>Ao!=a.x>Ao&&this.addBorderIntersection(1,xr(p.y,a.y,(Ao-p.x)/(a.x-p.x))),p.y<0!=a.y<0&&this.addBorderIntersection(2,xr(p.x,a.x,(0-p.y)/(a.y-p.y))),p.y>Ao!=a.y>Ao&&this.addBorderIntersection(3,xr(p.x,a.x,(Ao-p.y)/(a.y-p.y)))}addBorderIntersection(a,p){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const m=this.borders[a];p<m[0]&&(m[0]=p),p>m[1]&&(m[1]=p)}processBorderOverlap(a,p){if(a.x===p.x){if(a.y===p.y)return;const m=0===a.x?0:1;this.addBorderIntersection(m,p.y),this.addBorderIntersection(m,a.y)}else{const m=0===a.y?2:3;this.addBorderIntersection(m,p.x),this.addBorderIntersection(m,a.x)}}centroid(){const a=this.polyCount.reduce((p,m)=>p+m.edges,0);return 0!==a?this.acc.div(a)._round():new Ge(0,0)}span(){return new Ge(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((a,p)=>a+ +(p[0]!==Number.MAX_VALUE),0)}}class pm{constructor(a){this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(p=>p.id),this.index=a.index,this.hasPattern=!1,this.layoutVertexArray=new gi,this.centroidVertexArray=new c1,this.indexArray=new ns,this.programConfigurations=new tf(a.layers,a.zoom),this.segments=new eu,this.stateDependentLayerIds=this.layers.filter(p=>p.isStateDependent()).map(p=>p.id),this.enableTerrain=a.enableTerrain}populate(a,p,m){this.features=[],this.hasPattern=mu("fill-extrusion",this.layers,p),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDone=[!1,!1,!1,!1],this.tileToMeter=function(w){const M=Math.exp(Math.PI*(1-w.y/(1<<w.z)*2));return 80150034*M/(M*M+1)/Ao/(1<<w.z)}(m);for(const{feature:w,id:M,index:D,sourceLayerIndex:k}of a){const L=this.layers[0]._featureFilter.needGeometry,V=Lc(w,L);if(!this.layers[0]._featureFilter.filter(new se(this.zoom),V,m))continue;const $={id:M,sourceLayerIndex:k,index:D,geometry:L?V.geometry:Hf(w),properties:w.properties,type:w.type,patterns:{}},X=this.layoutVertexArray.length;this.hasPattern?this.features.push(vc("fill-extrusion",this.layers,$,this.zoom,p)):this.addFeature($,$.geometry,D,m,{}),p.featureIndex.insert(w,$.geometry,D,k,this.index,X)}this.sortBorders()}addFeatures(a,p,m){for(const w of this.features){const{geometry:M}=w;this.addFeature(w,M,w.index,p,m)}this.sortBorders()}update(a,p,m){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,p,this.stateDependentLayers,m)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,rC),this.indexBuffer=a.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(a),this.uploaded=!0}uploadCentroid(a){0!==this.centroidVertexArray.length&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=a.createVertexBuffer(this.centroidVertexArray,nC.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(a,p,m,w,M){const D=this.enableTerrain?new vy:null;for(const L of _y(p,500)){let V=0,$=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);if(0===L.length||(k=L[0]).every(Le=>Le.x<=0)||k.every(Le=>Le.x>=Ao)||k.every(Le=>Le.y<=0)||k.every(Le=>Le.y>=Ao))continue;for(let Le=0;Le<L.length;Le++){const Ze=L[Le];if(0===Ze.length)continue;V+=Ze.length;let st=0;D&&D.startRing(Ze[0]);for(let xt=0;xt<Ze.length;xt++){const St=Ze[xt];if(xt>=1){const Dt=Ze[xt-1];if(!ZA(St,Dt)){D&&D.append(St,Dt),$.vertexLength+4>eu.MAX_VERTEX_ARRAY_LENGTH&&($=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const Rt=St.sub(Dt)._perp(),Pt=Rt.x/(Math.abs(Rt.x)+Math.abs(Rt.y)),tn=Rt.y>0?1:0,dn=Dt.dist(St);st+dn>32768&&(st=0),ip(this.layoutVertexArray,St.x,St.y,Pt,tn,0,0,st),ip(this.layoutVertexArray,St.x,St.y,Pt,tn,0,1,st),st+=dn,ip(this.layoutVertexArray,Dt.x,Dt.y,Pt,tn,0,0,st),ip(this.layoutVertexArray,Dt.x,Dt.y,Pt,tn,0,1,st);const en=$.vertexLength;this.indexArray.emplaceBack(en,en+2,en+1),this.indexArray.emplaceBack(en+1,en+2,en+3),$.vertexLength+=4,$.primitiveLength+=2}}}}if($.vertexLength+V>eu.MAX_VERTEX_ARRAY_LENGTH&&($=this.segments.prepareSegment(V,this.layoutVertexArray,this.indexArray)),"Polygon"!==ch[a.type])continue;const X=[],K=[],J=$.vertexLength;for(let Le=0;Le<L.length;Le++){const Ze=L[Le];if(0!==Ze.length){Ze!==L[0]&&K.push(X.length/2);for(let st=0;st<Ze.length;st++){const xt=Ze[st];ip(this.layoutVertexArray,xt.x,xt.y,0,0,1,1,0),X.push(xt.x),X.push(xt.y),D&&D.currentPolyCount.top++}}}const ge=my(X,K);for(let Le=0;Le<ge.length;Le+=3)this.indexArray.emplaceBack(J+ge[Le],J+ge[Le+2],J+ge[Le+1]);$.primitiveLength+=ge.length/3,$.vertexLength+=V}var k;if(D&&D.polyCount.length>0){if(D.borders){D.vertexArrayOffset=this.centroidVertexArray.length;const L=D.borders,V=this.featuresOnBorder.push(D)-1;for(let $=0;$<4;$++)L[$][0]!==Number.MAX_VALUE&&this.borders[$].push(V)}this.encodeCentroid(D.borders?void 0:D.centroid(),D)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,m,M,w)}sortBorders(){for(let a=0;a<4;a++)this.borders[a].sort((p,m)=>this.featuresOnBorder[p].borders[a][0]-this.featuresOnBorder[m].borders[a][0])}encodeCentroid(a,p,m=!0){let w,M;if(a)if(0!==a.y){const k=p.span()._mult(this.tileToMeter);w=(Math.max(a.x,1)<<3)+Math.min(7,Math.round(k.x/10)),M=(Math.max(a.y,1)<<3)+Math.min(7,Math.round(k.y/10))}else w=Math.ceil(7*(a.x+450)),M=0;else w=0,M=+m;let D=m?this.centroidVertexArray.length:p.vertexArrayOffset;for(const k of p.polyCount){m&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*k.edges+k.top);for(let L=0;L<2*k.edges;L++)this.centroidVertexArray.emplace(D++,0,M),this.centroidVertexArray.emplace(D++,w,M);for(let L=0;L<k.top;L++)this.centroidVertexArray.emplace(D++,w,M)}}}function ZA(h,a){return h.x===a.x&&(h.x<0||h.x>Ao)||h.y===a.y&&(h.y<0||h.y>Ao)}Bn("FillExtrusionBucket",pm,{omit:["layers","features"]}),Bn("PartMetadata",vy);var KA={paint:new et({"fill-extrusion-opacity":new Xe(tt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Ye(tt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Xe(tt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Xe(tt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new $t(tt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Ye(tt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Ye(tt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Xe(tt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})};function gm(h,a){return h.x*a.x+h.y*a.y}function mm(h,a){if(1===h.length){let p=0;const m=a[p++];let w;for(;!w||m.equals(w);)if(w=a[p++],!w)return 1/0;for(;p<a.length;p++){const M=a[p],D=h[0],k=w.sub(m),L=M.sub(m),V=D.sub(m),$=gm(k,k),X=gm(k,L),K=gm(L,L),J=gm(V,k),ge=gm(V,L),Le=$*K-X*X,Ze=(K*J-X*ge)/Le,st=($*ge-X*J)/Le,xt=m.z*(1-Ze-st)+w.z*Ze+M.z*st;if(isFinite(xt))return xt}return 1/0}{let p=1/0;for(const m of a)p=Math.min(p,m.z);return p}}function _m(h){const a=new Ge(h[0],h[1]);return a.z=h[2],a}function xy(h,a,p,m,w,M,D,k){const L=D*w.getElevationAt(h,a,!0,!0),V=0!==M[0],$=V?0===M[1]?D*(M[0]/7-450):D*function(X,K,J){const ge=Math.floor(K[0]/8),Le=Math.floor(K[1]/8),Ze=10*(K[0]-8*ge),st=10*(K[1]-8*Le),xt=X.getElevationAt(ge,Le,!0,!0),St=X.getMeterToDEM(J),Dt=Math.floor(.5*(Ze*St-1)),Rt=Math.floor(.5*(st*St-1)),Pt=X.tileCoordToPixel(ge,Le),tn=2*Dt+1,dn=2*Rt+1,en=(Hr=tn,$n=dn,[(kr=X).getElevationAtPixel($r=Pt.x-Dt,Kr=Pt.y-Rt,!0),kr.getElevationAtPixel($r+$n,Kr,!0),kr.getElevationAtPixel($r,Kr+$n,!0),kr.getElevationAtPixel($r+Hr,Kr+$n,!0)]),Tn=Math.abs(en[0]-en[1]),Xt=Math.abs(en[2]-en[3]),nn=Math.abs(en[0]-en[2])+Math.abs(en[1]-en[3]),Cn=Math.min(.25,.5*St*(Tn+Xt)/tn),Ht=Math.min(.25,.5*St*nn/dn);var kr,$r,Kr,Hr,$n;return xt+Math.max(Cn*Ze,Ht*st)}(w,M,k):L;return{base:L+(0===p)?-1:p,top:V?Math.max($+m,L+p+2):L+m}}const JA=wn([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:QA}=JA,M1=wn([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:lC}=M1,uC=wd.VectorTileFeature.types,cC=Math.cos(Math.PI/180*37.5);class by{constructor(a){this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(p=>p.id),this.index=a.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(p=>{this.gradients[p.id]={}}),this.layoutVertexArray=new yi,this.layoutVertexArray2=new uo,this.indexArray=new ns,this.programConfigurations=new tf(a.layers,a.zoom),this.segments=new eu,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(p=>p.isStateDependent()).map(p=>p.id)}populate(a,p,m){this.hasPattern=mu("line",this.layers,p);const w=this.layers[0].layout.get("line-sort-key"),M=[];for(const{feature:V,id:$,index:X,sourceLayerIndex:K}of a){const J=this.layers[0]._featureFilter.needGeometry,ge=Lc(V,J);if(!this.layers[0]._featureFilter.filter(new se(this.zoom),ge,m))continue;const Le=w?w.evaluate(ge,{},m):void 0,Ze={id:$,properties:V.properties,type:V.type,sourceLayerIndex:K,index:X,geometry:J?ge.geometry:Hf(V),patterns:{},sortKey:Le};M.push(Ze)}w&&M.sort((V,$)=>V.sortKey-$.sortKey);const{lineAtlas:D,featureIndex:k}=p,L=this.addConstantDashes(D);for(const V of M){const{geometry:$,index:X,sourceLayerIndex:K}=V;if(L&&this.addFeatureDashes(V,D),this.hasPattern){const J=vc("line",this.layers,V,this.zoom,p);this.patternFeatures.push(J)}else this.addFeature(V,$,X,m,D.positions);k.insert(a[X].feature,$,X,K,this.index)}}addConstantDashes(a){let p=!1;for(const m of this.layers){const w=m.paint.get("line-dasharray").value,M=m.layout.get("line-cap").value;if("constant"!==w.kind||"constant"!==M.kind)p=!0;else{const D=M.value,k=w.value;if(!k)continue;a.addDash(k.from,D),a.addDash(k.to,D),k.other&&a.addDash(k.other,D)}}return p}addFeatureDashes(a,p){const m=this.zoom;for(const w of this.layers){const M=w.paint.get("line-dasharray").value,D=w.layout.get("line-cap").value;if("constant"===M.kind&&"constant"===D.kind)continue;let k,L,V,$,X,K;if("constant"===M.kind){const Ze=M.value;if(!Ze)continue;k=Ze.other||Ze.to,L=Ze.to,V=Ze.from}else k=M.evaluate({zoom:m-1},a),L=M.evaluate({zoom:m},a),V=M.evaluate({zoom:m+1},a);"constant"===D.kind?$=X=K=D.value:($=D.evaluate({zoom:m-1},a),X=D.evaluate({zoom:m},a),K=D.evaluate({zoom:m+1},a)),p.addDash(k,$),p.addDash(L,X),p.addDash(V,K);const J=p.getKey(k,$),ge=p.getKey(L,X),Le=p.getKey(V,K);a.patterns[w.id]={min:J,mid:ge,max:Le}}}update(a,p,m){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,p,this.stateDependentLayers,m)}addFeatures(a,p,m){for(const w of this.patternFeatures)this.addFeature(w,w.geometry,w.index,p,m)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(a){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=a.createVertexBuffer(this.layoutVertexArray2,lC)),this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,QA),this.indexBuffer=a.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(a),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(a){if(a.properties&&a.properties.hasOwnProperty("mapbox_clip_start")&&a.properties.hasOwnProperty("mapbox_clip_end"))return{start:+a.properties.mapbox_clip_start,end:+a.properties.mapbox_clip_end}}addFeature(a,p,m,w,M){const D=this.layers[0].layout,k=D.get("line-join").evaluate(a,{}),L=D.get("line-cap").evaluate(a,{}),V=D.get("line-miter-limit"),$=D.get("line-round-limit");this.lineClips=this.lineFeatureClips(a);for(const X of p)this.addLine(X,a,k,L,V,$);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,m,M,w)}addLine(a,p,m,w,M,D){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let st=0;st<a.length-1;st++)this.totalDistance+=a[st].dist(a[st+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const k="Polygon"===uC[p.type];let L=a.length;for(;L>=2&&a[L-1].equals(a[L-2]);)L--;let V=0;for(;V<L-1&&a[V].equals(a[V+1]);)V++;if(L<(k?3:2))return;"bevel"===m&&(M=1.05);const $=this.overscaling<=16?122880/(512*this.overscaling):0,X=this.segments.prepareSegment(10*L,this.layoutVertexArray,this.indexArray);let K,J,ge,Le,Ze;this.e1=this.e2=-1,k&&(K=a[L-2],Ze=a[V].sub(K)._unit()._perp());for(let st=V;st<L;st++){if(ge=st===L-1?k?a[V+1]:void 0:a[st+1],ge&&a[st].equals(ge))continue;Ze&&(Le=Ze),K&&(J=K),K=a[st],Ze=ge?ge.sub(K)._unit()._perp():Le,Le=Le||Ze;let xt=Le.add(Ze);0===xt.x&&0===xt.y||xt._unit();const St=Le.x*Ze.x+Le.y*Ze.y,Dt=xt.x*Ze.x+xt.y*Ze.y,Rt=0!==Dt?1/Dt:1/0,Pt=2*Math.sqrt(2-2*Dt),tn=Dt<cC&&J&&ge,dn=Le.x*Ze.y-Le.y*Ze.x>0;if(tn&&st>V){const Xt=K.dist(J);if(Xt>2*$){const nn=K.sub(K.sub(J)._mult($/Xt)._round());this.updateDistance(J,nn),this.addCurrentVertex(nn,Le,0,0,X),J=nn}}const en=J&&ge;let Tn=en?m:k?"butt":w;if(en&&"round"===Tn&&(Rt<D?Tn="miter":Rt<=2&&(Tn="fakeround")),"miter"===Tn&&Rt>M&&(Tn="bevel"),"bevel"===Tn&&(Rt>2&&(Tn="flipbevel"),Rt<M&&(Tn="miter")),J&&this.updateDistance(J,K),"miter"===Tn)xt._mult(Rt),this.addCurrentVertex(K,xt,0,0,X);else if("flipbevel"===Tn){if(Rt>100)xt=Ze.mult(-1);else{const Xt=Rt*Le.add(Ze).mag()/Le.sub(Ze).mag();xt._perp()._mult(Xt*(dn?-1:1))}this.addCurrentVertex(K,xt,0,0,X),this.addCurrentVertex(K,xt.mult(-1),0,0,X)}else if("bevel"===Tn||"fakeround"===Tn){const Xt=-Math.sqrt(Rt*Rt-1),nn=dn?Xt:0,Cn=dn?0:Xt;if(J&&this.addCurrentVertex(K,Le,nn,Cn,X),"fakeround"===Tn){const Ht=Math.round(180*Pt/Math.PI/20);for(let kr=1;kr<Ht;kr++){let $r=kr/Ht;if(.5!==$r){const Hr=$r-.5;$r+=$r*Hr*($r-1)*((1.0904+St*(St*(3.55645-1.43519*St)-3.2452))*Hr*Hr+(.848013+St*(.215638*St-1.06021)))}const Kr=Ze.sub(Le)._mult($r)._add(Le)._unit()._mult(dn?-1:1);this.addHalfVertex(K,Kr.x,Kr.y,!1,dn,0,X)}}ge&&this.addCurrentVertex(K,Ze,-nn,-Cn,X)}else if("butt"===Tn)this.addCurrentVertex(K,xt,0,0,X);else if("square"===Tn){const Xt=J?1:-1;J||this.addCurrentVertex(K,xt,Xt,Xt,X),this.addCurrentVertex(K,xt,0,0,X),J&&this.addCurrentVertex(K,xt,Xt,Xt,X)}else"round"===Tn&&(J&&(this.addCurrentVertex(K,Le,0,0,X),this.addCurrentVertex(K,Le,1,1,X,!0)),ge&&(this.addCurrentVertex(K,Ze,-1,-1,X,!0),this.addCurrentVertex(K,Ze,0,0,X)));if(tn&&st<L-1){const Xt=K.dist(ge);if(Xt>2*$){const nn=K.add(ge.sub(K)._mult($/Xt)._round());this.updateDistance(K,nn),this.addCurrentVertex(nn,Ze,0,0,X),K=nn}}}}addCurrentVertex(a,p,m,w,M,D=!1){const k=p.y*w-p.x,L=-p.y-p.x*w;this.addHalfVertex(a,p.x+p.y*m,p.y-p.x*m,D,!1,m,M),this.addHalfVertex(a,k,L,D,!0,-w,M)}addHalfVertex({x:a,y:p},m,w,M,D,k,L){this.layoutVertexArray.emplaceBack((a<<1)+(M?1:0),(p<<1)+(D?1:0),Math.round(63*m)+128,Math.round(63*w)+128,1+(0===k?0:k<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length);const V=L.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,V),L.primitiveLength++),D?this.e2=V:this.e1=V}updateScaledDistance(){if(this.lineClips){const a=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=a*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(a,p){this.distance+=a.dist(p),this.updateScaledDistance()}}Bn("LineBucket",by,{omit:["layers","patternFeatures"]});const T1=new et({"line-cap":new Ye(tt.layout_line["line-cap"]),"line-join":new Ye(tt.layout_line["line-join"]),"line-miter-limit":new Xe(tt.layout_line["line-miter-limit"]),"line-round-limit":new Xe(tt.layout_line["line-round-limit"]),"line-sort-key":new Ye(tt.layout_line["line-sort-key"])});var Kp={paint:new et({"line-opacity":new Ye(tt.paint_line["line-opacity"]),"line-color":new Ye(tt.paint_line["line-color"]),"line-translate":new Xe(tt.paint_line["line-translate"]),"line-translate-anchor":new Xe(tt.paint_line["line-translate-anchor"]),"line-width":new Ye(tt.paint_line["line-width"]),"line-gap-width":new Ye(tt.paint_line["line-gap-width"]),"line-offset":new Ye(tt.paint_line["line-offset"]),"line-blur":new Ye(tt.paint_line["line-blur"]),"line-dasharray":new $t(tt.paint_line["line-dasharray"]),"line-pattern":new $t(tt.paint_line["line-pattern"]),"line-gradient":new Jt(tt.paint_line["line-gradient"])}),layout:T1};const wy=new class extends Ye{possiblyEvaluate(h,a){return a=new se(Math.floor(a.zoom),{now:a.now,fadeDuration:a.fadeDuration,zoomHistory:a.zoomHistory,transition:a.transition}),super.possiblyEvaluate(h,a)}evaluate(h,a,p,m){return a=be({},a,{zoom:Math.floor(a.zoom)}),super.evaluate(h,a,p,m)}}(Kp.paint.properties["line-width"].specification);function ym(h,a){return a>0?a+2*h:h}wy.useIntegerZoom=!0;const hC=wn([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),vs=wn([{name:"a_projected_pos",components:3,type:"Float32"}],4);wn([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const dC=wn([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),fC=wn([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);wn([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Jp=wn([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),D1=wn([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);wn([{name:"triangle",components:3,type:"Uint16"}]),wn([{type:"Float32",name:"anchorX"},{type:"Float32",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),wn([{type:"Float32",name:"anchorX"},{type:"Float32",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),wn([{type:"Float32",name:"offsetX"}]),wn([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);const hh=128;function Ey(h,a){const{expression:p}=a;if("constant"===p.kind)return{kind:"constant",layoutSize:p.evaluate(new se(h+1))};if("source"===p.kind)return{kind:"source"};{const{zoomStops:m,interpolationType:w}=p;let M=0;for(;M<m.length&&m[M]<=h;)M++;M=Math.max(0,M-1);let D=M;for(;D<m.length&&m[D]<h+1;)D++;D=Math.min(m.length-1,D);const k=m[M],L=m[D];return"composite"===p.kind?{kind:"composite",minZoom:k,maxZoom:L,interpolationType:w}:{kind:"camera",minZoom:k,maxZoom:L,minSize:p.evaluate(new se(k)),maxSize:p.evaluate(new se(L)),interpolationType:w}}}function vm(h,{uSize:a,uSizeT:p},{lowerSize:m,upperSize:w}){return"source"===h.kind?m/hh:"composite"===h.kind?xr(m/hh,w/hh,p):a}function op(h,a){let p=0,m=0;if("constant"===h.kind)m=h.layoutSize;else if("source"!==h.kind){const{interpolationType:w,minZoom:M,maxZoom:D}=h,k=w?le(ii.interpolationFactor(w,a,M,D),0,1):0;"camera"===h.kind?m=xr(h.minSize,h.maxSize,k):p=k}return{uSizeT:p,uSize:m}}var eP=Object.freeze({__proto__:null,getSizeData:Ey,evaluateSizeForFeature:vm,evaluateSizeForZoom:op,SIZE_PACK_FACTOR:hh});function tP(h,a,p){return h.sections.forEach(m=>{m.text=function(w,M,D){const k=M.layout.get("text-transform").evaluate(D,{});return"uppercase"===k?w=w.toLocaleUpperCase():"lowercase"===k&&(w=w.toLocaleLowerCase()),ie.applyArabicShaping&&(w=ie.applyArabicShaping(w)),w}(m.text,a,p)}),h}const Wh={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42"};function _u(h){return"\ufe36"===h||"\ufe48"===h||"\ufe38"===h||"\ufe44"===h||"\ufe42"===h||"\ufe3e"===h||"\ufe3c"===h||"\ufe3a"===h||"\ufe18"===h||"\ufe40"===h||"\ufe10"===h||"\ufe13"===h||"\ufe14"===h||"\uff40"===h||"\uffe3"===h||"\ufe11"===h||"\ufe12"===h}function Cy(h){return"\ufe35"===h||"\ufe47"===h||"\ufe37"===h||"\ufe43"===h||"\ufe41"===h||"\ufe3d"===h||"\ufe3b"===h||"\ufe39"===h||"\ufe17"===h||"\ufe3f"===h}var Sy=function(h,a,p,m,w){var M,D,k=8*w-m-1,L=(1<<k)-1,V=L>>1,$=-7,X=p?w-1:0,K=p?-1:1,J=h[a+X];for(X+=K,M=J&(1<<-$)-1,J>>=-$,$+=k;$>0;M=256*M+h[a+X],X+=K,$-=8);for(D=M&(1<<-$)-1,M>>=-$,$+=m;$>0;D=256*D+h[a+X],X+=K,$-=8);if(0===M)M=1-V;else{if(M===L)return D?NaN:1/0*(J?-1:1);D+=Math.pow(2,m),M-=V}return(J?-1:1)*D*Math.pow(2,M-m)},My=function(h,a,p,m,w,M){var D,k,L,V=8*M-w-1,$=(1<<V)-1,X=$>>1,K=23===w?Math.pow(2,-24)-Math.pow(2,-77):0,J=m?0:M-1,ge=m?1:-1,Le=a<0||0===a&&1/a<0?1:0;for(a=Math.abs(a),isNaN(a)||a===1/0?(k=isNaN(a)?1:0,D=$):(D=Math.floor(Math.log(a)/Math.LN2),a*(L=Math.pow(2,-D))<1&&(D--,L*=2),(a+=D+X>=1?K/L:K*Math.pow(2,1-X))*L>=2&&(D++,L/=2),D+X>=$?(k=0,D=$):D+X>=1?(k=(a*L-1)*Math.pow(2,w),D+=X):(k=a*Math.pow(2,X-1)*Math.pow(2,w),D=0));w>=8;h[p+J]=255&k,J+=ge,k/=256,w-=8);for(D=D<<w|k,V+=w;V>0;h[p+J]=255&D,J+=ge,D/=256,V-=8);h[p+J-ge]|=128*Le},Ha=io;function io(h){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(h)?h:new Uint8Array(h||0),this.pos=0,this.type=0,this.length=this.buf.length}io.Varint=0,io.Fixed64=1,io.Bytes=2,io.Fixed32=5;var Qp=4294967296,I1=1/Qp,A1="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function dh(h){return h.type===io.Bytes?h.readVarint()+h.pos:h.pos+1}function Ty(h,a,p){var m=a<=16383?1:a<=2097151?2:a<=268435455?3:Math.floor(Math.log(a)/(7*Math.LN2));p.realloc(m);for(var w=p.pos-1;w>=h;w--)p.buf[w+m]=p.buf[w]}function pC(h,a){for(var p=0;p<h.length;p++)a.writeVarint(h[p])}function P1(h,a){for(var p=0;p<h.length;p++)a.writeSVarint(h[p])}function gC(h,a){for(var p=0;p<h.length;p++)a.writeFloat(h[p])}function mC(h,a){for(var p=0;p<h.length;p++)a.writeDouble(h[p])}function _C(h,a){for(var p=0;p<h.length;p++)a.writeBoolean(h[p])}function R1(h,a){for(var p=0;p<h.length;p++)a.writeFixed32(h[p])}function Dy(h,a){for(var p=0;p<h.length;p++)a.writeSFixed32(h[p])}function O1(h,a){for(var p=0;p<h.length;p++)a.writeFixed64(h[p])}function yC(h,a){for(var p=0;p<h.length;p++)a.writeSFixed64(h[p])}function Iy(h,a){return(h[a]|h[a+1]<<8|h[a+2]<<16)+16777216*h[a+3]}function lf(h,a,p){h[p]=a,h[p+1]=a>>>8,h[p+2]=a>>>16,h[p+3]=a>>>24}function eg(h,a){return(h[a]|h[a+1]<<8|h[a+2]<<16)+(h[a+3]<<24)}function vC(h,a,p){a.glyphs=[],1===h&&p.readMessage(xC,a)}function xC(h,a,p){if(3===h){const{id:m,bitmap:w,width:M,height:D,left:k,top:L,advance:V}=p.readMessage(uf,{});a.glyphs.push({id:m,bitmap:new Hh({width:M+6,height:D+6},w),metrics:{width:M,height:D,left:k,top:L,advance:V}})}else 4===h?a.ascender=p.readSVarint():5===h&&(a.descender=p.readSVarint())}function uf(h,a,p){1===h?a.id=p.readVarint():2===h?a.bitmap=p.readBytes():3===h?a.width=p.readVarint():4===h?a.height=p.readVarint():5===h?a.left=p.readSVarint():6===h?a.top=p.readSVarint():7===h&&(a.advance=p.readVarint())}function Ay(h){let a=0,p=0;for(const D of h)a+=D.w*D.h,p=Math.max(p,D.w);h.sort((D,k)=>k.h-D.h);const m=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(a/.95)),p),h:1/0}];let w=0,M=0;for(const D of h)for(let k=m.length-1;k>=0;k--){const L=m[k];if(!(D.w>L.w||D.h>L.h)){if(D.x=L.x,D.y=L.y,M=Math.max(M,D.y+D.h),w=Math.max(w,D.x+D.w),D.w===L.w&&D.h===L.h){const V=m.pop();k<m.length&&(m[k]=V)}else D.h===L.h?(L.x+=D.w,L.w-=D.w):D.w===L.w?(L.y+=D.h,L.h-=D.h):(m.push({x:L.x+D.w,y:L.y,w:L.w-D.w,h:D.h}),L.y+=D.h,L.h-=D.h);break}}return{w,h:M,fill:a/(w*M)||0}}io.prototype={destroy:function(){this.buf=null},readFields:function(h,a,p){for(p=p||this.length;this.pos<p;){var m=this.readVarint(),w=m>>3,M=this.pos;this.type=7&m,h(w,a,this),this.pos===M&&this.skip(m)}return a},readMessage:function(h,a){return this.readFields(h,a,this.readVarint()+this.pos)},readFixed32:function(){var h=Iy(this.buf,this.pos);return this.pos+=4,h},readSFixed32:function(){var h=eg(this.buf,this.pos);return this.pos+=4,h},readFixed64:function(){var h=Iy(this.buf,this.pos)+Iy(this.buf,this.pos+4)*Qp;return this.pos+=8,h},readSFixed64:function(){var h=Iy(this.buf,this.pos)+eg(this.buf,this.pos+4)*Qp;return this.pos+=8,h},readFloat:function(){var h=Sy(this.buf,this.pos,!0,23,4);return this.pos+=4,h},readDouble:function(){var h=Sy(this.buf,this.pos,!0,52,8);return this.pos+=8,h},readVarint:function(h){var a,p,m=this.buf;return a=127&(p=m[this.pos++]),p<128?a:(a|=(127&(p=m[this.pos++]))<<7,p<128?a:(a|=(127&(p=m[this.pos++]))<<14,p<128?a:(a|=(127&(p=m[this.pos++]))<<21,p<128?a:function(w,M,D){var k,L,V=D.buf;if(k=(112&(L=V[D.pos++]))>>4,L<128||(k|=(127&(L=V[D.pos++]))<<3,L<128)||(k|=(127&(L=V[D.pos++]))<<10,L<128)||(k|=(127&(L=V[D.pos++]))<<17,L<128)||(k|=(127&(L=V[D.pos++]))<<24,L<128)||(k|=(1&(L=V[D.pos++]))<<31,L<128))return function(h,a,p){return p?4294967296*a+(h>>>0):4294967296*(a>>>0)+(h>>>0)}(w,k,M);throw new Error("Expected varint not more than 10 bytes")}(a|=(15&(p=m[this.pos]))<<28,h,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var h=this.readVarint();return h%2==1?(h+1)/-2:h/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var h=this.readVarint()+this.pos,a=this.pos;return this.pos=h,h-a>=12&&A1?A1.decode(this.buf.subarray(a,h)):function(p,m,w){for(var M="",D=m;D<w;){var k,L,V,$=p[D],X=null,K=$>239?4:$>223?3:$>191?2:1;if(D+K>w)break;1===K?$<128&&(X=$):2===K?128==(192&(k=p[D+1]))&&(X=(31&$)<<6|63&k)<=127&&(X=null):3===K?(L=p[D+2],128==(192&(k=p[D+1]))&&128==(192&L)&&((X=(15&$)<<12|(63&k)<<6|63&L)<=2047||X>=55296&&X<=57343)&&(X=null)):4===K&&(L=p[D+2],V=p[D+3],128==(192&(k=p[D+1]))&&128==(192&L)&&128==(192&V)&&((X=(15&$)<<18|(63&k)<<12|(63&L)<<6|63&V)<=65535||X>=1114112)&&(X=null)),null===X?(X=65533,K=1):X>65535&&(X-=65536,M+=String.fromCharCode(X>>>10&1023|55296),X=56320|1023&X),M+=String.fromCharCode(X),D+=K}return M}(this.buf,a,h)},readBytes:function(){var h=this.readVarint()+this.pos,a=this.buf.subarray(this.pos,h);return this.pos=h,a},readPackedVarint:function(h,a){if(this.type!==io.Bytes)return h.push(this.readVarint(a));var p=dh(this);for(h=h||[];this.pos<p;)h.push(this.readVarint(a));return h},readPackedSVarint:function(h){if(this.type!==io.Bytes)return h.push(this.readSVarint());var a=dh(this);for(h=h||[];this.pos<a;)h.push(this.readSVarint());return h},readPackedBoolean:function(h){if(this.type!==io.Bytes)return h.push(this.readBoolean());var a=dh(this);for(h=h||[];this.pos<a;)h.push(this.readBoolean());return h},readPackedFloat:function(h){if(this.type!==io.Bytes)return h.push(this.readFloat());var a=dh(this);for(h=h||[];this.pos<a;)h.push(this.readFloat());return h},readPackedDouble:function(h){if(this.type!==io.Bytes)return h.push(this.readDouble());var a=dh(this);for(h=h||[];this.pos<a;)h.push(this.readDouble());return h},readPackedFixed32:function(h){if(this.type!==io.Bytes)return h.push(this.readFixed32());var a=dh(this);for(h=h||[];this.pos<a;)h.push(this.readFixed32());return h},readPackedSFixed32:function(h){if(this.type!==io.Bytes)return h.push(this.readSFixed32());var a=dh(this);for(h=h||[];this.pos<a;)h.push(this.readSFixed32());return h},readPackedFixed64:function(h){if(this.type!==io.Bytes)return h.push(this.readFixed64());var a=dh(this);for(h=h||[];this.pos<a;)h.push(this.readFixed64());return h},readPackedSFixed64:function(h){if(this.type!==io.Bytes)return h.push(this.readSFixed64());var a=dh(this);for(h=h||[];this.pos<a;)h.push(this.readSFixed64());return h},skip:function(h){var a=7&h;if(a===io.Varint)for(;this.buf[this.pos++]>127;);else if(a===io.Bytes)this.pos=this.readVarint()+this.pos;else if(a===io.Fixed32)this.pos+=4;else{if(a!==io.Fixed64)throw new Error("Unimplemented type: "+a);this.pos+=8}},writeTag:function(h,a){this.writeVarint(h<<3|a)},realloc:function(h){for(var a=this.length||16;a<this.pos+h;)a*=2;if(a!==this.length){var p=new Uint8Array(a);p.set(this.buf),this.buf=p,this.length=a}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(h){this.realloc(4),lf(this.buf,h,this.pos),this.pos+=4},writeSFixed32:function(h){this.realloc(4),lf(this.buf,h,this.pos),this.pos+=4},writeFixed64:function(h){this.realloc(8),lf(this.buf,-1&h,this.pos),lf(this.buf,Math.floor(h*I1),this.pos+4),this.pos+=8},writeSFixed64:function(h){this.realloc(8),lf(this.buf,-1&h,this.pos),lf(this.buf,Math.floor(h*I1),this.pos+4),this.pos+=8},writeVarint:function(h){(h=+h||0)>268435455||h<0?function(a,p){var m,w,M,k;if(a>=0?(m=a%4294967296|0,w=a/4294967296|0):(w=~(-a/4294967296),4294967295^(m=~(-a%4294967296))?m=m+1|0:(m=0,w=w+1|0)),a>=0x10000000000000000||a<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");p.realloc(10),M=m,(k=p).buf[k.pos++]=127&M|128,M>>>=7,k.buf[k.pos++]=127&M|128,M>>>=7,k.buf[k.pos++]=127&M|128,M>>>=7,k.buf[k.pos++]=127&M|128,k.buf[k.pos]=127&(M>>>=7),function(M,D){var k=(7&M)<<4;D.buf[D.pos++]|=k|((M>>>=3)?128:0),M&&(D.buf[D.pos++]=127&M|((M>>>=7)?128:0),M&&(D.buf[D.pos++]=127&M|((M>>>=7)?128:0),M&&(D.buf[D.pos++]=127&M|((M>>>=7)?128:0),M&&(D.buf[D.pos++]=127&M|((M>>>=7)?128:0),M&&(D.buf[D.pos++]=127&M)))))}(w,p)}(h,this):(this.realloc(4),this.buf[this.pos++]=127&h|(h>127?128:0),h<=127||(this.buf[this.pos++]=127&(h>>>=7)|(h>127?128:0),h<=127||(this.buf[this.pos++]=127&(h>>>=7)|(h>127?128:0),h<=127||(this.buf[this.pos++]=h>>>7&127))))},writeSVarint:function(h){this.writeVarint(h<0?2*-h-1:2*h)},writeBoolean:function(h){this.writeVarint(Boolean(h))},writeString:function(h){h=String(h),this.realloc(4*h.length),this.pos++;var a=this.pos;this.pos=function(m,w,M){for(var D,k,L=0;L<w.length;L++){if((D=w.charCodeAt(L))>55295&&D<57344){if(!k){D>56319||L+1===w.length?(m[M++]=239,m[M++]=191,m[M++]=189):k=D;continue}if(D<56320){m[M++]=239,m[M++]=191,m[M++]=189,k=D;continue}D=k-55296<<10|D-56320|65536,k=null}else k&&(m[M++]=239,m[M++]=191,m[M++]=189,k=null);D<128?m[M++]=D:(D<2048?m[M++]=D>>6|192:(D<65536?m[M++]=D>>12|224:(m[M++]=D>>18|240,m[M++]=D>>12&63|128),m[M++]=D>>6&63|128),m[M++]=63&D|128)}return M}(this.buf,h,this.pos);var p=this.pos-a;p>=128&&Ty(a,p,this),this.pos=a-1,this.writeVarint(p),this.pos+=p},writeFloat:function(h){this.realloc(4),My(this.buf,h,this.pos,!0,23,4),this.pos+=4},writeDouble:function(h){this.realloc(8),My(this.buf,h,this.pos,!0,52,8),this.pos+=8},writeBytes:function(h){var a=h.length;this.writeVarint(a),this.realloc(a);for(var p=0;p<a;p++)this.buf[this.pos++]=h[p]},writeRawMessage:function(h,a){this.pos++;var p=this.pos;h(a,this);var m=this.pos-p;m>=128&&Ty(p,m,this),this.pos=p-1,this.writeVarint(m),this.pos+=m},writeMessage:function(h,a,p){this.writeTag(h,io.Bytes),this.writeRawMessage(a,p)},writePackedVarint:function(h,a){a.length&&this.writeMessage(h,pC,a)},writePackedSVarint:function(h,a){a.length&&this.writeMessage(h,P1,a)},writePackedBoolean:function(h,a){a.length&&this.writeMessage(h,_C,a)},writePackedFloat:function(h,a){a.length&&this.writeMessage(h,gC,a)},writePackedDouble:function(h,a){a.length&&this.writeMessage(h,mC,a)},writePackedFixed32:function(h,a){a.length&&this.writeMessage(h,R1,a)},writePackedSFixed32:function(h,a){a.length&&this.writeMessage(h,Dy,a)},writePackedFixed64:function(h,a){a.length&&this.writeMessage(h,O1,a)},writePackedSFixed64:function(h,a){a.length&&this.writeMessage(h,yC,a)},writeBytesField:function(h,a){this.writeTag(h,io.Bytes),this.writeBytes(a)},writeFixed32Field:function(h,a){this.writeTag(h,io.Fixed32),this.writeFixed32(a)},writeSFixed32Field:function(h,a){this.writeTag(h,io.Fixed32),this.writeSFixed32(a)},writeFixed64Field:function(h,a){this.writeTag(h,io.Fixed64),this.writeFixed64(a)},writeSFixed64Field:function(h,a){this.writeTag(h,io.Fixed64),this.writeSFixed64(a)},writeVarintField:function(h,a){this.writeTag(h,io.Varint),this.writeVarint(a)},writeSVarintField:function(h,a){this.writeTag(h,io.Varint),this.writeSVarint(a)},writeStringField:function(h,a){this.writeTag(h,io.Bytes),this.writeString(a)},writeFloatField:function(h,a){this.writeTag(h,io.Fixed32),this.writeFloat(a)},writeDoubleField:function(h,a){this.writeTag(h,io.Fixed64),this.writeDouble(a)},writeBooleanField:function(h,a){this.writeVarintField(h,Boolean(a))}};class Py{constructor(a,{pixelRatio:p,version:m,stretchX:w,stretchY:M,content:D}){this.paddedRect=a,this.pixelRatio=p,this.stretchX=w,this.stretchY=M,this.content=D,this.version=m}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class k1{constructor(a,p){const m={},w={};this.haveRenderCallbacks=[];const M=[];this.addImages(a,m,M),this.addImages(p,w,M);const{w:D,h:k}=Ay(M),L=new Iu({width:D||1,height:k||1});for(const V in a){const $=a[V],X=m[V].paddedRect;Iu.copy($.data,L,{x:0,y:0},{x:X.x+1,y:X.y+1},$.data)}for(const V in p){const $=p[V],X=w[V].paddedRect,K=X.x+1,J=X.y+1,ge=$.data.width,Le=$.data.height;Iu.copy($.data,L,{x:0,y:0},{x:K,y:J},$.data),Iu.copy($.data,L,{x:0,y:Le-1},{x:K,y:J-1},{width:ge,height:1}),Iu.copy($.data,L,{x:0,y:0},{x:K,y:J+Le},{width:ge,height:1}),Iu.copy($.data,L,{x:ge-1,y:0},{x:K-1,y:J},{width:1,height:Le}),Iu.copy($.data,L,{x:0,y:0},{x:K+ge,y:J},{width:1,height:Le})}this.image=L,this.iconPositions=m,this.patternPositions=w}addImages(a,p,m){for(const w in a){const M=a[w],D={x:0,y:0,w:M.data.width+2,h:M.data.height+2};m.push(D),p[w]=new Py(D,M),M.hasRenderCallback&&this.haveRenderCallbacks.push(w)}}patchUpdatedImages(a,p){a.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const m in a.updatedImages)this.patchUpdatedImage(this.iconPositions[m],a.getImage(m),p),this.patchUpdatedImage(this.patternPositions[m],a.getImage(m),p)}patchUpdatedImage(a,p,m){if(!a||!p||a.version===p.version)return;a.version=p.version;const[w,M]=a.tl;m.update(p.data,void 0,{x:w,y:M})}}Bn("ImagePosition",Py),Bn("ImageAtlas",k1);const Ju={horizontal:1,vertical:2,horizontalOnly:3};class tg{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(a,p){const m=new tg;return m.scale=a||1,m.fontStack=p,m}static forImage(a){const p=new tg;return p.imageName=a,p}}class Xh{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(a,p){const m=new Xh;for(let w=0;w<a.sections.length;w++){const M=a.sections[w];M.image?m.addImageSection(M):m.addTextSection(M,p)}return m}length(){return this.text.length}getSection(a){return this.sections[this.sectionIndex[a]]}getSections(){return this.sections}getSectionIndex(a){return this.sectionIndex[a]}getCharCode(a){return this.text.charCodeAt(a)}verticalizePunctuation(a){this.text=function(p,m){let w="";for(let M=0;M<p.length;M++){const D=p.charCodeAt(M+1)||null,k=p.charCodeAt(M-1)||null;w+=!m&&(D&&vn(D)&&!Wh[p[M+1]]||k&&vn(k)&&!Wh[p[M-1]])||!Wh[p[M]]?p[M]:Wh[p[M]]}return w}(this.text,a)}trim(){let a=0;for(let m=0;m<this.text.length&&ng[this.text.charCodeAt(m)];m++)a++;let p=this.text.length;for(let m=this.text.length-1;m>=0&&m>=a&&ng[this.text.charCodeAt(m)];m--)p--;this.text=this.text.substring(a,p),this.sectionIndex=this.sectionIndex.slice(a,p)}substring(a,p){const m=new Xh;return m.text=this.text.substring(a,p),m.sectionIndex=this.sectionIndex.slice(a,p),m.sections=this.sections,m}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((a,p)=>Math.max(a,this.sections[p].scale),0)}addTextSection(a,p){this.text+=a.text,this.sections.push(tg.forText(a.scale,a.fontStack||p));const m=this.sections.length-1;for(let w=0;w<a.text.length;++w)this.sectionIndex.push(m)}addImageSection(a){const p=a.image?a.image.name:"";if(0===p.length)return void Ke("Can't add FormattedSection with an empty image.");const m=this.getNextImageSectionCharCode();m?(this.text+=String.fromCharCode(m),this.sections.push(tg.forImage(p)),this.sectionIndex.push(this.sections.length-1)):Ke("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Pu(h,a,p,m,w,M,D,k,L,V,$,X,K,J,ge,Le){const Ze=Xh.fromFeature(h,w);let st;X===Ju.vertical&&Ze.verticalizePunctuation(K);const{processBidirectionalText:xt,processStyledBidirectionalText:St}=ie;if(xt&&1===Ze.sections.length){st=[];const Pt=xt(Ze.toString(),ky(Ze,V,M,a,m,J,ge));for(const tn of Pt){const dn=new Xh;dn.text=tn,dn.sections=Ze.sections;for(let en=0;en<tn.length;en++)dn.sectionIndex.push(0);st.push(dn)}}else if(St){st=[];const Pt=St(Ze.text,Ze.sectionIndex,ky(Ze,V,M,a,m,J,ge));for(const tn of Pt){const dn=new Xh;dn.text=tn[0],dn.sectionIndex=tn[1],dn.sections=Ze.sections,st.push(dn)}}else st=function(Pt,tn){const dn=[],en=Pt.text;let Tn=0;for(const Xt of tn)dn.push(Pt.substring(Tn,Xt)),Tn=Xt;return Tn<en.length&&dn.push(Pt.substring(Tn,en.length)),dn}(Ze,ky(Ze,V,M,a,m,J,ge));const Dt=[],Rt={positionedLines:Dt,text:Ze.toString(),top:$[1],bottom:$[1],left:$[0],right:$[0],writingMode:X,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(Pt,tn,dn,en,Tn,Xt,nn,Cn,Ht,kr,$r,Kr){let Hr=0,$n=0,Ho=0;const cr="right"===Cn?1:"left"===Cn?0:.5;let $s=!1;for(const zo of Tn){const qs=zo.getSections();for(const ks of qs){if(ks.imageName)continue;const ka=tn[ks.fontStack];if(ka&&($s=void 0!==ka.ascender&&void 0!==ka.descender,!$s))break}if(!$s)break}let Oa=0;for(const zo of Tn){zo.trim();const qs=zo.getMaxScale(),ks=24*(qs-1),ka={positionedGlyphs:[],lineOffset:0};Pt.positionedLines[Oa]=ka;const qa=ka.positionedGlyphs;let wo=0;if(!zo.length()){$n+=Xt,++Oa;continue}let ua=0,Ms=0;for(let pl=0;pl<zo.length();pl++){const Ls=zo.getSection(pl),ec=zo.getSectionIndex(pl),ls=zo.getCharCode(pl);let ci=Ls.scale,Ws=null,yu=null,tc=null,Nc=24,Fc=0;const Id=!(Ht===Ju.horizontal||!$r&&!zt(ls)||$r&&(ng[ls]||(Hs=ls,_s(Hs)||Rc(Hs)||Ql(Hs)||_(Hs)||j(Hs))));if(Ls.imageName){const mh=en[Ls.imageName];if(!mh)continue;tc=Ls.imageName,Pt.iconsInText=Pt.iconsInText||!0,yu=mh.paddedRect;const tl=mh.displaySize;ci=24*ci/Kr,Ws={width:tl[0],height:tl[1],left:1,top:-3,advance:Id?tl[1]:tl[0],localGlyph:!1},Fc=$s?-Ws.height*ci:24*qs-17-tl[1]*ci,Nc=Ws.advance;const _h=(Id?tl[0]:tl[1])*ci-24*qs;_h>0&&_h>wo&&(wo=_h)}else{const mh=dn[Ls.fontStack];if(!mh)continue;mh[ls]&&(yu=mh[ls]);const tl=tn[Ls.fontStack];if(!tl)continue;const _h=tl.glyphs[ls];if(!_h)continue;if(Ws=_h.metrics,Nc=8203!==ls?24:0,$s){const gf=void 0!==tl.ascender?Math.abs(tl.ascender):0,tu=void 0!==tl.descender?Math.abs(tl.descender):0,mf=(gf+tu)*ci;ua<mf&&(ua=mf,Ms=(gf-tu)/2*ci),Fc=-gf*ci}else Fc=24*(qs-ci)-17}Id?(Pt.verticalizable=!0,qa.push({glyph:ls,imageName:tc,x:Hr,y:$n+Fc,vertical:Id,scale:ci,localGlyph:Ws.localGlyph,fontStack:Ls.fontStack,sectionIndex:ec,metrics:Ws,rect:yu}),Hr+=Nc*ci+kr):(qa.push({glyph:ls,imageName:tc,x:Hr,y:$n+Fc,vertical:Id,scale:ci,localGlyph:Ws.localGlyph,fontStack:Ls.fontStack,sectionIndex:ec,metrics:Ws,rect:yu}),Hr+=Ws.advance*ci+kr)}0!==qa.length&&(Ho=Math.max(Hr-kr,Ho),$s?cf(qa,cr,wo,Ms,Xt*qs/2):cf(qa,cr,wo,0,Xt/2)),Hr=0;const ca=Xt*qs+wo;ka.lineOffset=Math.max(wo,ks),$n+=ca,++Oa}var Hs;const fl=$n,{horizontalAlign:Os,verticalAlign:xs}=Ly(nn);(function(zo,qs,ks,ka,qa,wo){const ua=(qs-ks)*qa,Ms=-wo*ka;for(const ca of zo)for(const pl of ca.positionedGlyphs)pl.x+=ua,pl.y+=Ms})(Pt.positionedLines,cr,Os,xs,Ho,fl),Pt.top+=-xs*fl,Pt.bottom=Pt.top+fl,Pt.left+=-Os*Ho,Pt.right=Pt.left+Ho,Pt.hasBaseline=$s}(Rt,a,p,m,st,D,k,L,X,V,K,Le),!function(Pt){for(const tn of Pt)if(0!==tn.positionedGlyphs.length)return!1;return!0}(Dt)&&Rt}const ng={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},bC={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function L1(h,a,p,m,w,M){if(a.imageName){const D=m[a.imageName];return D?D.displaySize[0]*a.scale*24/M+w:0}{const D=p[a.fontStack],k=D&&D.glyphs[h];return k?k.metrics.advance*a.scale+w:0}}function Ry(h,a,p,m){const w=Math.pow(h-a,2);return m?h<a?w/2:2*w:w+Math.abs(p)*p}function nP(h,a,p){let m=0;return 10===h&&(m-=1e4),p&&(m+=150),40!==h&&65288!==h||(m+=50),41!==a&&65289!==a||(m+=50),m}function Oy(h,a,p,m,w,M){let D=null,k=Ry(a,p,w,M);for(const L of m){const V=Ry(a-L.x,p,w,M)+L.badness;V<=k&&(D=L,k=V)}return{index:h,x:a,priorBreak:D,badness:k}}function N1(h){return h?N1(h.priorBreak).concat(h.index):[]}function ky(h,a,p,m,w,M,D){if("point"!==M)return[];if(!h)return[];const k=[],L=function(K,J,ge,Le,Ze,st){let xt=0;for(let St=0;St<K.length();St++){const Dt=K.getSection(St);xt+=L1(K.getCharCode(St),Dt,Le,Ze,J,st)}return xt/Math.max(1,Math.ceil(xt/ge))}(h,a,p,m,w,D),V=h.text.indexOf("\u200b")>=0;let $=0;for(let K=0;K<h.length();K++){const J=h.getSection(K),ge=h.getCharCode(K);if(ng[ge]||($+=L1(ge,J,m,w,a,D)),K<h.length()-1){const Le=!((X=ge)<11904||!(Al(X)||wr(X)||I(X)||d(X)||zh(X)||Xu(X)||Sr(X)||Su(X)||ja(X)||Bo(X)||Aa(X)||ne(X)||_c(X)||Il(X)||aa(X)||Mu(X)||la(X)||b(X)||rh(X)||nh(X)));(bC[ge]||Le||J.imageName)&&k.push(Oy(K+1,$,L,k,nP(ge,h.getCharCode(K+1),Le&&V),!1))}}var X;return N1(Oy(h.length(),$,L,k,0,!0))}function Ly(h){let a=.5,p=.5;switch(h){case"right":case"top-right":case"bottom-right":a=1;break;case"left":case"top-left":case"bottom-left":a=0}switch(h){case"bottom":case"bottom-right":case"bottom-left":p=1;break;case"top":case"top-right":case"top-left":p=0}return{horizontalAlign:a,verticalAlign:p}}function cf(h,a,p,m,w){if(!(a||p||m||w))return;const M=h.length-1,D=h[M],k=(D.x+D.metrics.advance*D.scale)*a;for(let L=0;L<=M;L++)h[L].x-=k,h[L].y+=p+m+w}function fh(h,a,p){const{horizontalAlign:m,verticalAlign:w}=Ly(p),M=a[0]-h.displaySize[0]*m,D=a[1]-h.displaySize[1]*w;return{image:h,top:D,bottom:D+h.displaySize[1],left:M,right:M+h.displaySize[0]}}function wC(h,a,p,m,w,M){const D=h.image;let k;if(D.content){const Ze=D.content,st=D.pixelRatio||1;k=[Ze[0]/st,Ze[1]/st,D.displaySize[0]-Ze[2]/st,D.displaySize[1]-Ze[3]/st]}const L=a.left*M,V=a.right*M;let $,X,K,J;"width"===p||"both"===p?(J=w[0]+L-m[3],X=w[0]+V+m[1]):(J=w[0]+(L+V-D.displaySize[0])/2,X=J+D.displaySize[0]);const ge=a.top*M,Le=a.bottom*M;return"height"===p||"both"===p?($=w[1]+ge-m[0],K=w[1]+Le+m[2]):($=w[1]+(ge+Le-D.displaySize[1])/2,K=$+D.displaySize[1]),{image:D,top:$,right:X,bottom:K,left:J,collisionPadding:k}}class hf extends Ge{constructor(a,p,m,w){super(a,p),this.angle=m,void 0!==w&&(this.segment=w)}clone(){return new hf(this.x,this.y,this.angle,this.segment)}}function Ny(h,a,p,m,w){if(void 0===a.segment)return!0;let M=a,D=a.segment+1,k=0;for(;k>-p/2;){if(D--,D<0)return!1;k-=h[D].dist(M),M=h[D]}k+=h[D].dist(h[D+1]),D++;const L=[];let V=0;for(;k<p/2;){const $=h[D],X=h[D+1];if(!X)return!1;let K=h[D-1].angleTo($)-$.angleTo(X);for(K=Math.abs((K+3*Math.PI)%(2*Math.PI)-Math.PI),L.push({distance:k,angleDelta:K}),V+=K;k-L[0].distance>m;)V-=L.shift().angleDelta;if(V>w)return!1;D++,k+=$.dist(X)}return!0}function EC(h){let a=0;for(let p=0;p<h.length-1;p++)a+=h[p].dist(h[p+1]);return a}function Ru(h,a,p){return h?.6*a*p:0}function xm(h,a){return Math.max(h?h.right-h.left:0,a?a.right-a.left:0)}function Fy(h,a,p,m,w,M){const D=Ru(p,w,M),k=xm(p,m)*M;let L=0;const V=EC(h)/2;for(let $=0;$<h.length-1;$++){const X=h[$],K=h[$+1],J=X.dist(K);if(L+J>V){const ge=(V-L)/J,Le=xr(X.x,K.x,ge),Ze=xr(X.y,K.y,ge),st=new hf(Le,Ze,K.angleTo(X),$);return!D||Ny(h,st,k,D,a)?st:void 0}L+=J}}function CC(h,a,p,m,w,M,D,k,L){const V=Ru(m,M,D),$=xm(m,w),X=$*D,K=0===h[0].x||h[0].x===L||0===h[0].y||h[0].y===L;return a-X<a/4&&(a=X+a/4),By(h,K?a/2*k%a:($/2+2*M)*D*k%a,a,V,p,X,K,!1,L)}function By(h,a,p,m,w,M,D,k,L){const V=M/2,$=EC(h);let X=0,K=a-p,J=[];for(let ge=0;ge<h.length-1;ge++){const Le=h[ge],Ze=h[ge+1],st=Le.dist(Ze),xt=Ze.angleTo(Le);for(;K+p<X+st;){K+=p;const St=(K-X)/st,Dt=xr(Le.x,Ze.x,St),Rt=xr(Le.y,Ze.y,St);if(Dt>=0&&Dt<L&&Rt>=0&&Rt<L&&K-V>=0&&K+V<=$){const Pt=new hf(Dt,Rt,xt,ge);Pt._round(),m&&!Ny(h,Pt,M,m,w)||J.push(Pt)}}X+=st}return k||J.length||D||(J=By(h,X/2,p,m,w,M,D,!0,L)),J}function ap(h,a,p,m,w){const M=[];for(let D=0;D<h.length;D++){const k=h[D];let L;for(let V=0;V<k.length-1;V++){let $=k[V],X=k[V+1];$.x<a&&X.x<a||($.x<a?$=new Ge(a,$.y+(a-$.x)/(X.x-$.x)*(X.y-$.y))._round():X.x<a&&(X=new Ge(a,$.y+(a-$.x)/(X.x-$.x)*(X.y-$.y))._round()),$.y<p&&X.y<p||($.y<p?$=new Ge($.x+(p-$.y)/(X.y-$.y)*(X.x-$.x),p)._round():X.y<p&&(X=new Ge($.x+(p-$.y)/(X.y-$.y)*(X.x-$.x),p)._round()),$.x>=m&&X.x>=m||($.x>=m?$=new Ge(m,$.y+(m-$.x)/(X.x-$.x)*(X.y-$.y))._round():X.x>=m&&(X=new Ge(m,$.y+(m-$.x)/(X.x-$.x)*(X.y-$.y))._round()),$.y>=w&&X.y>=w||($.y>=w?$=new Ge($.x+(w-$.y)/(X.y-$.y)*(X.x-$.x),w)._round():X.y>=w&&(X=new Ge($.x+(w-$.y)/(X.y-$.y)*(X.x-$.x),w)._round()),L&&$.equals(L[L.length-1])||(L=[$],M.push(L)),L.push(X)))))}}return M}Bn("Anchor",hf);var zy=df,F1=df,Ed=1e20;function df(h,a,p,m,w,M){this.fontSize=h||24,this.buffer=void 0===a?3:a,this.cutoff=m||.25,this.fontFamily=w||"sans-serif",this.fontWeight=M||"normal",this.radius=p||8;var D=this.size=this.fontSize+2*this.buffer,k=D+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=D,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textAlign="left",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(k*k),this.gridInner=new Float64Array(k*k),this.f=new Float64Array(k),this.z=new Float64Array(k+1),this.v=new Uint16Array(k),this.useMetrics=void 0!==this.ctx.measureText("A").actualBoundingBoxLeft,this.middle=Math.round(D/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function Vy(h,a,p,m,w,M){for(var D=0;D<a;D++)SC(h,D,a,p,m,w,M);for(var k=0;k<p;k++)SC(h,k*a,1,a,m,w,M)}function SC(h,a,p,m,w,M,D){var k,L,V,$;for(M[0]=0,D[0]=-Ed,D[1]=Ed,k=0;k<m;k++)w[k]=h[a+k*p];for(k=1,L=0,V=0;k<m;k++){do{V=(w[k]-w[$=M[L]]+k*k-$*$)/(k-$)/2}while(V<=D[L]&&--L>-1);M[++L]=k,D[L]=V,D[L+1]=Ed}for(k=0,L=0;k<m;k++){for(;D[L+1]<k;)L++;h[a+k*p]=w[$=M[L]]+(k-$)*(k-$)}}df.prototype._draw=function(h,a){var p,m,w,M,D,k,L,V,$,X=this.ctx.measureText(h),K=X.width,J=2*this.buffer;a&&this.useMetrics?(D=Math.floor(X.actualBoundingBoxAscent),V=this.buffer+Math.ceil(X.actualBoundingBoxAscent),k=this.buffer,L=this.buffer,p=(m=Math.min(this.size,Math.ceil(X.actualBoundingBoxRight-X.actualBoundingBoxLeft)))+J,w=(M=Math.min(this.size-k,Math.ceil(X.actualBoundingBoxAscent+X.actualBoundingBoxDescent)))+J,this.ctx.textBaseline="alphabetic"):(p=m=this.size,w=M=this.size,D=19*this.fontSize/24,k=L=0,V=this.middle,this.ctx.textBaseline="middle"),m&&M&&(this.ctx.clearRect(L,k,m,M),this.ctx.fillText(h,this.buffer,V),$=this.ctx.getImageData(L,k,m,M));var ge=new Uint8ClampedArray(p*w);return function(Le,Ze,st,xt,St,Dt,Rt){Dt.fill(Ed,0,Ze*st),Rt.fill(0,0,Ze*st);for(var Pt=(Ze-xt)/2,tn=0;tn<St;tn++)for(var dn=0;dn<xt;dn++){var en=(tn+Pt)*Ze+dn+Pt,Tn=Le.data[4*(tn*xt+dn)+3]/255;if(1===Tn)Dt[en]=0,Rt[en]=Ed;else if(0===Tn)Dt[en]=Ed,Rt[en]=0;else{var Xt=Math.max(0,.5-Tn),nn=Math.max(0,Tn-.5);Dt[en]=Xt*Xt,Rt[en]=nn*nn}}}($,p,w,m,M,this.gridOuter,this.gridInner),Vy(this.gridOuter,p,w,this.f,this.v,this.z),Vy(this.gridInner,p,w,this.f,this.v,this.z),function(Le,Ze,st,xt,St,Dt,Rt){for(var Pt=0;Pt<Ze*st;Pt++){var tn=Math.sqrt(xt[Pt])-Math.sqrt(St[Pt]);Le[Pt]=Math.round(255-255*(tn/Dt+Rt))}}(ge,p,w,this.gridOuter,this.gridInner,this.radius,this.cutoff),{data:ge,metrics:{width:m,height:M,sdfWidth:p,sdfHeight:w,top:D,left:0,advance:K}}},df.prototype.draw=function(h){return this._draw(h,!1).data},df.prototype.drawWithMetrics=function(h){return this._draw(h,!0)},zy.default=F1;const Cd={none:0,ideographs:1,all:2};class Sd{constructor(a,p,m){this.requestManager=a,this.localGlyphMode=p,this.localFontFamily=m,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(a){this.url=a}getGlyphs(a,p){const m=[];for(const w in a)for(const M of a[w])m.push({stack:w,id:M});he(m,({stack:w,id:M},D)=>{let k=this.entries[w];k||(k=this.entries[w]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let L=k.glyphs[M];if(void 0!==L)return void D(null,{stack:w,id:M,glyph:L});if(L=this._tinySDF(k,w,M),L)return k.glyphs[M]=L,void D(null,{stack:w,id:M,glyph:L});const V=Math.floor(M/256);if(256*V>65535)return void D(new Error("glyphs > 65535 not supported"));if(k.ranges[V])return void D(null,{stack:w,id:M,glyph:L});let $=k.requests[V];$||($=k.requests[V]=[],Sd.loadGlyphRange(w,V,this.url,this.requestManager,(X,K)=>{if(K){k.ascender=K.ascender,k.descender=K.descender;for(const J in K.glyphs)this._doesCharSupportLocalGlyph(+J)||(k.glyphs[+J]=K.glyphs[+J]);k.ranges[V]=!0}for(const J of $)J(X,K);delete k.requests[V]})),$.push((X,K)=>{X?D(X):K&&D(null,{stack:w,id:M,glyph:K.glyphs[M]||null})})},(w,M)=>{if(w)p(w);else if(M){const D={};for(const{stack:k,id:L,glyph:V}of M)void 0===D[k]&&(D[k]={}),void 0===D[k].glyphs&&(D[k].glyphs={}),D[k].glyphs[L]=V&&{id:V.id,bitmap:V.bitmap.clone(),metrics:V.metrics},D[k].ascender=this.entries[k].ascender,D[k].descender=this.entries[k].descender;p(null,D)}})}_doesCharSupportLocalGlyph(a){return this.localGlyphMode!==Cd.none&&(this.localGlyphMode===Cd.all?!!this.localFontFamily:!!this.localFontFamily&&(Bo(a)||l(a)||_c(a)||la(a))||Su(a))}_tinySDF(a,p,m){const w=this.localFontFamily;if(!w||!this._doesCharSupportLocalGlyph(m))return;let M=a.tinySDF;if(!M){let Le="400";/bold/i.test(p)?Le="900":/medium/i.test(p)?Le="500":/light/i.test(p)&&(Le="200"),M=a.tinySDF=new Sd.TinySDF(48,6,16,.25,w,Le)}if(this.localGlyphs[M.fontWeight][m])return this.localGlyphs[M.fontWeight][m];const{data:D,metrics:k}=M.drawWithMetrics(String.fromCharCode(m)),{sdfWidth:L,sdfHeight:V,width:$,height:X,left:K,top:J,advance:ge}=k;return this.localGlyphs[M.fontWeight][m]={id:m,bitmap:new Hh({width:L,height:V},D),metrics:{width:$/2,height:X/2,left:K/2,top:J/2-27,advance:ge/2,localGlyph:!0}}}}function Uy(h,a,p,m){const w=[],M=h.image,D=M.pixelRatio,k=M.paddedRect.w-2,L=M.paddedRect.h-2,V=h.right-h.left,$=h.bottom-h.top,X=M.stretchX||[[0,k]],K=M.stretchY||[[0,L]],J=(Xt,nn)=>Xt+nn[1]-nn[0],ge=X.reduce(J,0),Le=K.reduce(J,0),Ze=k-ge,st=L-Le;let xt=0,St=ge,Dt=0,Rt=Le,Pt=0,tn=Ze,dn=0,en=st;if(M.content&&m){const Xt=M.content;xt=bm(X,0,Xt[0]),Dt=bm(K,0,Xt[1]),St=bm(X,Xt[0],Xt[2]),Rt=bm(K,Xt[1],Xt[3]),Pt=Xt[0]-xt,dn=Xt[1]-Dt,tn=Xt[2]-Xt[0]-St,en=Xt[3]-Xt[1]-Rt}const Tn=(Xt,nn,Cn,Ht)=>{const kr=Em(Xt.stretch-xt,St,V,h.left),$r=Cm(Xt.fixed-Pt,tn,Xt.stretch,ge),Kr=Em(nn.stretch-Dt,Rt,$,h.top),Hr=Cm(nn.fixed-dn,en,nn.stretch,Le),$n=Em(Cn.stretch-xt,St,V,h.left),Ho=Cm(Cn.fixed-Pt,tn,Cn.stretch,ge),cr=Em(Ht.stretch-Dt,Rt,$,h.top),$s=Cm(Ht.fixed-dn,en,Ht.stretch,Le),Oa=new Ge(kr,Kr),Hs=new Ge($n,Kr),fl=new Ge($n,cr),Os=new Ge(kr,cr),xs=new Ge($r/D,Hr/D),zo=new Ge(Ho/D,$s/D),qs=a*Math.PI/180;if(qs){const qa=Math.sin(qs),wo=Math.cos(qs),ua=[wo,-qa,qa,wo];Oa._matMult(ua),Hs._matMult(ua),Os._matMult(ua),fl._matMult(ua)}const ks=Xt.stretch+Xt.fixed,ka=nn.stretch+nn.fixed;return{tl:Oa,tr:Hs,bl:Os,br:fl,tex:{x:M.paddedRect.x+1+ks,y:M.paddedRect.y+1+ka,w:Cn.stretch+Cn.fixed-ks,h:Ht.stretch+Ht.fixed-ka},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:xs,pixelOffsetBR:zo,minFontScaleX:tn/D/V,minFontScaleY:en/D/$,isSDF:p}};if(m&&(M.stretchX||M.stretchY)){const Xt=wm(X,Ze,ge),nn=wm(K,st,Le);for(let Cn=0;Cn<Xt.length-1;Cn++){const Ht=Xt[Cn],kr=Xt[Cn+1];for(let $r=0;$r<nn.length-1;$r++)w.push(Tn(Ht,nn[$r],kr,nn[$r+1]))}}else w.push(Tn({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:k+1},{fixed:0,stretch:L+1}));return w}function bm(h,a,p){let m=0;for(const w of h)m+=Math.max(a,Math.min(p,w[1]))-Math.max(a,Math.min(p,w[0]));return m}function wm(h,a,p){const m=[{fixed:-1,stretch:0}];for(const[w,M]of h){const D=m[m.length-1];m.push({fixed:w-D.stretch,stretch:D.stretch}),m.push({fixed:w-D.stretch,stretch:D.stretch+(M-w)})}return m.push({fixed:a+1,stretch:p}),m}function Em(h,a,p,m){return h/a*p+m}function Cm(h,a,p,m){return h-a*p/m}function MC(h,a,p,m){const w=a+h.positionedLines[m].lineOffset;return 0===m?p+w/2:p+(w+(a+h.positionedLines[m-1].lineOffset))/2}Sd.loadGlyphRange=function(h,a,p,m,w){const M=256*a,D=M+255,k=m.transformRequest(m.normalizeGlyphsURL(p).replace("{fontstack}",h).replace("{range}",`${M}-${D}`),Fs.Glyphs);Q(k,(L,V)=>{if(L)w(L);else if(V){const $={},X=new Ha(V).readFields(vC,{});for(const K of X.glyphs)$[K.id]=K;w(null,{glyphs:$,ascender:X.ascender,descender:X.descender})}})},Sd.TinySDF=zy;class TC{constructor(a=[],p=DC){if(this.data=a,this.length=this.data.length,this.compare=p,this.length>0)for(let m=(this.length>>1)-1;m>=0;m--)this._down(m)}push(a){this.data.push(a),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const a=this.data[0],p=this.data.pop();return this.length--,this.length>0&&(this.data[0]=p,this._down(0)),a}peek(){return this.data[0]}_up(a){const{data:p,compare:m}=this,w=p[a];for(;a>0;){const M=a-1>>1,D=p[M];if(m(w,D)>=0)break;p[a]=D,a=M}p[a]=w}_down(a){const{data:p,compare:m}=this,w=this.length>>1,M=p[a];for(;a<w;){let D=1+(a<<1),k=p[D];const L=D+1;if(L<this.length&&m(p[L],k)<0&&(D=L,k=p[L]),m(k,M)>=0)break;p[a]=k,a=D}p[a]=M}}function DC(h,a){return h<a?-1:h>a?1:0}function IC(h,a=1,p=!1){let m=1/0,w=1/0,M=-1/0,D=-1/0;const k=h[0];for(let J=0;J<k.length;J++){const ge=k[J];(!J||ge.x<m)&&(m=ge.x),(!J||ge.y<w)&&(w=ge.y),(!J||ge.x>M)&&(M=ge.x),(!J||ge.y>D)&&(D=ge.y)}const L=Math.min(M-m,D-w);let V=L/2;const $=new TC([],B1);if(0===L)return new Ge(m,w);for(let J=m;J<M;J+=L)for(let ge=w;ge<D;ge+=L)$.push(new Md(J+V,ge+V,V,h));let X=function(J){let ge=0,Le=0,Ze=0;const st=J[0];for(let xt=0,St=st.length,Dt=St-1;xt<St;Dt=xt++){const Rt=st[xt],Pt=st[Dt],tn=Rt.x*Pt.y-Pt.x*Rt.y;Le+=(Rt.x+Pt.x)*tn,Ze+=(Rt.y+Pt.y)*tn,ge+=3*tn}return new Md(Le/ge,Ze/ge,0,J)}(h),K=$.length;for(;$.length;){const J=$.pop();(J.d>X.d||!X.d)&&(X=J,p&&console.log("found best %d after %d probes",Math.round(1e4*J.d)/1e4,K)),J.max-X.d<=a||(V=J.h/2,$.push(new Md(J.p.x-V,J.p.y-V,V,h)),$.push(new Md(J.p.x+V,J.p.y-V,V,h)),$.push(new Md(J.p.x-V,J.p.y+V,V,h)),$.push(new Md(J.p.x+V,J.p.y+V,V,h)),K+=4)}return p&&(console.log(`num probes: ${K}`),console.log(`best distance: ${X.d}`)),X.p}function B1(h,a){return a.max-h.max}function Md(h,a,p,m){this.p=new Ge(h,a),this.h=p,this.d=function(w,M){let D=!1,k=1/0;for(let L=0;L<M.length;L++){const V=M[L];for(let $=0,X=V.length,K=X-1;$<X;K=$++){const J=V[$],ge=V[K];J.y>w.y!=ge.y>w.y&&w.x<(ge.x-J.x)*(w.y-J.y)/(ge.y-J.y)+J.x&&(D=!D),k=Math.min(k,vd(w,J,ge))}}return(D?1:-1)*Math.sqrt(k)}(this.p,m),this.max=this.d+this.h*Math.SQRT2}const Sm=Number.POSITIVE_INFINITY,jy=Math.sqrt(2);function z1(h,a){return a[1]!==Sm?function(p,m,w){let M=0,D=0;switch(m=Math.abs(m),w=Math.abs(w),p){case"top-right":case"top-left":case"top":D=w-7;break;case"bottom-right":case"bottom-left":case"bottom":D=7-w}switch(p){case"top-right":case"bottom-right":case"right":M=-m;break;case"top-left":case"bottom-left":case"left":M=m}return[M,D]}(h,a[0],a[1]):function(p,m){let w=0,M=0;m<0&&(m=0);const D=m/jy;switch(p){case"top-right":case"top-left":M=D-7;break;case"bottom-right":case"bottom-left":M=7-D;break;case"bottom":M=7-m;break;case"top":M=m-7}switch(p){case"top-right":case"bottom-right":w=-D;break;case"top-left":case"bottom-left":w=D;break;case"left":w=m;break;case"right":w=-m}return[w,M]}(h,a[0])}function AC(h,a,p,m,w,M,D,k){h.createArrays(),h.tilePixelRatio=Ao/(512*h.overscaling),h.compareText={},h.iconsNeedLinear=!1;const L=h.layers[0].layout,V=h.layers[0]._unevaluatedLayout._values,$={};if("composite"===h.textSizeData.kind){const{minZoom:J,maxZoom:ge}=h.textSizeData;$.compositeTextSizes=[V["text-size"].possiblyEvaluate(new se(J),D),V["text-size"].possiblyEvaluate(new se(ge),D)]}if("composite"===h.iconSizeData.kind){const{minZoom:J,maxZoom:ge}=h.iconSizeData;$.compositeIconSizes=[V["icon-size"].possiblyEvaluate(new se(J),D),V["icon-size"].possiblyEvaluate(new se(ge),D)]}$.layoutTextSize=V["text-size"].possiblyEvaluate(new se(k+1),D),$.layoutIconSize=V["icon-size"].possiblyEvaluate(new se(k+1),D),$.textMaxSize=V["text-size"].possiblyEvaluate(new se(18),D);const X="map"===L.get("text-rotation-alignment")&&"point"!==L.get("symbol-placement"),K=L.get("text-size");for(const J of h.features){const ge=L.get("text-font").evaluate(J,{},D).join(","),Le=K.evaluate(J,{},D),Ze=$.layoutTextSize.evaluate(J,{},D),st=($.layoutIconSize.evaluate(J,{},D),{horizontal:{},vertical:void 0}),xt=J.text;let St,Dt=[0,0];if(xt){const tn=xt.toString(),dn=24*L.get("text-letter-spacing").evaluate(J,{},D),en=24*L.get("text-line-height").evaluate(J,{},D),Tn=it(tn)?dn:0,Xt=L.get("text-anchor").evaluate(J,{},D),nn=L.get("text-variable-anchor");if(!nn){const Hr=L.get("text-radial-offset").evaluate(J,{},D);Dt=Hr?z1(Xt,[24*Hr,Sm]):L.get("text-offset").evaluate(J,{},D).map($n=>24*$n)}let Cn=X?"center":L.get("text-justify").evaluate(J,{},D);const Ht=L.get("symbol-placement"),kr="point"===Ht,$r="point"===Ht?24*L.get("text-max-width").evaluate(J,{},D):0,Kr=Hr=>{h.allowVerticalPlacement&&Ee(tn)&&(st.vertical=Pu(xt,a,p,w,ge,$r,en,Xt,Hr,Tn,Dt,Ju.vertical,!0,Ht,Ze,Le))};if(!X&&nn){const Hr="auto"===Cn?nn.map(Ho=>Mm(Ho)):[Cn];let $n=!1;for(let Ho=0;Ho<Hr.length;Ho++){const cr=Hr[Ho];if(!st.horizontal[cr])if($n)st.horizontal[cr]=st.horizontal[0];else{const $s=Pu(xt,a,p,w,ge,$r,en,"center",cr,Tn,Dt,Ju.horizontal,!1,Ht,Ze,Le);$s&&(st.horizontal[cr]=$s,$n=1===$s.positionedLines.length)}}Kr("left")}else{if("auto"===Cn&&(Cn=Mm(Xt)),kr||L.get("text-writing-mode").indexOf("horizontal")>=0||!Ee(tn)){const Hr=Pu(xt,a,p,w,ge,$r,en,Xt,Cn,Tn,Dt,Ju.horizontal,!1,Ht,Ze,Le);Hr&&(st.horizontal[Cn]=Hr)}Kr("point"===Ht?"left":Cn)}}let Rt=!1;if(J.icon&&J.icon.name){const tn=m[J.icon.name];tn&&(St=fh(w[J.icon.name],L.get("icon-offset").evaluate(J,{},D),L.get("icon-anchor").evaluate(J,{},D)),Rt=tn.sdf,void 0===h.sdfIcons?h.sdfIcons=tn.sdf:h.sdfIcons!==tn.sdf&&Ke("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(tn.pixelRatio!==h.pixelRatio||0!==L.get("icon-rotate").constantOr(1))&&(h.iconsNeedLinear=!0))}const Pt=$y(st.horizontal)||st.vertical;h.iconsInText||(h.iconsInText=!!Pt&&Pt.iconsInText),(Pt||St)&&V1(h,J,st,St,m,$,Ze,0,Dt,Rt,D)}M&&h.generateCollisionDebugBuffers(k,h.collisionBoxArray)}function Mm(h){switch(h){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function V1(h,a,p,m,w,M,D,k,L,V,$){let X=M.textMaxSize.evaluate(a,{},$);void 0===X&&(X=D);const K=h.layers[0].layout,J=K.get("icon-offset").evaluate(a,{},$),ge=$y(p.horizontal)||p.vertical,Le=D/24,Ze=h.tilePixelRatio*X/24,st=h.tilePixelRatio*K.get("symbol-spacing"),xt=K.get("text-padding")*h.tilePixelRatio,St=K.get("icon-padding")*h.tilePixelRatio,Dt=an(K.get("text-max-angle")),Rt="map"===K.get("text-rotation-alignment")&&"point"!==K.get("symbol-placement"),Pt="map"===K.get("icon-rotation-alignment")&&"point"!==K.get("symbol-placement"),tn=K.get("symbol-placement"),dn=st/2,en=K.get("icon-text-fit");let Tn;m&&"none"!==en&&(h.allowVerticalPlacement&&p.vertical&&(Tn=wC(m,p.vertical,en,K.get("icon-text-fit-padding"),J,Le)),ge&&(m=wC(m,ge,en,K.get("icon-text-fit-padding"),J,Le)));const Xt=(nn,Cn)=>{Cn.x<0||Cn.x>=Ao||Cn.y<0||Cn.y>=Ao||function(Ht,kr,$r,Kr,Hr,$n,Ho,cr,$s,Oa,Hs,fl,Os,xs,zo,qs,ks,ka,qa,wo,ua,Ms,ca,pl){const Ls=Ht.addToLineVertexArray(kr,$r);let ec,ls,ci,Ws,yu,tc,Nc,Fc=0,Id=0,mh=0,tl=0,_h=-1,gf=-1;const tu={};let mf=Vp(""),ov=0,cg=0;if(void 0===cr._unevaluatedLayout.getValue("text-radial-offset")?[ov,cg]=cr.layout.get("text-offset").evaluate(wo,{},ca).map(ku=>24*ku):(ov=24*cr.layout.get("text-radial-offset").evaluate(wo,{},ca),cg=Sm),Ht.allowVerticalPlacement&&Kr.vertical){const ku=Kr.vertical;if(xs)tc=lp(ku),Ho&&(Nc=lp(Ho));else{const nu=cr.layout.get("text-rotate").evaluate(wo,{},ca)+90;ci=Tm($s,kr,Oa,Hs,fl,ku,Os,nu,zo),Ho&&(Ws=Tm($s,kr,Oa,Hs,fl,Ho,ks,nu))}}if(Hr){const ku=cr.layout.get("icon-rotate").evaluate(wo,{},ca),nu="none"!==cr.layout.get("icon-text-fit"),zm=Uy(Hr,ku,Ms,nu),sv=Ho?Uy(Ho,ku,Ms,nu):void 0;ls=Tm($s,kr,Oa,Hs,fl,Hr,ks,ku),Fc=4*zm.length;const av=Ht.iconSizeData;let Ad=null;"source"===av.kind?(Ad=[hh*cr.layout.get("icon-size").evaluate(wo,{},ca)],Ad[0]>Ou&&Ke(`${Ht.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):"composite"===av.kind&&(Ad=[hh*ua.compositeIconSizes[0].evaluate(wo,{},ca),hh*ua.compositeIconSizes[1].evaluate(wo,{},ca)],(Ad[0]>Ou||Ad[1]>Ou)&&Ke(`${Ht.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),Ht.addSymbols(Ht.icon,zm,Ad,qa,ka,wo,!1,kr,Ls.lineStartIndex,Ls.lineLength,-1,ca),_h=Ht.icon.placedSymbolArray.length-1,sv&&(Id=4*sv.length,Ht.addSymbols(Ht.icon,sv,Ad,qa,ka,wo,Ju.vertical,kr,Ls.lineStartIndex,Ls.lineLength,-1,ca),gf=Ht.icon.placedSymbolArray.length-1)}for(const ku in Kr.horizontal){const nu=Kr.horizontal[ku];ec||(mf=Vp(nu.text),xs?yu=lp(nu):ec=Tm($s,kr,Oa,Hs,fl,nu,Os,cr.layout.get("text-rotate").evaluate(wo,{},ca),zo));const zm=1===nu.positionedLines.length;if(mh+=Gy(Ht,kr,nu,$n,cr,xs,wo,zo,Ls,Kr.vertical?Ju.horizontal:Ju.horizontalOnly,zm?Object.keys(Kr.horizontal):[ku],tu,_h,ua,ca),zm)break}Kr.vertical&&(tl+=Gy(Ht,kr,Kr.vertical,$n,cr,xs,wo,zo,Ls,Ju.vertical,["vertical"],tu,gf,ua,ca));let Bc=-1;const Bm=(ku,nu)=>ku?Math.max(ku,nu):nu;Bc=Bm(yu,Bc),Bc=Bm(tc,Bc),Bc=Bm(Nc,Bc);const tx=Bc>-1?1:0;tx&&(Bc*=pl/24),Ht.glyphOffsetArray.length>=Yh.MAX_GLYPHS&&Ke("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==wo.sortKey&&Ht.addToSortKeyRanges(Ht.symbolInstances.length,wo.sortKey),Ht.symbolInstances.emplaceBack(kr.x,kr.y,tu.right>=0?tu.right:-1,tu.center>=0?tu.center:-1,tu.left>=0?tu.left:-1,tu.vertical>=0?tu.vertical:-1,_h,gf,mf,void 0!==ec?ec:Ht.collisionBoxArray.length,void 0!==ec?ec+1:Ht.collisionBoxArray.length,void 0!==ci?ci:Ht.collisionBoxArray.length,void 0!==ci?ci+1:Ht.collisionBoxArray.length,void 0!==ls?ls:Ht.collisionBoxArray.length,void 0!==ls?ls+1:Ht.collisionBoxArray.length,Ws||Ht.collisionBoxArray.length,Ws?Ws+1:Ht.collisionBoxArray.length,Oa,mh,tl,Fc,Id,tx,0,ov,cg,Bc)}(h,Cn,nn,p,m,w,Tn,h.layers[0],h.collisionBoxArray,a.index,a.sourceLayerIndex,h.index,xt,Rt,L,0,St,Pt,J,a,M,V,$,D)};if("line"===tn)for(const nn of ap(a.geometry,0,0,Ao,Ao)){const Cn=CC(nn,st,Dt,p.vertical||ge,m,24,Ze,h.overscaling,Ao);for(const Ht of Cn){const kr=ge;kr&&PC(h,kr.text,dn,Ht)||Xt(nn,Ht)}}else if("line-center"===tn){for(const nn of a.geometry)if(nn.length>1){const Cn=Fy(nn,Dt,p.vertical||ge,m,24,Ze);Cn&&Xt(nn,Cn)}}else if("Polygon"===a.type)for(const nn of _y(a.geometry,0)){const Cn=IC(nn,16);Xt(nn[0],new hf(Cn.x,Cn.y,0))}else if("LineString"===a.type)for(const nn of a.geometry)Xt(nn,new hf(nn[0].x,nn[0].y,0));else if("Point"===a.type)for(const nn of a.geometry)for(const Cn of nn)Xt([Cn],new hf(Cn.x,Cn.y,0))}const Ou=32640;function Gy(h,a,p,m,w,M,D,k,L,V,$,X,K,J,ge){const Le=function(xt,St,Dt,Rt,Pt,tn,dn,en){const Tn=[];if(0===St.positionedLines.length)return Tn;const Xt=Rt.layout.get("text-rotate").evaluate(tn,{})*Math.PI/180,nn=function(Kr){const Hr=Kr[0],$n=Kr[1],Ho=Hr*$n;return Ho>0?[Hr,-$n]:Ho<0?[-Hr,$n]:0===Hr?[$n,Hr]:[$n,-Hr]}(Dt);let Cn=Math.abs(St.top-St.bottom);for(const Kr of St.positionedLines)Cn-=Kr.lineOffset;const Ht=St.positionedLines.length,kr=Cn/Ht;let $r=St.top-Dt[1];for(let Kr=0;Kr<Ht;++Kr){const Hr=St.positionedLines[Kr];$r=MC(St,kr,$r,Kr);for(const $n of Hr.positionedGlyphs){if(!$n.rect)continue;const Ho=$n.rect||{};let cr=4,$s=!0,Oa=1,Hs=0;const fl=(Pt||en)&&$n.vertical,Os=$n.metrics.advance*$n.scale/2,xs=$n.metrics,zo=$n.rect;if(null===zo)continue;if(en&&St.verticalizable&&(Hs=$n.imageName?Os-$n.metrics.width*$n.scale/2:0),$n.imageName){const ci=dn[$n.imageName];if(!ci)continue;$s=ci.sdf,Oa=ci.pixelRatio,cr=1/Oa}const qs=Pt?[$n.x+Os,$n.y]:[0,0];let ks=[0,0],ka=[0,0],qa=!1;Pt||(fl?(ka=[$n.x+Os+nn[0],$n.y+nn[1]-Hs],qa=!0):ks=[$n.x+Os+Dt[0],$n.y+Dt[1]-Hs]);const wo=zo.w*$n.scale/(Oa*($n.localGlyph?2:1)),ua=zo.h*$n.scale/(Oa*($n.localGlyph?2:1));let Ms,ca,pl,Ls;if(fl){const ci=$n.y-$r,Ws=new Ge(-Os,Os-ci),yu=-Math.PI/2,tc=new Ge(...ka);Ms=new Ge(-Os+ks[0],ks[1]),Ms._rotateAround(yu,Ws)._add(tc),Ms.x+=-ci+Os,Ms.y-=(xs.left-cr)*$n.scale;const Nc=$n.imageName?xs.advance*$n.scale:24*$n.scale,Fc=String.fromCharCode($n.glyph);_u(Fc)?Ms.x+=(1-cr)*$n.scale:Cy(Fc)?Ms.x+=Nc-xs.height*$n.scale+(-cr-1)*$n.scale:Ms.x+=$n.imageName||xs.width+2*cr===zo.w&&xs.height+2*cr===zo.h?(Nc-ua)/2:(Nc-(xs.height+2*cr)*$n.scale)/2,ca=new Ge(Ms.x,Ms.y-wo),pl=new Ge(Ms.x+ua,Ms.y),Ls=new Ge(Ms.x+ua,Ms.y-wo)}else{const ci=(xs.left-cr)*$n.scale-Os+ks[0],Ws=(-xs.top-cr)*$n.scale+ks[1],yu=ci+wo,tc=Ws+ua;Ms=new Ge(ci,Ws),ca=new Ge(yu,Ws),pl=new Ge(ci,tc),Ls=new Ge(yu,tc)}if(Xt){let ci;ci=Pt?new Ge(0,0):qa?new Ge(nn[0],nn[1]):new Ge(Dt[0],Dt[1]),Ms._rotateAround(Xt,ci),ca._rotateAround(Xt,ci),pl._rotateAround(Xt,ci),Ls._rotateAround(Xt,ci)}const ec=new Ge(0,0),ls=new Ge(0,0);Tn.push({tl:Ms,tr:ca,bl:pl,br:Ls,tex:Ho,writingMode:St.writingMode,glyphOffset:qs,sectionIndex:$n.sectionIndex,isSDF:$s,pixelOffsetTL:ec,pixelOffsetBR:ls,minFontScaleX:0,minFontScaleY:0})}}return Tn}(0,p,k,w,M,D,m,h.allowVerticalPlacement),Ze=h.textSizeData;let st=null;"source"===Ze.kind?(st=[hh*w.layout.get("text-size").evaluate(D,{},ge)],st[0]>Ou&&Ke(`${h.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):"composite"===Ze.kind&&(st=[hh*J.compositeTextSizes[0].evaluate(D,{},ge),hh*J.compositeTextSizes[1].evaluate(D,{},ge)],(st[0]>Ou||st[1]>Ou)&&Ke(`${h.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),h.addSymbols(h.text,Le,st,k,M,D,V,a,L.lineStartIndex,L.lineLength,K,ge);for(const xt of $)X[xt]=h.text.placedSymbolArray.length-1;return 4*Le.length}function $y(h){for(const a in h)return h[a];return null}function Tm(h,a,p,m,w,M,D,k,L){let V=M.top,$=M.bottom,X=M.left,K=M.right;const J=M.collisionPadding;if(J&&(X-=J[0],V-=J[1],K+=J[2],$+=J[3]),k){const ge=new Ge(X,V),Le=new Ge(K,V),Ze=new Ge(X,$),st=new Ge(K,$),xt=an(k);let St=new Ge(0,0);L&&(St=new Ge(L[0],L[1])),ge._rotateAround(xt,St),Le._rotateAround(xt,St),Ze._rotateAround(xt,St),st._rotateAround(xt,St),X=Math.min(ge.x,Le.x,Ze.x,st.x),K=Math.max(ge.x,Le.x,Ze.x,st.x),V=Math.min(ge.y,Le.y,Ze.y,st.y),$=Math.max(ge.y,Le.y,Ze.y,st.y)}return h.emplaceBack(a.x,a.y,X,V,K,$,D,p,m,w),h.length-1}function lp(h){h.collisionPadding&&(h.top-=h.collisionPadding[1],h.bottom+=h.collisionPadding[3]);const a=h.bottom-h.top;return a>0?Math.max(10,a):null}function PC(h,a,p,m){const w=h.compareText;if(a in w){const M=w[a];for(let D=M.length-1;D>=0;D--)if(m.dist(M[D])<p)return!0}else w[a]=[];return w[a].push(m),!1}const U1=wd.VectorTileFeature.types,j1=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function rg(h,a,p,m,w,M,D,k,L,V,$,X,K){const J=k?Math.min(Ou,Math.round(k[0])):0,ge=k?Math.min(Ou,Math.round(k[1])):0;h.emplaceBack(a,p,Math.round(32*m),Math.round(32*w),M,D,(J<<1)+(L?1:0),ge,16*V,16*$,256*X,256*K)}function ig(h,a,p){h.emplaceBack(a.x,a.y,p),h.emplaceBack(a.x,a.y,p),h.emplaceBack(a.x,a.y,p),h.emplaceBack(a.x,a.y,p)}function G1(h){for(const a of h.sections)if(rr(a.text))return!0;return!1}class up{constructor(a){this.layoutVertexArray=new es,this.indexArray=new ns,this.programConfigurations=a,this.segments=new eu,this.dynamicLayoutVertexArray=new Pl,this.opacityVertexArray=new gu,this.placedSymbolArray=new Fp}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length}upload(a,p,m,w){this.isEmpty()||(m&&(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,hC.members),this.indexBuffer=a.createIndexBuffer(this.indexArray,p),this.dynamicLayoutVertexBuffer=a.createVertexBuffer(this.dynamicLayoutVertexArray,vs.members,!0),this.opacityVertexBuffer=a.createVertexBuffer(this.opacityVertexArray,j1,!0),this.opacityVertexBuffer.itemSize=1),(m||w)&&this.programConfigurations.upload(a))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Bn("SymbolBuffers",up);class cp{constructor(a,p,m){this.layoutVertexArray=new a,this.layoutAttributes=p,this.indexArray=new m,this.segments=new eu,this.collisionVertexArray=new ts,this.collisionVertexArrayExt=new Pl}upload(a){this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=a.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=a.createVertexBuffer(this.collisionVertexArray,dC.members,!0),this.collisionVertexBufferExt=a.createVertexBuffer(this.collisionVertexArrayExt,fC.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}Bn("CollisionBuffers",cp);class Yh{constructor(a){this.collisionBoxArray=a.collisionBoxArray,this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(D=>D.id),this.index=a.index,this.pixelRatio=a.pixelRatio,this.sourceLayerIndex=a.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=fy([]),this.placementViewportMatrix=fy([]);const p=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Ey(this.zoom,p["text-size"]),this.iconSizeData=Ey(this.zoom,p["icon-size"]);const m=this.layers[0].layout,w=m.get("symbol-sort-key"),M=m.get("symbol-z-order");this.canOverlap=m.get("text-allow-overlap")||m.get("icon-allow-overlap")||m.get("text-ignore-placement")||m.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==M&&void 0!==w.constantOr(1),this.sortFeaturesByY=("viewport-y"===M||"auto"===M&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=m.get("text-writing-mode").map(D=>Ju[D]),this.stateDependentLayerIds=this.layers.filter(D=>D.isStateDependent()).map(D=>D.id),this.sourceID=a.sourceID}createArrays(){this.text=new up(new tf(this.layers,this.zoom,a=>/^text/.test(a))),this.icon=new up(new tf(this.layers,this.zoom,a=>/^icon/.test(a))),this.glyphOffsetArray=new jf,this.lineVertexArray=new Kg,this.symbolInstances=new Uf}calculateGlyphDependencies(a,p,m,w,M){for(let D=0;D<a.length;D++)if(p[a.charCodeAt(D)]=!0,w&&M){const k=Wh[a.charAt(D)];k&&(p[k.charCodeAt(0)]=!0)}}populate(a,p,m){const w=this.layers[0],M=w.layout,D=M.get("text-font"),k=M.get("text-field"),L=M.get("icon-image"),V=("constant"!==k.value.kind||k.value.value instanceof fr&&!k.value.value.isEmpty()||k.value.value.toString().length>0)&&("constant"!==D.value.kind||D.value.value.length>0),$="constant"!==L.value.kind||!!L.value.value||Object.keys(L.parameters).length>0,X=M.get("symbol-sort-key");if(this.features=[],!V&&!$)return;const K=p.iconDependencies,J=p.glyphDependencies,ge=p.availableImages,Le=new se(this.zoom);for(const{feature:Ze,id:st,index:xt,sourceLayerIndex:St}of a){const Dt=w._featureFilter.needGeometry,Rt=Lc(Ze,Dt);if(!w._featureFilter.filter(Le,Rt,m))continue;let Pt,tn;if(Dt||(Rt.geometry=Hf(Ze)),V){const en=w.getValueAndResolveTokens("text-field",Rt,m,ge),Tn=fr.factory(en);G1(Tn)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===Y()||this.hasRTLText&&ie.isParsed())&&(Pt=tP(Tn,w,Rt))}if($){const en=w.getValueAndResolveTokens("icon-image",Rt,m,ge);tn=en instanceof Hl?en:Hl.fromString(en)}if(!Pt&&!tn)continue;const dn=this.sortFeaturesByKey?X.evaluate(Rt,{},m):void 0;if(this.features.push({id:st,text:Pt,icon:tn,index:xt,sourceLayerIndex:St,geometry:Rt.geometry,properties:Ze.properties,type:U1[Ze.type],sortKey:dn}),tn&&(K[tn.name]=!0),Pt){const en=D.evaluate(Rt,{},m).join(","),Tn="map"===M.get("text-rotation-alignment")&&"point"!==M.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Ju.vertical)>=0;for(const Xt of Pt.sections)if(Xt.image)K[Xt.image.name]=!0;else{const nn=Ee(Pt.toString()),Cn=Xt.fontStack||en,Ht=J[Cn]=J[Cn]||{};this.calculateGlyphDependencies(Xt.text,Ht,Tn,this.allowVerticalPlacement,nn)}}}"line"===M.get("symbol-placement")&&(this.features=function(Ze){const st={},xt={},St=[];let Dt=0;function Rt(en){St.push(Ze[en]),Dt++}function Pt(en,Tn,Xt){const nn=xt[en];return delete xt[en],xt[Tn]=nn,St[nn].geometry[0].pop(),St[nn].geometry[0]=St[nn].geometry[0].concat(Xt[0]),nn}function tn(en,Tn,Xt){const nn=st[Tn];return delete st[Tn],st[en]=nn,St[nn].geometry[0].shift(),St[nn].geometry[0]=Xt[0].concat(St[nn].geometry[0]),nn}function dn(en,Tn,Xt){const nn=Xt?Tn[0][Tn[0].length-1]:Tn[0][0];return`${en}:${nn.x}:${nn.y}`}for(let en=0;en<Ze.length;en++){const Tn=Ze[en],Xt=Tn.geometry,nn=Tn.text?Tn.text.toString():null;if(!nn){Rt(en);continue}const Cn=dn(nn,Xt),Ht=dn(nn,Xt,!0);if(Cn in xt&&Ht in st&&xt[Cn]!==st[Ht]){const kr=tn(Cn,Ht,Xt),$r=Pt(Cn,Ht,St[kr].geometry);delete st[Cn],delete xt[Ht],xt[dn(nn,St[$r].geometry,!0)]=$r,St[kr].geometry=null}else Cn in xt?Pt(Cn,Ht,Xt):Ht in st?tn(Cn,Ht,Xt):(Rt(en),st[Cn]=Dt-1,xt[Ht]=Dt-1)}return St.filter(en=>en.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((Ze,st)=>Ze.sortKey-st.sortKey)}update(a,p,m){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(a,p,this.layers,m),this.icon.programConfigurations.updatePaintArrays(a,p,this.layers,m))}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(a){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(a),this.iconCollisionBox.upload(a)),this.text.upload(a,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(a,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(a,p){const m=this.lineVertexArray.length;if(void 0!==a.segment){let w=a.dist(p[a.segment+1]),M=a.dist(p[a.segment]);const D={};for(let k=a.segment+1;k<p.length;k++)D[k]={x:p[k].x,y:p[k].y,tileUnitDistanceFromAnchor:w},k<p.length-1&&(w+=p[k+1].dist(p[k]));for(let k=a.segment||0;k>=0;k--)D[k]={x:p[k].x,y:p[k].y,tileUnitDistanceFromAnchor:M},k>0&&(M+=p[k-1].dist(p[k]));for(let k=0;k<p.length;k++){const L=D[k];this.lineVertexArray.emplaceBack(L.x,L.y,L.tileUnitDistanceFromAnchor)}}return{lineStartIndex:m,lineLength:this.lineVertexArray.length-m}}addSymbols(a,p,m,w,M,D,k,L,V,$,X,K){const J=a.indexArray,ge=a.layoutVertexArray,Le=a.segments.prepareSegment(4*p.length,ge,J,this.canOverlap?D.sortKey:void 0),Ze=this.glyphOffsetArray.length,st=Le.vertexLength,xt=this.allowVerticalPlacement&&k===Ju.vertical?Math.PI/2:0,St=D.text&&D.text.sections;for(let Dt=0;Dt<p.length;Dt++){const{tl:Rt,tr:Pt,bl:tn,br:dn,tex:en,pixelOffsetTL:Tn,pixelOffsetBR:Xt,minFontScaleX:nn,minFontScaleY:Cn,glyphOffset:Ht,isSDF:kr,sectionIndex:$r}=p[Dt],Kr=Le.vertexLength,Hr=Ht[1];rg(ge,L.x,L.y,Rt.x,Hr+Rt.y,en.x,en.y,m,kr,Tn.x,Tn.y,nn,Cn),rg(ge,L.x,L.y,Pt.x,Hr+Pt.y,en.x+en.w,en.y,m,kr,Xt.x,Tn.y,nn,Cn),rg(ge,L.x,L.y,tn.x,Hr+tn.y,en.x,en.y+en.h,m,kr,Tn.x,Xt.y,nn,Cn),rg(ge,L.x,L.y,dn.x,Hr+dn.y,en.x+en.w,en.y+en.h,m,kr,Xt.x,Xt.y,nn,Cn),ig(a.dynamicLayoutVertexArray,L,xt),J.emplaceBack(Kr,Kr+1,Kr+2),J.emplaceBack(Kr+1,Kr+2,Kr+3),Le.vertexLength+=4,Le.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Ht[0]),Dt!==p.length-1&&$r===p[Dt+1].sectionIndex||a.programConfigurations.populatePaintArrays(ge.length,D,D.index,{},K,St&&St[$r])}a.placedSymbolArray.emplaceBack(L.x,L.y,Ze,this.glyphOffsetArray.length-Ze,st,V,$,L.segment,m?m[0]:0,m?m[1]:0,w[0],w[1],k,0,!1,0,X,0)}_commitLayoutVertex(a,p,m,w,M){a.emplaceBack(p.x,p.y,m,w,Math.round(M.x),Math.round(M.y))}_addCollisionDebugVertices(a,p,m,w,M){const D=m.segments.prepareSegment(4,m.layoutVertexArray,m.indexArray),k=D.vertexLength,L=M.anchorX,V=M.anchorY;for(let X=0;X<4;X++)m.collisionVertexArray.emplaceBack(0,0,0,0);m.collisionVertexArrayExt.emplaceBack(p,-a.padding,-a.padding),m.collisionVertexArrayExt.emplaceBack(p,a.padding,-a.padding),m.collisionVertexArrayExt.emplaceBack(p,a.padding,a.padding),m.collisionVertexArrayExt.emplaceBack(p,-a.padding,a.padding),this._commitLayoutVertex(m.layoutVertexArray,w,L,V,new Ge(a.x1,a.y1)),this._commitLayoutVertex(m.layoutVertexArray,w,L,V,new Ge(a.x2,a.y1)),this._commitLayoutVertex(m.layoutVertexArray,w,L,V,new Ge(a.x2,a.y2)),this._commitLayoutVertex(m.layoutVertexArray,w,L,V,new Ge(a.x1,a.y2)),D.vertexLength+=4;const $=m.indexArray;$.emplaceBack(k,k+1),$.emplaceBack(k+1,k+2),$.emplaceBack(k+2,k+3),$.emplaceBack(k+3,k),D.primitiveLength+=4}_addTextDebugCollisionBoxes(a,p,m,w,M,D){for(let k=w;k<M;k++){const L=m.get(k),V=this.getSymbolInstanceTextSize(a,D,p,k);this._addCollisionDebugVertices(L,V,this.textCollisionBox,L.anchorPoint,D)}}_addIconDebugCollisionBoxes(a,p,m,w,M,D){for(let k=w;k<M;k++){const L=m.get(k),V=this.getSymbolInstanceIconSize(a,p,k);this._addCollisionDebugVertices(L,V,this.iconCollisionBox,L.anchorPoint,D)}}generateCollisionDebugBuffers(a,p){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new cp(Yu,Jp.members,yc),this.iconCollisionBox=new cp(Yu,Jp.members,yc);const m=op(this.iconSizeData,a),w=op(this.textSizeData,a);for(let M=0;M<this.symbolInstances.length;M++){const D=this.symbolInstances.get(M);this._addTextDebugCollisionBoxes(w,a,p,D.textBoxStartIndex,D.textBoxEndIndex,D),this._addTextDebugCollisionBoxes(w,a,p,D.verticalTextBoxStartIndex,D.verticalTextBoxEndIndex,D),this._addIconDebugCollisionBoxes(m,a,p,D.iconBoxStartIndex,D.iconBoxEndIndex,D),this._addIconDebugCollisionBoxes(m,a,p,D.verticalIconBoxStartIndex,D.verticalIconBoxEndIndex,D)}}getSymbolInstanceTextSize(a,p,m,w){const M=this.text.placedSymbolArray.get(p.rightJustifiedTextSymbolIndex>=0?p.rightJustifiedTextSymbolIndex:p.centerJustifiedTextSymbolIndex>=0?p.centerJustifiedTextSymbolIndex:p.leftJustifiedTextSymbolIndex>=0?p.leftJustifiedTextSymbolIndex:p.verticalPlacedTextSymbolIndex>=0?p.verticalPlacedTextSymbolIndex:w),D=vm(this.textSizeData,a,M)/24;return this.tilePixelRatio*D}getSymbolInstanceIconSize(a,p,m){const w=this.icon.placedSymbolArray.get(m),M=vm(this.iconSizeData,a,w);return this.tilePixelRatio*M}_commitDebugCollisionVertexUpdate(a,p,m){a.emplaceBack(p,-m,-m),a.emplaceBack(p,m,-m),a.emplaceBack(p,m,m),a.emplaceBack(p,-m,m)}_updateTextDebugCollisionBoxes(a,p,m,w,M,D){for(let k=w;k<M;k++){const L=m.get(k),V=this.getSymbolInstanceTextSize(a,D,p,k);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,V,L.padding)}}_updateIconDebugCollisionBoxes(a,p,m,w,M){for(let D=w;D<M;D++){const k=m.get(D),L=this.getSymbolInstanceIconSize(a,p,D);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,L,k.padding)}}updateCollisionDebugBuffers(a,p){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const m=op(this.iconSizeData,a),w=op(this.textSizeData,a);for(let M=0;M<this.symbolInstances.length;M++){const D=this.symbolInstances.get(M);this._updateTextDebugCollisionBoxes(w,a,p,D.textBoxStartIndex,D.textBoxEndIndex,D),this._updateTextDebugCollisionBoxes(w,a,p,D.verticalTextBoxStartIndex,D.verticalTextBoxEndIndex,D),this._updateIconDebugCollisionBoxes(m,a,p,D.iconBoxStartIndex,D.iconBoxEndIndex),this._updateIconDebugCollisionBoxes(m,a,p,D.verticalIconBoxStartIndex,D.verticalIconBoxEndIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(a,p,m,w,M,D,k,L,V){const $={};for(let X=p;X<m;X++){const K=a.get(X);$.textBox={x1:K.x1,y1:K.y1,x2:K.x2,y2:K.y2,padding:K.padding,anchorPointX:K.anchorPointX,anchorPointY:K.anchorPointY},$.textFeatureIndex=K.featureIndex;break}for(let X=w;X<M;X++){const K=a.get(X);$.verticalTextBox={x1:K.x1,y1:K.y1,x2:K.x2,y2:K.y2,padding:K.padding,anchorPointX:K.anchorPointX,anchorPointY:K.anchorPointY},$.verticalTextFeatureIndex=K.featureIndex;break}for(let X=D;X<k;X++){const K=a.get(X);$.iconBox={x1:K.x1,y1:K.y1,x2:K.x2,y2:K.y2,padding:K.padding,anchorPointX:K.anchorPointX,anchorPointY:K.anchorPointY},$.iconFeatureIndex=K.featureIndex;break}for(let X=L;X<V;X++){const K=a.get(X);$.verticalIconBox={x1:K.x1,y1:K.y1,x2:K.x2,y2:K.y2,padding:K.padding,anchorPointX:K.anchorPointX,anchorPointY:K.anchorPointY},$.verticalIconFeatureIndex=K.featureIndex;break}return $}deserializeCollisionBoxes(a){this.collisionArrays=[];for(let p=0;p<this.symbolInstances.length;p++){const m=this.symbolInstances.get(p);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(a,m.textBoxStartIndex,m.textBoxEndIndex,m.verticalTextBoxStartIndex,m.verticalTextBoxEndIndex,m.iconBoxStartIndex,m.iconBoxEndIndex,m.verticalIconBoxStartIndex,m.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(a,p){const m=a.placedSymbolArray.get(p),w=m.vertexStartIndex+4*m.numGlyphs;for(let M=m.vertexStartIndex;M<w;M+=4)a.indexArray.emplaceBack(M,M+1,M+2),a.indexArray.emplaceBack(M+1,M+2,M+3)}getSortedSymbolIndexes(a){if(this.sortedAngle===a&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;const p=Math.sin(a),m=Math.cos(a),w=[],M=[],D=[];for(let k=0;k<this.symbolInstances.length;++k){D.push(k);const L=this.symbolInstances.get(k);w.push(0|Math.round(p*L.anchorX+m*L.anchorY)),M.push(L.featureIndex)}return D.sort((k,L)=>w[k]-w[L]||M[L]-M[k]),D}addToSortKeyRanges(a,p){const m=this.sortKeyRanges[this.sortKeyRanges.length-1];m&&m.sortKey===p?m.symbolInstanceEnd=a+1:this.sortKeyRanges.push({sortKey:p,symbolInstanceStart:a,symbolInstanceEnd:a+1})}sortFeatures(a){if(this.sortFeaturesByY&&this.sortedAngle!==a&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(a),this.sortedAngle=a,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const p of this.symbolInstanceIndexes){const m=this.symbolInstances.get(p);this.featureSortOrder.push(m.featureIndex),[m.rightJustifiedTextSymbolIndex,m.centerJustifiedTextSymbolIndex,m.leftJustifiedTextSymbolIndex].forEach((w,M,D)=>{w>=0&&D.indexOf(w)===M&&this.addIndicesForPlacedSymbol(this.text,w)}),m.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,m.verticalPlacedTextSymbolIndex),m.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,m.placedIconSymbolIndex),m.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,m.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}Bn("SymbolBucket",Yh,{omit:["layers","collisionBoxArray","features","compareText"]}),Yh.MAX_GLYPHS=65535,Yh.addDynamicAttributes=ig;const Hy=new et({"symbol-placement":new Xe(tt.layout_symbol["symbol-placement"]),"symbol-spacing":new Xe(tt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Xe(tt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Ye(tt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Xe(tt.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Xe(tt.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Xe(tt.layout_symbol["icon-ignore-placement"]),"icon-optional":new Xe(tt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Xe(tt.layout_symbol["icon-rotation-alignment"]),"icon-size":new Ye(tt.layout_symbol["icon-size"]),"icon-text-fit":new Xe(tt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Xe(tt.layout_symbol["icon-text-fit-padding"]),"icon-image":new Ye(tt.layout_symbol["icon-image"]),"icon-rotate":new Ye(tt.layout_symbol["icon-rotate"]),"icon-padding":new Xe(tt.layout_symbol["icon-padding"]),"icon-keep-upright":new Xe(tt.layout_symbol["icon-keep-upright"]),"icon-offset":new Ye(tt.layout_symbol["icon-offset"]),"icon-anchor":new Ye(tt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Xe(tt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Xe(tt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Xe(tt.layout_symbol["text-rotation-alignment"]),"text-field":new Ye(tt.layout_symbol["text-field"]),"text-font":new Ye(tt.layout_symbol["text-font"]),"text-size":new Ye(tt.layout_symbol["text-size"]),"text-max-width":new Ye(tt.layout_symbol["text-max-width"]),"text-line-height":new Ye(tt.layout_symbol["text-line-height"]),"text-letter-spacing":new Ye(tt.layout_symbol["text-letter-spacing"]),"text-justify":new Ye(tt.layout_symbol["text-justify"]),"text-radial-offset":new Ye(tt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Xe(tt.layout_symbol["text-variable-anchor"]),"text-anchor":new Ye(tt.layout_symbol["text-anchor"]),"text-max-angle":new Xe(tt.layout_symbol["text-max-angle"]),"text-writing-mode":new Xe(tt.layout_symbol["text-writing-mode"]),"text-rotate":new Ye(tt.layout_symbol["text-rotate"]),"text-padding":new Xe(tt.layout_symbol["text-padding"]),"text-keep-upright":new Xe(tt.layout_symbol["text-keep-upright"]),"text-transform":new Ye(tt.layout_symbol["text-transform"]),"text-offset":new Ye(tt.layout_symbol["text-offset"]),"text-allow-overlap":new Xe(tt.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Xe(tt.layout_symbol["text-ignore-placement"]),"text-optional":new Xe(tt.layout_symbol["text-optional"])});var Dm={paint:new et({"icon-opacity":new Ye(tt.paint_symbol["icon-opacity"]),"icon-color":new Ye(tt.paint_symbol["icon-color"]),"icon-halo-color":new Ye(tt.paint_symbol["icon-halo-color"]),"icon-halo-width":new Ye(tt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Ye(tt.paint_symbol["icon-halo-blur"]),"icon-translate":new Xe(tt.paint_symbol["icon-translate"]),"icon-translate-anchor":new Xe(tt.paint_symbol["icon-translate-anchor"]),"text-opacity":new Ye(tt.paint_symbol["text-opacity"]),"text-color":new Ye(tt.paint_symbol["text-color"],{runtimeType:wa,getOverride:h=>h.textColor,hasOverride:h=>!!h.textColor}),"text-halo-color":new Ye(tt.paint_symbol["text-halo-color"]),"text-halo-width":new Ye(tt.paint_symbol["text-halo-width"]),"text-halo-blur":new Ye(tt.paint_symbol["text-halo-blur"]),"text-translate":new Xe(tt.paint_symbol["text-translate"]),"text-translate-anchor":new Xe(tt.paint_symbol["text-translate-anchor"])}),layout:Hy};class Im{constructor(a){this.type=a.property.overrides?a.property.overrides.runtimeType:ba,this.defaultValue=a}evaluate(a){if(a.formattedSection){const p=this.defaultValue.property.overrides;if(p&&p.hasOverride(a.formattedSection))return p.getOverride(a.formattedSection)}return a.feature&&a.featureState?this.defaultValue.evaluate(a.feature,a.featureState):this.defaultValue.property.specification.default}eachChild(a){this.defaultValue.isConstant()||a(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Bn("FormatSectionOverride",Im,{omit:["defaultValue"]});class Td extends sh{constructor(a){super(a,Dm)}recalculate(a,p){super.recalculate(a,p),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const m=this.layout.get("text-writing-mode");if(m){const w=[];for(const M of m)w.indexOf(M)<0&&w.push(M);this.layout._values["text-writing-mode"]=w}else this.layout._values["text-writing-mode"]="point"===this.layout.get("symbol-placement")?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(a,p,m,w){const M=this.layout.get(a).evaluate(p,{},m,w),D=this._unevaluatedLayout._values[a];return D.isDataDriven()||ds(D.value)||!M?M:(k=p.properties,M.replace(/{([^{}]+)}/g,(V,$)=>$ in k?String(k[$]):""));var k}createBucket(a){return new Yh(a)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const a of Dm.paint.overridableProperties){if(!Td.hasPaintOverride(this.layout,a))continue;const p=this.paint.get(a),m=new Im(p),w=new Pc(m,p.property.specification);let M=null;M="constant"===p.value.kind||"source"===p.value.kind?new Oo("source",w):new ga("composite",w,p.value.zoomStops,p.value._interpolationType),this.paint._values[a]=new Je(p.property,M,p.parameters)}}_handleOverridablePaintPropertyUpdate(a,p,m){return!(!this.layout||p.isDataDriven()||m.isDataDriven())&&Td.hasPaintOverride(this.layout,a)}static hasPaintOverride(a,p){const m=a.get("text-field"),w=Dm.paint.properties[p];let M=!1;const D=k=>{for(const L of k)if(w.overrides&&w.overrides.hasOverride(L))return void(M=!0)};if("constant"===m.value.kind&&m.value.value instanceof fr)D(m.value.value.sections);else if("source"===m.value.kind){const k=V=>{M||(V instanceof fc&&to(V.value)===Nr?D(V.value.sections):V instanceof Za?D(V.sections):V.eachChild(k))},L=m.value;L._styleExpression&&k(L._styleExpression.expression)}return M}getProgramConfiguration(a){return new yd(this,a)}}var RC={paint:new et({"background-color":new Xe(tt.paint_background["background-color"]),"background-pattern":new qt(tt.paint_background["background-pattern"]),"background-opacity":new Xe(tt.paint_background["background-opacity"])})},$1={paint:new et({"raster-opacity":new Xe(tt.paint_raster["raster-opacity"]),"raster-hue-rotate":new Xe(tt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Xe(tt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Xe(tt.paint_raster["raster-brightness-max"]),"raster-saturation":new Xe(tt.paint_raster["raster-saturation"]),"raster-contrast":new Xe(tt.paint_raster["raster-contrast"]),"raster-resampling":new Xe(tt.paint_raster["raster-resampling"]),"raster-fade-duration":new Xe(tt.paint_raster["raster-fade-duration"])})};class OC extends sh{constructor(a){super(a,{}),this.implementation=a}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}recalculate(){}updateTransitions(){}hasTransition(){}serialize(){}onAdd(a){this.implementation.onAdd&&this.implementation.onAdd(a,a.painter.context.gl)}onRemove(a){this.implementation.onRemove&&this.implementation.onRemove(a,a.painter.context.gl)}}var kC={paint:new et({"sky-type":new Xe(tt.paint_sky["sky-type"]),"sky-atmosphere-sun":new Xe(tt.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new Xe(tt.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new Xe(tt.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new Xe(tt.paint_sky["sky-gradient-radius"]),"sky-gradient":new Jt(tt.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new Xe(tt.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new Xe(tt.paint_sky["sky-atmosphere-color"]),"sky-opacity":new Xe(tt.paint_sky["sky-opacity"])})};function Am(h,a,p){const m=lh(0,0,1),w=om(y1());return function(M,D,k){k*=.5;var L=D[0],V=D[1],$=D[2],X=D[3],K=Math.sin(k),J=Math.cos(k);M[0]=L*J-$*K,M[1]=V*J+X*K,M[2]=$*J+L*K,M[3]=X*J-V*K}(w,w,p?-an(h)+Math.PI:an(h)),Yf(w,w,-an(a)),im(m,m,w),Xf(m,m)}const qy={circle:class extends sh{constructor(h){super(h,Wf)}createBucket(h){return new Ra(h)}queryRadius(h){const a=h;return tm("circle-radius",this,a)+tm("circle-stroke-width",this,a)+uy(this.paint.get("circle-translate"))}queryIntersectsFeature(h,a,p,m,w,M,D,k){const L="map"===this.paint.get("circle-pitch-alignment");if(L&&h.queryGeometry.isAboveHorizon)return!1;const V=Du(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),M.angle,h.pixelToTileUnitsFactor),$=this.paint.get("circle-radius").evaluate(a,p)+this.paint.get("circle-stroke-width").evaluate(a,p),X=L?$*h.pixelToTileUnitsFactor:$;for(const K of m)for(const J of K){const ge=J.add(V),Le=k&&M.elevation?M.elevation.exaggeration()*k.getElevationAt(ge.x,ge.y,!0):0,Ze=L?ge:Zf(ge,Le,D),st=L?h.tilespaceRays.map(Dt=>x1(Dt,Le)):h.queryGeometry.screenGeometry;let xt=X;const St=of([],[J.x,J.y,Le,1],D);if("viewport"===this.paint.get("circle-pitch-scale")&&"map"===this.paint.get("circle-pitch-alignment")?xt*=St[3]/M.cameraToCenterDistance:"map"===this.paint.get("circle-pitch-scale")&&"viewport"===this.paint.get("circle-pitch-alignment")&&(xt*=M.cameraToCenterDistance/St[3]),em(st,Ze,xt))return!0}return!1}getProgramIds(){return["circle"]}getProgramConfiguration(h){return new yd(this,h)}},heatmap:class extends sh{createBucket(h){return new py(h)}constructor(h){super(h,XA),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(h){"heatmap-color"===h&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=xd({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(h){return new yd(this,h)}},hillshade:class extends sh{constructor(h){super(h,Au)}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}getProgramIds(){return["hillshade","hillshadePrepare"]}getProgramConfiguration(h){return new yd(this,h)}},fill:class extends sh{constructor(h){super(h,eC)}getProgramIds(){const h=this.paint.get("fill-pattern"),a=h&&h.constantOr(1),p=[a?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&p.push(a&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),p}getProgramConfiguration(h){return new yd(this,h)}recalculate(h,a){super.recalculate(h,a);const p=this.paint._values["fill-outline-color"];"constant"===p.value.kind&&void 0===p.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(h){return new fm(h)}queryRadius(){return uy(this.paint.get("fill-translate"))}queryIntersectsFeature(h,a,p,m,w,M){return!h.queryGeometry.isAboveHorizon&&BE(cy(h.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),M.angle,h.pixelToTileUnitsFactor),m)}isTileClipped(){return!0}},"fill-extrusion":class extends sh{constructor(h){super(h,KA)}createBucket(h){return new pm(h)}queryRadius(){return uy(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(h){return new yd(this,h)}queryIntersectsFeature(h,a,p,m,w,M,D,k,L){const V=Du(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),M.angle,h.pixelToTileUnitsFactor),$=this.paint.get("fill-extrusion-height").evaluate(a,p),X=this.paint.get("fill-extrusion-base").evaluate(a,p),K=[0,0],J=k&&M.elevation,ge=M.elevation?M.elevation.exaggeration():1;if(J){const st=h.tile.getBucket(this).centroidVertexArray,xt=L+1;if(xt<st.length){const St=st.get(xt);K[0]=St.a_centroid_pos0,K[1]=St.a_centroid_pos1}}if(0===K[0]&&1===K[1])return!1;const Le=(st=m,xt=X,St=$,Dt=V,Rt=D,(Pt=J?k:null)?function(Tn,Xt,nn,Cn,Ht,kr,$r,Kr,Hr){const $n=[],Ho=[],cr=[0,0,0,1];for(const $s of Tn){const Oa=[],Hs=[];for(const fl of $s){const Os=fl.x+Cn.x,xs=fl.y+Cn.y,zo=xy(Os,xs,Xt,nn,kr,$r,Kr,Hr);cr[0]=Os,cr[1]=xs,cr[2]=zo.base,cr[3]=1,of(cr,cr,Ht),cr[3]=Math.max(cr[3],1e-5);const qs=_m([cr[0]/cr[3],cr[1]/cr[3],cr[2]/cr[3]]);cr[0]=Os,cr[1]=xs,cr[2]=zo.top,cr[3]=1,of(cr,cr,Ht),cr[3]=Math.max(cr[3],1e-5);const ks=_m([cr[0]/cr[3],cr[1]/cr[3],cr[2]/cr[3]]);Oa.push(qs),Hs.push(ks)}$n.push(Oa),Ho.push(Hs)}return[$n,Ho]}(st,xt,St,Dt,Rt,Pt,K,ge,M.center.lat):function(Tn,Xt,nn,Cn,Ht){const kr=[],$r=[],Kr=Ht[8]*Xt,Hr=Ht[9]*Xt,$n=Ht[10]*Xt,Ho=Ht[11]*Xt,cr=Ht[8]*nn,$s=Ht[9]*nn,Oa=Ht[10]*nn,Hs=Ht[11]*nn;for(const fl of Tn){const Os=[],xs=[];for(const zo of fl){const qs=zo.x+Cn.x,ks=zo.y+Cn.y,ka=Ht[0]*qs+Ht[4]*ks+Ht[12],qa=Ht[1]*qs+Ht[5]*ks+Ht[13],wo=Ht[2]*qs+Ht[6]*ks+Ht[14],ua=Ht[3]*qs+Ht[7]*ks+Ht[15],Ms=ka+Kr,ca=qa+Hr,pl=wo+$n,Ls=Math.max(ua+Ho,1e-5),ec=ka+cr,ls=qa+$s,ci=wo+Oa,Ws=Math.max(ua+Hs,1e-5),yu=new Ge(Ms/Ls,ca/Ls);yu.z=pl/Ls,Os.push(yu);const tc=new Ge(ec/Ws,ls/Ws);tc.z=ci/Ws,xs.push(tc)}kr.push(Os),$r.push(xs)}return[kr,$r]}(st,xt,St,Dt,Rt)),Ze=h.queryGeometry;var st,xt,St,Dt,Rt,Pt;return function(st,xt,St){let Dt=1/0;BE(St,xt)&&(Dt=mm(St,xt[0]));for(let Rt=0;Rt<xt.length;Rt++){const Pt=xt[Rt],tn=st[Rt];for(let dn=0;dn<Pt.length-1;dn++){const en=Pt[dn],Tn=[en,Pt[dn+1],tn[dn+1],tn[dn],en];nf(St,Tn)&&(Dt=Math.min(Dt,mm(St,Tn)))}}return Dt!==1/0&&Dt}(Le[0],Le[1],Ze.isPointQuery()?Ze.screenBounds:Ze.screenGeometry)}},line:class extends sh{constructor(h){super(h,Kp),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(h){if("line-gradient"===h){const a=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=a._styleExpression&&a._styleExpression.expression instanceof Lh,this.gradientVersion=(this.gradientVersion+1)%kt}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(h,a){super.recalculate(h,a),this.paint._values["line-floorwidth"]=wy.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,h)}createBucket(h){return new by(h)}getProgramIds(){const h=this.paint.get("line-dasharray"),a=this.paint.get("line-pattern").constantOr(1),p=this.paint.get("line-gradient");return[a?"linePattern":h?"lineSDF":p?"lineGradient":"line"]}getProgramConfiguration(h){return new yd(this,h)}queryRadius(h){const a=h,p=ym(tm("line-width",this,a),tm("line-gap-width",this,a)),m=tm("line-offset",this,a);return p/2+Math.abs(m)+uy(this.paint.get("line-translate"))}queryIntersectsFeature(h,a,p,m,w,M){if(h.queryGeometry.isAboveHorizon)return!1;const D=cy(h.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),M.angle,h.pixelToTileUnitsFactor),k=h.pixelToTileUnitsFactor/2*ym(this.paint.get("line-width").evaluate(a,p),this.paint.get("line-gap-width").evaluate(a,p)),L=this.paint.get("line-offset").evaluate(a,p);return L&&(m=function(V,$){const X=[],K=new Ge(0,0);for(let J=0;J<V.length;J++){const ge=V[J],Le=[];for(let Ze=0;Ze<ge.length;Ze++){const st=ge[Ze-1],xt=ge[Ze],St=ge[Ze+1],Dt=0===Ze?K:xt.sub(st)._unit()._perp(),Rt=Ze===ge.length-1?K:St.sub(xt)._unit()._perp(),Pt=Dt._add(Rt)._unit();Pt._mult(1/(Pt.x*Rt.x+Pt.y*Rt.y)),Le.push(Pt._mult($)._add(xt))}X.push(Le)}return X}(m,L*h.pixelToTileUnitsFactor)),function(V,$,X){for(let K=0;K<$.length;K++){const J=$[K];if(V.length>=3)for(let ge=0;ge<J.length;ge++)if(rf(V,J[ge]))return!0;if(zE(V,J,X))return!0}return!1}(D,m,k)}isTileClipped(){return!0}},symbol:Td,background:class extends sh{constructor(h){super(h,RC)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends sh{constructor(h){super(h,$1)}getProgramIds(){return["raster"]}},sky:class extends sh{constructor(h){super(h,kC),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(h){"sky-gradient"===h?this._updateColorRamp():"sky-atmosphere-sun"!==h&&"sky-atmosphere-halo-color"!==h&&"sky-atmosphere-color"!==h&&"sky-atmosphere-sun-intensity"!==h||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=xd({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(h){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const a=h.style.light.properties.get("position");return this._lightPosition.azimuthal!==a.azimuthal||this._lightPosition.polar!==a.polar}}getCenter(h,a){const p=this.paint.get("sky-type");if("atmosphere"===p){const m=this.paint.get("sky-atmosphere-sun"),w=!m,M=h.style.light,D=M.properties.get("position");return w&&"viewport"===M.properties.get("anchor")&&Ke("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),w?Am(D.azimuthal,90-D.polar,a):Am(m[0],90-m[1],a)}if("gradient"===p){const m=this.paint.get("sky-gradient-center");return Am(m[0],90-m[1],a)}}is3D(){return!1}isSky(){return!0}markSkyboxValid(h){this._skyboxInvalidated=!1,this._lightPosition=h.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const h=this.paint.get("sky-type");return"atmosphere"===h?["skyboxCapture","skybox"]:"gradient"===h?["skyboxGradient"]:null}}},{HTMLImageElement:Wy,HTMLCanvasElement:LC,HTMLVideoElement:Xy,ImageData:H1,ImageBitmap:og}=It;class Pm{constructor(a,p,m,w){this.context=a,this.format=m,this.texture=a.gl.createTexture(),this.update(p,w)}update(a,p,m){const{width:w,height:M}=a,D=!(this.size&&this.size[0]===w&&this.size[1]===M||m),{context:k}=this,{gl:L}=k;if(this.useMipmap=Boolean(p&&p.useMipmap),L.bindTexture(L.TEXTURE_2D,this.texture),k.pixelStoreUnpackFlipY.set(!1),k.pixelStoreUnpack.set(1),k.pixelStoreUnpackPremultiplyAlpha.set(this.format===L.RGBA&&(!p||!1!==p.premultiply)),D)this.size=[w,M],a instanceof Wy||a instanceof LC||a instanceof Xy||a instanceof H1||og&&a instanceof og?L.texImage2D(L.TEXTURE_2D,0,this.format,this.format,L.UNSIGNED_BYTE,a):L.texImage2D(L.TEXTURE_2D,0,this.format,w,M,0,this.format,L.UNSIGNED_BYTE,a.data);else{const{x:V,y:$}=m||{x:0,y:0};a instanceof Wy||a instanceof LC||a instanceof Xy||a instanceof H1||og&&a instanceof og?L.texSubImage2D(L.TEXTURE_2D,0,V,$,L.RGBA,L.UNSIGNED_BYTE,a):L.texSubImage2D(L.TEXTURE_2D,0,V,$,w,M,L.RGBA,L.UNSIGNED_BYTE,a.data)}this.useMipmap&&this.isSizePowerOfTwo()&&L.generateMipmap(L.TEXTURE_2D)}bind(a,p,m){const{context:w}=this,{gl:M}=w;M.bindTexture(M.TEXTURE_2D,this.texture),m!==M.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(m=M.LINEAR),a!==this.filter&&(M.texParameteri(M.TEXTURE_2D,M.TEXTURE_MAG_FILTER,a),M.texParameteri(M.TEXTURE_2D,M.TEXTURE_MIN_FILTER,m||a),this.filter=a),p!==this.wrap&&(M.texParameteri(M.TEXTURE_2D,M.TEXTURE_WRAP_S,p),M.texParameteri(M.TEXTURE_2D,M.TEXTURE_WRAP_T,p),this.wrap=p)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:a}=this.context;a.deleteTexture(this.texture),this.texture=null}}class ff{constructor(a,p){a&&(p?this.setSouthWest(a).setNorthEast(p):4===a.length?this.setSouthWest([a[0],a[1]]).setNorthEast([a[2],a[3]]):this.setSouthWest(a[0]).setNorthEast(a[1]))}setNorthEast(a){return this._ne=a instanceof Gs?new Gs(a.lng,a.lat):Gs.convert(a),this}setSouthWest(a){return this._sw=a instanceof Gs?new Gs(a.lng,a.lat):Gs.convert(a),this}extend(a){const p=this._sw,m=this._ne;let w,M;if(a instanceof Gs)w=a,M=a;else{if(!(a instanceof ff))return Array.isArray(a)?4===a.length||a.every(Array.isArray)?this.extend(ff.convert(a)):this.extend(Gs.convert(a)):this;if(w=a._sw,M=a._ne,!w||!M)return this}return p||m?(p.lng=Math.min(w.lng,p.lng),p.lat=Math.min(w.lat,p.lat),m.lng=Math.max(M.lng,m.lng),m.lat=Math.max(M.lat,m.lat)):(this._sw=new Gs(w.lng,w.lat),this._ne=new Gs(M.lng,M.lat)),this}getCenter(){return new Gs((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Gs(this.getWest(),this.getNorth())}getSouthEast(){return new Gs(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(a){const{lng:p,lat:m}=Gs.convert(a);let w=this._sw.lng<=p&&p<=this._ne.lng;return this._sw.lng>this._ne.lng&&(w=this._sw.lng>=p&&p>=this._ne.lng),this._sw.lat<=m&&m<=this._ne.lat&&w}static convert(a){return!a||a instanceof ff?a:new ff(a)}}const xc=6371008.8;class Gs{constructor(a,p){if(isNaN(a)||isNaN(p))throw new Error(`Invalid LngLat object: (${a}, ${p})`);if(this.lng=+a,this.lat=+p,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Gs(Ne(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(a){const p=Math.PI/180,m=this.lat*p,w=a.lat*p,M=Math.sin(m)*Math.sin(w)+Math.cos(m)*Math.cos(w)*Math.cos((a.lng-this.lng)*p);return xc*Math.acos(Math.min(M,1))}toBounds(a=0){const p=360*a/40075017,m=p/Math.cos(Math.PI/180*this.lat);return new ff(new Gs(this.lng-m,this.lat-p),new Gs(this.lng+m,this.lat+p))}static convert(a){if(a instanceof Gs)return a;if(Array.isArray(a)&&(2===a.length||3===a.length))return new Gs(Number(a[0]),Number(a[1]));if(!Array.isArray(a)&&"object"==typeof a&&null!==a)return new Gs(Number("lng"in a?a.lng:a.lon),Number(a.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const Yy=2*Math.PI*xc;function q1(h){return Yy*Math.cos(h*Math.PI/180)}function W1(h){return(180+h)/360}function X1(h){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+h*Math.PI/360)))/360}function Zy(h,a){return h/q1(a)}function sg(h){return 360/Math.PI*Math.atan(Math.exp((180-360*h)*Math.PI/180))-90}function Ky(h,a){return h*q1(sg(a))}class hp{constructor(a,p,m=0){this.x=+a,this.y=+p,this.z=+m}static fromLngLat(a,p=0){const m=Gs.convert(a);return new hp(W1(m.lng),X1(m.lat),Zy(p,m.lat))}toLngLat(){return new Gs(360*this.x-180,sg(this.y))}toAltitude(){return Ky(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Yy*(a=sg(this.y),1/Math.cos(a*Math.PI/180));var a}}class Jy{constructor(a,p){this.width=a,this.height=p,this.nextRow=0,this.image=new Hh({width:a,height:p}),this.positions={},this.uploaded=!1}getDash(a,p){const m=this.getKey(a,p);return this.positions[m]}trim(){const a=this.width,p=this.height=Oe(this.nextRow);this.image.resize({width:a,height:p})}getKey(a,p){return a.join(",")+p}getDashRanges(a,p,m){const w=[];let M=a.length%2==1?-a[a.length-1]*m:0,D=a[0]*m,k=!0;w.push({left:M,right:D,isDash:k,zeroLength:0===a[0]});let L=a[0];for(let V=1;V<a.length;V++){k=!k;const $=a[V];M=L*m,L+=$,D=L*m,w.push({left:M,right:D,isDash:k,zeroLength:0===$})}return w}addRoundDash(a,p,m){const w=p/2;for(let M=-m;M<=m;M++){const D=this.width*(this.nextRow+m+M);let k=0,L=a[k];for(let V=0;V<this.width;V++){V/L.right>1&&(L=a[++k]);const $=Math.abs(V-L.left),X=Math.abs(V-L.right),K=Math.min($,X);let J;const ge=M/m*(w+1);if(L.isDash){const Le=w-Math.abs(ge);J=Math.sqrt(K*K+Le*Le)}else J=w-Math.sqrt(K*K+ge*ge);this.image.data[D+V]=Math.max(0,Math.min(255,J+128))}}}addRegularDash(a,p){for(let L=a.length-1;L>=0;--L){const V=a[L],$=a[L+1];V.zeroLength?a.splice(L,1):$&&$.isDash===V.isDash&&($.left=V.left,a.splice(L,1))}const m=a[0],w=a[a.length-1];m.isDash===w.isDash&&(m.left=w.left-this.width,w.right=m.right+this.width);const M=this.width*this.nextRow;let D=0,k=a[D];for(let L=0;L<this.width;L++){L/k.right>1&&(k=a[++D]);const V=Math.abs(L-k.left),$=Math.abs(L-k.right),X=Math.min(V,$);this.image.data[M+L]=Math.max(0,Math.min(255,(k.isDash?X:-X)+p+128))}}addDash(a,p){const m=this.getKey(a,p);if(this.positions[m])return this.positions[m];const w="round"===p,M=w?7:0,D=2*M+1;if(this.nextRow+D>this.height)return Ke("LineAtlas out of space"),null;0===a.length&&a.push(1);let k=0;for(let $=0;$<a.length;$++)a[$]<0&&(Ke("Negative value is found in line dasharray, replacing values with 0"),a[$]=0),k+=a[$];if(0!==k){const $=this.width/k,X=this.getDashRanges(a,this.width,$);w?this.addRoundDash(X,$,M):this.addRegularDash(X,"square"===p?.5*$:0)}const L=this.nextRow+M;this.nextRow+=D;const V={tl:[L,M],br:[k,0]};return this.positions[m]=V,V}}Bn("LineAtlas",Jy);class Zr{constructor(a){this._callback=a,this._triggered=!1,"undefined"!=typeof MessageChannel&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){delete this._channel,this._callback=()=>{}}}const $o=It.performance;function Qy(h){const a=h?h.url.toString():void 0;return $o.getEntriesByName(a)}class Rm{constructor(){this.tasks={},this.taskQueue=[],jt(["process"],this),this.invoker=new Zr(this.process),this.nextId=0}add(a,p){const m=this.nextId++,w=function({type:M,isSymbolTile:D,zoom:k}){return k=k||0,"message"===M?0:"maybePrepare"!==M||D?"parseTile"!==M||D?"parseTile"===M&&D?300-k:"maybePrepare"===M&&D?400-k:500:200-k:100-k}(p);if(0===w){Ut();try{a()}finally{}return{cancel:()=>{}}}return this.tasks[m]={fn:a,metadata:p,priority:w,id:m},this.taskQueue.push(m),this.invoker.trigger(),{cancel:()=>{delete this.tasks[m]}}}process(){Ut();try{if(this.taskQueue=this.taskQueue.filter(m=>!!this.tasks[m]),!this.taskQueue.length)return;const a=this.pick();if(null===a)return;const p=this.tasks[a];if(delete this.tasks[a],this.taskQueue.length&&this.invoker.trigger(),!p)return;p.fn()}finally{}}pick(){let a=null,p=1/0;for(let w=0;w<this.taskQueue.length;w++){const M=this.tasks[this.taskQueue[w]];M.priority<p&&(p=M.priority,a=w)}if(null===a)return null;const m=this.taskQueue[a];return this.taskQueue.splice(a,1),m}remove(){this.invoker.remove()}}function bc(h,a,p){var m=2*Math.PI*6378137/256/Math.pow(2,p);return[h*m-2*Math.PI*6378137/2,a*m-2*Math.PI*6378137/2]}class Om{constructor(a,p,m){this.z=a,this.x=p,this.y=m,this.key=Qu(0,a,a,p,m)}equals(a){return this.z===a.z&&this.x===a.x&&this.y===a.y}url(a,p){const m=(M=this.y,D=this.z,k=bc(256*(w=this.x),256*(M=Math.pow(2,D)-M-1),D),L=bc(256*(w+1),256*(M+1),D),k[0]+","+k[1]+","+L[0]+","+L[1]);var w,M,D,k,L;const V=function($,X,K){let J,ge="";for(let Le=$;Le>0;Le--)J=1<<Le-1,ge+=(X&J?1:0)+(K&J?2:0);return ge}(this.z,this.x,this.y);return a[(this.x+this.y)%a.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String("tms"===p?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",V).replace("{bbox-epsg-3857}",m)}getTilePoint(a){const p=Math.pow(2,this.z);return new Ge((a.x*p-this.x)*Ao,(a.y*p-this.y)*Ao)}getTileVec3(a){const p=Math.pow(2,this.z);return lh((a.x*p-this.x)*Ao,(a.y*p-this.y)*Ao,Ky(a.z,a.y))}toString(){return`${this.z}/${this.x}/${this.y}`}}class Y1{constructor(a,p){this.wrap=a,this.canonical=p,this.key=Qu(a,p.z,p.z,p.x,p.y)}}class Ll{constructor(a,p,m,w,M){this.overscaledZ=a,this.wrap=p,this.canonical=new Om(m,+w,+M),this.key=0===p&&a===m?this.canonical.key:Qu(p,a,m,w,M)}equals(a){return this.overscaledZ===a.overscaledZ&&this.wrap===a.wrap&&this.canonical.equals(a.canonical)}scaledTo(a){const p=this.canonical.z-a;return a>this.canonical.z?new Ll(a,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ll(a,this.wrap,a,this.canonical.x>>p,this.canonical.y>>p)}calculateScaledKey(a,p=!0){if(this.overscaledZ===a&&p)return this.key;if(a>this.canonical.z)return Qu(this.wrap*+p,a,this.canonical.z,this.canonical.x,this.canonical.y);{const m=this.canonical.z-a;return Qu(this.wrap*+p,a,a,this.canonical.x>>m,this.canonical.y>>m)}}isChildOf(a){if(a.wrap!==this.wrap)return!1;const p=this.canonical.z-a.canonical.z;return 0===a.overscaledZ||a.overscaledZ<this.overscaledZ&&a.canonical.x===this.canonical.x>>p&&a.canonical.y===this.canonical.y>>p}children(a){if(this.overscaledZ>=a)return[new Ll(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const p=this.canonical.z+1,m=2*this.canonical.x,w=2*this.canonical.y;return[new Ll(p,this.wrap,p,m,w),new Ll(p,this.wrap,p,m+1,w),new Ll(p,this.wrap,p,m,w+1),new Ll(p,this.wrap,p,m+1,w+1)]}isLessThan(a){return this.wrap<a.wrap||!(this.wrap>a.wrap)&&(this.overscaledZ<a.overscaledZ||!(this.overscaledZ>a.overscaledZ)&&(this.canonical.x<a.canonical.x||!(this.canonical.x>a.canonical.x)&&this.canonical.y<a.canonical.y))}wrapped(){return new Ll(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(a){return new Ll(this.overscaledZ,a,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Y1(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(a){return this.canonical.getTilePoint(new hp(a.x-this.wrap,a.y))}getTileVec3(a){return this.canonical.getTileVec3(new hp(a.x-this.wrap,a.y,a.z))}}function Qu(h,a,p,m,w){const M=1<<Math.min(p,22);let D=M*(w%M)+m%M;return h&&p<22&&(D+=M*M*((h<0?-2*h-1:2*h)%(1<<2*(22-p)))),16*(32*D+p)+(a-p)}Bn("CanonicalTileID",Om),Bn("OverscaledTileID",Ll,{omit:["projMatrix"]});class km{constructor(a){this._stringToNumber={},this._numberToString=[];for(let p=0;p<a.length;p++){const m=a[p];this._stringToNumber[m]=p,this._numberToString[p]=m}}encode(a){return this._stringToNumber[a]}decode(a){return this._numberToString[a]}}class ev{constructor(a,p,m,w,M){this.type="Feature",this._vectorTileFeature=a,a._z=p,a._x=m,a._y=w,this.properties=a.properties,this.id=M}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(a){this._geometry=a}toJSON(){const a={geometry:this.geometry};for(const p in this)"_geometry"!==p&&"_vectorTileFeature"!==p&&(a[p]=this[p]);return a}}var tv=wn([{name:"a_pos",type:"Int16",components:2}]);class NC{constructor(a,p,m){this.tileID=a,this.uid=mt(),this.uses=0,this.tileSize=p,this.tileZoom=m,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(a){const p=a+this.timeAdded;p<rn.now()||this.fadeEndTime&&p<this.fadeEndTime||(this.fadeEndTime=p)}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}loadVectorData(a,p,m){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",a){a.featureIndex&&(this.latestFeatureIndex=a.featureIndex,a.rawTileData?(this.latestRawTileData=a.rawTileData,this.latestFeatureIndex.rawTileData=a.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=a.collisionBoxArray,this.buckets=function(w,M){const D={};if(!M)return D;for(const k of w){const L=k.layerIds.map(V=>M.getLayer(V)).filter(Boolean);if(0!==L.length){k.layers=L,k.stateDependentLayerIds&&(k.stateDependentLayers=k.stateDependentLayerIds.map(V=>L.filter($=>$.id===V)[0]));for(const V of L)D[V.id]=k}}return D}(a.buckets,p.style),this.hasSymbolBuckets=!1;for(const w in this.buckets){const M=this.buckets[w];if(M instanceof Yh){if(this.hasSymbolBuckets=!0,!m)break;M.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const w in this.buckets){const M=this.buckets[w];if(M instanceof Yh&&M.hasRTLText){this.hasRTLText=!0,ie.isLoading()||ie.isLoaded()||"deferred"!==Y()||te();break}}this.queryPadding=0;for(const w in this.buckets){const M=this.buckets[w];this.queryPadding=Math.max(this.queryPadding,p.style.getLayer(w).queryRadius(M))}a.imageAtlas&&(this.imageAtlas=a.imageAtlas),a.glyphAtlasImage&&(this.glyphAtlasImage=a.glyphAtlasImage),a.lineAtlas&&(this.lineAtlas=a.lineAtlas)}else this.collisionBoxArray=new Vf}unloadVectorData(){for(const a in this.buckets)this.buckets[a].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(a){return this.buckets[a.id]}upload(a){for(const m in this.buckets){const w=this.buckets[m];w.uploadPending()&&w.upload(a)}const p=a.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Pm(a,this.imageAtlas.image,p.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Pm(a,this.glyphAtlasImage,p.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new Pm(a,this.lineAtlas.image,p.ALPHA),this.lineAtlas.uploaded=!0)}prepare(a){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(a,this.imageAtlasTexture)}queryRenderedFeatures(a,p,m,w,M,D,k,L){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:w,pixelPosMatrix:k,transform:D,params:M},a,p,m):{}}querySourceFeatures(a,p){const m=this.latestFeatureIndex;if(!m||!m.rawTileData)return;const w=m.loadVTLayers(),M=p?p.sourceLayer:"",D=w._geojsonTileLayer||w[M];if(!D)return;const k=Zl(p&&p.filter),{z:L,x:V,y:$}=this.tileID.canonical,X={z:L,x:V,y:$};for(let K=0;K<D.length;K++){const J=D.feature(K);if(k.needGeometry){const Ze=Lc(J,!0);if(!k.filter(new se(this.tileID.overscaledZ),Ze,this.tileID.canonical))continue}else if(!k.filter(new se(this.tileID.overscaledZ),J))continue;const ge=m.getId(J,M),Le=new ev(J,L,V,$,ge);Le.tile=X,a.push(Le)}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(a){const p=this.expirationTime;if(a.cacheControl){const m=Sn(a.cacheControl);m["max-age"]&&(this.expirationTime=Date.now()+1e3*m["max-age"])}else a.expires&&(this.expirationTime=new Date(a.expires).getTime());if(this.expirationTime){const m=Date.now();let w=!1;if(this.expirationTime>m)w=!1;else if(p)if(this.expirationTime<p)w=!0;else{const M=this.expirationTime-p;M?this.expirationTime=m+Math.max(M,3e4):w=!0}else w=!0;w?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}setFeatureState(a,p){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||0===Object.keys(a).length)return;const m=this.latestFeatureIndex.loadVTLayers();for(const w in this.buckets){if(!p.style.hasLayer(w))continue;const M=this.buckets[w],D=M.layers[0].sourceLayer||"_geojsonTileLayer",k=m[D],L=a[D];if(!k||!L||0===Object.keys(L).length)continue;M.update(L,k,this.imageAtlas&&this.imageAtlas.patternPositions||{});const V=p&&p.style&&p.style.getLayer(w);V&&(this.queryPadding=Math.max(this.queryPadding,V.queryRadius(M)))}}holdingForFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<rn.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(a){this.symbolFadeHoldUntil=rn.now()+a}setDependencies(a,p){const m={};for(const w of p)m[w]=!0;this.dependencies[a]=m}hasDependency(a,p){for(const m of a){const w=this.dependencies[m];if(w)for(const M of p)if(w[M])return!0}return!1}clearQueryDebugViz(){}}class Z1{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(a,p,m){const w=String(p);if(this.stateChanges[a]=this.stateChanges[a]||{},this.stateChanges[a][w]=this.stateChanges[a][w]||{},be(this.stateChanges[a][w],m),null===this.deletedStates[a]){this.deletedStates[a]={};for(const M in this.state[a])M!==w&&(this.deletedStates[a][M]=null)}else if(this.deletedStates[a]&&null===this.deletedStates[a][w]){this.deletedStates[a][w]={};for(const M in this.state[a][w])m[M]||(this.deletedStates[a][w][M]=null)}else for(const M in m)this.deletedStates[a]&&this.deletedStates[a][w]&&null===this.deletedStates[a][w][M]&&delete this.deletedStates[a][w][M]}removeFeatureState(a,p,m){if(null===this.deletedStates[a])return;const w=String(p);if(this.deletedStates[a]=this.deletedStates[a]||{},m&&void 0!==p)null!==this.deletedStates[a][w]&&(this.deletedStates[a][w]=this.deletedStates[a][w]||{},this.deletedStates[a][w][m]=null);else if(void 0!==p)if(this.stateChanges[a]&&this.stateChanges[a][w])for(m in this.deletedStates[a][w]={},this.stateChanges[a][w])this.deletedStates[a][w][m]=null;else this.deletedStates[a][w]=null;else this.deletedStates[a]=null}getState(a,p){const m=String(p),w=be({},(this.state[a]||{})[m],(this.stateChanges[a]||{})[m]);if(null===this.deletedStates[a])return{};if(this.deletedStates[a]){const M=this.deletedStates[a][p];if(null===M)return{};for(const D in M)delete w[D]}return w}initializeTileState(a,p){a.setFeatureState(this.state,p)}coalesceChanges(a,p){const m={};for(const w in this.stateChanges){this.state[w]=this.state[w]||{};const M={};for(const D in this.stateChanges[w])this.state[w][D]||(this.state[w][D]={}),be(this.state[w][D],this.stateChanges[w][D]),M[D]=this.state[w][D];m[w]=M}for(const w in this.deletedStates){this.state[w]=this.state[w]||{};const M={};if(null===this.deletedStates[w])for(const D in this.state[w])M[D]={},this.state[w][D]={};else for(const D in this.deletedStates[w]){if(null===this.deletedStates[w][D])this.state[w][D]={};else for(const k of Object.keys(this.deletedStates[w][D]))delete this.state[w][D][k];M[D]=this.state[w][D]}m[w]=m[w]||{},be(m[w],M)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(m).length)for(const w in a)a[w].setFeatureState(m,p)}}class FC{constructor(a){this.size=a,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(a,p){const m=this.toIdx(a,p);return{min:this.minimums[m],max:this.maximums[m]}}isLeaf(a,p){return this.leaves[this.toIdx(a,p)]}toIdx(a,p){return p*this.size+a}}function ph(h,a,p,m){let w=0,M=Number.MAX_VALUE;for(let D=0;D<3;D++)if(Math.abs(m[D])<1e-15){if(p[D]<h[D]||p[D]>a[D])return null}else{const k=1/m[D];let L=(h[D]-p[D])*k,V=(a[D]-p[D])*k;if(L>V){const $=L;L=V,V=$}if(L>w&&(w=L),V<M&&(M=V),w>M)return null}return w}function ag(h,a,p,m,w,M,D,k,L,V,$){const X=m-h,K=w-a,J=M-p,ge=D-h,Le=k-a,Ze=L-p,st=$[1]*Ze-$[2]*Le,xt=$[2]*ge-$[0]*Ze,St=$[0]*Le-$[1]*ge,Dt=X*st+K*xt+J*St;if(Math.abs(Dt)<1e-15)return null;const Rt=1/Dt,Pt=V[0]-h,tn=V[1]-a,dn=V[2]-p,en=(Pt*st+tn*xt+dn*St)*Rt;if(en<0||en>1)return null;const Tn=tn*J-dn*K,Xt=dn*X-Pt*J,nn=Pt*K-tn*X,Cn=($[0]*Tn+$[1]*Xt+$[2]*nn)*Rt;return Cn<0||en+Cn>1?null:(ge*Tn+Le*Xt+Ze*nn)*Rt}function lg(h,a,p){return(h-a)/(p-a)}function Lm(h,a,p,m,w,M,D,k,L){const V=1<<p,$=M-m,X=D-w,K=(h+1)/V*$+m,J=(a+0)/V*X+w,ge=(a+1)/V*X+w;k[0]=(h+0)/V*$+m,k[1]=J,L[0]=K,L[1]=ge}class BC{constructor(a){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=a,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const p=function(M){const D=Math.ceil(Math.log2(M.dim/8)),k=[];let L=Math.ceil(Math.pow(2,D));const V=1/L,$=(J,ge,Le,Ze,st)=>{const xt=Ze?1:0,St=(J+1)*Le-xt,Dt=ge*Le,Rt=(ge+1)*Le-xt;st[0]=J*Le,st[1]=Dt,st[2]=St,st[3]=Rt};let X=new FC(L);const K=[];for(let J=0;J<L*L;J++){$(J%L,Math.floor(J/L),V,!1,K);const ge=Zh(K[0],K[1],M),Le=Zh(K[2],K[1],M),Ze=Zh(K[2],K[3],M),st=Zh(K[0],K[3],M);X.minimums.push(Math.min(ge,Le,Ze,st)),X.maximums.push(Math.max(ge,Le,Ze,st)),X.leaves.push(1)}for(k.push(X),L/=2;L>=1;L/=2){const J=k[k.length-1];X=new FC(L);for(let ge=0;ge<L*L;ge++){$(ge%L,Math.floor(ge/L),2,!0,K);const Le=J.getElevation(K[0],K[1]),Ze=J.getElevation(K[2],K[1]),st=J.getElevation(K[2],K[3]),xt=J.getElevation(K[0],K[3]),St=J.isLeaf(K[0],K[1]),Dt=J.isLeaf(K[2],K[1]),Rt=J.isLeaf(K[2],K[3]),Pt=J.isLeaf(K[0],K[3]),tn=Math.min(Le.min,Ze.min,st.min,xt.min),dn=Math.max(Le.max,Ze.max,st.max,xt.max),en=St&&Dt&&Rt&&Pt;X.maximums.push(dn),X.minimums.push(tn),X.leaves.push(dn-tn<=5&&en?1:0)}k.push(X)}return k}(this.dem),m=p.length-1,w=p[m];this._addNode(w.minimums[0],w.maximums[0],w.leaves[0]),this._construct(p,0,0,m,0)}raycastRoot(a,p,m,w,M,D,k=1){return ph([a,p,-100],[m,w,this.maximums[0]*k],M,D)}raycast(a,p,m,w,M,D,k=1){if(!this.nodeCount)return null;const L=this.raycastRoot(a,p,m,w,M,D,k);if(null==L)return null;const V=[],$=[],X=[],K=[],J=[{idx:0,t:L,nodex:0,nodey:0,depth:0}];for(;J.length>0;){const{idx:ge,t:Le,nodex:Ze,nodey:st,depth:xt}=J.pop();if(this.leaves[ge]){Lm(Ze,st,xt,a,p,m,w,X,K);const Dt=1<<xt,Rt=(Ze+0)/Dt,Pt=(Ze+1)/Dt,tn=(st+0)/Dt,dn=(st+1)/Dt,en=Zh(Rt,tn,this.dem)*k,Tn=Zh(Pt,tn,this.dem)*k,Xt=Zh(Pt,dn,this.dem)*k,nn=Zh(Rt,dn,this.dem)*k,Cn=ag(X[0],X[1],en,K[0],X[1],Tn,K[0],K[1],Xt,M,D),Ht=ag(K[0],K[1],Xt,X[0],K[1],nn,X[0],X[1],en,M,D),kr=Math.min(null!==Cn?Cn:Number.MAX_VALUE,null!==Ht?Ht:Number.MAX_VALUE);if(kr!==Number.MAX_VALUE)return kr;{const $r=jE([],M,D,Le);if(K1(en,Tn,nn,Xt,lg($r[0],X[0],K[0]),lg($r[1],X[1],K[1]))>=$r[2])return Le}continue}let St=0;for(let Dt=0;Dt<this._siblingOffset.length;Dt++){Lm((Ze<<1)+this._siblingOffset[Dt][0],(st<<1)+this._siblingOffset[Dt][1],xt+1,a,p,m,w,X,K),X[2]=-100,K[2]=this.maximums[this.childOffsets[ge]+Dt]*k;const Rt=ph(X,K,M,D);if(null!=Rt){const Pt=Rt;V[Dt]=Pt;let tn=!1;for(let dn=0;dn<St&&!tn;dn++)Pt>=V[$[dn]]&&($.splice(dn,0,Dt),tn=!0);tn||($[St]=Dt),St++}}for(let Dt=0;Dt<St;Dt++){const Rt=$[Dt];J.push({idx:this.childOffsets[ge]+Rt,t:V[Rt],nodex:(Ze<<1)+this._siblingOffset[Rt][0],nodey:(st<<1)+this._siblingOffset[Rt][1],depth:xt+1})}}return null}_addNode(a,p,m){return this.minimums.push(a),this.maximums.push(p),this.leaves.push(m),this.childOffsets.push(0),this.nodeCount++}_construct(a,p,m,w,M){if(1===a[w].isLeaf(p,m))return;this.childOffsets[M]||(this.childOffsets[M]=this.nodeCount);const D=w-1,k=a[D];let L,V=0;for(let $=0;$<this._siblingOffset.length;$++){const X=2*p+this._siblingOffset[$][0],K=2*m+this._siblingOffset[$][1],J=k.getElevation(X,K),ge=k.isLeaf(X,K),Le=this._addNode(J.min,J.max,ge);ge&&(V|=1<<$),L||(L=Le)}for(let $=0;$<this._siblingOffset.length;$++)V&1<<$||this._construct(a,2*p+this._siblingOffset[$][0],2*m+this._siblingOffset[$][1],D,L+$)}}function K1(h,a,p,m,w,M){return xr(xr(h,p,M),xr(a,m,M),w)}function Zh(h,a,p){const m=p.dim,w=le(h*m-.5,0,m-1),M=le(a*m-.5,0,m-1),D=Math.floor(w),k=Math.floor(M),L=Math.min(D+1,m-1),V=Math.min(k+1,m-1);return K1(p.get(D,k),p.get(L,k),p.get(D,V),p.get(L,V),w-D,M-k)}const zC={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};class Nm{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(a,p,m,w=!1,M=!1){if(this.uid=a,p.height!==p.width)throw new RangeError("DEM tiles must be square");if(m&&"mapbox"!==m&&"terrarium"!==m)return Ke(`"${m}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=p.height;const D=this.dim=p.height-2;if(this.data=new Uint32Array(p.data.buffer),this.encoding=m||"mapbox",this.borderReady=w,!w){for(let k=0;k<D;k++)this.data[this._idx(-1,k)]=this.data[this._idx(0,k)],this.data[this._idx(D,k)]=this.data[this._idx(D-1,k)],this.data[this._idx(k,-1)]=this.data[this._idx(k,0)],this.data[this._idx(k,D)]=this.data[this._idx(k,D-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(D,-1)]=this.data[this._idx(D-1,0)],this.data[this._idx(-1,D)]=this.data[this._idx(0,D-1)],this.data[this._idx(D,D)]=this.data[this._idx(D-1,D-1)],M&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new BC(this)}get(a,p,m=!1){const w=new Uint8Array(this.data.buffer);m&&(a=le(a,-1,this.dim),p=le(p,-1,this.dim));const M=4*this._idx(a,p);return("terrarium"===this.encoding?this._unpackTerrarium:this._unpackMapbox)(w[M],w[M+1],w[M+2])}static getUnpackVector(a){return zC[a]}get unpackVector(){return zC[this.encoding]}_idx(a,p){if(a<-1||a>=this.dim+1||p<-1||p>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(p+1)*this.stride+(a+1)}_unpackMapbox(a,p,m){return(256*a*256+256*p+m)/10-1e4}_unpackTerrarium(a,p,m){return 256*a+p+m/256-32768}static pack(a,p){const m=[0,0,0,0],w=Nm.getUnpackVector(p);let M=Math.floor((a+w[3])/w[2]);return m[2]=M%256,M=Math.floor(M/256),m[1]=M%256,M=Math.floor(M/256),m[0]=M,m}getPixels(){return new Iu({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(a,p,m){if(this.dim!==a.dim)throw new Error("dem dimension mismatch");let w=p*this.dim,M=p*this.dim+this.dim,D=m*this.dim,k=m*this.dim+this.dim;switch(p){case-1:w=M-1;break;case 1:M=w+1}switch(m){case-1:D=k-1;break;case 1:k=D+1}const L=-p*this.dim,V=-m*this.dim;for(let $=D;$<k;$++)for(let X=w;X<M;X++)this.data[this._idx(X,$)]=a.data[this._idx(X+L,$+V)]}onDeserialize(){this._tree&&(this._tree.dem=this)}}Bn("DEMData",Nm),Bn("DemMinMaxQuadTree",BC,{omit:["dem"]});class rP{constructor(a,p){this.max=a,this.onRemove=p,this.reset()}reset(){for(const a in this.data)for(const p of this.data[a])p.timeout&&clearTimeout(p.timeout),this.onRemove(p.value);return this.data={},this.order=[],this}add(a,p,m){const w=a.wrapped().key;void 0===this.data[w]&&(this.data[w]=[]);const M={value:p,timeout:void 0};if(void 0!==m&&(M.timeout=setTimeout(()=>{this.remove(a,M)},m)),this.data[w].push(M),this.order.push(w),this.order.length>this.max){const D=this._getAndRemoveByKey(this.order[0]);D&&this.onRemove(D)}return this}has(a){return a.wrapped().key in this.data}getAndRemove(a){return this.has(a)?this._getAndRemoveByKey(a.wrapped().key):null}_getAndRemoveByKey(a){const p=this.data[a].shift();return p.timeout&&clearTimeout(p.timeout),0===this.data[a].length&&delete this.data[a],this.order.splice(this.order.indexOf(a),1),p.value}getByKey(a){const p=this.data[a];return p?p[0].value:null}get(a){return this.has(a)?this.data[a.wrapped().key][0].value:null}remove(a,p){if(!this.has(a))return this;const m=a.wrapped().key,w=void 0===p?0:this.data[m].indexOf(p),M=this.data[m][w];return this.data[m].splice(w,1),M.timeout&&clearTimeout(M.timeout),0===this.data[m].length&&delete this.data[m],this.onRemove(M.value),this.order.splice(this.order.indexOf(m),1),this}setMaxSize(a){for(this.max=a;this.order.length>this.max;){const p=this._getAndRemoveByKey(this.order[0]);p&&this.onRemove(p)}return this}filter(a){const p=[];for(const m in this.data)for(const w of this.data[m])a(w.value)||p.push(w);for(const m of p)this.remove(m.value.tileID,m)}}class pf{constructor(a,p,m){this.func=a,this.mask=p,this.range=m}}pf.ReadOnly=!1,pf.ReadWrite=!0,pf.disabled=new pf(519,pf.ReadOnly,[0,1]);class nv{constructor(a,p,m,w,M,D){this.test=a,this.ref=p,this.mask=m,this.fail=w,this.depthFail=M,this.pass=D}}nv.disabled=new nv({func:519,mask:0},0,0,7680,7680,7680);class wc{constructor(a,p,m){this.blendFunction=a,this.blendColor=p,this.mask=m}}wc.Replace=[1,0],wc.disabled=new wc(wc.Replace,Nn.transparent,[!1,!1,!1,!1]),wc.unblended=new wc(wc.Replace,Nn.transparent,[!0,!0,!0,!0]),wc.alphaBlended=new wc([1,771],Nn.transparent,[!0,!0,!0,!0]);class gh{constructor(a,p,m){this.enable=a,this.mode=p,this.frontFace=m}}gh.disabled=new gh(!1,1029,2305),gh.backCCW=new gh(!0,1029,2305),gh.backCW=new gh(!0,1029,2304),gh.frontCW=new gh(!0,1028,2304),gh.frontCCW=new gh(!0,1028,2305);class dp extends bn{constructor(a,p,m){super(),this.id=a,this._onlySymbols=m,p.on("data",w=>{"source"===w.dataType&&"metadata"===w.sourceDataType&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===w.dataType&&"content"===w.sourceDataType&&(this.reload(),this.transform&&this.update(this.transform))}),p.on("error",()=>{this._sourceErrored=!0}),this._source=p,this._tiles={},this._cache=new rP(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new Z1}onAdd(a){this.map=a,this._maxTileCacheSize=a?a._maxTileCacheSize:null}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const a in this._tiles){const p=this._tiles[a];if("loaded"!==p.state&&"errored"!==p.state)return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const a=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,a&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(a,p){return a.isSymbolTile=this._onlySymbols,this._source.loadTile(a,p)}_unloadTile(a){if(this._source.unloadTile)return this._source.unloadTile(a,()=>{})}_abortTile(a){if(this._source.abortTile)return this._source.abortTile(a,()=>{})}serialize(){return this._source.serialize()}prepare(a){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const p in this._tiles){const m=this._tiles[p];m.upload(a),m.prepare(this.map.style.imageManager)}}getIds(){return me(this._tiles).map(a=>a.tileID).sort(VC).map(a=>a.key)}getRenderableIds(a){const p=[];for(const m in this._tiles)this._isIdRenderable(+m,a)&&p.push(this._tiles[m]);return a?p.sort((m,w)=>{const M=m.tileID,D=w.tileID,k=new Ge(M.canonical.x,M.canonical.y)._rotate(this.transform.angle),L=new Ge(D.canonical.x,D.canonical.y)._rotate(this.transform.angle);return M.overscaledZ-D.overscaledZ||L.y-k.y||L.x-k.x}).map(m=>m.tileID.key):p.map(m=>m.tileID).sort(VC).map(m=>m.key)}hasRenderableParent(a){const p=this.findLoadedParent(a,0);return!!p&&this._isIdRenderable(p.tileID.key)}_isIdRenderable(a,p){return this._tiles[a]&&this._tiles[a].hasData()&&!this._coveredTiles[a]&&(p||!this._tiles[a].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const a in this._tiles)"errored"!==this._tiles[a].state&&this._reloadTile(+a,"reloading")}}_reloadTile(a,p){const m=this._tiles[a];m&&("loading"!==m.state&&(m.state=p),this._loadTile(m,this._tileLoaded.bind(this,m,a,p)))}_tileLoaded(a,p,m,w){if(w)return a.state="errored",void(404!==w.status?this._source.fire(new Wt(w,{tile:a})):this.update(this.transform));a.timeAdded=rn.now(),"expired"===m&&(a.refreshedUponExpiration=!0),this._setTileReloadTimer(p,a),"raster-dem"===this.getSource().type&&a.dem&&this._backfillDEM(a),this._state.initializeTileState(a,this.map?this.map.painter:null),this._source.fire(new fn("data",{dataType:"source",tile:a,coord:a.tileID,sourceCacheId:this.id}))}_backfillDEM(a){const p=this.getRenderableIds();for(let w=0;w<p.length;w++){const M=p[w];if(a.neighboringTiles&&a.neighboringTiles[M]){const D=this.getTileByID(M);m(a,D),m(D,a)}}function m(w,M){if(!w.dem||w.dem.borderReady)return;w.needsHillshadePrepare=!0,w.needsDEMTextureUpload=!0;let D=M.tileID.canonical.x-w.tileID.canonical.x;const k=M.tileID.canonical.y-w.tileID.canonical.y,L=Math.pow(2,w.tileID.canonical.z),V=M.tileID.key;0===D&&0===k||Math.abs(k)>1||(Math.abs(D)>1&&(1===Math.abs(D+L)?D+=L:1===Math.abs(D-L)&&(D-=L)),M.dem&&w.dem&&(w.dem.backfillBorder(M.dem,D,k),w.neighboringTiles&&w.neighboringTiles[V]&&(w.neighboringTiles[V].backfilled=!0)))}}getTile(a){return this.getTileByID(a.key)}getTileByID(a){return this._tiles[a]}_retainLoadedChildren(a,p,m,w){for(const M in this._tiles){let D=this._tiles[M];if(w[M]||!D.hasData()||D.tileID.overscaledZ<=p||D.tileID.overscaledZ>m)continue;let k=D.tileID;for(;D&&D.tileID.overscaledZ>p+1;){const V=D.tileID.scaledTo(D.tileID.overscaledZ-1);D=this._tiles[V.key],D&&D.hasData()&&(k=V)}let L=k;for(;L.overscaledZ>p;)if(L=L.scaledTo(L.overscaledZ-1),a[L.key]){w[k.key]=k;break}}}findLoadedParent(a,p){if(a.key in this._loadedParentTiles){const m=this._loadedParentTiles[a.key];return m&&m.tileID.overscaledZ>=p?m:null}for(let m=a.overscaledZ-1;m>=p;m--){const w=a.scaledTo(m),M=this._getLoadedTile(w);if(M)return M}}_getLoadedTile(a){const p=this._tiles[a.key];return p&&p.hasData()?p:this._cache.getByKey(this._source.reparseOverscaled?a.wrapped().key:a.canonical.key)}updateCacheSize(a,p){p=p||this._source.tileSize;const m=Math.ceil(a.width/p)+1,w=Math.ceil(a.height/p)+1,M=Math.floor(m*w*5),D="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,M):M;this._cache.setMaxSize(D)}handleWrapJump(a){const p=Math.round((a-(void 0===this._prevLng?a:this._prevLng))/360);if(this._prevLng=a,p){const m={};for(const w in this._tiles){const M=this._tiles[w];M.tileID=M.tileID.unwrapTo(M.tileID.wrap+p),m[M.tileID.key]=M}this._tiles=m;for(const w in this._timers)clearTimeout(this._timers[w]),delete this._timers[w];for(const w in this._tiles)this._setTileReloadTimer(+w,this._tiles[w])}}update(a,p,m){if(this.transform=a,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!m)return;let w;this.updateCacheSize(a,p),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?w=a.getVisibleUnwrappedCoordinates(this._source.tileID).map(k=>new Ll(k.canonical.z,k.wrap,k.canonical.z,k.canonical.x,k.canonical.y)):(w=a.coveringTiles({tileSize:p||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!m,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(w=w.filter(k=>this._source.hasTile(k)))):w=[];const M=this._updateRetainedTiles(w);if(UC(this._source.type)&&0!==w.length){const k={},L={},V=Object.keys(M);for(const X of V){const K=M[X],J=this._tiles[X];if(!J||J.fadeEndTime&&J.fadeEndTime<=rn.now())continue;const ge=this.findLoadedParent(K,Math.max(K.overscaledZ-dp.maxOverzooming,this._source.minzoom));ge&&(this._addTile(ge.tileID),k[ge.tileID.key]=ge.tileID),L[X]=K}const $=w[w.length-1].overscaledZ;for(const X in this._tiles){const K=this._tiles[X];if(M[X]||!K.hasData())continue;let J=K.tileID;for(;J.overscaledZ>$;){J=J.scaledTo(J.overscaledZ-1);const ge=this._tiles[J.key];if(ge&&ge.hasData()&&L[J.key]){M[X]=K.tileID;break}}}for(const X in k)M[X]||(this._coveredTiles[X]=!0,M[X]=k[X])}for(const k in M)this._tiles[k].clearFadeHold();const D=function(k,L){const V=[];for(const $ in k)$ in L||V.push($);return V}(this._tiles,M);for(const k of D){const L=this._tiles[k];L.hasSymbolBuckets&&!L.holdingForFade()?L.setHoldDuration(this.map._fadeDuration):L.hasSymbolBuckets&&!L.symbolFadeFinished()||this._removeTile(+k)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const a in this._tiles)this._tiles[a].holdingForFade()&&this._removeTile(+a)}_updateRetainedTiles(a){const p={};if(0===a.length)return p;const m={},w=a[a.length-1].overscaledZ,M=a[0].overscaledZ,D=Math.max(M-dp.maxOverzooming,this._source.minzoom),k=Math.max(M+dp.maxUnderzooming,this._source.minzoom),L={};for(const V of a){const $=this._addTile(V);p[V.key]=V,$.hasData()||w<this._source.maxzoom&&(L[V.key]=V)}this._retainLoadedChildren(L,w,k,p);for(const V of a){let $=this._tiles[V.key];if($.hasData())continue;if(V.canonical.z>=this._source.maxzoom){const K=V.children(this._source.maxzoom)[0],J=this.getTile(K);if(J&&J.hasData()){p[K.key]=K;continue}}else{const K=V.children(this._source.maxzoom);if(p[K[0].key]&&p[K[1].key]&&p[K[2].key]&&p[K[3].key])continue}let X=$.wasRequested();for(let K=V.overscaledZ-1;K>=D;--K){const J=V.scaledTo(K);if(m[J.key]||(m[J.key]=!0,$=this.getTile(J),!$&&X&&($=this._addTile(J)),$&&(p[J.key]=J,X=$.wasRequested(),$.hasData())))break}}return p}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const a in this._tiles){const p=[];let m,w=this._tiles[a].tileID;for(;w.overscaledZ>0;){if(w.key in this._loadedParentTiles){m=this._loadedParentTiles[w.key];break}p.push(w.key);const M=w.scaledTo(w.overscaledZ-1);if(m=this._getLoadedTile(M),m)break;w=M}for(const M of p)this._loadedParentTiles[M]=m}}_addTile(a){let p=this._tiles[a.key];if(p)return p;p=this._cache.getAndRemove(a),p&&(this._setTileReloadTimer(a.key,p),p.tileID=a,this._state.initializeTileState(p,this.map?this.map.painter:null),this._cacheTimers[a.key]&&(clearTimeout(this._cacheTimers[a.key]),delete this._cacheTimers[a.key],this._setTileReloadTimer(a.key,p)));const m=Boolean(p);return m||(p=new NC(a,this._source.tileSize*a.overscaleFactor(),this.transform.tileZoom),this._loadTile(p,this._tileLoaded.bind(this,p,a.key,p.state))),p?(p.uses++,this._tiles[a.key]=p,m||this._source.fire(new fn("dataloading",{tile:p,coord:p.tileID,dataType:"source"})),p):null}_setTileReloadTimer(a,p){a in this._timers&&(clearTimeout(this._timers[a]),delete this._timers[a]);const m=p.getExpiryTimeout();m&&(this._timers[a]=setTimeout(()=>{this._reloadTile(a,"expired"),delete this._timers[a]},m))}_removeTile(a){const p=this._tiles[a];p&&(p.uses--,delete this._tiles[a],this._timers[a]&&(clearTimeout(this._timers[a]),delete this._timers[a]),p.uses>0||(p.hasData()&&"reloading"!==p.state?this._cache.add(p.tileID,p,p.getExpiryTimeout()):(p.aborted=!0,this._abortTile(p),this._unloadTile(p))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const a in this._tiles)this._removeTile(+a);this._cache.reset()}tilesIn(a,p,m){const w=[],M=this.transform;if(!M)return w;for(const D in this._tiles){const k=this._tiles[D];if(m&&k.clearQueryDebugViz(),k.holdingForFade())continue;const L=a.containsTile(k,M,p);L&&w.push(L)}return w}getVisibleCoordinates(a){const p=this.getRenderableIds(a).map(m=>this._tiles[m].tileID);for(const m of p)m.projMatrix=this.transform.calculateProjMatrix(m.toUnwrapped());return p}hasTransition(){if(this._source.hasTransition())return!0;if(UC(this._source.type))for(const a in this._tiles){const p=this._tiles[a];if(void 0!==p.fadeEndTime&&p.fadeEndTime>=rn.now())return!0}return!1}setFeatureState(a,p,m){this._state.updateState(a=a||"_geojsonTileLayer",p,m)}removeFeatureState(a,p,m){this._state.removeFeatureState(a=a||"_geojsonTileLayer",p,m)}getFeatureState(a,p){return this._state.getState(a=a||"_geojsonTileLayer",p)}setDependencies(a,p,m){const w=this._tiles[a];w&&w.setDependencies(p,m)}reloadTilesForDependencies(a,p){for(const m in this._tiles)this._tiles[m].hasDependency(a,p)&&this._reloadTile(+m,"reloading");this._cache.filter(m=>!m.hasDependency(a,p))}}function VC(h,a){const p=Math.abs(2*h.wrap)-+(h.wrap<0),m=Math.abs(2*a.wrap)-+(a.wrap<0);return h.overscaledZ-a.overscaledZ||m-p||a.canonical.y-h.canonical.y||a.canonical.x-h.canonical.x}function UC(h){return"raster"===h||"image"===h||"video"===h}dp.maxOverzooming=10,dp.maxUnderzooming=3;class rv{constructor(a,p,m){this._demTile=a,this._dem=this._demTile.dem,this._scale=p,this._offset=m}static create(a,p,m){const w=m||a.findDEMTileFor(p);if(!w||!w.dem)return;const M=w.dem,D=w.tileID,k=1<<p.canonical.z-D.canonical.z;return new rv(w,w.tileSize/Ao/k,[(p.canonical.x/k-D.canonical.x)*M.dim,(p.canonical.y/k-D.canonical.y)*M.dim])}tileCoordToPixel(a,p){const m=p*this._scale+this._offset[1],w=Math.floor(a*this._scale+this._offset[0]),M=Math.floor(m);return new Ge(w,M)}getElevationAt(a,p,m,w){const M=a*this._scale+this._offset[0],D=p*this._scale+this._offset[1],k=Math.floor(M),L=Math.floor(D),V=this._dem;return w=!!w,m?xr(xr(V.get(k,L,w),V.get(k,L+1,w),D-L),xr(V.get(k+1,L,w),V.get(k+1,L+1,w),D-L),M-k):V.get(k,L,w)}getElevationAtPixel(a,p,m){return this._dem.get(a,p,!!m)}getMeterToDEM(a){return(1<<this._demTile.tileID.canonical.z)*Zy(1,a)*this._dem.stride}}class jC{constructor(a,p){this.tileID=a,this.x=a.canonical.x,this.y=a.canonical.y,this.z=a.canonical.z,this.grid=new pu(Ao,16,0),this.featureIndexArray=new Bp,this.promoteId=p}insert(a,p,m,w,M,D=0){const k=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(m,w,M,D);const L=this.grid;for(let V=0;V<p.length;V++){const $=p[V],X=[1/0,1/0,-1/0,-1/0];for(let K=0;K<$.length;K++){const J=$[K];X[0]=Math.min(X[0],J.x),X[1]=Math.min(X[1],J.y),X[2]=Math.max(X[2],J.x),X[3]=Math.max(X[3],J.y)}X[0]<Ao&&X[1]<Ao&&X[2]>=0&&X[3]>=0&&L.insert(k,X[0],X[1],X[2],X[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new wd.VectorTile(new Ha(this.rawTileData)).layers,this.sourceLayerCoder=new km(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(a,p,m,w){this.loadVTLayers();const M=a.params||{},D=Zl(M.filter),k=a.tileResult,L=a.transform,V=k.bufferedTilespaceBounds,$=this.grid.query(V.min.x,V.min.y,V.max.x,V.max.y,(ge,Le,Ze,st)=>g1(k.bufferedTilespaceGeometry,ge,Le,Ze,st));$.sort(iP);let X=null;L.elevation&&$.length>0&&(X=rv.create(L.elevation,this.tileID));const K={};let J;for(let ge=0;ge<$.length;ge++){const Le=$[ge];if(Le===J)continue;J=Le;const Ze=this.featureIndexArray.get(Le);let st=null;this.loadMatchingFeature(K,Ze,D,M.layers,M.availableImages,p,m,w,(xt,St,Dt,Rt=0)=>(st||(st=Hf(xt)),St.queryIntersectsFeature(k,xt,Dt,st,this.z,a.transform,a.pixelPosMatrix,X,Rt)))}return K}loadMatchingFeature(a,p,m,w,M,D,k,L,V){const{featureIndex:$,bucketIndex:X,sourceLayerIndex:K,layoutVertexArrayOffset:J}=p,ge=this.bucketLayerIDs[X];if(w&&!function(xt,St){for(let Dt=0;Dt<xt.length;Dt++)if(St.indexOf(xt[Dt])>=0)return!0;return!1}(w,ge))return;const Le=this.sourceLayerCoder.decode(K),Ze=this.vtLayers[Le].feature($);if(m.needGeometry){const xt=Lc(Ze,!0);if(!m.filter(new se(this.tileID.overscaledZ),xt,this.tileID.canonical))return}else if(!m.filter(new se(this.tileID.overscaledZ),Ze))return;const st=this.getId(Ze,Le);for(let xt=0;xt<ge.length;xt++){const St=ge[xt];if(w&&w.indexOf(St)<0)continue;const Dt=D[St];if(!Dt)continue;let Rt={};void 0!==st&&L&&(Rt=L.getState(Dt.sourceLayer||"_geojsonTileLayer",st));const Pt=be({},k[St]);Pt.paint=GC(Pt.paint,Dt.paint,Ze,Rt,M),Pt.layout=GC(Pt.layout,Dt.layout,Ze,Rt,M);const tn=!V||V(Ze,Dt,Rt,J);if(!tn)continue;const dn=new ev(Ze,this.z,this.x,this.y,st);dn.layer=Pt;let en=a[St];void 0===en&&(en=a[St]=[]),en.push({featureIndex:$,feature:dn,intersectionZ:tn})}}lookupSymbolFeatures(a,p,m,w,M,D,k,L){const V={};this.loadVTLayers();const $=Zl(M);for(const X of a)this.loadMatchingFeature(V,{bucketIndex:m,sourceLayerIndex:w,featureIndex:X,layoutVertexArrayOffset:0},$,D,k,L,p);return V}hasLayer(a){for(const p of this.bucketLayerIDs)for(const m of p)if(a===m)return!0;return!1}getId(a,p){let m=a.id;return this.promoteId&&(m=a.properties["string"==typeof this.promoteId?this.promoteId:this.promoteId[p]],"boolean"==typeof m&&(m=Number(m))),m}}function GC(h,a,p,m,w){return Ce(h,(M,D)=>{const k=a instanceof ot?a.get(D):null;return k&&k.evaluate?k.evaluate(p,m,w):k})}function iP(h,a){return a-h}Bn("FeatureIndex",jC,{omit:["rawTileData","sourceLayerCoder"]});class $C{constructor(a){const p={},m=[];for(const k in a){const L=a[k],V=p[k]={};for(const $ in L.glyphs){const X=L.glyphs[+$];if(!X||0===X.bitmap.width||0===X.bitmap.height)continue;const K=X.metrics.localGlyph?2:1,J={x:0,y:0,w:X.bitmap.width+2*K,h:X.bitmap.height+2*K};m.push(J),V[$]=J}}const{w,h:M}=Ay(m),D=new Hh({width:w||1,height:M||1});for(const k in a){const L=a[k];for(const V in L.glyphs){const $=L.glyphs[+V];if(!$||0===$.bitmap.width||0===$.bitmap.height)continue;const X=p[k][V],K=$.metrics.localGlyph?2:1;Hh.copy($.bitmap,D,{x:0,y:0},{x:X.x+K,y:X.y+K},$.bitmap)}}this.image=D,this.positions=p}}Bn("GlyphAtlas",$C);class Dd{constructor(a){this.tileID=new Ll(a.tileID.overscaledZ,a.tileID.wrap,a.tileID.canonical.z,a.tileID.canonical.x,a.tileID.canonical.y),this.tileZoom=a.tileZoom,this.uid=a.uid,this.zoom=a.zoom,this.pixelRatio=a.pixelRatio,this.tileSize=a.tileSize,this.source=a.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=a.showCollisionBoxes,this.collectResourceTiming=!!a.collectResourceTiming,this.returnDependencies=!!a.returnDependencies,this.promoteId=a.promoteId,this.enableTerrain=!!a.enableTerrain,this.isSymbolTile=a.isSymbolTile}parse(a,p,m,w,M){this.status="parsing",this.data=a,this.collisionBoxArray=new Vf;const D=new km(Object.keys(a.layers).sort()),k=new jC(this.tileID,this.promoteId);k.bucketLayerIDs=[];const L={},V=new Jy(256,256),$={featureIndex:k,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:V,availableImages:m},X=p.familiesBySource[this.source];for(const Rt in X){const Pt=a.layers[Rt];if(!Pt)continue;let tn=!1,dn=!1;for(const Xt of X[Rt])"symbol"===Xt[0].type?tn=!0:dn=!0;if(!0===this.isSymbolTile&&!tn||!1===this.isSymbolTile&&!dn)continue;1===Pt.version&&Ke(`Vector tile source "${this.source}" layer "${Rt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const en=D.encode(Rt),Tn=[];for(let Xt=0;Xt<Pt.length;Xt++){const nn=Pt.feature(Xt),Cn=k.getId(nn,Rt);Tn.push({feature:nn,id:Cn,index:Xt,sourceLayerIndex:en})}for(const Xt of X[Rt]){const nn=Xt[0];void 0!==this.isSymbolTile&&"symbol"===nn.type!==this.isSymbolTile||nn.minzoom&&this.zoom<Math.floor(nn.minzoom)||nn.maxzoom&&this.zoom>=nn.maxzoom||"none"!==nn.visibility&&(ug(Xt,this.zoom,m),(L[nn.id]=nn.createBucket({index:k.bucketLayerIDs.length,layers:Xt,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:en,sourceID:this.source,enableTerrain:this.enableTerrain})).populate(Tn,$,this.tileID.canonical),k.bucketLayerIDs.push(Xt.map(Cn=>Cn.id)))}}let K,J,ge,Le;V.trim();const Ze={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},st=Ce($.glyphDependencies,Rt=>Object.keys(Rt).map(Number));Object.keys(st).length?w.send("getGlyphs",{uid:this.uid,stacks:st},(Rt,Pt)=>{K||(K=Rt,J=Pt,Dt.call(this))},void 0,!1,Ze):J={};const xt=Object.keys($.iconDependencies);xt.length?w.send("getImages",{icons:xt,source:this.source,tileID:this.tileID,type:"icons"},(Rt,Pt)=>{K||(K=Rt,ge=Pt,Dt.call(this))},void 0,!1,Ze):ge={};const St=Object.keys($.patternDependencies);function Dt(){if(K)return M(K);if(J&&ge&&Le){const Rt=new $C(J),Pt=new k1(ge,Le);for(const tn in L){const dn=L[tn];dn instanceof Yh?(ug(dn.layers,this.zoom,m),AC(dn,J,Rt.positions,ge,Pt.iconPositions,this.showCollisionBoxes,this.tileID.canonical,this.tileZoom)):dn.hasPattern&&(dn instanceof by||dn instanceof fm||dn instanceof pm)&&(ug(dn.layers,this.zoom,m),dn.addFeatures($,this.tileID.canonical,Pt.patternPositions))}this.status="done",M(null,{buckets:me(L).filter(tn=>!tn.isEmpty()),featureIndex:k,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Rt.image,lineAtlas:V,imageAtlas:Pt,glyphMap:this.returnDependencies?J:null,iconMap:this.returnDependencies?ge:null,glyphPositions:this.returnDependencies?Rt.positions:null})}}St.length?w.send("getImages",{icons:St,source:this.source,tileID:this.tileID,type:"patterns"},(Rt,Pt)=>{K||(K=Rt,Le=Pt,Dt.call(this))},void 0,!1,Ze):Le={},Dt.call(this)}}function ug(h,a,p){const m=new se(a);for(const w of h)w.recalculate(m,p)}class ex{constructor(a){this.entries={},this.scheduler=a}request(a,p,m,w){const M=this.entries[a]=this.entries[a]||{callbacks:[]};if(M.result){const[D,k]=M.result;return this.scheduler?this.scheduler.add(()=>{w(D,k)},p):w(D,k),()=>{}}return M.callbacks.push(w),M.cancel||(M.cancel=m((D,k)=>{M.result=[D,k];for(const L of M.callbacks)this.scheduler?this.scheduler.add(()=>{L(D,k)},p):L(D,k);setTimeout(()=>delete this.entries[a],3e3)})),()=>{M.result||(M.callbacks=M.callbacks.filter(D=>D!==w),M.callbacks.length||(M.cancel(),delete this.entries[a]))}}}function iv(h,a,p){const m=JSON.stringify(h.request);return h.data&&(this.deduped.entries[m]={result:[null,h.data]}),this.deduped.request(m,{type:"parseTile",isSymbolTile:h.isSymbolTile,zoom:h.tileZoom},w=>{const M=Q(h.request,(D,k,L,V)=>{D?w(D):k&&w(null,{vectorTile:p?void 0:new wd.VectorTile(new Ha(k)),rawData:k,cacheControl:L,expires:V})});return()=>{M.cancel(),w()}},a)}x.ARRAY_TYPE=Ku,x.AUTH_ERR_MSG=Ie,x.Actor=class{constructor(h,a,p){this.target=h,this.parent=a,this.mapId=p,this.callbacks={},this.cancelCallbacks={},jt(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=Ut()?h:It,this.scheduler=new Rm}send(h,a,p,m,w=!1,M){const D=Math.round(1e18*Math.random()).toString(36).substring(0,10);p&&(p.metadata=M,this.callbacks[D]=p);const k=In(this.globalScope)?void 0:[];return this.target.postMessage({id:D,type:h,hasCallback:!!p,targetMapId:m,mustQueue:w,sourceMapId:this.mapId,data:Wu(a,k)},k),{cancel:()=>{p&&delete this.callbacks[D],this.target.postMessage({id:D,type:"<cancel>",targetMapId:m,sourceMapId:this.mapId})}}}receive(h){const a=h.data,p=a.id;if(p&&(!a.targetMapId||this.mapId===a.targetMapId))if("<cancel>"===a.type){const m=this.cancelCallbacks[p];delete this.cancelCallbacks[p],m&&m.cancel()}else if(a.mustQueue||Ut()){const m=this.callbacks[p];this.cancelCallbacks[p]=this.scheduler.add(()=>this.processTask(p,a),m&&m.metadata||{type:"message"})}else this.processTask(p,a)}processTask(h,a){if("<response>"===a.type){const p=this.callbacks[h];delete this.callbacks[h],p&&(a.error?p(md(a.error)):p(null,md(a.data)))}else{const p=In(this.globalScope)?void 0:[],m=a.hasCallback?(M,D)=>{delete this.cancelCallbacks[h],this.target.postMessage({id:h,type:"<response>",sourceMapId:this.mapId,error:M?Wu(M):null,data:Wu(D,p)},p)}:M=>{},w=md(a.data);if(this.parent[a.type])this.parent[a.type](a.sourceMapId,w,m);else if(this.parent.getWorkerSource){const M=a.type.split(".");this.parent.getWorkerSource(a.sourceMapId,M[0],w.source)[M[1]](w,m)}else m(new Error(`Could not find function ${a.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},x.CanonicalTileID=Om,x.Color=Nn,x.ColorMode=wc,x.CullFaceMode=gh,x.DEMData=Nm,x.DataConstantProperty=Xe,x.DedupedRequest=ex,x.DepthMode=pf,x.EXTENT=Ao,x.Elevation=class{getAtPointOrZero(h,a=0){return this.getAtPoint(h,a)||0}getAtPoint(h,a,p=!0){null==a&&(a=null);const m=this._source();if(!m||h.y<0||h.y>1)return a;const w=m.getSource().maxzoom,M=1<<w,D=Math.floor(h.x),k=h.x-D,L=new Ll(w,D,w,Math.floor(k*M),Math.floor(h.y*M)),V=this.findDEMTileFor(L);if(!V||!V.dem)return a;const $=V.dem,X=1<<V.tileID.canonical.z,K=(k*X-V.tileID.canonical.x)*$.dim,J=(h.y*X-V.tileID.canonical.y)*$.dim,ge=Math.floor(K),Le=Math.floor(J);return(p?this.exaggeration():1)*xr(xr($.get(ge,Le),$.get(ge,Le+1),J-Le),xr($.get(ge+1,Le),$.get(ge+1,Le+1),J-Le),K-ge)}getAtTileOffset(h,a,p){const m=1<<h.canonical.z;return this.getAtPointOrZero(new hp(h.wrap+(h.canonical.x+a/Ao)/m,(h.canonical.y+p/Ao)/m))}getForTilePoints(h,a,p,m){const w=rv.create(this,h,m);return!!w&&(a.forEach(M=>{M[2]=this.exaggeration()*w.getElevationAt(M[0],M[1],p)}),!0)}getMinMaxForTile(h){const a=this.findDEMTileFor(h);if(!a||!a.dem)return null;const p=a.dem.tree,m=a.tileID,w=1<<h.canonical.z-m.canonical.z;let M=h.canonical.x/w-m.canonical.x,D=h.canonical.y/w-m.canonical.y,k=0;for(let L=0;L<h.canonical.z-m.canonical.z&&!p.leaves[k];L++){M*=2,D*=2;const V=2*Math.floor(D)+Math.floor(M);k=p.childOffsets[k]+V,M%=1,D%=1}return{min:this.exaggeration()*p.minimums[k],max:this.exaggeration()*p.maximums[k]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(h,a,p){throw new Error("Pure virtual method called.")}pointCoordinate(h){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(h){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},x.ErrorEvent=Wt,x.EvaluationParameters=se,x.Event=fn,x.Evented=bn,x.GlyphManager=Sd,x.ImagePosition=Py,x.LineAtlas=Jy,x.LngLat=Gs,x.LngLatBounds=ff,x.LocalGlyphMode=Cd,x.MAX_SAFE_INTEGER=kt,x.MercatorCoordinate=hp,x.ONE_EM=24,x.OverscaledTileID=Ll,x.Properties=et,x.RGBAImage=Iu,x.RequestManager=class{constructor(h,a,p){this._transformRequestFn=h,this._customAccessToken=a,this._silenceAuthErrors=!!p,this._createSkuToken()}_createSkuToken(){const h=function(){let a="";for(let p=0;p<10;p++)a+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",ae,a].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=h.token,this._skuTokenExpiresAt=h.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(h,a){return this._transformRequestFn&&this._transformRequestFn(h,a)||{url:h}}normalizeStyleURL(h,a){if(!ct(h))return h;const p=Yt(h);return p.path=`/styles/v1${p.path}`,this._makeAPIURL(p,this._customAccessToken||a)}normalizeGlyphsURL(h,a){if(!ct(h))return h;const p=Yt(h);return p.path=`/fonts/v1${p.path}`,this._makeAPIURL(p,this._customAccessToken||a)}normalizeSourceURL(h,a){if(!ct(h))return h;const p=Yt(h);return p.path=`/v4/${p.authority}.json`,p.params.push("secure"),this._makeAPIURL(p,this._customAccessToken||a)}normalizeSpriteURL(h,a,p,m){const w=Yt(h);return ct(h)?(w.path=`/styles/v1${w.path}/sprite${a}${p}`,this._makeAPIURL(w,this._customAccessToken||m)):(w.path+=`${a}${p}`,wt(w))}normalizeTileURL(h,a,p){if(this._isSkuTokenExpired()&&this._createSkuToken(),h&&!ct(h))return h;const m=Yt(h);m.path=m.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${a||p&&"raster"!==m.authority&&512===p?"@2x":""}${ai.supported?".webp":"$1"}`),"raster"===m.authority?m.path=`/${nr.RASTER_URL_PREFIX}${m.path}`:(m.path=m.path.replace(/^.+\/v4\//,"/"),m.path=`/${nr.TILE_URL_VERSION}${m.path}`);const w=this._customAccessToken||function(M){for(const D of M){const k=D.match(/^access_token=(.*)$/);if(k)return k[1]}return null}(m.params)||nr.ACCESS_TOKEN;return nr.REQUIRE_ACCESS_TOKEN&&w&&this._skuToken&&m.params.push(`sku=${this._skuToken}`),this._makeAPIURL(m,w)}canonicalizeTileURL(h,a){const p=Yt(h);if(!p.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!p.path.match(/\.[\w]+$/))return h;let m="mapbox://";p.path.match(/^\/raster\/v1\//)?m+=`raster/${p.path.replace(`/${nr.RASTER_URL_PREFIX}/`,"")}`:m+=`tiles/${p.path.replace(`/${nr.TILE_URL_VERSION}/`,"")}`;let w=p.params;return a&&(w=w.filter(M=>!M.match(/^access_token=/))),w.length&&(m+=`?${w.join("&")}`),m}canonicalizeTileset(h,a){const p=!!a&&ct(a),m=[];for(const w of h.tiles||[])Ot(w)?m.push(this.canonicalizeTileURL(w,p)):m.push(w);return m}_makeAPIURL(h,a){const p="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",m=Yt(nr.API_URL);if(h.protocol=m.protocol,h.authority=m.authority,"http"===h.protocol){const w=h.params.indexOf("secure");w>=0&&h.params.splice(w,1)}if("/"!==m.path&&(h.path=`${m.path}${h.path}`),!nr.REQUIRE_ACCESS_TOKEN)return wt(h);if(a=a||nr.ACCESS_TOKEN,!this._silenceAuthErrors){if(!a)throw new Error(`An API access token is required to use Mapbox GL. ${p}`);if("s"===a[0])throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${p}`)}return h.params=h.params.filter(w=>-1===w.indexOf("access_token")),h.params.push(`access_token=${a||""}`),wt(h)}},x.ResourceType=Fs,x.SegmentVector=eu,x.SourceCache=dp,x.StencilMode=nv,x.StructArrayLayout1ui2=Pa,x.StructArrayLayout2f1f2i16=Oc,x.StructArrayLayout2i4=pr,x.StructArrayLayout2ui4=yc,x.StructArrayLayout3f12=Pl,x.StructArrayLayout3ui6=ns,x.StructArrayLayout4i8=gi,x.Texture=Pm,x.Tile=NC,x.Transitionable=Ve,x.Uniform1f=jh,x.Uniform1i=class extends Uh{constructor(h,a){super(h,a),this.current=0}set(h){this.current!==h&&(this.current=h,this.gl.uniform1i(this.location,h))}},x.Uniform2f=class extends Uh{constructor(h,a){super(h,a),this.current=[0,0]}set(h){h[0]===this.current[0]&&h[1]===this.current[1]||(this.current=h,this.gl.uniform2f(this.location,h[0],h[1]))}},x.Uniform3f=class extends Uh{constructor(h,a){super(h,a),this.current=[0,0,0]}set(h){h[0]===this.current[0]&&h[1]===this.current[1]&&h[2]===this.current[2]||(this.current=h,this.gl.uniform3f(this.location,h[0],h[1],h[2]))}},x.Uniform4f=Ol,x.UniformColor=Qg,x.UniformMatrix3f=class extends Uh{constructor(h,a){super(h,a),this.current=$f}set(h){for(let a=0;a<9;a++)if(h[a]!==this.current[a]){this.current=h,this.gl.uniformMatrix3fv(this.location,!1,h);break}}},x.UniformMatrix4f=class extends Uh{constructor(h,a){super(h,a),this.current=jp}set(h){if(h[12]!==this.current[12]||h[0]!==this.current[0])return this.current=h,void this.gl.uniformMatrix4fv(this.location,!1,h);for(let a=1;a<16;a++)if(h[a]!==this.current[a]){this.current=h,this.gl.uniformMatrix4fv(this.location,!1,h);break}}},x.UnwrappedTileID=Y1,x.ValidationError=Vt,x.VectorTileWorkerSource=class extends bn{constructor(h,a,p,m,w){super(),this.actor=h,this.layerIndex=a,this.availableImages=p,this.loadVectorData=w||iv,this.loading={},this.loaded={},this.deduped=new ex(h.scheduler),this.isSpriteLoaded=m,this.scheduler=h.scheduler}loadTile(h,a){const p=h.uid,m=h&&h.request,w=m&&m.collectResourceTiming,M=this.loading[p]=new Dd(h);M.abort=this.loadVectorData(h,(D,k)=>{const L=!this.loading[p];if(delete this.loading[p],L||D||!k)return M.status="done",L||(this.loaded[p]=M),a(D);const V=k.rawData,$={};k.expires&&($.expires=k.expires),k.cacheControl&&($.cacheControl=k.cacheControl),M.vectorTile=k.vectorTile||new wd.VectorTile(new Ha(V));const X=()=>{M.parse(M.vectorTile,this.layerIndex,this.availableImages,this.actor,(K,J)=>{if(K||!J)return a(K);const ge={};if(w){const Le=Qy(m);Le.length>0&&(ge.resourceTiming=JSON.parse(JSON.stringify(Le)))}a(null,be({rawTileData:V.slice(0)},J,$,ge))})};this.isSpriteLoaded?X():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(X,{type:"parseTile",isSymbolTile:h.isSymbolTile,zoom:h.tileZoom}):X()}),this.loaded=this.loaded||{},this.loaded[p]=M})}reloadTile(h,a){const p=this.loaded,m=h.uid,w=this;if(p&&p[m]){const M=p[m];M.showCollisionBoxes=h.showCollisionBoxes,M.enableTerrain=!!h.enableTerrain;const D=(k,L)=>{const V=M.reloadCallback;V&&(delete M.reloadCallback,M.parse(M.vectorTile,w.layerIndex,this.availableImages,w.actor,V)),a(k,L)};"parsing"===M.status?M.reloadCallback=D:"done"===M.status&&(M.vectorTile?M.parse(M.vectorTile,this.layerIndex,this.availableImages,this.actor,D):D())}}abortTile(h,a){const p=h.uid,m=this.loading[p];m&&(m.abort&&m.abort(),delete this.loading[p]),a()}removeTile(h,a){const p=this.loaded,m=h.uid;p&&p[m]&&delete p[m],a()}},x.WritingMode=Ju,x.ZoomHistory=Bh,x.add=function(h,a,p){return h[0]=a[0]+p[0],h[1]=a[1]+p[1],h[2]=a[2]+p[2],h},x.addDynamicAttributes=ig,x.altitudeFromMercatorZ=Ky,x.asyncAll=he,x.bezier=ue,x.bindAll=jt,x.bufferConvexPolygon=function(h,a){const p=[];for(let m=0;m<h.length;m++){const w=Ne(m-1,-1,h.length-1),M=Ne(m+1,-1,h.length-1),D=h[m],k=h[M],L=h[w].sub(D).unit(),V=k.sub(D).unit(),$=V.angleWithSep(L.x,L.y),X=L.add(V).unit().mult(-1*a/Math.sin($/2));p.push(D.add(X))}return p},x.cacheEntryPossiblyAdded=function(h){al++,al>fa&&(h.getActor().send("enforceCacheSizeLimit",qi),al=0)},x.clamp=le,x.clearTileCache=function(h){const a=It.caches.delete(jo);h&&a.catch(h).then(()=>h())},x.clipLine=ap,x.clone=function(h){var a=new Ku(3);return a[0]=h[0],a[1]=h[1],a[2]=h[2],a},x.clone$1=function(h){var a=new Ku(16);return a[0]=h[0],a[1]=h[1],a[2]=h[2],a[3]=h[3],a[4]=h[4],a[5]=h[5],a[6]=h[6],a[7]=h[7],a[8]=h[8],a[9]=h[9],a[10]=h[10],a[11]=h[11],a[12]=h[12],a[13]=h[13],a[14]=h[14],a[15]=h[15],a},x.clone$2=Pe,x.collisionCircleLayout=D1,x.config=nr,x.conjugate=function(h,a){return h[0]=-a[0],h[1]=-a[1],h[2]=-a[2],h[3]=a[3],h},x.copy=function(h,a){return h[0]=a[0],h[1]=a[1],h[2]=a[2],h},x.create=nm,x.create$1=function(){var h=new Ku(16);return Ku!=Float32Array&&(h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[11]=0,h[12]=0,h[13]=0,h[14]=0),h[0]=1,h[5]=1,h[10]=1,h[15]=1,h},x.create$2=dy,x.createExpression=lo,x.createFilter=Zl,x.createLayout=wn,x.createStyleLayer=function(h){return"custom"===h.type?new OC(h):new qy[h.type](h)},x.cross=function(h,a,p){var m=a[0],w=a[1],M=a[2],D=p[0],k=p[1],L=p[2];return h[0]=w*L-M*k,h[1]=M*D-m*L,h[2]=m*k-w*D,h},x.degToRad=an,x.div=function(h,a,p){return h[0]=a[0]/p[0],h[1]=a[1]/p[1],h[2]=a[2]/p[2],h},x.dot=function(h,a){return h[0]*a[0]+h[1]*a[1]+h[2]*a[2]},x.dot$1=function(h,a){return h[0]*a[0]+h[1]*a[1]+h[2]*a[2]+h[3]*a[3]},x.ease=pe,x.easeCubicInOut=Se,x.emitValidationErrors=Rs,x.endsWith=Lt,x.enforceCacheSizeLimit=function(h){fo(),fi&&fi.then(a=>{a.keys().then(p=>{for(let m=0;m<p.length-h;m++)a.delete(p[m])})})},x.evaluateSizeForFeature=vm,x.evaluateSizeForZoom=op,x.evaluateVariableOffset=z1,x.evented=q,x.exactEquals=function(h,a){return h[0]===a[0]&&h[1]===a[1]&&h[2]===a[2]&&h[3]===a[3]},x.exactEquals$1=function(h,a){return h[0]===a[0]&&h[1]===a[1]&&h[2]===a[2]},x.exported=rn,x.exported$1=ai,x.extend=be,x.filterObject=ht,x.fromMat4=function(h,a){return h[0]=a[0],h[1]=a[1],h[2]=a[2],h[3]=a[4],h[4]=a[5],h[5]=a[6],h[6]=a[8],h[7]=a[9],h[8]=a[10],h},x.fromQuat=function(h,a){var p=a[0],m=a[1],w=a[2],M=a[3],D=p+p,k=m+m,L=w+w,V=p*D,$=m*D,X=m*k,K=w*D,J=w*k,ge=w*L,Le=M*D,Ze=M*k,st=M*L;return h[0]=1-X-ge,h[1]=$+st,h[2]=K-Ze,h[3]=0,h[4]=$-st,h[5]=1-V-ge,h[6]=J+Le,h[7]=0,h[8]=K+Ze,h[9]=J-Le,h[10]=1-V-X,h[11]=0,h[12]=0,h[13]=0,h[14]=0,h[15]=1,h},x.fromRotation=function(h,a){var p=Math.sin(a),m=Math.cos(a);return h[0]=m,h[1]=p,h[2]=0,h[3]=-p,h[4]=m,h[5]=0,h[6]=0,h[7]=0,h[8]=1,h},x.fromScaling=function(h,a){return h[0]=a[0],h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[5]=a[1],h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[10]=a[2],h[11]=0,h[12]=0,h[13]=0,h[14]=0,h[15]=1,h},x.furthestTileCorner=function(h){const a=Math.round((h+45+360)%360/90)%4;return fe[a]},x.getAABBPointSquareDist=function(h,a,p){let m=0;for(let w=0;w<2;++w){const M=p?p[w]:0;h[w]>M&&(m+=(h[w]-M)*(h[w]-M)),a[w]<M&&(m+=(M-a[w])*(M-a[w]))}return m},x.getAnchorAlignment=Ly,x.getAnchorJustification=Mm,x.getBounds=function(h){let a=1/0,p=1/0,m=-1/0,w=-1/0;for(const M of h)a=Math.min(a,M.x),p=Math.min(p,M.y),m=Math.max(m,M.x),w=Math.max(w,M.y);return{min:new Ge(a,p),max:new Ge(m,w)}},x.getImage=ft,x.getJSON=function(h,a){return Re(be(h,{type:"json"}),a)},x.getMapSessionAPI=So,x.getPerformanceMeasurement=Qy,x.getRTLTextPluginStatus=Y,x.getReferrer=Bs,x.getVideo=function(h,a){const p=It.document.createElement("video");p.muted=!0,p.onloadstart=function(){a(null,p)};for(let m=0;m<h.length;m++){const w=It.document.createElement("source");je(h[m])||(p.crossOrigin="Anonymous"),w.src=h[m],p.appendChild(w)}return{cancel:()=>{}}},x.identity=fy,x.identity$1=om,x.invert=function(h,a){var p=a[0],m=a[1],w=a[2],M=a[3],D=a[4],k=a[5],L=a[6],V=a[7],$=a[8],X=a[9],K=a[10],J=a[11],ge=a[12],Le=a[13],Ze=a[14],st=a[15],xt=p*k-m*D,St=p*L-w*D,Dt=p*V-M*D,Rt=m*L-w*k,Pt=m*V-M*k,tn=w*V-M*L,dn=$*Le-X*ge,en=$*Ze-K*ge,Tn=$*st-J*ge,Xt=X*Ze-K*Le,nn=X*st-J*Le,Cn=K*st-J*Ze,Ht=xt*Cn-St*nn+Dt*Xt+Rt*Tn-Pt*en+tn*dn;return Ht?(h[0]=(k*Cn-L*nn+V*Xt)*(Ht=1/Ht),h[1]=(w*nn-m*Cn-M*Xt)*Ht,h[2]=(Le*tn-Ze*Pt+st*Rt)*Ht,h[3]=(K*Pt-X*tn-J*Rt)*Ht,h[4]=(L*Tn-D*Cn-V*en)*Ht,h[5]=(p*Cn-w*Tn+M*en)*Ht,h[6]=(Ze*Dt-ge*tn-st*St)*Ht,h[7]=($*tn-K*Dt+J*St)*Ht,h[8]=(D*nn-k*Tn+V*dn)*Ht,h[9]=(m*Tn-p*nn-M*dn)*Ht,h[10]=(ge*Pt-Le*Dt+st*xt)*Ht,h[11]=(X*Dt-$*Pt-J*xt)*Ht,h[12]=(k*en-D*Xt-L*dn)*Ht,h[13]=(p*Xt-m*en+w*dn)*Ht,h[14]=(Le*St-ge*Rt-Ze*xt)*Ht,h[15]=($*Rt-X*St+K*xt)*Ht,h):null},x.isMapAuthenticated=function(h){return Mo.has(h)},x.isMapboxURL=ct,x.latFromMercatorY=sg,x.len=HE,x.length=_1,x.length$1=function(h){return Math.hypot(h[0],h[1],h[2],h[3])},x.loadVectorTile=iv,x.makeRequest=Re,x.mercatorXfromLng=W1,x.mercatorYfromLat=X1,x.mercatorZfromAltitude=Zy,x.mul=function(h,a,p){return h[0]=a[0]*p[0],h[1]=a[1]*p[1],h[2]=a[2]*p[2],h[3]=a[3]*p[3],h},x.mul$1=UE,x.mul$2=$E,x.multiply=m1,x.multiply$1=Gp,x.nextPowerOfTwo=Oe,x.normalize=Xf,x.normalize$1=function(h,a){var p=a[0],m=a[1],w=a[2],M=a[3],D=p*p+m*m+w*w+M*M;return D>0&&(D=1/Math.sqrt(D)),h[0]=p*D,h[1]=m*D,h[2]=w*D,h[3]=M*D,h},x.number=xr,x.ortho=function(h,a,p,m,w,M,D){var k=1/(a-p),L=1/(m-w),V=1/(M-D);return h[0]=-2*k,h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[5]=-2*L,h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[10]=2*V,h[11]=0,h[12]=(a+p)*k,h[13]=(w+m)*L,h[14]=(D+M)*V,h[15]=1,h},x.pbf=Ha,x.perspective=function(h,a,p,m,w){var M,D=1/Math.tan(a/2);return h[0]=D/p,h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[5]=D,h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[11]=-1,h[12]=0,h[13]=0,h[15]=0,null!=w&&w!==1/0?(h[10]=(w+m)*(M=1/(m-w)),h[14]=2*w*m*M):(h[10]=-1,h[14]=-2*m),h},x.pick=function(h,a){const p={};for(let m=0;m<a.length;m++){const w=a[m];w in h&&(p[w]=h[w])}return p},x.plugin=ie,x.pointGeometry=Ge,x.polygonIntersectsBox=g1,x.polygonIntersectsPolygon=nf,x.polygonizeBounds=function(h,a,p=0,m=!0){const w=new Ge(p,p),M=h.sub(w),D=a.add(w),k=[M,new Ge(D.x,M.y),D,new Ge(M.x,D.y)];return m&&k.push(M),k},x.posAttributes=tv,x.postMapLoadEvent=Vr,x.postTurnstileEvent=jn,x.potpack=Ay,x.prevPowerOfTwo=function(h){return h<=1?1:Math.pow(2,Math.floor(Math.log(h)/Math.LN2))},x.radToDeg=function(h){return h*At},x.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],x.registerForPluginStateChange=function(h){return h({pluginStatus:P,pluginURL:O}),q.on("pluginStateChange",h),h},x.removeAuthState=function(h){Mo.delete(h)},x.renderColorRamp=xd,x.rotateX=function(h,a,p){var m=Math.sin(p),w=Math.cos(p),M=a[4],D=a[5],k=a[6],L=a[7],V=a[8],$=a[9],X=a[10],K=a[11];return a!==h&&(h[0]=a[0],h[1]=a[1],h[2]=a[2],h[3]=a[3],h[12]=a[12],h[13]=a[13],h[14]=a[14],h[15]=a[15]),h[4]=M*w+V*m,h[5]=D*w+$*m,h[6]=k*w+X*m,h[7]=L*w+K*m,h[8]=V*w-M*m,h[9]=$*w-D*m,h[10]=X*w-k*m,h[11]=K*w-L*m,h},x.rotateX$1=Yf,x.rotateY=function(h,a,p){var m=Math.sin(p),w=Math.cos(p),M=a[0],D=a[1],k=a[2],L=a[3],V=a[8],$=a[9],X=a[10],K=a[11];return a!==h&&(h[4]=a[4],h[5]=a[5],h[6]=a[6],h[7]=a[7],h[12]=a[12],h[13]=a[13],h[14]=a[14],h[15]=a[15]),h[0]=M*w-V*m,h[1]=D*w-$*m,h[2]=k*w-X*m,h[3]=L*w-K*m,h[8]=M*m+V*w,h[9]=D*m+$*w,h[10]=k*m+X*w,h[11]=L*m+K*w,h},x.rotateZ=function(h,a,p){var m=Math.sin(p),w=Math.cos(p),M=a[0],D=a[1],k=a[2],L=a[3],V=a[4],$=a[5],X=a[6],K=a[7];return a!==h&&(h[8]=a[8],h[9]=a[9],h[10]=a[10],h[11]=a[11],h[12]=a[12],h[13]=a[13],h[14]=a[14],h[15]=a[15]),h[0]=M*w+V*m,h[1]=D*w+$*m,h[2]=k*w+X*m,h[3]=L*w+K*m,h[4]=V*w-M*m,h[5]=$*w-D*m,h[6]=X*w-k*m,h[7]=K*w-L*m,h},x.rotateZ$1=function(h,a,p){p*=.5;var m=a[0],w=a[1],M=a[2],D=a[3],k=Math.sin(p),L=Math.cos(p);return h[0]=m*L+w*k,h[1]=w*L-m*k,h[2]=M*L+D*k,h[3]=D*L-M*k,h},x.scale=function(h,a,p){return h[0]=a[0]*p,h[1]=a[1]*p,h[2]=a[2]*p,h},x.scale$1=function(h,a,p){var m=p[0],w=p[1],M=p[2];return h[0]=a[0]*m,h[1]=a[1]*m,h[2]=a[2]*m,h[3]=a[3]*m,h[4]=a[4]*w,h[5]=a[5]*w,h[6]=a[6]*w,h[7]=a[7]*w,h[8]=a[8]*M,h[9]=a[9]*M,h[10]=a[10]*M,h[11]=a[11]*M,h[12]=a[12],h[13]=a[13],h[14]=a[14],h[15]=a[15],h},x.scale$2=function(h,a,p){return h[0]=a[0]*p,h[1]=a[1]*p,h[2]=a[2]*p,h[3]=a[3]*p,h},x.scaleAndAdd=jE,x.setCacheLimits=function(h,a){qi=h,fa=a},x.setRTLTextPlugin=function(h,a,p=!1){if(P===C||P===c||P===y)throw new Error("setRTLTextPlugin cannot be called multiple times.");O=rn.resolveURL(h),P=C,S=a,U(),p||te()},x.smoothstep=function(h,a,p){return(p=le((p-h)/(a-h),0,1))*p*(3-2*p)},x.spec=tt,x.storeAuthState=function(h,a){a?Mo.add(h):Mo.delete(h)},x.sub=GE,x.subtract=rm,x.symbolSize=eP,x.transformMat3=function(h,a,p){var m=a[0],w=a[1],M=a[2];return h[0]=m*p[0]+w*p[3]+M*p[6],h[1]=m*p[1]+w*p[4]+M*p[7],h[2]=m*p[2]+w*p[5]+M*p[8],h},x.transformMat4=of,x.transformMat4$1=function(h,a,p){var m=a[0],w=a[1],M=a[2],D=p[3]*m+p[7]*w+p[11]*M+p[15];return h[0]=(p[0]*m+p[4]*w+p[8]*M+p[12])/(D=D||1),h[1]=(p[1]*m+p[5]*w+p[9]*M+p[13])/D,h[2]=(p[2]*m+p[6]*w+p[10]*M+p[14])/D,h},x.transformQuat=im,x.translate=function(h,a,p){var m,w,M,D,k,L,V,$,X,K,J,ge,Le=p[0],Ze=p[1],st=p[2];return a===h?(h[12]=a[0]*Le+a[4]*Ze+a[8]*st+a[12],h[13]=a[1]*Le+a[5]*Ze+a[9]*st+a[13],h[14]=a[2]*Le+a[6]*Ze+a[10]*st+a[14],h[15]=a[3]*Le+a[7]*Ze+a[11]*st+a[15]):(w=a[1],M=a[2],D=a[3],k=a[4],L=a[5],V=a[6],$=a[7],X=a[8],K=a[9],J=a[10],ge=a[11],h[0]=m=a[0],h[1]=w,h[2]=M,h[3]=D,h[4]=k,h[5]=L,h[6]=V,h[7]=$,h[8]=X,h[9]=K,h[10]=J,h[11]=ge,h[12]=m*Le+k*Ze+X*st+a[12],h[13]=w*Le+L*Ze+K*st+a[13],h[14]=M*Le+V*Ze+J*st+a[14],h[15]=D*Le+$*Ze+ge*st+a[15]),h},x.triggerPluginCompletionEvent=F,x.uniqueId=mt,x.validateCustomStyleLayer=function(h){const a=[],p=h.id;return void 0===p&&a.push({message:`layers.${p}: missing required property "id"`}),void 0===h.render&&a.push({message:`layers.${p}: missing required method "render"`}),h.renderingMode&&"2d"!==h.renderingMode&&"3d"!==h.renderingMode&&a.push({message:`layers.${p}: property "renderingMode" must be either "2d" or "3d"`}),a},x.validateFog=sa,x.validateLight=th,x.validateStyle=ya,x.values=me,x.vectorTile=wd,x.version="2.4.1",x.warnOnce=Ke,x.window=It,x.wrap=Ne}),Be(0,function(x){function ut(Re){const Q=typeof Re;if("number"===Q||"boolean"===Q||"string"===Q||null==Re)return JSON.stringify(Re);if(Array.isArray(Re)){let je="[";for(const at of Re)je+=`${ut(at)},`;return`${je}]`}const oe=Object.keys(Re).sort();let Ae="{";for(let je=0;je<oe.length;je++)Ae+=`${JSON.stringify(oe[je])}:${ut(Re[oe[je]])},`;return`${Ae}}`}function qe(Re){let Q="";for(const oe of x.refProperties)Q+=`/${ut(Re[oe])}`;return Q}class dt{constructor(Q){this.keyCache={},Q&&this.replace(Q)}replace(Q){this._layerConfigs={},this._layers={},this.update(Q,[])}update(Q,oe){for(const je of Q){this._layerConfigs[je.id]=je;const at=this._layers[je.id]=x.createStyleLayer(je);at._featureFilter=x.createFilter(at.filter),this.keyCache[je.id]&&delete this.keyCache[je.id]}for(const je of oe)delete this.keyCache[je],delete this._layerConfigs[je],delete this._layers[je];this.familiesBySource={};const Ae=function(je,at){const bt={};for(let ft=0;ft<je.length;ft++){const Et=at&&at[je[ft].id]||qe(je[ft]);at&&(at[je[ft].id]=Et);let Nt=bt[Et];Nt||(Nt=bt[Et]=[]),Nt.push(je[ft])}const Ct=[];for(const ft in bt)Ct.push(bt[ft]);return Ct}(x.values(this._layerConfigs),this.keyCache);for(const je of Ae){const at=je.map(fn=>this._layers[fn.id]),bt=at[0];if("none"===bt.visibility)continue;const Ct=bt.source||"";let ft=this.familiesBySource[Ct];ft||(ft=this.familiesBySource[Ct]={});const Et=bt.sourceLayer||"_geojsonTileLayer";let Nt=ft[Et];Nt||(Nt=ft[Et]=[]),Nt.push(at)}}}const{ImageBitmap:Ge}=x.window;class Qe{loadTile(Q,oe){const{uid:Ae,encoding:je,rawImageData:at,padding:bt,buildQuadTree:Ct}=Q,ft=Ge&&at instanceof Ge?this.getImageData(at,bt):at;oe(null,new x.DEMData(Ae,ft,je,bt<1,Ct))}getImageData(Q,oe){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(Q.width,Q.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=Q.width,this.offscreenCanvas.height=Q.height,this.offscreenCanvasContext.drawImage(Q,0,0,Q.width,Q.height);const Ae=this.offscreenCanvasContext.getImageData(-oe,-oe,Q.width+2*oe,Q.height+2*oe);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new x.RGBAImage({width:Ae.width,height:Ae.height},Ae.data)}}var It=function Re(Q,oe){var Ae,je=Q&&Q.type;if("FeatureCollection"===je)for(Ae=0;Ae<Q.features.length;Ae++)Re(Q.features[Ae],oe);else if("GeometryCollection"===je)for(Ae=0;Ae<Q.geometries.length;Ae++)Re(Q.geometries[Ae],oe);else if("Feature"===je)Re(Q.geometry,oe);else if("Polygon"===je)kt(Q.coordinates,oe);else if("MultiPolygon"===je)for(Ae=0;Ae<Q.coordinates.length;Ae++)kt(Q.coordinates[Ae],oe);return Q};function kt(Re,Q){if(0!==Re.length){vt(Re[0],Q);for(var oe=1;oe<Re.length;oe++)vt(Re[oe],!Q)}}function vt(Re,Q){for(var oe=0,Ae=0,je=Re.length,at=je-1;Ae<je;at=Ae++)oe+=(Re[Ae][0]-Re[at][0])*(Re[at][1]+Re[Ae][1]);oe>=0!=!!Q&&Re.reverse()}const At=x.vectorTile.VectorTileFeature.prototype.toGeoJSON;class an{constructor(Q){this._feature=Q,this.extent=x.EXTENT,this.type=Q.type,this.properties=Q.tags,"id"in Q&&!isNaN(Q.id)&&(this.id=parseInt(Q.id,10))}loadGeometry(){if(1===this._feature.type){const Q=[];for(const oe of this._feature.geometry)Q.push([new x.pointGeometry(oe[0],oe[1])]);return Q}{const Q=[];for(const oe of this._feature.geometry){const Ae=[];for(const je of oe)Ae.push(new x.pointGeometry(je[0],je[1]));Q.push(Ae)}return Q}}toGeoJSON(Q,oe,Ae){return At.call(this,Q,oe,Ae)}}class fe{constructor(Q){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=x.EXTENT,this.length=Q.length,this._features=Q}feature(Q){return new an(this._features[Q])}}var Se=x.vectorTile.VectorTileFeature,ue=pe;function pe(Re,Q){this.options=Q||{},this.features=Re,this.length=Re.length}function le(Re,Q){this.id="number"==typeof Re.id?Re.id:void 0,this.type=Re.type,this.rawGeometry=1===Re.type?[Re.geometry]:Re.geometry,this.properties=Re.tags,this.extent=Q||4096}pe.prototype.feature=function(Re){return new le(this.features[Re],this.options.extent)},le.prototype.loadGeometry=function(){var Re=this.rawGeometry;this.geometry=[];for(var Q=0;Q<Re.length;Q++){for(var oe=Re[Q],Ae=[],je=0;je<oe.length;je++)Ae.push(new x.pointGeometry(oe[je][0],oe[je][1]));this.geometry.push(Ae)}return this.geometry},le.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Re=this.geometry,Q=1/0,oe=-1/0,Ae=1/0,je=-1/0,at=0;at<Re.length;at++)for(var bt=Re[at],Ct=0;Ct<bt.length;Ct++){var ft=bt[Ct];Q=Math.min(Q,ft.x),oe=Math.max(oe,ft.x),Ae=Math.min(Ae,ft.y),je=Math.max(je,ft.y)}return[Q,Ae,oe,je]},le.prototype.toGeoJSON=Se.prototype.toGeoJSON;var Ne=me,he=ue;function me(Re){var Q=new x.pbf;return function(oe,Ae){for(var je in oe.layers)Ae.writeMessage(3,be,oe.layers[je])}(Re,Q),Q.finish()}function be(Re,Q){var oe;Q.writeVarintField(15,Re.version||1),Q.writeStringField(1,Re.name||""),Q.writeVarintField(5,Re.extent||4096);var Ae={keys:[],values:[],keycache:{},valuecache:{}};for(oe=0;oe<Re.length;oe++)Ae.feature=Re.feature(oe),Q.writeMessage(2,re,Ae);var je=Ae.keys;for(oe=0;oe<je.length;oe++)Q.writeStringField(3,je[oe]);var at=Ae.values;for(oe=0;oe<at.length;oe++)Q.writeMessage(4,jt,at[oe])}function re(Re,Q){var oe=Re.feature;void 0!==oe.id&&Q.writeVarintField(1,oe.id),Q.writeMessage(2,mt,Re),Q.writeVarintField(3,oe.type),Q.writeMessage(4,xe,oe)}function mt(Re,Q){var oe=Re.feature,Ae=Re.keys,je=Re.values,at=Re.keycache,bt=Re.valuecache;for(var Ct in oe.properties){var ft=at[Ct];void 0===ft&&(Ae.push(Ct),at[Ct]=ft=Ae.length-1),Q.writeVarint(ft);var Et=oe.properties[Ct],Nt=typeof Et;"string"!==Nt&&"boolean"!==Nt&&"number"!==Nt&&(Et=JSON.stringify(Et));var fn=Nt+":"+Et,Wt=bt[fn];void 0===Wt&&(je.push(Et),bt[fn]=Wt=je.length-1),Q.writeVarint(Wt)}}function ze(Re,Q){return(Q<<3)+(7&Re)}function Oe(Re){return Re<<1^Re>>31}function xe(Re,Q){for(var oe=Re.loadGeometry(),Ae=Re.type,je=0,at=0,bt=oe.length,Ct=0;Ct<bt;Ct++){var ft=oe[Ct],Et=1;1===Ae&&(Et=ft.length),Q.writeVarint(ze(1,Et));for(var Nt=3===Ae?ft.length-1:ft.length,fn=0;fn<Nt;fn++){1===fn&&1!==Ae&&Q.writeVarint(ze(2,Nt-1));var Wt=ft[fn].x-je,bn=ft[fn].y-at;Q.writeVarint(Oe(Wt)),Q.writeVarint(Oe(bn)),je+=Wt,at+=bn}3===Ae&&Q.writeVarint(ze(7,1))}}function jt(Re,Q){var oe=typeof Re;"string"===oe?Q.writeStringField(1,Re):"boolean"===oe?Q.writeBooleanField(7,Re):"number"===oe&&(Re%1!=0?Q.writeDoubleField(3,Re):Re<0?Q.writeSVarintField(6,Re):Q.writeVarintField(5,Re))}function Lt(Re,Q,oe,Ae,je,at){if(je-Ae<=oe)return;const bt=Ae+je>>1;Ce(Re,Q,bt,Ae,je,at%2),Lt(Re,Q,oe,Ae,bt-1,at+1),Lt(Re,Q,oe,bt+1,je,at+1)}function Ce(Re,Q,oe,Ae,je,at){for(;je>Ae;){if(je-Ae>600){const Et=je-Ae+1,Nt=oe-Ae+1,fn=Math.log(Et),Wt=.5*Math.exp(2*fn/3),bn=.5*Math.sqrt(fn*Wt*(Et-Wt)/Et)*(Nt-Et/2<0?-1:1);Ce(Re,Q,oe,Math.max(Ae,Math.floor(oe-Nt*Wt/Et+bn)),Math.min(je,Math.floor(oe+(Et-Nt)*Wt/Et+bn)),at)}const bt=Q[2*oe+at];let Ct=Ae,ft=je;for(ht(Re,Q,Ae,oe),Q[2*je+at]>bt&&ht(Re,Q,Ae,je);Ct<ft;){for(ht(Re,Q,Ct,ft),Ct++,ft--;Q[2*Ct+at]<bt;)Ct++;for(;Q[2*ft+at]>bt;)ft--}Q[2*Ae+at]===bt?ht(Re,Q,Ae,ft):(ft++,ht(Re,Q,ft,je)),ft<=oe&&(Ae=ft+1),oe<=ft&&(je=ft-1)}}function ht(Re,Q,oe,Ae){Pe(Re,oe,Ae),Pe(Q,2*oe,2*Ae),Pe(Q,2*oe+1,2*Ae+1)}function Pe(Re,Q,oe){const Ae=Re[Q];Re[Q]=Re[oe],Re[oe]=Ae}function lt(Re,Q,oe,Ae){const je=Re-oe,at=Q-Ae;return je*je+at*at}Ne.fromVectorTileJs=me,Ne.fromGeojsonVt=function(Re,Q){Q=Q||{};var oe={};for(var Ae in Re)oe[Ae]=new ue(Re[Ae].features,Q),oe[Ae].name=Ae,oe[Ae].version=Q.version,oe[Ae].extent=Q.extent;return me({layers:oe})},Ne.GeoJSONWrapper=he;const Ke=Re=>Re[0],Me=Re=>Re[1];class Ft{constructor(Q,oe=Ke,Ae=Me,je=64,at=Float64Array){this.nodeSize=je,this.points=Q;const bt=Q.length<65536?Uint16Array:Uint32Array,Ct=this.ids=new bt(Q.length),ft=this.coords=new at(2*Q.length);for(let Et=0;Et<Q.length;Et++)Ct[Et]=Et,ft[2*Et]=oe(Q[Et]),ft[2*Et+1]=Ae(Q[Et]);Lt(Ct,ft,je,0,Ct.length-1,0)}range(Q,oe,Ae,je){return function(at,bt,Ct,ft,Et,Nt,fn){const Wt=[0,at.length-1,0],bn=[];let tt,Vt;for(;Wt.length;){const Wn=Wt.pop(),zr=Wt.pop(),lr=Wt.pop();if(zr-lr<=fn){for(let vr=lr;vr<=zr;vr++)tt=bt[2*vr],Vt=bt[2*vr+1],tt>=Ct&&tt<=Et&&Vt>=ft&&Vt<=Nt&&bn.push(at[vr]);continue}const oi=Math.floor((lr+zr)/2);tt=bt[2*oi],Vt=bt[2*oi+1],tt>=Ct&&tt<=Et&&Vt>=ft&&Vt<=Nt&&bn.push(at[oi]);const ir=(Wn+1)%2;(0===Wn?Ct<=tt:ft<=Vt)&&(Wt.push(lr),Wt.push(oi-1),Wt.push(ir)),(0===Wn?Et>=tt:Nt>=Vt)&&(Wt.push(oi+1),Wt.push(zr),Wt.push(ir))}return bn}(this.ids,this.coords,Q,oe,Ae,je,this.nodeSize)}within(Q,oe,Ae){return function(je,at,bt,Ct,ft,Et){const Nt=[0,je.length-1,0],fn=[],Wt=ft*ft;for(;Nt.length;){const bn=Nt.pop(),tt=Nt.pop(),Vt=Nt.pop();if(tt-Vt<=Et){for(let ir=Vt;ir<=tt;ir++)lt(at[2*ir],at[2*ir+1],bt,Ct)<=Wt&&fn.push(je[ir]);continue}const Wn=Math.floor((Vt+tt)/2),zr=at[2*Wn],lr=at[2*Wn+1];lt(zr,lr,bt,Ct)<=Wt&&fn.push(je[Wn]);const oi=(bn+1)%2;(0===bn?bt-ft<=zr:Ct-ft<=lr)&&(Nt.push(Vt),Nt.push(Wn-1),Nt.push(oi)),(0===bn?bt+ft>=zr:Ct+ft>=lr)&&(Nt.push(Wn+1),Nt.push(tt),Nt.push(oi))}return fn}(this.ids,this.coords,Q,oe,Ae,this.nodeSize)}}const Ut={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Re=>Re},Sn=Math.fround||(Gt=new Float32Array(1),Re=>(Gt[0]=+Re,Gt[0]));var Gt;class Mn{constructor(Q){this.options=ai(Object.create(Ut),Q),this.trees=new Array(this.options.maxZoom+1)}load(Q){const{log:oe,minZoom:Ae,maxZoom:je,nodeSize:at}=this.options;oe&&console.time("total time");const bt=`prepare ${Q.length} points`;oe&&console.time(bt),this.points=Q;let Ct=[];for(let ft=0;ft<Q.length;ft++)Q[ft].geometry&&Ct.push(sr(Q[ft],ft));this.trees[je+1]=new Ft(Ct,Qr,eo,at,Float32Array),oe&&console.timeEnd(bt);for(let ft=je;ft>=Ae;ft--){const Et=+Date.now();Ct=this._cluster(Ct,ft),this.trees[ft]=new Ft(Ct,Qr,eo,at,Float32Array),oe&&console.log("z%d: %d clusters in %dms",ft,Ct.length,+Date.now()-Et)}return oe&&console.timeEnd("total time"),this}getClusters(Q,oe){let Ae=((Q[0]+180)%360+360)%360-180;const je=Math.max(-90,Math.min(90,Q[1]));let at=180===Q[2]?180:((Q[2]+180)%360+360)%360-180;const bt=Math.max(-90,Math.min(90,Q[3]));if(Q[2]-Q[0]>=360)Ae=-180,at=180;else if(Ae>at){const Nt=this.getClusters([Ae,je,180,bt],oe),fn=this.getClusters([-180,je,at,bt],oe);return Nt.concat(fn)}const Ct=this.trees[this._limitZoom(oe)],ft=Ct.range(rn(Ae),hi(bt),rn(at),hi(je)),Et=[];for(const Nt of ft){const fn=Ct.points[Nt];Et.push(fn.numPoints?In(fn):this.points[fn.index])}return Et}getChildren(Q){const oe=this._getOriginId(Q),Ae=this._getOriginZoom(Q),je="No cluster with the specified id.",at=this.trees[Ae];if(!at)throw new Error(je);const bt=at.points[oe];if(!bt)throw new Error(je);const Ct=this.options.radius/(this.options.extent*Math.pow(2,Ae-1)),ft=at.within(bt.x,bt.y,Ct),Et=[];for(const Nt of ft){const fn=at.points[Nt];fn.parentId===Q&&Et.push(fn.numPoints?In(fn):this.points[fn.index])}if(0===Et.length)throw new Error(je);return Et}getLeaves(Q,oe,Ae){const je=[];return this._appendLeaves(je,Q,oe=oe||10,Ae=Ae||0,0),je}getTile(Q,oe,Ae){const je=this.trees[this._limitZoom(Q)],at=Math.pow(2,Q),{extent:bt,radius:Ct}=this.options,ft=Ct/bt,Et=(Ae-ft)/at,Nt=(Ae+1+ft)/at,fn={features:[]};return this._addTileFeatures(je.range((oe-ft)/at,Et,(oe+1+ft)/at,Nt),je.points,oe,Ae,at,fn),0===oe&&this._addTileFeatures(je.range(1-ft/at,Et,1,Nt),je.points,at,Ae,at,fn),oe===at-1&&this._addTileFeatures(je.range(0,Et,ft/at,Nt),je.points,-1,Ae,at,fn),fn.features.length?fn:null}getClusterExpansionZoom(Q){let oe=this._getOriginZoom(Q)-1;for(;oe<=this.options.maxZoom;){const Ae=this.getChildren(Q);if(oe++,1!==Ae.length)break;Q=Ae[0].properties.cluster_id}return oe}_appendLeaves(Q,oe,Ae,je,at){const bt=this.getChildren(oe);for(const Ct of bt){const ft=Ct.properties;if(ft&&ft.cluster?at+ft.point_count<=je?at+=ft.point_count:at=this._appendLeaves(Q,ft.cluster_id,Ae,je,at):at<je?at++:Q.push(Ct),Q.length===Ae)break}return at}_addTileFeatures(Q,oe,Ae,je,at,bt){for(const Ct of Q){const ft=oe[Ct],Et=ft.numPoints;let Nt,fn,Wt;if(Et)Nt=Vn(ft),fn=ft.x,Wt=ft.y;else{const Vt=this.points[ft.index];Nt=Vt.properties,fn=rn(Vt.geometry.coordinates[0]),Wt=hi(Vt.geometry.coordinates[1])}const bn={type:1,geometry:[[Math.round(this.options.extent*(fn*at-Ae)),Math.round(this.options.extent*(Wt*at-je))]],tags:Nt};let tt;Et?tt=ft.id:this.options.generateId?tt=ft.index:this.points[ft.index].id&&(tt=this.points[ft.index].id),void 0!==tt&&(bn.id=tt),bt.features.push(bn)}}_limitZoom(Q){return Math.max(this.options.minZoom,Math.min(+Q,this.options.maxZoom+1))}_cluster(Q,oe){const Ae=[],{radius:je,extent:at,reduce:bt,minPoints:Ct}=this.options,ft=je/(at*Math.pow(2,oe));for(let Et=0;Et<Q.length;Et++){const Nt=Q[Et];if(Nt.zoom<=oe)continue;Nt.zoom=oe;const fn=this.trees[oe+1],Wt=fn.within(Nt.x,Nt.y,ft),bn=Nt.numPoints||1;let tt=bn;for(const Vt of Wt){const Wn=fn.points[Vt];Wn.zoom>oe&&(tt+=Wn.numPoints||1)}if(tt>=Ct){let Vt=Nt.x*bn,Wn=Nt.y*bn,zr=bt&&bn>1?this._map(Nt,!0):null;const lr=(Et<<5)+(oe+1)+this.points.length;for(const oi of Wt){const ir=fn.points[oi];if(ir.zoom<=oe)continue;ir.zoom=oe;const vr=ir.numPoints||1;Vt+=ir.x*vr,Wn+=ir.y*vr,ir.parentId=lr,bt&&(zr||(zr=this._map(Nt,!0)),bt(zr,this._map(ir)))}Nt.parentId=lr,Ae.push(hr(Vt/tt,Wn/tt,lr,tt,zr))}else if(Ae.push(Nt),tt>1)for(const Vt of Wt){const Wn=fn.points[Vt];Wn.zoom<=oe||(Wn.zoom=oe,Ae.push(Wn))}}return Ae}_getOriginId(Q){return Q-this.points.length>>5}_getOriginZoom(Q){return(Q-this.points.length)%32}_map(Q,oe){if(Q.numPoints)return oe?ai({},Q.properties):Q.properties;const Ae=this.points[Q.index].properties,je=this.options.map(Ae);return oe&&je===Ae?ai({},je):je}}function hr(Re,Q,oe,Ae,je){return{x:Sn(Re),y:Sn(Q),zoom:1/0,id:oe,parentId:-1,numPoints:Ae,properties:je}}function sr(Re,Q){const[oe,Ae]=Re.geometry.coordinates;return{x:Sn(rn(oe)),y:Sn(hi(Ae)),zoom:1/0,index:Q,parentId:-1}}function In(Re){return{type:"Feature",id:Re.id,properties:Vn(Re),geometry:{type:"Point",coordinates:[(Q=Re.x,360*(Q-.5)),nr(Re.y)]}};var Q}function Vn(Re){const Q=Re.numPoints,oe=Q>=1e4?`${Math.round(Q/1e3)}k`:Q>=1e3?Math.round(Q/100)/10+"k":Q;return ai(ai({},Re.properties),{cluster:!0,cluster_id:Re.id,point_count:Q,point_count_abbreviated:oe})}function rn(Re){return Re/360+.5}function hi(Re){const Q=Math.sin(Re*Math.PI/180),oe=.5-.25*Math.log((1+Q)/(1-Q))/Math.PI;return oe<0?0:oe>1?1:oe}function nr(Re){const Q=(180-360*Re)*Math.PI/180;return 360*Math.atan(Math.exp(Q))/Math.PI-90}function ai(Re,Q){for(const oe in Q)Re[oe]=Q[oe];return Re}function Qr(Re){return Re.x}function eo(Re){return Re.y}function _t(Re,Q,oe,Ae){for(var je,at=Ae,bt=oe-Q>>1,Ct=oe-Q,ft=Re[Q],Et=Re[Q+1],Nt=Re[oe],fn=Re[oe+1],Wt=Q+3;Wt<oe;Wt+=3){var bn=ve(Re[Wt],Re[Wt+1],ft,Et,Nt,fn);if(bn>at)je=Wt,at=bn;else if(bn===at){var tt=Math.abs(Wt-bt);tt<Ct&&(je=Wt,Ct=tt)}}at>Ae&&(je-Q>3&&_t(Re,Q,je,Ae),Re[je+2]=at,oe-je>3&&_t(Re,je,oe,Ae))}function ve(Re,Q,oe,Ae,je,at){var bt=je-oe,Ct=at-Ae;if(0!==bt||0!==Ct){var ft=((Re-oe)*bt+(Q-Ae)*Ct)/(bt*bt+Ct*Ct);ft>1?(oe=je,Ae=at):ft>0&&(oe+=bt*ft,Ae+=Ct*ft)}return(bt=Re-oe)*bt+(Ct=Q-Ae)*Ct}function ce(Re,Q,oe,Ae){var je={id:void 0===Re?null:Re,type:Q,geometry:oe,tags:Ae,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(at){var bt=at.geometry,Ct=at.type;if("Point"===Ct||"MultiPoint"===Ct||"LineString"===Ct)ae(at,bt);else if("Polygon"===Ct||"MultiLineString"===Ct)for(var ft=0;ft<bt.length;ft++)ae(at,bt[ft]);else if("MultiPolygon"===Ct)for(ft=0;ft<bt.length;ft++)for(var Et=0;Et<bt[ft].length;Et++)ae(at,bt[ft][Et])}(je),je}function ae(Re,Q){for(var oe=0;oe<Q.length;oe+=3)Re.minX=Math.min(Re.minX,Q[oe]),Re.minY=Math.min(Re.minY,Q[oe+1]),Re.maxX=Math.max(Re.maxX,Q[oe]),Re.maxY=Math.max(Re.maxY,Q[oe+1])}function Ie(Re,Q,oe,Ae){if(Q.geometry){var je=Q.geometry.coordinates,at=Q.geometry.type,bt=Math.pow(oe.tolerance/((1<<oe.maxZoom)*oe.extent),2),Ct=[],ft=Q.id;if(oe.promoteId?ft=Q.properties[oe.promoteId]:oe.generateId&&(ft=Ae||0),"Point"===at)ct(je,Ct);else if("MultiPoint"===at)for(var Et=0;Et<je.length;Et++)ct(je[Et],Ct);else if("LineString"===at)Ot(je,Ct,bt,!1);else if("MultiLineString"===at){if(oe.lineMetrics){for(Et=0;Et<je.length;Et++)Ot(je[Et],Ct=[],bt,!1),Re.push(ce(ft,"LineString",Ct,Q.properties));return}Kt(je,Ct,bt,!1)}else if("Polygon"===at)Kt(je,Ct,bt,!0);else{if("MultiPolygon"!==at){if("GeometryCollection"===at){for(Et=0;Et<Q.geometry.geometries.length;Et++)Ie(Re,{id:ft,geometry:Q.geometry.geometries[Et],properties:Q.properties},oe,Ae);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Et=0;Et<je.length;Et++){var Nt=[];Kt(je[Et],Nt,bt,!0),Ct.push(Nt)}}Re.push(ce(ft,at,Ct,Q.properties))}}function ct(Re,Q){Q.push(Yt(Re[0])),Q.push(wt(Re[1])),Q.push(0)}function Ot(Re,Q,oe,Ae){for(var je,at,bt=0,Ct=0;Ct<Re.length;Ct++){var ft=Yt(Re[Ct][0]),Et=wt(Re[Ct][1]);Q.push(ft),Q.push(Et),Q.push(0),Ct>0&&(bt+=Ae?(je*Et-ft*at)/2:Math.sqrt(Math.pow(ft-je,2)+Math.pow(Et-at,2))),je=ft,at=Et}var Nt=Q.length-3;Q[2]=1,_t(Q,0,Nt,oe),Q[Nt+2]=1,Q.size=Math.abs(bt),Q.start=0,Q.end=Q.size}function Kt(Re,Q,oe,Ae){for(var je=0;je<Re.length;je++){var at=[];Ot(Re[je],at,oe,Ae),Q.push(at)}}function Yt(Re){return Re/360+.5}function wt(Re){var Q=Math.sin(Re*Math.PI/180),oe=.5-.25*Math.log((1+Q)/(1-Q))/Math.PI;return oe<0?0:oe>1?1:oe}function Qn(Re,Q,oe,Ae,je,at,bt,Ct){if(Ae/=Q,at>=(oe/=Q)&&bt<Ae)return Re;if(bt<oe||at>=Ae)return null;for(var ft=[],Et=0;Et<Re.length;Et++){var Nt=Re[Et],fn=Nt.geometry,Wt=Nt.type,bn=0===je?Nt.minX:Nt.minY,tt=0===je?Nt.maxX:Nt.maxY;if(bn>=oe&&tt<Ae)ft.push(Nt);else if(!(tt<oe||bn>=Ae)){var Vt=[];if("Point"===Wt||"MultiPoint"===Wt)Er(fn,Vt,oe,Ae,je);else if("LineString"===Wt)Qt(fn,Vt,oe,Ae,je,!1,Ct.lineMetrics);else if("MultiLineString"===Wt)ar(fn,Vt,oe,Ae,je,!1);else if("Polygon"===Wt)ar(fn,Vt,oe,Ae,je,!0);else if("MultiPolygon"===Wt)for(var Wn=0;Wn<fn.length;Wn++){var zr=[];ar(fn[Wn],zr,oe,Ae,je,!0),zr.length&&Vt.push(zr)}if(Vt.length){if(Ct.lineMetrics&&"LineString"===Wt){for(Wn=0;Wn<Vt.length;Wn++)ft.push(ce(Nt.id,Wt,Vt[Wn],Nt.tags));continue}"LineString"!==Wt&&"MultiLineString"!==Wt||(1===Vt.length?(Wt="LineString",Vt=Vt[0]):Wt="MultiLineString"),"Point"!==Wt&&"MultiPoint"!==Wt||(Wt=3===Vt.length?"Point":"MultiPoint"),ft.push(ce(Nt.id,Wt,Vt,Nt.tags))}}}return ft.length?ft:null}function Er(Re,Q,oe,Ae,je){for(var at=0;at<Re.length;at+=3){var bt=Re[at+je];bt>=oe&&bt<=Ae&&(Q.push(Re[at]),Q.push(Re[at+1]),Q.push(Re[at+2]))}}function Qt(Re,Q,oe,Ae,je,at,bt){for(var Ct,ft,Et=jn(Re),Nt=0===je?ei:So,fn=Re.start,Wt=0;Wt<Re.length-3;Wt+=3){var bn=Re[Wt],tt=Re[Wt+1],Vt=Re[Wt+2],Wn=Re[Wt+3],zr=Re[Wt+4],lr=0===je?bn:tt,oi=0===je?Wn:zr,ir=!1;bt&&(Ct=Math.sqrt(Math.pow(bn-Wn,2)+Math.pow(tt-zr,2))),lr<oe?oi>oe&&(ft=Nt(Et,bn,tt,Wn,zr,oe),bt&&(Et.start=fn+Ct*ft)):lr>Ae?oi<Ae&&(ft=Nt(Et,bn,tt,Wn,zr,Ae),bt&&(Et.start=fn+Ct*ft)):Vr(Et,bn,tt,Vt),oi<oe&&lr>=oe&&(ft=Nt(Et,bn,tt,Wn,zr,oe),ir=!0),oi>Ae&&lr<=Ae&&(ft=Nt(Et,bn,tt,Wn,zr,Ae),ir=!0),!at&&ir&&(bt&&(Et.end=fn+Ct*ft),Q.push(Et),Et=jn(Re)),bt&&(fn+=Ct)}var vr=Re.length-3;bn=Re[vr],tt=Re[vr+1],Vt=Re[vr+2],(lr=0===je?bn:tt)>=oe&&lr<=Ae&&Vr(Et,bn,tt,Vt),vr=Et.length-3,at&&vr>=3&&(Et[vr]!==Et[0]||Et[vr+1]!==Et[1])&&Vr(Et,Et[0],Et[1],Et[2]),Et.length&&Q.push(Et)}function jn(Re){var Q=[];return Q.size=Re.size,Q.start=Re.start,Q.end=Re.end,Q}function ar(Re,Q,oe,Ae,je,at){for(var bt=0;bt<Re.length;bt++)Qt(Re[bt],Q,oe,Ae,je,at,!1)}function Vr(Re,Q,oe,Ae){Re.push(Q),Re.push(oe),Re.push(Ae)}function ei(Re,Q,oe,Ae,je,at){var bt=(at-Q)/(Ae-Q);return Re.push(at),Re.push(oe+(je-oe)*bt),Re.push(1),bt}function So(Re,Q,oe,Ae,je,at){var bt=(at-oe)/(je-oe);return Re.push(Q+(Ae-Q)*bt),Re.push(at),Re.push(1),bt}function Mo(Re,Q){for(var oe=[],Ae=0;Ae<Re.length;Ae++){var je,at=Re[Ae],bt=at.type;if("Point"===bt||"MultiPoint"===bt||"LineString"===bt)je=jo(at.geometry,Q);else if("MultiLineString"===bt||"Polygon"===bt){je=[];for(var Ct=0;Ct<at.geometry.length;Ct++)je.push(jo(at.geometry[Ct],Q))}else if("MultiPolygon"===bt)for(je=[],Ct=0;Ct<at.geometry.length;Ct++){for(var ft=[],Et=0;Et<at.geometry[Ct].length;Et++)ft.push(jo(at.geometry[Ct][Et],Q));je.push(ft)}oe.push(ce(at.id,bt,je,at.tags))}return oe}function jo(Re,Q){var oe=[];oe.size=Re.size,void 0!==Re.start&&(oe.start=Re.start,oe.end=Re.end);for(var Ae=0;Ae<Re.length;Ae+=3)oe.push(Re[Ae]+Q,Re[Ae+1],Re[Ae+2]);return oe}function fi(Re,Q){if(Re.transformed)return Re;var oe,Ae,je,at=1<<Re.z,bt=Re.x,Ct=Re.y;for(oe=0;oe<Re.features.length;oe++){var ft=Re.features[oe],Et=ft.geometry,Nt=ft.type;if(ft.geometry=[],1===Nt)for(Ae=0;Ae<Et.length;Ae+=2)ft.geometry.push(Xo(Et[Ae],Et[Ae+1],Q,at,bt,Ct));else for(Ae=0;Ae<Et.length;Ae++){var fn=[];for(je=0;je<Et[Ae].length;je+=2)fn.push(Xo(Et[Ae][je],Et[Ae][je+1],Q,at,bt,Ct));ft.geometry.push(fn)}}return Re.transformed=!0,Re}function Xo(Re,Q,oe,Ae,je,at){return[Math.round(oe*(Re*Ae-je)),Math.round(oe*(Q*Ae-at))]}function qi(Re,Q,oe,Ae,je){for(var at=Q===je.maxZoom?0:je.tolerance/((1<<Q)*je.extent),bt={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:oe,y:Ae,z:Q,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Ct=0;Ct<Re.length;Ct++){bt.numFeatures++,fa(bt,Re[Ct],at,je);var ft=Re[Ct].minX,Et=Re[Ct].minY,Nt=Re[Ct].maxX,fn=Re[Ct].maxY;ft<bt.minX&&(bt.minX=ft),Et<bt.minY&&(bt.minY=Et),Nt>bt.maxX&&(bt.maxX=Nt),fn>bt.maxY&&(bt.maxY=fn)}return bt}function fa(Re,Q,oe,Ae){var je=Q.geometry,at=Q.type,bt=[];if("Point"===at||"MultiPoint"===at)for(var Ct=0;Ct<je.length;Ct+=3)bt.push(je[Ct]),bt.push(je[Ct+1]),Re.numPoints++,Re.numSimplified++;else if("LineString"===at)fo(bt,je,Re,oe,!1,!1);else if("MultiLineString"===at||"Polygon"===at)for(Ct=0;Ct<je.length;Ct++)fo(bt,je[Ct],Re,oe,"Polygon"===at,0===Ct);else if("MultiPolygon"===at)for(var ft=0;ft<je.length;ft++){var Et=je[ft];for(Ct=0;Ct<Et.length;Ct++)fo(bt,Et[Ct],Re,oe,!0,0===Ct)}if(bt.length){var Nt=Q.tags||null;if("LineString"===at&&Ae.lineMetrics){for(var fn in Nt={},Q.tags)Nt[fn]=Q.tags[fn];Nt.mapbox_clip_start=je.start/je.size,Nt.mapbox_clip_end=je.end/je.size}var Wt={geometry:bt,type:"Polygon"===at||"MultiPolygon"===at?3:"LineString"===at||"MultiLineString"===at?2:1,tags:Nt};null!==Q.id&&(Wt.id=Q.id),Re.features.push(Wt)}}function fo(Re,Q,oe,Ae,je,at){var bt=Ae*Ae;if(Ae>0&&Q.size<(je?bt:Ae))oe.numPoints+=Q.length/3;else{for(var Ct=[],ft=0;ft<Q.length;ft+=3)(0===Ae||Q[ft+2]>bt)&&(oe.numSimplified++,Ct.push(Q[ft]),Ct.push(Q[ft+1])),oe.numPoints++;je&&function(Et,Nt){for(var fn=0,Wt=0,bn=Et.length,tt=bn-2;Wt<bn;tt=Wt,Wt+=2)fn+=(Et[Wt]-Et[tt])*(Et[Wt+1]+Et[tt+1]);if(fn>0===Nt)for(Wt=0,bn=Et.length;Wt<bn/2;Wt+=2){var Vt=Et[Wt],Wn=Et[Wt+1];Et[Wt]=Et[bn-2-Wt],Et[Wt+1]=Et[bn-1-Wt],Et[bn-2-Wt]=Vt,Et[bn-1-Wt]=Wn}}(Ct,at),Re.push(Ct)}}function ln(Re,Q){var oe=(Q=this.options=function(je,at){for(var bt in at)je[bt]=at[bt];return je}(Object.create(this.options),Q)).debug;if(oe&&console.time("preprocess data"),Q.maxZoom<0||Q.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Q.promoteId&&Q.generateId)throw new Error("promoteId and generateId cannot be used together.");var je,at,bt,Ct,ft,Et,Ae=function(je,at){var bt=[];if("FeatureCollection"===je.type)for(var Ct=0;Ct<je.features.length;Ct++)Ie(bt,je.features[Ct],at,Ct);else Ie(bt,"Feature"===je.type?je:{geometry:je},at);return bt}(Re,Q);this.tiles={},this.tileCoords=[],oe&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Q.indexMaxZoom,Q.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(je=Ae,at=Q,bt=at.buffer/at.extent,Ct=je,ft=Qn(je,1,-1-bt,bt,0,-1,2,at),Et=Qn(je,1,1-bt,2+bt,0,-1,2,at),(ft||Et)&&(Ct=Qn(je,1,-bt,1+bt,0,-1,2,at)||[],ft&&(Ct=Mo(ft,1).concat(Ct)),Et&&(Ct=Ct.concat(Mo(Et,-1)))),Ae=Ct).length&&this.splitTile(Ae,0,0,0),oe&&(Ae.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function al(Re,Q,oe){return 32*((1<<Re)*oe+Q)+Re}function Fs(Re,Q){const oe=Re.tileID.canonical;if(!this._geoJSONIndex)return Q(null,null);const Ae=this._geoJSONIndex.getTile(oe.z,oe.x,oe.y);if(!Ae)return Q(null,null);const je=new fe(Ae.features);let at=Ne(je);0===at.byteOffset&&at.byteLength===at.buffer.byteLength||(at=new Uint8Array(at)),Q(null,{vectorTile:je,rawData:at.buffer})}ln.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},ln.prototype.splitTile=function(Re,Q,oe,Ae,je,at,bt){for(var Ct=[Re,Q,oe,Ae],ft=this.options,Et=ft.debug;Ct.length;){Ae=Ct.pop(),oe=Ct.pop(),Q=Ct.pop(),Re=Ct.pop();var Nt=1<<Q,fn=al(Q,oe,Ae),Wt=this.tiles[fn];if(!Wt&&(Et>1&&console.time("creation"),Wt=this.tiles[fn]=qi(Re,Q,oe,Ae,ft),this.tileCoords.push({z:Q,x:oe,y:Ae}),Et)){Et>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Q,oe,Ae,Wt.numFeatures,Wt.numPoints,Wt.numSimplified),console.timeEnd("creation"));var bn="z"+Q;this.stats[bn]=(this.stats[bn]||0)+1,this.total++}if(Wt.source=Re,je){if(Q===ft.maxZoom||Q===je)continue;var tt=1<<je-Q;if(oe!==Math.floor(at/tt)||Ae!==Math.floor(bt/tt))continue}else if(Q===ft.indexMaxZoom||Wt.numPoints<=ft.indexMaxPoints)continue;if(Wt.source=null,0!==Re.length){Et>1&&console.time("clipping");var Vt,Wn,zr,lr,oi,ir,vr=.5*ft.buffer/ft.extent,ba=.5-vr,gn=.5+vr,Tr=1+vr;Vt=Wn=zr=lr=null,oi=Qn(Re,Nt,oe-vr,oe+gn,0,Wt.minX,Wt.maxX,ft),ir=Qn(Re,Nt,oe+ba,oe+Tr,0,Wt.minX,Wt.maxX,ft),Re=null,oi&&(Vt=Qn(oi,Nt,Ae-vr,Ae+gn,1,Wt.minY,Wt.maxY,ft),Wn=Qn(oi,Nt,Ae+ba,Ae+Tr,1,Wt.minY,Wt.maxY,ft),oi=null),ir&&(zr=Qn(ir,Nt,Ae-vr,Ae+gn,1,Wt.minY,Wt.maxY,ft),lr=Qn(ir,Nt,Ae+ba,Ae+Tr,1,Wt.minY,Wt.maxY,ft),ir=null),Et>1&&console.timeEnd("clipping"),Ct.push(Vt||[],Q+1,2*oe,2*Ae),Ct.push(Wn||[],Q+1,2*oe,2*Ae+1),Ct.push(zr||[],Q+1,2*oe+1,2*Ae),Ct.push(lr||[],Q+1,2*oe+1,2*Ae+1)}}},ln.prototype.getTile=function(Re,Q,oe){var Ae=this.options,je=Ae.extent,at=Ae.debug;if(Re<0||Re>24)return null;var bt=1<<Re,Ct=al(Re,Q=(Q%bt+bt)%bt,oe);if(this.tiles[Ct])return fi(this.tiles[Ct],je);at>1&&console.log("drilling down to z%d-%d-%d",Re,Q,oe);for(var ft,Et=Re,Nt=Q,fn=oe;!ft&&Et>0;)Et--,Nt=Math.floor(Nt/2),fn=Math.floor(fn/2),ft=this.tiles[al(Et,Nt,fn)];return ft&&ft.source?(at>1&&console.log("found parent tile z%d-%d-%d",Et,Nt,fn),at>1&&console.time("drilling down"),this.splitTile(ft.source,Et,Nt,fn,Re,Q,oe),at>1&&console.timeEnd("drilling down"),this.tiles[Ct]?fi(this.tiles[Ct],je):null):null};class yr extends x.VectorTileWorkerSource{constructor(Q,oe,Ae,je,at){super(Q,oe,Ae,je,Fs),at&&(this.loadGeoJSON=at)}loadData(Q,oe){const Ae=Q&&Q.request,je=Ae&&Ae.collectResourceTiming;this.loadGeoJSON(Q,(at,bt)=>{if(at||!bt)return oe(at);if("object"!=typeof bt)return oe(new Error(`Input data given to '${Q.source}' is not a valid GeoJSON object.`));{It(bt,!0);try{if(Q.filter){const ft=x.createExpression(Q.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===ft.result)throw new Error(ft.value.map(Nt=>`${Nt.key}: ${Nt.message}`).join(", "));const Et=bt.features.filter(Nt=>ft.value.evaluate({zoom:0},Nt));bt={type:"FeatureCollection",features:Et}}this._geoJSONIndex=Q.cluster?new Mn(function({superclusterOptions:ft,clusterProperties:Et}){if(!Et||!ft)return ft;const Nt={},fn={},Wt={accumulated:null,zoom:0},bn={properties:null},tt=Object.keys(Et);for(const Vt of tt){const[Wn,zr]=Et[Vt],lr=x.createExpression(zr),oi=x.createExpression("string"==typeof Wn?[Wn,["accumulated"],["get",Vt]]:Wn);Nt[Vt]=lr.value,fn[Vt]=oi.value}return ft.map=Vt=>{bn.properties=Vt;const Wn={};for(const zr of tt)Wn[zr]=Nt[zr].evaluate(Wt,bn);return Wn},ft.reduce=(Vt,Wn)=>{bn.properties=Wn;for(const zr of tt)Wt.accumulated=Vt[zr],Vt[zr]=fn[zr].evaluate(Wt,bn)},ft}(Q)).load(bt.features):new ln(ft=bt,Q.geojsonVtOptions)}catch(ft){return oe(ft)}this.loaded={};const Ct={};if(je){const ft=x.getPerformanceMeasurement(Ae);ft&&(Ct.resourceTiming={},Ct.resourceTiming[Q.source]=JSON.parse(JSON.stringify(ft)))}oe(null,Ct)}var ft})}reloadTile(Q,oe){const Ae=this.loaded;return Ae&&Ae[Q.uid]?super.reloadTile(Q,oe):this.loadTile(Q,oe)}loadGeoJSON(Q,oe){if(Q.request)x.getJSON(Q.request,oe);else{if("string"!=typeof Q.data)return oe(new Error(`Input data given to '${Q.source}' is not a valid GeoJSON object.`));try{return oe(null,JSON.parse(Q.data))}catch(Ae){return oe(new Error(`Input data given to '${Q.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(Q,oe){try{oe(null,this._geoJSONIndex.getClusterExpansionZoom(Q.clusterId))}catch(Ae){oe(Ae)}}getClusterChildren(Q,oe){try{oe(null,this._geoJSONIndex.getChildren(Q.clusterId))}catch(Ae){oe(Ae)}}getClusterLeaves(Q,oe){try{oe(null,this._geoJSONIndex.getLeaves(Q.clusterId,Q.limit,Q.offset))}catch(Ae){oe(Ae)}}}class Bs{constructor(Q){this.self=Q,this.actor=new x.Actor(Q,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded=!1,this.workerSourceTypes={vector:x.VectorTileWorkerSource,geojson:yr},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(oe,Ae)=>{if(this.workerSourceTypes[oe])throw new Error(`Worker source with name "${oe}" already registered.`);this.workerSourceTypes[oe]=Ae},this.self.registerRTLTextPlugin=oe=>{if(x.plugin.isParsed())throw new Error("RTL text plugin already registered.");x.plugin.applyArabicShaping=oe.applyArabicShaping,x.plugin.processBidirectionalText=oe.processBidirectionalText,x.plugin.processStyledBidirectionalText=oe.processStyledBidirectionalText}}checkIfReady(Q,oe,Ae){Ae()}setReferrer(Q,oe){this.referrer=oe}spriteLoaded(Q,oe){this.isSpriteLoaded=oe;for(const Ae in this.workerSources[Q]){const je=this.workerSources[Q][Ae];for(const at in je)je[at]instanceof x.VectorTileWorkerSource&&(je[at].isSpriteLoaded=oe,je[at].fire(new x.Event("isSpriteLoaded")))}}setImages(Q,oe,Ae){this.availableImages[Q]=oe;for(const je in this.workerSources[Q]){const at=this.workerSources[Q][je];for(const bt in at)at[bt].availableImages=oe}Ae()}enableTerrain(Q,oe,Ae){this.terrain=oe,Ae()}setLayers(Q,oe,Ae){this.getLayerIndex(Q).replace(oe),Ae()}updateLayers(Q,oe,Ae){this.getLayerIndex(Q).update(oe.layers,oe.removedIds),Ae()}loadTile(Q,oe,Ae){const je=this.enableTerrain?x.extend({enableTerrain:this.terrain},oe):oe;this.getWorkerSource(Q,oe.type,oe.source).loadTile(je,Ae)}loadDEMTile(Q,oe,Ae){const je=this.enableTerrain?x.extend({buildQuadTree:this.terrain},oe):oe;this.getDEMWorkerSource(Q,oe.source).loadTile(je,Ae)}reloadTile(Q,oe,Ae){const je=this.enableTerrain?x.extend({enableTerrain:this.terrain},oe):oe;this.getWorkerSource(Q,oe.type,oe.source).reloadTile(je,Ae)}abortTile(Q,oe,Ae){this.getWorkerSource(Q,oe.type,oe.source).abortTile(oe,Ae)}removeTile(Q,oe,Ae){this.getWorkerSource(Q,oe.type,oe.source).removeTile(oe,Ae)}removeSource(Q,oe,Ae){if(!this.workerSources[Q]||!this.workerSources[Q][oe.type]||!this.workerSources[Q][oe.type][oe.source])return;const je=this.workerSources[Q][oe.type][oe.source];delete this.workerSources[Q][oe.type][oe.source],void 0!==je.removeSource?je.removeSource(oe,Ae):Ae()}loadWorkerSource(Q,oe,Ae){try{this.self.importScripts(oe.url),Ae()}catch(je){Ae(je.toString())}}syncRTLPluginState(Q,oe,Ae){try{x.plugin.setState(oe);const je=x.plugin.getPluginURL();if(x.plugin.isLoaded()&&!x.plugin.isParsed()&&null!=je){this.self.importScripts(je);const at=x.plugin.isParsed();Ae(at?void 0:new Error(`RTL Text Plugin failed to import scripts from ${je}`),at)}}catch(je){Ae(je.toString())}}getAvailableImages(Q){let oe=this.availableImages[Q];return oe||(oe=[]),oe}getLayerIndex(Q){let oe=this.layerIndexes[Q];return oe||(oe=this.layerIndexes[Q]=new dt),oe}getWorkerSource(Q,oe,Ae){return this.workerSources[Q]||(this.workerSources[Q]={}),this.workerSources[Q][oe]||(this.workerSources[Q][oe]={}),this.workerSources[Q][oe][Ae]||(this.workerSources[Q][oe][Ae]=new this.workerSourceTypes[oe]({send:(je,at,bt,Ct,ft,Et)=>{this.actor.send(je,at,bt,Q,ft,Et)},scheduler:this.actor.scheduler},this.getLayerIndex(Q),this.getAvailableImages(Q),this.isSpriteLoaded)),this.workerSources[Q][oe][Ae]}getDEMWorkerSource(Q,oe){return this.demWorkerSources[Q]||(this.demWorkerSources[Q]={}),this.demWorkerSources[Q][oe]||(this.demWorkerSources[Q][oe]=new Qe),this.demWorkerSources[Q][oe]}enforceCacheSizeLimit(Q,oe){x.enforceCacheSizeLimit(oe)}getWorkerPerformanceMetrics(Q,oe,Ae){Ae(void 0,void 0)}}return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope&&(self.worker=new Bs(self)),Bs}),Be(0,function(x){var ut=qe;function qe(C){return c=C,!("undefined"==typeof window||"undefined"==typeof document||!(Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray)||!Function.prototype||!Function.prototype.bind||!(Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions)||!("JSON"in window&&"parse"in JSON&&"stringify"in JSON)||!function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var S,P,O=new Blob([""],{type:"text/javascript"}),F=URL.createObjectURL(O);try{P=new Worker(F),S=!0}catch(U){S=!1}return P&&P.terminate(),URL.revokeObjectURL(F),S}()||!("Uint8ClampedArray"in window)||!ArrayBuffer.isView||!function(){var S=document.createElement("canvas");S.width=S.height=1;var P=S.getContext("2d");if(!P)return!1;var O=P.getImageData(0,0,1,1);return O&&O.width===S.width}()||(void 0===dt[y=c&&c.failIfMajorPerformanceCaveat]&&(dt[y]=function(S){var P,F,U,q,O=(F=S,U=document.createElement("canvas"),(q=Object.create(qe.webGLContextAttributes)).failIfMajorPerformanceCaveat=F,U.getContext("webgl",q)||U.getContext("experimental-webgl",q));if(!O)return!1;try{P=O.createShader(O.VERTEX_SHADER)}catch(F){return!1}return!(!P||O.isContextLost())&&(O.shaderSource(P,"void main() {}"),O.compileShader(P),!0===O.getShaderParameter(P,O.COMPILE_STATUS))}(y)),!dt[y]||document.documentMode));var c,y}var dt={};function Ge(C,c){if(Array.isArray(C)){if(!Array.isArray(c)||C.length!==c.length)return!1;for(let y=0;y<C.length;y++)if(!Ge(C[y],c[y]))return!1;return!0}if("object"==typeof C&&null!==C&&null!==c){if("object"!=typeof c||Object.keys(C).length!==Object.keys(c).length)return!1;for(const y in C)if(!Ge(C[y],c[y]))return!1;return!0}return C===c}qe.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const Qe={create:function(C,c,y){const S=x.window.document.createElement(C);return void 0!==c&&(S.className=c),y&&y.appendChild(S),S},createNS:function(C,c){return x.window.document.createElementNS(C,c)}},It=x.window.document&&x.window.document.documentElement.style,kt=It&&void 0!==It.userSelect?"userSelect":"WebkitUserSelect";let vt;Qe.disableDrag=function(){It&&kt&&(vt=It[kt],It[kt]="none")},Qe.enableDrag=function(){It&&kt&&(It[kt]=vt)},Qe.setTransform=function(C,c){C.style.transform=c};let At=!1;try{const C=Object.defineProperty({},"passive",{get(){At=!0}});x.window.addEventListener("test",C,C),x.window.removeEventListener("test",C,C)}catch(C){At=!1}Qe.addEventListener=function(C,c,y,S={}){C.addEventListener(c,y,"passive"in S&&At?S:S.capture)},Qe.removeEventListener=function(C,c,y,S={}){C.removeEventListener(c,y,"passive"in S&&At?S:S.capture)};const an=function(C){C.preventDefault(),C.stopPropagation(),x.window.removeEventListener("click",an,!0)};function fe(C,c,y){const S=C.offsetWidth===c.width?1:C.offsetWidth/c.width;return new x.pointGeometry((y.clientX-c.left)*S,(y.clientY-c.top)*S)}Qe.suppressClick=function(){x.window.addEventListener("click",an,!0),x.window.setTimeout(()=>{x.window.removeEventListener("click",an,!0)},0)},Qe.mousePos=function(C,c){const y=C.getBoundingClientRect();return fe(C,y,c)},Qe.touchPos=function(C,c){const y=C.getBoundingClientRect(),S=[];for(let P=0;P<c.length;P++)S.push(fe(C,y,c[P]));return S},Qe.mouseButton=function(C){return void 0!==x.window.InstallTrigger&&2===C.button&&C.ctrlKey&&x.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:C.button},Qe.remove=function(C){C.parentNode&&C.parentNode.removeChild(C)};class Se{constructor(c,y){this.pos=c,this.dir=y}intersectsPlane(c,y,S){const P=x.dot(y,this.dir);if(Math.abs(P)<1e-6)return!1;const O=x.dot(x.sub(x.create(),c,this.pos),y)/P,F=x.scaleAndAdd(x.create(),this.pos,this.dir,O);return x.copy(S,F),!0}}class ue{constructor(c,y){this.points=c,this.planes=y}static fromInvProjectionMatrix(c,y,S){const P=Math.pow(2,S),O=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(U=>{const q=x.transformMat4([],U,c),Y=1/q[3]/y*P;return x.mul(q,q,[Y,Y,1/q[3],Y])}),F=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(U=>{const q=x.sub([],O[U[0]],O[U[1]]),Y=x.sub([],O[U[2]],O[U[1]]),te=x.normalize([],x.cross([],q,Y)),ie=-x.dot(te,O[U[1]]);return te.concat(ie)});return new ue(O,F)}}class pe{constructor(c,y){this.min=c,this.max=y,this.center=x.scale([],x.add([],this.min,this.max),.5)}quadrant(c){const y=[c%2==0,c<2],S=x.clone(this.min),P=x.clone(this.max);for(let O=0;O<y.length;O++)S[O]=y[O]?this.min[O]:this.center[O],P[O]=y[O]?this.center[O]:this.max[O];return P[2]=this.max[2],new pe(S,P)}distanceX(c){return Math.max(Math.min(this.max[0],c[0]),this.min[0])-c[0]}distanceY(c){return Math.max(Math.min(this.max[1],c[1]),this.min[1])-c[1]}distanceZ(c){return Math.max(Math.min(this.max[2],c[2]),this.min[2])-c[2]}intersects(c){const y=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let S=!0;for(let P=0;P<c.planes.length;P++){const O=c.planes[P];let F=0;for(let U=0;U<y.length;U++)F+=x.dot$1(O,y[U])>=0;if(0===F)return 0;F!==y.length&&(S=!1)}if(S)return 2;for(let P=0;P<3;P++){let O=Number.MAX_VALUE,F=-Number.MAX_VALUE;for(let U=0;U<c.points.length;U++){const q=c.points[U][P]-this.min[P];O=Math.min(O,q),F=Math.max(F,q)}if(F<0||O>this.max[P]-this.min[P])return 0}return 1}}function le(C){const{userImage:c}=C;return!!(c&&c.render&&c.render())&&(C.data.replace(new Uint8Array(c.data.buffer)),!0)}class Ne extends x.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new x.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(c){if(this.loaded!==c&&(this.loaded=c,c)){for(const{ids:y,callback:S}of this.requestors)this._notify(y,S);this.requestors=[]}}getImage(c){return this.images[c]}addImage(c,y){this._validate(c,y)&&(this.images[c]=y)}_validate(c,y){let S=!0;return this._validateStretch(y.stretchX,y.data&&y.data.width)||(this.fire(new x.ErrorEvent(new Error(`Image "${c}" has invalid "stretchX" value`))),S=!1),this._validateStretch(y.stretchY,y.data&&y.data.height)||(this.fire(new x.ErrorEvent(new Error(`Image "${c}" has invalid "stretchY" value`))),S=!1),this._validateContent(y.content,y)||(this.fire(new x.ErrorEvent(new Error(`Image "${c}" has invalid "content" value`))),S=!1),S}_validateStretch(c,y){if(!c)return!0;let S=0;for(const P of c){if(P[0]<S||P[1]<P[0]||y<P[1])return!1;S=P[1]}return!0}_validateContent(c,y){return!(c&&(4!==c.length||c[0]<0||y.data.width<c[0]||c[1]<0||y.data.height<c[1]||c[2]<0||y.data.width<c[2]||c[3]<0||y.data.height<c[3]||c[2]<c[0]||c[3]<c[1]))}updateImage(c,y){y.version=this.images[c].version+1,this.images[c]=y,this.updatedImages[c]=!0}removeImage(c){const y=this.images[c];delete this.images[c],delete this.patterns[c],y.userImage&&y.userImage.onRemove&&y.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(c,y){let S=!0;if(!this.isLoaded())for(const P of c)this.images[P]||(S=!1);this.isLoaded()||S?this._notify(c,y):this.requestors.push({ids:c,callback:y})}_notify(c,y){const S={};for(const P of c){this.images[P]||this.fire(new x.Event("styleimagemissing",{id:P}));const O=this.images[P];O?S[P]={data:O.data.clone(),pixelRatio:O.pixelRatio,sdf:O.sdf,version:O.version,stretchX:O.stretchX,stretchY:O.stretchY,content:O.content,hasRenderCallback:Boolean(O.userImage&&O.userImage.render)}:x.warnOnce(`Image "${P}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}y(null,S)}getPixelSize(){const{width:c,height:y}=this.atlasImage;return{width:c,height:y}}getPattern(c){const y=this.patterns[c],S=this.getImage(c);if(!S)return null;if(y&&y.position.version===S.version)return y.position;if(y)y.position.version=S.version;else{const P={w:S.data.width+2,h:S.data.height+2,x:0,y:0},O=new x.ImagePosition(P,S);this.patterns[c]={bin:P,position:O}}return this._updatePatternAtlas(),this.patterns[c].position}bind(c){const y=c.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new x.Texture(c,this.atlasImage,y.RGBA),this.atlasTexture.bind(y.LINEAR,y.CLAMP_TO_EDGE)}_updatePatternAtlas(){const c=[];for(const O in this.patterns)c.push(this.patterns[O].bin);const{w:y,h:S}=x.potpack(c),P=this.atlasImage;P.resize({width:y||1,height:S||1});for(const O in this.patterns){const{bin:F}=this.patterns[O],U=F.x+1,q=F.y+1,Y=this.images[O].data,te=Y.width,ie=Y.height;x.RGBAImage.copy(Y,P,{x:0,y:0},{x:U,y:q},{width:te,height:ie}),x.RGBAImage.copy(Y,P,{x:0,y:ie-1},{x:U,y:q-1},{width:te,height:1}),x.RGBAImage.copy(Y,P,{x:0,y:0},{x:U,y:q+ie},{width:te,height:1}),x.RGBAImage.copy(Y,P,{x:te-1,y:0},{x:U-1,y:q},{width:1,height:ie}),x.RGBAImage.copy(Y,P,{x:0,y:0},{x:U+te,y:q},{width:1,height:ie})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(c){for(const y of c){if(this.callbackDispatchedThisFrame[y])continue;this.callbackDispatchedThisFrame[y]=!0;const S=this.images[y];le(S)&&this.updateImage(y,S)}}}const he=new x.Properties({anchor:new x.DataConstantProperty(x.spec.light.anchor),position:new class{constructor(){this.specification=x.spec.light.position}possiblyEvaluate(C,c){return function([y,S,P]){const O=x.degToRad(S+90),F=x.degToRad(P);return{x:y*Math.cos(O)*Math.sin(F),y:y*Math.sin(O)*Math.sin(F),z:y*Math.cos(F),azimuthal:S,polar:P}}(C.expression.evaluate(c))}interpolate(C,c,y){return{x:x.number(C.x,c.x,y),y:x.number(C.y,c.y,y),z:x.number(C.z,c.z,y),azimuthal:x.number(C.azimuthal,c.azimuthal,y),polar:x.number(C.polar,c.polar,y)}}},color:new x.DataConstantProperty(x.spec.light.color),intensity:new x.DataConstantProperty(x.spec.light.intensity)}),me="-transition";class be extends x.Evented{constructor(c){super(),this._transitionable=new x.Transitionable(he),this.setLight(c),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(c,y={}){if(!this._validate(x.validateLight,c,y))for(const S in c){const P=c[S];x.endsWith(S,me)?this._transitionable.setTransition(S.slice(0,-me.length),P):this._transitionable.setValue(S,P)}}updateTransitions(c){this._transitioning=this._transitionable.transitioned(c,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(c){this.properties=this._transitioning.possiblyEvaluate(c)}_validate(c,y,S){return(!S||!1!==S.validate)&&x.emitValidationErrors(this,c.call(x.validateStyle,x.extend({value:y,style:{glyphs:!0,sprite:!0},styleSpec:x.spec})))}}const re=new x.Properties({source:new x.DataConstantProperty(x.spec.terrain.source),exaggeration:new x.DataConstantProperty(x.spec.terrain.exaggeration)}),mt="-transition";class ze extends x.Evented{constructor(c){super(),this._transitionable=new x.Transitionable(re),this.set(c),this._transitioning=this._transitionable.untransitioned()}get(){return this._transitionable.serialize()}set(c){for(const y in c){const S=c[y];x.endsWith(y,mt)?this._transitionable.setTransition(y.slice(0,-mt.length),S):this._transitionable.setValue(y,S)}}updateTransitions(c){this._transitioning=this._transitionable.transitioned(c,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(c){this.properties=this._transitioning.possiblyEvaluate(c)}}function Oe(C,c,y,S){const P=x.smoothstep(45,65,y),[O,F]=xe(C,S),U=x.length(c);let q=1-Math.min(1,Math.exp((U-O)/(F-O)*-6));return q*=q*q,q=Math.min(1,1.00747*q),q*P*C.alpha}function xe(C,c){const y=.5/Math.tan(.5*c);return[C.range[0]+y,C.range[1]+y]}const jt=new x.Properties({range:new x.DataConstantProperty(x.spec.fog.range),color:new x.DataConstantProperty(x.spec.fog.color),"horizon-blend":new x.DataConstantProperty(x.spec.fog["horizon-blend"])}),Lt="-transition";class Ce extends x.Evented{constructor(c){super(),this._transitionable=new x.Transitionable(jt),this.set(c),this._transitioning=this._transitionable.untransitioned()}get state(){return{range:this.properties.get("range"),horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(c,y={}){if(!this._validate(x.validateFog,c,y))for(const S in c){const P=c[S];x.endsWith(S,Lt)?this._transitionable.setTransition(S.slice(0,-Lt.length),P):this._transitionable.setValue(S,P)}}getOpacity(c){const y=this.properties&&this.properties.get("color")||1;return x.smoothstep(45,65,c)*y.a}getOpacityAtLatLng(c,y){return function(S,P,O){const F=x.MercatorCoordinate.fromLngLat(P),U=O.elevation?O.elevation.getAtPointOrZero(F):0,q=[F.x,F.y,U];return x.transformMat4$1(q,q,O.mercatorFogMatrix),Oe(S,q,O.pitch,O._fov)}(this.state,c,y)}getFovAdjustedRange(c){return xe(this.state,c)}updateTransitions(c){this._transitioning=this._transitionable.transitioned(c,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(c){this.properties=this._transitioning.possiblyEvaluate(c)}_validate(c,y,S){return(!S||!1!==S.validate)&&x.emitValidationErrors(this,c.call(x.validateStyle,x.extend({value:y,style:{glyphs:!0,sprite:!0},styleSpec:x.spec})))}}class ht{constructor(c,y){this.workerPool=c,this.actors=[],this.currentActor=0,this.id=x.uniqueId();const S=this.workerPool.acquire(this.id);for(let P=0;P<S.length;P++){const O=new ht.Actor(S[P],y,this.id);O.name=`Worker ${P}`,this.actors.push(O)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(c,y,S){x.asyncAll(this.actors,(P,O)=>{P.send(c,y,O)},S=S||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(c=>{c.remove()}),this.actors=[],this.workerPool.release(this.id)}}function Pe(C,c,y){return c*(x.EXTENT/(C.tileSize*Math.pow(2,y-C.tileID.overscaledZ)))}ht.Actor=x.Actor;class lt{constructor(c,y,S,P){this.screenBounds=c,this.cameraPoint=y,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=S,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this.screenGeometry.map(O=>P.pointCoordinate3D(O)),this.cameraGeometry=this.bufferedCameraGeometry(0)}static createFromScreenPoints(c,y){let S,P;if(c instanceof x.pointGeometry||"number"==typeof c[0]){const O=x.pointGeometry.convert(c);S=[x.pointGeometry.convert(c)],P=y.isPointAboveHorizon(O)}else{const O=x.pointGeometry.convert(c[0]),F=x.pointGeometry.convert(c[1]);S=[O,F],P=x.polygonizeBounds(O,F).every(U=>y.isPointAboveHorizon(U))}return new lt(S,y.getCameraPoint(),P,y)}isPointQuery(){return 1===this.screenBounds.length}bufferedScreenGeometry(c){return x.polygonizeBounds(this.screenBounds[0],1===this.screenBounds.length?this.screenBounds[0]:this.screenBounds[1],c)}bufferedCameraGeometry(c){const y=this.screenBounds[0],S=1===this.screenBounds.length?this.screenBounds[0].add(new x.pointGeometry(1,1)):this.screenBounds[1],P=x.polygonizeBounds(y,S,0,!1);return this.cameraPoint.y>S.y&&(this.cameraPoint.x>y.x&&this.cameraPoint.x<S.x?P.splice(3,0,this.cameraPoint):this.cameraPoint.x>=S.x?P[2]=this.cameraPoint:this.cameraPoint.x<=y.x&&(P[3]=this.cameraPoint)),x.bufferConvexPolygon(P,c)}containsTile(c,y,S){const P=c.queryPadding+1,O=S?this._bufferedCameraMercator(P,y).map(we=>c.tileID.getTilePoint(we)):this._bufferedScreenMercator(P,y).map(we=>c.tileID.getTilePoint(we)),F=this.screenGeometryMercator.map(we=>c.tileID.getTileVec3(we)),U=F.map(we=>new x.pointGeometry(we[0],we[1])),q=y.getFreeCameraOptions().position||new x.MercatorCoordinate(0,0,0),Y=c.tileID.getTileVec3(q),te=F.map(we=>{const Fe=x.sub(we,we,Y);return x.normalize(Fe,Fe),new Se(Y,Fe)}),ie=Pe(c,1,y.zoom);if(x.polygonIntersectsBox(O,0,0,x.EXTENT,x.EXTENT))return{queryGeometry:this,tilespaceGeometry:U,tilespaceRays:te,bufferedTilespaceGeometry:O,bufferedTilespaceBounds:(se=x.getBounds(O),se.min.x=x.clamp(se.min.x,0,x.EXTENT),se.min.y=x.clamp(se.min.y,0,x.EXTENT),se.max.x=x.clamp(se.max.x,0,x.EXTENT),se.max.y=x.clamp(se.max.y,0,x.EXTENT),se),tile:c,tileID:c.tileID,pixelToTileUnitsFactor:ie};var se}_bufferedScreenMercator(c,y){const S=Ke(c);if(this._screenRaycastCache[S])return this._screenRaycastCache[S];{const P=this.bufferedScreenGeometry(c).map(O=>y.pointCoordinate3D(O));return this._screenRaycastCache[S]=P,P}}_bufferedCameraMercator(c,y){const S=Ke(c);if(this._cameraRaycastCache[S])return this._cameraRaycastCache[S];{const P=this.bufferedCameraGeometry(c).map(O=>y.pointCoordinate3D(O));return this._cameraRaycastCache[S]=P,P}}}function Ke(C){return 100*C|0}function Me(C,c,y){const S=function(P,O){if(P)return y(P);if(O){const F=x.pick(x.extend(O,C),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);O.vector_layers&&(F.vectorLayers=O.vector_layers,F.vectorLayerIds=F.vectorLayers.map(U=>U.id)),F.tiles=c.canonicalizeTileset(F,C.url),y(null,F)}};return C.url?x.getJSON(c.transformRequest(c.normalizeSourceURL(C.url),x.ResourceType.Source),S):x.exported.frame(()=>S(null,C))}class Ft{constructor(c,y,S){this.bounds=x.LngLatBounds.convert(this.validateBounds(c)),this.minzoom=y||0,this.maxzoom=S||24}validateBounds(c){return Array.isArray(c)&&4===c.length?[Math.max(-180,c[0]),Math.max(-90,c[1]),Math.min(180,c[2]),Math.min(90,c[3])]:[-180,-90,180,90]}contains(c){const y=Math.pow(2,c.z),S=Math.floor(x.mercatorXfromLng(this.bounds.getWest())*y),P=Math.floor(x.mercatorYfromLat(this.bounds.getNorth())*y),O=Math.ceil(x.mercatorXfromLng(this.bounds.getEast())*y),F=Math.ceil(x.mercatorYfromLat(this.bounds.getSouth())*y);return c.x>=S&&c.x<O&&c.y>=P&&c.y<F}}class Ut{constructor(c,y,S){this.context=c;const P=c.gl;this.buffer=P.createBuffer(),this.dynamicDraw=Boolean(S),this.context.unbindVAO(),c.bindElementBuffer.set(this.buffer),P.bufferData(P.ELEMENT_ARRAY_BUFFER,y.arrayBuffer,this.dynamicDraw?P.DYNAMIC_DRAW:P.STATIC_DRAW),this.dynamicDraw||delete y.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(c){const y=this.context.gl;this.context.unbindVAO(),this.bind(),y.bufferSubData(y.ELEMENT_ARRAY_BUFFER,0,c.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Sn={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Gt{constructor(c,y,S,P){this.length=y.length,this.attributes=S,this.itemSize=y.bytesPerElement,this.dynamicDraw=P,this.context=c;const O=c.gl;this.buffer=O.createBuffer(),c.bindVertexBuffer.set(this.buffer),O.bufferData(O.ARRAY_BUFFER,y.arrayBuffer,this.dynamicDraw?O.DYNAMIC_DRAW:O.STATIC_DRAW),this.dynamicDraw||delete y.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(c){const y=this.context.gl;this.bind(),y.bufferSubData(y.ARRAY_BUFFER,0,c.arrayBuffer)}enableAttributes(c,y){for(let S=0;S<this.attributes.length;S++){const P=y.attributes[this.attributes[S].name];void 0!==P&&c.enableVertexAttribArray(P)}}setVertexAttribPointers(c,y,S){for(let P=0;P<this.attributes.length;P++){const O=this.attributes[P],F=y.attributes[O.name];void 0!==F&&c.vertexAttribPointer(F,O.components,c[Sn[O.type]],!1,this.itemSize,O.offset+this.itemSize*(S||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Mn{constructor(c){this.gl=c.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(c){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class hr extends Mn{getDefault(){return x.Color.transparent}set(c){const y=this.current;(c.r!==y.r||c.g!==y.g||c.b!==y.b||c.a!==y.a||this.dirty)&&(this.gl.clearColor(c.r,c.g,c.b,c.a),this.current=c,this.dirty=!1)}}class sr extends Mn{getDefault(){return 1}set(c){(c!==this.current||this.dirty)&&(this.gl.clearDepth(c),this.current=c,this.dirty=!1)}}class In extends Mn{getDefault(){return 0}set(c){(c!==this.current||this.dirty)&&(this.gl.clearStencil(c),this.current=c,this.dirty=!1)}}class Vn extends Mn{getDefault(){return[!0,!0,!0,!0]}set(c){const y=this.current;(c[0]!==y[0]||c[1]!==y[1]||c[2]!==y[2]||c[3]!==y[3]||this.dirty)&&(this.gl.colorMask(c[0],c[1],c[2],c[3]),this.current=c,this.dirty=!1)}}class rn extends Mn{getDefault(){return!0}set(c){(c!==this.current||this.dirty)&&(this.gl.depthMask(c),this.current=c,this.dirty=!1)}}class hi extends Mn{getDefault(){return 255}set(c){(c!==this.current||this.dirty)&&(this.gl.stencilMask(c),this.current=c,this.dirty=!1)}}class nr extends Mn{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(c){const y=this.current;(c.func!==y.func||c.ref!==y.ref||c.mask!==y.mask||this.dirty)&&(this.gl.stencilFunc(c.func,c.ref,c.mask),this.current=c,this.dirty=!1)}}class ai extends Mn{getDefault(){const c=this.gl;return[c.KEEP,c.KEEP,c.KEEP]}set(c){const y=this.current;(c[0]!==y[0]||c[1]!==y[1]||c[2]!==y[2]||this.dirty)&&(this.gl.stencilOp(c[0],c[1],c[2]),this.current=c,this.dirty=!1)}}class Qr extends Mn{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const y=this.gl;c?y.enable(y.STENCIL_TEST):y.disable(y.STENCIL_TEST),this.current=c,this.dirty=!1}}class eo extends Mn{getDefault(){return[0,1]}set(c){const y=this.current;(c[0]!==y[0]||c[1]!==y[1]||this.dirty)&&(this.gl.depthRange(c[0],c[1]),this.current=c,this.dirty=!1)}}class _t extends Mn{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const y=this.gl;c?y.enable(y.DEPTH_TEST):y.disable(y.DEPTH_TEST),this.current=c,this.dirty=!1}}class ve extends Mn{getDefault(){return this.gl.LESS}set(c){(c!==this.current||this.dirty)&&(this.gl.depthFunc(c),this.current=c,this.dirty=!1)}}class ce extends Mn{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const y=this.gl;c?y.enable(y.BLEND):y.disable(y.BLEND),this.current=c,this.dirty=!1}}class ae extends Mn{getDefault(){const c=this.gl;return[c.ONE,c.ZERO]}set(c){const y=this.current;(c[0]!==y[0]||c[1]!==y[1]||this.dirty)&&(this.gl.blendFunc(c[0],c[1]),this.current=c,this.dirty=!1)}}class Ie extends Mn{getDefault(){return x.Color.transparent}set(c){const y=this.current;(c.r!==y.r||c.g!==y.g||c.b!==y.b||c.a!==y.a||this.dirty)&&(this.gl.blendColor(c.r,c.g,c.b,c.a),this.current=c,this.dirty=!1)}}class ct extends Mn{getDefault(){return this.gl.FUNC_ADD}set(c){(c!==this.current||this.dirty)&&(this.gl.blendEquation(c),this.current=c,this.dirty=!1)}}class Ot extends Mn{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const y=this.gl;c?y.enable(y.CULL_FACE):y.disable(y.CULL_FACE),this.current=c,this.dirty=!1}}class Kt extends Mn{getDefault(){return this.gl.BACK}set(c){(c!==this.current||this.dirty)&&(this.gl.cullFace(c),this.current=c,this.dirty=!1)}}class Yt extends Mn{getDefault(){return this.gl.CCW}set(c){(c!==this.current||this.dirty)&&(this.gl.frontFace(c),this.current=c,this.dirty=!1)}}class wt extends Mn{getDefault(){return null}set(c){(c!==this.current||this.dirty)&&(this.gl.useProgram(c),this.current=c,this.dirty=!1)}}class Qn extends Mn{getDefault(){return this.gl.TEXTURE0}set(c){(c!==this.current||this.dirty)&&(this.gl.activeTexture(c),this.current=c,this.dirty=!1)}}class Er extends Mn{getDefault(){const c=this.gl;return[0,0,c.drawingBufferWidth,c.drawingBufferHeight]}set(c){const y=this.current;(c[0]!==y[0]||c[1]!==y[1]||c[2]!==y[2]||c[3]!==y[3]||this.dirty)&&(this.gl.viewport(c[0],c[1],c[2],c[3]),this.current=c,this.dirty=!1)}}class Qt extends Mn{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const y=this.gl;y.bindFramebuffer(y.FRAMEBUFFER,c),this.current=c,this.dirty=!1}}class jn extends Mn{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const y=this.gl;y.bindRenderbuffer(y.RENDERBUFFER,c),this.current=c,this.dirty=!1}}class ar extends Mn{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const y=this.gl;y.bindTexture(y.TEXTURE_2D,c),this.current=c,this.dirty=!1}}class Vr extends Mn{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const y=this.gl;y.bindBuffer(y.ARRAY_BUFFER,c),this.current=c,this.dirty=!1}}class ei extends Mn{getDefault(){return null}set(c){const y=this.gl;y.bindBuffer(y.ELEMENT_ARRAY_BUFFER,c),this.current=c,this.dirty=!1}}class So extends Mn{constructor(c){super(c),this.vao=c.extVertexArrayObject}getDefault(){return null}set(c){this.vao&&(c!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(c),this.current=c,this.dirty=!1)}}class Mo extends Mn{getDefault(){return 4}set(c){if(c===this.current&&!this.dirty)return;const y=this.gl;y.pixelStorei(y.UNPACK_ALIGNMENT,c),this.current=c,this.dirty=!1}}class jo extends Mn{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const y=this.gl;y.pixelStorei(y.UNPACK_PREMULTIPLY_ALPHA_WEBGL,c),this.current=c,this.dirty=!1}}class fi extends Mn{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const y=this.gl;y.pixelStorei(y.UNPACK_FLIP_Y_WEBGL,c),this.current=c,this.dirty=!1}}class Xo extends Mn{constructor(c,y){super(c),this.context=c,this.parent=y}getDefault(){return null}}class qi extends Xo{setDirty(){this.dirty=!0}set(c){if(c===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const y=this.gl;y.framebufferTexture2D(y.FRAMEBUFFER,y.COLOR_ATTACHMENT0,y.TEXTURE_2D,c,0),this.current=c,this.dirty=!1}}class fa extends Xo{attachment(){return this.gl.DEPTH_ATTACHMENT}set(c){if(c===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const y=this.gl;y.framebufferRenderbuffer(y.FRAMEBUFFER,this.attachment(),y.RENDERBUFFER,c),this.current=c,this.dirty=!1}}class fo extends fa{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class ln{constructor(c,y,S,P){this.context=c,this.width=y,this.height=S;const O=this.framebuffer=c.gl.createFramebuffer();this.colorAttachment=new qi(c,O),P&&(this.depthAttachment=new fa(c,O))}destroy(){const c=this.context.gl,y=this.colorAttachment.get();if(y&&c.deleteTexture(y),this.depthAttachment){const S=this.depthAttachment.get();S&&c.deleteRenderbuffer(S)}c.deleteFramebuffer(this.framebuffer)}}class al{constructor(c){this.gl=c,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new hr(this),this.clearDepth=new sr(this),this.clearStencil=new In(this),this.colorMask=new Vn(this),this.depthMask=new rn(this),this.stencilMask=new hi(this),this.stencilFunc=new nr(this),this.stencilOp=new ai(this),this.stencilTest=new Qr(this),this.depthRange=new eo(this),this.depthTest=new _t(this),this.depthFunc=new ve(this),this.blend=new ce(this),this.blendFunc=new ae(this),this.blendColor=new Ie(this),this.blendEquation=new ct(this),this.cullFace=new Ot(this),this.cullFaceSide=new Kt(this),this.frontFace=new Yt(this),this.program=new wt(this),this.activeTexture=new Qn(this),this.viewport=new Er(this),this.bindFramebuffer=new Qt(this),this.bindRenderbuffer=new jn(this),this.bindTexture=new ar(this),this.bindVertexBuffer=new Vr(this),this.bindElementBuffer=new ei(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new So(this),this.pixelStoreUnpack=new Mo(this),this.pixelStoreUnpackPremultiplyAlpha=new jo(this),this.pixelStoreUnpackFlipY=new fi(this),this.extTextureFilterAnisotropic=c.getExtension("EXT_texture_filter_anisotropic")||c.getExtension("MOZ_EXT_texture_filter_anisotropic")||c.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=c.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extTextureHalfFloat=c.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(c.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=c.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=c.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=c.getParameter(c.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(c,y){return new Ut(this,c,y)}createVertexBuffer(c,y,S){return new Gt(this,c,y,S)}createRenderbuffer(c,y,S){const P=this.gl,O=P.createRenderbuffer();return this.bindRenderbuffer.set(O),P.renderbufferStorage(P.RENDERBUFFER,c,y,S),this.bindRenderbuffer.set(null),O}createFramebuffer(c,y,S){return new ln(this,c,y,S)}clear({color:c,depth:y,stencil:S}){const P=this.gl;let O=0;c&&(O|=P.COLOR_BUFFER_BIT,this.clearColor.set(c),this.colorMask.set([!0,!0,!0,!0])),void 0!==y&&(O|=P.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(y),this.depthMask.set(!0)),void 0!==S&&(O|=P.STENCIL_BUFFER_BIT,this.clearStencil.set(S),this.stencilMask.set(255)),P.clear(O)}setCullFace(c){!1===c.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(c.mode),this.frontFace.set(c.frontFace))}setDepthMode(c){c.func!==this.gl.ALWAYS||c.mask?(this.depthTest.set(!0),this.depthFunc.set(c.func),this.depthMask.set(c.mask),this.depthRange.set(c.range)):this.depthTest.set(!1)}setStencilMode(c){c.test.func!==this.gl.ALWAYS||c.mask?(this.stencilTest.set(!0),this.stencilMask.set(c.mask),this.stencilOp.set([c.fail,c.depthFail,c.pass]),this.stencilFunc.set({func:c.test.func,ref:c.ref,mask:c.test.mask})):this.stencilTest.set(!1)}setColorMode(c){Ge(c.blendFunction,x.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(c.blendFunction),this.blendColor.set(c.blendColor)),this.colorMask.set(c.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class Fs extends x.Evented{constructor(c,y,S,P){super(),this.id=c,this.dispatcher=S,this.setEventedParent(P),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=x.extend({type:"raster"},y),x.extend(this,x.pick(y,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new x.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Me(this._options,this.map._requestManager,(c,y)=>{this._tileJSONRequest=null,this._loaded=!0,c?this.fire(new x.ErrorEvent(c)):y&&(x.extend(this,y),y.bounds&&(this.tileBounds=new Ft(y.bounds,this.minzoom,this.maxzoom)),x.postTurnstileEvent(y.tiles),this.fire(new x.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new x.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(c){this.map=c,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return x.extend({},this._options)}hasTile(c){return!this.tileBounds||this.tileBounds.contains(c.canonical)}loadTile(c,y){const S=x.exported.devicePixelRatio>=2,P=this.map._requestManager.normalizeTileURL(c.tileID.canonical.url(this.tiles,this.scheme),S,this.tileSize);c.request=x.getImage(this.map._requestManager.transformRequest(P,x.ResourceType.Tile),(O,F,U,q)=>{if(delete c.request,c.aborted)c.state="unloaded",y(null);else if(O)c.state="errored",y(O);else if(F){this.map._refreshExpiredTiles&&c.setExpiryData({cacheControl:U,expires:q});const Y=this.map.painter.context,te=Y.gl;c.texture=this.map.painter.getTileTexture(F.width),c.texture?c.texture.update(F,{useMipmap:!0}):(c.texture=new x.Texture(Y,F,te.RGBA,{useMipmap:!0}),c.texture.bind(te.LINEAR,te.CLAMP_TO_EDGE,te.LINEAR_MIPMAP_NEAREST),Y.extTextureFilterAnisotropic&&te.texParameterf(te.TEXTURE_2D,Y.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,Y.extTextureFilterAnisotropicMax)),c.state="loaded",x.cacheEntryPossiblyAdded(this.dispatcher),y(null)}})}abortTile(c,y){c.request&&(c.request.cancel(),delete c.request),y()}unloadTile(c,y){c.texture&&this.map.painter.saveTileTexture(c.texture),y()}hasTransition(){return!1}}let yr;var Bs=x.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Re extends x.Evented{constructor(c,y,S,P){super(),this.id=c,this.dispatcher=S,this.coordinates=y.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(P),this.options=y}load(c,y){this._loaded=!1,this.fire(new x.Event("dataloading",{dataType:"source"})),this.url=this.options.url,x.getImage(this.map._requestManager.transformRequest(this.url,x.ResourceType.Image),(S,P)=>{this._loaded=!0,S?this.fire(new x.ErrorEvent(S)):P&&(this.image=x.exported.getImageData(P),c&&(this.coordinates=c),y&&y(),this._finishLoading())})}loaded(){return this._loaded}updateImage(c){return this.image&&c.url?(this.options.url=c.url,this.load(c.coordinates,()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new x.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(c){this.map=c,this.load()}setCoordinates(c){this.coordinates=c;const y=c.map(x.MercatorCoordinate.fromLngLat);this.tileID=function(P){let O=1/0,F=1/0,U=-1/0,q=-1/0;for(const se of P)O=Math.min(O,se.x),F=Math.min(F,se.y),U=Math.max(U,se.x),q=Math.max(q,se.y);const Y=Math.max(U-O,q-F),te=Math.max(0,Math.floor(-Math.log(Y)/Math.LN2)),ie=Math.pow(2,te);return new x.CanonicalTileID(te,Math.floor((O+U)/2*ie),Math.floor((F+q)/2*ie))}(y),this.minzoom=this.maxzoom=this.tileID.z;const S=y.map(P=>this.tileID.getTilePoint(P)._round());return this._boundsArray=new x.StructArrayLayout4i8,this._boundsArray.emplaceBack(S[0].x,S[0].y,0,0),this._boundsArray.emplaceBack(S[1].x,S[1].y,x.EXTENT,0),this._boundsArray.emplaceBack(S[3].x,S[3].y,0,x.EXTENT),this._boundsArray.emplaceBack(S[2].x,S[2].y,x.EXTENT,x.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new x.Event("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(0===Object.keys(this.tiles).length||!this.image)return;const c=this.map.painter.context,y=c.gl;this.boundsBuffer||(this.boundsBuffer=c.createVertexBuffer(this._boundsArray,Bs.members)),this.boundsSegments||(this.boundsSegments=x.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new x.Texture(c,this.image,y.RGBA),this.texture.bind(y.LINEAR,y.CLAMP_TO_EDGE));for(const S in this.tiles){const P=this.tiles[S];"loaded"!==P.state&&(P.state="loaded",P.texture=this.texture)}}loadTile(c,y){this.tileID&&this.tileID.equals(c.tileID.canonical)?(this.tiles[String(c.tileID.wrap)]=c,c.buckets={},y(null)):(c.state="errored",y(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const Q={vector:class extends x.Evented{constructor(C,c,y,S){if(super(),this.id=C,this.dispatcher=y,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,x.extend(this,x.pick(c,["url","scheme","tileSize","promoteId"])),this._options=x.extend({type:"vector"},c),this._collectResourceTiming=c.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(S),this._tileWorkers={},this._deduped=new x.DedupedRequest}load(){this._loaded=!1,this.fire(new x.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Me(this._options,this.map._requestManager,(C,c)=>{this._tileJSONRequest=null,this._loaded=!0,C?this.fire(new x.ErrorEvent(C)):c&&(x.extend(this,c),c.bounds&&(this.tileBounds=new Ft(c.bounds,this.minzoom,this.maxzoom)),x.postTurnstileEvent(c.tiles,this.map._requestManager._customAccessToken),this.fire(new x.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new x.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}hasTile(C){return!this.tileBounds||this.tileBounds.contains(C.canonical)}onAdd(C){this.map=C,this.load()}setSourceProperty(C){this._tileJSONRequest&&this._tileJSONRequest.cancel(),C();const c=this.map.style._getSourceCaches(this.id);for(const y of c)y.clearTiles();this.load()}setTiles(C){return this.setSourceProperty(()=>{this._options.tiles=C}),this}setUrl(C){return this.setSourceProperty(()=>{this.url=C,this._options.url=C}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return x.extend({},this._options)}loadTile(C,c){const y=this.map._requestManager.normalizeTileURL(C.tileID.canonical.url(this.tiles,this.scheme)),S={request:this.map._requestManager.transformRequest(y,x.ResourceType.Tile),data:void 0,uid:C.uid,tileID:C.tileID,tileZoom:C.tileZoom,zoom:C.tileID.overscaledZ,tileSize:this.tileSize*C.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:x.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:C.isSymbolTile};if(S.request.collectResourceTiming=this._collectResourceTiming,C.actor&&"expired"!==C.state)"loading"===C.state?C.reloadCallback=c:C.request=C.actor.send("reloadTile",S,P.bind(this));else if(C.actor=this._tileWorkers[y]=this._tileWorkers[y]||this.dispatcher.getActor(),this.dispatcher.ready)C.request=C.actor.send("loadTile",S,P.bind(this),void 0,!0);else{const O=x.loadVectorTile.call({deduped:this._deduped},S,(F,U)=>{F||!U?P.call(this,F):(S.data={cacheControl:U.cacheControl,expires:U.expires,rawData:U.rawData.slice(0)},C.actor&&C.actor.send("loadTile",S,P.bind(this),void 0,!0))},!0);C.request={cancel:O}}function P(O,F){return delete C.request,C.aborted?c(null):O&&404!==O.status?c(O):(F&&F.resourceTiming&&(C.resourceTiming=F.resourceTiming),this.map._refreshExpiredTiles&&F&&C.setExpiryData(F),C.loadVectorData(F,this.map.painter),x.cacheEntryPossiblyAdded(this.dispatcher),c(null),void(C.reloadCallback&&(this.loadTile(C,C.reloadCallback),C.reloadCallback=null)))}}abortTile(C){C.request&&(C.request.cancel(),delete C.request),C.actor&&C.actor.send("abortTile",{uid:C.uid,type:this.type,source:this.id})}unloadTile(C){C.unloadVectorData(),C.actor&&C.actor.send("removeTile",{uid:C.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}},raster:Fs,"raster-dem":class extends Fs{constructor(C,c,y,S){super(C,c,y,S),this.type="raster-dem",this.maxzoom=22,this._options=x.extend({type:"raster-dem"},c),this.encoding=c.encoding||"mapbox"}loadTile(C,c){const y=this.map._requestManager.normalizeTileURL(C.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function S(P,O){P&&(C.state="errored",c(P)),O&&(C.dem=O,C.dem.onDeserialize(),C.needsHillshadePrepare=!0,C.needsDEMTextureUpload=!0,C.state="loaded",c(null))}C.request=x.getImage(this.map._requestManager.transformRequest(y,x.ResourceType.Tile),function(P,O,F,U){if(delete C.request,C.aborted)C.state="unloaded",c(null);else if(P)C.state="errored",c(P);else if(O){this.map._refreshExpiredTiles&&C.setExpiryData({cacheControl:F,expires:U});const q=x.window.ImageBitmap&&O instanceof x.window.ImageBitmap&&(null==yr&&(yr=x.window.OffscreenCanvas&&new x.window.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof x.window.createImageBitmap),yr),Y=1-(O.width-x.prevPowerOfTwo(O.width))/2;Y<1||C.neighboringTiles||(C.neighboringTiles=this._getNeighboringTiles(C.tileID));const te=q?O:x.exported.getImageData(O,Y),ie={uid:C.uid,coord:C.tileID,source:this.id,rawImageData:te,encoding:this.encoding,padding:Y};C.actor&&"expired"!==C.state||(C.actor=this.dispatcher.getActor(),C.actor.send("loadDEMTile",ie,S.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(C){const c=C.canonical,y=Math.pow(2,c.z),S=(c.x-1+y)%y,P=0===c.x?C.wrap-1:C.wrap,O=(c.x+1+y)%y,F=c.x+1===y?C.wrap+1:C.wrap,U={};return U[new x.OverscaledTileID(C.overscaledZ,P,c.z,S,c.y).key]={backfilled:!1},U[new x.OverscaledTileID(C.overscaledZ,F,c.z,O,c.y).key]={backfilled:!1},c.y>0&&(U[new x.OverscaledTileID(C.overscaledZ,P,c.z,S,c.y-1).key]={backfilled:!1},U[new x.OverscaledTileID(C.overscaledZ,C.wrap,c.z,c.x,c.y-1).key]={backfilled:!1},U[new x.OverscaledTileID(C.overscaledZ,F,c.z,O,c.y-1).key]={backfilled:!1}),c.y+1<y&&(U[new x.OverscaledTileID(C.overscaledZ,P,c.z,S,c.y+1).key]={backfilled:!1},U[new x.OverscaledTileID(C.overscaledZ,C.wrap,c.z,c.x,c.y+1).key]={backfilled:!1},U[new x.OverscaledTileID(C.overscaledZ,F,c.z,O,c.y+1).key]={backfilled:!1}),U}unloadTile(C){C.demTexture&&this.map.painter.saveTileTexture(C.demTexture),C.fbo&&(C.fbo.destroy(),delete C.fbo),C.dem&&delete C.dem,delete C.neighboringTiles,C.state="unloaded"}},geojson:class extends x.Evented{constructor(C,c,y,S){super(),this.id=C,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=y.getActor(),this.setEventedParent(S),this._data=c.data,this._options=x.extend({},c),this._collectResourceTiming=c.collectResourceTiming,void 0!==c.maxzoom&&(this.maxzoom=c.maxzoom),c.type&&(this.type=c.type),c.attribution&&(this.attribution=c.attribution),this.promoteId=c.promoteId;const P=x.EXTENT/this.tileSize;this.workerOptions=x.extend({source:this.id,cluster:c.cluster||!1,geojsonVtOptions:{buffer:(void 0!==c.buffer?c.buffer:128)*P,tolerance:(void 0!==c.tolerance?c.tolerance:.375)*P,extent:x.EXTENT,maxZoom:this.maxzoom,lineMetrics:c.lineMetrics||!1,generateId:c.generateId||!1},superclusterOptions:{maxZoom:void 0!==c.clusterMaxZoom?c.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,c.clusterMinPoints||2),extent:x.EXTENT,radius:(void 0!==c.clusterRadius?c.clusterRadius:50)*P,log:!1,generateId:c.generateId||!1},clusterProperties:c.clusterProperties,filter:c.filter},c.workerOptions)}onAdd(C){this.map=C,this.setData(this._data)}setData(C){return this._data=C,this._updateWorkerData(),this}getClusterExpansionZoom(C,c){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:C,source:this.id},c),this}getClusterChildren(C,c){return this.actor.send("geojson.getClusterChildren",{clusterId:C,source:this.id},c),this}getClusterLeaves(C,c,y,S){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:C,limit:c,offset:y},S),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new x.Event("dataloading",{dataType:"source"})),this._loaded=!1;const C=x.extend({},this.workerOptions),c=this._data;"string"==typeof c?(C.request=this.map._requestManager.transformRequest(x.exported.resolveURL(c),x.ResourceType.Source),C.request.collectResourceTiming=this._collectResourceTiming):C.data=JSON.stringify(c),this._pendingLoad=this.actor.send(`${this.type}.loadData`,C,(y,S)=>{if(this._loaded=!0,this._pendingLoad=null,y)this.fire(new x.ErrorEvent(y));else{const P={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&S&&S.resourceTiming&&S.resourceTiming[this.id]&&(P.resourceTiming=S.resourceTiming[this.id]),this.fire(new x.Event("data",P)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(C,c){const y=C.actor?"reloadTile":"loadTile";C.actor=this.actor,C.request=this.actor.send(y,{type:this.type,uid:C.uid,tileID:C.tileID,tileZoom:C.tileZoom,zoom:C.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:x.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(S,P)=>(delete C.request,C.unloadVectorData(),C.aborted?c(null):S?c(S):(C.loadVectorData(P,this.map.painter,"reloadTile"===y),c(null))),void 0,"loadTile"===y)}abortTile(C){C.request&&(C.request.cancel(),delete C.request),C.aborted=!0}unloadTile(C){C.unloadVectorData(),this.actor.send("removeTile",{uid:C.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return x.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends Re{constructor(C,c,y,S){super(C,c,y,S),this.roundZoom=!0,this.type="video",this.options=c}load(){this._loaded=!1;const C=this.options;this.urls=[];for(const c of C.urls)this.urls.push(this.map._requestManager.transformRequest(c,x.ResourceType.Source).url);x.getVideo(this.urls,(c,y)=>{this._loaded=!0,c?this.fire(new x.ErrorEvent(c)):y&&(this.video=y,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(C){if(this.video){const c=this.video.seekable;C<c.start(0)||C>c.end(0)?this.fire(new x.ErrorEvent(new x.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${c.start(0)} and ${c.end(0)}-second mark.`))):this.video.currentTime=C}}getVideo(){return this.video}onAdd(C){this.map||(this.map=C,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(0===Object.keys(this.tiles).length||this.video.readyState<2)return;const C=this.map.painter.context,c=C.gl;this.boundsBuffer||(this.boundsBuffer=C.createVertexBuffer(this._boundsArray,Bs.members)),this.boundsSegments||(this.boundsSegments=x.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE),c.texSubImage2D(c.TEXTURE_2D,0,0,0,c.RGBA,c.UNSIGNED_BYTE,this.video)):(this.texture=new x.Texture(C,this.video,c.RGBA),this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE));for(const y in this.tiles){const S=this.tiles[y];"loaded"!==S.state&&(S.state="loaded",S.texture=this.texture)}}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:Re,canvas:class extends Re{constructor(C,c,y,S){super(C,c,y,S),c.coordinates?Array.isArray(c.coordinates)&&4===c.coordinates.length&&!c.coordinates.some(P=>!Array.isArray(P)||2!==P.length||P.some(O=>"number"!=typeof O))||this.fire(new x.ErrorEvent(new x.ValidationError(`sources.${C}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new x.ErrorEvent(new x.ValidationError(`sources.${C}`,null,'missing required property "coordinates"'))),c.animate&&"boolean"!=typeof c.animate&&this.fire(new x.ErrorEvent(new x.ValidationError(`sources.${C}`,null,'optional "animate" property must be a boolean value'))),c.canvas?"string"==typeof c.canvas||c.canvas instanceof x.window.HTMLCanvasElement||this.fire(new x.ErrorEvent(new x.ValidationError(`sources.${C}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new x.ErrorEvent(new x.ValidationError(`sources.${C}`,null,'missing required property "canvas"'))),this.options=c,this.animate=void 0===c.animate||c.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof x.window.HTMLCanvasElement?this.options.canvas:x.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new x.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(C){this.map=C,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let C=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,C=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,C=!0),this._hasInvalidDimensions()||0===Object.keys(this.tiles).length)return;const c=this.map.painter.context,y=c.gl;this.boundsBuffer||(this.boundsBuffer=c.createVertexBuffer(this._boundsArray,Bs.members)),this.boundsSegments||(this.boundsSegments=x.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(C||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new x.Texture(c,this.canvas,y.RGBA,{premultiply:!0});for(const S in this.tiles){const P=this.tiles[S];"loaded"!==P.state&&(P.state="loaded",P.texture=this.texture)}}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const C of[this.canvas.width,this.canvas.height])if(isNaN(C)||C<=0)return!0;return!1}}},oe=function(C,c,y,S){const P=new Q[c.type](C,c,y,S);if(P.id!==C)throw new Error(`Expected Source id to be ${C} instead of ${P.id}`);return x.bindAll(["load","abort","unload","serialize","prepare"],P),P};function Ae(C,c){const y=x.identity([]);return x.scale$1(y,y,[.5*C.width,.5*-C.height,1]),x.translate(y,y,[1,-1,0]),x.multiply(y,y,C.calculateProjMatrix(c.toUnwrapped()))}function je(C,c,y,S,P,O,F,U=!1){const q=C.tilesIn(S,F,U);q.sort(bt);const Y=[];for(const ie of q)Y.push({wrappedTileID:ie.tile.tileID.wrapped().key,queryResults:ie.tile.queryRenderedFeatures(c,y,C._state,ie,P,O,Ae(C.transform,ie.tile.tileID),U)});const te=function(ie){const se={},we={};for(const Fe of ie){const Ve=Fe.queryResults,nt=Fe.wrappedTileID,Te=we[nt]=we[nt]||{};for(const He in Ve){const Je=Ve[He],ot=Te[He]=Te[He]||{},Xe=se[He]=se[He]||[];for(const Ye of Je)ot[Ye.featureIndex]||(ot[Ye.featureIndex]=!0,Xe.push(Ye))}}return se}(Y);for(const ie in te)te[ie].forEach(se=>{const we=se.feature,Fe=C.getFeatureState(we.layer["source-layer"],we.id);we.source=we.layer.source,we.layer["source-layer"]&&(we.sourceLayer=we.layer["source-layer"]),we.state=Fe});return te}function at(C,c){const y=C.getRenderableIds().map(O=>C.getTileByID(O)),S=[],P={};for(let O=0;O<y.length;O++){const F=y[O],U=F.tileID.canonical.key;P[U]||(P[U]=!0,F.querySourceFeatures(S,c))}return S}function bt(C,c){const y=C.tileID,S=c.tileID;return y.overscaledZ-S.overscaledZ||y.canonical.y-S.canonical.y||y.wrap-S.wrap||y.canonical.x-S.canonical.x}function Ct(){return null!=rr.workerClass?new rr.workerClass:new x.window.Worker(rr.workerUrl)}const ft="mapboxgl_preloaded_worker_pool";class Et{constructor(){this.active={}}acquire(c){if(!this.workers)for(this.workers=[];this.workers.length<Et.workerCount;)this.workers.push(new Ct);return this.active[c]=!0,this.workers.slice()}release(c){delete this.active[c],0===this.numActive()&&(this.workers.forEach(y=>{y.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[ft]}numActive(){return Object.keys(this.active).length}}let Nt;function fn(){return Nt||(Nt=new Et),Nt}function Wt(C,c){const y={};for(const S in C)"ref"!==S&&(y[S]=C[S]);return x.refProperties.forEach(S=>{S in c&&(y[S]=c[S])}),y}function bn(C){C=C.slice();const c=Object.create(null);for(let y=0;y<C.length;y++)c[C[y].id]=C[y];for(let y=0;y<C.length;y++)"ref"in C[y]&&(C[y]=Wt(C[y],c[C[y].ref]));return C}Et.workerCount=2;const tt={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog"};function Vt(C,c,y){y.push({command:tt.addSource,args:[C,c[C]]})}function Wn(C,c,y){c.push({command:tt.removeSource,args:[C]}),y[C]=!0}function zr(C,c,y,S){Wn(C,y,S),Vt(C,c,y)}function lr(C,c,y){let S;for(S in C[y])if(C[y].hasOwnProperty(S)&&"data"!==S&&!Ge(C[y][S],c[y][S]))return!1;for(S in c[y])if(c[y].hasOwnProperty(S)&&"data"!==S&&!Ge(C[y][S],c[y][S]))return!1;return!0}function oi(C,c,y,S,P,O){let F;for(F in c=c||{},C=C||{})C.hasOwnProperty(F)&&(Ge(C[F],c[F])||y.push({command:O,args:[S,F,c[F],P]}));for(F in c)c.hasOwnProperty(F)&&!C.hasOwnProperty(F)&&(Ge(C[F],c[F])||y.push({command:O,args:[S,F,c[F],P]}))}function ir(C){return C.id}function vr(C,c){return C[c.id]=c,C}class ba{constructor(c,y){this.reset(c,y)}reset(c,y){this.points=c||[],this._distances=[0];for(let S=1;S<this.points.length;S++)this._distances[S]=this._distances[S-1]+this.points[S].dist(this.points[S-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(y||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(c){if(1===this.points.length)return this.points[0];c=x.clamp(c,0,1);let y=1,S=this._distances[y];const P=c*this.paddedLength+this.padding;for(;S<P&&y<this._distances.length;)S=this._distances[++y];const O=y-1,F=this._distances[O],U=S-F,q=U>0?(P-F)/U:0;return this.points[O].mult(1-q).add(this.points[y].mult(q))}}class gn{constructor(c,y,S){const P=this.boxCells=[],O=this.circleCells=[];this.xCellCount=Math.ceil(c/S),this.yCellCount=Math.ceil(y/S);for(let F=0;F<this.xCellCount*this.yCellCount;F++)P.push([]),O.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=c,this.height=y,this.xScale=this.xCellCount/c,this.yScale=this.yCellCount/y,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(c,y,S,P,O){this._forEachCell(y,S,P,O,this._insertBoxCell,this.boxUid++),this.boxKeys.push(c),this.bboxes.push(y),this.bboxes.push(S),this.bboxes.push(P),this.bboxes.push(O)}insertCircle(c,y,S,P){this._forEachCell(y-P,S-P,y+P,S+P,this._insertCircleCell,this.circleUid++),this.circleKeys.push(c),this.circles.push(y),this.circles.push(S),this.circles.push(P)}_insertBoxCell(c,y,S,P,O,F){this.boxCells[O].push(F)}_insertCircleCell(c,y,S,P,O,F){this.circleCells[O].push(F)}_query(c,y,S,P,O,F){if(S<0||c>this.width||P<0||y>this.height)return!O&&[];const U=[];if(c<=0&&y<=0&&this.width<=S&&this.height<=P){if(O)return!0;for(let q=0;q<this.boxKeys.length;q++)U.push({key:this.boxKeys[q],x1:this.bboxes[4*q],y1:this.bboxes[4*q+1],x2:this.bboxes[4*q+2],y2:this.bboxes[4*q+3]});for(let q=0;q<this.circleKeys.length;q++){const Y=this.circles[3*q],te=this.circles[3*q+1],ie=this.circles[3*q+2];U.push({key:this.circleKeys[q],x1:Y-ie,y1:te-ie,x2:Y+ie,y2:te+ie})}return F?U.filter(F):U}return this._forEachCell(c,y,S,P,this._queryCell,U,{hitTest:O,seenUids:{box:{},circle:{}}},F),O?U.length>0:U}_queryCircle(c,y,S,P,O){const F=c-S,U=c+S,q=y-S,Y=y+S;if(U<0||F>this.width||Y<0||q>this.height)return!P&&[];const te=[];return this._forEachCell(F,q,U,Y,this._queryCellCircle,te,{hitTest:P,circle:{x:c,y,radius:S},seenUids:{box:{},circle:{}}},O),P?te.length>0:te}query(c,y,S,P,O){return this._query(c,y,S,P,!1,O)}hitTest(c,y,S,P,O){return this._query(c,y,S,P,!0,O)}hitTestCircle(c,y,S,P){return this._queryCircle(c,y,S,!0,P)}_queryCell(c,y,S,P,O,F,U,q){const Y=U.seenUids,te=this.boxCells[O];if(null!==te){const se=this.bboxes;for(const we of te)if(!Y.box[we]){Y.box[we]=!0;const Fe=4*we;if(c<=se[Fe+2]&&y<=se[Fe+3]&&S>=se[Fe+0]&&P>=se[Fe+1]&&(!q||q(this.boxKeys[we]))){if(U.hitTest)return F.push(!0),!0;F.push({key:this.boxKeys[we],x1:se[Fe],y1:se[Fe+1],x2:se[Fe+2],y2:se[Fe+3]})}}}const ie=this.circleCells[O];if(null!==ie){const se=this.circles;for(const we of ie)if(!Y.circle[we]){Y.circle[we]=!0;const Fe=3*we;if(this._circleAndRectCollide(se[Fe],se[Fe+1],se[Fe+2],c,y,S,P)&&(!q||q(this.circleKeys[we]))){if(U.hitTest)return F.push(!0),!0;{const Ve=se[Fe],nt=se[Fe+1],Te=se[Fe+2];F.push({key:this.circleKeys[we],x1:Ve-Te,y1:nt-Te,x2:Ve+Te,y2:nt+Te})}}}}}_queryCellCircle(c,y,S,P,O,F,U,q){const Y=U.circle,te=U.seenUids,ie=this.boxCells[O];if(null!==ie){const we=this.bboxes;for(const Fe of ie)if(!te.box[Fe]){te.box[Fe]=!0;const Ve=4*Fe;if(this._circleAndRectCollide(Y.x,Y.y,Y.radius,we[Ve+0],we[Ve+1],we[Ve+2],we[Ve+3])&&(!q||q(this.boxKeys[Fe])))return F.push(!0),!0}}const se=this.circleCells[O];if(null!==se){const we=this.circles;for(const Fe of se)if(!te.circle[Fe]){te.circle[Fe]=!0;const Ve=3*Fe;if(this._circlesCollide(we[Ve],we[Ve+1],we[Ve+2],Y.x,Y.y,Y.radius)&&(!q||q(this.circleKeys[Fe])))return F.push(!0),!0}}}_forEachCell(c,y,S,P,O,F,U,q){const Y=this._convertToXCellCoord(c),te=this._convertToYCellCoord(y),ie=this._convertToXCellCoord(S),se=this._convertToYCellCoord(P);for(let we=Y;we<=ie;we++)for(let Fe=te;Fe<=se;Fe++)if(O.call(this,c,y,S,P,this.xCellCount*Fe+we,F,U,q))return}_convertToXCellCoord(c){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(c*this.xScale)))}_convertToYCellCoord(c){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(c*this.yScale)))}_circlesCollide(c,y,S,P,O,F){const U=P-c,q=O-y,Y=S+F;return Y*Y>U*U+q*q}_circleAndRectCollide(c,y,S,P,O,F,U){const q=(F-P)/2,Y=Math.abs(c-(P+q));if(Y>q+S)return!1;const te=(U-O)/2,ie=Math.abs(y-(O+te));if(ie>te+S)return!1;if(Y<=q||ie<=te)return!0;const se=Y-q,we=ie-te;return se*se+we*we<=S*S}}const Tr=Math.tan(85*Math.PI/180);function Xn(C,c,y,S,P){const O=x.create$1();return c?(x.scale$1(O,O,[1/P,1/P,1]),y||x.rotateZ(O,O,S.angle)):x.multiply(O,S.labelPlaneMatrix,C),O}function wa(C,c,y,S,P){if(c){const O=x.clone$1(C);return x.scale$1(O,O,[P,P,1]),y||x.rotateZ(O,O,-S.angle),O}return S.glCoordMatrix}function po(C,c,y=0){const S=[C.x,C.y,y,1];y?x.transformMat4(S,S,c):pd(S,S,c);const P=S[3];return{point:new x.pointGeometry(S[0]/P,S[1]/P),signedDistanceFromCamera:P}}function Rn(C,c){return Math.min(.5+C/c*.5,1.5)}function Js(C,c){const y=C[0]/C[3],S=C[1]/C[3];return y>=-c[0]&&y<=c[0]&&S>=-c[1]&&S<=c[1]}function Nr(C,c,y,S,P,O,F,U,q){const Y=S?C.textSizeData:C.iconSizeData,te=x.evaluateSizeForZoom(Y,y.transform.zoom),ie=[256/y.width*2+1,256/y.height*2+1],se=S?C.text.dynamicLayoutVertexArray:C.icon.dynamicLayoutVertexArray;se.clear();const we=C.lineVertexArray,Fe=S?C.text.placedSymbolArray:C.icon.placedSymbolArray,Ve=y.transform.width/y.transform.height;let nt=!1;for(let Te=0;Te<Fe.length;Te++){const He=Fe.get(Te);if(He.writingMode!==x.WritingMode.vertical||nt||0!==Te&&Fe.get(Te-1).writingMode===x.WritingMode.horizontal||(nt=!0),He.hidden||He.writingMode===x.WritingMode.vertical&&!nt){Qs(He.numGlyphs,se);continue}nt=!1;const Je=q?q({x:He.anchorX,y:He.anchorY}):0,ot=[He.anchorX,He.anchorY,Je,1];if(x.transformMat4(ot,ot,c),!Js(ot,ie)){Qs(He.numGlyphs,se);continue}const Xe=Rn(y.transform.cameraToCenterDistance,ot[3]),Ye=x.evaluateSizeForFeature(Y,te,He),$t=F?Ye/Xe:Ye*Xe,qt=new x.pointGeometry(He.anchorX,He.anchorY),Jt=po(qt,P,Je);if(Jt.signedDistanceFromCamera<=0){Qs(He.numGlyphs,se);continue}const et=Jt.point;let xn={};const un=F?null:q,Kn=_r(He,$t,!1,U,c,P,O,C.glyphOffsetArray,we,se,et,qt,xn,Ve,un);nt=Kn.useVertical,un&&Kn.needsFlipping&&(xn={}),(Kn.notEnoughRoom||nt||Kn.needsFlipping&&_r(He,$t,!0,U,c,P,O,C.glyphOffsetArray,we,se,et,qt,xn,Ve,un).notEnoughRoom)&&Qs(He.numGlyphs,se)}S?C.text.dynamicLayoutVertexBuffer.updateData(se):C.icon.dynamicLayoutVertexBuffer.updateData(se)}function Gl(C,c,y,S,P,O,F,U,q,Y,te,ie,se){const we=U.glyphStartIndex+U.numGlyphs,Fe=U.lineStartIndex,Ve=U.lineStartIndex+U.lineLength,nt=c.getoffsetX(U.glyphStartIndex),Te=c.getoffsetX(we-1),He=wu(C*nt,y,S,P,O,F,U.segment,Fe,Ve,q,Y,te,ie,se,!0);if(!He)return null;const Je=wu(C*Te,y,S,P,O,F,U.segment,Fe,Ve,q,Y,te,ie,se,!0);return Je?{first:He,last:Je}:null}function Ea(C,c,y,S){return C.writingMode===x.WritingMode.horizontal&&Math.abs(y.y-c.y)>Math.abs(y.x-c.x)*S?{useVertical:!0}:C.writingMode===x.WritingMode.vertical?c.y<y.y?{needsFlipping:!0}:null:0!==C.flipState&&function(P,O,F){const U=(O.x-P.x)*F;return 0===U||Math.abs((O.y-P.y)/U)>Tr}(c,y,S)?1===C.flipState?{needsFlipping:!0}:null:c.x>y.x?{needsFlipping:!0}:null}function _r(C,c,y,S,P,O,F,U,q,Y,te,ie,se,we,Fe){const Ve=c/24,nt=C.lineOffsetX*Ve,Te=C.lineOffsetY*Ve;let He;if(C.numGlyphs>1){const Je=C.glyphStartIndex+C.numGlyphs,ot=C.lineStartIndex,Xe=C.lineStartIndex+C.lineLength,Ye=Gl(Ve,U,nt,Te,y,te,ie,C,q,O,se,Fe);if(!Ye)return{notEnoughRoom:!0};const $t=po(Ye.first.point,F).point,qt=po(Ye.last.point,F).point;if(S&&!y){const Jt=Ea(C,$t,qt,we);if(C.flipState=Jt&&Jt.needsFlipping?1:2,Jt)return Jt}He=[Ye.first];for(let Jt=C.glyphStartIndex+1;Jt<Je-1;Jt++)He.push(wu(Ve*U.getoffsetX(Jt),nt,Te,y,te,ie,C.segment,ot,Xe,q,O,se,Fe));He.push(Ye.last)}else{if(S&&!y){const ot=po(ie,P).point,Xe=C.lineStartIndex+C.segment+1,Ye=new x.pointGeometry(q.getx(Xe),q.gety(Xe)),$t=po(Ye,P),qt=Ea(C,ot,$t.signedDistanceFromCamera>0?$t.point:Ln(ie,Ye,ot,1,P),we);if(C.flipState=qt&&qt.needsFlipping?1:2,qt)return qt}const Je=wu(Ve*U.getoffsetX(C.glyphStartIndex),nt,Te,y,te,ie,C.segment,C.lineStartIndex,C.lineStartIndex+C.lineLength,q,O,se,Fe);if(!Je)return{notEnoughRoom:!0};He=[Je]}for(const Je of He)x.addDynamicAttributes(Y,Je.point,Je.angle);return{}}function Ln(C,c,y,S,P,O){const F=C.add(C.sub(c)._unit()),U=po(F,P,O?O(F):0).point,q=y.sub(U);return y.add(q._mult(S/q.mag()))}function wu(C,c,y,S,P,O,F,U,q,Y,te,ie,se,we,Fe){const Ve=S?C-c:C+c;let nt=Ve>0?1:-1,Te=0;S&&(nt*=-1,Te=Math.PI),nt<0&&(Te+=Math.PI);let He=nt>0?U+F:U+F+1,Je=P,ot=P,Xe=0,Ye=0;const $t=Math.abs(Ve),qt=[],Jt=[];let et=O;const xn=()=>{const pr=He-nt;return 0===Xe?O:new x.pointGeometry(Y.getx(pr),Y.gety(pr))},un=()=>Ln(xn(),et,ot,$t-Xe+1,te,se);for(;Xe+Ye<=$t;){if(He+=nt,He<U||He>=q)return null;if(ot=Je,qt.push(Je),we&&Jt.push(et||xn()),Je=ie[He],void 0===Je){et=new x.pointGeometry(Y.getx(He),Y.gety(He));const pr=po(et,te,se?se(et):0);Je=pr.signedDistanceFromCamera>0?ie[He]=pr.point:un()}else et=null;Xe+=Ye,Ye=ot.dist(Je)}Fe&&se&&(et=et||new x.pointGeometry(Y.getx(He),Y.gety(He)),ie[He]=Je=void 0===ie[He]?Je:un(),Ye=ot.dist(Je));const Kn=($t-Xe)/Ye,En=Je.sub(ot),wn=En.mult(Kn)._add(ot);y&&wn._add(En._unit()._perp()._mult(y*nt));const Ir=Te+Math.atan2(Je.y-ot.y,Je.x-ot.x);return qt.push(wn),we&&(et=et||new x.pointGeometry(Y.getx(He),Y.gety(He)),Jt.push(function(pr,gi,yi){const uo=1-yi;return new x.pointGeometry(pr.x*uo+gi.x*yi,pr.y*uo+gi.y*yi)}(Jt.length>0?Jt[Jt.length-1]:et,et,Kn))),{point:wn,angle:Ir,path:qt,tilePath:Jt}}const $l=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Qs(C,c){for(let y=0;y<C;y++){const S=c.length;c.resize(S+4),c.float32.set($l,3*S)}}function pd(C,c,y){const S=c[0],P=c[1];return C[0]=y[0]*S+y[4]*P+y[12],C[1]=y[1]*S+y[5]*P+y[13],C[3]=y[3]*S+y[7]*P+y[15],C}const Or=100;class Nn{constructor(c,y,S=new gn(c.width+200,c.height+200,25),P=new gn(c.width+200,c.height+200,25)){this.transform=c,this.grid=S,this.ignoredGrid=P,this.pitchfactor=Math.cos(c._pitch)*c.cameraToCenterDistance,this.screenRightBoundary=c.width+Or,this.screenBottomBoundary=c.height+Or,this.gridRightBoundary=c.width+200,this.gridBottomBoundary=c.height+200,this.fogState=y}placeCollisionBox(c,y,S,P,O,F,U){const q=this.projectAndGetPerspectiveRatio(F,y.anchorPointX,y.anchorPointY,y.elevation,y.tileID),Y=O*q.perspectiveRatio,te=(y.x1*c+S.x-y.padding)*Y+q.point.x,ie=(y.y1*c+S.y-y.padding)*Y+q.point.y,se=(y.x2*c+S.x+y.padding)*Y+q.point.x,we=(y.y2*c+S.y+y.padding)*Y+q.point.y,Fe=q.perspectiveRatio<=.55||q.aboveHorizon;return!this.isInsideGrid(te,ie,se,we)||!P&&this.grid.hitTest(te,ie,se,we,U)||Fe?{box:[],offscreen:!1}:{box:[te,ie,se,we],offscreen:this.isOffscreen(te,ie,se,we)}}placeCollisionCircles(c,y,S,P,O,F,U,q,Y,te,ie,se,we,Fe){const Ve=[],nt=this.transform.elevation,Te=nt?un=>nt.getAtTileOffset(Fe,un.x,un.y):un=>0,He=new x.pointGeometry(y.anchorX,y.anchorY),Je=Te(He),ot=this.projectAndGetPerspectiveRatio(F,He.x,He.y,Je,Fe),{perspectiveRatio:Xe}=ot,Ye=(te?O/Xe:O*Xe)/x.ONE_EM,$t=po(He,U,Je).point,qt=ot.signedDistanceFromCamera>0?Gl(Ye,P,y.lineOffsetX*Ye,y.lineOffsetY*Ye,!1,$t,He,y,S,U,{},nt&&!te?Te:null,te&&!!nt):null;let Jt=!1,et=!1,xn=!0;if(qt&&!ot.aboveHorizon){const un=.5*se*Xe+we,Kn=new x.pointGeometry(-100,-100),En=new x.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),wn=new ba,Ir=qt.first,pr=qt.last;let gi=[];for(let Xr=Ir.path.length-1;Xr>=1;Xr--)gi.push(Ir.path[Xr]);for(let Xr=1;Xr<pr.path.length;Xr++)gi.push(pr.path[Xr]);const yi=2.5*un;if(q){const Xr=gi.map(nt?(bo,es)=>{const Pl=Te(es<Ir.path.length-1?Ir.tilePath[Ir.path.length-1-es]:pr.tilePath[es-Ir.path.length+2]);return po(bo,q,Pl)}:bo=>po(bo,q));gi=Xr.some(bo=>bo.signedDistanceFromCamera<=0)?[]:Xr.map(bo=>bo.point)}let uo=[];if(gi.length>0){const Xr=gi[0].clone(),bo=gi[0].clone();for(let es=1;es<gi.length;es++)Xr.x=Math.min(Xr.x,gi[es].x),Xr.y=Math.min(Xr.y,gi[es].y),bo.x=Math.max(bo.x,gi[es].x),bo.y=Math.max(bo.y,gi[es].y);uo=Xr.x>=Kn.x&&bo.x<=En.x&&Xr.y>=Kn.y&&bo.y<=En.y?[gi]:bo.x<Kn.x||Xr.x>En.x||bo.y<Kn.y||Xr.y>En.y?[]:x.clipLine([gi],Kn.x,Kn.y,En.x,En.y)}for(const Xr of uo){wn.reset(Xr,.25*un);let bo=0;bo=wn.length<=.5*un?1:Math.ceil(wn.paddedLength/yi)+1;for(let es=0;es<bo;es++){const Pl=es/Math.max(bo-1,1),gu=wn.lerp(Pl),Rl=gu.x+Or,Yu=gu.y+Or;Ve.push(Rl,Yu,un,0);const Oc=Rl-un,ts=Yu-un,ns=Rl+un,ui=Yu+un;if(xn=xn&&this.isOffscreen(Oc,ts,ns,ui),et=et||this.isInsideGrid(Oc,ts,ns,ui),!c&&this.grid.hitTestCircle(Rl,Yu,un,ie)&&(Jt=!0,!Y))return{circles:[],offscreen:!1,collisionDetected:Jt}}}}return{circles:!Y&&Jt||!et?[]:Ve,offscreen:xn,collisionDetected:Jt}}queryRenderedSymbols(c){if(0===c.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};const y=[];let S=1/0,P=1/0,O=-1/0,F=-1/0;for(const te of c){const ie=new x.pointGeometry(te.x+Or,te.y+Or);S=Math.min(S,ie.x),P=Math.min(P,ie.y),O=Math.max(O,ie.x),F=Math.max(F,ie.y),y.push(ie)}const U=this.grid.query(S,P,O,F).concat(this.ignoredGrid.query(S,P,O,F)),q={},Y={};for(const te of U){const ie=te.key;if(void 0===q[ie.bucketInstanceId]&&(q[ie.bucketInstanceId]={}),q[ie.bucketInstanceId][ie.featureIndex])continue;const se=[new x.pointGeometry(te.x1,te.y1),new x.pointGeometry(te.x2,te.y1),new x.pointGeometry(te.x2,te.y2),new x.pointGeometry(te.x1,te.y2)];x.polygonIntersectsPolygon(y,se)&&(q[ie.bucketInstanceId][ie.featureIndex]=!0,void 0===Y[ie.bucketInstanceId]&&(Y[ie.bucketInstanceId]=[]),Y[ie.bucketInstanceId].push(ie.featureIndex))}return Y}insertCollisionBox(c,y,S,P,O){(y?this.ignoredGrid:this.grid).insert({bucketInstanceId:S,featureIndex:P,collisionGroupID:O},c[0],c[1],c[2],c[3])}insertCollisionCircles(c,y,S,P,O){const F=y?this.ignoredGrid:this.grid,U={bucketInstanceId:S,featureIndex:P,collisionGroupID:O};for(let q=0;q<c.length;q+=4)F.insertCircle(U,c[q],c[q+1],c[q+2])}projectAndGetPerspectiveRatio(c,y,S,P,O){const F=[y,S,P||0,1];let U=!1;if(P||this.transform.pitch>0){x.transformMat4(F,F,c);let q=!1;this.fogState&&O&&(q=function(Y,te,ie,se,we,Fe){const Ve=Fe.calculateFogTileMatrix(we),nt=[te,ie,se];return x.transformMat4$1(nt,nt,Ve),Oe(Y,nt,Fe.pitch,Fe._fov)}(this.fogState,y,S,P||0,O.toUnwrapped(),this.transform)>.9),U=F[2]>F[3]||q}else pd(F,F,c);return{point:new x.pointGeometry((F[0]/F[3]+1)/2*this.transform.width+Or,(-F[1]/F[3]+1)/2*this.transform.height+Or),perspectiveRatio:Math.min(.5+this.transform.cameraToCenterDistance/F[3]*.5,1.5),signedDistanceFromCamera:F[3],aboveHorizon:U}}isOffscreen(c,y,S,P){return S<Or||c>=this.screenRightBoundary||P<Or||y>this.screenBottomBoundary}isInsideGrid(c,y,S,P){return S>=0&&c<this.gridRightBoundary&&P>=0&&y<this.gridBottomBoundary}getViewportMatrix(){const c=x.identity([]);return x.translate(c,c,[-100,-100,0]),c}}class go{constructor(c,y,S,P){this.opacity=c?Math.max(0,Math.min(1,c.opacity+(c.placed?y:-y))):P&&S?1:0,this.placed=S}isHidden(){return 0===this.opacity&&!this.placed}}class Gu{constructor(c,y,S,P,O){this.text=new go(c?c.text:null,y,S,O),this.icon=new go(c?c.icon:null,y,P,O)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class fr{constructor(c,y,S){this.text=c,this.icon=y,this.skipFade=S}}class Hl{constructor(){this.invProjMatrix=x.create$1(),this.viewportMatrix=x.create$1(),this.circles=[]}}class Oh{constructor(c,y,S,P,O){this.bucketInstanceId=c,this.featureIndex=y,this.sourceLayerIndex=S,this.bucketIndex=P,this.tileID=O}}class ea{constructor(c){this.crossSourceCollisions=c,this.maxGroupID=0,this.collisionGroups={}}get(c){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[c]){const y=++this.maxGroupID;this.collisionGroups[c]={ID:y,predicate:S=>S.collisionGroupID===y}}return this.collisionGroups[c]}}function to(C,c,y,S,P){const{horizontalAlign:O,verticalAlign:F}=x.getAnchorAlignment(C),U=-(O-.5)*c,q=-(F-.5)*y,Y=x.evaluateVariableOffset(C,S);return new x.pointGeometry(U+Y[0]*P,q+Y[1]*P)}function za(C,c,y,S,P){const O=new x.pointGeometry(C,c);return y&&O._rotate(S?P:-P),O}class fc{constructor(c,y,S,P,O){this.transform=c.clone(),this.collisionIndex=new Nn(this.transform,O),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=y,this.retainedQueryData={},this.collisionGroups=new ea(S),this.collisionCircleArrays={},this.prevPlacement=P,P&&(P.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(c,y,S,P){const O=S.getBucket(y),F=S.latestFeatureIndex;if(!O||!F||y.id!==O.layerIds[0])return;const U=S.collisionBoxArray,q=O.layers[0].layout,Y=Math.pow(2,this.transform.zoom-S.tileID.overscaledZ),te=S.tileSize/x.EXTENT,ie=this.transform.calculateProjMatrix(S.tileID.toUnwrapped()),se="map"===q.get("text-pitch-alignment"),we="map"===q.get("text-rotation-alignment"),Fe=Pe(S,1,this.transform.zoom),Ve=Xn(ie,se,we,this.transform,Fe);let nt=null;if(se){const He=wa(ie,se,we,this.transform,Fe);nt=x.multiply([],this.transform.labelPlaneMatrix,He)}this.retainedQueryData[O.bucketInstanceId]=new Oh(O.bucketInstanceId,F,O.sourceLayerIndex,O.index,S.tileID);const Te={bucket:O,layout:q,posMatrix:ie,textLabelPlaneMatrix:Ve,labelToScreenMatrix:nt,scale:Y,textPixelRatio:te,holdingForFade:S.holdingForFade(),collisionBoxArray:U,partiallyEvaluatedTextSize:x.evaluateSizeForZoom(O.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:x.evaluateSizeForZoom(O.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(O.sourceID)};if(P)for(const He of O.sortKeyRanges){const{sortKey:Je,symbolInstanceStart:ot,symbolInstanceEnd:Xe}=He;c.push({sortKey:Je,symbolInstanceStart:ot,symbolInstanceEnd:Xe,parameters:Te})}else c.push({symbolInstanceStart:0,symbolInstanceEnd:O.symbolInstances.length,parameters:Te})}attemptAnchorPlacement(c,y,S,P,O,F,U,q,Y,te,ie,se,we,Fe,Ve,nt,Te,He){const Je=[se.textOffset0,se.textOffset1],ot=to(c,S,P,Je,O),Xe=this.collisionIndex.placeCollisionBox(O,y,za(ot.x,ot.y,F,U,this.transform.angle),ie,q,Y,te.predicate);if((!nt||0!==this.collisionIndex.placeCollisionBox(Fe.getSymbolInstanceIconSize(He,this.transform.zoom,we),nt,za(ot.x,ot.y,F,U,this.transform.angle),ie,q,Y,te.predicate).box.length)&&Xe.box.length>0){let Ye;return this.prevPlacement&&this.prevPlacement.variableOffsets[se.crossTileID]&&this.prevPlacement.placements[se.crossTileID]&&this.prevPlacement.placements[se.crossTileID].text&&(Ye=this.prevPlacement.variableOffsets[se.crossTileID].anchor),this.variableOffsets[se.crossTileID]={textOffset:Je,width:S,height:P,anchor:c,textScale:O,prevAnchor:Ye},this.markUsedJustification(Fe,c,se,Ve),Fe.allowVerticalPlacement&&(this.markUsedOrientation(Fe,Ve,se),this.placedOrientations[se.crossTileID]=Ve),{shift:ot,placedGlyphBoxes:Xe}}}placeLayerBucketPart(c,y,S){const{bucket:P,layout:O,posMatrix:F,textLabelPlaneMatrix:U,labelToScreenMatrix:q,textPixelRatio:Y,holdingForFade:te,collisionBoxArray:ie,partiallyEvaluatedTextSize:se,partiallyEvaluatedIconSize:we,collisionGroup:Fe}=c.parameters,Ve=O.get("text-optional"),nt=O.get("icon-optional"),Te=O.get("text-allow-overlap"),He=O.get("icon-allow-overlap"),Je="map"===O.get("text-rotation-alignment"),ot="map"===O.get("text-pitch-alignment"),Xe="none"!==O.get("icon-text-fit"),Ye="viewport-y"===O.get("symbol-z-order"),$t=Te&&(He||!P.hasIconData()||nt),qt=He&&(Te||!P.hasTextData()||Ve);!P.collisionArrays&&ie&&P.deserializeCollisionBoxes(ie),S&&P.updateCollisionDebugBuffers(this.transform.zoom,ie);const Jt=(et,xn,un)=>{if(y[et.crossTileID])return;if(te)return void(this.placements[et.crossTileID]=new fr(!1,!1,!1));let Kn=!1,En=!1,wn=!0,Ir=null,pr={box:null,offscreen:null},gi={box:null,offscreen:null},yi=null,uo=null,Xr=null,bo=0,es=0,Pl=0;un.textFeatureIndex?bo=un.textFeatureIndex:et.useRuntimeCollisionCircles&&(bo=et.featureIndex),un.verticalTextFeatureIndex&&(es=un.verticalTextFeatureIndex);const gu=ts=>{ts.tileID=this.retainedQueryData[P.bucketInstanceId].tileID,(this.transform.elevation||ts.elevation)&&(ts.elevation=this.transform.elevation?this.transform.elevation.getAtTileOffset(this.retainedQueryData[P.bucketInstanceId].tileID,ts.anchorPointX,ts.anchorPointY):0)},Rl=un.textBox;if(Rl){gu(Rl);const ts=ui=>{let ys=x.WritingMode.horizontal;if(P.allowVerticalPlacement&&!ui&&this.prevPlacement){const Ga=this.prevPlacement.placedOrientations[et.crossTileID];Ga&&(this.placedOrientations[et.crossTileID]=Ga,ys=Ga,this.markUsedOrientation(P,ys,et))}return ys},ns=(ui,ys)=>{if(P.allowVerticalPlacement&&et.numVerticalGlyphVertices>0&&un.verticalTextBox){for(const Ga of P.writingModes)if(Ga===x.WritingMode.vertical?(pr=ys(),gi=pr):pr=ui(),pr&&pr.box&&pr.box.length)break}else pr=ui()};if(O.get("text-variable-anchor")){let ui=O.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[et.crossTileID]){const rs=this.prevPlacement.variableOffsets[et.crossTileID];ui.indexOf(rs.anchor)>0&&(ui=ui.filter($a=>$a!==rs.anchor),ui.unshift(rs.anchor))}const ys=(rs,$a,yc)=>{const Pa=P.getSymbolInstanceTextSize(se,et,this.transform.zoom,xn),Zu=(rs.x2-rs.x1)*Pa+2*rs.padding,Kd=(rs.y2-rs.y1)*Pa+2*rs.padding,Vf=Xe&&!He?$a:null;Vf&&gu(Vf);let Vh={box:[],offscreen:!1};const Fp=Te?2*ui.length:ui.length;for(let Jd=0;Jd<Fp;++Jd){const Uf=this.attemptAnchorPlacement(ui[Jd%ui.length],rs,Zu,Kd,Pa,Je,ot,Y,F,Fe,Jd>=ui.length,et,xn,P,yc,Vf,se,we);if(Uf&&(Vh=Uf.placedGlyphBoxes,Vh&&Vh.box&&Vh.box.length)){Kn=!0,Ir=Uf.shift;break}}return Vh};ns(()=>ys(Rl,un.iconBox,x.WritingMode.horizontal),()=>{const rs=un.verticalTextBox;return rs&&gu(rs),P.allowVerticalPlacement&&!(pr&&pr.box&&pr.box.length)&&et.numVerticalGlyphVertices>0&&rs?ys(rs,un.verticalIconBox,x.WritingMode.vertical):{box:null,offscreen:null}}),pr&&(Kn=pr.box,wn=pr.offscreen);const Ga=ts(pr&&pr.box);if(!Kn&&this.prevPlacement){const rs=this.prevPlacement.variableOffsets[et.crossTileID];rs&&(this.variableOffsets[et.crossTileID]=rs,this.markUsedJustification(P,rs.anchor,et,Ga))}}else{const ui=(ys,Ga)=>{const rs=P.getSymbolInstanceTextSize(se,et,this.transform.zoom,xn),$a=this.collisionIndex.placeCollisionBox(rs,ys,new x.pointGeometry(0,0),Te,Y,F,Fe.predicate);return $a&&$a.box&&$a.box.length&&(this.markUsedOrientation(P,Ga,et),this.placedOrientations[et.crossTileID]=Ga),$a};ns(()=>ui(Rl,x.WritingMode.horizontal),()=>{const ys=un.verticalTextBox;return P.allowVerticalPlacement&&et.numVerticalGlyphVertices>0&&ys?(gu(ys),ui(ys,x.WritingMode.vertical)):{box:null,offscreen:null}}),ts(pr&&pr.box&&pr.box.length)}}if(yi=pr,Kn=yi&&yi.box&&yi.box.length>0,wn=yi&&yi.offscreen,et.useRuntimeCollisionCircles){const ts=P.text.placedSymbolArray.get(et.centerJustifiedTextSymbolIndex>=0?et.centerJustifiedTextSymbolIndex:et.verticalPlacedTextSymbolIndex),ns=x.evaluateSizeForFeature(P.textSizeData,se,ts),ui=O.get("text-padding");uo=this.collisionIndex.placeCollisionCircles(Te,ts,P.lineVertexArray,P.glyphOffsetArray,ns,F,U,q,S,ot,Fe.predicate,et.collisionCircleDiameter,ui,this.retainedQueryData[P.bucketInstanceId].tileID),Kn=Te||uo.circles.length>0&&!uo.collisionDetected,wn=wn&&uo.offscreen}if(un.iconFeatureIndex&&(Pl=un.iconFeatureIndex),un.iconBox){const ts=ns=>{gu(ns);const ui=Xe&&Ir?za(Ir.x,Ir.y,Je,ot,this.transform.angle):new x.pointGeometry(0,0),ys=P.getSymbolInstanceIconSize(we,this.transform.zoom,xn);return this.collisionIndex.placeCollisionBox(ys,ns,ui,He,Y,F,Fe.predicate)};gi&&gi.box&&gi.box.length&&un.verticalIconBox?(Xr=ts(un.verticalIconBox),En=Xr.box.length>0):(Xr=ts(un.iconBox),En=Xr.box.length>0),wn=wn&&Xr.offscreen}const Yu=Ve||0===et.numHorizontalGlyphVertices&&0===et.numVerticalGlyphVertices,Oc=nt||0===et.numIconVertices;if(Yu||Oc?Oc?Yu||(En=En&&Kn):Kn=En&&Kn:En=Kn=En&&Kn,Kn&&yi&&yi.box&&this.collisionIndex.insertCollisionBox(yi.box,O.get("text-ignore-placement"),P.bucketInstanceId,gi&&gi.box&&es?es:bo,Fe.ID),En&&Xr&&this.collisionIndex.insertCollisionBox(Xr.box,O.get("icon-ignore-placement"),P.bucketInstanceId,Pl,Fe.ID),uo&&(Kn&&this.collisionIndex.insertCollisionCircles(uo.circles,O.get("text-ignore-placement"),P.bucketInstanceId,bo,Fe.ID),S)){const ts=P.bucketInstanceId;let ns=this.collisionCircleArrays[ts];void 0===ns&&(ns=this.collisionCircleArrays[ts]=new Hl);for(let ui=0;ui<uo.circles.length;ui+=4)ns.circles.push(uo.circles[ui+0]),ns.circles.push(uo.circles[ui+1]),ns.circles.push(uo.circles[ui+2]),ns.circles.push(uo.collisionDetected?1:0)}this.placements[et.crossTileID]=new fr(Kn||$t,En||qt,wn||P.justReloaded),y[et.crossTileID]=!0};if(Ye){const et=P.getSortedSymbolIndexes(this.transform.angle);for(let xn=et.length-1;xn>=0;--xn){const un=et[xn];Jt(P.symbolInstances.get(un),un,P.collisionArrays[un])}}else for(let et=c.symbolInstanceStart;et<c.symbolInstanceEnd;et++)Jt(P.symbolInstances.get(et),et,P.collisionArrays[et]);if(S&&P.bucketInstanceId in this.collisionCircleArrays){const et=this.collisionCircleArrays[P.bucketInstanceId];x.invert(et.invProjMatrix,F),et.viewportMatrix=this.collisionIndex.getViewportMatrix()}P.justReloaded=!1}markUsedJustification(c,y,S,P){let O;O=P===x.WritingMode.vertical?S.verticalPlacedTextSymbolIndex:{left:S.leftJustifiedTextSymbolIndex,center:S.centerJustifiedTextSymbolIndex,right:S.rightJustifiedTextSymbolIndex}[x.getAnchorJustification(y)];const F=[S.leftJustifiedTextSymbolIndex,S.centerJustifiedTextSymbolIndex,S.rightJustifiedTextSymbolIndex,S.verticalPlacedTextSymbolIndex];for(const U of F)U>=0&&(c.text.placedSymbolArray.get(U).crossTileID=O>=0&&U!==O?0:S.crossTileID)}markUsedOrientation(c,y,S){const P=y===x.WritingMode.horizontal||y===x.WritingMode.horizontalOnly?y:0,O=y===x.WritingMode.vertical?y:0,F=[S.leftJustifiedTextSymbolIndex,S.centerJustifiedTextSymbolIndex,S.rightJustifiedTextSymbolIndex];for(const U of F)c.text.placedSymbolArray.get(U).placedOrientation=P;S.verticalPlacedTextSymbolIndex&&(c.text.placedSymbolArray.get(S.verticalPlacedTextSymbolIndex).placedOrientation=O)}commit(c){this.commitTime=c,this.zoomAtLastRecencyCheck=this.transform.zoom;const y=this.prevPlacement;let S=!1;this.prevZoomAdjustment=y?y.zoomAdjustment(this.transform.zoom):0;const P=y?y.symbolFadeChange(c):1,O=y?y.opacities:{},F=y?y.variableOffsets:{},U=y?y.placedOrientations:{};for(const q in this.placements){const Y=this.placements[q],te=O[q];te?(this.opacities[q]=new Gu(te,P,Y.text,Y.icon),S=S||Y.text!==te.text.placed||Y.icon!==te.icon.placed):(this.opacities[q]=new Gu(null,P,Y.text,Y.icon,Y.skipFade),S=S||Y.text||Y.icon)}for(const q in O){const Y=O[q];if(!this.opacities[q]){const te=new Gu(Y,P,!1,!1);te.isHidden()||(this.opacities[q]=te,S=S||Y.text.placed||Y.icon.placed)}}for(const q in F)this.variableOffsets[q]||!this.opacities[q]||this.opacities[q].isHidden()||(this.variableOffsets[q]=F[q]);for(const q in U)this.placedOrientations[q]||!this.opacities[q]||this.opacities[q].isHidden()||(this.placedOrientations[q]=U[q]);S?this.lastPlacementChangeTime=c:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=y?y.lastPlacementChangeTime:c)}updateLayerOpacities(c,y){const S={};for(const P of y){const O=P.getBucket(c);O&&P.latestFeatureIndex&&c.id===O.layerIds[0]&&this.updateBucketOpacities(O,S,P.collisionBoxArray)}}updateBucketOpacities(c,y,S){c.hasTextData()&&c.text.opacityVertexArray.clear(),c.hasIconData()&&c.icon.opacityVertexArray.clear(),c.hasIconCollisionBoxData()&&c.iconCollisionBox.collisionVertexArray.clear(),c.hasTextCollisionBoxData()&&c.textCollisionBox.collisionVertexArray.clear();const P=c.layers[0].layout,O=new Gu(null,0,!1,!1,!0),F=P.get("text-allow-overlap"),U=P.get("icon-allow-overlap"),q=P.get("text-variable-anchor"),Y="map"===P.get("text-rotation-alignment"),te="map"===P.get("text-pitch-alignment"),ie="none"!==P.get("icon-text-fit"),se=new Gu(null,0,F&&(U||!c.hasIconData()||P.get("icon-optional")),U&&(F||!c.hasTextData()||P.get("text-optional")),!0);!c.collisionArrays&&S&&(c.hasIconCollisionBoxData()||c.hasTextCollisionBoxData())&&c.deserializeCollisionBoxes(S);const we=(Fe,Ve,nt)=>{for(let Te=0;Te<Ve/4;Te++)Fe.opacityVertexArray.emplaceBack(nt)};for(let Fe=0;Fe<c.symbolInstances.length;Fe++){const Ve=c.symbolInstances.get(Fe),{numHorizontalGlyphVertices:nt,numVerticalGlyphVertices:Te,crossTileID:He}=Ve;let Je=this.opacities[He];y[He]?Je=O:Je||(Je=se,this.opacities[He]=Je),y[He]=!0;const ot=Ve.numIconVertices>0,Xe=this.placedOrientations[Ve.crossTileID],Ye=Xe===x.WritingMode.vertical,$t=Xe===x.WritingMode.horizontal||Xe===x.WritingMode.horizontalOnly;if(nt>0||Te>0){const qt=li(Je.text);we(c.text,nt,Ye?Pr:qt),we(c.text,Te,$t?Pr:qt);const Jt=Je.text.isHidden();[Ve.rightJustifiedTextSymbolIndex,Ve.centerJustifiedTextSymbolIndex,Ve.leftJustifiedTextSymbolIndex].forEach(un=>{un>=0&&(c.text.placedSymbolArray.get(un).hidden=Jt||Ye?1:0)}),Ve.verticalPlacedTextSymbolIndex>=0&&(c.text.placedSymbolArray.get(Ve.verticalPlacedTextSymbolIndex).hidden=Jt||$t?1:0);const et=this.variableOffsets[Ve.crossTileID];et&&this.markUsedJustification(c,et.anchor,Ve,Xe);const xn=this.placedOrientations[Ve.crossTileID];xn&&(this.markUsedJustification(c,"left",Ve,xn),this.markUsedOrientation(c,xn,Ve))}if(ot){const qt=li(Je.icon);Ve.placedIconSymbolIndex>=0&&(we(c.icon,Ve.numIconVertices,Ye?Pr:qt),c.icon.placedSymbolArray.get(Ve.placedIconSymbolIndex).hidden=Je.icon.isHidden()),Ve.verticalPlacedIconSymbolIndex>=0&&(we(c.icon,Ve.numVerticalIconVertices,$t?Pr:qt),c.icon.placedSymbolArray.get(Ve.verticalPlacedIconSymbolIndex).hidden=Je.icon.isHidden())}if(c.hasIconCollisionBoxData()||c.hasTextCollisionBoxData()){const qt=c.collisionArrays[Fe];if(qt){let Jt=new x.pointGeometry(0,0);if(qt.textBox||qt.verticalTextBox){let xn=!0;if(q){const un=this.variableOffsets[He];un?(Jt=to(un.anchor,un.width,un.height,un.textOffset,un.textScale),Y&&Jt._rotate(te?this.transform.angle:-this.transform.angle)):xn=!1}qt.textBox&&mo(c.textCollisionBox.collisionVertexArray,Je.text.placed,!xn||Ye,Jt.x,Jt.y),qt.verticalTextBox&&mo(c.textCollisionBox.collisionVertexArray,Je.text.placed,!xn||$t,Jt.x,Jt.y)}const et=Boolean(!$t&&qt.verticalIconBox);qt.iconBox&&mo(c.iconCollisionBox.collisionVertexArray,Je.icon.placed,et,ie?Jt.x:0,ie?Jt.y:0),qt.verticalIconBox&&mo(c.iconCollisionBox.collisionVertexArray,Je.icon.placed,!et,ie?Jt.x:0,ie?Jt.y:0)}}}if(c.sortFeatures(this.transform.angle),this.retainedQueryData[c.bucketInstanceId]&&(this.retainedQueryData[c.bucketInstanceId].featureSortOrder=c.featureSortOrder),c.hasTextData()&&c.text.opacityVertexBuffer&&c.text.opacityVertexBuffer.updateData(c.text.opacityVertexArray),c.hasIconData()&&c.icon.opacityVertexBuffer&&c.icon.opacityVertexBuffer.updateData(c.icon.opacityVertexArray),c.hasIconCollisionBoxData()&&c.iconCollisionBox.collisionVertexBuffer&&c.iconCollisionBox.collisionVertexBuffer.updateData(c.iconCollisionBox.collisionVertexArray),c.hasTextCollisionBoxData()&&c.textCollisionBox.collisionVertexBuffer&&c.textCollisionBox.collisionVertexBuffer.updateData(c.textCollisionBox.collisionVertexArray),c.bucketInstanceId in this.collisionCircleArrays){const Fe=this.collisionCircleArrays[c.bucketInstanceId];c.placementInvProjMatrix=Fe.invProjMatrix,c.placementViewportMatrix=Fe.viewportMatrix,c.collisionCircleArray=Fe.circles,delete this.collisionCircleArrays[c.bucketInstanceId]}}symbolFadeChange(c){return 0===this.fadeDuration?1:(c-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(c){return Math.max(0,(this.transform.zoom-c)/1.5)}hasTransitions(c){return this.stale||c-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(c,y){const S=this.zoomAtLastRecencyCheck===y?1-this.zoomAdjustment(y):1;return this.zoomAtLastRecencyCheck=y,this.commitTime+this.fadeDuration*S>c}setStale(){this.stale=!0}}function mo(C,c,y,S,P){C.emplaceBack(c?1:0,y?1:0,S||0,P||0),C.emplaceBack(c?1:0,y?1:0,S||0,P||0),C.emplaceBack(c?1:0,y?1:0,S||0,P||0),C.emplaceBack(c?1:0,y?1:0,S||0,P||0)}const mn=Math.pow(2,25),xl=Math.pow(2,24),Za=Math.pow(2,17),ql=Math.pow(2,16),gd=Math.pow(2,9),os=Math.pow(2,8),no=Math.pow(2,1);function li(C){if(0===C.opacity&&!C.placed)return 0;if(1===C.opacity&&C.placed)return 4294967295;const c=C.placed?1:0,y=Math.floor(127*C.opacity);return y*mn+c*xl+y*Za+c*ql+y*gd+c*os+y*no+c}const Pr=0;class To{constructor(c){this._sortAcrossTiles="viewport-y"!==c.layout.get("symbol-z-order")&&void 0!==c.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(c,y,S,P,O){const F=this._bucketParts;for(;this._currentTileIndex<c.length;)if(y.getBucketParts(F,P,c[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,O())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,F.sort((U,q)=>U.sortKey-q.sortKey));this._currentPartIndex<F.length;)if(y.placeLayerBucketPart(F[this._currentPartIndex],this._seenCrossTileIDs,S),this._currentPartIndex++,O())return!0;return!1}}class Ic{constructor(c,y,S,P,O,F,U,q){this.placement=new fc(c,O,F,U,q),this._currentPlacementIndex=y.length-1,this._forceFullPlacement=S,this._showCollisionBoxes=P,this._done=!1}isDone(){return this._done}continuePlacement(c,y,S){const P=x.exported.now(),O=()=>{const F=x.exported.now()-P;return!this._forceFullPlacement&&F>2};for(;this._currentPlacementIndex>=0;){const F=y[c[this._currentPlacementIndex]],U=this.placement.collisionIndex.transform.zoom;if("symbol"===F.type&&(!F.minzoom||F.minzoom<=U)&&(!F.maxzoom||F.maxzoom>U)){if(this._inProgressLayer||(this._inProgressLayer=new To(F)),this._inProgressLayer.continuePlacement(S[F.source],this.placement,this._showCollisionBoxes,F,O))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(c){return this.placement.commit(c),this.placement}}const Va=512/x.EXTENT/2;class Xc{constructor(c,y,S){this.tileID=c,this.indexedSymbolInstances={},this.bucketInstanceId=S;for(let P=0;P<y.length;P++){const O=y.get(P),F=O.key;this.indexedSymbolInstances[F]||(this.indexedSymbolInstances[F]=[]),this.indexedSymbolInstances[F].push({crossTileID:O.crossTileID,coord:this.getScaledCoordinates(O,c)})}}getScaledCoordinates(c,y){const S=Va/Math.pow(2,y.canonical.z-this.tileID.canonical.z);return{x:Math.floor((y.canonical.x*x.EXTENT+c.anchorX)*S),y:Math.floor((y.canonical.y*x.EXTENT+c.anchorY)*S)}}findMatches(c,y,S){const P=this.tileID.canonical.z<y.canonical.z?1:Math.pow(2,this.tileID.canonical.z-y.canonical.z);for(let O=0;O<c.length;O++){const F=c.get(O);if(F.crossTileID)continue;const U=this.indexedSymbolInstances[F.key];if(!U)continue;const q=this.getScaledCoordinates(F,y);for(const Y of U)if(Math.abs(Y.coord.x-q.x)<=P&&Math.abs(Y.coord.y-q.y)<=P&&!S[Y.crossTileID]){S[Y.crossTileID]=!0,F.crossTileID=Y.crossTileID;break}}}}class Dn{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Wi{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(c){const y=Math.round((c-this.lng)/360);if(0!==y)for(const S in this.indexes){const P=this.indexes[S],O={};for(const F in P){const U=P[F];U.tileID=U.tileID.unwrapTo(U.tileID.wrap+y),O[U.tileID.key]=U}this.indexes[S]=O}this.lng=c}addBucket(c,y,S){if(this.indexes[c.overscaledZ]&&this.indexes[c.overscaledZ][c.key]){if(this.indexes[c.overscaledZ][c.key].bucketInstanceId===y.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(c.overscaledZ,this.indexes[c.overscaledZ][c.key])}for(let O=0;O<y.symbolInstances.length;O++)y.symbolInstances.get(O).crossTileID=0;this.usedCrossTileIDs[c.overscaledZ]||(this.usedCrossTileIDs[c.overscaledZ]={});const P=this.usedCrossTileIDs[c.overscaledZ];for(const O in this.indexes){const F=this.indexes[O];if(Number(O)>c.overscaledZ)for(const U in F){const q=F[U];q.tileID.isChildOf(c)&&q.findMatches(y.symbolInstances,c,P)}else{const U=F[c.scaledTo(Number(O)).key];U&&U.findMatches(y.symbolInstances,c,P)}}for(let O=0;O<y.symbolInstances.length;O++){const F=y.symbolInstances.get(O);F.crossTileID||(F.crossTileID=S.generate(),P[F.crossTileID]=!0)}return void 0===this.indexes[c.overscaledZ]&&(this.indexes[c.overscaledZ]={}),this.indexes[c.overscaledZ][c.key]=new Xc(c,y.symbolInstances,y.bucketInstanceId),!0}removeBucketCrossTileIDs(c,y){for(const S in y.indexedSymbolInstances)for(const P of y.indexedSymbolInstances[S])delete this.usedCrossTileIDs[c][P.crossTileID]}removeStaleBuckets(c){let y=!1;for(const S in this.indexes){const P=this.indexes[S];for(const O in P)c[P[O].bucketInstanceId]||(this.removeBucketCrossTileIDs(S,P[O]),delete P[O],y=!0)}return y}}class Gr{constructor(){this.layerIndexes={},this.crossTileIDs=new Dn,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(c,y,S){let P=this.layerIndexes[c.id];void 0===P&&(P=this.layerIndexes[c.id]=new Wi);let O=!1;const F={};P.handleWrapJump(S);for(const U of y){const q=U.getBucket(c);q&&c.id===q.layerIds[0]&&(q.bucketInstanceId||(q.bucketInstanceId=++this.maxBucketInstanceId),P.addBucket(U.tileID,q,this.crossTileIDs)&&(O=!0),F[q.bucketInstanceId]=!0)}return P.removeStaleBuckets(F)&&(O=!0),O}pruneUnusedLayers(c){const y={};c.forEach(S=>{y[S]=!0});for(const S in this.layerIndexes)y[S]||delete this.layerIndexes[S]}}const so=(C,c)=>x.emitValidationErrors(C,c&&c.filter(y=>"source.canvas"!==y.identifier)),kh=x.pick(tt,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog"]),Yc=x.pick(tt,["setCenter","setZoom","setBearing","setPitch"]),Do=function(){const C={},c=x.spec.$version;for(const y in x.spec.$root){const S=x.spec.$root[y];if(S.required){let P=null;P="version"===y?c:"array"===S.type?[]:{},null!=P&&(C[y]=P)}}return C}(),Ca={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class zs extends x.Evented{constructor(c,y={}){super(),this.map=c,this.dispatcher=new ht(fn(),this),this.imageManager=new Ne,this.imageManager.setEventedParent(this),this.glyphManager=new x.GlyphManager(c._requestManager,y.localFontFamily?x.LocalGlyphMode.all:y.localIdeographFontFamily?x.LocalGlyphMode.ideographs:x.LocalGlyphMode.none,y.localFontFamily||y.localIdeographFontFamily),this.lineAtlas=new x.LineAtlas(256,512),this.crossTileSymbolIndex=new Gr,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this.zoomHistory=new x.ZoomHistory,this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",x.getReferrer());const S=this;this._rtlTextPluginCallback=zs.registerForPluginStateChange(P=>{S.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:P.pluginStatus,pluginURL:P.pluginURL},(O,F)=>{if(x.triggerPluginCompletionEvent(O),F&&F.every(U=>U))for(const U in S._sourceCaches){const q=S._sourceCaches[U],Y=q.getSource().type;"vector"!==Y&&"geojson"!==Y||q.reload()}})}),this.on("data",P=>{if("source"!==P.dataType||"metadata"!==P.sourceDataType)return;const O=this.getSource(P.sourceId);if(O&&O.vectorLayerIds)for(const F in this._layers){const U=this._layers[F];U.source===O.id&&this._validateLayer(U)}})}loadURL(c,y={}){this.fire(new x.Event("dataloading",{dataType:"style"}));const S="boolean"==typeof y.validate?y.validate:!x.isMapboxURL(c);c=this.map._requestManager.normalizeStyleURL(c,y.accessToken);const P=this.map._requestManager.transformRequest(c,x.ResourceType.Style);this._request=x.getJSON(P,(O,F)=>{this._request=null,O?this.fire(new x.ErrorEvent(O)):F&&this._load(F,S)})}loadJSON(c,y={}){this.fire(new x.Event("dataloading",{dataType:"style"})),this._request=x.exported.frame(()=>{this._request=null,this._load(c,!1!==y.validate)})}loadEmpty(){this.fire(new x.Event("dataloading",{dataType:"style"})),this._load(Do,!1)}_updateLayerCount(c,y){const S=y?1:-1;c.is3D()&&(this._num3DLayers+=S),"circle"===c.type&&(this._numCircleLayers+=S),"symbol"===c.type&&(this._numSymbolLayers+=S)}_load(c,y){if(y&&so(this,x.validateStyle(c)))return;this._loaded=!0,this.stylesheet=c;for(const P in c.sources)this.addSource(P,c.sources[P],{validate:!1});this._changed=!1,c.sprite?this._loadSprite(c.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(c.glyphs);const S=bn(this.stylesheet.layers);this._order=S.map(P=>P.id),this._layers={},this._serializedLayers={};for(let P of S)P=x.createStyleLayer(P),P.setEventedParent(this,{layer:{id:P.id}}),this._layers[P.id]=P,this._serializedLayers[P.id]=P.serialize(),this._updateLayerCount(P,!0);this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new be(this.stylesheet.light),this.stylesheet.terrain&&this._createTerrain(this.stylesheet.terrain),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new x.Event("data",{dataType:"style"})),this.fire(new x.Event("style.load"))}_loadSprite(c){this._spriteRequest=function(y,S,P){let O,F,U;const q=x.exported.devicePixelRatio>1?"@2x":"";let Y=x.getJSON(S.transformRequest(S.normalizeSpriteURL(y,q,".json"),x.ResourceType.SpriteJSON),(se,we)=>{Y=null,U||(U=se,O=we,ie())}),te=x.getImage(S.transformRequest(S.normalizeSpriteURL(y,q,".png"),x.ResourceType.SpriteImage),(se,we)=>{te=null,U||(U=se,F=we,ie())});function ie(){if(U)P(U);else if(O&&F){const se=x.exported.getImageData(F),we={};for(const Fe in O){const{width:Ve,height:nt,x:Te,y:He,sdf:Je,pixelRatio:ot,stretchX:Xe,stretchY:Ye,content:$t}=O[Fe],qt=new x.RGBAImage({width:Ve,height:nt});x.RGBAImage.copy(se,qt,{x:Te,y:He},{x:0,y:0},{width:Ve,height:nt}),we[Fe]={data:qt,pixelRatio:ot,sdf:Je,stretchX:Xe,stretchY:Ye,content:$t}}P(null,we)}}return{cancel(){Y&&(Y.cancel(),Y=null),te&&(te.cancel(),te=null)}}}(c,this.map._requestManager,(y,S)=>{if(this._spriteRequest=null,y)this.fire(new x.ErrorEvent(y));else if(S)for(const P in S)this.imageManager.addImage(P,S[P]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new x.Event("data",{dataType:"style"}))})}_validateLayer(c){const y=this.getSource(c.source);if(!y)return;const S=c.sourceLayer;S&&("geojson"===y.type||y.vectorLayerIds&&-1===y.vectorLayerIds.indexOf(S))&&this.fire(new x.ErrorEvent(new Error(`Source layer "${S}" does not exist on source "${y.id}" as specified by style layer "${c.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const c in this._sourceCaches)if(!this._sourceCaches[c].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(c){const y=[];for(const S of c){const P=this._layers[S];"custom"!==P.type&&y.push(P.serialize())}return y}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const c in this._sourceCaches)if(this._sourceCaches[c].hasTransition())return!0;for(const c in this._layers)if(this._layers[c].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(c){return!!this.terrain&&Ca[c.type]}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(c){if(!this._loaded)return;const y=this._changed;if(this._changed){const P=Object.keys(this._updatedLayers),O=Object.keys(this._removedLayers);(P.length||O.length)&&this._updateWorkerLayers(P,O);for(const F in this._updatedSources){const U=this._updatedSources[F];"reload"===U?this._reloadSource(F):"clear"===U&&this._clearSource(F)}this._updateTilesForChangedImages();for(const F in this._updatedPaintProps)this._layers[F].updateTransitions(c);this.light.updateTransitions(c),this.fog&&this.fog.updateTransitions(c),this._resetUpdates()}const S={};for(const P in this._sourceCaches){const O=this._sourceCaches[P];S[P]=O.used,O.used=!1}for(const P of this._order){const O=this._layers[P];if(O.recalculate(c,this._availableImages),!O.isHidden(c.zoom)){const U=this._getLayerSourceCache(O);U&&(U.used=!0)}const F=this.map.painter;if(F){const U=O.getProgramIds();if(!U)continue;const q=O.getProgramConfiguration(c.zoom);for(const Y of U)F.useProgram(Y,q)}}for(const P in S){const O=this._sourceCaches[P];S[P]!==O.used&&O.getSource().fire(new x.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:O.getSource().id}))}this.light.recalculate(c),this.terrain&&this.terrain.recalculate(c),this.fog&&this.fog.recalculate(c),this.z=c.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),y&&this.fire(new x.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const c=Object.keys(this._changedImages);if(c.length){for(const y in this._sourceCaches)this._sourceCaches[y].reloadTilesForDependencies(["icons","patterns"],c);this._changedImages={}}}_updateWorkerLayers(c,y){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(c),removedIds:y})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(c){if(this._checkLoaded(),so(this,x.validateStyle(c)))return!1;(c=x.clone$2(c)).layers=bn(c.layers);const y=function(P,O){if(!P)return[{command:tt.setStyle,args:[O]}];let F=[];try{if(!Ge(P.version,O.version))return[{command:tt.setStyle,args:[O]}];Ge(P.center,O.center)||F.push({command:tt.setCenter,args:[O.center]}),Ge(P.zoom,O.zoom)||F.push({command:tt.setZoom,args:[O.zoom]}),Ge(P.bearing,O.bearing)||F.push({command:tt.setBearing,args:[O.bearing]}),Ge(P.pitch,O.pitch)||F.push({command:tt.setPitch,args:[O.pitch]}),Ge(P.sprite,O.sprite)||F.push({command:tt.setSprite,args:[O.sprite]}),Ge(P.glyphs,O.glyphs)||F.push({command:tt.setGlyphs,args:[O.glyphs]}),Ge(P.transition,O.transition)||F.push({command:tt.setTransition,args:[O.transition]}),Ge(P.light,O.light)||F.push({command:tt.setLight,args:[O.light]}),Ge(P.fog,O.fog)||F.push({command:tt.setFog,args:[O.fog]});const U={},q=[];!function(ie,se,we,Fe){let Ve;for(Ve in se=se||{},ie=ie||{})ie.hasOwnProperty(Ve)&&(se.hasOwnProperty(Ve)||Wn(Ve,we,Fe));for(Ve in se)se.hasOwnProperty(Ve)&&(ie.hasOwnProperty(Ve)?Ge(ie[Ve],se[Ve])||("geojson"===ie[Ve].type&&"geojson"===se[Ve].type&&lr(ie,se,Ve)?we.push({command:tt.setGeoJSONSourceData,args:[Ve,se[Ve].data]}):zr(Ve,se,we,Fe)):Vt(Ve,se,we))}(P.sources,O.sources,q,U);const Y=[];P.layers&&P.layers.forEach(ie=>{U[ie.source]?F.push({command:tt.removeLayer,args:[ie.id]}):Y.push(ie)});let te=P.terrain;te&&U[te.source]&&(F.push({command:tt.setTerrain,args:[void 0]}),te=void 0),F=F.concat(q),Ge(te,O.terrain)||F.push({command:tt.setTerrain,args:[O.terrain]}),function(ie,se,we){se=se||[];const Fe=(ie=ie||[]).map(ir),Ve=se.map(ir),nt=ie.reduce(vr,{}),Te=se.reduce(vr,{}),He=Fe.slice(),Je=Object.create(null);let ot,Xe,Ye,$t,qt,Jt,et;for(ot=0,Xe=0;ot<Fe.length;ot++)Ye=Fe[ot],Te.hasOwnProperty(Ye)?Xe++:(we.push({command:tt.removeLayer,args:[Ye]}),He.splice(He.indexOf(Ye,Xe),1));for(ot=0,Xe=0;ot<Ve.length;ot++)Ye=Ve[Ve.length-1-ot],He[He.length-1-ot]!==Ye&&(nt.hasOwnProperty(Ye)?(we.push({command:tt.removeLayer,args:[Ye]}),He.splice(He.lastIndexOf(Ye,He.length-Xe),1)):Xe++,Jt=He[He.length-ot],we.push({command:tt.addLayer,args:[Te[Ye],Jt]}),He.splice(He.length-ot,0,Ye),Je[Ye]=!0);for(ot=0;ot<Ve.length;ot++)if(Ye=Ve[ot],$t=nt[Ye],qt=Te[Ye],!Je[Ye]&&!Ge($t,qt))if(Ge($t.source,qt.source)&&Ge($t["source-layer"],qt["source-layer"])&&Ge($t.type,qt.type)){for(et in oi($t.layout,qt.layout,we,Ye,null,tt.setLayoutProperty),oi($t.paint,qt.paint,we,Ye,null,tt.setPaintProperty),Ge($t.filter,qt.filter)||we.push({command:tt.setFilter,args:[Ye,qt.filter]}),Ge($t.minzoom,qt.minzoom)&&Ge($t.maxzoom,qt.maxzoom)||we.push({command:tt.setLayerZoomRange,args:[Ye,qt.minzoom,qt.maxzoom]}),$t)$t.hasOwnProperty(et)&&"layout"!==et&&"paint"!==et&&"filter"!==et&&"metadata"!==et&&"minzoom"!==et&&"maxzoom"!==et&&(0===et.indexOf("paint.")?oi($t[et],qt[et],we,Ye,et.slice(6),tt.setPaintProperty):Ge($t[et],qt[et])||we.push({command:tt.setLayerProperty,args:[Ye,et,qt[et]]}));for(et in qt)qt.hasOwnProperty(et)&&!$t.hasOwnProperty(et)&&"layout"!==et&&"paint"!==et&&"filter"!==et&&"metadata"!==et&&"minzoom"!==et&&"maxzoom"!==et&&(0===et.indexOf("paint.")?oi($t[et],qt[et],we,Ye,et.slice(6),tt.setPaintProperty):Ge($t[et],qt[et])||we.push({command:tt.setLayerProperty,args:[Ye,et,qt[et]]}))}else we.push({command:tt.removeLayer,args:[Ye]}),Jt=He[He.lastIndexOf(Ye)+1],we.push({command:tt.addLayer,args:[qt,Jt]})}(Y,O.layers,F)}catch(U){console.warn("Unable to compute style diff:",U),F=[{command:tt.setStyle,args:[O]}]}return F}(this.serialize(),c).filter(P=>!(P.command in Yc));if(0===y.length)return!1;const S=y.filter(P=>!(P.command in kh));if(S.length>0)throw new Error(`Unimplemented: ${S.map(P=>P.command).join(", ")}.`);return y.forEach(P=>{"setTransition"!==P.command&&this[P.command].apply(this,P.args)}),this.stylesheet=c,!0}addImage(c,y){if(this.getImage(c))return this.fire(new x.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(c,y),this._afterImageUpdated(c)}updateImage(c,y){this.imageManager.updateImage(c,y)}getImage(c){return this.imageManager.getImage(c)}removeImage(c){if(!this.getImage(c))return this.fire(new x.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(c),this._afterImageUpdated(c)}_afterImageUpdated(c){this._availableImages=this.imageManager.listImages(),this._changedImages[c]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new x.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(c,y,S={}){if(this._checkLoaded(),void 0!==this.getSource(c))throw new Error("There is already a source with this ID");if(!y.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(y).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(y.type)>=0&&this._validate(x.validateStyle.source,`sources.${c}`,y,null,S))return;this.map&&this.map._collectResourceTiming&&(y.collectResourceTiming=!0);const P=oe(c,y,this.dispatcher,this);P.setEventedParent(this,()=>({isSourceLoaded:this.loaded(),source:P.serialize(),sourceId:c}));const O=F=>{const U=(F?"symbol:":"other:")+c,q=this._sourceCaches[U]=new x.SourceCache(U,P,F);(F?this._symbolSourceCaches:this._otherSourceCaches)[c]=q,q.style=this,q.onAdd(this.map)};O(!1),"vector"!==y.type&&"geojson"!==y.type||O(!0),P.onAdd&&P.onAdd(this.map),this._changed=!0}removeSource(c){this._checkLoaded();const y=this.getSource(c);if(void 0===y)throw new Error("There is no source with this ID");for(const P in this._layers)if(this._layers[P].source===c)return this.fire(new x.ErrorEvent(new Error(`Source "${c}" cannot be removed while layer "${P}" is using it.`)));if(this.terrain&&this.terrain.get().source===c)return this.fire(new x.ErrorEvent(new Error(`Source "${c}" cannot be removed while terrain is using it.`)));const S=this._getSourceCaches(c);for(const P of S)delete this._sourceCaches[P.id],delete this._updatedSources[P.id],P.fire(new x.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:P.getSource().id})),P.setEventedParent(null),P.clearTiles();delete this._otherSourceCaches[c],delete this._symbolSourceCaches[c],y.setEventedParent(null),y.onRemove&&y.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(c,y){this._checkLoaded(),this.getSource(c).setData(y),this._changed=!0}getSource(c){const y=this._getSourceCache(c);return y&&y.getSource()}addLayer(c,y,S={}){this._checkLoaded();const P=c.id;if(this.getLayer(P))return void this.fire(new x.ErrorEvent(new Error(`Layer with id "${P}" already exists on this map`)));let O;if("custom"===c.type){if(so(this,x.validateCustomStyleLayer(c)))return;O=x.createStyleLayer(c)}else{if("object"==typeof c.source&&(this.addSource(P,c.source),c=x.clone$2(c),c=x.extend(c,{source:P})),this._validate(x.validateStyle.layer,`layers.${P}`,c,{arrayIndex:-1},S))return;O=x.createStyleLayer(c),this._validateLayer(O),O.setEventedParent(this,{layer:{id:P}}),this._serializedLayers[O.id]=O.serialize(),this._updateLayerCount(O,!0)}const F=y?this._order.indexOf(y):this._order.length;if(y&&-1===F)return void this.fire(new x.ErrorEvent(new Error(`Layer with id "${y}" does not exist on this map.`)));this._order.splice(F,0,P),this._layerOrderChanged=!0,this._layers[P]=O;const U=this._getLayerSourceCache(O);if(this._removedLayers[P]&&O.source&&U&&"custom"!==O.type){const q=this._removedLayers[P];delete this._removedLayers[P],q.type!==O.type?this._updatedSources[O.source]="clear":(this._updatedSources[O.source]="reload",U.pause())}this._updateLayer(O),O.onAdd&&O.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(c,y){if(this._checkLoaded(),this._changed=!0,!this._layers[c])return void this.fire(new x.ErrorEvent(new Error(`The layer '${c}' does not exist in the map's style and cannot be moved.`)));if(c===y)return;const S=this._order.indexOf(c);this._order.splice(S,1);const P=y?this._order.indexOf(y):this._order.length;y&&-1===P?this.fire(new x.ErrorEvent(new Error(`Layer with id "${y}" does not exist on this map.`))):(this._order.splice(P,0,c),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(c){this._checkLoaded();const y=this._layers[c];if(!y)return void this.fire(new x.ErrorEvent(new Error(`The layer '${c}' does not exist in the map's style and cannot be removed.`)));y.setEventedParent(null),this._updateLayerCount(y,!1);const S=this._order.indexOf(c);this._order.splice(S,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[c]=y,delete this._layers[c],delete this._serializedLayers[c],delete this._updatedLayers[c],delete this._updatedPaintProps[c],y.onRemove&&y.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(c){return this._layers[c]}hasLayer(c){return c in this._layers}hasLayerType(c){for(const y in this._layers)if(this._layers[y].type===c)return!0;return!1}setLayerZoomRange(c,y,S){this._checkLoaded();const P=this.getLayer(c);P?P.minzoom===y&&P.maxzoom===S||(null!=y&&(P.minzoom=y),null!=S&&(P.maxzoom=S),this._updateLayer(P)):this.fire(new x.ErrorEvent(new Error(`The layer '${c}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(c,y,S={}){this._checkLoaded();const P=this.getLayer(c);if(P){if(!Ge(P.filter,y))return null==y?(P.filter=void 0,void this._updateLayer(P)):void(this._validate(x.validateStyle.filter,`layers.${P.id}.filter`,y,null,S)||(P.filter=x.clone$2(y),this._updateLayer(P)))}else this.fire(new x.ErrorEvent(new Error(`The layer '${c}' does not exist in the map's style and cannot be filtered.`)))}getFilter(c){return x.clone$2(this.getLayer(c).filter)}setLayoutProperty(c,y,S,P={}){this._checkLoaded();const O=this.getLayer(c);O?Ge(O.getLayoutProperty(y),S)||(O.setLayoutProperty(y,S,P),this._updateLayer(O)):this.fire(new x.ErrorEvent(new Error(`The layer '${c}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(c,y){const S=this.getLayer(c);if(S)return S.getLayoutProperty(y);this.fire(new x.ErrorEvent(new Error(`The layer '${c}' does not exist in the map's style.`)))}setPaintProperty(c,y,S,P={}){this._checkLoaded();const O=this.getLayer(c);O?Ge(O.getPaintProperty(y),S)||(O.setPaintProperty(y,S,P)&&this._updateLayer(O),this._changed=!0,this._updatedPaintProps[c]=!0):this.fire(new x.ErrorEvent(new Error(`The layer '${c}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(c,y){return this.getLayer(c).getPaintProperty(y)}setFeatureState(c,y){this._checkLoaded();const S=c.source,P=c.sourceLayer,O=this.getSource(S);if(void 0===O)return void this.fire(new x.ErrorEvent(new Error(`The source '${S}' does not exist in the map's style.`)));const F=O.type;if("geojson"===F&&P)return void this.fire(new x.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if("vector"===F&&!P)return void this.fire(new x.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));void 0===c.id&&this.fire(new x.ErrorEvent(new Error("The feature id parameter must be provided.")));const U=this._getSourceCaches(S);for(const q of U)q.setFeatureState(P,c.id,y)}removeFeatureState(c,y){this._checkLoaded();const S=c.source,P=this.getSource(S);if(void 0===P)return void this.fire(new x.ErrorEvent(new Error(`The source '${S}' does not exist in the map's style.`)));const O=P.type,F="vector"===O?c.sourceLayer:void 0;if("vector"===O&&!F)return void this.fire(new x.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(y&&"string"!=typeof c.id&&"number"!=typeof c.id)return void this.fire(new x.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const U=this._getSourceCaches(S);for(const q of U)q.removeFeatureState(F,c.id,y)}getFeatureState(c){this._checkLoaded();const y=c.source,S=c.sourceLayer,P=this.getSource(y);if(void 0!==P){if("vector"!==P.type||S)return void 0===c.id&&this.fire(new x.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(y)[0].getFeatureState(S,c.id);this.fire(new x.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new x.ErrorEvent(new Error(`The source '${y}' does not exist in the map's style.`)))}getTransition(){return x.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const c={};for(const y in this._sourceCaches){const S=this._sourceCaches[y].getSource();c[S.id]||(c[S.id]=S.serialize())}return x.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.stylesheet.terrain,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:c,layers:this._serializeLayers(this._order)},y=>void 0!==y)}_updateLayer(c){this._updatedLayers[c.id]=!0;const y=this._getLayerSourceCache(c);c.source&&!this._updatedSources[c.source]&&y&&"raster"!==y.getSource().type&&(this._updatedSources[c.source]="reload",y.pause()),this._changed=!0}_flattenAndSortRenderedFeatures(c){const y=F=>"fill-extrusion"===this._layers[F].type,S={},P=[];for(let F=this._order.length-1;F>=0;F--){const U=this._order[F];if(y(U)){S[U]=F;for(const q of c){const Y=q[U];if(Y)for(const te of Y)P.push(te)}}}P.sort((F,U)=>U.intersectionZ-F.intersectionZ);const O=[];for(let F=this._order.length-1;F>=0;F--){const U=this._order[F];if(y(U))for(let q=P.length-1;q>=0;q--){const Y=P[q].feature;if(S[Y.layer.id]<F)break;O.push(Y),P.pop()}else for(const q of c){const Y=q[U];if(Y)for(const te of Y)O.push(te.feature)}}return O}queryRenderedFeatures(c,y,S){y&&y.filter&&this._validate(x.validateStyle.filter,"queryRenderedFeatures.filter",y.filter,null,y);const P={};if(y&&y.layers){if(!Array.isArray(y.layers))return this.fire(new x.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const q of y.layers){const Y=this._layers[q];if(!Y)return this.fire(new x.ErrorEvent(new Error(`The layer '${q}' does not exist in the map's style and cannot be queried for features.`))),[];P[Y.source]=!0}}const O=[];y.availableImages=this._availableImages;const F=y&&y.layers?y.layers.some(q=>{const Y=this.getLayer(q);return Y&&Y.is3D()}):this.has3DLayers(),U=lt.createFromScreenPoints(c,S);for(const q in this._sourceCaches){const Y=this._sourceCaches[q].getSource().id;y.layers&&!P[Y]||O.push(je(this._sourceCaches[q],this._layers,this._serializedLayers,U,y,S,F,!!this.map._showQueryGeometry))}return this.placement&&O.push(function(q,Y,te,ie,se,we,Fe){const Ve={},nt=we.queryRenderedSymbols(ie),Te=[];for(const He of Object.keys(nt).map(Number))Te.push(Fe[He]);Te.sort(bt);for(const He of Te){const Je=He.featureIndex.lookupSymbolFeatures(nt[He.bucketInstanceId],Y,He.bucketIndex,He.sourceLayerIndex,se.filter,se.layers,se.availableImages,q);for(const ot in Je){const Xe=Ve[ot]=Ve[ot]||[],Ye=Je[ot];Ye.sort(($t,qt)=>{const Jt=He.featureSortOrder;if(Jt){const et=Jt.indexOf($t.featureIndex);return Jt.indexOf(qt.featureIndex)-et}return qt.featureIndex-$t.featureIndex});for(const $t of Ye)Xe.push($t)}}for(const He in Ve)Ve[He].forEach(Je=>{const ot=Je.feature,Xe=te(q[He]).getFeatureState(ot.layer["source-layer"],ot.id);ot.source=ot.layer.source,ot.layer["source-layer"]&&(ot.sourceLayer=ot.layer["source-layer"]),ot.state=Xe});return Ve}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),U.screenGeometry,y,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(O)}querySourceFeatures(c,y){y&&y.filter&&this._validate(x.validateStyle.filter,"querySourceFeatures.filter",y.filter,null,y);const S=this._getSourceCaches(c);let P=[];for(const O of S)P=P.concat(at(O,y));return P}addSourceType(c,y,S){return zs.getSourceType(c)?S(new Error(`A source type called "${c}" already exists.`)):(zs.setSourceType(c,y),y.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:c,url:y.workerSourceURL},S):S(null,null))}getLight(){return this.light.getLight()}setLight(c,y={}){this._checkLoaded();const S=this.light.getLight();let P=!1;for(const F in c)if(!Ge(c[F],S[F])){P=!0;break}if(!P)return;const O={now:x.exported.now(),transition:x.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(c,y),this.light.updateTransitions(O)}getTerrain(){return this.terrain?this.terrain.get():null}setTerrain(c){if(this._checkLoaded(),!c)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);if("object"==typeof c.source){const y="terrain-dem-src";this.addSource(y,c.source),c=x.clone$2(c),c=x.extend(c,{source:y})}if(!this._validate(x.validateStyle.terrain,"terrain",c)){if(this.terrain){const y=this.terrain,S=y.get();for(const P in c)if(!Ge(c[P],S[P])){y.set(c),this.stylesheet.terrain=c;const O={now:x.exported.now(),transition:x.extend({duration:0},this.stylesheet.transition)};y.updateTransitions(O);break}}else this._createTerrain(c);this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}}_createFog(c){const y=this.fog=new Ce(c);this.stylesheet.fog=c;const S={now:x.exported.now(),transition:x.extend({duration:0},this.stylesheet.transition)};y.updateTransitions(S)}_updateMarkersOpacity(){0!==this.map._markers.length&&this.map._requestDomTask(()=>{for(const c of this.map._markers)c._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(c){if(this._checkLoaded(),!c)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const y=this.fog,S=y.get();for(const P in c)if(!Ge(c[P],S[P])){y.set(c),this.stylesheet.fog=c;const O={now:x.exported.now(),transition:x.extend({duration:0},this.stylesheet.transition)};y.updateTransitions(O);break}}else this._createFog(c);this._markersNeedUpdate=!0}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const c=this._order.filter(S=>this.isLayerDraped(this._layers[S])),y=this._order.filter(S=>!this.isLayerDraped(this._layers[S]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...c),this._drapedFirstOrder.push(...y)}_createTerrain(c){const y=this.terrain=new ze(c);this.stylesheet.terrain=c,this.dispatcher.broadcast("enableTerrain",!0),this._force3DLayerUpdate();const S={now:x.exported.now(),transition:x.extend({duration:0},this.stylesheet.transition)};y.updateTransitions(S)}_force3DLayerUpdate(){for(const c in this._layers){const y=this._layers[c];"fill-extrusion"===y.type&&this._updateLayer(y)}}_validate(c,y,S,P,O={}){return(!O||!1!==O.validate)&&so(this,c.call(x.validateStyle,x.extend({key:y,style:this.serialize(),value:S,styleSpec:x.spec},P)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),x.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const c in this._layers)this._layers[c].setEventedParent(null);for(const c in this._sourceCaches)this._sourceCaches[c].clearTiles(),this._sourceCaches[c].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(c){const y=this._getSourceCaches(c);for(const S of y)S.clearTiles()}_reloadSource(c){const y=this._getSourceCaches(c);for(const S of y)S.resume(),S.reload()}_updateSources(c){for(const y in this._sourceCaches)this._sourceCaches[y].update(c)}_generateCollisionBoxes(){for(const c in this._sourceCaches){const y=this._sourceCaches[c];y.resume(),y.reload()}}_updatePlacement(c,y,S,P,O=!1){let F=!1,U=!1;const q={};for(const Y of this._order){const te=this._layers[Y];if("symbol"!==te.type)continue;if(!q[te.source]){const se=this._getLayerSourceCache(te);if(!se)continue;q[te.source]=se.getRenderableIds(!0).map(we=>se.getTileByID(we)).sort((we,Fe)=>Fe.tileID.overscaledZ-we.tileID.overscaledZ||(we.tileID.isLessThan(Fe.tileID)?-1:1))}const ie=this.crossTileSymbolIndex.addLayer(te,q[te.source],c.center.lng);F=F||ie}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),O=O||this._layerOrderChanged||0===S,this._layerOrderChanged&&this.fire(new x.Event("neworder")),(O||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(x.exported.now(),c.zoom))&&(this.pauseablePlacement=new Ic(c,this._order,O,y,S,P,this.placement,this.fog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,q),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(x.exported.now()),U=!0),F&&this.pauseablePlacement.placement.setStale()),U||F)for(const Y of this._order){const te=this._layers[Y];"symbol"===te.type&&this.placement.updateLayerOpacities(te,q[te.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(x.exported.now())}_releaseSymbolFadeTiles(){for(const c in this._sourceCaches)this._sourceCaches[c].releaseSymbolFadeTiles()}getImages(c,y,S){this.imageManager.getImages(y.icons,S),this._updateTilesForChangedImages();const P=O=>{O&&O.setDependencies(y.tileID.key,y.type,y.icons)};P(this._otherSourceCaches[y.source]),P(this._symbolSourceCaches[y.source])}getGlyphs(c,y,S){this.glyphManager.getGlyphs(y.stacks,S)}getResource(c,y,S){return x.makeRequest(y,S)}_getSourceCache(c){return this._otherSourceCaches[c]}_getLayerSourceCache(c){return"symbol"===c.type?this._symbolSourceCaches[c.source]:this._otherSourceCaches[c.source]}_getSourceCaches(c){const y=[];return this._otherSourceCaches[c]&&y.push(this._otherSourceCaches[c]),this._symbolSourceCaches[c]&&y.push(this._symbolSourceCaches[c]),y}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}}zs.getSourceType=function(C){return Q[C]},zs.setSourceType=function(C,c){Q[C]=c},zs.registerForPluginStateChange=x.registerForPluginStateChange;var Sa="\n#define EPSILON 0.0000001\n#define PI 3.141592653589793\n#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}\n#endif",bl="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}";let wl={},or={};wl=ur("","\n#define ELEVATION_SCALE 7.0\n#define ELEVATION_OFFSET 450.0\n#ifdef TERRAIN\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nuniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;\n#else\nuniform sampler2D u_dem;uniform sampler2D u_dem_prev;\n#endif\nuniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));\n#ifdef TERRAIN_DEM_NEAREST_FILTER\nreturn u_exaggeration*tl;\n#endif\nfloat tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}float prevElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}\n#ifdef TERRAIN_VERTEX_MORPHING\nfloat elevation(vec2 apos) {float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}\n#else\nfloat elevation(vec2 apos) {return currentElevation(apos);}\n#endif\nfloat unpack_depth(vec4 rgba_depth)\n{const vec4 bit_shift=vec4(1.0/(256.0*256.0*256.0),1.0/(256.0*256.0),1.0/256.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(\nunpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))\n);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nfloat tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;\n#else\nvec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);\n#endif\nreturn vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;vec4 bounds=vec4(d,vec2(1.0)-d);h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}\n#else\nfloat elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }\n#endif",!0),or=ur("#ifdef FOG\nuniform float u_fog_temporal_offset;float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}\n#endif","#ifdef FOG\nuniform mat4 u_fog_matrix;vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}\n#endif",!0);const Xi=ur("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nhighp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}","#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(\nunpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered."),Zc=Sa;var ss={background:ur("uniform vec4 u_color;uniform float u_opacity;void main() {vec4 out_color=u_color;\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),backgroundPattern:ur("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_mix);\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),circle:ur("varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(\nantialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)\n);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef FOG\nout_color=fog_apply_premultiplied(out_color,v_fog_pos);\n#endif\ngl_FragColor=out_color*(v_visibility*opacity_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","#define NUM_VISIBILITY_RINGS 2\n#define INV_SQRT2 0.70710678\n#define ELEVATION_BIAS 0.0001\n#define NUM_SAMPLES_PER_RING 16\nuniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {\n#if defined(TERRAIN)\nreturn elevation(pos)+ELEVATION_BIAS;\n#else\nreturn 0.0;\n#endif\n}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);\n#ifdef PITCH_WITH_MAP\nreturn u_matrix*( world_center+vec4(sample_offset,0,0) );\n#else\nreturn projected_center+vec4(sample_offset,0,0);\n#endif\n}float get_sample_step() {\n#ifdef PITCH_WITH_MAP\nreturn 2.0*PI/float(NUM_SAMPLES_PER_RING);\n#else\nreturn PI/float(NUM_SAMPLES_PER_RING);\n#endif\n}void main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float height=circle_elevation(circle_center);vec4 world_center=vec4(circle_center,height,1);vec4 projected_center=u_matrix*world_center;float view_scale=0.0;\n#ifdef PITCH_WITH_MAP\n#ifdef SCALE_WITH_MAP\nview_scale=1.0;\n#else\nview_scale=projected_center.w/u_camera_to_center_distance;\n#endif\n#else\n#ifdef SCALE_WITH_MAP\nview_scale=u_camera_to_center_distance;\n#else\nview_scale=projected_center.w;\n#endif\n#endif\ngl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale);float visibility=0.0;\n#ifdef TERRAIN\nfloat step=get_sample_step();\n#ifdef PITCH_WITH_MAP\nfloat cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);vec4 occlusion_world_center=vec4(circle_center,cantilevered_height,1);vec4 occlusion_projected_center=u_matrix*occlusion_world_center;\n#else\nvec4 occlusion_world_center=world_center;vec4 occlusion_projected_center=projected_center;\n#endif\nfor(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);\n#else\nvisibility=1.0;\n#endif\nv_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);\n#ifdef FOG\nv_fog_pos=fog_position(world_center.xyz);\n#endif\n}"),clippingMask:ur("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:ur("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef FOG\ngl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec3 pos=vec3(floor(a_pos*0.5)+extrude,elevation(floor(a_pos*0.5)));gl_Position=u_matrix*vec4(pos,1);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),heatmapTexture:ur("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:ur("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=u_matrix*vec4(a_pos,elevation(a_pos),1.0);gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:ur("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(\nmix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:ur("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);}"),fill:ur("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\nvec4 out_color=color;\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutline:ur("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutlinePattern:ur("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=mix(color1,color2,u_fade);\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillPattern:ur("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_fade);\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillExtrusion:ur("varying vec4 v_color;void main() {vec4 color=v_color;\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;varying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;\n#ifdef TERRAIN\nvec2 centroid_pos=a_centroid_pos;bool flat_roof=centroid_pos.x !=0.0;float ele=elevation(pos_nx.xy);float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);vec3 pos=vec3(pos_nx.xy,h);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);\n#else\nvec3 pos=vec3(pos_nx.xy,t > 0.0 ? height : base);gl_Position=u_matrix*vec4(pos,1);\n#endif\nfloat colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.rgb+=clamp(color.rgb*directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),fillExtrusionPattern:ur("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_fade);out_color=out_color*v_lighting;\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;\n#ifdef TERRAIN\nvec2 centroid_pos=a_centroid_pos;bool flat_roof=centroid_pos.x !=0.0;float ele=elevation(pos_nx.xy);float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);vec3 p=vec3(pos_nx.xy,h);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);\n#else\nvec3 p=vec3(pos_nx.xy,z);gl_Position=u_matrix*vec4(p,1);\n#endif\nvec2 pos=normal.z==1.0\n? pos_nx.xy\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;\n#ifdef FOG\nv_fog_pos=fog_position(p);\n#endif\n}"),hillshadePrepare:ur("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nreturn texture2D(u_image,coord).a/4.0;\n#else\nvec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;\n#endif\n}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos);float f=getElevation(v_pos+vec2(epsilon.x,0));float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float h=getElevation(v_pos+vec2(0,epsilon.y));float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(\n(c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c)\n)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(\nderiv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:ur("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef FOG\ngl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),line:ur("uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 out_color=color;\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\nv_width2=vec2(outset,inset);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),lineGradient:ur("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\nv_width2=vec2(outset,inset);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),linePattern:ur("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),lineSDF:ur("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_mix;uniform vec3 u_scale;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash_from\n#pragma mapbox: define lowp vec4 dash_to\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 dash_from\n#pragma mapbox: initialize mediump vec4 dash_to\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfwidth=min(dash_from.z*u_scale.y,dash_to.z*u_scale.z);float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/sdfwidth;alpha*=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);vec4 out_color=color;\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define EXTRUDE_SCALE 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform vec2 u_texsize;uniform mediump vec3 u_scale;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash_from\n#pragma mapbox: define lowp vec4 dash_to\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 dash_from\n#pragma mapbox: initialize mediump vec4 dash_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\nfloat tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;float scaleA=dash_from.z==0.0 ? 0.0 : tileZoomRatio/(dash_from.z*fromScale);float scaleB=dash_to.z==0.0 ? 0.0 : tileZoomRatio/(dash_to.z*toScale);float heightA=dash_from.y;float heightB=dash_to.y;v_tex_a=vec2(a_linesofar*scaleA/floorwidth,(-normal.y*heightA+dash_from.x+0.5)/u_texsize.y);v_tex_b=vec2(a_linesofar*scaleB/floorwidth,(-normal.y*heightB+dash_to.x+0.5)/u_texsize.y);v_width2=vec2(outset,inset);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),raster:ur("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(\ndot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);\n#ifdef FOG\nout_color=fog_dither(fog_apply(out_color,v_fog_pos));\n#endif\ngl_FragColor=vec4(out_color*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),symbolIcon:ur("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}float h=elevation(a_pos);vec4 projectedPoint=u_matrix*vec4(a_pos,h,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),h,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h,1.0);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0);\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\nfloat occlusion_fade=occlusionFade(projectedPoint);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projectedPoint.w <=0.0 || occlusion_fade==0.0));v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));}"),symbolSDF:ur("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}float h=elevation(a_pos);vec4 projectedPoint=u_matrix*vec4(a_pos,h,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),h,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h,1.0);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\nfloat occlusion_fade=occlusionFade(projectedPoint);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projectedPoint.w <=0.0 || occlusion_fade==0.0));float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}"),symbolTextAndIcon:ur("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}float h=elevation(a_pos);vec4 projectedPoint=u_matrix*vec4(a_pos,h,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),h,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h,1.0);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale);\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\nfloat occlusion_fade=occlusionFade(projectedPoint);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projectedPoint.w <=0.0 || occlusion_fade==0.0));float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}"),terrainRaster:ur("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\nvoid main() {vec4 color=texture2D(u_image0,v_pos0);\n#ifdef FOG\ncolor=fog_dither(fog_apply_from_vert(color,v_fog_opacity));\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\nconst float skirtOffset=24575.0;const float wireframeOffset=0.00015;void main() {v_pos0=a_texture_pos/8192.0;float skirt=float(a_pos.x >=skirtOffset);float elevation=elevation(a_texture_pos)-skirt*u_skirt_height;\n#ifdef TERRAIN_WIREFRAME\nelevation+=u_skirt_height*u_skirt_height*wireframeOffset;\n#endif\nvec2 decodedPos=a_pos-vec2(skirt*skirtOffset,0.0);gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);\n#ifdef FOG\nv_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));\n#endif\n}"),terrainDepth:ur("#ifdef GL_ES\nprecision highp float;\n#endif\nvec4 pack_depth(float ndc_z) {float depth=ndc_z*0.5+0.5;const vec4 bit_shift=vec4(256.0*256.0*256.0,256.0*256.0,256.0,1.0);const vec4 bit_mask =vec4(0.0,1.0/256.0,1.0/256.0,1.0/256.0);vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}varying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying float v_depth;void main() {float elevation=elevation(a_texture_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:ur("\nvarying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(\ncos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;\n#ifdef FOG\nsky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);\n#endif\nsky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",bl),skyboxGradient:ur("varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));\n#ifdef FOG\ncolor.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;\n#endif\ncolor*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",bl),skyboxCapture:ur("\nvarying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;\n#ifdef GL_ES\nprecision highp float;\n#endif\n#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)\n#define BETA_M                  vec3(21e-6,21e-6,21e-6)\n#define MIE_G                   0.76\n#define DENSITY_HEIGHT_SCALE_R  8000.0\n#define DENSITY_HEIGHT_SCALE_M  1200.0\n#define PLANET_RADIUS           6360e3\n#define ATMOSPHERE_RADIUS       6420e3\n#define SAMPLE_STEPS            10\n#define DENSITY_STEPS           4\nfloat ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}","attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}")};function ur(C,c,y){const S=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,P=/uniform (highp |mediump |lowp )?([\w]+) ([\w]+)([\s]*)([\w]*)/g,O=c.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),F=C.match(P),U=c.match(P),q=Sa.match(P);let Y=U?U.concat(F):F;y||(wl.staticUniforms&&(Y=wl.staticUniforms.concat(Y)),or.staticUniforms&&(Y=or.staticUniforms.concat(Y))),Y&&(Y=Y.concat(q));const te={};return{fragmentSource:C=C.replace(S,(ie,se,we,Fe,Ve)=>(te[Ve]=!0,"define"===se?`\n#ifndef HAS_UNIFORM_u_${Ve}\nvarying ${we} ${Fe} ${Ve};\n#else\nuniform ${we} ${Fe} u_${Ve};\n#endif\n`:`\n#ifdef HAS_UNIFORM_u_${Ve}\n    ${we} ${Fe} ${Ve} = u_${Ve};\n#endif\n`)),vertexSource:c=c.replace(S,(ie,se,we,Fe,Ve)=>{const nt="float"===Fe?"vec2":"vec4",Te=Ve.match(/color/)?"color":nt;return te[Ve]?"define"===se?`\n#ifndef HAS_UNIFORM_u_${Ve}\nuniform lowp float u_${Ve}_t;\nattribute ${we} ${nt} a_${Ve};\nvarying ${we} ${Fe} ${Ve};\n#else\nuniform ${we} ${Fe} u_${Ve};\n#endif\n`:"vec4"===Te?`\n#ifndef HAS_UNIFORM_u_${Ve}\n    ${Ve} = a_${Ve};\n#else\n    ${we} ${Fe} ${Ve} = u_${Ve};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${Ve}\n    ${Ve} = unpack_mix_${Te}(a_${Ve}, u_${Ve}_t);\n#else\n    ${we} ${Fe} ${Ve} = u_${Ve};\n#endif\n`:"define"===se?`\n#ifndef HAS_UNIFORM_u_${Ve}\nuniform lowp float u_${Ve}_t;\nattribute ${we} ${nt} a_${Ve};\n#else\nuniform ${we} ${Fe} u_${Ve};\n#endif\n`:"vec4"===Te?`\n#ifndef HAS_UNIFORM_u_${Ve}\n    ${we} ${Fe} ${Ve} = a_${Ve};\n#else\n    ${we} ${Fe} ${Ve} = u_${Ve};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${Ve}\n    ${we} ${Fe} ${Ve} = unpack_mix_${Te}(a_${Ve}, u_${Ve}_t);\n#else\n    ${we} ${Fe} ${Ve} = u_${Ve};\n#endif\n`}),staticAttributes:O,staticUniforms:Y}}class hs{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(c,y,S,P,O,F,U,q){this.context=c;let Y=this.boundPaintVertexBuffers.length!==P.length;for(let te=0;!Y&&te<P.length;te++)this.boundPaintVertexBuffers[te]!==P[te]&&(Y=!0);c.extVertexArrayObject&&this.vao&&this.boundProgram===y&&this.boundLayoutVertexBuffer===S&&!Y&&this.boundIndexBuffer===O&&this.boundVertexOffset===F&&this.boundDynamicVertexBuffer===U&&this.boundDynamicVertexBuffer2===q?(c.bindVertexArrayOES.set(this.vao),U&&U.bind(),O&&O.dynamicDraw&&O.bind(),q&&q.bind()):this.freshBind(y,S,P,O,F,U,q)}freshBind(c,y,S,P,O,F,U){let q;const Y=c.numAttributes,te=this.context,ie=te.gl;if(te.extVertexArrayObject)this.vao&&this.destroy(),this.vao=te.extVertexArrayObject.createVertexArrayOES(),te.bindVertexArrayOES.set(this.vao),q=0,this.boundProgram=c,this.boundLayoutVertexBuffer=y,this.boundPaintVertexBuffers=S,this.boundIndexBuffer=P,this.boundVertexOffset=O,this.boundDynamicVertexBuffer=F,this.boundDynamicVertexBuffer2=U;else{q=te.currentNumAttributes||0;for(let se=Y;se<q;se++)ie.disableVertexAttribArray(se)}y.enableAttributes(ie,c);for(const se of S)se.enableAttributes(ie,c);F&&F.enableAttributes(ie,c),U&&U.enableAttributes(ie,c),y.bind(),y.setVertexAttribPointers(ie,c,O);for(const se of S)se.bind(),se.setVertexAttribPointers(ie,c,O);F&&(F.bind(),F.setVertexAttribPointers(ie,c,O)),P&&P.bind(),U&&(U.bind(),U.setVertexAttribPointers(ie,c,O)),te.currentNumAttributes=Y}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function ll(C,c){const y=Math.pow(2,c.canonical.z),S=c.canonical.y;return[new x.MercatorCoordinate(0,S/y).toLngLat().lat,new x.MercatorCoordinate(0,(S+1)/y).toLngLat().lat]}function ul(C,c,y,S,P,O,F){const U=C.context,q=U.gl,Y=y.fbo;if(!Y)return;C.prepareDrawTile(c);const te=C.useProgram("hillshade");U.activeTexture.set(q.TEXTURE0),q.bindTexture(q.TEXTURE_2D,Y.colorAttachment.get());const ie=((se,we,Fe,Ve)=>{const nt=Fe.paint.get("hillshade-shadow-color"),Te=Fe.paint.get("hillshade-highlight-color"),He=Fe.paint.get("hillshade-accent-color");let Je=Fe.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===Fe.paint.get("hillshade-illumination-anchor")&&(Je-=se.transform.angle);const ot=!se.options.moving;return{u_matrix:Ve||se.transform.calculateProjMatrix(we.tileID.toUnwrapped(),ot),u_image:0,u_latrange:ll(0,we.tileID),u_light:[Fe.paint.get("hillshade-exaggeration"),Je],u_shadow:nt,u_highlight:Te,u_accent:He}})(C,y,S,C.terrain?c.projMatrix:null);C.prepareDrawProgram(U,te,c.toUnwrapped()),te.draw(U,q.TRIANGLES,P,O,F,x.CullFaceMode.disabled,ie,S.id,C.rasterBoundsBuffer,C.quadTriangleIndexBuffer,C.rasterBoundsSegments)}function $u(C,c,y){if(!c.needsDEMTextureUpload)return;const S=C.context,P=S.gl;S.pixelStoreUnpackPremultiplyAlpha.set(!1),c.demTexture=c.demTexture||C.getTileTexture(y.stride);const O=y.getPixels();c.demTexture?c.demTexture.update(O,{premultiply:!1}):c.demTexture=new x.Texture(S,O,P.RGBA,{premultiply:!1}),c.needsDEMTextureUpload=!1}function Lh(C,c,y,S,P,O){const F=C.context,U=F.gl;if(!c.dem)return;const q=c.dem;if(F.activeTexture.set(U.TEXTURE1),$u(C,c,q),!c.demTexture)return;c.demTexture.bind(U.NEAREST,U.CLAMP_TO_EDGE);const Y=q.dim;F.activeTexture.set(U.TEXTURE0);let te=c.fbo;if(!te){const ie=new x.Texture(F,{width:Y,height:Y,data:null},U.RGBA);ie.bind(U.LINEAR,U.CLAMP_TO_EDGE),te=c.fbo=F.createFramebuffer(Y,Y,!0),te.colorAttachment.set(ie.texture)}F.bindFramebuffer.set(te.framebuffer),F.viewport.set([0,0,Y,Y]),C.useProgram("hillshadePrepare").draw(F,U.TRIANGLES,S,P,O,x.CullFaceMode.disabled,((ie,se)=>{const we=se.stride,Fe=x.create$1();return x.ortho(Fe,0,x.EXTENT,-x.EXTENT,0,0,1),x.translate(Fe,Fe,[0,-x.EXTENT,0]),{u_matrix:Fe,u_image:1,u_dimension:[we,we],u_zoom:ie.overscaledZ,u_unpack:se.unpackVector}})(c.tileID,q),y.id,C.rasterBoundsBuffer,C.quadTriangleIndexBuffer,C.rasterBoundsSegments),c.needsHillshadePrepare=!1}const xr=(C,c)=>({u_matrix:new x.UniformMatrix4f(C,c.u_matrix),u_image0:new x.Uniform1i(C,c.u_image0),u_skirt_height:new x.Uniform1f(C,c.u_skirt_height)}),Ts=(C,c)=>({u_matrix:C,u_image0:0,u_skirt_height:c}),Wl=new class{constructor(){this.operations={}}newMorphing(C,c,y,S,P){if(C in this.operations){const O=this.operations[C];O.to.tileID.key!==y.tileID.key&&(O.queued=y)}else this.operations[C]={startTime:S,phase:0,duration:P,from:c,to:y,queued:null}}getMorphValuesForProxy(C){if(!(C in this.operations))return null;const c=this.operations[C];return{from:c.from,to:c.to,phase:c.phase}}update(C){for(const c in this.operations){const y=this.operations[c];for(y.phase=(C-y.startTime)/y.duration;y.phase>=1||!this._validOp(y);)if(!this._nextOp(y,C)){delete this.operations[c];break}}}_nextOp(C,c){return!!C.queued&&(C.from=C.to,C.to=C.queued,C.queued=null,C.phase=0,C.startTime=c,!0)}_validOp(C){return C.from.hasData()&&C.to.hasData()}},Vs={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function pc(C,c){const y=1<<C.z;return!c&&(0===C.x||C.x===y-1)||0===C.y||C.y===y-1}const jr=C=>({u_matrix:C});function Kc(C,c,y,S,P){if(P>0){const O=x.exported.now(),F=(O-C.timeAdded)/P,U=c?(O-c.timeAdded)/P:-1,q=y.getSource(),Y=S.coveringZoomLevel({tileSize:q.tileSize,roundZoom:q.roundZoom}),te=!c||Math.abs(c.tileID.overscaledZ-Y)>Math.abs(C.tileID.overscaledZ-Y),ie=te&&C.refreshedUponExpiration?1:x.clamp(te?F:1-U,0,1);return C.refreshedUponExpiration&&F>=1&&(C.refreshedUponExpiration=!1),c?{opacity:1,mix:1-ie}:{opacity:ie,mix:0}}return{opacity:1,mix:0}}class as extends x.SourceCache{constructor(c){const y=oe("proxy",{type:"geojson",maxzoom:c.transform.maxZoom},new ht(fn(),null),c.style);super("proxy",y,!1),y.setEventedParent(this),this.map=this.getSource().map=c,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(c,y,S){if(c.freezeTileCoverage)return;this.transform=c;const P=c.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((O,F)=>{if(O[F.key]="",!this._tiles[F.key]){const U=new x.Tile(F,this._source.tileSize*F.overscaleFactor(),c.tileZoom);U.state="loaded",this._tiles[F.key]=U}return O},{});for(const O in this._tiles)O in P||(this.freeFBO(O),this._tiles[O].state="unloaded",delete this._tiles[O])}freeFBO(c){const y=this.proxyCachedFBO[c];if(void 0!==y){const S=Object.values(y);this.renderCachePool.push(...S),delete this.proxyCachedFBO[c]}}deallocRenderCache(){this.renderCache.forEach(c=>c.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Yn extends x.OverscaledTileID{constructor(c,y,S){super(c.overscaledZ,c.wrap,c.canonical.z,c.canonical.x,c.canonical.y),this.proxyTileKey=y,this.projMatrix=S}}class ro extends x.Elevation{constructor(c,y){super(),this.painter=c,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[S,P,O]=function(q){const Y=new x.StructArrayLayout4i8,te=new x.StructArrayLayout3ui6;Y.reserve(17161),te.reserve(33800);const se=x.EXTENT/128,we=x.EXTENT+se/2,Fe=we+se;for(let nt=-se;nt<Fe;nt+=se)for(let Te=-se;Te<Fe;Te+=se){const He=Te<0||Te>we||nt<0||nt>we?24575:0,Je=x.clamp(Math.round(Te),0,x.EXTENT),ot=x.clamp(Math.round(nt),0,x.EXTENT);Y.emplaceBack(Je+He,ot,Je,ot)}const Ve=(nt,Te)=>{const He=131*Te+nt;te.emplaceBack(He+1,He,He+131),te.emplaceBack(He+131,He+131+1,He+1)};for(let nt=1;nt<129;nt++)for(let Te=1;Te<129;Te++)Ve(Te,nt);return[0,129].forEach(nt=>{for(let Te=0;Te<130;Te++)Ve(Te,nt),Ve(nt,Te)}),[Y,te,32768]}(),F=c.context;this.gridBuffer=F.createVertexBuffer(S,Bs.members),this.gridIndexBuffer=F.createIndexBuffer(P),this.gridSegments=x.SegmentVector.simpleSegment(0,0,S.length,P.length),this.gridNoSkirtSegments=x.SegmentVector.simpleSegment(0,0,S.length,O),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new as(y.map),this.orthoMatrix=x.create$1(),x.ortho(this.orthoMatrix,0,x.EXTENT,0,x.EXTENT,0,1);const U=F.gl;this._overlapStencilMode=new x.StencilMode({func:U.GEQUAL,mask:255},0,255,U.KEEP,U.KEEP,U.REPLACE),this._previousZoom=c.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=y,this._useVertexMorphing=!0,this._exaggeration=1}set style(c){c.on("data",this._onStyleDataEvent.bind(this)),c.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=c,this._checkRenderCacheEfficiency()}update(c,y,S){if(c&&c.terrain){this._style!==c&&(this.style=c),this.enabled=!0;const P=c.terrain.properties;this.sourceCache=c._getSourceCache(P.get("source")),this._exaggeration=P.get("exaggeration");const O=()=>{this.sourceCache.used&&x.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.\nThis leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const F=this.sourceCache.getSource().tileSize/128,U=this.proxySourceCache.getSource().tileSize;this.sourceCache.update(y,F*U,!0),this._findCoveringTileCache[this.sourceCache.id]={}};this.sourceCache.usedForTerrain||(this._findCoveringTileCache[this.sourceCache.id]={},this.sourceCache.usedForTerrain=!0,O(),this._initializing=!0),O(),y.updateElevation(!S),this._findCoveringTileCache[this.proxySourceCache.id]={},this.proxySourceCache.update(y),this._emptyDEMTextureDirty=!0}else this._disable()}_checkRenderCacheEfficiency(){const c=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||100!==c.efficiency&&x.warnOnce(`Terrain render cache efficiency is not optimal (${c.efficiency}%) and performance\n                may be affected negatively, consider placing all background, fill and line layers before layer\n                with id '${c.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(c){c.coord&&"source"===c.dataType?this._clearRenderCacheForTile(c.sourceCacheId,c.coord):"style"===c.dataType&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const c in this._style._sourceCaches)this._style._sourceCaches[c].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this.pool.forEach(c=>c.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),delete this._depthFBO,delete this._depthTexture)}_source(){return this.enabled?this.sourceCache:null}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const c=2*this.proxySourceCache.getSource().tileSize;return[c,c]}set useVertexMorphing(c){this._useVertexMorphing=c}updateTileBinding(c){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const y=this.proxySourceCache,S=this.painter.transform;this._initializing&&(this._initializing=0===S._centerAltitude&&-1===this.getAtPointOrZero(x.MercatorCoordinate.fromLngLat(S.center),-1),this._emptyDEMTextureDirty=!this._initializing);const P=this.proxyCoords=y.getIds().map(q=>{const Y=y.getTileByID(q).tileID;return Y.projMatrix=S.calculateProjMatrix(Y.toUnwrapped()),Y});(function(q,Y){const te=Y.transform.pointCoordinate(Y.transform.getCameraPoint()),ie=new x.pointGeometry(te.x,te.y);q.sort((se,we)=>{if(we.overscaledZ-se.overscaledZ)return we.overscaledZ-se.overscaledZ;const Fe=new x.pointGeometry(se.canonical.x+(1<<se.canonical.z)*se.wrap,se.canonical.y),Ve=new x.pointGeometry(we.canonical.x+(1<<we.canonical.z)*we.wrap,we.canonical.y),nt=ie.mult(1<<se.canonical.z);return nt.x-=.5,nt.y-=.5,nt.distSqr(Fe)-nt.distSqr(Ve)})})(P,this.painter),this._previousZoom=S.zoom;const O=this.proxyToSource||{};this.proxyToSource={},P.forEach(q=>{this.proxyToSource[q.key]={}}),this.terrainTileForTile={};const F=this._style._sourceCaches;for(const q in F){const Y=F[q];if(!Y.used||(Y!==this.sourceCache&&(this._findCoveringTileCache[Y.id]={}),this._setupProxiedCoordsForOrtho(Y,c[q],O),Y.usedForTerrain))continue;const te=c[q];Y.getSource().reparseOverscaled&&this._assignTerrainTiles(te)}this.proxiedCoords[y.id]=P.map(q=>new Yn(q,q.key,this.orthoMatrix)),this._assignTerrainTiles(P),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(O),this.renderingToTexture=!1,this._updateTimestamp=x.exported.now();const U={};this._visibleDemTiles=[];for(const q of this.proxyCoords){const Y=this.terrainTileForTile[q.key];if(!Y)continue;const te=Y.tileID.key;te in U||(this._visibleDemTiles.push(Y),U[te]=te)}}_assignTerrainTiles(c){this._initializing||c.forEach(y=>{if(this.terrainTileForTile[y.key])return;const S=this._findTileCoveringTileID(y,this.sourceCache);S&&(this.terrainTileForTile[y.key]=S)})}_prepareDEMTextures(){const c=this.painter.context,y=c.gl;for(const S in this.terrainTileForTile){const P=this.terrainTileForTile[S],O=P.dem;!O||P.demTexture&&!P.needsDEMTextureUpload||(c.activeTexture.set(y.TEXTURE1),$u(this.painter,P,O))}}_prepareDemTileUniforms(c,y,S,P){if(!y||null==y.demTexture)return!1;const O=c.tileID.canonical,F=Math.pow(2,y.tileID.canonical.z-O.z),U=P||"";return S[`u_dem_tl${U}`]=[O.x*F%1,O.y*F%1],S[`u_dem_scale${U}`]=F,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}_getLoadedAreaMinimum(){let c=0;const y=this._visibleDemTiles.reduce((S,P)=>{if(!P.dem)return S;const O=P.dem.tree.minimums[0];return O>0&&c++,S+O},0);return c?y/c:0}_updateEmptyDEMTexture(){const c=this.painter.context,y=c.gl;c.activeTexture.set(y.TEXTURE2);const S=this._getLoadedAreaMinimum(),P={width:1,height:1,data:new Uint8Array(x.DEMData.pack(S,this.sourceCache.getSource().encoding))};this._emptyDEMTextureDirty=!1;let O=this._emptyDEMTexture;return O?O.update(P,{premultiply:!1}):O=this._emptyDEMTexture=new x.Texture(c,P,y.RGBA,{premultiply:!1}),O}setupElevationDraw(c,y,S){const P=this.painter.context,O=P.gl,F=(U=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:x.DEMData.getUnpackVector(U),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var U;F.u_dem_size=this.sourceCache.getSource().tileSize,F.u_exaggeration=this.exaggeration();let q=null,Y=null,te=1;if(S&&S.morphing&&this._useVertexMorphing){const ie=S.morphing.srcDemTile,se=S.morphing.dstDemTile;te=S.morphing.phase,ie&&se&&(this._prepareDemTileUniforms(c,ie,F,"_prev")&&(Y=ie),this._prepareDemTileUniforms(c,se,F)&&(q=se))}if(Y&&q?(P.activeTexture.set(O.TEXTURE2),q.demTexture.bind(O.NEAREST,O.CLAMP_TO_EDGE,O.NEAREST),P.activeTexture.set(O.TEXTURE4),Y.demTexture.bind(O.NEAREST,O.CLAMP_TO_EDGE,O.NEAREST),F.u_dem_lerp=te):(q=this.terrainTileForTile[c.tileID.key],P.activeTexture.set(O.TEXTURE2),(this._prepareDemTileUniforms(c,q,F)?q.demTexture:this.emptyDEMTexture).bind(O.NEAREST,O.CLAMP_TO_EDGE,O.NEAREST)),S&&S.useDepthForOcclusion&&(P.activeTexture.set(O.TEXTURE3),this._depthTexture.bind(O.NEAREST,O.CLAMP_TO_EDGE,O.NEAREST),F.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height]),S&&S.useMeterToDem&&q){const ie=(1<<q.tileID.canonical.z)*x.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;F.u_meter_to_dem=ie}S&&S.labelPlaneMatrixInv&&(F.u_label_plane_matrix_inv=S.labelPlaneMatrixInv),y.setTerrainUniformValues(P,F)}renderToBackBuffer(c){const y=this.painter,S=this.painter.context;0!==c.length&&(S.bindFramebuffer.set(null),S.viewport.set([0,0,y.width,y.height]),this.renderingToTexture=!1,function(P,O,F,U,q){const Y=P.context,te=Y.gl;let ie,se;const we=P.options.showTerrainWireframe?2:0,Fe=(Je,ot)=>{if(se===Je)return;const Xe=[Vs[Je]];ot&&Xe.push(Vs[we]),ie=P.useProgram("terrainRaster",null,Xe),se=Je},Ve=P.colorModeForRenderPass(),nt=new x.DepthMode(te.LEQUAL,x.DepthMode.ReadWrite,P.depthRangeFor3D);Wl.update(q);const Te=P.transform,He=6*Math.pow(1.5,22-Te.zoom)*O.exaggeration();(we?[!1,!0]:[!1]).forEach(Je=>{se=-1;const ot=Je?te.LINES:te.TRIANGLES,[Xe,Ye]=Je?O.getWirefameBuffer():[O.gridIndexBuffer,O.gridSegments];for(const Jt of U){const et=F.getTile(Jt),xn=x.StencilMode.disabled,un=O.prevTerrainTileForTile[Jt.key],Kn=O.terrainTileForTile[Jt.key];qt=Kn,null!=($t=un)&&null!=qt&&$t.hasData()&&qt.hasData()&&null!=$t.demTexture&&null!=qt.demTexture&&$t.tileID.key!==qt.tileID.key&&Wl.newMorphing(Jt.key,un,Kn,q,250),Y.activeTexture.set(te.TEXTURE0),et.texture.bind(te.LINEAR,te.CLAMP_TO_EDGE,te.LINEAR_MIPMAP_NEAREST);const En=Wl.getMorphValuesForProxy(Jt.key),wn=En?1:0;let Ir;En&&(Ir={morphing:{srcDemTile:En.from,dstDemTile:En.to,phase:x.easeCubicInOut(En.phase)}});const pr=Ts(Jt.projMatrix,pc(Jt.canonical,Te.renderWorldCopies)?He/10:He);Fe(wn,Je),O.setupElevationDraw(et,ie,Ir),P.prepareDrawProgram(Y,ie,Jt.toUnwrapped()),ie.draw(Y,ot,nt,xn,Ve,x.CullFaceMode.backCCW,pr,"terrain_raster",O.gridBuffer,Xe,Ye)}var $t,qt})}(y,this,this.proxySourceCache,c,this._updateTimestamp),this.renderingToTexture=!0,c.splice(0,c.length))}renderBatch(c){if(0===this._drapedRenderBatches.length)return c+1;this.renderingToTexture=!0;const y=this.painter,S=this.painter.context,P=this.proxySourceCache,O=this.proxiedCoords[P.id],F=this._drapedRenderBatches.shift(),U=[],q=y.style.order;let Y=0;for(const te of O){const ie=P.getTileByID(te.proxyTileKey),se=P.proxyCachedFBO[te.key]?P.proxyCachedFBO[te.key][c]:void 0,we=void 0!==se?P.renderCache[se]:this.pool[Y++],Fe=void 0!==se;if(ie.texture=we.tex,Fe&&!we.dirty){U.push(ie.tileID);continue}let Ve;S.bindFramebuffer.set(we.fb.framebuffer),this.renderedToTile=!1,we.dirty&&(S.clear({color:x.Color.transparent}),we.dirty=!1);for(let nt=F.start;nt<=F.end;++nt){const Te=y.style._layers[q[nt]];if(Te.isHidden(y.transform.zoom))continue;const He=y.style._getLayerSourceCache(Te),Je=He?this.proxyToSource[te.key][He.id]:[te];if(!Je)continue;const ot=Je;S.viewport.set([0,0,we.fb.width,we.fb.height]),Ve!==(He?He.id:null)&&(this._setupStencil(we,Je,Te,He),Ve=He?He.id:null),y.renderLayer(y,He,Te,ot)}this.renderedToTile?(we.dirty=!0,U.push(ie.tileID)):Fe||--Y,5===Y&&(Y=0,this.renderToBackBuffer(U))}return this.renderToBackBuffer(U),this.renderingToTexture=!1,S.bindFramebuffer.set(null),S.viewport.set([0,0,y.width,y.height]),F.end+1}postRender(){}renderCacheEfficiency(c){const y=c.order.length;if(0===y)return{efficiency:100};let S,P=0,O=0,F=!1;for(let U=0;U<y;++U){const q=c._layers[c.order[U]];this._style.isLayerDraped(q)?(F&&++P,++O):F||(F=!0,S=q.id)}return 0===O?{efficiency:100}:{efficiency:100*(1-P/O),firstUndrapedLayer:S}}getMinElevationBelowMSL(){let c=0;return this._visibleDemTiles.filter(y=>y.dem).forEach(y=>{c=Math.min(c,y.dem.tree.minimums[0])}),0===c?c:(c-30)*this._exaggeration}raycast(c,y,S){if(!this._visibleDemTiles)return null;const P=this._visibleDemTiles.filter(O=>O.dem).map(O=>{const F=O.tileID,U=Math.pow(2,F.overscaledZ),{x:q,y:Y}=F.canonical,te=q/U,ie=(q+1)/U,se=Y/U,we=(Y+1)/U;return{minx:te,miny:se,maxx:ie,maxy:we,t:O.dem.tree.raycastRoot(te,se,ie,we,c,y,S),tile:O}});P.sort((O,F)=>(null!==O.t?O.t:Number.MAX_VALUE)-(null!==F.t?F.t:Number.MAX_VALUE));for(const O of P){if(null==O.t)return null;const F=O.tile.dem.tree.raycast(O.minx,O.miny,O.maxx,O.maxy,c,y,S);if(null!=F)return F}return null}_createFBO(){const c=this.painter.context,y=c.gl,S=this.drapeBufferSize;c.activeTexture.set(y.TEXTURE0);const P=new x.Texture(c,{width:S[0],height:S[1],data:null},y.RGBA);P.bind(y.LINEAR,y.CLAMP_TO_EDGE);const O=c.createFramebuffer(S[0],S[1],!1);return O.colorAttachment.set(P.texture),O.depthAttachment=new fo(c,O.framebuffer),void 0===this._sharedDepthStencil?(this._sharedDepthStencil=c.createRenderbuffer(c.gl.DEPTH_STENCIL,S[0],S[1]),this._stencilRef=0,O.depthAttachment.set(this._sharedDepthStencil),c.clear({stencil:0})):O.depthAttachment.set(this._sharedDepthStencil),c.extTextureFilterAnisotropic&&!c.extTextureFilterAnisotropicForceOff&&y.texParameterf(y.TEXTURE_2D,c.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,c.extTextureFilterAnisotropicMax),{fb:O,tex:P,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const c in this._style._sourceCaches)if(this._style._sourceCaches[c].hasTransition())return!0;return this._style.order.some(c=>{const y=this._style._layers[c],S=y.isHidden(this.painter.transform.zoom),P=y.getCrossfadeParameters(),O=!!P&&1!==P.t,F=y.hasTransition();return"custom"!==y.type&&!S&&(O||F)})}_clearRasterFadeFromRenderCache(){let c=!1;for(const y in this._style._sourceCaches)if(this._style._sourceCaches[y]._source instanceof Fs){c=!0;break}if(c)for(let y=0;y<this._style.order.length;++y){const S=this._style._layers[this._style.order[y]],P=S.isHidden(this.painter.transform.zoom),O=this._style._getLayerSourceCache(S);if("raster"!==S.type||P||!O)continue;const F=S.paint.get("raster-fade-duration");for(const U of this.proxyCoords){const q=this.proxyToSource[U.key][O.id];if(q)for(const Y of q){const te=Kc(O.getTile(Y),O.findLoadedParent(Y,0),O,this.painter.transform,F);(1!==te.opacity||0!==te.mix)&&this._clearRenderCacheForTile(O.id,Y)}}}}_setupDrapedRenderBatches(){const c=this._style.order,y=c.length;if(0===y)return;const S=[];let P,O=0,F=this._style._layers[c[O]];for(;!this._style.isLayerDraped(F)&&F.isHidden(this.painter.transform.zoom)&&++O<y;)F=this._style._layers[c[O]];for(;O<y;++O){const U=this._style._layers[c[O]];U.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(U)?void 0===P&&(P=O):void 0!==P&&(S.push({start:P,end:O-1}),P=void 0))}void 0!==P&&S.push({start:P,end:O-1}),this._drapedRenderBatches=S}_setupRenderCache(c){const y=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,y.renderCache.length>y.renderCachePool.length){const F=Object.values(y.proxyCachedFBO);y.proxyCachedFBO={};for(let U=0;U<F.length;++U){const q=Object.values(F[U]);y.renderCachePool.push(...q)}}return}this._clearRasterFadeFromRenderCache();const S=this.proxyCoords,P=this._tilesDirty;for(let F=S.length-1;F>=0;F--){const U=S[F];if(y.getTileByID(U.key),void 0!==y.proxyCachedFBO[U.key]){const q=c[U.key],Y=this.proxyToSource[U.key];let te=0;for(const ie in Y){const se=Y[ie],we=q[ie];if(!we||we.length!==se.length||se.some((Fe,Ve)=>Fe!==we[Ve]||P[ie]&&P[ie].hasOwnProperty(Fe.key))){te=-1;break}++te}for(const ie in y.proxyCachedFBO[U.key])y.renderCache[y.proxyCachedFBO[U.key][ie]].dirty=te<0||te!==Object.values(q).length}}const O=[...this._drapedRenderBatches];O.sort((F,U)=>U.end-U.start-(F.end-F.start));for(const F of O)for(const U of S){if(y.proxyCachedFBO[U.key])continue;let q=y.renderCachePool.pop();void 0===q&&y.renderCache.length<50&&(q=y.renderCache.length,y.renderCache.push(this._createFBO())),void 0!==q&&(y.proxyCachedFBO[U.key]={},y.proxyCachedFBO[U.key][F.start]=q,y.renderCache[q].dirty=!0)}this._tilesDirty={}}_setupStencil(c,y,S,P){if(!P||!this._sourceTilesOverlap[P.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const O=this.painter.context,F=O.gl;if(y.length<=1)return void(this._overlapStencilType=!1);let U;if(S.isTileClipped())U=y.length,this._overlapStencilMode.test={func:F.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(y[0].overscaledZ>y[y.length-1].overscaledZ))return void(this._overlapStencilType=!1);U=1,this._overlapStencilMode.test={func:F.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+U>255&&(O.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=U,this._overlapStencilMode.ref=this._stencilRef,S.isTileClipped()&&this._renderTileClippingMasks(y,this._overlapStencilMode.ref)}stencilModeForRTTOverlap(c){return this.renderingToTexture&&this._overlapStencilType?("Clip"===this._overlapStencilType&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[c.key]),this._overlapStencilMode):x.StencilMode.disabled}_renderTileClippingMasks(c,y){const S=this.painter,P=this.painter.context,O=P.gl;S._tileClippingMaskIDs={},P.setColorMode(x.ColorMode.disabled),P.setDepthMode(x.DepthMode.disabled);const F=S.useProgram("clippingMask");for(const U of c){const q=S._tileClippingMaskIDs[U.key]=--y;F.draw(P,O.TRIANGLES,x.DepthMode.disabled,new x.StencilMode({func:O.ALWAYS,mask:0},q,255,O.KEEP,O.KEEP,O.REPLACE),x.ColorMode.disabled,x.CullFaceMode.disabled,jr(U.projMatrix),"$clipping",S.tileExtentBuffer,S.quadTriangleIndexBuffer,S.tileExtentSegments)}}pointCoordinate(c){const y=this.painter.transform;if(c.x<0||c.x>y.width||c.y<0||c.y>y.height)return null;const S=[c.x,c.y,1,1];x.transformMat4(S,S,y.pixelMatrixInverse),x.scale$2(S,S,1/S[3]),S[0]/=y.worldSize,S[1]/=y.worldSize;const P=y._camera.position,O=x.mercatorZfromAltitude(1,y.center.lat),F=[P[0],P[1],P[2]/O,0],U=x.subtract([],S.slice(0,3),F);x.normalize(U,U);const q=this.raycast(F,U,this._exaggeration);return null!==q&&q?(x.scaleAndAdd(F,F,U,q),F[3]=F[2],F[2]*=O,F):null}drawDepth(){const c=this.painter,y=c.context,S=this.proxySourceCache,P=Math.ceil(c.width),O=Math.ceil(c.height);if(!this._depthFBO||this._depthFBO.width===P&&this._depthFBO.height===O||(this._depthFBO.destroy(),delete this._depthFBO,delete this._depthTexture),!this._depthFBO){const F=y.gl,U=y.createFramebuffer(P,O,!0);y.activeTexture.set(F.TEXTURE0);const q=new x.Texture(y,{width:P,height:O,data:null},F.RGBA);q.bind(F.NEAREST,F.CLAMP_TO_EDGE),U.colorAttachment.set(q.texture);const Y=y.createRenderbuffer(y.gl.DEPTH_COMPONENT16,P,O);U.depthAttachment.set(Y),this._depthFBO=U,this._depthTexture=q}y.bindFramebuffer.set(this._depthFBO.framebuffer),y.viewport.set([0,0,P,O]),function(F,U,q,Y){const te=F.context,ie=te.gl;te.clear({depth:1});const se=F.useProgram("terrainDepth"),we=new x.DepthMode(ie.LESS,x.DepthMode.ReadWrite,F.depthRangeFor3D);for(const Fe of Y){const Ve=q.getTile(Fe),nt=Ts(Fe.projMatrix,0);U.setupElevationDraw(Ve,se),se.draw(te,ie.TRIANGLES,we,x.StencilMode.disabled,x.ColorMode.unblended,x.CullFaceMode.backCCW,nt,"terrain_depth",U.gridBuffer,U.gridIndexBuffer,U.gridNoSkirtSegments)}}(c,this,S,this.proxyCoords)}_setupProxiedCoordsForOrtho(c,y,S){if(c.getSource()instanceof Re)return this._setupProxiedCoordsForImageSource(c,y,S);this._findCoveringTileCache[c.id]=this._findCoveringTileCache[c.id]||{};const P=this.proxiedCoords[c.id]=[],O=this.proxyCoords;for(let U=0;U<O.length;U++){const q=O[U],Y=this._findTileCoveringTileID(q,c);if(Y){const te=this._createProxiedId(q,Y,S[q.key]&&S[q.key][c.id]);P.push(te),this.proxyToSource[q.key][c.id]=[te]}}let F=!1;for(let U=0;U<y.length;U++){const q=c.getTile(y[U]);if(!q||!q.hasData())continue;const Y=this._findTileCoveringTileID(q.tileID,this.proxySourceCache);if(Y&&Y.tileID.canonical.z!==q.tileID.canonical.z){const te=this.proxyToSource[Y.tileID.key][c.id],ie=this._createProxiedId(Y.tileID,q,S[Y.tileID.key]&&S[Y.tileID.key][c.id]);te?te.splice(te.length-1,0,ie):this.proxyToSource[Y.tileID.key][c.id]=[ie],P.push(ie),F=!0}}this._sourceTilesOverlap[c.id]=F}_setupProxiedCoordsForImageSource(c,y,S){if(!c.getSource().loaded())return;const P=this.proxiedCoords[c.id]=[],O=this.proxyCoords,F=c.getSource(),U=new x.pointGeometry(F.tileID.x,F.tileID.y)._div(1<<F.tileID.z),q=F.coordinates.map(x.MercatorCoordinate.fromLngLat).reduce((te,ie)=>(te.min.x=Math.min(te.min.x,ie.x-U.x),te.min.y=Math.min(te.min.y,ie.y-U.y),te.max.x=Math.max(te.max.x,ie.x-U.x),te.max.y=Math.max(te.max.y,ie.y-U.y),te),{min:new x.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE),max:new x.pointGeometry(-Number.MAX_VALUE,-Number.MAX_VALUE)}),Y=(te,ie)=>{const se=te.wrap+te.canonical.x/(1<<te.canonical.z),we=te.canonical.y/(1<<te.canonical.z),Fe=x.EXTENT/(1<<te.canonical.z),Ve=ie.wrap+ie.canonical.x/(1<<ie.canonical.z),nt=ie.canonical.y/(1<<ie.canonical.z);return se+Fe<Ve+q.min.x||se>Ve+q.max.x||we+Fe<nt+q.min.y||we>nt+q.max.y};for(let te=0;te<O.length;te++){const ie=O[te];for(let se=0;se<y.length;se++){const we=c.getTile(y[se]);if(!we||!we.hasData()||Y(ie,we.tileID))continue;const Fe=this._createProxiedId(ie,we,S[ie.key]&&S[ie.key][c.id]),Ve=this.proxyToSource[ie.key][c.id];Ve?Ve.push(Fe):this.proxyToSource[ie.key][c.id]=[Fe],P.push(Fe)}}}_createProxiedId(c,y,S){let P=this.orthoMatrix;if(S){const O=S.find(F=>F.key===y.tileID.key);if(O)return O}if(y.tileID.key!==c.key){const O=c.canonical.z-y.tileID.canonical.z;let F,U,q;P=x.create$1();const Y=y.tileID.wrap-c.wrap<<c.overscaledZ;O>0?(F=x.EXTENT>>O,U=F*((y.tileID.canonical.x<<O)-c.canonical.x+Y),q=F*((y.tileID.canonical.y<<O)-c.canonical.y)):(F=x.EXTENT<<-O,U=x.EXTENT*(y.tileID.canonical.x-(c.canonical.x+Y<<-O)),q=x.EXTENT*(y.tileID.canonical.y-(c.canonical.y<<-O))),x.ortho(P,0,F,0,F,0,1),x.translate(P,P,[U,q,0])}return new Yn(y.tileID,c.key,P)}_findTileCoveringTileID(c,y){let S=y.getTile(c);if(S&&S.hasData())return S;const P=this._findCoveringTileCache[y.id],O=P[c.key];if(S=O?y.getTileByID(O):null,S&&S.hasData()||null===O)return S;let F=S?S.tileID:c,U=F.overscaledZ;const q=y.getSource().minzoom,Y=[];if(!O){const ie=y.getSource().maxzoom;if(c.canonical.z>=ie){const se=c.canonical.z-ie;y.getSource().reparseOverscaled?(U=Math.max(c.canonical.z+2,y.transform.tileZoom),F=new x.OverscaledTileID(U,c.wrap,ie,c.canonical.x>>se,c.canonical.y>>se)):0!==se&&(U=ie,F=new x.OverscaledTileID(U,c.wrap,ie,c.canonical.x>>se,c.canonical.y>>se))}F.key!==c.key&&(Y.push(F.key),S=y.getTile(F))}const te=ie=>{Y.forEach(se=>{P[se]=ie}),Y.length=0};for(U-=1;U>=q&&(!S||!S.hasData());U--){S&&te(S.tileID.key);const ie=F.calculateScaledKey(U);if(S=y.getTileByID(ie),S&&S.hasData())break;const se=P[ie];if(null===se)break;void 0===se?Y.push(ie):S=y.getTileByID(se)}return te(S?S.tileID.key:null),S&&S.hasData()?S:null}findDEMTileFor(c){return this.enabled?this._findTileCoveringTileID(c,this.sourceCache):null}prepareDrawTile(c){this.renderedToTile=!0}_clearRenderCacheForTile(c,y){let S=this._tilesDirty[c];S||(S=this._tilesDirty[c]={}),S[y.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const c=function(y){let S,P,O;const F=new x.StructArrayLayout2ui4,U=131;for(P=1;P<129;P++){for(S=1;S<129;S++)O=P*U+S,F.emplaceBack(O,O+1),F.emplaceBack(O,O+U),F.emplaceBack(O+1,O+U),128===P&&F.emplaceBack(O+U,O+U+1);F.emplaceBack(O+1,O+1+U)}return F}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(c),this.wireframeSegments=x.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,c.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}function au(C){const c=[];for(let y=0;y<C.length;y++){if(null===C[y])continue;const S=C[y].split(" ");c.push(S.pop())}return c}class Ds{static cacheKey(c,y,S){let P=`${c}${S?S.cacheKey:""}`;for(const O of y)P+=`/${O}`;return P}constructor(c,y,S,P,O,F){const U=c.gl;this.program=U.createProgram();const q=au(S.staticAttributes),Y=P?P.getBinderAttributes():[],te=q.concat(Y),ie=S.staticUniforms?au(S.staticUniforms):[],se=P?P.getBinderUniforms():[],we=ie.concat(se),Fe=[];for(const Xe of we)Fe.indexOf(Xe)<0&&Fe.push(Xe);let Ve=P?P.defines():[];Ve=Ve.concat(F.map(Xe=>`#define ${Xe}`));const nt=Ve.concat(Xi.fragmentSource,Zc,or.fragmentSource,S.fragmentSource).join("\n"),Te=Ve.concat(Xi.vertexSource,Zc,or.vertexSource,wl.vertexSource,S.vertexSource).join("\n"),He=U.createShader(U.FRAGMENT_SHADER);if(U.isContextLost())return void(this.failedToCreate=!0);U.shaderSource(He,nt),U.compileShader(He),U.attachShader(this.program,He);const Je=U.createShader(U.VERTEX_SHADER);if(U.isContextLost())return void(this.failedToCreate=!0);U.shaderSource(Je,Te),U.compileShader(Je),U.attachShader(this.program,Je),this.attributes={};const ot={};this.numAttributes=te.length;for(let Xe=0;Xe<this.numAttributes;Xe++)te[Xe]&&(U.bindAttribLocation(this.program,Xe,te[Xe]),this.attributes[te[Xe]]=Xe);U.linkProgram(this.program),U.deleteShader(Je),U.deleteShader(He);for(let Xe=0;Xe<Fe.length;Xe++){const Ye=Fe[Xe];if(Ye&&!ot[Ye]){const $t=U.getUniformLocation(this.program,Ye);$t&&(ot[Ye]=$t)}}var Xe,Ye;this.fixedUniforms=O(c,ot),this.binderUniforms=P?P.getUniforms(c,ot):[],-1!==F.indexOf("TERRAIN")&&(this.terrainUniforms={u_dem:new x.Uniform1i(Xe=c,(Ye=ot).u_dem),u_dem_prev:new x.Uniform1i(Xe,Ye.u_dem_prev),u_dem_unpack:new x.Uniform4f(Xe,Ye.u_dem_unpack),u_dem_tl:new x.Uniform2f(Xe,Ye.u_dem_tl),u_dem_scale:new x.Uniform1f(Xe,Ye.u_dem_scale),u_dem_tl_prev:new x.Uniform2f(Xe,Ye.u_dem_tl_prev),u_dem_scale_prev:new x.Uniform1f(Xe,Ye.u_dem_scale_prev),u_dem_size:new x.Uniform1f(Xe,Ye.u_dem_size),u_dem_lerp:new x.Uniform1f(Xe,Ye.u_dem_lerp),u_exaggeration:new x.Uniform1f(Xe,Ye.u_exaggeration),u_depth:new x.Uniform1i(Xe,Ye.u_depth),u_depth_size_inv:new x.Uniform2f(Xe,Ye.u_depth_size_inv),u_meter_to_dem:new x.Uniform1f(Xe,Ye.u_meter_to_dem),u_label_plane_matrix_inv:new x.UniformMatrix4f(Xe,Ye.u_label_plane_matrix_inv)}),-1!==F.indexOf("FOG")&&(this.fogUniforms=((Xe,Ye)=>({u_fog_matrix:new x.UniformMatrix4f(Xe,Ye.u_fog_matrix),u_fog_range:new x.Uniform2f(Xe,Ye.u_fog_range),u_fog_color:new x.Uniform4f(Xe,Ye.u_fog_color),u_fog_horizon_blend:new x.Uniform1f(Xe,Ye.u_fog_horizon_blend),u_fog_temporal_offset:new x.Uniform1f(Xe,Ye.u_fog_temporal_offset)}))(c,ot))}setTerrainUniformValues(c,y){if(!this.terrainUniforms)return;const S=this.terrainUniforms;if(!this.failedToCreate){c.program.set(this.program);for(const P in y)S[P].set(y[P])}}setFogUniformValues(c,y){if(!this.fogUniforms)return;const S=this.fogUniforms;if(!this.failedToCreate){c.program.set(this.program);for(const P in y)S[P].location&&S[P].set(y[P])}}draw(c,y,S,P,O,F,U,q,Y,te,ie,se,we,Fe,Ve,nt){const Te=c.gl;if(this.failedToCreate)return;c.program.set(this.program),c.setDepthMode(S),c.setStencilMode(P),c.setColorMode(O),c.setCullFace(F);for(const Je in this.fixedUniforms)this.fixedUniforms[Je].set(U[Je]);Fe&&Fe.setUniforms(c,this.binderUniforms,se,{zoom:we});const He={[Te.LINES]:2,[Te.TRIANGLES]:3,[Te.LINE_STRIP]:1}[y];for(const Je of ie.get()){const ot=Je.vaos||(Je.vaos={});(ot[q]||(ot[q]=new hs)).bind(c,this,Y,Fe?Fe.getPaintVertexBuffers():[],te,Je.vertexOffset,Ve,nt),Te.drawElements(y,Je.primitiveLength*He,Te.UNSIGNED_SHORT,Je.primitiveOffset*He*2)}}}function Ma(C,c,y){const S=1/Pe(y,1,c.transform.tileZoom),P=Math.pow(2,y.tileID.overscaledZ),O=y.tileSize*Math.pow(2,c.transform.tileZoom)/P,F=O*(y.tileID.canonical.x+y.tileID.wrap*P),U=O*y.tileID.canonical.y;return{u_image:0,u_texsize:y.imageAtlasTexture.size,u_scale:[S,C.fromScale,C.toScale],u_fade:C.t,u_pixel_coord_upper:[F>>16,U>>16],u_pixel_coord_lower:[65535&F,65535&U]}}const lu=(C,c,y,S)=>{const P=c.style.light,O=P.properties.get("position"),F=[O.x,O.y,O.z],U=x.create$2();"viewport"===P.properties.get("anchor")&&(x.fromRotation(U,-c.transform.angle),x.transformMat3(F,F,U));const q=P.properties.get("color");return{u_matrix:C,u_lightpos:F,u_lightintensity:P.properties.get("intensity"),u_lightcolor:[q.r,q.g,q.b],u_vertical_gradient:+y,u_opacity:S}},Jc=(C,c,y,S,P,O,F)=>x.extend(lu(C,c,y,S),Ma(O,c,F),{u_height_factor:-Math.pow(2,P.overscaledZ)/F.tileSize/8}),Xl=C=>({u_matrix:C}),uu=(C,c,y,S)=>x.extend(Xl(C),Ma(y,c,S)),Yr=(C,c)=>({u_matrix:C,u_world:c}),ao=(C,c,y,S,P)=>x.extend(uu(C,c,y,S),{u_world:P}),ii=(C,c,y,S)=>{const P=C.transform;let O;if("map"===S.paint.get("circle-pitch-alignment")){const F=Pe(y,1,P.zoom);O=[F,F]}else O=P.pixelsToGLUnits;return{u_camera_to_center_distance:P.cameraToCenterDistance,u_matrix:C.translatePosMatrix(c.projMatrix,y,S.paint.get("circle-translate"),S.paint.get("circle-translate-anchor")),u_device_pixel_ratio:x.exported.devicePixelRatio,u_extrude_scale:O}},gc=C=>{const c=[];return"map"===C.paint.get("circle-pitch-alignment")&&c.push("PITCH_WITH_MAP"),"map"===C.paint.get("circle-pitch-scale")&&c.push("SCALE_WITH_MAP"),c},ta=(C,c,y)=>{const S=x.EXTENT/y.tileSize;return{u_matrix:C,u_camera_to_center_distance:c.cameraToCenterDistance,u_extrude_scale:[c.pixelsToGLUnits[0]/S,c.pixelsToGLUnits[1]/S]}},Ac=(C,c,y=1)=>({u_matrix:C,u_color:c,u_overlay:0,u_overlay_scale:y}),Gn=(C,c,y,S)=>({u_matrix:C,u_extrude_scale:Pe(c,1,y),u_intensity:S}),cu=(C,c,y,S)=>{const P=C.transform;return{u_matrix:hu(C,c,y,S),u_ratio:1/Pe(c,1,P.zoom),u_device_pixel_ratio:x.exported.devicePixelRatio,u_units_to_pixels:[1/P.pixelsToGLUnits[0],1/P.pixelsToGLUnits[1]]}},_i=(C,c,y,S,P)=>x.extend(cu(C,c,y,S),{u_image:0,u_image_height:P}),Fn=(C,c,y,S,P)=>{const O=C.transform,F=Yo(c,O);return{u_matrix:hu(C,c,y,P),u_texsize:c.imageAtlasTexture.size,u_ratio:1/Pe(c,1,O.zoom),u_device_pixel_ratio:x.exported.devicePixelRatio,u_image:0,u_scale:[F,S.fromScale,S.toScale],u_fade:S.t,u_units_to_pixels:[1/O.pixelsToGLUnits[0],1/O.pixelsToGLUnits[1]]}},Yi=(C,c,y,S,P)=>{const O=Yo(c,C.transform);return x.extend(cu(C,c,y,P),{u_texsize:c.lineAtlasTexture.size,u_scale:[O,S.fromScale,S.toScale],u_image:0,u_mix:S.t})};function Yo(C,c){return 1/Pe(C,1,c.tileZoom)}function hu(C,c,y,S){return C.translatePosMatrix(S||c.tileID.projMatrix,c,y.paint.get("line-translate"),y.paint.get("line-translate-anchor"))}const Ka=(C,c,y,S,P)=>{return{u_matrix:C,u_tl_parent:c,u_scale_parent:y,u_buffer_scale:1,u_fade_t:S.mix,u_opacity:S.opacity*P.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:P.paint.get("raster-brightness-min"),u_brightness_high:P.paint.get("raster-brightness-max"),u_saturation_factor:(F=P.paint.get("raster-saturation"),F>0?1-1/(1.001-F):-F),u_contrast_factor:(O=P.paint.get("raster-contrast"),O>0?1/(1-O):1+O),u_spin_weights:Cr(P.paint.get("raster-hue-rotate"))};var O,F};function Cr(C){C*=Math.PI/180;const c=Math.sin(C),y=Math.cos(C);return[(2*y+1)/3,(-Math.sqrt(3)*c-y+1)/3,(Math.sqrt(3)*c-y+1)/3]}const Ja=(C,c,y,S,P,O,F,U,q,Y)=>{const te=P.transform;return{u_is_size_zoom_constant:+("constant"===C||"source"===C),u_is_size_feature_constant:+("constant"===C||"camera"===C),u_size_t:c?c.uSizeT:0,u_size:c?c.uSize:0,u_camera_to_center_distance:te.cameraToCenterDistance,u_pitch:te.pitch/360*2*Math.PI,u_rotate_symbol:+y,u_aspect_ratio:te.width/te.height,u_fade_change:P.options.fadeDuration?P.symbolFadeChange:1,u_matrix:O,u_label_plane_matrix:F,u_coord_matrix:U,u_is_text:+q,u_pitch_with_map:+S,u_texsize:Y,u_texture:0}},pa=(C,c,y,S,P,O,F,U,q,Y,te)=>{const{cameraToCenterDistance:ie,_pitch:se}=P.transform;return x.extend(Ja(C,c,y,S,P,O,F,U,q,Y),{u_gamma_scale:S?ie*Math.cos(P.terrain?0:se):1,u_device_pixel_ratio:x.exported.devicePixelRatio,u_is_halo:+te})},On=(C,c,y,S,P,O,F,U,q,Y)=>x.extend(pa(C,c,y,S,P,O,F,U,!0,q,!0),{u_texsize_icon:Y,u_texture_icon:1}),Dr=(C,c,y)=>({u_matrix:C,u_opacity:c,u_color:y}),Wr=(C,c,y,S,P,O)=>x.extend(function(F,U,q,Y){const te=q.imageManager.getPattern(F.from.toString()),ie=q.imageManager.getPattern(F.to.toString()),{width:se,height:we}=q.imageManager.getPixelSize(),Fe=Math.pow(2,Y.tileID.overscaledZ),Ve=Y.tileSize*Math.pow(2,q.transform.tileZoom)/Fe,nt=Ve*(Y.tileID.canonical.x+Y.tileID.wrap*Fe),Te=Ve*Y.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:te.tl,u_pattern_br_a:te.br,u_pattern_tl_b:ie.tl,u_pattern_br_b:ie.br,u_texsize:[se,we],u_mix:U.t,u_pattern_size_a:te.displaySize,u_pattern_size_b:ie.displaySize,u_scale_a:U.fromScale,u_scale_b:U.toScale,u_tile_units_to_pixels:1/Pe(Y,1,q.transform.tileZoom),u_pixel_coord_upper:[nt>>16,Te>>16],u_pixel_coord_lower:[65535&nt,65535&Te]}}(S,O,y,P),{u_matrix:C,u_opacity:c}),El={fillExtrusion:(C,c)=>({u_matrix:new x.UniformMatrix4f(C,c.u_matrix),u_lightpos:new x.Uniform3f(C,c.u_lightpos),u_lightintensity:new x.Uniform1f(C,c.u_lightintensity),u_lightcolor:new x.Uniform3f(C,c.u_lightcolor),u_vertical_gradient:new x.Uniform1f(C,c.u_vertical_gradient),u_opacity:new x.Uniform1f(C,c.u_opacity)}),fillExtrusionPattern:(C,c)=>({u_matrix:new x.UniformMatrix4f(C,c.u_matrix),u_lightpos:new x.Uniform3f(C,c.u_lightpos),u_lightintensity:new x.Uniform1f(C,c.u_lightintensity),u_lightcolor:new x.Uniform3f(C,c.u_lightcolor),u_vertical_gradient:new x.Uniform1f(C,c.u_vertical_gradient),u_height_factor:new x.Uniform1f(C,c.u_height_factor),u_image:new x.Uniform1i(C,c.u_image),u_texsize:new x.Uniform2f(C,c.u_texsize),u_pixel_coord_upper:new x.Uniform2f(C,c.u_pixel_coord_upper),u_pixel_coord_lower:new x.Uniform2f(C,c.u_pixel_coord_lower),u_scale:new x.Uniform3f(C,c.u_scale),u_fade:new x.Uniform1f(C,c.u_fade),u_opacity:new x.Uniform1f(C,c.u_opacity)}),fill:(C,c)=>({u_matrix:new x.UniformMatrix4f(C,c.u_matrix)}),fillPattern:(C,c)=>({u_matrix:new x.UniformMatrix4f(C,c.u_matrix),u_image:new x.Uniform1i(C,c.u_image),u_texsize:new x.Uniform2f(C,c.u_texsize),u_pixel_coord_upper:new x.Uniform2f(C,c.u_pixel_coord_upper),u_pixel_coord_lower:new x.Uniform2f(C,c.u_pixel_coord_lower),u_scale:new x.Uniform3f(C,c.u_scale),u_fade:new x.Uniform1f(C,c.u_fade)}),fillOutline:(C,c)=>({u_matrix:new x.UniformMatrix4f(C,c.u_matrix),u_world:new x.Uniform2f(C,c.u_world)}),fillOutlinePattern:(C,c)=>({u_matrix:new x.UniformMatrix4f(C,c.u_matrix),u_world:new x.Uniform2f(C,c.u_world),u_image:new x.Uniform1i(C,c.u_image),u_texsize:new x.Uniform2f(C,c.u_texsize),u_pixel_coord_upper:new x.Uniform2f(C,c.u_pixel_coord_upper),u_pixel_coord_lower:new x.Uniform2f(C,c.u_pixel_coord_lower),u_scale:new x.Uniform3f(C,c.u_scale),u_fade:new x.Uniform1f(C,c.u_fade)}),circle:(C,c)=>({u_camera_to_center_distance:new x.Uniform1f(C,c.u_camera_to_center_distance),u_extrude_scale:new x.Uniform2f(C,c.u_extrude_scale),u_device_pixel_ratio:new x.Uniform1f(C,c.u_device_pixel_ratio),u_matrix:new x.UniformMatrix4f(C,c.u_matrix)}),collisionBox:(C,c)=>({u_matrix:new x.UniformMatrix4f(C,c.u_matrix),u_camera_to_center_distance:new x.Uniform1f(C,c.u_camera_to_center_distance),u_extrude_scale:new x.Uniform2f(C,c.u_extrude_scale)}),collisionCircle:(C,c)=>({u_matrix:new x.UniformMatrix4f(C,c.u_matrix),u_inv_matrix:new x.UniformMatrix4f(C,c.u_inv_matrix),u_camera_to_center_distance:new x.Uniform1f(C,c.u_camera_to_center_distance),u_viewport_size:new x.Uniform2f(C,c.u_viewport_size)}),debug:(C,c)=>({u_color:new x.UniformColor(C,c.u_color),u_matrix:new x.UniformMatrix4f(C,c.u_matrix),u_overlay:new x.Uniform1i(C,c.u_overlay),u_overlay_scale:new x.Uniform1f(C,c.u_overlay_scale)}),clippingMask:(C,c)=>({u_matrix:new x.UniformMatrix4f(C,c.u_matrix)}),heatmap:(C,c)=>({u_extrude_scale:new x.Uniform1f(C,c.u_extrude_scale),u_intensity:new x.Uniform1f(C,c.u_intensity),u_matrix:new x.UniformMatrix4f(C,c.u_matrix)}),heatmapTexture:(C,c)=>({u_image:new x.Uniform1i(C,c.u_image),u_color_ramp:new x.Uniform1i(C,c.u_color_ramp),u_opacity:new x.Uniform1f(C,c.u_opacity)}),hillshade:(C,c)=>({u_matrix:new x.UniformMatrix4f(C,c.u_matrix),u_image:new x.Uniform1i(C,c.u_image),u_latrange:new x.Uniform2f(C,c.u_latrange),u_light:new x.Uniform2f(C,c.u_light),u_shadow:new x.UniformColor(C,c.u_shadow),u_highlight:new x.UniformColor(C,c.u_highlight),u_accent:new x.UniformColor(C,c.u_accent)}),hillshadePrepare:(C,c)=>({u_matrix:new x.UniformMatrix4f(C,c.u_matrix),u_image:new x.Uniform1i(C,c.u_image),u_dimension:new x.Uniform2f(C,c.u_dimension),u_zoom:new x.Uniform1f(C,c.u_zoom),u_unpack:new x.Uniform4f(C,c.u_unpack)}),line:(C,c)=>({u_matrix:new x.UniformMatrix4f(C,c.u_matrix),u_ratio:new x.Uniform1f(C,c.u_ratio),u_device_pixel_ratio:new x.Uniform1f(C,c.u_device_pixel_ratio),u_units_to_pixels:new x.Uniform2f(C,c.u_units_to_pixels)}),lineGradient:(C,c)=>({u_matrix:new x.UniformMatrix4f(C,c.u_matrix),u_ratio:new x.Uniform1f(C,c.u_ratio),u_device_pixel_ratio:new x.Uniform1f(C,c.u_device_pixel_ratio),u_units_to_pixels:new x.Uniform2f(C,c.u_units_to_pixels),u_image:new x.Uniform1i(C,c.u_image),u_image_height:new x.Uniform1f(C,c.u_image_height)}),linePattern:(C,c)=>({u_matrix:new x.UniformMatrix4f(C,c.u_matrix),u_texsize:new x.Uniform2f(C,c.u_texsize),u_ratio:new x.Uniform1f(C,c.u_ratio),u_device_pixel_ratio:new x.Uniform1f(C,c.u_device_pixel_ratio),u_image:new x.Uniform1i(C,c.u_image),u_units_to_pixels:new x.Uniform2f(C,c.u_units_to_pixels),u_scale:new x.Uniform3f(C,c.u_scale),u_fade:new x.Uniform1f(C,c.u_fade)}),lineSDF:(C,c)=>({u_matrix:new x.UniformMatrix4f(C,c.u_matrix),u_texsize:new x.Uniform2f(C,c.u_texsize),u_ratio:new x.Uniform1f(C,c.u_ratio),u_device_pixel_ratio:new x.Uniform1f(C,c.u_device_pixel_ratio),u_units_to_pixels:new x.Uniform2f(C,c.u_units_to_pixels),u_image:new x.Uniform1i(C,c.u_image),u_scale:new x.Uniform3f(C,c.u_scale),u_mix:new x.Uniform1f(C,c.u_mix)}),raster:(C,c)=>({u_matrix:new x.UniformMatrix4f(C,c.u_matrix),u_tl_parent:new x.Uniform2f(C,c.u_tl_parent),u_scale_parent:new x.Uniform1f(C,c.u_scale_parent),u_buffer_scale:new x.Uniform1f(C,c.u_buffer_scale),u_fade_t:new x.Uniform1f(C,c.u_fade_t),u_opacity:new x.Uniform1f(C,c.u_opacity),u_image0:new x.Uniform1i(C,c.u_image0),u_image1:new x.Uniform1i(C,c.u_image1),u_brightness_low:new x.Uniform1f(C,c.u_brightness_low),u_brightness_high:new x.Uniform1f(C,c.u_brightness_high),u_saturation_factor:new x.Uniform1f(C,c.u_saturation_factor),u_contrast_factor:new x.Uniform1f(C,c.u_contrast_factor),u_spin_weights:new x.Uniform3f(C,c.u_spin_weights)}),symbolIcon:(C,c)=>({u_is_size_zoom_constant:new x.Uniform1i(C,c.u_is_size_zoom_constant),u_is_size_feature_constant:new x.Uniform1i(C,c.u_is_size_feature_constant),u_size_t:new x.Uniform1f(C,c.u_size_t),u_size:new x.Uniform1f(C,c.u_size),u_camera_to_center_distance:new x.Uniform1f(C,c.u_camera_to_center_distance),u_pitch:new x.Uniform1f(C,c.u_pitch),u_rotate_symbol:new x.Uniform1i(C,c.u_rotate_symbol),u_aspect_ratio:new x.Uniform1f(C,c.u_aspect_ratio),u_fade_change:new x.Uniform1f(C,c.u_fade_change),u_matrix:new x.UniformMatrix4f(C,c.u_matrix),u_label_plane_matrix:new x.UniformMatrix4f(C,c.u_label_plane_matrix),u_coord_matrix:new x.UniformMatrix4f(C,c.u_coord_matrix),u_is_text:new x.Uniform1i(C,c.u_is_text),u_pitch_with_map:new x.Uniform1i(C,c.u_pitch_with_map),u_texsize:new x.Uniform2f(C,c.u_texsize),u_texture:new x.Uniform1i(C,c.u_texture)}),symbolSDF:(C,c)=>({u_is_size_zoom_constant:new x.Uniform1i(C,c.u_is_size_zoom_constant),u_is_size_feature_constant:new x.Uniform1i(C,c.u_is_size_feature_constant),u_size_t:new x.Uniform1f(C,c.u_size_t),u_size:new x.Uniform1f(C,c.u_size),u_camera_to_center_distance:new x.Uniform1f(C,c.u_camera_to_center_distance),u_pitch:new x.Uniform1f(C,c.u_pitch),u_rotate_symbol:new x.Uniform1i(C,c.u_rotate_symbol),u_aspect_ratio:new x.Uniform1f(C,c.u_aspect_ratio),u_fade_change:new x.Uniform1f(C,c.u_fade_change),u_matrix:new x.UniformMatrix4f(C,c.u_matrix),u_label_plane_matrix:new x.UniformMatrix4f(C,c.u_label_plane_matrix),u_coord_matrix:new x.UniformMatrix4f(C,c.u_coord_matrix),u_is_text:new x.Uniform1i(C,c.u_is_text),u_pitch_with_map:new x.Uniform1i(C,c.u_pitch_with_map),u_texsize:new x.Uniform2f(C,c.u_texsize),u_texture:new x.Uniform1i(C,c.u_texture),u_gamma_scale:new x.Uniform1f(C,c.u_gamma_scale),u_device_pixel_ratio:new x.Uniform1f(C,c.u_device_pixel_ratio),u_is_halo:new x.Uniform1i(C,c.u_is_halo)}),symbolTextAndIcon:(C,c)=>({u_is_size_zoom_constant:new x.Uniform1i(C,c.u_is_size_zoom_constant),u_is_size_feature_constant:new x.Uniform1i(C,c.u_is_size_feature_constant),u_size_t:new x.Uniform1f(C,c.u_size_t),u_size:new x.Uniform1f(C,c.u_size),u_camera_to_center_distance:new x.Uniform1f(C,c.u_camera_to_center_distance),u_pitch:new x.Uniform1f(C,c.u_pitch),u_rotate_symbol:new x.Uniform1i(C,c.u_rotate_symbol),u_aspect_ratio:new x.Uniform1f(C,c.u_aspect_ratio),u_fade_change:new x.Uniform1f(C,c.u_fade_change),u_matrix:new x.UniformMatrix4f(C,c.u_matrix),u_label_plane_matrix:new x.UniformMatrix4f(C,c.u_label_plane_matrix),u_coord_matrix:new x.UniformMatrix4f(C,c.u_coord_matrix),u_is_text:new x.Uniform1i(C,c.u_is_text),u_pitch_with_map:new x.Uniform1i(C,c.u_pitch_with_map),u_texsize:new x.Uniform2f(C,c.u_texsize),u_texsize_icon:new x.Uniform2f(C,c.u_texsize_icon),u_texture:new x.Uniform1i(C,c.u_texture),u_texture_icon:new x.Uniform1i(C,c.u_texture_icon),u_gamma_scale:new x.Uniform1f(C,c.u_gamma_scale),u_device_pixel_ratio:new x.Uniform1f(C,c.u_device_pixel_ratio),u_is_halo:new x.Uniform1i(C,c.u_is_halo)}),background:(C,c)=>({u_matrix:new x.UniformMatrix4f(C,c.u_matrix),u_opacity:new x.Uniform1f(C,c.u_opacity),u_color:new x.UniformColor(C,c.u_color)}),backgroundPattern:(C,c)=>({u_matrix:new x.UniformMatrix4f(C,c.u_matrix),u_opacity:new x.Uniform1f(C,c.u_opacity),u_image:new x.Uniform1i(C,c.u_image),u_pattern_tl_a:new x.Uniform2f(C,c.u_pattern_tl_a),u_pattern_br_a:new x.Uniform2f(C,c.u_pattern_br_a),u_pattern_tl_b:new x.Uniform2f(C,c.u_pattern_tl_b),u_pattern_br_b:new x.Uniform2f(C,c.u_pattern_br_b),u_texsize:new x.Uniform2f(C,c.u_texsize),u_mix:new x.Uniform1f(C,c.u_mix),u_pattern_size_a:new x.Uniform2f(C,c.u_pattern_size_a),u_pattern_size_b:new x.Uniform2f(C,c.u_pattern_size_b),u_scale_a:new x.Uniform1f(C,c.u_scale_a),u_scale_b:new x.Uniform1f(C,c.u_scale_b),u_pixel_coord_upper:new x.Uniform2f(C,c.u_pixel_coord_upper),u_pixel_coord_lower:new x.Uniform2f(C,c.u_pixel_coord_lower),u_tile_units_to_pixels:new x.Uniform1f(C,c.u_tile_units_to_pixels)}),terrainRaster:xr,terrainDepth:xr,skybox:(C,c)=>({u_matrix:new x.UniformMatrix4f(C,c.u_matrix),u_sun_direction:new x.Uniform3f(C,c.u_sun_direction),u_cubemap:new x.Uniform1i(C,c.u_cubemap),u_opacity:new x.Uniform1f(C,c.u_opacity),u_temporal_offset:new x.Uniform1f(C,c.u_temporal_offset)}),skyboxGradient:(C,c)=>({u_matrix:new x.UniformMatrix4f(C,c.u_matrix),u_color_ramp:new x.Uniform1i(C,c.u_color_ramp),u_center_direction:new x.Uniform3f(C,c.u_center_direction),u_radius:new x.Uniform1f(C,c.u_radius),u_opacity:new x.Uniform1f(C,c.u_opacity),u_temporal_offset:new x.Uniform1f(C,c.u_temporal_offset)}),skyboxCapture:(C,c)=>({u_matrix_3f:new x.UniformMatrix3f(C,c.u_matrix_3f),u_sun_direction:new x.Uniform3f(C,c.u_sun_direction),u_sun_intensity:new x.Uniform1f(C,c.u_sun_intensity),u_color_tint_r:new x.Uniform4f(C,c.u_color_tint_r),u_color_tint_m:new x.Uniform4f(C,c.u_color_tint_m),u_luminance:new x.Uniform1f(C,c.u_luminance)})};let Cl;function _o(C,c,y,S,P,O,F){const U=C.context,q=U.gl,Y=C.useProgram("collisionBox"),te=[];let ie=0,se=0;for(let Je=0;Je<S.length;Je++){const ot=S[Je],Xe=c.getTile(ot),Ye=Xe.getBucket(y);if(!Ye)continue;let $t=ot.projMatrix;0===P[0]&&0===P[1]||($t=C.translatePosMatrix(ot.projMatrix,Xe,P,O));const qt=F?Ye.textCollisionBox:Ye.iconCollisionBox,Jt=Ye.collisionCircleArray;if(Jt.length>0){const et=x.create$1(),xn=$t;x.mul$1(et,Ye.placementInvProjMatrix,C.transform.glCoordMatrix),x.mul$1(et,et,Ye.placementViewportMatrix),te.push({circleArray:Jt,circleOffset:se,transform:xn,invTransform:et}),ie+=Jt.length/4,se=ie}qt&&(C.terrain&&C.terrain.setupElevationDraw(Xe,Y),Y.draw(U,q.LINES,x.DepthMode.disabled,x.StencilMode.disabled,C.colorModeForRenderPass(),x.CullFaceMode.disabled,ta($t,C.transform,Xe),y.id,qt.layoutVertexBuffer,qt.indexBuffer,qt.segments,null,C.transform.zoom,null,qt.collisionVertexBuffer,qt.collisionVertexBufferExt))}if(!F||!te.length)return;const we=C.useProgram("collisionCircle"),Fe=new x.StructArrayLayout2f1f2i16;Fe.resize(4*ie),Fe._trim();let Ve=0;for(const Je of te)for(let ot=0;ot<Je.circleArray.length/4;ot++){const Xe=4*ot,Ye=Je.circleArray[Xe+0],$t=Je.circleArray[Xe+1],qt=Je.circleArray[Xe+2],Jt=Je.circleArray[Xe+3];Fe.emplace(Ve++,Ye,$t,qt,Jt,0),Fe.emplace(Ve++,Ye,$t,qt,Jt,1),Fe.emplace(Ve++,Ye,$t,qt,Jt,2),Fe.emplace(Ve++,Ye,$t,qt,Jt,3)}(!Cl||Cl.length<2*ie)&&(Cl=function(Je){const ot=2*Je,Xe=new x.StructArrayLayout3ui6;Xe.resize(ot),Xe._trim();for(let Ye=0;Ye<ot;Ye++){const $t=6*Ye;Xe.uint16[$t+0]=4*Ye+0,Xe.uint16[$t+1]=4*Ye+1,Xe.uint16[$t+2]=4*Ye+2,Xe.uint16[$t+3]=4*Ye+2,Xe.uint16[$t+4]=4*Ye+3,Xe.uint16[$t+5]=4*Ye+0}return Xe}(ie));const nt=U.createIndexBuffer(Cl,!0),Te=U.createVertexBuffer(Fe,x.collisionCircleLayout.members,!0);for(const Je of te){const ot={u_matrix:Je.transform,u_inv_matrix:Je.invTransform,u_camera_to_center_distance:(He=C.transform).cameraToCenterDistance,u_viewport_size:[He.width,He.height]};we.draw(U,q.TRIANGLES,x.DepthMode.disabled,x.StencilMode.disabled,C.colorModeForRenderPass(),x.CullFaceMode.disabled,ot,y.id,Te,nt,x.SegmentVector.simpleSegment(0,2*Je.circleOffset,Je.circleArray.length,Je.circleArray.length/2),null,C.transform.zoom,null,null,null)}var He;Te.destroy(),nt.destroy()}const Zo=x.identity(new Float32Array(16));function yo(C,c,y,S,P,O){const{horizontalAlign:F,verticalAlign:U}=x.getAnchorAlignment(C),q=-(F-.5)*c,Y=-(U-.5)*y,te=x.evaluateVariableOffset(C,S);return new x.pointGeometry((q/P+te[0])*O,(Y/P+te[1])*O)}function Us(C,c,y,S,P,O,F,U,q,Y,te,ie){const se=C.text.placedSymbolArray,we=C.text.dynamicLayoutVertexArray,Fe=C.icon.dynamicLayoutVertexArray,Ve={};we.clear();for(let nt=0;nt<se.length;nt++){const Te=se.get(nt),He=C.allowVerticalPlacement&&!Te.placedOrientation,Je=Te.hidden||!Te.crossTileID||He?null:S[Te.crossTileID];if(Je){const ot=new x.pointGeometry(Te.anchorX,Te.anchorY),Xe=ie(ot),Ye=po(ot,y?U:F,Xe),$t=Rn(O.cameraToCenterDistance,Ye.signedDistanceFromCamera);let qt=P.evaluateSizeForFeature(C.textSizeData,Y,Te)*$t/x.ONE_EM;y&&(qt*=C.tilePixelRatio/q);const{width:Jt,height:et,anchor:xn,textOffset:un,textScale:Kn}=Je,En=yo(xn,Jt,et,un,Kn,qt),wn=y?po(ot.add(En),F,Xe).point:Ye.point.add(c?En.rotate(-O.angle):En),Ir=C.allowVerticalPlacement&&Te.placedOrientation===x.WritingMode.vertical?Math.PI/2:0;for(let pr=0;pr<Te.numGlyphs;pr++)x.addDynamicAttributes(we,wn,Ir);te&&Te.associatedIconIndex>=0&&(Ve[Te.associatedIconIndex]={shiftedAnchor:wn,angle:Ir})}else Qs(Te.numGlyphs,we)}if(te){Fe.clear();const nt=C.icon.placedSymbolArray;for(let Te=0;Te<nt.length;Te++){const He=nt.get(Te);if(He.hidden)Qs(He.numGlyphs,Fe);else{const Je=Ve[Te];if(Je)for(let ot=0;ot<He.numGlyphs;ot++)x.addDynamicAttributes(Fe,Je.shiftedAnchor,Je.angle);else Qs(He.numGlyphs,Fe)}}C.icon.dynamicLayoutVertexBuffer.updateData(Fe)}C.text.dynamicLayoutVertexBuffer.updateData(we)}function na(C,c,y){return y.iconsInText&&c?"symbolTextAndIcon":C?"symbolSDF":"symbolIcon"}function dr(C,c,y,S,P,O,F,U,q,Y,te,ie){const se=C.context,we=se.gl,Fe=C.transform,Ve="map"===U,nt="map"===q,Te=Ve&&"point"!==y.layout.get("symbol-placement"),He=Ve&&!nt&&!Te,Je=void 0!==y.layout.get("symbol-sort-key").constantOr(1);let ot=!1;const Xe=C.depthModeForSublayer(0,x.DepthMode.ReadOnly),Ye=y.layout.get("text-variable-anchor"),$t=[],qt=C.terrain&&nt?["PITCH_WITH_MAP_TERRAIN"]:null;for(const Jt of S){const et=c.getTile(Jt),xn=et.getBucket(y);if(!xn)continue;const un=P?xn.text:xn.icon;if(!un||!un.segments.get().length)continue;const Kn=un.programConfigurations.get(y.id),En=P||xn.sdfIcons,wn=P?xn.textSizeData:xn.iconSizeData,Ir=nt||0!==Fe.pitch,pr=C.useProgram(na(En,P,xn),Kn,qt),gi=x.evaluateSizeForZoom(wn,Fe.zoom);let yi,uo,Xr,bo,es=[0,0],Pl=null;if(P){if(uo=et.glyphAtlasTexture,Xr=we.LINEAR,yi=et.glyphAtlasTexture.size,xn.iconsInText){es=et.imageAtlasTexture.size,Pl=et.imageAtlasTexture;const Pa="composite"===wn.kind||"camera"===wn.kind;bo=Ir||C.options.rotating||C.options.zooming||Pa?we.LINEAR:we.NEAREST}}else{const Pa=1!==y.layout.get("icon-size").constantOr(0)||xn.iconsNeedLinear;uo=et.imageAtlasTexture,Xr=En||C.options.rotating||C.options.zooming||Pa||Ir?we.LINEAR:we.NEAREST,yi=et.imageAtlasTexture.size}const gu=Pe(et,1,C.transform.zoom),Rl=Xn(Jt.projMatrix,nt,Ve,C.transform,gu),Yu=C.terrain&&nt&&Te?x.invert(new Float32Array(16),Rl):Zo,Oc=wa(Jt.projMatrix,nt,Ve,C.transform,gu),ts=Ye&&xn.hasTextData(),ns="none"!==y.layout.get("icon-text-fit")&&ts&&xn.hasIconData();if(Te){const Pa=Fe.elevation;Nr(xn,Jt.projMatrix,C,P,Rl,Oc,nt,Y,Pa?Zu=>Pa.getAtTileOffset(Jt,Zu.x,Zu.y):null)}const ui=C.translatePosMatrix(Jt.projMatrix,et,O,F),ys=Te||P&&Ye||ns?Zo:Rl,Ga=C.translatePosMatrix(Oc,et,O,F,!0),rs=En&&0!==y.paint.get(P?"text-halo-width":"icon-halo-width").constantOr(1);let $a;$a=En?xn.iconsInText?On(wn.kind,gi,He,nt,C,ui,ys,Ga,yi,es):pa(wn.kind,gi,He,nt,C,ui,ys,Ga,P,yi,!0):Ja(wn.kind,gi,He,nt,C,ui,ys,Ga,P,yi);const yc={program:pr,buffers:un,uniformValues:$a,atlasTexture:uo,atlasTextureIcon:Pl,atlasInterpolation:Xr,atlasInterpolationIcon:bo,isSDF:En,hasHalo:rs,tile:et,labelPlaneMatrixInv:Yu};if(Je&&xn.canOverlap){ot=!0;const Pa=un.segments.get();for(const Zu of Pa)$t.push({segments:new x.SegmentVector([Zu]),sortKey:Zu.sortKey,state:yc})}else $t.push({segments:un.segments,sortKey:0,state:yc})}ot&&$t.sort((Jt,et)=>Jt.sortKey-et.sortKey);for(const Jt of $t){const et=Jt.state;if(C.terrain&&C.terrain.setupElevationDraw(et.tile,et.program,{useDepthForOcclusion:!0,labelPlaneMatrixInv:et.labelPlaneMatrixInv}),se.activeTexture.set(we.TEXTURE0),et.atlasTexture.bind(et.atlasInterpolation,we.CLAMP_TO_EDGE),et.atlasTextureIcon&&(se.activeTexture.set(we.TEXTURE1),et.atlasTextureIcon&&et.atlasTextureIcon.bind(et.atlasInterpolationIcon,we.CLAMP_TO_EDGE)),et.isSDF){const xn=et.uniformValues;et.hasHalo&&(xn.u_is_halo=1,Sl(et.buffers,Jt.segments,y,C,et.program,Xe,te,ie,xn)),xn.u_is_halo=0}Sl(et.buffers,Jt.segments,y,C,et.program,Xe,te,ie,et.uniformValues)}}function Sl(C,c,y,S,P,O,F,U,q){const Y=S.context;P.draw(Y,Y.gl.TRIANGLES,O,F,U,x.CullFaceMode.disabled,q,y.id,C.layoutVertexBuffer,C.indexBuffer,c,y.paint,S.transform.zoom,C.programConfigurations.get(y.id),C.dynamicLayoutVertexBuffer,C.opacityVertexBuffer)}function Is(C,c,y,S,P,O,F){const U=C.context.gl,q=y.paint.get("fill-pattern"),Y=q&&q.constantOr(1),te=y.getCrossfadeParameters();let ie,se,we,Fe,Ve;F?(se=Y&&!y.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",ie=U.LINES):(se=Y?"fillPattern":"fill",ie=U.TRIANGLES);for(const nt of S){const Te=c.getTile(nt);if(Y&&!Te.patternsLoaded())continue;const He=Te.getBucket(y);if(!He)continue;C.prepareDrawTile(nt);const Je=He.programConfigurations.get(y.id),ot=C.useProgram(se,Je);Y&&(C.context.activeTexture.set(U.TEXTURE0),Te.imageAtlasTexture.bind(U.LINEAR,U.CLAMP_TO_EDGE),Je.updatePaintBuffers(te));const Xe=q.constantOr(null);if(Xe&&Te.imageAtlas){const $t=Te.imageAtlas,qt=$t.patternPositions[Xe.to.toString()],Jt=$t.patternPositions[Xe.from.toString()];qt&&Jt&&Je.setConstantPatternPositions(qt,Jt)}const Ye=C.translatePosMatrix(nt.projMatrix,Te,y.paint.get("fill-translate"),y.paint.get("fill-translate-anchor"));if(F){Fe=He.indexBuffer2,Ve=He.segments2;const $t=C.terrain&&C.terrain.renderingToTexture?C.terrain.drapeBufferSize:[U.drawingBufferWidth,U.drawingBufferHeight];we="fillOutlinePattern"===se&&Y?ao(Ye,C,te,Te,$t):Yr(Ye,$t)}else Fe=He.indexBuffer,Ve=He.segments,we=Y?uu(Ye,C,te,Te):Xl(Ye);C.prepareDrawProgram(C.context,ot,nt.toUnwrapped()),ot.draw(C.context,ie,P,C.stencilModeForClipping(nt),O,x.CullFaceMode.disabled,we,y.id,He.layoutVertexBuffer,Fe,Ve,y.paint,C.transform.zoom,Je)}}function vo(C,c,y,S,P,O,F){const U=C.context,q=U.gl,Y=y.paint.get("fill-extrusion-pattern"),te=Y.constantOr(1),ie=y.getCrossfadeParameters(),se=y.paint.get("fill-extrusion-opacity");for(const we of S){const Fe=c.getTile(we),Ve=Fe.getBucket(y);if(!Ve)continue;const nt=Ve.programConfigurations.get(y.id),Te=C.useProgram(te?"fillExtrusionPattern":"fillExtrusion",nt);if(C.terrain){const Ye=C.terrain;if(!Ve.enableTerrain)continue;if(Ye.setupElevationDraw(Fe,Te,{useMeterToDem:!0}),mc(U,c,we,Ve,y,Ye),!Ve.centroidVertexBuffer){const $t=Te.attributes.a_centroid_pos;void 0!==$t&&q.vertexAttrib2f($t,0,0)}}te&&(C.context.activeTexture.set(q.TEXTURE0),Fe.imageAtlasTexture.bind(q.LINEAR,q.CLAMP_TO_EDGE),nt.updatePaintBuffers(ie));const He=Y.constantOr(null);if(He&&Fe.imageAtlas){const Ye=Fe.imageAtlas,$t=Ye.patternPositions[He.to.toString()],qt=Ye.patternPositions[He.from.toString()];$t&&qt&&nt.setConstantPatternPositions($t,qt)}const Je=C.translatePosMatrix(we.projMatrix,Fe,y.paint.get("fill-extrusion-translate"),y.paint.get("fill-extrusion-translate-anchor")),ot=y.paint.get("fill-extrusion-vertical-gradient"),Xe=te?Jc(Je,C,ot,se,we,ie,Fe):lu(Je,C,ot,se);C.prepareDrawProgram(U,Te,we.toUnwrapped()),Te.draw(U,U.gl.TRIANGLES,P,O,F,x.CullFaceMode.backCCW,Xe,y.id,Ve.layoutVertexBuffer,Ve.indexBuffer,Ve.segments,y.paint,C.transform.zoom,nt,C.terrain?Ve.centroidVertexBuffer:null)}}function mc(C,c,y,S,P,O){const F=[Te=>{let He=Te.canonical.x-1,Je=Te.wrap;return He<0&&(He=(1<<Te.canonical.z)-1,Je--),new x.OverscaledTileID(Te.overscaledZ,Je,Te.canonical.z,He,Te.canonical.y)},Te=>{let He=Te.canonical.x+1,Je=Te.wrap;return He===1<<Te.canonical.z&&(He=0,Je++),new x.OverscaledTileID(Te.overscaledZ,Je,Te.canonical.z,He,Te.canonical.y)},Te=>new x.OverscaledTileID(Te.overscaledZ,Te.wrap,Te.canonical.z,Te.canonical.x,(0===Te.canonical.y?1<<Te.canonical.z:Te.canonical.y)-1),Te=>new x.OverscaledTileID(Te.overscaledZ,Te.wrap,Te.canonical.z,Te.canonical.x,Te.canonical.y===(1<<Te.canonical.z)-1?0:Te.canonical.y+1)],U=Te=>{const He=c.getSource().maxzoom,Je=$t=>{const qt=c.getTileByID($t);if(qt&&qt.hasData())return qt.getBucket(P)};let ot,Xe,Ye;return(Te.overscaledZ===Te.canonical.z||Te.overscaledZ>=He)&&(ot=Je(Te.key)),Te.overscaledZ>=He&&(Xe=Je(Te.calculateScaledKey(Te.overscaledZ+1))),Te.overscaledZ>He&&(Ye=Je(Te.calculateScaledKey(Te.overscaledZ-1))),ot||Xe||Ye},q=[0,0,0],Y=(Te,He)=>(q[0]=Math.min(Te.min.y,He.min.y),q[1]=Math.max(Te.max.y,He.max.y),q[2]=x.EXTENT-He.min.x>Te.max.x?He.min.x-x.EXTENT:Te.max.x,q),te=(Te,He)=>(q[0]=Math.min(Te.min.x,He.min.x),q[1]=Math.max(Te.max.x,He.max.x),q[2]=x.EXTENT-He.min.y>Te.max.y?He.min.y-x.EXTENT:Te.max.y,q),ie=[(Te,He)=>Y(Te,He),(Te,He)=>Y(He,Te),(Te,He)=>te(Te,He),(Te,He)=>te(He,Te)],se=new x.pointGeometry(0,0);let we,Fe,Ve;const nt=(Te,He,Je,ot,Xe)=>{const Ye=[[ot?Je:Te,ot?Te:Je,0],[ot?Je:He,ot?He:Je,0]],$t=Xe<0?x.EXTENT+Xe:Xe,qt=[ot?$t:(Te+He)/2,ot?(Te+He)/2:$t,0];return 0===Je&&Xe<0||0!==Je&&Xe>0?O.getForTilePoints(Ve,[qt],!0,Fe):Ye.push(qt),O.getForTilePoints(y,Ye,!0,we),Math.max(Ye[0][2],Ye[1][2],qt[2])/O.exaggeration()};for(let Te=0;Te<4;Te++){const He=S.borders[Te];if(0===He.length&&(S.borderDone[Te]=!0),S.borderDone[Te])continue;const Je=Ve=F[Te](y),ot=U(Je);if(!(ot&&ot.enableTerrain&&(Fe=O.findDEMTileFor(Je),Fe&&Fe.dem)))continue;if(!we){const qt=O.findDEMTileFor(y);if(!qt||!qt.dem)return;we=qt}const Xe=(Te<2?1:5)-Te,Ye=ot.borders[Xe];let $t=0;for(let qt=0;qt<He.length;qt++){const Jt=S.featuresOnBorder[He[qt]],et=Jt.borders[Te];let xn;for(;$t<Ye.length&&(xn=ot.featuresOnBorder[Ye[$t]],!(xn.borders[Xe][1]>et[0]+3));)ot.borderDone[Xe]||ot.encodeCentroid(void 0,xn,!1),$t++;if(xn&&$t<Ye.length){const un=$t;let Kn=0;for(;!(xn.borders[Xe][0]>et[1]-3)&&(Kn++,++$t!==Ye.length);)xn=ot.featuresOnBorder[Ye[$t]];if(xn=ot.featuresOnBorder[Ye[un]],Jt.intersectsCount()>1||xn.intersectsCount()>1||1!==Kn){1!==Kn&&($t=un),S.encodeCentroid(void 0,Jt,!1),ot.borderDone[Xe]||ot.encodeCentroid(void 0,xn,!1);continue}const En=ie[Te](Jt,xn),wn=Te%2?x.EXTENT-1:0;se.x=nt(En[0],Math.min(x.EXTENT-1,En[1]),wn,Te<2,En[2]),se.y=0,S.encodeCentroid(se,Jt,!1),ot.borderDone[Xe]||ot.encodeCentroid(se,xn,!1)}else S.encodeCentroid(void 0,Jt,!1)}S.borderDone[Te]=S.needsCentroidUpdate=!0,ot.borderDone[Xe]||(ot.borderDone[Xe]=ot.needsCentroidUpdate=!0)}(S.needsCentroidUpdate||!S.centroidVertexBuffer&&0!==S.centroidVertexArray.length)&&S.uploadCentroid(C)}const ra=new x.Color(1,0,0,1),br=new x.Color(0,1,0,1),Ta=new x.Color(0,0,1,1),ws=new x.Color(1,0,1,1),Io=new x.Color(0,1,1,1);function Es(C,c,y,S){du(C,0,c+y/2,C.transform.width,y,S)}function Wd(C,c,y,S){du(C,c-y/2,0,y,C.transform.height,S)}function du(C,c,y,S,P,O){const F=C.context,U=F.gl;U.enable(U.SCISSOR_TEST),U.scissor(c*x.exported.devicePixelRatio,y*x.exported.devicePixelRatio,S*x.exported.devicePixelRatio,P*x.exported.devicePixelRatio),F.clear({color:O}),U.disable(U.SCISSOR_TEST)}function Hu(C,c,y){const S=C.context,P=S.gl,O=y.projMatrix,F=C.useProgram("debug"),U=c.getTileByID(y.key);C.terrain&&C.terrain.setupElevationDraw(U,F);const q=x.DepthMode.disabled,Y=x.StencilMode.disabled,te=C.colorModeForRenderPass();S.activeTexture.set(P.TEXTURE0),C.emptyTexture.bind(P.LINEAR,P.CLAMP_TO_EDGE),F.draw(S,P.LINE_STRIP,q,Y,te,x.CullFaceMode.disabled,Ac(O,x.Color.red),"$debug",C.debugBuffer,C.tileBorderIndexBuffer,C.debugSegments);const se=U.latestRawTileData,we=Math.floor((se&&se.byteLength||0)/1024),Fe=c.getTile(y).tileSize,Ve=512/Math.min(Fe,512)*(y.overscaledZ/C.transform.zoom)*.5;let nt=y.canonical.toString();y.overscaledZ!==y.canonical.z&&(nt+=` => ${y.overscaledZ}`),function(Te,He){Te.initDebugOverlayCanvas();const Je=Te.debugOverlayCanvas,ot=Te.context.gl,Xe=Te.debugOverlayCanvas.getContext("2d");Xe.clearRect(0,0,Je.width,Je.height),Xe.shadowColor="white",Xe.shadowBlur=2,Xe.lineWidth=1.5,Xe.strokeStyle="white",Xe.textBaseline="top",Xe.font="bold 36px Open Sans, sans-serif",Xe.fillText(He,5,5),Xe.strokeText(He,5,5),Te.debugOverlayTexture.update(Je),Te.debugOverlayTexture.bind(ot.LINEAR,ot.CLAMP_TO_EDGE)}(C,`${nt} ${we}kb`),F.draw(S,P.TRIANGLES,q,Y,x.ColorMode.alphaBlended,x.CullFaceMode.disabled,Ac(O,x.Color.transparent,Ve),"$debug",C.debugBuffer,C.quadTriangleIndexBuffer,C.debugSegments)}const Qc=x.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:Pc}=Qc;function ds(C,c,y,S){C.emplaceBack(c,y,S)}class lo{constructor(c){this.vertexArray=new x.StructArrayLayout3f12,this.indices=new x.StructArrayLayout3ui6,ds(this.vertexArray,-1,-1,1),ds(this.vertexArray,1,-1,1),ds(this.vertexArray,-1,1,1),ds(this.vertexArray,1,1,1),ds(this.vertexArray,-1,-1,-1),ds(this.vertexArray,1,-1,-1),ds(this.vertexArray,-1,1,-1),ds(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=c.createVertexBuffer(this.vertexArray,Pc),this.indexBuffer=c.createIndexBuffer(this.indices),this.segment=x.SegmentVector.simpleSegment(0,0,36,12)}}function Oo(C,c,y,S,P,O){const F=C.gl,U=c.paint.get("sky-atmosphere-color"),q=c.paint.get("sky-atmosphere-halo-color"),Y=c.paint.get("sky-atmosphere-sun-intensity"),te={u_matrix_3f:x.fromMat4([],S),u_sun_direction:P,u_sun_intensity:Y,u_color_tint_r:[(Fe=U).r,Fe.g,Fe.b,Fe.a],u_color_tint_m:[(Ve=q).r,Ve.g,Ve.b,Ve.a],u_luminance:5e-5};var Fe,Ve;F.framebufferTexture2D(F.FRAMEBUFFER,F.COLOR_ATTACHMENT0,F.TEXTURE_CUBE_MAP_POSITIVE_X+O,c.skyboxTexture,0),y.draw(C,F.TRIANGLES,x.DepthMode.disabled,x.StencilMode.disabled,x.ColorMode.unblended,x.CullFaceMode.frontCW,te,"skyboxCapture",c.skyboxGeometry.vertexBuffer,c.skyboxGeometry.indexBuffer,c.skyboxGeometry.segment)}const ga={symbol:function(C,c,y,S,P){if("translucent"!==C.renderPass)return;const O=x.StencilMode.disabled,F=C.colorModeForRenderPass();y.layout.get("text-variable-anchor")&&function(U,q,Y,te,ie,se,we){const Fe=q.transform,Ve="map"===ie,nt="map"===se;for(const Te of U){const He=te.getTile(Te),Je=He.getBucket(Y);if(!Je||!Je.text||!Je.text.segments.get().length)continue;const ot=x.evaluateSizeForZoom(Je.textSizeData,Fe.zoom),Xe=Pe(He,1,q.transform.zoom),Ye=Xn(Te.projMatrix,nt,Ve,q.transform,Xe),$t="none"!==Y.layout.get("icon-text-fit")&&Je.hasIconData();if(ot){const qt=Math.pow(2,Fe.zoom-He.tileID.overscaledZ),Jt=Fe.elevation;Us(Je,Ve,nt,we,x.symbolSize,Fe,Ye,Te.projMatrix,qt,ot,$t,Jt?et=>Jt.getAtTileOffset(Te,et.x,et.y):et=>0)}}}(S,C,y,c,y.layout.get("text-rotation-alignment"),y.layout.get("text-pitch-alignment"),P),0!==y.paint.get("icon-opacity").constantOr(1)&&dr(C,c,y,S,!1,y.paint.get("icon-translate"),y.paint.get("icon-translate-anchor"),y.layout.get("icon-rotation-alignment"),y.layout.get("icon-pitch-alignment"),y.layout.get("icon-keep-upright"),O,F),0!==y.paint.get("text-opacity").constantOr(1)&&dr(C,c,y,S,!0,y.paint.get("text-translate"),y.paint.get("text-translate-anchor"),y.layout.get("text-rotation-alignment"),y.layout.get("text-pitch-alignment"),y.layout.get("text-keep-upright"),O,F),c.map.showCollisionBoxes&&(_o(C,c,y,S,y.paint.get("text-translate"),y.paint.get("text-translate-anchor"),!0),_o(C,c,y,S,y.paint.get("icon-translate"),y.paint.get("icon-translate-anchor"),!1))},circle:function(C,c,y,S){if("translucent"!==C.renderPass)return;const P=y.paint.get("circle-opacity"),O=y.paint.get("circle-stroke-width"),F=y.paint.get("circle-stroke-opacity"),U=void 0!==y.layout.get("circle-sort-key").constantOr(1);if(0===P.constantOr(1)&&(0===O.constantOr(1)||0===F.constantOr(1)))return;const q=C.context,Y=q.gl,te=C.depthModeForSublayer(0,x.DepthMode.ReadOnly),ie=x.StencilMode.disabled,se=C.colorModeForRenderPass(),we=[];for(let Fe=0;Fe<S.length;Fe++){const Ve=S[Fe],nt=c.getTile(Ve),Te=nt.getBucket(y);if(!Te)continue;const He=Te.programConfigurations.get(y.id),Je=gc(y),ot={programConfiguration:He,program:C.useProgram("circle",He,Je),layoutVertexBuffer:Te.layoutVertexBuffer,indexBuffer:Te.indexBuffer,uniformValues:ii(C,Ve,nt,y),tile:nt};if(U){const Xe=Te.segments.get();for(const Ye of Xe)we.push({segments:new x.SegmentVector([Ye]),sortKey:Ye.sortKey,state:ot})}else we.push({segments:Te.segments,sortKey:0,state:ot})}U&&we.sort((Fe,Ve)=>Fe.sortKey-Ve.sortKey);for(const Fe of we){const{programConfiguration:Ve,program:nt,layoutVertexBuffer:Te,indexBuffer:He,uniformValues:Je,tile:ot}=Fe.state,Xe=Fe.segments;C.terrain&&C.terrain.setupElevationDraw(ot,nt,{useDepthForOcclusion:!0}),C.prepareDrawProgram(q,nt,ot.tileID.toUnwrapped()),nt.draw(q,Y.TRIANGLES,te,ie,se,x.CullFaceMode.disabled,Je,y.id,Te,He,Xe,y.paint,C.transform.zoom,Ve)}},heatmap:function(C,c,y,S){if(0!==y.paint.get("heatmap-opacity"))if("offscreen"===C.renderPass){const P=C.context,O=P.gl,F=x.StencilMode.disabled,U=new x.ColorMode([O.ONE,O.ONE],x.Color.transparent,[!0,!0,!0,!0]);(function(q,Y,te){const ie=q.gl;q.activeTexture.set(ie.TEXTURE1),q.viewport.set([0,0,Y.width/4,Y.height/4]);let se=te.heatmapFbo;if(se)ie.bindTexture(ie.TEXTURE_2D,se.colorAttachment.get()),q.bindFramebuffer.set(se.framebuffer);else{const we=ie.createTexture();ie.bindTexture(ie.TEXTURE_2D,we),ie.texParameteri(ie.TEXTURE_2D,ie.TEXTURE_WRAP_S,ie.CLAMP_TO_EDGE),ie.texParameteri(ie.TEXTURE_2D,ie.TEXTURE_WRAP_T,ie.CLAMP_TO_EDGE),ie.texParameteri(ie.TEXTURE_2D,ie.TEXTURE_MIN_FILTER,ie.LINEAR),ie.texParameteri(ie.TEXTURE_2D,ie.TEXTURE_MAG_FILTER,ie.LINEAR),se=te.heatmapFbo=q.createFramebuffer(Y.width/4,Y.height/4,!1),function(Fe,Ve,nt,Te){const He=Fe.gl;He.texImage2D(He.TEXTURE_2D,0,He.RGBA,Ve.width/4,Ve.height/4,0,He.RGBA,Fe.extRenderToTextureHalfFloat?Fe.extTextureHalfFloat.HALF_FLOAT_OES:He.UNSIGNED_BYTE,null),Te.colorAttachment.set(nt)}(q,Y,we,se)}})(P,C,y),P.clear({color:x.Color.transparent});for(let q=0;q<S.length;q++){const Y=S[q];if(c.hasRenderableParent(Y))continue;const te=c.getTile(Y),ie=te.getBucket(y);if(!ie)continue;const se=ie.programConfigurations.get(y.id),we=C.useProgram("heatmap",se),{zoom:Fe}=C.transform;C.terrain&&C.terrain.setupElevationDraw(te,we),C.prepareDrawProgram(P,we,Y.toUnwrapped()),we.draw(P,O.TRIANGLES,x.DepthMode.disabled,F,U,x.CullFaceMode.disabled,Gn(Y.projMatrix,te,Fe,y.paint.get("heatmap-intensity")),y.id,ie.layoutVertexBuffer,ie.indexBuffer,ie.segments,y.paint,C.transform.zoom,se)}P.viewport.set([0,0,C.width,C.height])}else"translucent"===C.renderPass&&(C.context.setColorMode(C.colorModeForRenderPass()),function(P,O){const F=P.context,U=F.gl,q=O.heatmapFbo;if(!q)return;F.activeTexture.set(U.TEXTURE0),U.bindTexture(U.TEXTURE_2D,q.colorAttachment.get()),F.activeTexture.set(U.TEXTURE1);let Y=O.colorRampTexture;Y||(Y=O.colorRampTexture=new x.Texture(F,O.colorRamp,U.RGBA)),Y.bind(U.LINEAR,U.CLAMP_TO_EDGE),P.useProgram("heatmapTexture").draw(F,U.TRIANGLES,x.DepthMode.disabled,x.StencilMode.disabled,P.colorModeForRenderPass(),x.CullFaceMode.disabled,{u_image:0,u_color_ramp:1,u_opacity:O.paint.get("heatmap-opacity")},O.id,P.viewportBuffer,P.quadTriangleIndexBuffer,P.viewportSegments,O.paint,P.transform.zoom)}(C,y))},line:function(C,c,y,S){if("translucent"!==C.renderPass)return;const P=y.paint.get("line-opacity"),O=y.paint.get("line-width");if(0===P.constantOr(1)||0===O.constantOr(1))return;const F=C.depthModeForSublayer(0,x.DepthMode.ReadOnly),U=C.colorModeForRenderPass(),q=y.paint.get("line-dasharray"),Y=q.constantOr(1),te=y.layout.get("line-cap"),ie=y.paint.get("line-pattern"),se=ie.constantOr(1),we=y.paint.get("line-gradient"),Fe=y.getCrossfadeParameters(),Ve=se?"linePattern":Y?"lineSDF":we?"lineGradient":"line",nt=C.context,Te=nt.gl;for(const He of S){const Je=c.getTile(He);if(se&&!Je.patternsLoaded())continue;const ot=Je.getBucket(y);if(!ot)continue;C.prepareDrawTile(He);const Xe=ot.programConfigurations.get(y.id),Ye=C.useProgram(Ve,Xe),$t=ie.constantOr(null);if($t&&Je.imageAtlas){const un=Je.imageAtlas,Kn=un.patternPositions[$t.to.toString()],En=un.patternPositions[$t.from.toString()];Kn&&En&&Xe.setConstantPatternPositions(Kn,En)}const qt=q.constantOr(null),Jt=te.constantOr(null);if(!se&&qt&&Jt&&Je.lineAtlas){const un=Je.lineAtlas,Kn=un.getDash(qt.to,Jt),En=un.getDash(qt.from,Jt);Kn&&En&&Xe.setConstantPatternPositions(Kn,En)}const et=C.terrain?He.projMatrix:null,xn=se?Fn(C,Je,y,Fe,et):Y?Yi(C,Je,y,Fe,et):we?_i(C,Je,y,et,ot.lineClipsArray.length):cu(C,Je,y,et);if(se)nt.activeTexture.set(Te.TEXTURE0),Je.imageAtlasTexture.bind(Te.LINEAR,Te.CLAMP_TO_EDGE),Xe.updatePaintBuffers(Fe);else if(Y)nt.activeTexture.set(Te.TEXTURE0),Je.lineAtlasTexture.bind(Te.LINEAR,Te.REPEAT),Xe.updatePaintBuffers(Fe);else if(we){const un=ot.gradients[y.id];let Kn=un.texture;if(y.gradientVersion!==un.version){let En=256;if(y.stepInterpolant){const wn=c.getSource().maxzoom,Ir=He.canonical.z===wn?Math.ceil(1<<C.transform.maxZoom-He.canonical.z):1;En=x.clamp(x.nextPowerOfTwo(ot.maxLineLength/x.EXTENT*1024*Ir),256,nt.maxTextureSize)}un.gradient=x.renderColorRamp({expression:y.gradientExpression(),evaluationKey:"lineProgress",resolution:En,image:un.gradient||void 0,clips:ot.lineClipsArray}),un.texture?un.texture.update(un.gradient):un.texture=new x.Texture(nt,un.gradient,Te.RGBA),un.version=y.gradientVersion,Kn=un.texture}nt.activeTexture.set(Te.TEXTURE0),Kn.bind(y.stepInterpolant?Te.NEAREST:Te.LINEAR,Te.CLAMP_TO_EDGE)}C.prepareDrawProgram(nt,Ye,He.toUnwrapped()),Ye.draw(nt,Te.TRIANGLES,F,C.stencilModeForClipping(He),U,x.CullFaceMode.disabled,xn,y.id,ot.layoutVertexBuffer,ot.indexBuffer,ot.segments,y.paint,C.transform.zoom,Xe,ot.layoutVertexBuffer2)}},fill:function(C,c,y,S){const P=y.paint.get("fill-color"),O=y.paint.get("fill-opacity");if(0===O.constantOr(1))return;const F=C.colorModeForRenderPass(),U=y.paint.get("fill-pattern"),q=C.opaquePassEnabledForLayer()&&!U.constantOr(1)&&1===P.constantOr(x.Color.transparent).a&&1===O.constantOr(0)?"opaque":"translucent";if(C.renderPass===q){const Y=C.depthModeForSublayer(1,"opaque"===C.renderPass?x.DepthMode.ReadWrite:x.DepthMode.ReadOnly);Is(C,c,y,S,Y,F,!1)}if("translucent"===C.renderPass&&y.paint.get("fill-antialias")){const Y=C.depthModeForSublayer(y.getPaintProperty("fill-outline-color")?2:0,x.DepthMode.ReadOnly);Is(C,c,y,S,Y,F,!0)}},"fill-extrusion":function(C,c,y,S){const P=y.paint.get("fill-extrusion-opacity");if(0!==P&&"translucent"===C.renderPass){const O=new x.DepthMode(C.context.gl.LEQUAL,x.DepthMode.ReadWrite,C.depthRangeFor3D);if(1!==P||y.paint.get("fill-extrusion-pattern").constantOr(1))vo(C,c,y,S,O,x.StencilMode.disabled,x.ColorMode.disabled),vo(C,c,y,S,O,C.stencilModeFor3D(),C.colorModeForRenderPass());else{const F=C.colorModeForRenderPass();vo(C,c,y,S,O,x.StencilMode.disabled,F)}}},hillshade:function(C,c,y,S){if("offscreen"!==C.renderPass&&"translucent"!==C.renderPass)return;const P=C.context,O=C.depthModeForSublayer(0,x.DepthMode.ReadOnly),F=C.colorModeForRenderPass(),U=C.terrain&&C.terrain.renderingToTexture,[q,Y]="translucent"!==C.renderPass||U?[{},S]:C.stencilConfigForOverlap(S);for(const te of Y){const ie=c.getTile(te);if(ie.needsHillshadePrepare&&"offscreen"===C.renderPass)Lh(C,ie,y,O,x.StencilMode.disabled,F);else if("translucent"===C.renderPass){const se=U&&C.terrain?C.terrain.stencilModeForRTTOverlap(te):q[te.overscaledZ];ul(C,te,ie,y,O,se,F)}}P.viewport.set([0,0,C.width,C.height])},raster:function(C,c,y,S,P,O){if("translucent"!==C.renderPass||0===y.paint.get("raster-opacity")||!S.length)return;const F=C.context,U=F.gl,q=c.getSource(),Y=C.useProgram("raster"),te=C.colorModeForRenderPass(),ie=C.terrain&&C.terrain.renderingToTexture,[se,we]=q instanceof Re||ie?[{},S]:C.stencilConfigForOverlap(S),Fe=we[we.length-1].overscaledZ,Ve=!C.options.moving;for(const nt of we){const Te=ie?x.DepthMode.disabled:C.depthModeForSublayer(nt.overscaledZ-Fe,1===y.paint.get("raster-opacity")?x.DepthMode.ReadWrite:x.DepthMode.ReadOnly,U.LESS),He=nt.toUnwrapped(),Je=c.getTile(nt);if(ie&&(!Je||!Je.hasData()))continue;const ot=ie?nt.projMatrix:C.transform.calculateProjMatrix(He,Ve),Xe=C.terrain&&ie?C.terrain.stencilModeForRTTOverlap(nt):se[nt.overscaledZ],Ye=O?0:y.paint.get("raster-fade-duration");Je.registerFadeDuration(Ye);const $t=c.findLoadedParent(nt,0),qt=Kc(Je,$t,c,C.transform,Ye);let Jt,et;C.terrain&&C.terrain.prepareDrawTile(nt);const xn="nearest"===y.paint.get("raster-resampling")?U.NEAREST:U.LINEAR;F.activeTexture.set(U.TEXTURE0),Je.texture.bind(xn,U.CLAMP_TO_EDGE,U.LINEAR_MIPMAP_NEAREST),F.activeTexture.set(U.TEXTURE1),$t?($t.texture.bind(xn,U.CLAMP_TO_EDGE,U.LINEAR_MIPMAP_NEAREST),Jt=Math.pow(2,$t.tileID.overscaledZ-Je.tileID.overscaledZ),et=[Je.tileID.canonical.x*Jt%1,Je.tileID.canonical.y*Jt%1]):Je.texture.bind(xn,U.CLAMP_TO_EDGE,U.LINEAR_MIPMAP_NEAREST);const un=Ka(ot,et||[0,0],Jt||1,qt,y);C.prepareDrawProgram(F,Y,He),q instanceof Re?Y.draw(F,U.TRIANGLES,Te,x.StencilMode.disabled,te,x.CullFaceMode.disabled,un,y.id,q.boundsBuffer,C.quadTriangleIndexBuffer,q.boundsSegments):Y.draw(F,U.TRIANGLES,Te,Xe,te,x.CullFaceMode.disabled,un,y.id,C.rasterBoundsBuffer,C.quadTriangleIndexBuffer,C.rasterBoundsSegments)}},background:function(C,c,y,S){const P=y.paint.get("background-color"),O=y.paint.get("background-opacity");if(0===O)return;const F=C.context,U=F.gl,q=C.transform,Y=q.tileSize,te=y.paint.get("background-pattern");if(C.isPatternMissing(te))return;const ie=!te&&1===P.a&&1===O&&C.opaquePassEnabledForLayer()?"opaque":"translucent";if(C.renderPass!==ie)return;const se=x.StencilMode.disabled,we=C.depthModeForSublayer(0,"opaque"===ie?x.DepthMode.ReadWrite:x.DepthMode.ReadOnly),Fe=C.colorModeForRenderPass(),Ve=C.useProgram(te?"backgroundPattern":"background"),nt=S||q.coveringTiles({tileSize:Y});te&&(F.activeTexture.set(U.TEXTURE0),C.imageManager.bind(C.context));const Te=y.getCrossfadeParameters();for(const He of nt){const Je=He.toUnwrapped(),ot=S?He.projMatrix:C.transform.calculateProjMatrix(Je);C.prepareDrawTile(He);const Xe=te?Wr(ot,O,C,te,{tileID:He,tileSize:Y},Te):Dr(ot,O,P);C.prepareDrawProgram(F,Ve,Je),Ve.draw(F,U.TRIANGLES,we,se,Fe,x.CullFaceMode.disabled,Xe,y.id,C.tileExtentBuffer,C.quadTriangleIndexBuffer,C.tileExtentSegments)}},sky:function(C,c,y){const S=y.paint.get("sky-opacity");if(0===S)return;const P=C.context,O=y.paint.get("sky-type"),F=new x.DepthMode(P.gl.LEQUAL,x.DepthMode.ReadOnly,[0,1]),U=C.frameCounter/1e3%1;"atmosphere"===O?"offscreen"===C.renderPass?y.needsSkyboxCapture(C)&&(function(q,Y,te,ie){const se=q.context,we=se.gl;let Fe=Y.skyboxFbo;if(!Fe){Fe=Y.skyboxFbo=se.createFramebuffer(32,32,!1),Y.skyboxGeometry=new lo(se),Y.skyboxTexture=se.gl.createTexture(),we.bindTexture(we.TEXTURE_CUBE_MAP,Y.skyboxTexture),we.texParameteri(we.TEXTURE_CUBE_MAP,we.TEXTURE_WRAP_S,we.CLAMP_TO_EDGE),we.texParameteri(we.TEXTURE_CUBE_MAP,we.TEXTURE_WRAP_T,we.CLAMP_TO_EDGE),we.texParameteri(we.TEXTURE_CUBE_MAP,we.TEXTURE_MIN_FILTER,we.LINEAR),we.texParameteri(we.TEXTURE_CUBE_MAP,we.TEXTURE_MAG_FILTER,we.LINEAR);for(let He=0;He<6;++He)we.texImage2D(we.TEXTURE_CUBE_MAP_POSITIVE_X+He,0,we.RGBA,32,32,0,we.RGBA,we.UNSIGNED_BYTE,null)}se.bindFramebuffer.set(Fe.framebuffer),se.viewport.set([0,0,32,32]);const Ve=Y.getCenter(q,!0),nt=q.useProgram("skyboxCapture"),Te=new Float64Array(16);x.identity(Te),x.rotateY(Te,Te,.5*-Math.PI),Oo(se,Y,nt,Te,Ve,0),x.identity(Te),x.rotateY(Te,Te,.5*Math.PI),Oo(se,Y,nt,Te,Ve,1),x.identity(Te),x.rotateX(Te,Te,.5*-Math.PI),Oo(se,Y,nt,Te,Ve,2),x.identity(Te),x.rotateX(Te,Te,.5*Math.PI),Oo(se,Y,nt,Te,Ve,3),x.identity(Te),Oo(se,Y,nt,Te,Ve,4),x.identity(Te),x.rotateY(Te,Te,Math.PI),Oo(se,Y,nt,Te,Ve,5),se.viewport.set([0,0,q.width,q.height])}(C,y),y.markSkyboxValid(C)):"sky"===C.renderPass&&function(q,Y,te,ie,se){const we=q.context,Fe=we.gl,Ve=q.transform,nt=q.useProgram("skybox");we.activeTexture.set(Fe.TEXTURE0),Fe.bindTexture(Fe.TEXTURE_CUBE_MAP,Y.skyboxTexture);const Te={u_matrix:Ve.skyboxMatrix,u_sun_direction:Y.getCenter(q,!1),u_cubemap:0,u_opacity:ie,u_temporal_offset:se};q.prepareDrawProgram(we,nt),nt.draw(we,Fe.TRIANGLES,te,x.StencilMode.disabled,q.colorModeForRenderPass(),x.CullFaceMode.backCW,Te,"skybox",Y.skyboxGeometry.vertexBuffer,Y.skyboxGeometry.indexBuffer,Y.skyboxGeometry.segment)}(C,y,F,S,U):"gradient"===O&&"sky"===C.renderPass&&function(q,Y,te,ie,se){const we=q.context,Fe=we.gl,Ve=q.transform,nt=q.useProgram("skyboxGradient");Y.skyboxGeometry||(Y.skyboxGeometry=new lo(we)),we.activeTexture.set(Fe.TEXTURE0);let Te=Y.colorRampTexture;Te||(Te=Y.colorRampTexture=new x.Texture(we,Y.colorRamp,Fe.RGBA)),Te.bind(Fe.LINEAR,Fe.CLAMP_TO_EDGE);const He=(Je=Ve.skyboxMatrix,ot=Y.getCenter(q,!1),Xe=Y.paint.get("sky-gradient-radius"),Ye=ie,$t=se,{u_matrix:Je,u_color_ramp:0,u_center_direction:ot,u_radius:x.degToRad(Xe),u_opacity:Ye,u_temporal_offset:$t});var Je,ot,Xe,Ye,$t;q.prepareDrawProgram(we,nt),nt.draw(we,Fe.TRIANGLES,te,x.StencilMode.disabled,q.colorModeForRenderPass(),x.CullFaceMode.backCW,He,"skyboxGradient",Y.skyboxGeometry.vertexBuffer,Y.skyboxGeometry.indexBuffer,Y.skyboxGeometry.segment)}(C,y,F,S,U)},debug:function(C,c,y){for(let S=0;S<y.length;S++)Hu(C,c,y[S])},custom:function(C,c,y){const S=C.context,P=y.implementation;if("offscreen"===C.renderPass){const O=P.prerender;O&&(C.setCustomLayerDefaults(),S.setColorMode(C.colorModeForRenderPass()),O.call(P,S.gl,C.transform.customLayerMatrix()),S.setDirty(),C.setBaseState())}else if("translucent"===C.renderPass){C.setCustomLayerDefaults(),S.setColorMode(C.colorModeForRenderPass()),S.setStencilMode(x.StencilMode.disabled);const O="3d"===P.renderingMode?new x.DepthMode(C.context.gl.LEQUAL,x.DepthMode.ReadWrite,C.depthRangeFor3D):C.depthModeForSublayer(0,x.DepthMode.ReadOnly);S.setDepthMode(O),P.render(S.gl,C.transform.customLayerMatrix()),S.setDirty(),C.setBaseState(),S.bindFramebuffer.set(null)}}};class xo{constructor(c,y){this.context=new al(c),this.transform=y,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=x.SourceCache.maxUnderzooming+x.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Gr,this.gpuTimers={},this.frameCounter=0}updateTerrain(c,y){const S=!!c&&!!c.terrain;if(!(S||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new ro(this,c));const P=this._terrain;this.transform.elevation=S?P:null,P.update(c,this.transform,y)}_updateFog(c){const y=c.fog;if(!y||y.getOpacity(this.transform.pitch)<1||y.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[S,P]=y.getFovAdjustedRange(this.transform._fov);if(S>P)return void(this.transform.fogCullDistSq=null);const O=S+.78*(P-S);this.transform.fogCullDistSq=O*O}get terrain(){return this._terrain&&this._terrain.enabled?this._terrain:null}resize(c,y){if(this.width=c*x.exported.devicePixelRatio,this.height=y*x.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const S of this.style.order)this.style._layers[S].resize()}setup(){const c=this.context,y=new x.StructArrayLayout2i4;y.emplaceBack(0,0),y.emplaceBack(x.EXTENT,0),y.emplaceBack(0,x.EXTENT),y.emplaceBack(x.EXTENT,x.EXTENT),this.tileExtentBuffer=c.createVertexBuffer(y,x.posAttributes.members),this.tileExtentSegments=x.SegmentVector.simpleSegment(0,0,4,2);const S=new x.StructArrayLayout2i4;S.emplaceBack(0,0),S.emplaceBack(x.EXTENT,0),S.emplaceBack(0,x.EXTENT),S.emplaceBack(x.EXTENT,x.EXTENT),this.debugBuffer=c.createVertexBuffer(S,x.posAttributes.members),this.debugSegments=x.SegmentVector.simpleSegment(0,0,4,5);const P=new x.StructArrayLayout4i8;P.emplaceBack(0,0,0,0),P.emplaceBack(x.EXTENT,0,x.EXTENT,0),P.emplaceBack(0,x.EXTENT,0,x.EXTENT),P.emplaceBack(x.EXTENT,x.EXTENT,x.EXTENT,x.EXTENT),this.rasterBoundsBuffer=c.createVertexBuffer(P,Bs.members),this.rasterBoundsSegments=x.SegmentVector.simpleSegment(0,0,4,2);const O=new x.StructArrayLayout2i4;O.emplaceBack(-1,-1),O.emplaceBack(1,-1),O.emplaceBack(-1,1),O.emplaceBack(1,1),this.viewportBuffer=c.createVertexBuffer(O,x.posAttributes.members),this.viewportSegments=x.SegmentVector.simpleSegment(0,0,4,2);const F=new x.StructArrayLayout1ui2;F.emplaceBack(0),F.emplaceBack(1),F.emplaceBack(3),F.emplaceBack(2),F.emplaceBack(0),this.tileBorderIndexBuffer=c.createIndexBuffer(F);const U=new x.StructArrayLayout3ui6;U.emplaceBack(0,1,2),U.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=c.createIndexBuffer(U),this.emptyTexture=new x.Texture(c,{width:1,height:1,data:new Uint8Array([0,0,0,0])},c.gl.RGBA),this.identityMat=x.create$1();const q=this.context.gl;this.stencilClearMode=new x.StencilMode({func:q.ALWAYS,mask:0},0,255,q.ZERO,q.ZERO,q.ZERO),this.loadTimeStamps.push(x.window.performance.now())}clearStencil(){const c=this.context,y=c.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this.useProgram("clippingMask").draw(c,y.TRIANGLES,x.DepthMode.disabled,this.stencilClearMode,x.ColorMode.disabled,x.CullFaceMode.disabled,jr(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(c,y,S){if(!(y&&this.currentStencilSource!==y.id&&c.isTileClipped()&&S&&S.length))return;this.currentStencilSource=y.id;const P=this.context,O=P.gl;this.nextStencilID+S.length>256&&this.clearStencil(),P.setColorMode(x.ColorMode.disabled),P.setDepthMode(x.DepthMode.disabled);const F=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const U of S){const q=this._tileClippingMaskIDs[U.key]=this.nextStencilID++;F.draw(P,O.TRIANGLES,x.DepthMode.disabled,new x.StencilMode({func:O.ALWAYS,mask:0},q,255,O.KEEP,O.KEEP,O.REPLACE),x.ColorMode.disabled,x.CullFaceMode.disabled,jr(U.projMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const c=this.nextStencilID++,y=this.context.gl;return new x.StencilMode({func:y.NOTEQUAL,mask:255},c,255,y.KEEP,y.KEEP,y.REPLACE)}stencilModeForClipping(c){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(c);const y=this.context.gl;return new x.StencilMode({func:y.EQUAL,mask:255},this._tileClippingMaskIDs[c.key],0,y.KEEP,y.KEEP,y.REPLACE)}stencilConfigForOverlap(c){const y=this.context.gl,S=c.sort((F,U)=>U.overscaledZ-F.overscaledZ),P=S[S.length-1].overscaledZ,O=S[0].overscaledZ-P+1;if(O>1){this.currentStencilSource=void 0,this.nextStencilID+O>256&&this.clearStencil();const F={};for(let U=0;U<O;U++)F[U+P]=new x.StencilMode({func:y.GEQUAL,mask:255},U+this.nextStencilID,255,y.KEEP,y.KEEP,y.REPLACE);return this.nextStencilID+=O,[F,S]}return[{[P]:x.StencilMode.disabled},S]}colorModeForRenderPass(){const c=this.context.gl;if(this._showOverdrawInspector){const y=1/8;return new x.ColorMode([c.CONSTANT_COLOR,c.ONE],new x.Color(y,y,y,0),[!0,!0,!0,!0])}return"opaque"===this.renderPass?x.ColorMode.unblended:x.ColorMode.alphaBlended}depthModeForSublayer(c,y,S){if(!this.opaquePassEnabledForLayer())return x.DepthMode.disabled;const P=1-((1+this.currentLayer)*this.numSublayers+c)*this.depthEpsilon;return new x.DepthMode(S||this.context.gl.LEQUAL,y,[P,P])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(c,y){this.style=c,this.options=y,this.lineAtlas=c.lineAtlas,this.imageManager=c.imageManager,this.glyphManager=c.glyphManager,this.symbolFadeChange=c.placement.symbolFadeChange(x.exported.now()),this.imageManager.beginFrame();const S=this.style.order,P=this.style._sourceCaches;for(const Y in P){const te=P[Y];te.used&&te.prepare(this.context)}const O={},F={},U={};for(const Y in P){const te=P[Y];O[Y]=te.getVisibleCoordinates(),F[Y]=O[Y].slice().reverse(),U[Y]=te.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let Y=0;Y<S.length;Y++)if(this.style._layers[S[Y]].is3D()){this.opaquePassCutoff=Y;break}if(this.terrain&&(this.terrain.updateTileBinding(U),this.opaquePassCutoff=0),!x.isMapAuthenticated(this.context.gl))return;this.renderPass="offscreen";for(const Y of S){const te=this.style._layers[Y],ie=c._getLayerSourceCache(te);if(!te.hasOffscreenPass()||te.isHidden(this.transform.zoom))continue;const se=ie?F[ie.id]:void 0;("custom"===te.type||te.isSky()||se&&se.length)&&this.renderLayer(this,ie,te,se)}this.depthRangeFor3D=[0,1-(c.order.length+2)*this.numSublayers*this.depthEpsilon],this.terrain&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&this.terrain.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);let q=x.Color.transparent;if(this.style.fog&&(q=this.style.fog.properties.get("color")),this.context.clear({color:y.showOverdrawInspector?x.Color.black:q,depth:1}),this.clearStencil(),this._showOverdrawInspector=y.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=S.length-1;this.currentLayer>=0;this.currentLayer--){const Y=this.style._layers[S[this.currentLayer]],te=c._getLayerSourceCache(Y);if(Y.isSky())continue;const ie=te?F[te.id]:void 0;this._renderTileClippingMasks(Y,te,ie),this.renderLayer(this,te,Y,ie)}if(this.renderPass="sky",this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<S.length;this.currentLayer++){const Y=this.style._layers[S[this.currentLayer]],te=c._getLayerSourceCache(Y);Y.isSky()&&this.renderLayer(this,te,Y,te?F[te.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<S.length;){const Y=this.style._layers[S[this.currentLayer]],te=c._getLayerSourceCache(Y);if(Y.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(Y)){if(Y.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const ie=te?("symbol"===Y.type?U:F)[te.id]:void 0;this._renderTileClippingMasks(Y,te,te?O[te.id]:void 0),this.renderLayer(this,te,Y,ie),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry){let Y=null;x.values(this.style._layers).forEach(te=>{const ie=c._getLayerSourceCache(te);ie&&!te.isHidden(this.transform.zoom)&&(!Y||Y.getSource().maxzoom<ie.getSource().maxzoom)&&(Y=ie)}),Y&&this.options.showTileBoundaries&&ga.debug(this,Y,Y.getVisibleCoordinates())}this.options.showPadding&&function(Y){const te=Y.transform.padding;Es(Y,Y.transform.height-(te.top||0),3,ra),Es(Y,te.bottom||0,3,br),Wd(Y,te.left||0,3,Ta),Wd(Y,Y.transform.width-(te.right||0),3,ws);const ie=Y.transform.centerPoint;var se,we,Fe,Ve;du(se=Y,(we=ie.x)-1,(Fe=Y.transform.height-ie.y)-10,2,20,Ve=Io),du(se,we-10,Fe-1,20,2,Ve)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%x.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(x.window.performance.now()),this.saveCanvasCopy())}renderLayer(c,y,S,P){S.isHidden(this.transform.zoom)||("background"===S.type||"sky"===S.type||"custom"===S.type||P&&P.length)&&(this.id=S.id,this.gpuTimingStart(S),ga[S.type](c,y,S,P,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(c){if(!this.options.gpuTiming)return;const y=this.context.extTimerQuery;let S=this.gpuTimers[c.id];S||(S=this.gpuTimers[c.id]={calls:0,cpuTime:0,query:y.createQueryEXT()}),S.calls++,y.beginQueryEXT(y.TIME_ELAPSED_EXT,S.query)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const c=this.context.extTimerQuery;c.endQueryEXT(c.TIME_ELAPSED_EXT)}collectGpuTimers(){const c=this.gpuTimers;return this.gpuTimers={},c}queryGpuTimers(c){const y={};for(const S in c){const P=c[S],O=this.context.extTimerQuery,F=O.getQueryObjectEXT(P.query,O.QUERY_RESULT_EXT)/1e6;O.deleteQueryEXT(P.query),y[S]=F}return y}translatePosMatrix(c,y,S,P,O){if(!S[0]&&!S[1])return c;const F=O?"map"===P?this.transform.angle:0:"viewport"===P?-this.transform.angle:0;if(F){const Y=Math.sin(F),te=Math.cos(F);S=[S[0]*te-S[1]*Y,S[0]*Y+S[1]*te]}const U=[O?S[0]:Pe(y,S[0],this.transform.zoom),O?S[1]:Pe(y,S[1],this.transform.zoom),0],q=new Float32Array(16);return x.translate(q,c,U),q}saveTileTexture(c){const y=this._tileTextures[c.size[0]];y?y.push(c):this._tileTextures[c.size[0]]=[c]}getTileTexture(c){const y=this._tileTextures[c];return y&&y.length>0?y.pop():null}isPatternMissing(c){if(!c)return!1;if(!c.from||!c.to)return!0;const y=this.imageManager.getPattern(c.from.toString()),S=this.imageManager.getPattern(c.to.toString());return!y||!S}currentGlobalDefines(){const c=this.terrain&&this.terrain.renderingToTexture,y=this.style&&this.style.fog,S=[];return this.terrain&&!this.terrain.renderingToTexture&&S.push("TERRAIN"),y&&!c&&0!==y.getOpacity(this.transform.pitch)&&S.push("FOG"),c&&S.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&S.push("OVERDRAW_INSPECTOR"),S}useProgram(c,y,S){this.cache=this.cache||{};const P=S||[],O=this.currentGlobalDefines().concat(P),F=Ds.cacheKey(c,O,y);return this.cache[F]||(this.cache[F]=new Ds(this.context,c,ss[c],y,El[c],O)),this.cache[F]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const c=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(c.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=x.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new x.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}prepareDrawTile(c){this.terrain&&this.terrain.prepareDrawTile(c)}prepareDrawProgram(c,y,S){if(this.terrain&&this.terrain.renderingToTexture)return;const P=this.style.fog;if(P){const O=P.getOpacity(this.transform.pitch);0!==O&&y.setFogUniformValues(c,((F,U,q,Y)=>{const te=U.properties.get("color"),ie=F.frameCounter/1e3%1,se=[te.r/te.a,te.g/te.a,te.b/te.a,Y];return{u_fog_matrix:q?F.transform.calculateFogTileMatrix(q):F.identityMat,u_fog_range:U.getFovAdjustedRange(F.transform._fov),u_fog_color:se,u_fog_horizon_blend:U.properties.get("horizon-blend"),u_fog_temporal_offset:ie}})(this,P,S,O))}}setTileLoadedFlag(c){this.tileLoaded=c}saveCanvasCopy(){this.frameCopies.push(this.canvasCopy()),this.tileLoaded=!1}canvasCopy(){const c=this.context.gl,y=c.createTexture();return c.bindTexture(c.TEXTURE_2D,y),c.copyTexImage2D(c.TEXTURE_2D,0,c.RGBA,0,0,c.drawingBufferWidth,c.drawingBufferHeight,0),y}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const c=this.style&&this.style.fog;return!!c&&0!==c.getOpacity(this.transform.pitch)}}class ma{constructor(c=0,y=0,S=0,P=0){if(isNaN(c)||c<0||isNaN(y)||y<0||isNaN(S)||S<0||isNaN(P)||P<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=c,this.bottom=y,this.left=S,this.right=P}interpolate(c,y,S){return null!=y.top&&null!=c.top&&(this.top=x.number(c.top,y.top,S)),null!=y.bottom&&null!=c.bottom&&(this.bottom=x.number(c.bottom,y.bottom,S)),null!=y.left&&null!=c.left&&(this.left=x.number(c.left,y.left,S)),null!=y.right&&null!=c.right&&(this.right=x.number(c.right,y.right,S)),this}getCenter(c,y){const S=x.clamp((this.left+c-this.right)/2,0,c),P=x.clamp((this.top+y-this.bottom)/2,0,y);return new x.pointGeometry(S,P)}equals(c){return this.top===c.top&&this.bottom===c.bottom&&this.left===c.left&&this.right===c.right}clone(){return new ma(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function _a(C,c){return[C[4*c],C[4*c+1],C[4*c+2],C[4*c+3]]}function Da(C,c,y){C[4*c+0]=y[0],C[4*c+1]=y[1],C[4*c+2]=y[2],C[4*c+3]=y[3]}function js(C,c){const y=_a(C,3);x.fromQuat(C,c),Da(C,3,y)}function fu(C,c){Da(C,3,[c[0],c[1],c[2],1])}function Yl(C,c){const y=x.identity$1([]);return x.rotateZ$1(y,y,-c),x.rotateX$1(y,y,-C),y}function ko(C,c){const y=[C[0],C[1],0],S=[c[0],c[1],0];if(x.length(y)>=1e-15){const F=x.normalize([],y);x.scale(S,F,x.dot(S,F)),c[0]=S[0],c[1]=S[1]}const P=x.cross([],c,C);if(x.len(P)<1e-15)return null;const O=Math.atan2(-P[1],P[0]);return Yl(Math.atan2(Math.sqrt(C[0]*C[0]+C[1]*C[1]),-C[2]),O)}class Ia{constructor(c,y){this.position=c,this.orientation=y}get position(){return this._position}set position(c){this._position=this._renderWorldCopies?function(y){if(!y)return;const S=Array.isArray(y)?new x.MercatorCoordinate(y[0],y[1],y[2]):y;return S.x=x.wrap(S.x,0,1),S}(c):c}lookAtPoint(c,y){if(this.orientation=null,!this.position)return;const S=this._elevation?this._elevation.getAtPointOrZero(x.MercatorCoordinate.fromLngLat(c)):0,P=this.position,O=x.MercatorCoordinate.fromLngLat(c,S),F=[O.x-P.x,O.y-P.y,O.z-P.z];y||(y=[0,0,1]),y[2]=Math.abs(y[2]),this.orientation=ko(F,y)}setPitchBearing(c,y){this.orientation=Yl(x.degToRad(c),x.degToRad(-y))}}class As{constructor(c,y){this._transform=x.identity([]),this._orientation=x.identity$1([]),y&&(this._orientation=y,js(this._transform,this._orientation)),c&&fu(this._transform,c)}get mercatorPosition(){const c=this.position;return new x.MercatorCoordinate(c[0],c[1],c[2])}get position(){const c=_a(this._transform,3);return[c[0],c[1],c[2]]}set position(c){fu(this._transform,c)}get orientation(){return this._orientation}set orientation(c){this._orientation=c,js(this._transform,this._orientation)}getPitchBearing(){const c=this.forward(),y=this.right();return{bearing:Math.atan2(-y[1],y[0]),pitch:Math.atan2(Math.sqrt(c[0]*c[0]+c[1]*c[1]),-c[2])}}setPitchBearing(c,y){this._orientation=Yl(c,y),js(this._transform,this._orientation)}forward(){const c=_a(this._transform,2);return[-c[0],-c[1],-c[2]]}up(){const c=_a(this._transform,1);return[-c[0],-c[1],-c[2]]}right(){const c=_a(this._transform,0);return[c[0],c[1],c[2]]}getCameraToWorld(c,y){const S=new Float64Array(16);return x.invert(S,this.getWorldToCamera(c,y)),S}getWorldToCameraPosition(c,y,S){const P=this.position;x.scale(P,P,-c);const O=new Float64Array(16);return x.fromScaling(O,[S,S,S]),x.translate(O,O,P),O[10]*=y,O}getWorldToCamera(c,y){const S=new Float64Array(16),P=new Float64Array(4),O=this.position;return x.conjugate(P,this._orientation),x.scale(O,O,-c),x.fromQuat(S,P),x.translate(S,S,O),S[1]*=-1,S[5]*=-1,S[9]*=-1,S[13]*=-1,S[8]*=y,S[9]*=y,S[10]*=y,S[11]*=y,S}getCameraToClipPerspective(c,y,S,P){const O=new Float64Array(16);return x.perspective(O,c,y,S,P),O}getDistanceToElevation(c){const y=0===c?0:x.mercatorZfromAltitude(c,this.position[1]),S=this.forward();return(y-this.position[2])/S[2]}clone(){return new As([...this.position],[...this.orientation])}}class Xd{constructor(c,y,S,P,O){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=void 0===O||O,this._minZoom=c||0,this._maxZoom=y||22,this._minPitch=null==S?0:S,this._maxPitch=null==P?60:P,this.setMaxBounds(),this.width=0,this.height=0,this._center=new x.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new ma,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._camera=new As,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._horizonShift=.1}clone(){const c=new Xd(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return c._elevation=this._elevation,c._centerAltitude=this._centerAltitude,c.tileSize=this.tileSize,c.latRange=this.latRange,c.width=this.width,c.height=this.height,c.cameraElevationReference=this.cameraElevationReference,c._center=this._center,c._setZoom(this.zoom),c._cameraZoom=this._cameraZoom,c.angle=this.angle,c._fov=this._fov,c._pitch=this._pitch,c._averageElevation=this._averageElevation,c._unmodified=this._unmodified,c._edgeInsets=this._edgeInsets.clone(),c._camera=this._camera.clone(),c._calcMatrices(),c.freezeTileCoverage=this.freezeTileCoverage,c}get elevation(){return this._elevation}set elevation(c){this._elevation!==c&&(this._elevation=c,c?this._updateCenterElevation()&&this._updateCameraOnTerrain():(this._cameraZoom=null,this._centerAltitude=0),this._calcMatrices())}updateElevation(c){this._terrainEnabled()&&null==this._cameraZoom&&this._updateCenterElevation()&&this._updateCameraOnTerrain(),c&&this._constrainCameraAltitude(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(c){this._minZoom!==c&&(this._minZoom=c,this.zoom=Math.max(this.zoom,c))}get maxZoom(){return this._maxZoom}set maxZoom(c){this._maxZoom!==c&&(this._maxZoom=c,this.zoom=Math.min(this.zoom,c))}get minPitch(){return this._minPitch}set minPitch(c){this._minPitch!==c&&(this._minPitch=c,this.pitch=Math.max(this.pitch,c))}get maxPitch(){return this._maxPitch}set maxPitch(c){this._maxPitch!==c&&(this._maxPitch=c,this.pitch=Math.min(this.pitch,c))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(c){void 0===c?c=!0:null===c&&(c=!1),this._renderWorldCopies=c}get worldSize(){return this.tileSize*this.scale}get cameraWorldSize(){const c=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(c))}get pixelsPerMeter(){return x.mercatorZfromAltitude(1,this.center.lat)*this.worldSize}get cameraPixelsPerMeter(){return x.mercatorZfromAltitude(1,this.center.lat)*this.cameraWorldSize}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new x.pointGeometry(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(c){const y=-x.wrap(c,-180,180)*Math.PI/180;var S,P,O,F,U,q,Y,te,ie,se;this.angle!==y&&(this._unmodified=!1,this.angle=y,this._calcMatrices(),this.rotationMatrix=(S=new x.ARRAY_TYPE(4),x.ARRAY_TYPE!=Float32Array&&(S[1]=0,S[2]=0),S[0]=1,S[3]=1,S),P=this.rotationMatrix,F=this.angle,U=(O=this.rotationMatrix)[0],q=O[1],Y=O[2],te=O[3],ie=Math.sin(F),se=Math.cos(F),P[0]=U*se+Y*ie,P[1]=q*se+te*ie,P[2]=U*-ie+Y*se,P[3]=q*-ie+te*se)}get pitch(){return this._pitch/Math.PI*180}set pitch(c){const y=x.clamp(c,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==y&&(this._unmodified=!1,this._pitch=y,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(c){c=Math.max(.01,Math.min(60,c)),this._fov!==c&&(this._unmodified=!1,this._fov=c/180*Math.PI,this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(c){this._averageElevation=c,this._calcFogMatrices()}get zoom(){return this._zoom}set zoom(c){const y=Math.min(Math.max(c,this.minZoom),this.maxZoom);this._zoom!==y&&(this._unmodified=!1,this._setZoom(y),this._terrainEnabled()&&this._updateCameraOnTerrain(),this._constrain(),this._calcMatrices())}_setZoom(c){this._zoom=c,this.scale=this.zoomScale(c),this.tileZoom=Math.floor(c),this.zoomFraction=c-this.tileZoom}_updateCenterElevation(){if(!this._elevation)return!1;const c=this._elevation.getAtPointOrZero(x.MercatorCoordinate.fromLngLat(this.center),-1);return-1===c?(this._cameraZoom=null,!1):(this._centerAltitude=c,!0)}_updateCameraOnTerrain(){const c=this.cameraToCenterDistance/this.worldSize,y=x.mercatorZfromAltitude(this._centerAltitude,this.center.lat);this._cameraZoom=this._zoomFromMercatorZ(y+c)}sampleAverageElevation(){if(!this._elevation)return 0;const c=this._elevation,y=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],S=this.horizonLineFromTop();let P=0,O=0;for(let F=0;F<y.length;F++){const U=new x.pointGeometry(y[F][0]*this.width,S+y[F][1]*(this.height-S)),q=c.pointCoordinate(U);if(!q)continue;const Y=1/Math.hypot(q[0]-this._camera.position[0],q[1]-this._camera.position[1]);P+=q[3]*Y,O+=Y}return 0===O?NaN:P/O}get center(){return this._center}set center(c){c.lat===this._center.lat&&c.lng===this._center.lng||(this._unmodified=!1,this._center=c,this._terrainEnabled()&&("ground"===this.cameraElevationReference?this._updateCenterElevation()?this._updateCameraOnTerrain():this._cameraZoom=null:this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(null==this._cameraZoom||!this._elevation)return;const c=this._cameraZoom,y=this._elevation.getAtPointOrZero(x.MercatorCoordinate.fromLngLat(this.center)),S=x.mercatorZfromAltitude(y,this.center.lat),P=this._mercatorZfromZoom(c),O=this._mercatorZfromZoom(this._maxZoom),F=Math.max(P-S,O);this._setZoom(this._zoomFromMercatorZ(F))}get padding(){return this._edgeInsets.toJSON()}set padding(c){this._edgeInsets.equals(c)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,c,1),this._calcMatrices())}computeZoomRelativeTo(c){const y=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,c.toAltitude()));let S;S=c.z<this._camera.position[2]?[y.x,y.y,y.z]:[c.x,c.y,c.z];const P=x.length(x.sub([],this._camera.position,S));return x.clamp(this._zoomFromMercatorZ(P),this._minZoom,this._maxZoom)}setFreeCameraOptions(c){if(!this.height||!c.position&&!c.orientation)return;this._updateCameraState();let y=!1;if(c.orientation&&!x.exactEquals(c.orientation,this._camera.orientation)&&(y=this._setCameraOrientation(c.orientation)),c.position){const S=[c.position.x,c.position.y,c.position.z];x.exactEquals$1(S,this._camera.position)||(this._setCameraPosition(S),y=!0)}y&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const c=this._camera.position,y=new Ia;return y.position=new x.MercatorCoordinate(c[0],c[1],c[2]),y.orientation=this._camera.orientation,y._elevation=this.elevation,y._renderWorldCopies=this._renderWorldCopies,y}_setCameraOrientation(c){if(!x.length$1(c))return!1;x.normalize$1(c,c);const y=x.transformQuat([],[0,0,-1],c),S=x.transformQuat([],[0,-1,0],c);if(S[2]<0)return!1;const P=ko(y,S);return!!P&&(this._camera.orientation=P,!0)}_setCameraPosition(c){const y=this.zoomScale(this.minZoom)*this.tileSize,S=this.zoomScale(this.maxZoom)*this.tileSize,P=this.cameraToCenterDistance;c[2]=x.clamp(c[2],P/S,P/y),this._camera.position=c}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(c){return this._edgeInsets.equals(c)}interpolatePadding(c,y,S){this._unmodified=!1,this._edgeInsets.interpolate(c,y,S),this._constrain(),this._calcMatrices()}coveringZoomLevel(c){const y=(c.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/c.tileSize));return Math.max(0,y)}getVisibleUnwrappedCoordinates(c){const y=[new x.UnwrappedTileID(0,c)];if(this._renderWorldCopies){const S=this.pointCoordinate(new x.pointGeometry(0,0)),P=this.pointCoordinate(new x.pointGeometry(this.width,0)),O=this.pointCoordinate(new x.pointGeometry(this.width,this.height)),F=this.pointCoordinate(new x.pointGeometry(0,this.height)),U=Math.floor(Math.min(S.x,P.x,O.x,F.x)),q=Math.floor(Math.max(S.x,P.x,O.x,F.x)),Y=1;for(let te=U-Y;te<=q+Y;te++)0!==te&&y.push(new x.UnwrappedTileID(te,c))}return y}coveringTiles(c){let y=this.coveringZoomLevel(c);const S=y,P=this.elevation&&!c.isTerrainDEM;if(void 0!==c.minzoom&&y<c.minzoom)return[];void 0!==c.maxzoom&&y>c.maxzoom&&(y=c.maxzoom);const O=x.MercatorCoordinate.fromLngLat(this.center),F=1<<y,U=[F*O.x,F*O.y,0],q=ue.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,y),Y=this.pointCoordinate(this.getCameraPoint()),te=F*x.mercatorZfromAltitude(1,this.center.lat),ie=this._camera.position[2]/x.mercatorZfromAltitude(1,this.center.lat),se=[F*Y.x,F*Y.y,ie],we=this.cameraToCenterDistance/c.tileSize*(c.roundZoom?1:.502),Fe=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation?y:0,Ve=c.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,nt=c.isTerrainDEM?-Ve:this._elevation?this._elevation.getMinElevationBelowMSL():0,Te=et=>({aabb:new pe([et*F,0,nt],[(et+1)*F,F,Ve]),zoom:0,x:0,y:0,wrap:et,fullyVisible:!1}),He=[],Je=[],ot=y,Xe=c.reparseOverscaled?S:y,Ye=et=>{if(!this._elevation||!et.tileID)return;const xn=this._elevation.getMinMaxForTile(et.tileID),un=et.aabb;xn?(un.min[2]=xn.min,un.max[2]=xn.max,un.center[2]=(un.min[2]+un.max[2])/2):(et.shouldSplit=Jt(et),et.shouldSplit||(un.min[2]=un.max[2]=un.center[2]=this._centerAltitude))},$t=et=>et*et,qt=$t((ie-this._centerAltitude)*te),Jt=et=>{if(et.zoom<Fe)return!0;if(et.zoom===ot)return!1;if(null!=et.shouldSplit)return et.shouldSplit;const xn=et.aabb.distanceX(se),un=et.aabb.distanceY(se);let Kn=qt;P&&(Kn=$t(et.aabb.distanceZ(se)*te));const En=xn*xn+un*un+Kn;return En<$t((1<<ot-et.zoom)*we*((wn,Ir)=>{if(Ir*$t(.707)<wn)return 1;const pr=Math.sqrt(Ir/wn);return pr/(1.4144271570014144+(Math.pow(1.1,pr-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(Kn,qt),En))};if(this._renderWorldCopies)for(let et=1;et<=3;et++)He.push(Te(-et)),He.push(Te(et));for(He.push(Te(0));He.length>0;){const et=He.pop(),xn=et.x,un=et.y;let Kn=et.fullyVisible;if(!Kn){const En=et.aabb.intersects(q);if(0===En)continue;Kn=2===En}if(et.zoom!==ot&&Jt(et))for(let En=0;En<4;En++){const wn=(xn<<1)+En%2,Ir=(un<<1)+(En>>1),pr={aabb:et.aabb.quadrant(En),zoom:et.zoom+1,x:wn,y:Ir,wrap:et.wrap,fullyVisible:Kn,tileID:void 0,shouldSplit:void 0};P&&(pr.tileID=new x.OverscaledTileID(et.zoom+1===ot?Xe:et.zoom+1,et.wrap,et.zoom+1,wn,Ir),Ye(pr)),He.push(pr)}else{const En=et.zoom===ot?Xe:et.zoom;if(c.minzoom&&c.minzoom>En)continue;const wn=U[0]-(.5+xn+(et.wrap<<et.zoom))*(1<<y-et.zoom),Ir=U[1]-.5-un,pr=et.tileID?et.tileID:new x.OverscaledTileID(En,et.wrap,et.zoom,xn,un);Je.push({tileID:pr,distanceSq:wn*wn+Ir*Ir})}}if(this.fogCullDistSq){const et=this.fogCullDistSq;Je.splice(0,Je.length,...Je.filter(xn=>{const un=[0,0,0,1],Kn=[x.EXTENT,x.EXTENT,0,1],En=this.calculateFogTileMatrix(xn.tileID.toUnwrapped());x.transformMat4(un,un,En),x.transformMat4(Kn,Kn,En);const wn=x.getAABBPointSquareDist(un,Kn);if(0===wn)return!0;let Ir=!1;const pr=this.horizonLineFromTop();if(wn>et&&0!==pr){const gi=this.calculateProjMatrix(xn.tileID.toUnwrapped());let yi;P&&this._elevation&&(yi=this._elevation.getMinMaxForTile(xn.tileID)),yi||(yi={min:nt,max:Ve});const uo=x.furthestTileCorner(this.bearing),Xr=[uo[0]*x.EXTENT,uo[1]*x.EXTENT,yi.max];x.transformMat4$1(Xr,Xr,gi),Ir=(1-Xr[1])*this.height*.5<pr}return wn<et||Ir}))}return Je.sort((et,xn)=>et.distanceSq-xn.distanceSq).map(et=>et.tileID)}resize(c,y){this.width=c,this.height=y,this.pixelsToGLUnits=[2/c,-2/y],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(c){return Math.pow(2,c)}scaleZoom(c){return Math.log(c)/Math.LN2}project(c){const y=x.clamp(c.lat,-this.maxValidLatitude,this.maxValidLatitude);return new x.pointGeometry(x.mercatorXfromLng(c.lng)*this.worldSize,x.mercatorYfromLat(y)*this.worldSize)}unproject(c){return new x.MercatorCoordinate(c.x/this.worldSize,c.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}setLocationAtPoint(c,y){const S=this.pointCoordinate(y),P=this.pointCoordinate(this.centerPoint),O=this.locationCoordinate(c),F=new x.MercatorCoordinate(O.x-(S.x-P.x),O.y-(S.y-P.y));this.center=this.coordinateLocation(F),this._renderWorldCopies&&(this.center=this.center.wrap())}setLocation(c){this.center=this.coordinateLocation(c),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(c){return this._coordinatePoint(this.locationCoordinate(c),!1)}locationPoint3D(c){return this._coordinatePoint(this.locationCoordinate(c),!0)}pointLocation(c){return this.coordinateLocation(this.pointCoordinate(c))}pointLocation3D(c){return this.coordinateLocation(this.pointCoordinate3D(c))}locationCoordinate(c){return x.MercatorCoordinate.fromLngLat(c)}coordinateLocation(c){return c.toLngLat()}pointRayIntersection(c,y){const S=null!=y?y:this._centerAltitude,P=[c.x,c.y,0,1],O=[c.x,c.y,1,1];x.transformMat4(P,P,this.pixelMatrixInverse),x.transformMat4(O,O,this.pixelMatrixInverse);const F=O[3];x.scale$2(P,P,1/P[3]),x.scale$2(O,O,1/F);const U=P[2],q=O[2];return{p0:P,p1:O,t:U===q?0:(S-U)/(q-U)}}screenPointToMercatorRay(c){const y=[c.x,c.y,0,1],S=[c.x,c.y,1,1];return x.transformMat4(y,y,this.pixelMatrixInverse),x.transformMat4(S,S,this.pixelMatrixInverse),x.scale$2(y,y,1/y[3]),x.scale$2(S,S,1/S[3]),y[2]=x.mercatorZfromAltitude(y[2],this._center.lat)*this.worldSize,S[2]=x.mercatorZfromAltitude(S[2],this._center.lat)*this.worldSize,x.scale$2(y,y,1/this.worldSize),x.scale$2(S,S,1/this.worldSize),new Se([y[0],y[1],y[2]],x.normalize([],x.sub([],S,y)))}rayIntersectionCoordinate(c){const{p0:y,p1:S,t:P}=c,O=x.mercatorZfromAltitude(y[2],this._center.lat),F=x.mercatorZfromAltitude(S[2],this._center.lat);return new x.MercatorCoordinate(x.number(y[0],S[0],P)/this.worldSize,x.number(y[1],S[1],P)/this.worldSize,x.number(O,F,P))}pointCoordinate(c){const y=this.horizonLineFromTop(!1),S=new x.pointGeometry(c.x,Math.max(y,c.y));return this.rayIntersectionCoordinate(this.pointRayIntersection(S))}pointCoordinate3D(c){if(!this.elevation)return this.pointCoordinate(c);const y=this.elevation;let S=this.elevation.pointCoordinate(c);if(S)return new x.MercatorCoordinate(S[0],S[1],S[2]);let P=0,O=this.horizonLineFromTop();if(c.y>O)return this.pointCoordinate(c);const F=.02*O,U=c.clone();for(let q=0;q<10&&O-P>F;q++){U.y=x.number(P,O,.66);const Y=y.pointCoordinate(U);Y?(O=U.y,S=Y):P=U.y}return S?new x.MercatorCoordinate(S[0],S[1],S[2]):this.pointCoordinate(c)}isPointAboveHorizon(c){if(this.elevation)return!this.elevation.pointCoordinate(c);{const y=this.horizonLineFromTop();return c.y<y}}_coordinatePoint(c,y){const S=y&&this.elevation?this.elevation.getAtPointOrZero(c,this._centerAltitude):this._centerAltitude,P=[c.x*this.worldSize,c.y*this.worldSize,S+c.toAltitude(),1];return x.transformMat4(P,P,this.pixelMatrix),P[3]>0?new x.pointGeometry(P[0]/P[3],P[1]/P[3]):new x.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE)}getBounds(){return this._terrainEnabled()?this._getBounds3D():(new x.LngLatBounds).extend(this.pointLocation(new x.pointGeometry(this._edgeInsets.left,this._edgeInsets.top))).extend(this.pointLocation(new x.pointGeometry(this.width-this._edgeInsets.right,this._edgeInsets.top))).extend(this.pointLocation(new x.pointGeometry(this.width-this._edgeInsets.right,this.height-this._edgeInsets.bottom))).extend(this.pointLocation(new x.pointGeometry(this._edgeInsets.left,this.height-this._edgeInsets.bottom)))}_getBounds3D(){const c=this.elevation,y=c.visibleDemTiles.reduce((P,O)=>{if(O.dem){const F=O.dem.tree;P.min=Math.min(P.min,F.minimums[0]),P.max=Math.max(P.max,F.maximums[0])}return P},{min:Number.MAX_VALUE,max:0});y.min*=c.exaggeration(),y.max*=c.exaggeration();const S=this.horizonLineFromTop();return[new x.pointGeometry(0,S),new x.pointGeometry(this.width,S),new x.pointGeometry(this.width,this.height),new x.pointGeometry(0,this.height)].reduce((P,O)=>P.extend(this.coordinateLocation(this.rayIntersectionCoordinate(this.pointRayIntersection(O,y.min)))).extend(this.coordinateLocation(this.rayIntersectionCoordinate(this.pointRayIntersection(O,y.max)))),new x.LngLatBounds)}horizonLineFromTop(c=!0){const y=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,S=this.height/2-.97*y;return c?Math.max(0,S):S}getMaxBounds(){return this.latRange&&2===this.latRange.length&&this.lngRange&&2===this.lngRange.length?new x.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}setMaxBounds(c){c?(this.lngRange=[c.getWest(),c.getEast()],this.latRange=[c.getSouth(),c.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}calculatePosMatrix(c,y){const S=c.canonical,P=y/this.zoomScale(S.z),O=S.x+Math.pow(2,S.z)*c.wrap,F=x.identity(new Float64Array(16));return x.translate(F,F,[O*P,S.y*P,0]),x.scale$1(F,F,[P/x.EXTENT,P/x.EXTENT,1]),F}calculateFogTileMatrix(c){const y=c.key,S=this._fogTileMatrixCache;if(S[y])return S[y];const P=this.calculatePosMatrix(c,this.cameraWorldSize);return x.multiply(P,this.worldToFogMatrix,P),S[y]=new Float32Array(P),S[y]}calculateProjMatrix(c,y=!1){const S=c.key,P=y?this._alignedProjMatrixCache:this._projMatrixCache;if(P[S])return P[S];const O=this.calculatePosMatrix(c,this.worldSize);return x.multiply(O,y?this.alignedProjMatrix:this.projMatrix,O),P[S]=new Float32Array(O),P[S]}customLayerMatrix(){return this.mercatorMatrix.slice()}recenterOnTerrain(){if(!this._elevation)return;const c=this._elevation;this._updateCameraState();const y=this._camera.position,S=this._camera.forward();if(y[2]<=0||S[2]>=0)return;const P=x.mercatorZfromAltitude(1,this._center.lat);y[2]/=P,S[2]/=P,x.normalize(S,S);const O=c.raycast(y,S,c.exaggeration());if(O){const F=x.scaleAndAdd([],y,S,O),U=new x.MercatorCoordinate(F[0],F[1],x.mercatorZfromAltitude(F[2],x.latFromMercatorY(F[1]))),q=this._camera.position,Y=U.z+x.length([U.x-q[0],U.y-q[1],U.z-q[2]]);this._cameraZoom=this._zoomFromMercatorZ(Y),this._centerAltitude=U.toAltitude(),this._center=U.toLngLat(),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCameraAltitude(){if(!this._elevation)return;const c=this._elevation;this._updateCameraState();const y=c.getAtPointOrZero(this._camera.mercatorPosition),S=this._minimumHeightOverTerrain()*Math.cos(x.degToRad(this._maxPitch)),P=x.mercatorZfromAltitude(y,this._center.lat),O=this._camera.position[2]-P;if(O<S){const F=x.MercatorCoordinate.fromLngLat(this._center,this._centerAltitude),U=this._camera.mercatorPosition,q=[F.x-U.x,F.y-U.y,F.z-U.z],Y=x.length(q);q[2]-=S-O;const te=x.length(q);if(0===te)return;x.scale(q,q,Y/te),this._camera.position=[F.x-q[0],F.y-q[1],F.z-q[2]],this._camera.orientation=ko(q,this._camera.up()),this._updateStateFromCamera()}}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let c,y,S,P,O=-90,F=90,U=-180,q=180;const Y=this.size,te=this._unmodified;if(this.latRange){const we=this.latRange;O=x.mercatorYfromLat(we[1])*this.worldSize,F=x.mercatorYfromLat(we[0])*this.worldSize,c=F-O<Y.y?Y.y/(F-O):0}if(this.lngRange){const we=this.lngRange;U=x.mercatorXfromLng(we[0])*this.worldSize,q=x.mercatorXfromLng(we[1])*this.worldSize,y=q-U<Y.x?Y.x/(q-U):0}const ie=this.point,se=Math.max(y||0,c||0);if(se)return this.center=this.unproject(new x.pointGeometry(y?(q+U)/2:ie.x,c?(F+O)/2:ie.y)),this.zoom+=this.scaleZoom(se),this._unmodified=te,void(this._constraining=!1);if(this.latRange){const we=ie.y,Fe=Y.y/2;we-Fe<O&&(P=O+Fe),we+Fe>F&&(P=F-Fe)}if(this.lngRange){const we=ie.x,Fe=Y.x/2;we-Fe<U&&(S=U+Fe),we+Fe>q&&(S=q-Fe)}void 0===S&&void 0===P||(this.center=this.unproject(new x.pointGeometry(void 0!==S?S:ie.x,void 0!==P?P:ie.y))),this._constrainCameraAltitude(),this._unmodified=te,this._constraining=!1}_minZoomForBounds(){const c=(P,O)=>Math.log2(P/(this.tileSize*Math.abs(O[1]-O[0])));let y=0;if(this.latRange){const P=this.latRange;y=c(this.height,[x.mercatorYfromLat(P[0]),x.mercatorYfromLat(P[1])])}let S=0;if(this.lngRange){const P=this.lngRange;S=c(this.width,[x.mercatorXfromLng(P[0]),x.mercatorXfromLng(P[1])])}return Math.max(y,S)}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const c=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;const y=this.pixelsPerMeter;this._updateCameraState();const S=Math.PI/2+this._pitch,P=this.fovAboveCenter,O=this.elevation?this.elevation.getMinElevationBelowMSL()*y:0,F=(this._camera.position[2]*this.worldSize-O)/Math.cos(this._pitch),U=Math.sin(P)*F/Math.sin(x.clamp(Math.PI-S-P,.01,Math.PI-.01)),q=this.point,Y=q.x,te=q.y,ie=Math.cos(Math.PI/2-this._pitch)*U+F,se=Math.min(1.01*ie,F*(1/this._horizonShift)),we=this.height/50,Fe=this._camera.getWorldToCamera(this.worldSize,y),Ve=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,we,se);Ve[8]=2*-c.x/this.width,Ve[9]=2*c.y/this.height;let nt=x.mul$1([],Ve,Fe);this.mercatorMatrix=x.scale$1([],nt,[this.worldSize,this.worldSize,this.worldSize/y]),this.projMatrix=nt,this.invProjMatrix=x.invert(new Float64Array(16),this.projMatrix);const Te=new Float32Array(16);x.identity(Te),x.scale$1(Te,Te,[1,-1,1]),x.rotateX(Te,Te,this._pitch),x.rotateZ(Te,Te,this.angle);const He=x.perspective(new Float32Array(16),this._fov,this.width/this.height,we,se),Je=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;He[8]=2*-c.x/this.width,He[9]=2*(c.y+Je)/this.height,this.skyboxMatrix=x.multiply(Te,He,Te);const ot=this.width%2/2,Xe=this.height%2/2,Ye=Math.cos(this.angle),$t=Math.sin(this.angle),qt=Y-Math.round(Y)+Ye*ot+$t*Xe,Jt=te-Math.round(te)+Ye*Xe+$t*ot,et=new Float64Array(nt);if(x.translate(et,et,[qt>.5?qt-1:qt,Jt>.5?Jt-1:Jt,0]),this.alignedProjMatrix=et,nt=x.create$1(),x.scale$1(nt,nt,[this.width/2,-this.height/2,1]),x.translate(nt,nt,[1,-1,0]),this.labelPlaneMatrix=nt,nt=x.create$1(),x.scale$1(nt,nt,[1,-1,1]),x.translate(nt,nt,[-1,-1,0]),x.scale$1(nt,nt,[2/this.width,2/this.height,1]),this.glCoordMatrix=nt,this.pixelMatrix=x.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),nt=x.invert(new Float64Array(16),this.pixelMatrix),!nt)throw new Error("failed to invert matrix");this.pixelMatrixInverse=nt,this._projMatrixCache={},this._alignedProjMatrixCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const c=this.cameraWorldSize,y=this.cameraPixelsPerMeter,S=this._camera.position,P=1/this.height,O=[c,c,y];x.scale(O,O,P),x.scale(S,S,-1),x.multiply$1(S,S,O);const F=x.create$1();x.translate(F,F,S),x.scale$1(F,F,O),this.mercatorFogMatrix=F,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(c,y,P)}_updateCameraState(){if(!this.height)return;this._camera.setPitchBearing(this._pitch,this.angle);const c=this._camera.forward(),y=this.cameraToCenterDistance,S=this.point,P=this._mercatorZfromZoom(this._cameraZoom?this._cameraZoom:this._zoom)-x.mercatorZfromAltitude(this._centerAltitude,this.center.lat),O=this.cameraToCenterDistance/P;this._camera.position=[S.x/this.worldSize-c[0]*y/O,S.y/this.worldSize-c[1]*y/O,x.mercatorZfromAltitude(this._centerAltitude,this._center.lat)+-c[2]*y/O]}_translateCameraConstrained(c){const y=this._maxCameraBoundsDistance()*Math.cos(this._pitch),S=c[2];let P=1;S>0&&(P=Math.min((y-this._camera.position[2])/S,1)),this._camera.position=x.scaleAndAdd([],this._camera.position,c,P),this._updateStateFromCamera()}_updateStateFromCamera(){const c=this._camera.position,y=this._camera.forward(),{pitch:S,bearing:P}=this._camera.getPitchBearing(),O=x.mercatorZfromAltitude(this._centerAltitude,this.center.lat),F=this._mercatorZfromZoom(this._maxZoom)*Math.cos(x.degToRad(this._maxPitch)),U=Math.max((c[2]-O)/Math.cos(S),F),q=this._zoomFromMercatorZ(U);x.scaleAndAdd(c,c,y,U),this._pitch=x.clamp(S,x.degToRad(this.minPitch),x.degToRad(this.maxPitch)),this.angle=x.wrap(P,-Math.PI,Math.PI),this._setZoom(x.clamp(q,this._minZoom,this._maxZoom)),this._terrainEnabled()&&this._updateCameraOnTerrain(),this._center=new x.MercatorCoordinate(c[0],c[1],c[2]).toLngLat(),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(c){return Math.pow(2,c)*this.tileSize}_mercatorZfromZoom(c){return this.cameraToCenterDistance/this._worldSizeFromZoom(c)}_minimumHeightOverTerrain(){const c=Math.min((null!=this._cameraZoom?this._cameraZoom:this._zoom)+2,this._maxZoom);return this._mercatorZfromZoom(c)}_zoomFromMercatorZ(c){return this.scaleZoom(this.cameraToCenterDistance/(c*this.tileSize))}_terrainEnabled(){return!!this._elevation}isHorizonVisibleForPoints(c,y){const S=Math.min(c.x,y.x),P=Math.max(c.x,y.x),O=Math.min(c.y,y.y),F=Math.max(c.y,y.y),U=[new x.pointGeometry(S,O),new x.pointGeometry(P,F),new x.pointGeometry(S,F),new x.pointGeometry(P,O)],q=this._renderWorldCopies?-3:0,Y=this._renderWorldCopies?4:1;for(const te of U){const ie=this.pointRayIntersection(te);if(ie.t<0)return!0;const se=this.rayIntersectionCoordinate(ie);if(se.x<q||se.y<0||se.x>Y||se.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+x.radToDeg(this.fovAboveCenter)>88||this.isHorizonVisibleForPoints(new x.pointGeometry(0,0),new x.pointGeometry(this.width,this.height))}zoomDeltaToMovement(c,y){const S=x.length(x.sub([],this._camera.position,c)),P=this._zoomFromMercatorZ(S)+y;return S-this._mercatorZfromZoom(P)}getCameraPoint(){const c=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new x.pointGeometry(0,c))}}function Zl(C,c){let y=!1,S=null;const P=()=>{S=null,y&&(C(),S=setTimeout(P,c),y=!1)};return()=>(y=!0,S||P(),S)}class eh{constructor(c){this._hashName=c&&encodeURIComponent(c),x.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Zl(this._updateHashUnthrottled.bind(this),300)}addTo(c){return this._map=c,x.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return x.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(c){const y=this._map.getCenter(),S=Math.round(100*this._map.getZoom())/100,P=Math.ceil((S*Math.LN2+Math.log(512/360/.5))/Math.LN10),O=Math.pow(10,P),F=Math.round(y.lng*O)/O,U=Math.round(y.lat*O)/O,q=this._map.getBearing(),Y=this._map.getPitch();let te="";if(te+=c?`/${F}/${U}/${S}`:`${S}/${U}/${F}`,(q||Y)&&(te+="/"+Math.round(10*q)/10),Y&&(te+=`/${Math.round(Y)}`),this._hashName){const ie=this._hashName;let se=!1;const we=x.window.location.hash.slice(1).split("&").map(Fe=>{const Ve=Fe.split("=")[0];return Ve===ie?(se=!0,`${Ve}=${te}`):Fe}).filter(Fe=>Fe);return se||we.push(`${ie}=${te}`),`#${we.join("&")}`}return`#${te}`}_getCurrentHash(){const c=x.window.location.hash.replace("#","");if(this._hashName){let y;return c.split("&").map(S=>S.split("=")).forEach(S=>{S[0]===this._hashName&&(y=S)}),(y&&y[1]||"").split("/")}return c.split("/")}_onHashChange(){const c=this._getCurrentHash();if(c.length>=3&&!c.some(y=>isNaN(y))){const y=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(c[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+c[2],+c[1]],zoom:+c[0],bearing:y,pitch:+(c[4]||0)}),!0}return!1}_updateHashUnthrottled(){const c=x.window.location.href.replace(/(#.+)?$/,this.getHashString());x.window.history.replaceState(x.window.history.state,null,c)}}const fs={linearity:.3,easing:x.bezier(0,0,.3,1)},Ps=x.extend({deceleration:2500,maxSpeed:1400},fs),Ml=x.extend({deceleration:20,maxSpeed:1400},fs),cl=x.extend({deceleration:1e3,maxSpeed:360},fs),Yd=x.extend({deceleration:1e3,maxSpeed:90},fs);class qu{constructor(c){this._map=c,this.clear()}clear(){this._inertiaBuffer=[]}record(c){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:x.exported.now(),settings:c})}_drainInertiaBuffer(){const c=this._inertiaBuffer,y=x.exported.now();for(;c.length>0&&y-c[0].time>160;)c.shift()}_onMoveEnd(c){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const y={zoom:0,bearing:0,pitch:0,pan:new x.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:O}of this._inertiaBuffer)y.zoom+=O.zoomDelta||0,y.bearing+=O.bearingDelta||0,y.pitch+=O.pitchDelta||0,O.panDelta&&y.pan._add(O.panDelta),O.around&&(y.around=O.around),O.pinchAround&&(y.pinchAround=O.pinchAround);const S=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,P={};if(y.pan.mag()){const O=ia(y.pan.mag(),S,x.extend({},Ps,c||{}));P.offset=y.pan.mult(O.amount/y.pan.mag()),P.center=this._map.transform.center,Tl(P,O)}if(y.zoom){const O=ia(y.zoom,S,Ml);P.zoom=this._map.transform.zoom+O.amount,Tl(P,O)}if(y.bearing){const O=ia(y.bearing,S,cl);P.bearing=this._map.transform.bearing+x.clamp(O.amount,-179,179),Tl(P,O)}if(y.pitch){const O=ia(y.pitch,S,Yd);P.pitch=this._map.transform.pitch+O.amount,Tl(P,O)}if(P.zoom||P.bearing){const O=void 0===y.pinchAround?y.around:y.pinchAround;P.around=O?this._map.unproject(O):this._map.getCenter()}return this.clear(),x.extend(P,{noMoveStart:!0})}}function Tl(C,c){(!C.duration||C.duration<c.duration)&&(C.duration=c.duration,C.easing=c.easing)}function ia(C,c,y){const{maxSpeed:S,linearity:P,deceleration:O}=y,F=x.clamp(C*P/(c/1e3),-S,S),U=Math.abs(F)/(O*P);return{easing:y.easing,duration:1e3*U,amount:F*(U/2)}}class hl extends x.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(c,y,S,P={}){const O=Qe.mousePos(y.getCanvasContainer(),S),F=y.unproject(O);super(c,x.extend({point:O,lngLat:F,originalEvent:S},P)),this._defaultPrevented=!1,this.target=y}}class ps extends x.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(c,y,S){const P="touchend"===c?S.changedTouches:S.touches,O=Qe.touchPos(y.getCanvasContainer(),P),F=O.map(q=>y.unproject(q)),U=O.reduce((q,Y,te,ie)=>q.add(Y.div(ie.length)),new x.pointGeometry(0,0));super(c,{points:O,point:U,lngLats:F,lngLat:y.unproject(U),originalEvent:S}),this._defaultPrevented=!1}}class Nh extends x.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(c,y,S){super(c,{originalEvent:S}),this._defaultPrevented=!1}}class Qa{constructor(c,y){this._map=c,this._clickTolerance=y.clickTolerance}reset(){delete this._mousedownPos}wheel(c){return this._firePreventable(new Nh(c.type,this._map,c))}mousedown(c,y){return this._mousedownPos=y,this._firePreventable(new hl(c.type,this._map,c))}mouseup(c){this._map.fire(new hl(c.type,this._map,c))}click(c,y){this._mousedownPos&&this._mousedownPos.dist(y)>=this._clickTolerance||this._map.fire(new hl(c.type,this._map,c))}dblclick(c){return this._firePreventable(new hl(c.type,this._map,c))}mouseover(c){this._map.fire(new hl(c.type,this._map,c))}mouseout(c){this._map.fire(new hl(c.type,this._map,c))}touchstart(c){return this._firePreventable(new ps(c.type,this._map,c))}touchmove(c){this._map.fire(new ps(c.type,this._map,c))}touchend(c){this._map.fire(new ps(c.type,this._map,c))}touchcancel(c){this._map.fire(new ps(c.type,this._map,c))}_firePreventable(c){if(this._map.fire(c),c.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Ko{constructor(c){this._map=c}reset(){this._delayContextMenu=!1,delete this._contextMenuEvent}mousemove(c){this._map.fire(new hl(c.type,this._map,c))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new hl("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(c){this._delayContextMenu?this._contextMenuEvent=c:this._map.fire(new hl(c.type,this._map,c)),this._map.listens("contextmenu")&&c.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Dl{constructor(c,y){this._map=c,this._el=c.getCanvasContainer(),this._container=c.getContainer(),this._clickTolerance=y.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(c,y){this.isEnabled()&&c.shiftKey&&0===c.button&&(Qe.disableDrag(),this._startPos=this._lastPos=y,this._active=!0)}mousemoveWindow(c,y){if(!this._active)return;const S=y;if(this._lastPos.equals(S)||!this._box&&S.dist(this._startPos)<this._clickTolerance)return;const P=this._startPos;this._lastPos=S,this._box||(this._box=Qe.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",c));const O=Math.min(P.x,S.x),F=Math.max(P.x,S.x),U=Math.min(P.y,S.y),q=Math.max(P.y,S.y);this._map._requestDomTask(()=>{this._box&&(Qe.setTransform(this._box,`translate(${O}px,${U}px)`),this._box.style.width=F-O+"px",this._box.style.height=q-U+"px")})}mouseupWindow(c,y){if(!this._active||0!==c.button)return;const S=this._startPos,P=y;if(this.reset(),Qe.suppressClick(),S.x!==P.x||S.y!==P.y)return this._map.fire(new x.Event("boxzoomend",{originalEvent:c})),{cameraAnimation:O=>O.fitScreenCoordinates(S,P,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",c)}keydown(c){this._active&&27===c.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",c))}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(Qe.remove(this._box),this._box=null),Qe.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(c,y){return this._map.fire(new x.Event(c,{originalEvent:y}))}}function Eu(C,c){const y={};for(let S=0;S<C.length;S++)y[C[S].identifier]=c[S];return y}class dl{constructor(c){this.reset(),this.numTouches=c.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(c,y,S){(this.centroid||S.length>this.numTouches)&&(this.aborted=!0),this.aborted||(void 0===this.startTime&&(this.startTime=c.timeStamp),S.length===this.numTouches&&(this.centroid=function(P){const O=new x.pointGeometry(0,0);for(const F of P)O._add(F);return O.div(P.length)}(y),this.touches=Eu(S,y)))}touchmove(c,y,S){if(this.aborted||!this.centroid)return;const P=Eu(S,y);for(const O in this.touches){const F=this.touches[O],U=P[O];(!U||U.dist(F)>30)&&(this.aborted=!0)}}touchend(c,y,S){if((!this.centroid||c.timeStamp-this.startTime>500)&&(this.aborted=!0),0===S.length){const P=!this.aborted&&this.centroid;if(this.reset(),P)return P}}}class Ua{constructor(c){this.singleTap=new dl(c),this.numTaps=c.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(c,y,S){this.singleTap.touchstart(c,y,S)}touchmove(c,y,S){this.singleTap.touchmove(c,y,S)}touchend(c,y,S){const P=this.singleTap.touchend(c,y,S);if(P){const O=c.timeStamp-this.lastTime<500,F=!this.lastTap||this.lastTap.dist(P)<30;if(O&&F||this.reset(),this.count++,this.lastTime=c.timeStamp,this.lastTap=P,this.count===this.numTaps)return this.reset(),P}}}class Lo{constructor(){this._zoomIn=new Ua({numTouches:1,numTaps:2}),this._zoomOut=new Ua({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(c,y,S){this._zoomIn.touchstart(c,y,S),this._zoomOut.touchstart(c,y,S)}touchmove(c,y,S){this._zoomIn.touchmove(c,y,S),this._zoomOut.touchmove(c,y,S)}touchend(c,y,S){const P=this._zoomIn.touchend(c,y,S),O=this._zoomOut.touchend(c,y,S);return P?(this._active=!0,c.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:F=>F.easeTo({duration:300,zoom:F.getZoom()+1,around:F.unproject(P)},{originalEvent:c})}):O?(this._active=!0,c.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:F=>F.easeTo({duration:300,zoom:F.getZoom()-1,around:F.unproject(O)},{originalEvent:c})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const oa={0:1,2:2};class No{constructor(c){this.reset(),this._clickTolerance=c.clickTolerance||1}reset(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton}_correctButton(c,y){return!1}_move(c,y){return{}}mousedown(c,y){if(this._lastPoint)return;const S=Qe.mouseButton(c);this._correctButton(c,S)&&(this._lastPoint=y,this._eventButton=S)}mousemoveWindow(c,y){const S=this._lastPoint;if(S)if(c.preventDefault(),function(P,O){const F=oa[O];return void 0===P.buttons||(P.buttons&F)!==F}(c,this._eventButton))this.reset();else if(this._moved||!(y.dist(S)<this._clickTolerance))return this._moved=!0,this._lastPoint=y,this._move(S,y)}mouseupWindow(c){this._lastPoint&&Qe.mouseButton(c)===this._eventButton&&(this._moved&&Qe.suppressClick(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Jo extends No{mousedown(c,y){super.mousedown(c,y),this._lastPoint&&(this._active=!0)}_correctButton(c,y){return 0===y&&!c.ctrlKey}_move(c,y){return{around:y,panDelta:y.sub(c)}}}class Kl extends No{_correctButton(c,y){return 0===y&&c.ctrlKey||2===y}_move(c,y){const S=.8*(y.x-c.x);if(S)return this._active=!0,{bearingDelta:S}}contextmenu(c){c.preventDefault()}}class Fh extends No{_correctButton(c,y){return 0===y&&c.ctrlKey||2===y}_move(c,y){const S=-.5*(y.y-c.y);if(S)return this._active=!0,{pitchDelta:S}}contextmenu(c){c.preventDefault()}}class Qo{constructor(c){this._minTouches=1,this._clickTolerance=c.clickTolerance||1,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new x.pointGeometry(0,0)}touchstart(c,y,S){return this._calculateTransform(c,y,S)}touchmove(c,y,S){if(this._active&&!(S.length<this._minTouches))return c.preventDefault(),this._calculateTransform(c,y,S)}touchend(c,y,S){this._calculateTransform(c,y,S),this._active&&S.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(c,y,S){S.length>0&&(this._active=!0);const P=Eu(S,y),O=new x.pointGeometry(0,0),F=new x.pointGeometry(0,0);let U=0;for(const Y in P){const te=P[Y],ie=this._touches[Y];ie&&(O._add(te),F._add(te.sub(ie)),U++,P[Y]=te)}if(this._touches=P,U<this._minTouches||!F.mag())return;const q=F.div(U);return this._sum._add(q),this._sum.mag()<this._clickTolerance?void 0:{around:O.div(U),panDelta:q}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ya{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}_start(c){}_move(c,y,S){return{}}touchstart(c,y,S){this._firstTwoTouches||S.length<2||(this._firstTwoTouches=[S[0].identifier,S[1].identifier],this._start([y[0],y[1]]))}touchmove(c,y,S){if(!this._firstTwoTouches)return;c.preventDefault();const[P,O]=this._firstTwoTouches,F=th(S,y,P),U=th(S,y,O);if(!F||!U)return;const q=this._aroundCenter?null:F.add(U).div(2);return this._move([F,U],q,c)}touchend(c,y,S){if(!this._firstTwoTouches)return;const[P,O]=this._firstTwoTouches,F=th(S,y,P),U=th(S,y,O);F&&U||(this._active&&Qe.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(c){this._enabled=!0,this._aroundCenter=!!c&&"center"===c.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function th(C,c,y){for(let S=0;S<C.length;S++)if(C[S].identifier===y)return c[S]}function sa(C,c){return Math.log(C/c)/Math.LN2}class Cu extends ya{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(c){this._startDistance=this._distance=c[0].dist(c[1])}_move(c,y){const S=this._distance;if(this._distance=c[0].dist(c[1]),this._active||!(Math.abs(sa(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:sa(this._distance,S),pinchAround:y}}}function gs(C,c){return 180*C.angleWith(c)/Math.PI}class Rs extends ya{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(c){this._startVector=this._vector=c[0].sub(c[1]),this._minDiameter=c[0].dist(c[1])}_move(c,y){const S=this._vector;if(this._vector=c[0].sub(c[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:gs(this._vector,S),pinchAround:y}}_isBelowThreshold(c){this._minDiameter=Math.min(this._minDiameter,c.mag());const y=25/(Math.PI*this._minDiameter)*360,S=gs(c,this._startVector);return Math.abs(S)<y}}function pu(C){return Math.abs(C.y)>Math.abs(C.x)}class Fo extends ya{reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}_start(c){this._lastPoints=c,pu(c[0].sub(c[1]))&&(this._valid=!1)}_move(c,y,S){const P=c[0].sub(this._lastPoints[0]),O=c[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(P,O,S.timeStamp),this._valid)return this._lastPoints=c,this._active=!0,{pitchDelta:(P.y+O.y)/2*-.5}}gestureBeginsVertically(c,y,S){if(void 0!==this._valid)return this._valid;const P=c.mag()>=2,O=y.mag()>=2;if(!P&&!O)return;if(!P||!O)return void 0===this._firstMove&&(this._firstMove=S),S-this._firstMove<100&&void 0;const F=c.y>0==y.y>0;return pu(c)&&pu(y)&&F}}const Zd={panStep:100,bearingStep:15,pitchStep:10};class Go{constructor(){const c=Zd;this._panStep=c.panStep,this._bearingStep=c.bearingStep,this._pitchStep=c.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(c){if(c.altKey||c.ctrlKey||c.metaKey)return;let y=0,S=0,P=0,O=0,F=0;switch(c.keyCode){case 61:case 107:case 171:case 187:y=1;break;case 189:case 109:case 173:y=-1;break;case 37:c.shiftKey?S=-1:(c.preventDefault(),O=-1);break;case 39:c.shiftKey?S=1:(c.preventDefault(),O=1);break;case 38:c.shiftKey?P=1:(c.preventDefault(),F=-1);break;case 40:c.shiftKey?P=-1:(c.preventDefault(),F=1);break;default:return}return this._rotationDisabled&&(S=0,P=0),{cameraAnimation:U=>{const q=U.getZoom();U.easeTo({duration:300,easeId:"keyboardHandler",easing:ms,zoom:y?Math.round(q)+y*(c.shiftKey?2:1):q,bearing:U.getBearing()+S*this._bearingStep,pitch:U.getPitch()+P*this._pitchStep,offset:[-O*this._panStep,-F*this._panStep],center:U.getCenter()},{originalEvent:c})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function ms(C){return C*(2-C)}const Bn=4.000244140625;class Jl{constructor(c,y){this._map=c,this._el=c.getCanvasContainer(),this._handler=y,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,x.bindAll(["_onTimeout"],this)}setZoomRate(c){this._defaultZoomRate=c}setWheelZoomRate(c){this._wheelZoomRate=c}isEnabled(){return!!this._enabled}isActive(){return!!this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(c){this.isEnabled()||(this._enabled=!0,this._aroundCenter=c&&"center"===c.around)}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(c){if(!this.isEnabled())return;let y=c.deltaMode===x.window.WheelEvent.DOM_DELTA_LINE?40*c.deltaY:c.deltaY;const S=x.exported.now(),P=S-(this._lastWheelEventTime||0);this._lastWheelEventTime=S,0!==y&&y%Bn==0?this._type="wheel":0!==y&&Math.abs(y)<4?this._type="trackpad":P>400?(this._type=null,this._lastValue=y,this._timeout=setTimeout(this._onTimeout,40,c)):this._type||(this._type=Math.abs(P*y)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,y+=this._lastValue)),c.shiftKey&&y&&(y/=4),this._type&&(this._lastWheelEvent=c,this._delta-=y,this._active||this._start(c)),c.preventDefault()}_onTimeout(c){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(c)}_start(c){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const y=Qe.mousePos(this._el,c);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:y,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const c=this._map.transform,y=()=>c._terrainEnabled()?c.computeZoomRelativeTo(this._aroundCoord):c.zoom;if(0!==this._delta){const q="wheel"===this._type&&Math.abs(this._delta)>Bn?this._wheelZoomRate:this._defaultZoomRate;let Y=2/(1+Math.exp(-Math.abs(this._delta*q)));this._delta<0&&0!==Y&&(Y=1/Y);const te=y(),ie=Math.pow(2,te),se="number"==typeof this._targetZoom?c.zoomScale(this._targetZoom):ie;this._targetZoom=Math.min(c.maxZoom,Math.max(c.minZoom,c.scaleZoom(se*Y))),"wheel"===this._type&&(this._startZoom=y(),this._easing=this._smoothOutEasing(200)),this._delta=0}const S="number"==typeof this._targetZoom?this._targetZoom:y(),P=this._startZoom,O=this._easing;let F,U=!1;if("wheel"===this._type&&P&&O){const q=Math.min((x.exported.now()-this._lastWheelEventTime)/200,1),Y=O(q);F=x.number(P,S,Y),q<1?this._frameId||(this._frameId=!0):U=!0}else F=S,U=!0;return this._active=!0,U&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!U,zoomDelta:F-y(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(c){let y=x.ease;if(this._prevEase){const S=this._prevEase,P=(x.exported.now()-S.start)/S.duration,O=S.easing(P+.01)-S.easing(P),F=.27/Math.sqrt(O*O+1e-4)*.01,U=Math.sqrt(.0729-F*F);y=x.bezier(F,U,.25,1)}return this._prevEase={start:x.exported.now(),duration:c,easing:y},y}reset(){this._active=!1}}class Cs{constructor(c,y){this._clickZoom=c,this._tapZoom=y}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Wu{constructor(){this.reset()}reset(){this._active=!1}dblclick(c,y){return c.preventDefault(),{cameraAnimation:S=>{S.easeTo({duration:300,zoom:S.getZoom()+(c.shiftKey?-1:1),around:S.unproject(y)},{originalEvent:c})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class md{constructor(){this._tap=new Ua({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()}touchstart(c,y,S){this._swipePoint||(this._tapTime&&c.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?S.length>0&&(this._swipePoint=y[0],this._swipeTouch=S[0].identifier):this._tap.touchstart(c,y,S))}touchmove(c,y,S){if(this._tapTime){if(this._swipePoint){if(S[0].identifier!==this._swipeTouch)return;const P=y[0],O=P.y-this._swipePoint.y;return this._swipePoint=P,c.preventDefault(),this._active=!0,{zoomDelta:O/128}}}else this._tap.touchmove(c,y,S)}touchend(c,y,S){this._tapTime?this._swipePoint&&0===S.length&&this.reset():this._tap.touchend(c,y,S)&&(this._tapTime=c.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Bh{constructor(c,y,S){this._el=c,this._mousePan=y,this._touchPan=S}enable(c){this._inertiaOptions=c||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class _s{constructor(c,y,S){this._pitchWithRotate=c.pitchWithRotate,this._mouseRotate=y,this._mousePitch=S}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Rc{constructor(c,y,S,P){this._el=c,this._touchZoom=y,this._touchRotate=S,this._tapDragZoom=P,this._rotationDisabled=!1,this._enabled=!0}enable(c){this._touchZoom.enable(c),this._rotationDisabled||this._touchRotate.enable(c),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Ql=C=>C.zoom||C.drag||C.pitch||C.rotate;class Xu extends x.Event{}class aa{constructor(){this.constants=[1,1,.01],this.radius=0}setup(c,y){const S=x.sub([],y,c);this.radius=x.length(S[2]<0?x.div([],S,this.constants):[S[0],S[1],0])}projectRay(c){x.div(c,c,this.constants),x.normalize(c,c),x.mul$2(c,c,this.constants);const y=x.scale([],c,this.radius);if(y[2]>0){const S=x.scale([],[0,0,1],x.dot(y,[0,0,1])),P=x.scale([],x.normalize([],[y[0],y[1],0]),this.radius),O=x.add([],y,x.scale([],x.sub([],x.add([],P,S),y),2));y[0]=O[0],y[1]=O[1]}return y}}function Il(C){return C.panDelta&&C.panDelta.mag()||C.zoomDelta||C.bearingDelta||C.pitchDelta}class Su{constructor(c,y){this._map=c,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new qu(c),this._bearingSnap=y.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new aa,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(y),x.bindAll(["handleEvent","handleWindowEvent"],this);const S=this._el;this._listeners=[[S,"touchstart",{passive:!0}],[S,"touchmove",{passive:!1}],[S,"touchend",void 0],[S,"touchcancel",void 0],[S,"mousedown",void 0],[S,"mousemove",void 0],[S,"mouseup",void 0],[x.window.document,"mousemove",{capture:!0}],[x.window.document,"mouseup",void 0],[S,"mouseover",void 0],[S,"mouseout",void 0],[S,"dblclick",void 0],[S,"click",void 0],[S,"keydown",{capture:!1}],[S,"keyup",void 0],[S,"wheel",{passive:!1}],[S,"contextmenu",void 0],[x.window,"blur",void 0]];for(const[P,O,F]of this._listeners)Qe.addEventListener(P,O,P===x.window.document?this.handleWindowEvent:this.handleEvent,F)}destroy(){for(const[c,y,S]of this._listeners)Qe.removeEventListener(c,y,c===x.window.document?this.handleWindowEvent:this.handleEvent,S)}_addDefaultHandlers(c){const y=this._map,S=y.getCanvasContainer();this._add("mapEvent",new Qa(y,c));const P=y.boxZoom=new Dl(y,c);this._add("boxZoom",P);const O=new Lo,F=new Wu;y.doubleClickZoom=new Cs(F,O),this._add("tapZoom",O),this._add("clickZoom",F);const U=new md;this._add("tapDragZoom",U);const q=y.touchPitch=new Fo;this._add("touchPitch",q);const Y=new Kl(c),te=new Fh(c);y.dragRotate=new _s(c,Y,te),this._add("mouseRotate",Y,["mousePitch"]),this._add("mousePitch",te,["mouseRotate"]);const ie=new Jo(c),se=new Qo(c);y.dragPan=new Bh(S,ie,se),this._add("mousePan",ie),this._add("touchPan",se,["touchZoom","touchRotate"]);const we=new Rs,Fe=new Cu;y.touchZoomRotate=new Rc(S,Fe,we,U),this._add("touchRotate",we,["touchPan","touchZoom"]),this._add("touchZoom",Fe,["touchPan","touchRotate"]),this._add("blockableMapEvent",new Ko(y));const Ve=y.scrollZoom=new Jl(y,this);this._add("scrollZoom",Ve,["mousePan"]);const nt=y.keyboard=new Go;this._add("keyboard",nt);for(const Te of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])c.interactive&&c[Te]&&y[Te].enable(c[Te])}_add(c,y,S){this._handlers.push({handlerName:c,handler:y,allowed:S}),this._handlersById[c]=y}stop(c){if(!this._updatingCamera){for(const{handler:y}of this._handlers)y.reset();this._inertia.clear(),this._fireEvents({},{},c),this._changes=[]}}isActive(){for(const{handler:c}of this._handlers)if(c.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return Boolean(Ql(this._eventsInProgress))||this.isZooming()}_blockedByActive(c,y,S){for(const P in c)if(P!==S&&(!y||y.indexOf(P)<0))return!0;return!1}handleWindowEvent(c){this.handleEvent(c,`${c.type}Window`)}_getMapTouches(c){const y=[];for(const S of c)this._el.contains(S.target)&&y.push(S);return y}handleEvent(c,y){if("blur"===c.type)return void this.stop(!0);this._updatingCamera=!0;const S="renderFrame"===c.type,P=S?void 0:c,O={needsRenderFrame:!1},F={},U={},q=c.touches?this._getMapTouches(c.touches):void 0,Y=q?Qe.touchPos(this._el,q):S?void 0:Qe.mousePos(this._el,c);for(const{handlerName:se,handler:we,allowed:Fe}of this._handlers){if(!we.isEnabled())continue;let Ve;this._blockedByActive(U,Fe,se)?we.reset():we[y||c.type]&&(Ve=we[y||c.type](c,Y,q),this.mergeHandlerResult(O,F,Ve,se,P),Ve&&Ve.needsRenderFrame&&this._triggerRenderFrame()),(Ve||we.isActive())&&(U[se]=we)}const te={};for(const se in this._previousActiveHandlers)U[se]||(te[se]=P);this._previousActiveHandlers=U,(Object.keys(te).length||Il(O))&&(this._changes.push([O,F,te]),this._triggerRenderFrame()),(Object.keys(U).length||Il(O))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:ie}=O;ie&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],ie(this._map))}mergeHandlerResult(c,y,S,P,O){if(!S)return;x.extend(c,S);const F={handlerName:P,originalEvent:S.originalEvent||O};void 0!==S.zoomDelta&&(y.zoom=F),void 0!==S.panDelta&&(y.drag=F),void 0!==S.pitchDelta&&(y.pitch=F),void 0!==S.bearingDelta&&(y.rotate=F)}_applyChanges(){const c={},y={},S={};for(const[P,O,F]of this._changes)P.panDelta&&(c.panDelta=(c.panDelta||new x.pointGeometry(0,0))._add(P.panDelta)),P.zoomDelta&&(c.zoomDelta=(c.zoomDelta||0)+P.zoomDelta),P.bearingDelta&&(c.bearingDelta=(c.bearingDelta||0)+P.bearingDelta),P.pitchDelta&&(c.pitchDelta=(c.pitchDelta||0)+P.pitchDelta),void 0!==P.around&&(c.around=P.around),void 0!==P.aroundCoord&&(c.aroundCoord=P.aroundCoord),void 0!==P.pinchAround&&(c.pinchAround=P.pinchAround),P.noInertia&&(c.noInertia=P.noInertia),x.extend(y,O),x.extend(S,F);this._updateMapTransform(c,y,S),this._changes=[]}_updateMapTransform(c,y,S){const P=this._map,O=P.transform,F=He=>[He.x,He.y,He.z];if((He=>{const Je=this._eventsInProgress.drag;return Je&&!this._handlersById[Je.handlerName].isActive()})()&&!Il(c)){const He=O.zoom;O.cameraElevationReference="sea",O.recenterOnTerrain(),O.cameraElevationReference="ground",He!==O.zoom&&this._map._update(!0)}if(!Il(c))return this._fireEvents(y,S,!0);let{panDelta:U,zoomDelta:q,bearingDelta:Y,pitchDelta:te,around:ie,aroundCoord:se,pinchAround:we}=c;void 0!==we&&(ie=we),(He=>y.drag&&!this._eventsInProgress.drag)()&&ie&&(this._dragOrigin=F(O.pointCoordinate3D(ie)),this._trackingEllipsoid.setup(O._camera.position,this._dragOrigin)),O.cameraElevationReference="sea",P._stop(!0),ie=ie||P.transform.centerPoint,Y&&(O.bearing+=Y),te&&(O.pitch+=te),O._updateCameraState();const Fe=[0,0,0];if(U){const He=O.screenPointToMercatorRay(ie),Je=O.screenPointToMercatorRay(ie.sub(U)),ot=this._trackingEllipsoid.projectRay(He.dir),Xe=this._trackingEllipsoid.projectRay(Je.dir);Fe[0]=Xe[0]-ot[0],Fe[1]=Xe[1]-ot[1]}const Ve=O.zoom,nt=[0,0,0];if(q){const He=F(se||O.pointCoordinate3D(ie)),Je={dir:x.normalize([],x.sub([],He,O._camera.position))},ot=O.screenPointToMercatorRay(O.centerPoint);if(Je.dir[2]<0){const Xe=x.altitudeFromMercatorZ(He[2],He[1]),Ye=O.rayIntersectionCoordinate(O.pointRayIntersection(O.centerPoint,Xe)),$t=O.zoomDeltaToMovement(F(Ye),q)*(ot.dir[2]/Je.dir[2]);x.scale(nt,Je.dir,$t)}else if(O._terrainEnabled()){const Xe=O.zoomDeltaToMovement(He,q);x.scale(nt,Je.dir,Xe)}}const Te=x.add(Fe,Fe,nt);O._translateCameraConstrained(Te),q&&Math.abs(O.zoom-Ve)>1e-4&&O.recenterOnTerrain(),O.cameraElevationReference="ground",this._map._update(),c.noInertia||this._inertia.record(c),this._fireEvents(y,S,!0)}_fireEvents(c,y,S){const P=Ql(this._eventsInProgress),O=Ql(c),F={};for(const te in c){const{originalEvent:ie}=c[te];this._eventsInProgress[te]||(F[`${te}start`]=ie),this._eventsInProgress[te]=c[te]}!P&&O&&this._fireEvent("movestart",O.originalEvent);for(const te in F)this._fireEvent(te,F[te]);O&&this._fireEvent("move",O.originalEvent);for(const te in c){const{originalEvent:ie}=c[te];this._fireEvent(te,ie)}const U={};let q;for(const te in this._eventsInProgress){const{handlerName:ie,originalEvent:se}=this._eventsInProgress[te];this._handlersById[ie].isActive()||(delete this._eventsInProgress[te],q=y[ie]||se,U[`${te}end`]=q)}for(const te in U)this._fireEvent(te,U[te]);const Y=Ql(this._eventsInProgress);if(S&&(P||O)&&!Y){this._updatingCamera=!0;const te=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),ie=se=>0!==se&&-this._bearingSnap<se&&se<this._bearingSnap;te?(ie(te.bearing||this._map.getBearing())&&(te.bearing=0),this._map.easeTo(te,{originalEvent:q})):(this._map.fire(new x.Event("moveend",{originalEvent:q})),ie(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(c,y){this._map.fire(new x.Event(c,y?{originalEvent:y}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(c=>{delete this._frameId,this.handleEvent(new Xu("renderFrame",{timeStamp:c})),this._applyChanges()})}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}class _c extends x.Evented{constructor(c,y){super(),this._moving=!1,this._zooming=!1,this.transform=c,this._bearingSnap=y.bearingSnap,x.bindAll(["_renderFrameCallback"],this)}getCenter(){return new x.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(c,y){return this.jumpTo({center:c},y)}panBy(c,y,S){return c=x.pointGeometry.convert(c).mult(-1),this.panTo(this.transform.center,x.extend({offset:c},y),S)}panTo(c,y,S){return this.easeTo(x.extend({center:c},y),S)}getZoom(){return this.transform.zoom}setZoom(c,y){return this.jumpTo({zoom:c},y),this}zoomTo(c,y,S){return this.easeTo(x.extend({zoom:c},y),S)}zoomIn(c,y){return this.zoomTo(this.getZoom()+1,c,y),this}zoomOut(c,y){return this.zoomTo(this.getZoom()-1,c,y),this}getBearing(){return this.transform.bearing}setBearing(c,y){return this.jumpTo({bearing:c},y),this}getPadding(){return this.transform.padding}setPadding(c,y){return this.jumpTo({padding:c},y),this}rotateTo(c,y,S){return this.easeTo(x.extend({bearing:c},y),S)}resetNorth(c,y){return this.rotateTo(0,x.extend({duration:1e3},c),y),this}resetNorthPitch(c,y){return this.easeTo(x.extend({bearing:0,pitch:0,duration:1e3},c),y),this}snapToNorth(c,y){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(c,y):this}getPitch(){return this.transform.pitch}setPitch(c,y){return this.jumpTo({pitch:c},y),this}cameraForBounds(c,y){c=x.LngLatBounds.convert(c);const S=y&&y.bearing||0;return this._cameraForBoxAndBearing(c.getNorthWest(),c.getSouthEast(),S,y)}_extendCameraOptions(c){const y={top:0,bottom:0,right:0,left:0};if("number"==typeof(c=x.extend({padding:y,offset:[0,0],maxZoom:this.transform.maxZoom},c)).padding){const S=c.padding;c.padding={top:S,bottom:S,right:S,left:S}}return c.padding=x.extend(y,c.padding),c}_cameraForBoxAndBearing(c,y,S,P){const O=this._extendCameraOptions(P),F=this.transform,U=F.padding,q=F.project(x.LngLat.convert(c)),Y=F.project(x.LngLat.convert(y)),te=q.rotate(-x.degToRad(S)),ie=Y.rotate(-x.degToRad(S)),se=new x.pointGeometry(Math.max(te.x,ie.x),Math.max(te.y,ie.y)),we=new x.pointGeometry(Math.min(te.x,ie.x),Math.min(te.y,ie.y)),Fe=se.sub(we),Ve=(F.width-(U.left+U.right+O.padding.left+O.padding.right))/Fe.x,nt=(F.height-(U.top+U.bottom+O.padding.top+O.padding.bottom))/Fe.y;if(nt<0||Ve<0)return void x.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const Te=Math.min(F.scaleZoom(F.scale*Math.min(Ve,nt)),O.maxZoom),He="number"==typeof O.offset.x?new x.pointGeometry(O.offset.x,O.offset.y):x.pointGeometry.convert(O.offset),Je=new x.pointGeometry((O.padding.left-O.padding.right)/2,(O.padding.top-O.padding.bottom)/2).rotate(S*Math.PI/180),ot=He.add(Je).mult(F.scale/F.zoomScale(Te));return{center:F.unproject(q.add(Y).div(2).sub(ot)),zoom:Te,bearing:S}}_cameraForBox(c,y,S,P,O){const F=this._extendCameraOptions(O);S=S||0,P=P||0,c=x.LngLat.convert(c),y=x.LngLat.convert(y);const U=this.transform.clone();U.padding=F.padding;const q=this.getFreeCameraOptions(),Y=new x.LngLat(.5*(c.lng+y.lng),.5*(c.lat+y.lat)),te=.5*(S+P);if(U._camera.position[2]<x.mercatorZfromAltitude(te,Y.lat))return void x.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");q.lookAtPoint(Y),U.setFreeCameraOptions(q);const ie=x.MercatorCoordinate.fromLngLat(c),se=x.MercatorCoordinate.fromLngLat(y),we=U.pointRayIntersection(U.centerPoint,te),Fe=[(Ve=U.rayIntersectionCoordinate(we)).x,Ve.y,Ve.z];var Ve;const nt=U.screenPointToMercatorRay(U.centerPoint);let Te,He=0;do{const Je=Math.floor(U.zoom),ot=1<<Je,Xe=Math.min(ot*ie.x,ot*se.x),Ye=Math.min(ot*ie.y,ot*se.y),$t=Math.max(ot*ie.x,ot*se.x),qt=Math.max(ot*ie.y,ot*se.y),Jt=new pe([Xe,Ye,S],[$t,qt,P]),et=ue.fromInvProjectionMatrix(U.invProjMatrix,U.worldSize,Je);if(2!==Jt.intersects(et)){Te&&(U._camera.position=x.scaleAndAdd([],U._camera.position,nt.dir,-Te),U._updateStateFromCamera());break}const xn=x.sub([],U._camera.position,Fe);Te=.5*x.length(xn),U._camera.position=x.scaleAndAdd([],U._camera.position,nt.dir,Te);try{U._updateStateFromCamera()}catch(un){return void x.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}}while(++He<10);return{center:U.center,zoom:U.zoom,bearing:U.bearing,pitch:U.pitch}}fitBounds(c,y,S){return this._fitInternal(this.cameraForBounds(c,y),y,S)}_raycastElevationBox(c,y){const S=this.transform.elevation;if(!S)return;const P=new x.pointGeometry(c.x,y.y),O=new x.pointGeometry(y.x,c.y),F=S.pointCoordinate(c);if(!F)return;const U=S.pointCoordinate(y);if(!U)return;const q=S.pointCoordinate(P);if(!q)return;const Y=S.pointCoordinate(O);if(!Y)return;const te=new x.MercatorCoordinate(F[0],F[1]).toLngLat(),ie=new x.MercatorCoordinate(U[0],U[1]).toLngLat(),se=new x.MercatorCoordinate(q[0],q[1]).toLngLat(),we=new x.MercatorCoordinate(Y[0],Y[1]).toLngLat(),Fe=Math.min(te.lng,Math.min(ie.lng,Math.min(se.lng,we.lng))),Ve=Math.min(te.lat,Math.min(ie.lat,Math.min(se.lat,we.lat))),nt=Math.max(te.lng,Math.max(ie.lng,Math.max(se.lng,we.lng))),Te=Math.max(te.lat,Math.max(ie.lat,Math.max(se.lat,we.lat))),He=Math.min(F[3],Math.min(U[3],Math.min(q[3],Y[3]))),Je=Math.max(F[3],Math.max(U[3],Math.max(q[3],Y[3])));return{minLngLat:new x.LngLat(Fe,Ve),maxLngLat:new x.LngLat(nt,Te),minAltitude:He,maxAltitude:Je}}fitScreenCoordinates(c,y,S,P,O){let F,U,q,Y;const te=x.pointGeometry.convert(c),ie=x.pointGeometry.convert(y),se=this._raycastElevationBox(te,ie);if(se)F=se.minLngLat,U=se.maxLngLat,q=se.minAltitude,Y=se.maxAltitude;else{if(this.transform.isHorizonVisibleForPoints(te,ie))return this;F=this.transform.pointLocation(te),U=this.transform.pointLocation(ie)}return this._fitInternal(0===this.transform.pitch?this._cameraForBoxAndBearing(this.transform.pointLocation(x.pointGeometry.convert(c)),this.transform.pointLocation(x.pointGeometry.convert(y)),S,P):this._cameraForBox(F,U,q,Y,P),P,O)}_fitInternal(c,y,S){return c?(delete(y=x.extend(c,y)).padding,y.linear?this.easeTo(y,S):this.flyTo(y,S)):this}jumpTo(c,y){this.stop();const S=this.transform;let P=!1,O=!1,F=!1;return"zoom"in c&&S.zoom!==+c.zoom&&(P=!0,S.zoom=+c.zoom),void 0!==c.center&&(S.center=x.LngLat.convert(c.center)),"bearing"in c&&S.bearing!==+c.bearing&&(O=!0,S.bearing=+c.bearing),"pitch"in c&&S.pitch!==+c.pitch&&(F=!0,S.pitch=+c.pitch),null==c.padding||S.isPaddingEqual(c.padding)||(S.padding=c.padding),this.fire(new x.Event("movestart",y)).fire(new x.Event("move",y)),P&&this.fire(new x.Event("zoomstart",y)).fire(new x.Event("zoom",y)).fire(new x.Event("zoomend",y)),O&&this.fire(new x.Event("rotatestart",y)).fire(new x.Event("rotate",y)).fire(new x.Event("rotateend",y)),F&&this.fire(new x.Event("pitchstart",y)).fire(new x.Event("pitch",y)).fire(new x.Event("pitchend",y)),this.fire(new x.Event("moveend",y))}getFreeCameraOptions(){return this.transform.getFreeCameraOptions()}setFreeCameraOptions(c,y){this.stop();const S=this.transform,P=S.zoom,O=S.pitch,F=S.bearing;S.setFreeCameraOptions(c);const U=P!==S.zoom,q=O!==S.pitch,Y=F!==S.bearing;return this.fire(new x.Event("movestart",y)).fire(new x.Event("move",y)),U&&this.fire(new x.Event("zoomstart",y)).fire(new x.Event("zoom",y)).fire(new x.Event("zoomend",y)),Y&&this.fire(new x.Event("rotatestart",y)).fire(new x.Event("rotate",y)).fire(new x.Event("rotateend",y)),q&&this.fire(new x.Event("pitchstart",y)).fire(new x.Event("pitch",y)).fire(new x.Event("pitchend",y)),this.fire(new x.Event("moveend",y)),this}easeTo(c,y){this._stop(!1,c.easeId),(!1===(c=x.extend({offset:[0,0],duration:500,easing:x.ease},c)).animate||!c.essential&&x.exported.prefersReducedMotion)&&(c.duration=0);const S=this.transform,P=this.getZoom(),O=this.getBearing(),F=this.getPitch(),U=this.getPadding(),q="zoom"in c?+c.zoom:P,Y="bearing"in c?this._normalizeBearing(c.bearing,O):O,te="pitch"in c?+c.pitch:F,ie="padding"in c?c.padding:S.padding,se=x.pointGeometry.convert(c.offset);let we=S.centerPoint.add(se);const Fe=S.pointLocation(we),Ve=x.LngLat.convert(c.center||Fe);this._normalizeCenter(Ve);const nt=S.project(Fe),Te=S.project(Ve).sub(nt),He=S.zoomScale(q-P);let Je,ot;c.around&&(Je=x.LngLat.convert(c.around),ot=S.locationPoint(Je));const Xe={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||q!==P,this._rotating=this._rotating||O!==Y,this._pitching=this._pitching||te!==F,this._padding=!S.isPaddingEqual(ie),this._easeId=c.easeId,this._prepareEase(y,c.noMoveStart,Xe),this._ease(Ye=>{if(this._zooming&&(S.zoom=x.number(P,q,Ye)),this._rotating&&(S.bearing=x.number(O,Y,Ye)),this._pitching&&(S.pitch=x.number(F,te,Ye)),this._padding&&(S.interpolatePadding(U,ie,Ye),we=S.centerPoint.add(se)),Je)S.setLocationAtPoint(Je,ot);else{const $t=S.zoomScale(S.zoom-P),qt=q>P?Math.min(2,He):Math.max(.5,He),Jt=Math.pow(qt,1-Ye),et=S.unproject(nt.add(Te.mult(Ye*Jt)).mult($t));S.setLocationAtPoint(S.renderWorldCopies?et.wrap():et,we)}this._fireMoveEvents(y)},Ye=>{S.recenterOnTerrain(),this._afterEase(y,Ye)},c),this}_prepareEase(c,y,S={}){this._moving=!0,this.transform.cameraElevationReference="sea",y||S.moving||this.fire(new x.Event("movestart",c)),this._zooming&&!S.zooming&&this.fire(new x.Event("zoomstart",c)),this._rotating&&!S.rotating&&this.fire(new x.Event("rotatestart",c)),this._pitching&&!S.pitching&&this.fire(new x.Event("pitchstart",c))}_fireMoveEvents(c){this.fire(new x.Event("move",c)),this._zooming&&this.fire(new x.Event("zoom",c)),this._rotating&&this.fire(new x.Event("rotate",c)),this._pitching&&this.fire(new x.Event("pitch",c))}_afterEase(c,y){if(this._easeId&&y&&this._easeId===y)return;delete this._easeId,this.transform.cameraElevationReference="ground";const S=this._zooming,P=this._rotating,O=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,S&&this.fire(new x.Event("zoomend",c)),P&&this.fire(new x.Event("rotateend",c)),O&&this.fire(new x.Event("pitchend",c)),this.fire(new x.Event("moveend",c))}flyTo(c,y){if(!c.essential&&x.exported.prefersReducedMotion){const wn=x.pick(c,["center","zoom","bearing","pitch","around"]);return this.jumpTo(wn,y)}this.stop(),c=x.extend({offset:[0,0],speed:1.2,curve:1.42,easing:x.ease},c);const S=this.transform,P=this.getZoom(),O=this.getBearing(),F=this.getPitch(),U=this.getPadding(),q="zoom"in c?x.clamp(+c.zoom,S.minZoom,S.maxZoom):P,Y="bearing"in c?this._normalizeBearing(c.bearing,O):O,te="pitch"in c?+c.pitch:F,ie="padding"in c?c.padding:S.padding,se=S.zoomScale(q-P),we=x.pointGeometry.convert(c.offset);let Fe=S.centerPoint.add(we);const Ve=S.pointLocation(Fe),nt=x.LngLat.convert(c.center||Ve);this._normalizeCenter(nt);const Te=S.project(Ve),He=S.project(nt).sub(Te);let Je=c.curve;const ot=Math.max(S.width,S.height),Xe=ot/se,Ye=He.mag();if("minZoom"in c){const wn=x.clamp(Math.min(c.minZoom,P,q),S.minZoom,S.maxZoom),Ir=ot/S.zoomScale(wn-P);Je=Math.sqrt(Ir/Ye*2)}const $t=Je*Je;function qt(wn){const Ir=(Xe*Xe-ot*ot+(wn?-1:1)*$t*$t*Ye*Ye)/(2*(wn?Xe:ot)*$t*Ye);return Math.log(Math.sqrt(Ir*Ir+1)-Ir)}function Jt(wn){return(Math.exp(wn)-Math.exp(-wn))/2}function et(wn){return(Math.exp(wn)+Math.exp(-wn))/2}const xn=qt(0);let un=function(wn){return et(xn)/et(xn+Je*wn)},Kn=function(wn){return ot*((et(xn)*(Jt(Ir=xn+Je*wn)/et(Ir))-Jt(xn))/$t)/Ye;var Ir},En=(qt(1)-xn)/Je;if(Math.abs(Ye)<1e-6||!isFinite(En)){if(Math.abs(ot-Xe)<1e-6)return this.easeTo(c,y);const wn=Xe<ot?-1:1;En=Math.abs(Math.log(Xe/ot))/Je,Kn=function(){return 0},un=function(Ir){return Math.exp(wn*Je*Ir)}}return c.duration="duration"in c?+c.duration:1e3*En/("screenSpeed"in c?+c.screenSpeed/Je:+c.speed),c.maxDuration&&c.duration>c.maxDuration&&(c.duration=0),this._zooming=!0,this._rotating=O!==Y,this._pitching=te!==F,this._padding=!S.isPaddingEqual(ie),this._prepareEase(y,!1),this._ease(wn=>{const Ir=wn*En,pr=1/un(Ir);S.zoom=1===wn?q:P+S.scaleZoom(pr),this._rotating&&(S.bearing=x.number(O,Y,wn)),this._pitching&&(S.pitch=x.number(F,te,wn)),this._padding&&(S.interpolatePadding(U,ie,wn),Fe=S.centerPoint.add(we));const gi=1===wn?nt:S.unproject(Te.add(He.mult(Kn(Ir))).mult(pr));S.setLocationAtPoint(S.renderWorldCopies?gi.wrap():gi,Fe),S._updateCenterElevation(),this._fireMoveEvents(y)},()=>this._afterEase(y),c),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(c,y){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const S=this._onEaseEnd;delete this._onEaseEnd,S.call(this,y)}if(!c){const S=this.handlers;S&&S.stop(!1)}return this}_ease(c,y,S){!1===S.animate||0===S.duration?(c(1),y()):(this._easeStart=x.exported.now(),this._easeOptions=S,this._onEaseFrame=c,this._onEaseEnd=y,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const c=Math.min((x.exported.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(c)),c<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(c,y){c=x.wrap(c,-180,180);const S=Math.abs(c-y);return Math.abs(c-360-y)<S&&(c-=360),Math.abs(c+360-y)<S&&(c+=360),c}_normalizeCenter(c){const y=this.transform;if(!y.renderWorldCopies||y.lngRange)return;const S=c.lng-y.center.lng;c.lng+=S>180?-360:S<-180?360:0}}class la{constructor(c={}){this.options=c,x.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(c){const y=this.options&&this.options.compact;return this._map=c,this._container=Qe.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=Qe.create("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=Qe.create("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),y&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===y&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){Qe.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(c,y){const S=this._map._getUIString(`AttributionControl.${y}`);c.title=S,c.setAttribute("aria-label",S)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","true"))}_updateEditLink(){let c=this._editLink;c||(c=this._editLink=this._container.querySelector(".mapbox-improve-map"));const y=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||x.config.ACCESS_TOKEN}];if(c){const S=y.reduce((P,O,F)=>(O.value&&(P+=`${O.key}=${O.value}${F<y.length-1?"&":""}`),P),"?");c.href=`${x.config.FEEDBACK_URL}/${S}${this._map._hash?this._map._hash.getHashString(!0):""}`,c.rel="noopener nofollow",this._setElementTitle(c,"MapFeedback")}}_updateData(c){!c||"metadata"!==c.sourceDataType&&"visibility"!==c.sourceDataType&&"style"!==c.dataType||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let c=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?c=c.concat(this.options.customAttribution.map(P=>"string"!=typeof P?"":P)):"string"==typeof this.options.customAttribution&&c.push(this.options.customAttribution)),this._map.style.stylesheet){const P=this._map.style.stylesheet;this.styleOwner=P.owner,this.styleId=P.id}const y=this._map.style._sourceCaches;for(const P in y){const O=y[P];if(O.used){const F=O.getSource();F.attribution&&c.indexOf(F.attribution)<0&&c.push(F.attribution)}}c.sort((P,O)=>P.length-O.length),c=c.filter((P,O)=>{for(let F=O+1;F<c.length;F++)if(c[F].indexOf(P)>=0)return!1;return!0});const S=c.join(" | ");S!==this._attribHTML&&(this._attribHTML=S,c.length?(this._innerContainer.innerHTML=S,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class wr{constructor(){x.bindAll(["_updateLogo"],this),x.bindAll(["_updateCompact"],this)}onAdd(c){this._map=c,this._container=Qe.create("div","mapboxgl-ctrl");const y=Qe.create("a","mapboxgl-ctrl-logo");return y.target="_blank",y.rel="noopener nofollow",y.href="https://www.mapbox.com/",y.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),y.setAttribute("rel","noopener nofollow"),this._container.appendChild(y),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){Qe.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(c){c&&"metadata"!==c.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const c=this._map.style._sourceCaches;if(0===Object.entries(c).length)return!0;for(const y in c){const S=c[y].getSource();if(S.hasOwnProperty("mapbox_logo")&&!S.mapbox_logo)return!1}return!0}_updateCompact(){const c=this._container.children;if(c.length){const y=c[0];this._map.getCanvasContainer().offsetWidth<250?y.classList.add("mapboxgl-compact"):y.classList.remove("mapboxgl-compact")}}}class Al{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(c){const y=++this._id;return this._queue.push({callback:c,id:y,cancelled:!1}),y}remove(c){const y=this._currentlyRunning,S=y?this._queue.concat(y):this._queue;for(const P of S)if(P.id===c)return void(P.cancelled=!0)}run(c=0){const y=this._currentlyRunning=this._queue;this._queue=[];for(const S of y)if(!S.cancelled&&(S.callback(c),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function Sr(C,c,y){if(C=new x.LngLat(C.lng,C.lat),c){const S=new x.LngLat(C.lng-360,C.lat),P=new x.LngLat(C.lng+360,C.lat),O=360*Math.ceil(Math.abs(C.lng-y.center.lng)/360),F=y.locationPoint(C).distSqr(c),U=c.x<0||c.y<0||c.x>y.width||c.y>y.height;y.locationPoint(S).distSqr(c)<F&&(U||Math.abs(S.lng-y.center.lng)<O)?C=S:y.locationPoint(P).distSqr(c)<F&&(U||Math.abs(P.lng-y.center.lng)<O)&&(C=P)}for(;Math.abs(C.lng-y.center.lng)>180;){const S=y.locationPoint(C);if(S.x>=0&&S.y>=0&&S.x<=y.width&&S.y<=y.height)break;C.lng>y.center.lng?C.lng-=360:C.lng+=360}return C}const Mu={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Aa(C,c,y){const S=C.classList;for(const P in Mu)S.remove(`mapboxgl-${y}-anchor-${P}`);S.add(`mapboxgl-${y}-anchor-${c}`)}class zh extends x.Evented{constructor(c,y){if(super(),(c instanceof x.window.HTMLElement||y)&&(c=x.extend({element:c},y)),x.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=c&&c.anchor||"center",this._color=c&&c.color||"#3FB1CE",this._scale=c&&c.scale||1,this._draggable=c&&c.draggable||!1,this._clickTolerance=c&&c.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=c&&c.rotation||0,this._rotationAlignment=c&&c.rotationAlignment||"auto",this._pitchAlignment=c&&c.pitchAlignment&&"auto"!==c.pitchAlignment?c.pitchAlignment:this._rotationAlignment,c&&c.element)this._element=c.element,this._offset=x.pointGeometry.convert(c&&c.offset||[0,0]);else{this._defaultMarker=!0,this._element=Qe.create("div"),this._element.setAttribute("aria-label","Map marker");const S=Qe.createNS("http://www.w3.org/2000/svg","svg"),P=41,O=27;S.setAttributeNS(null,"display","block"),S.setAttributeNS(null,"height",`${P}px`),S.setAttributeNS(null,"width",`${O}px`),S.setAttributeNS(null,"viewBox",`0 0 ${O} ${P}`);const F=Qe.createNS("http://www.w3.org/2000/svg","g");F.setAttributeNS(null,"stroke","none"),F.setAttributeNS(null,"stroke-width","1"),F.setAttributeNS(null,"fill","none"),F.setAttributeNS(null,"fill-rule","evenodd");const U=Qe.createNS("http://www.w3.org/2000/svg","g");U.setAttributeNS(null,"fill-rule","nonzero");const q=Qe.createNS("http://www.w3.org/2000/svg","g");q.setAttributeNS(null,"transform","translate(3.0, 29.0)"),q.setAttributeNS(null,"fill","#000000");const Y=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const He of Y){const Je=Qe.createNS("http://www.w3.org/2000/svg","ellipse");Je.setAttributeNS(null,"opacity","0.04"),Je.setAttributeNS(null,"cx","10.5"),Je.setAttributeNS(null,"cy","5.80029008"),Je.setAttributeNS(null,"rx",He.rx),Je.setAttributeNS(null,"ry",He.ry),q.appendChild(Je)}const te=Qe.createNS("http://www.w3.org/2000/svg","g");te.setAttributeNS(null,"fill",this._color);const ie=Qe.createNS("http://www.w3.org/2000/svg","path");ie.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),te.appendChild(ie);const se=Qe.createNS("http://www.w3.org/2000/svg","g");se.setAttributeNS(null,"opacity","0.25"),se.setAttributeNS(null,"fill","#000000");const we=Qe.createNS("http://www.w3.org/2000/svg","path");we.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),se.appendChild(we);const Fe=Qe.createNS("http://www.w3.org/2000/svg","g");Fe.setAttributeNS(null,"transform","translate(6.0, 7.0)"),Fe.setAttributeNS(null,"fill","#FFFFFF");const Ve=Qe.createNS("http://www.w3.org/2000/svg","g");Ve.setAttributeNS(null,"transform","translate(8.0, 8.0)");const nt=Qe.createNS("http://www.w3.org/2000/svg","circle");nt.setAttributeNS(null,"fill","#000000"),nt.setAttributeNS(null,"opacity","0.25"),nt.setAttributeNS(null,"cx","5.5"),nt.setAttributeNS(null,"cy","5.5"),nt.setAttributeNS(null,"r","5.4999962");const Te=Qe.createNS("http://www.w3.org/2000/svg","circle");Te.setAttributeNS(null,"fill","#FFFFFF"),Te.setAttributeNS(null,"cx","5.5"),Te.setAttributeNS(null,"cy","5.5"),Te.setAttributeNS(null,"r","5.4999962"),Ve.appendChild(nt),Ve.appendChild(Te),U.appendChild(q),U.appendChild(te),U.appendChild(se),U.appendChild(Fe),U.appendChild(Ve),S.appendChild(U),S.setAttributeNS(null,"height",P*this._scale+"px"),S.setAttributeNS(null,"width",O*this._scale+"px"),this._element.appendChild(S),this._offset=x.pointGeometry.convert(c&&c.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",S=>{S.preventDefault()}),this._element.addEventListener("mousedown",S=>{S.preventDefault()}),Aa(this._element,this._anchor,"marker"),this._popup=null}addTo(c){return this.remove(),this._map=c,c.getCanvasContainer().appendChild(this._element),c.on("move",this._update),c.on("moveend",this._update),c.on("remove",this._clearFadeTimer),c._addMarker(this),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._map.off("remove",this._clearFadeTimer),this._map._removeMarker(this),delete this._map),this._clearFadeTimer(),Qe.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(c){return this._lngLat=x.LngLat.convert(c),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(c){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),c){if(!("offset"in c.options)){const y=38.1,S=13.5,P=Math.sqrt(Math.pow(S,2)/2);c.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-y],"bottom-left":[P,-1*(y-S+P)],"bottom-right":[-P,-1*(y-S+P)],left:[S,-1*(y-S)],right:[-S,-1*(y-S)]}:this._offset}this._popup=c,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}_onKeyPress(c){const y=c.code,S=c.charCode||c.keyCode;"Space"!==y&&"Enter"!==y&&32!==S&&13!==S||this.togglePopup()}_onMapClick(c){const y=c.originalEvent.target,S=this._element;this._popup&&(y===S||S.contains(y))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const c=this._popup;return c?(c.isOpen()?c.remove():c.addTo(this._map),this):this}_evaluateOpacity(){const c=this._pos?this._pos.sub(this._transformedOffset()):null;if(!this._withinScreenBounds(c))return void this._clearFadeTimer();const y=this._map.unproject(c);let S=!1;if(this._map.getTerrain()){const O=this._map.getFreeCameraOptions();if(O.position){const F=O.position.toLngLat();S=F.distanceTo(y)<.9*F.distanceTo(this._lngLat)}}const P=(1-this._map._queryFogOpacity(y))*(S?.2:1);this._element.style.opacity=`${P}`,this._popup&&this._popup._setOpacity(`${P}`),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_withinScreenBounds(c){const y=this._map.transform;return!!c&&c.x>=0&&c.x<y.width&&c.y>=0&&c.y<y.height}_update(c){if(!this._map)return;this._map.transform.renderWorldCopies&&(this._lngLat=Sr(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._transformedOffset());let y="";"viewport"===this._rotationAlignment||"auto"===this._rotationAlignment?y=`rotateZ(${this._rotation}deg)`:"map"===this._rotationAlignment&&(y=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let S="";"viewport"===this._pitchAlignment||"auto"===this._pitchAlignment?S="rotateX(0deg)":"map"===this._pitchAlignment&&(S=`rotateX(${this._map.getPitch()}deg)`),c&&"moveend"!==c.type||(this._pos=this._pos.round()),this._map._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&Qe.setTransform(this._element,`${Mu[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${S} ${y}`),!this._map.getTerrain()&&!this._map.getFog()||this._fadeTimer||(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))})}_transformedOffset(){if(!this._defaultMarker)return this._offset;const c=this._map.transform,y=this._offset.mult(this._scale);return"map"===this._rotationAlignment&&y._rotate(c.angle),"map"===this._pitchAlignment&&(y.y*=Math.cos(c._pitch)),y}getOffset(){return this._offset}setOffset(c){return this._offset=x.pointGeometry.convert(c),this._update(),this}_onMove(c){if(!this._isDragging){const y=this._clickTolerance||this._map._clickTolerance;this._isDragging=c.point.dist(this._pointerdownPos)>=y}this._isDragging&&(this._pos=c.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new x.Event("dragstart"))),this.fire(new x.Event("drag")))}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new x.Event("dragend")),this._state="inactive"}_addDragHandler(c){this._element.contains(c.originalEvent.target)&&(c.preventDefault(),this._positionDelta=c.point.sub(this._pos).add(this._transformedOffset()),this._pointerdownPos=c.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))}setDraggable(c){return this._draggable=!!c,this._map&&(c?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(c){return this._rotation=c||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(c){return this._rotationAlignment=c||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(c){return this._pitchAlignment=c&&"auto"!==c?c:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}class ja{constructor(c){this.jumpTo(c)}getValue(c){if(c<=this._startTime)return this._start;if(c>=this._endTime)return this._end;const y=x.easeCubicInOut((c-this._startTime)/(this._endTime-this._startTime));return this._start*(1-y)+this._end*y}isEasing(c){return c>=this._startTime&&c<=this._endTime}jumpTo(c){this._startTime=-1/0,this._endTime=-1/0,this._start=c,this._end=c}easeTo(c,y,S){this._start=this.getValue(y),this._end=c,this._startTime=y,this._endTime=y+S}}const Bo={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},{HTMLImageElement:nh,HTMLElement:rh,ImageBitmap:l}=x.window,d={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0};function _(C){C.parentNode&&C.parentNode.removeChild(C)}const b={showCompass:!0,showZoom:!0,visualizePitch:!1};class I{constructor(c,y,S=!1){this._clickTolerance=10,this.element=y,this.mouseRotate=new Kl({clickTolerance:c.dragRotate._mouseRotate._clickTolerance}),this.map=c,S&&(this.mousePitch=new Fh({clickTolerance:c.dragRotate._mousePitch._clickTolerance})),x.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),Qe.addEventListener(y,"mousedown",this.mousedown),Qe.addEventListener(y,"touchstart",this.touchstart,{passive:!1}),Qe.addEventListener(y,"touchmove",this.touchmove),Qe.addEventListener(y,"touchend",this.touchend),Qe.addEventListener(y,"touchcancel",this.reset)}down(c,y){this.mouseRotate.mousedown(c,y),this.mousePitch&&this.mousePitch.mousedown(c,y),Qe.disableDrag()}move(c,y){const S=this.map,P=this.mouseRotate.mousemoveWindow(c,y);if(P&&P.bearingDelta&&S.setBearing(S.getBearing()+P.bearingDelta),this.mousePitch){const O=this.mousePitch.mousemoveWindow(c,y);O&&O.pitchDelta&&S.setPitch(S.getPitch()+O.pitchDelta)}}off(){const c=this.element;Qe.removeEventListener(c,"mousedown",this.mousedown),Qe.removeEventListener(c,"touchstart",this.touchstart,{passive:!1}),Qe.removeEventListener(c,"touchmove",this.touchmove),Qe.removeEventListener(c,"touchend",this.touchend),Qe.removeEventListener(c,"touchcancel",this.reset),this.offTemp()}offTemp(){Qe.enableDrag(),Qe.removeEventListener(x.window,"mousemove",this.mousemove),Qe.removeEventListener(x.window,"mouseup",this.mouseup)}mousedown(c){this.down(x.extend({},c,{ctrlKey:!0,preventDefault:()=>c.preventDefault()}),Qe.mousePos(this.element,c)),Qe.addEventListener(x.window,"mousemove",this.mousemove),Qe.addEventListener(x.window,"mouseup",this.mouseup)}mousemove(c){this.move(c,Qe.mousePos(this.element,c))}mouseup(c){this.mouseRotate.mouseupWindow(c),this.mousePitch&&this.mousePitch.mouseupWindow(c),this.offTemp()}touchstart(c){1!==c.targetTouches.length?this.reset():(this._startPos=this._lastPos=Qe.touchPos(this.element,c.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>c.preventDefault()},this._startPos))}touchmove(c){1!==c.targetTouches.length?this.reset():(this._lastPos=Qe.touchPos(this.element,c.targetTouches)[0],this.move({preventDefault:()=>c.preventDefault()},this._lastPos))}touchend(c){0===c.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const N={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1};let j,ne=0,Ee=!1;const it={maxWidth:100,unit:"metric"};function Bt(C,c,y){const S=y&&y.maxWidth||100,P=C._container.clientHeight/2,O=C.unproject([0,P]),F=C.unproject([S,P]),U=O.distanceTo(F);if(y&&"imperial"===y.unit){const q=3.2808*U;q>5280?zt(c,S,q/5280,C._getUIString("ScaleControl.Miles"),C):zt(c,S,q,C._getUIString("ScaleControl.Feet"),C)}else y&&"nautical"===y.unit?zt(c,S,U/1852,C._getUIString("ScaleControl.NauticalMiles"),C):U>=1e3?zt(c,S,U/1e3,C._getUIString("ScaleControl.Kilometers"),C):zt(c,S,U,C._getUIString("ScaleControl.Meters"),C)}function zt(C,c,y,S,P){const O=function(U){const q=Math.pow(10,`${Math.floor(U)}`.length-1);let Y=U/q;return Y=Y>=10?10:Y>=5?5:Y>=3?3:Y>=2?2:Y>=1?1:function(te){const ie=Math.pow(10,Math.ceil(-Math.log(te)/Math.LN10));return Math.round(te*ie)/ie}(Y),q*Y}(y),F=O/y;P._requestDomTask(()=>{C.style.width=c*F+"px",C.innerHTML=`${O}&nbsp;${S}`})}const vn={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},pn=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Pn(C){if(C){if("number"==typeof C){const c=Math.round(Math.sqrt(.5*Math.pow(C,2)));return{center:new x.pointGeometry(0,0),top:new x.pointGeometry(0,C),"top-left":new x.pointGeometry(c,c),"top-right":new x.pointGeometry(-c,c),bottom:new x.pointGeometry(0,-C),"bottom-left":new x.pointGeometry(c,-c),"bottom-right":new x.pointGeometry(-c,-c),left:new x.pointGeometry(C,0),right:new x.pointGeometry(-C,0)}}if(C instanceof x.pointGeometry||Array.isArray(C)){const c=x.pointGeometry.convert(C);return{center:c,top:c,"top-left":c,"top-right":c,bottom:c,"bottom-left":c,"bottom-right":c,left:c,right:c}}return{center:x.pointGeometry.convert(C.center||[0,0]),top:x.pointGeometry.convert(C.top||[0,0]),"top-left":x.pointGeometry.convert(C["top-left"]||[0,0]),"top-right":x.pointGeometry.convert(C["top-right"]||[0,0]),bottom:x.pointGeometry.convert(C.bottom||[0,0]),"bottom-left":x.pointGeometry.convert(C["bottom-left"]||[0,0]),"bottom-right":x.pointGeometry.convert(C["bottom-right"]||[0,0]),left:x.pointGeometry.convert(C.left||[0,0]),right:x.pointGeometry.convert(C.right||[0,0])}}return Pn(new x.pointGeometry(0,0))}const rr={version:x.version,supported:ut,setRTLTextPlugin:x.setRTLTextPlugin,getRTLTextPluginStatus:x.getRTLTextPluginStatus,Map:class extends _c{constructor(C){if(null!=(C=x.extend({},d,C)).minZoom&&null!=C.maxZoom&&C.minZoom>C.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=C.minPitch&&null!=C.maxPitch&&C.minPitch>C.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=C.minPitch&&C.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=C.maxPitch&&C.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new Xd(C.minZoom,C.maxZoom,C.minPitch,C.maxPitch,C.renderWorldCopies),C),this._interactive=C.interactive,this._maxTileCacheSize=C.maxTileCacheSize,this._failIfMajorPerformanceCaveat=C.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=C.preserveDrawingBuffer,this._antialias=C.antialias,this._trackResize=C.trackResize,this._bearingSnap=C.bearingSnap,this._refreshExpiredTiles=C.refreshExpiredTiles,this._fadeDuration=C.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=C.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=C.collectResourceTiming,this._optimizeForTerrain=C.optimizeForTerrain,this._renderTaskQueue=new Al,this._domRenderTaskQueue=new Al,this._controls=[],this._markers=[],this._mapId=x.uniqueId(),this._locale=x.extend({},Bo,C.locale),this._clickTolerance=C.clickTolerance,this._averageElevationLastSampledAt=-1/0,this._averageElevation=new ja(0),this._requestManager=new x.RequestManager(C.transformRequest,C.accessToken,C.testMode),this._silenceAuthErrors=!!C.testMode,"string"==typeof C.container){if(this._container=x.window.document.getElementById(C.container),!this._container)throw new Error(`Container '${C.container}' not found.`)}else{if(!(C.container instanceof rh))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=C.container}if(C.maxBounds&&this.setMaxBounds(C.maxBounds),x.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),void 0!==x.window&&(x.window.addEventListener("online",this._onWindowOnline,!1),x.window.addEventListener("resize",this._onWindowResize,!1),x.window.addEventListener("orientationchange",this._onWindowResize,!1),x.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1)),this.handlers=new Su(this,C),this._hash=C.hash&&new eh("string"==typeof C.hash&&C.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:C.center,zoom:C.zoom,bearing:C.bearing,pitch:C.pitch}),C.bounds&&(this.resize(),this.fitBounds(C.bounds,x.extend({},C.fitBoundsOptions,{duration:0})))),this.resize(),this._localFontFamily=C.localFontFamily,this._localIdeographFontFamily=C.localIdeographFontFamily,C.style&&this.setStyle(C.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),C.attributionControl&&this.addControl(new la({customAttribution:C.customAttribution})),this._logoControl=new wr,this.addControl(this._logoControl,C.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",c=>{this._update("style"===c.dataType),this.fire(new x.Event(`${c.dataType}data`,c))}),this.on("dataloading",c=>{this.fire(new x.Event(`${c.dataType}dataloading`,c))})}_getMapId(){return this._mapId}addControl(C,c){if(void 0===c&&(c=C.getDefaultPosition?C.getDefaultPosition():"top-right"),!C||!C.onAdd)return this.fire(new x.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const y=C.onAdd(this);this._controls.push(C);const S=this._controlPositions[c];return-1!==c.indexOf("bottom")?S.insertBefore(y,S.firstChild):S.appendChild(y),this}removeControl(C){if(!C||!C.onRemove)return this.fire(new x.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const c=this._controls.indexOf(C);return c>-1&&this._controls.splice(c,1),C.onRemove(this),this}hasControl(C){return this._controls.indexOf(C)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(C){const c=this._containerDimensions(),y=c[0],S=c[1];this._resizeCanvas(y,S),this.transform.resize(y,S),this.painter.resize(y,S);const P=!this._moving;return P&&(this.stop(),this.fire(new x.Event("movestart",C)).fire(new x.Event("move",C))),this.fire(new x.Event("resize",C)),P&&this.fire(new x.Event("moveend",C)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(C){return this.transform.setMaxBounds(x.LngLatBounds.convert(C)),this._update()}setMinZoom(C){if((C=null==C?-2:C)>=-2&&C<=this.transform.maxZoom)return this.transform.minZoom=C,this._update(),this.getZoom()<C&&this.setZoom(C),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(C){if((C=null==C?22:C)>=this.transform.minZoom)return this.transform.maxZoom=C,this._update(),this.getZoom()>C&&this.setZoom(C),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(C){if((C=null==C?0:C)<0)throw new Error("minPitch must be greater than or equal to 0");if(C>=0&&C<=this.transform.maxPitch)return this.transform.minPitch=C,this._update(),this.getPitch()<C&&this.setPitch(C),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(C){if((C=null==C?85:C)>85)throw new Error("maxPitch must be less than or equal to 85");if(C>=this.transform.minPitch)return this.transform.maxPitch=C,this._update(),this.getPitch()>C&&this.setPitch(C),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(C){return this.transform.renderWorldCopies=C,this._update()}project(C){return this.transform.locationPoint3D(x.LngLat.convert(C))}unproject(C){return this.transform.pointLocation3D(x.pointGeometry.convert(C))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()}_createDelegatedListener(C,c,y){if("mouseenter"===C||"mouseover"===C){let S=!1;return{layer:c,listener:y,delegates:{mousemove:O=>{const F=this.getLayer(c)?this.queryRenderedFeatures(O.point,{layers:[c]}):[];F.length?S||(S=!0,y.call(this,new hl(C,this,O.originalEvent,{features:F}))):S=!1},mouseout:()=>{S=!1}}}}if("mouseleave"===C||"mouseout"===C){let S=!1;return{layer:c,listener:y,delegates:{mousemove:F=>{(this.getLayer(c)?this.queryRenderedFeatures(F.point,{layers:[c]}):[]).length?S=!0:S&&(S=!1,y.call(this,new hl(C,this,F.originalEvent)))},mouseout:F=>{S&&(S=!1,y.call(this,new hl(C,this,F.originalEvent)))}}}}{const S=P=>{const O=this.getLayer(c)?this.queryRenderedFeatures(P.point,{layers:[c]}):[];O.length&&(P.features=O,y.call(this,P),delete P.features)};return{layer:c,listener:y,delegates:{[C]:S}}}}on(C,c,y){if(void 0===y)return super.on(C,c);const S=this._createDelegatedListener(C,c,y);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[C]=this._delegatedListeners[C]||[],this._delegatedListeners[C].push(S);for(const P in S.delegates)this.on(P,S.delegates[P]);return this}once(C,c,y){if(void 0===y)return super.once(C,c);const S=this._createDelegatedListener(C,c,y);for(const P in S.delegates)this.once(P,S.delegates[P]);return this}off(C,c,y){return void 0===y?super.off(C,c):(this._delegatedListeners&&this._delegatedListeners[C]&&(S=>{const P=this._delegatedListeners[C];for(let O=0;O<P.length;O++){const F=P[O];if(F.layer===c&&F.listener===y){for(const U in F.delegates)this.off(U,F.delegates[U]);return P.splice(O,1),this}}})(),this)}queryRenderedFeatures(C,c){return this.style?(void 0!==c||void 0===C||C instanceof x.pointGeometry||Array.isArray(C)||(c=C,C=void 0),this.style.queryRenderedFeatures(C=C||[[0,0],[this.transform.width,this.transform.height]],c=c||{},this.transform)):[]}querySourceFeatures(C,c){return this.style.querySourceFeatures(C,c)}queryTerrainElevation(C,c){const y=this.transform.elevation;return y?(c=x.extend({},{exaggerated:!0},c),y.getAtPoint(x.MercatorCoordinate.fromLngLat(C),null,c.exaggerated)):null}setStyle(C,c){return!1!==(c=x.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},c)).diff&&c.localIdeographFontFamily===this._localIdeographFontFamily&&c.localFontFamily===this._localFontFamily&&this.style&&C?(this._diffStyle(C,c),this):(this._localIdeographFontFamily=c.localIdeographFontFamily,this._localFontFamily=c.localFontFamily,this._updateStyle(C,c))}_getUIString(C){const c=this._locale[C];if(null==c)throw new Error(`Missing UI string '${C}'`);return c}_updateStyle(C,c){return this.style&&(this.style.setEventedParent(null),this.style._remove(),delete this.style),C&&(this.style=new zs(this,c||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof C?this.style.loadURL(C):this.style.loadJSON(C)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new zs(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(C,c){if("string"==typeof C){const y=this._requestManager.normalizeStyleURL(C),S=this._requestManager.transformRequest(y,x.ResourceType.Style);x.getJSON(S,(P,O)=>{P?this.fire(new x.ErrorEvent(P)):O&&this._updateDiff(O,c)})}else"object"==typeof C&&this._updateDiff(C,c)}_updateDiff(C,c){try{this.style.setState(C)&&this._update(!0)}catch(y){x.warnOnce(`Unable to perform style diff: ${y.message||y.error||y}.  Rebuilding the style from scratch.`),this._updateStyle(C,c)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():x.warnOnce("There is no style added to the map.")}addSource(C,c){return this._lazyInitEmptyStyle(),this.style.addSource(C,c),this._update(!0)}isSourceLoaded(C){const c=this.style&&this.style._getSourceCaches(C);if(0!==c.length)return c.every(y=>y.loaded());this.fire(new x.ErrorEvent(new Error(`There is no source with ID '${C}'`)))}areTilesLoaded(){const C=this.style&&this.style._sourceCaches;for(const c in C){const y=C[c]._tiles;for(const S in y){const P=y[S];if("loaded"!==P.state&&"errored"!==P.state)return!1}}return!0}addSourceType(C,c,y){return this._lazyInitEmptyStyle(),this.style.addSourceType(C,c,y)}removeSource(C){return this.style.removeSource(C),this._updateTerrain(),this._update(!0)}getSource(C){return this.style.getSource(C)}addImage(C,c,{pixelRatio:y=1,sdf:S=!1,stretchX:P,stretchY:O,content:F}={}){if(this._lazyInitEmptyStyle(),c instanceof nh||l&&c instanceof l){const{width:U,height:q,data:Y}=x.exported.getImageData(c);this.style.addImage(C,{data:new x.RGBAImage({width:U,height:q},Y),pixelRatio:y,stretchX:P,stretchY:O,content:F,sdf:S,version:0})}else{if(void 0===c.width||void 0===c.height)return this.fire(new x.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:U,height:q,data:Y}=c,te=c;this.style.addImage(C,{data:new x.RGBAImage({width:U,height:q},new Uint8Array(Y)),pixelRatio:y,stretchX:P,stretchY:O,content:F,sdf:S,version:0,userImage:te}),te.onAdd&&te.onAdd(this,C)}}}updateImage(C,c){const y=this.style.getImage(C);if(!y)return this.fire(new x.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const S=c instanceof nh||l&&c instanceof l?x.exported.getImageData(c):c,{width:P,height:O,data:F}=S;return void 0===P||void 0===O?this.fire(new x.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):P!==y.data.width||O!==y.data.height?this.fire(new x.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(y.data.replace(F,!(c instanceof nh||l&&c instanceof l)),void this.style.updateImage(C,y))}hasImage(C){return C?!!this.style.getImage(C):(this.fire(new x.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(C){this.style.removeImage(C)}loadImage(C,c){x.getImage(this._requestManager.transformRequest(C,x.ResourceType.Image),(y,S)=>{c(y,S instanceof nh?x.exported.getImageData(S):S)})}listImages(){return this.style.listImages()}addLayer(C,c){return this._lazyInitEmptyStyle(),this.style.addLayer(C,c),this._update(!0)}moveLayer(C,c){return this.style.moveLayer(C,c),this._update(!0)}removeLayer(C){return this.style.removeLayer(C),this._update(!0)}getLayer(C){return this.style.getLayer(C)}setLayerZoomRange(C,c,y){return this.style.setLayerZoomRange(C,c,y),this._update(!0)}setFilter(C,c,y={}){return this.style.setFilter(C,c,y),this._update(!0)}getFilter(C){return this.style.getFilter(C)}setPaintProperty(C,c,y,S={}){return this.style.setPaintProperty(C,c,y,S),this._update(!0)}getPaintProperty(C,c){return this.style.getPaintProperty(C,c)}setLayoutProperty(C,c,y,S={}){return this.style.setLayoutProperty(C,c,y,S),this._update(!0)}getLayoutProperty(C,c){return this.style.getLayoutProperty(C,c)}setLight(C,c={}){return this._lazyInitEmptyStyle(),this.style.setLight(C,c),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(C){return this._lazyInitEmptyStyle(),this.style.setTerrain(C),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(C){return this._lazyInitEmptyStyle(),this.style.setFog(C),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(C){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(x.LngLat.convert(C),this.transform):0}setFeatureState(C,c){return this.style.setFeatureState(C,c),this._update()}removeFeatureState(C,c){return this.style.removeFeatureState(C,c),this._update()}getFeatureState(C){return this.style.getFeatureState(C)}_containerDimensions(){let C=0,c=0;return this._container&&(C=this._container.clientWidth||400,c=this._container.clientHeight||300),[C,c]}_detectMissingCSS(){"rgb(250, 128, 114)"!==x.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&x.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const C=this._container;C.classList.add("mapboxgl-map"),(this._missingCSSCanary=Qe.create("div","mapboxgl-canary",C)).style.visibility="hidden",this._detectMissingCSS();const c=this._canvasContainer=Qe.create("div","mapboxgl-canvas-container",C);this._interactive&&c.classList.add("mapboxgl-interactive"),this._canvas=Qe.create("canvas","mapboxgl-canvas",c),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const y=this._containerDimensions();this._resizeCanvas(y[0],y[1]);const S=this._controlContainer=Qe.create("div","mapboxgl-control-container",C),P=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(O=>{P[O]=Qe.create("div",`mapboxgl-ctrl-${O}`,S)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(C,c){const y=x.exported.devicePixelRatio||1;this._canvas.width=y*C,this._canvas.height=y*c,this._canvas.style.width=`${C}px`,this._canvas.style.height=`${c}px`}_addMarker(C){this._markers.push(C)}_removeMarker(C){const c=this._markers.indexOf(C);-1!==c&&this._markers.splice(c,1)}_setupPainter(){const C=x.extend({},ut.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),c=this._canvas.getContext("webgl",C)||this._canvas.getContext("experimental-webgl",C);c?(x.storeAuthState(c,!0),this.painter=new xo(c,this.transform),this.on("data",y=>{"source"===y.dataType&&this.painter.setTileLoadedFlag(!0)}),x.exported$1.testSupport(c)):this.fire(new x.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(C){C.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new x.Event("webglcontextlost",{originalEvent:C}))}_contextRestored(C){this._setupPainter(),this.resize(),this._update(),this.fire(new x.Event("webglcontextrestored",{originalEvent:C}))}_onMapScroll(C){if(C.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(C){return this.style?(this._styleDirty=this._styleDirty||C,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(C){return this._update(),this._renderTaskQueue.add(C)}_cancelRenderFrame(C){this._renderTaskQueue.remove(C)}_requestDomTask(C){!this.isMoving()&&this.loaded()?C():this._domRenderTaskQueue.add(C)}_render(C){let c;const y=this.painter.context.extTimerQuery,S=x.exported.now();this.listens("gpu-timing-frame")&&(c=y.createQueryEXT(),y.beginQueryEXT(y.TIME_ELAPSED_EXT,c));let P=this._updateAverageElevation(S);if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(C),this._domRenderTaskQueue.run(C),this._removed)return;let O=!1;const F=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const q=this.transform.zoom,Y=x.exported.now();this.style.zoomHistory.update(q,Y);const te=new x.EvaluationParameters(q,{now:Y,fadeDuration:F,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),ie=te.crossFadingFactor();1===ie&&ie===this._crossFadingFactor||(O=!0,this._crossFadingFactor=ie),this.style.update(te)}if(this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0),this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,F,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:F,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),speedIndexTiming:this.speedIndexTiming}),this.fire(new x.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new x.Event("load"))),this.style&&(this.style.hasTransitions()||O)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){const q=x.exported.now()-S;y.endQueryEXT(y.TIME_ELAPSED_EXT,c),setTimeout(()=>{const Y=y.getQueryObjectEXT(c,y.QUERY_RESULT_EXT)/1e6;y.deleteQueryEXT(c),this.fire(new x.Event("gpu-timing-frame",{cpuTime:q,gpuTime:Y}))},50)}if(this.listens("gpu-timing-layer")){const q=this.painter.collectGpuTimers();setTimeout(()=>{const Y=this.painter.queryGpuTimers(q);this.fire(new x.Event("gpu-timing-layer",{layerTimes:Y}))},50)}const U=this._sourcesDirty||this._styleDirty||this._placementDirty||P;if(U||this._repaint)this.triggerRepaint();else{const q=!this.isMoving()&&this.loaded();if(q&&(P=this._updateAverageElevation(S,!0)),P)this.triggerRepaint();else if(this._triggerFrame(!1),q&&(this.fire(new x.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const Y=this._calculateSpeedIndex();this.fire(new x.Event("speedindexcompleted",{speedIndex:Y})),this.speedIndexTiming=!1}}return!this._loaded||this._fullyLoaded||U||(this._fullyLoaded=!0,this._authenticate()),this}_updateAverageElevation(C,c=!1){const y=S=>(this.transform.averageElevation=S,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return 0!==this.transform.averageElevation&&y(0);if((c||C-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(C)){const S=this.transform.averageElevation;let P=this.transform.sampleAverageElevation();isNaN(P)?P=0:this._averageElevationLastSampledAt=C;const O=Math.abs(S-P);if(O>1){if(this._isInitialLoad)return this._averageElevation.jumpTo(P),y(P);this._averageElevation.easeTo(P,C,300)}else if(O>1e-4)return this._averageElevation.jumpTo(P),y(P)}return!!this._averageElevation.isEasing(C)&&y(this._averageElevation.getValue(C))}_authenticate(){x.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,C=>{if(C&&(C.message===x.AUTH_ERR_MSG||401===C.status)){const c=this.painter.context.gl;x.storeAuthState(c,!1),this._logoControl instanceof wr&&this._logoControl._updateLogo(),c&&c.clear(c.DEPTH_BUFFER_BIT|c.COLOR_BUFFER_BIT|c.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new x.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),x.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){this.painter.updateTerrain(this.style,this.isMoving()||this.isRotating()||this.isZooming())}_calculateSpeedIndex(){const C=this.painter.canvasCopy(),c=this.painter.getCanvasCopiesAndTimestamps();c.timeStamps.push(performance.now());const y=this.painter.context.gl,S=y.createFramebuffer();function P(O){y.framebufferTexture2D(y.FRAMEBUFFER,y.COLOR_ATTACHMENT0,y.TEXTURE_2D,O,0);const F=new Uint8Array(y.drawingBufferWidth*y.drawingBufferHeight*4);return y.readPixels(0,0,y.drawingBufferWidth,y.drawingBufferHeight,y.RGBA,y.UNSIGNED_BYTE,F),F}return y.bindFramebuffer(y.FRAMEBUFFER,S),this._canvasPixelComparison(P(C),c.canvasCopies.map(P),c.timeStamps)}_canvasPixelComparison(C,c,y){let S=y[1]-y[0];const P=C.length/4;for(let O=0;O<c.length;O++){const F=c[O];let U=0;for(let q=0;q<F.length;q+=4)F[q]===C[q]&&F[q+1]===C[q+1]&&F[q+2]===C[q+2]&&F[q+3]===C[q+3]&&(U+=1);S+=(y[O+2]-y[O+1])*(1-U/P)}return S}remove(){this._hash&&this._hash.remove();for(const c of this._controls)c.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),void 0!==x.window&&(x.window.removeEventListener("resize",this._onWindowResize,!1),x.window.removeEventListener("orientationchange",this._onWindowResize,!1),x.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),x.window.removeEventListener("online",this._onWindowOnline,!1));const C=this.painter.context.gl.getExtension("WEBGL_lose_context");C&&C.loseContext(),_(this._canvasContainer),_(this._controlContainer),_(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),x.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new x.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(C){this._renderNextFrame=this._renderNextFrame||C,this.style&&!this._frame&&(this._frame=x.exported.frame(c=>{const y=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,y&&this._render(c)}))}_onWindowOnline(){this._update()}_onWindowResize(C){this._trackResize&&this.resize({originalEvent:C})._update()}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(C){this._showTileBoundaries!==C&&(this._showTileBoundaries=C,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(C){this._showTerrainWireframe!==C&&(this._showTerrainWireframe=C,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(C){this._speedIndexTiming!==C&&(this._speedIndexTiming=C,this._update())}get showPadding(){return!!this._showPadding}set showPadding(C){this._showPadding!==C&&(this._showPadding=C,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(C){this._showCollisionBoxes!==C&&(this._showCollisionBoxes=C,C?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(C){this._showOverdrawInspector!==C&&(this._showOverdrawInspector=C,this._update())}get repaint(){return!!this._repaint}set repaint(C){this._repaint!==C&&(this._repaint=C,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(C){this._vertices=C,this._update()}_setCacheLimits(C,c){x.setCacheLimits(C,c)}get version(){return x.version}},NavigationControl:class{constructor(C){this.options=x.extend({},b,C),this._container=Qe.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",c=>c.preventDefault()),this.options.showZoom&&(x.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",c=>this._map.zoomIn({},{originalEvent:c})),Qe.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",c=>this._map.zoomOut({},{originalEvent:c})),Qe.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(x.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",c=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:c}):this._map.resetNorth({},{originalEvent:c})}),this._compassIcon=Qe.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))}_updateZoomButtons(){const C=this._map.getZoom(),c=C===this._map.getMaxZoom(),y=C===this._map.getMinZoom();this._zoomInButton.disabled=c,this._zoomOutButton.disabled=y,this._zoomInButton.setAttribute("aria-disabled",c.toString()),this._zoomOutButton.setAttribute("aria-disabled",y.toString())}_rotateCompassArrow(){const C=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._map._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=C)})}onAdd(C){return this._map=C,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new I(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){Qe.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(C,c){const y=Qe.create("button",C,this._container);return y.type="button",y.addEventListener("click",c),y}_setButtonTitle(C,c){const y=this._map._getUIString(`NavigationControl.${c}`);C.title=y,C.setAttribute("aria-label",y)}},GeolocateControl:class extends x.Evented{constructor(C){super(),this.options=x.extend({},N,C),x.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation"],this),this._onDeviceOrientationListener=this._onDeviceOrientation.bind(this),this._updateMarkerRotationThrottled=Zl(this._updateMarkerRotation,20)}onAdd(C){var c;return this._map=C,this._container=Qe.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),c=this._setupUI,void 0!==j?c(j):void 0!==x.window.navigator.permissions?x.window.navigator.permissions.query({name:"geolocation"}).then(y=>{j="denied"!==y.state,c(j)}):(j=!!x.window.navigator.geolocation,c(j)),this._container}onRemove(){void 0!==this._geolocationWatchID&&(x.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),Qe.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,ne=0,Ee=!1}_isOutOfMapMaxBounds(C){const c=this._map.getMaxBounds(),y=C.coords;return c&&(y.longitude<c.getWest()||y.longitude>c.getEast()||y.latitude<c.getSouth()||y.latitude>c.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(C){if(this._map){if(this._isOutOfMapMaxBounds(C))return this._setErrorState(),this.fire(new x.Event("outofmaxbounds",C)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=C,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(C),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(C),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new x.Event("geolocate",C)),this._finish()}}_updateCamera(C){const c=new x.LngLat(C.coords.longitude,C.coords.latitude),y=C.coords.accuracy,S=this._map.getBearing(),P=x.extend({bearing:S},this.options.fitBoundsOptions);this._map.fitBounds(c.toBounds(y),P,{geolocateSource:!0})}_updateMarker(C){if(C){const c=new x.LngLat(C.coords.longitude,C.coords.latitude);this._accuracyCircleMarker.setLngLat(c).addTo(this._map),this._userLocationDotMarker.setLngLat(c).addTo(this._map),this._accuracy=C.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const C=this._map._container.clientHeight/2,c=this._map.unproject([0,C]),y=this._map.unproject([100,C]),S=c.distanceTo(y)/100,P=Math.ceil(2*this._accuracy/S);this._circleElement.style.width=`${P}px`,this._circleElement.style.height=`${P}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&"number"==typeof this._heading?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(C){if(this._map){if(this.options.trackUserLocation)if(1===C.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const c=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=c,this._geolocateButton.setAttribute("aria-label",c),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===C.code&&Ee)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new x.Event("error",C)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(C){if(this._container.addEventListener("contextmenu",c=>c.preventDefault()),this._geolocateButton=Qe.create("button","mapboxgl-ctrl-geolocate",this._container),Qe.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",!1===C){x.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const c=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=c,this._geolocateButton.setAttribute("aria-label",c)}else{const c=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=c,this._geolocateButton.setAttribute("aria-label",c)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=Qe.create("div","mapboxgl-user-location"),this._dotElement.appendChild(Qe.create("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(Qe.create("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new zh({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=Qe.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new zh({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",c=>{c.geolocateSource||"ACTIVE_LOCK"!==this._watchState||c.originalEvent&&"resize"===c.originalEvent.type||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new x.Event("trackuserlocationend")))})}_onDeviceOrientation(C){this._userLocationDotMarker&&(C.webkitCompassHeading?this._heading=C.webkitCompassHeading:!0===C.absolute&&(this._heading=-1*C.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return x.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new x.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":ne--,Ee=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new x.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new x.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let C;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),ne++,ne>1?(C={maximumAge:6e5,timeout:0},Ee=!0):(C=this.options.positionOptions,Ee=!1),this._geolocationWatchID=x.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,C),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else x.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const C=()=>{x.window.addEventListener("ondeviceorientationabsolute"in x.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientationListener)};void 0!==x.window.DeviceMotionEvent&&"function"==typeof x.window.DeviceMotionEvent.requestPermission?DeviceOrientationEvent.requestPermission().then(c=>{"granted"===c&&C()}).catch(console.error):C()}_clearWatch(){x.window.navigator.geolocation.clearWatch(this._geolocationWatchID),x.window.removeEventListener("deviceorientation",this._onDeviceOrientationListener),x.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientationListener),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:la,ScaleControl:class{constructor(C){this.options=x.extend({},it,C),x.bindAll(["_onMove","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_onMove(){Bt(this._map,this._container,this.options)}onAdd(C){return this._map=C,this._container=Qe.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",C.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){Qe.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}setUnit(C){this.options.unit=C,Bt(this._map,this._container,this.options)}},FullscreenControl:class{constructor(C){this._fullscreen=!1,C&&C.container&&(C.container instanceof x.window.HTMLElement?this._container=C.container:x.warnOnce("Full screen control 'container' must be a DOM element.")),x.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in x.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in x.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(C){return this._map=C,this._container||(this._container=this._map.getContainer()),this._controlContainer=Qe.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",x.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){Qe.remove(this._controlContainer),this._map=null,x.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!x.window.document.fullscreenEnabled&&!x.window.document.webkitFullscreenEnabled)}_setupUI(){const C=this._fullscreenButton=Qe.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);Qe.create("span","mapboxgl-ctrl-icon",C).setAttribute("aria-hidden",!0),C.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),x.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const C=this._getTitle();this._fullscreenButton.setAttribute("aria-label",C),this._fullscreenButton.title=C}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(x.window.document.fullscreenElement||x.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?x.window.document.exitFullscreen?x.window.document.exitFullscreen():x.window.document.webkitCancelFullScreen&&x.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends x.Evented{constructor(C){super(),this.options=x.extend(Object.create(vn),C),x.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}addTo(C){return this._map&&this.remove(),this._map=C,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new x.Event("open")),this}isOpen(){return!!this._map}remove(){return this._content&&Qe.remove(this._content),this._container&&(Qe.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new x.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(C){return this._lngLat=x.LngLat.convert(C),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(C){return this.setDOMContent(x.window.document.createTextNode(C))}setHTML(C){const c=x.window.document.createDocumentFragment(),y=x.window.document.createElement("body");let S;for(y.innerHTML=C;S=y.firstChild,S;)c.appendChild(S);return this.setDOMContent(c)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(C){return this.options.maxWidth=C,this._update(),this}setDOMContent(C){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=Qe.create("div","mapboxgl-popup-content",this._container);return this._content.appendChild(C),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(C){this._container&&this._container.classList.add(C)}removeClassName(C){this._container&&this._container.classList.remove(C)}setOffset(C){return this.options.offset=C,this._update(),this}toggleClassName(C){if(this._container)return this._container.classList.toggle(C)}_createCloseButton(){this.options.closeButton&&(this._closeButton=Qe.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_onMouseUp(C){this._update(C.point)}_onMouseMove(C){this._update(C.point)}_onDrag(C){this._update(C.point)}_update(C){if(!this._map||!this._lngLat&&!this._trackPointer||!this._content||(this._container||(this._container=Qe.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=Qe.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(O=>this._container.classList.add(O)),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Sr(this._lngLat,this._pos,this._map.transform)),this._trackPointer&&!C))return;const c=this._pos=this._trackPointer&&C?C:this._map.project(this._lngLat);let y=this.options.anchor;const S=Pn(this.options.offset);if(!y){const O=this._container.offsetWidth,F=this._container.offsetHeight;let U;U=c.y+S.bottom.y<F?["top"]:c.y>this._map.transform.height-F?["bottom"]:[],c.x<O/2?U.push("left"):c.x>this._map.transform.width-O/2&&U.push("right"),y=0===U.length?"bottom":U.join("-")}const P=c.add(S[y]).round();this._map._requestDomTask(()=>{this._container&&y&&(Qe.setTransform(this._container,`${Mu[y]} translate(${P.x}px,${P.y}px)`),Aa(this._container,y,"popup"))})}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const C=this._container.querySelector(pn);C&&C.focus()}_onClose(){this.remove()}_setOpacity(C){this._content&&(this._content.style.opacity=C),this._tip&&(this._tip.style.opacity=C)}},Marker:zh,Style:zs,LngLat:x.LngLat,LngLatBounds:x.LngLatBounds,Point:x.pointGeometry,MercatorCoordinate:x.MercatorCoordinate,FreeCameraOptions:Ia,Evented:x.Evented,config:x.config,prewarm:function(){fn().acquire(ft)},clearPrewarmedResources:function(){const C=Nt;C&&(C.isPreloaded()&&1===C.numActive()?(C.release(ft),Nt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return x.config.ACCESS_TOKEN},set accessToken(C){x.config.ACCESS_TOKEN=C},get baseApiUrl(){return x.config.API_URL},set baseApiUrl(C){x.config.API_URL=C},get workerCount(){return Et.workerCount},set workerCount(C){Et.workerCount=C},get maxParallelImageRequests(){return x.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(C){x.config.MAX_PARALLEL_IMAGE_REQUESTS=C},clearStorage(C){x.clearTileCache(C)},workerUrl:"",workerClass:null,setNow:x.exported.setNow,restoreNow:x.exported.restoreNow};return rr}),De}()},8228:Zt=>{"use strict";var gt=Object.getOwnPropertySymbols,Ue=Object.prototype.hasOwnProperty,De=Object.prototype.propertyIsEnumerable;function Be(x){if(null==x)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(x)}Zt.exports=function(){try{if(!Object.assign)return!1;var x=new String("abc");if(x[5]="de","5"===Object.getOwnPropertyNames(x)[0])return!1;for(var ut={},qe=0;qe<10;qe++)ut["_"+String.fromCharCode(qe)]=qe;if("0123456789"!==Object.getOwnPropertyNames(ut).map(function(Qe){return ut[Qe]}).join(""))return!1;var Ge={};return"abcdefghijklmnopqrst".split("").forEach(function(Qe){Ge[Qe]=Qe}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},Ge)).join("")}catch(Qe){return!1}}()?Object.assign:function(x,ut){for(var qe,Ge,dt=Be(x),Qe=1;Qe<arguments.length;Qe++){for(var It in qe=Object(arguments[Qe]))Ue.call(qe,It)&&(dt[It]=qe[It]);if(gt){Ge=gt(qe);for(var kt=0;kt<Ge.length;kt++)De.call(qe,Ge[kt])&&(dt[Ge[kt]]=qe[Ge[kt]])}}return dt}},7859:Zt=>{"use strict";var gt=function(Ue){return Ue!=Ue};Zt.exports=function(De,Be){return 0===De&&0===Be?1/De==1/Be:!!(De===Be||gt(De)&&gt(Be))}},4269:(Zt,gt,Ue)=>{"use strict";var De=Ue(6886),Be=Ue(44),pt=Ue(7859),x=Ue(8593),ut=Ue(6343),qe=Be(x(),Object);De(qe,{getPolyfill:x,implementation:pt,shim:ut}),Zt.exports=qe},8593:(Zt,gt,Ue)=>{"use strict";var De=Ue(7859);Zt.exports=function(){return"function"==typeof Object.is?Object.is:De}},6343:(Zt,gt,Ue)=>{"use strict";var De=Ue(8593),Be=Ue(6886);Zt.exports=function(){var x=De();return Be(Object,{is:x},{is:function(){return Object.is!==x}}),x}},6068:(Zt,gt,Ue)=>{"use strict";var De;if(!Object.keys){var Be=Object.prototype.hasOwnProperty,pt=Object.prototype.toString,x=Ue(2666),ut=Object.prototype.propertyIsEnumerable,qe=!ut.call({toString:null},"toString"),dt=ut.call(function(){},"prototype"),Ge=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],Qe=function(At){var an=At.constructor;return an&&an.prototype===At},It={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},kt=function(){if("undefined"==typeof window)return!1;for(var At in window)try{if(!It["$"+At]&&Be.call(window,At)&&null!==window[At]&&"object"==typeof window[At])try{Qe(window[At])}catch(an){return!0}}catch(an){return!0}return!1}();De=function(an){var fe=null!==an&&"object"==typeof an,Se="[object Function]"===pt.call(an),ue=x(an),pe=fe&&"[object String]"===pt.call(an),le=[];if(!fe&&!Se&&!ue)throw new TypeError("Object.keys called on a non-object");var Ne=dt&&Se;if(pe&&an.length>0&&!Be.call(an,0))for(var he=0;he<an.length;++he)le.push(String(he));if(ue&&an.length>0)for(var me=0;me<an.length;++me)le.push(String(me));else for(var be in an)(!Ne||"prototype"!==be)&&Be.call(an,be)&&le.push(String(be));if(qe)for(var re=function(At){if("undefined"==typeof window||!kt)return Qe(At);try{return Qe(At)}catch(an){return!1}}(an),mt=0;mt<Ge.length;++mt)(!re||"constructor"!==Ge[mt])&&Be.call(an,Ge[mt])&&le.push(Ge[mt]);return le}}Zt.exports=De},8507:(Zt,gt,Ue)=>{"use strict";var De=Array.prototype.slice,Be=Ue(2666),pt=Object.keys,x=pt?function(dt){return pt(dt)}:Ue(6068),ut=Object.keys;x.shim=function(){return Object.keys?function(){var Ge=Object.keys(arguments);return Ge&&Ge.length===arguments.length}(1,2)||(Object.keys=function(Qe){return Be(Qe)?ut(De.call(Qe)):ut(Qe)}):Object.keys=x,Object.keys||x},Zt.exports=x},2666:Zt=>{"use strict";var gt=Object.prototype.toString;Zt.exports=function(De){var Be=gt.call(De),pt="[object Arguments]"===Be;return pt||(pt="[object Array]"!==Be&&null!==De&&"object"==typeof De&&"number"==typeof De.length&&De.length>=0&&"[object Function]"===gt.call(De.callee)),pt}},5751:Zt=>{Zt.exports=function(Ue,De,Be,pt){var x=Ue[0],ut=Ue[1],qe=!1;void 0===Be&&(Be=0),void 0===pt&&(pt=De.length);for(var dt=(pt-Be)/2,Ge=0,Qe=dt-1;Ge<dt;Qe=Ge++){var It=De[Be+2*Ge+0],kt=De[Be+2*Ge+1],At=De[Be+2*Qe+1];kt>ut!=At>ut&&x<(De[Be+2*Qe+0]-It)*(ut-kt)/(At-kt)+It&&(qe=!qe)}return qe}},5503:(Zt,gt,Ue)=>{var De=Ue(5751),Be=Ue(5891);Zt.exports=function(x,ut,qe,dt){return ut.length>0&&Array.isArray(ut[0])?Be(x,ut,qe,dt):De(x,ut,qe,dt)},Zt.exports.nested=Be,Zt.exports.flat=De},5891:Zt=>{Zt.exports=function(Ue,De,Be,pt){var x=Ue[0],ut=Ue[1],qe=!1;void 0===Be&&(Be=0),void 0===pt&&(pt=De.length);for(var dt=pt-Be,Ge=0,Qe=dt-1;Ge<dt;Qe=Ge++){var It=De[Ge+Be][0],kt=De[Ge+Be][1],At=De[Qe+Be][1];kt>ut!=At>ut&&x<(De[Qe+Be][0]-It)*(ut-kt)/(At-kt)+It&&(qe=!qe)}return qe}},171:function(Zt){Zt.exports=function(){"use strict";function gt(_t,ve){if(!(_t instanceof ve))throw new TypeError("Cannot call a class as a function")}function Ue(_t,ve){for(var ce=0;ce<ve.length;ce++){var ae=ve[ce];ae.enumerable=ae.enumerable||!1,ae.configurable=!0,"value"in ae&&(ae.writable=!0),Object.defineProperty(_t,ae.key,ae)}}function De(_t,ve,ce){return ve&&Ue(_t.prototype,ve),ce&&Ue(_t,ce),_t}var Be=function(ve,ce){this.next=null,this.key=ve,this.data=ce,this.left=null,this.right=null};function pt(_t,ve){return _t>ve?1:_t<ve?-1:0}function x(_t,ve,ce){for(var ae=new Be(null,null),Ie=ae,ct=ae;;){var Ot=ce(_t,ve.key);if(Ot<0){if(null===ve.left)break;if(ce(_t,ve.left.key)<0&&(ve.left=(Kt=ve.left).right,Kt.right=ve,null===(ve=Kt).left))break;ct.left=ve,ct=ve,ve=ve.left}else{if(!(Ot>0))break;if(null===ve.right)break;var Kt;if(ce(_t,ve.right.key)>0&&(ve.right=(Kt=ve.right).left,Kt.left=ve,null===(ve=Kt).right))break;Ie.right=ve,Ie=ve,ve=ve.right}}return Ie.right=ve.left,ct.left=ve.right,ve.left=ae.right,ve.right=ae.left,ve}function ut(_t,ve,ce,ae){var Ie=new Be(_t,ve);if(null===ce)return Ie.left=Ie.right=null,Ie;var ct=ae(_t,(ce=x(_t,ce,ae)).key);return ct<0?(Ie.left=ce.left,Ie.right=ce,ce.left=null):ct>=0&&(Ie.right=ce.right,Ie.left=ce,ce.right=null),Ie}function qe(_t,ve,ce){var ae=null,Ie=null;if(ve){var ct=ce((ve=x(_t,ve,ce)).key,_t);0===ct?(ae=ve.left,Ie=ve.right):ct<0?(Ie=ve.right,ve.right=null,ae=ve):(ae=ve.left,ve.left=null,Ie=ve)}return{left:ae,right:Ie}}function Ge(_t,ve,ce,ae,Ie){if(_t){ae(ve+(ce?"\u2514\u2500\u2500 ":"\u251c\u2500\u2500 ")+Ie(_t)+"\n");var ct=ve+(ce?"    ":"\u2502   ");_t.left&&Ge(_t.left,ct,!1,ae,Ie),_t.right&&Ge(_t.right,ct,!0,ae,Ie)}}var Qe=function(){function _t(ve){void 0===ve&&(ve=pt),this._root=null,this._size=0,this._comparator=ve}return _t.prototype.insert=function(ve,ce){return this._size++,this._root=ut(ve,ce,this._root,this._comparator)},_t.prototype.add=function(ve,ce){var ae=new Be(ve,ce);null===this._root&&(ae.left=ae.right=null,this._size++,this._root=ae);var Ie=this._comparator,ct=x(ve,this._root,Ie),Ot=Ie(ve,ct.key);return 0===Ot?this._root=ct:(Ot<0?(ae.left=ct.left,ae.right=ct,ct.left=null):Ot>0&&(ae.right=ct.right,ae.left=ct,ct.right=null),this._size++,this._root=ae),this._root},_t.prototype.remove=function(ve){this._root=this._remove(ve,this._root,this._comparator)},_t.prototype._remove=function(ve,ce,ae){var Ie;return null===ce?null:0===ae(ve,(ce=x(ve,ce,ae)).key)?(null===ce.left?Ie=ce.right:(Ie=x(ve,ce.left,ae)).right=ce.right,this._size--,Ie):ce},_t.prototype.pop=function(){var ve=this._root;if(ve){for(;ve.left;)ve=ve.left;return this._root=x(ve.key,this._root,this._comparator),this._root=this._remove(ve.key,this._root,this._comparator),{key:ve.key,data:ve.data}}return null},_t.prototype.findStatic=function(ve){for(var ce=this._root,ae=this._comparator;ce;){var Ie=ae(ve,ce.key);if(0===Ie)return ce;ce=Ie<0?ce.left:ce.right}return null},_t.prototype.find=function(ve){return this._root&&(this._root=x(ve,this._root,this._comparator),0!==this._comparator(ve,this._root.key))?null:this._root},_t.prototype.contains=function(ve){for(var ce=this._root,ae=this._comparator;ce;){var Ie=ae(ve,ce.key);if(0===Ie)return!0;ce=Ie<0?ce.left:ce.right}return!1},_t.prototype.forEach=function(ve,ce){for(var ae=this._root,Ie=[],ct=!1;!ct;)null!==ae?(Ie.push(ae),ae=ae.left):0!==Ie.length?(ae=Ie.pop(),ve.call(ce,ae),ae=ae.right):ct=!0;return this},_t.prototype.range=function(ve,ce,ae,Ie){for(var ct=[],Ot=this._comparator,Kt=this._root;0!==ct.length||Kt;)if(Kt)ct.push(Kt),Kt=Kt.left;else{if(Ot((Kt=ct.pop()).key,ce)>0)break;if(Ot(Kt.key,ve)>=0&&ae.call(Ie,Kt))return this;Kt=Kt.right}return this},_t.prototype.keys=function(){var ve=[];return this.forEach(function(ce){return ve.push(ce.key)}),ve},_t.prototype.values=function(){var ve=[];return this.forEach(function(ce){return ve.push(ce.data)}),ve},_t.prototype.min=function(){return this._root?this.minNode(this._root).key:null},_t.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},_t.prototype.minNode=function(ve){if(void 0===ve&&(ve=this._root),ve)for(;ve.left;)ve=ve.left;return ve},_t.prototype.maxNode=function(ve){if(void 0===ve&&(ve=this._root),ve)for(;ve.right;)ve=ve.right;return ve},_t.prototype.at=function(ve){for(var ce=this._root,ae=!1,Ie=0,ct=[];!ae;)if(ce)ct.push(ce),ce=ce.left;else if(ct.length>0){if(ce=ct.pop(),Ie===ve)return ce;Ie++,ce=ce.right}else ae=!0;return null},_t.prototype.next=function(ve){var ce=this._root,ae=null;if(ve.right){for(ae=ve.right;ae.left;)ae=ae.left;return ae}for(var Ie=this._comparator;ce;){var ct=Ie(ve.key,ce.key);if(0===ct)break;ct<0?(ae=ce,ce=ce.left):ce=ce.right}return ae},_t.prototype.prev=function(ve){var ce=this._root,ae=null;if(null!==ve.left){for(ae=ve.left;ae.right;)ae=ae.right;return ae}for(var Ie=this._comparator;ce;){var ct=Ie(ve.key,ce.key);if(0===ct)break;ct<0?ce=ce.left:(ae=ce,ce=ce.right)}return ae},_t.prototype.clear=function(){return this._root=null,this._size=0,this},_t.prototype.toList=function(){return function(_t){for(var ve=_t,ce=[],ae=!1,Ie=new Be(null,null),ct=Ie;!ae;)ve?(ce.push(ve),ve=ve.left):ce.length>0?ve=(ve=ct=ct.next=ce.pop()).right:ae=!0;return ct.next=null,Ie.next}(this._root)},_t.prototype.load=function(ve,ce,ae){void 0===ce&&(ce=[]),void 0===ae&&(ae=!1);var Ie=ve.length,ct=this._comparator;if(ae&&fe(ve,ce,0,Ie-1,ct),null===this._root)this._root=It(ve,ce,0,Ie),this._size=Ie;else{var Ot=function(_t,ve,ce){for(var ae=new Be(null,null),Ie=ae,ct=_t,Ot=ve;null!==ct&&null!==Ot;)ce(ct.key,Ot.key)<0?(Ie.next=ct,ct=ct.next):(Ie.next=Ot,Ot=Ot.next),Ie=Ie.next;return null!==ct?Ie.next=ct:null!==Ot&&(Ie.next=Ot),ae.next}(this.toList(),function(_t,ve){for(var ce=new Be(null,null),ae=ce,Ie=0;Ie<_t.length;Ie++)ae=ae.next=new Be(_t[Ie],ve[Ie]);return ae.next=null,ce.next}(ve,ce),ct);this._root=At({head:Ot},0,Ie=this._size+Ie)}return this},_t.prototype.isEmpty=function(){return null===this._root},Object.defineProperty(_t.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(_t.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),_t.prototype.toString=function(ve){void 0===ve&&(ve=function(Ie){return String(Ie.key)});var ce=[];return Ge(this._root,"",!0,function(ae){return ce.push(ae)},ve),ce.join("")},_t.prototype.update=function(ve,ce,ae){var Ie=this._comparator,ct=qe(ve,this._root,Ie),Ot=ct.left,Kt=ct.right;Ie(ve,ce)<0?Kt=ut(ce,ae,Kt,Ie):Ot=ut(ce,ae,Ot,Ie),this._root=function(_t,ve,ce){return null===ve?_t:(null===_t||((ve=x(_t.key,ve,ce)).left=_t),ve)}(Ot,Kt,Ie)},_t.prototype.split=function(ve){return qe(ve,this._root,this._comparator)},_t}();function It(_t,ve,ce,ae){var Ie=ae-ce;if(Ie>0){var ct=ce+Math.floor(Ie/2),Yt=new Be(_t[ct],ve[ct]);return Yt.left=It(_t,ve,ce,ct),Yt.right=It(_t,ve,ct+1,ae),Yt}return null}function At(_t,ve,ce){var ae=ce-ve;if(ae>0){var Ie=ve+Math.floor(ae/2),ct=At(_t,ve,Ie),Ot=_t.head;return Ot.left=ct,_t.head=_t.head.next,Ot.right=At(_t,Ie+1,ce),Ot}return null}function fe(_t,ve,ce,ae,Ie){if(!(ce>=ae)){for(var ct=_t[ce+ae>>1],Ot=ce-1,Kt=ae+1;;){do{Ot++}while(Ie(_t[Ot],ct)<0);do{Kt--}while(Ie(_t[Kt],ct)>0);if(Ot>=Kt)break;var Yt=_t[Ot];_t[Ot]=_t[Kt],_t[Kt]=Yt,Yt=ve[Ot],ve[Ot]=ve[Kt],ve[Kt]=Yt}fe(_t,ve,ce,Kt,Ie),fe(_t,ve,Kt+1,ae,Ie)}}var Se=function(ve,ce){return ve.ll.x<=ce.x&&ce.x<=ve.ur.x&&ve.ll.y<=ce.y&&ce.y<=ve.ur.y},ue=function(ve,ce){return ce.ur.x<ve.ll.x||ve.ur.x<ce.ll.x||ce.ur.y<ve.ll.y||ve.ur.y<ce.ll.y?null:{ll:{x:ve.ll.x<ce.ll.x?ce.ll.x:ve.ll.x,y:ve.ll.y<ce.ll.y?ce.ll.y:ve.ll.y},ur:{x:ve.ur.x<ce.ur.x?ve.ur.x:ce.ur.x,y:ve.ur.y<ce.ur.y?ve.ur.y:ce.ur.y}}},pe=Number.EPSILON;void 0===pe&&(pe=Math.pow(2,-52));var le=pe*pe,Ne=function(ve,ce){if(-pe<ve&&ve<pe&&-pe<ce&&ce<pe)return 0;var ae=ve-ce;return ae*ae<le*ve*ce?0:ve<ce?-1:1},he=function(){function _t(){gt(this,_t),this.reset()}return De(_t,[{key:"reset",value:function(){this.xRounder=new me,this.yRounder=new me}},{key:"round",value:function(ce,ae){return{x:this.xRounder.round(ce),y:this.yRounder.round(ae)}}}]),_t}(),me=function(){function _t(){gt(this,_t),this.tree=new Qe,this.round(0)}return De(_t,[{key:"round",value:function(ce){var ae=this.tree.add(ce),Ie=this.tree.prev(ae);if(null!==Ie&&0===Ne(ae.key,Ie.key))return this.tree.remove(ce),Ie.key;var ct=this.tree.next(ae);return null!==ct&&0===Ne(ae.key,ct.key)?(this.tree.remove(ce),ct.key):ce}}]),_t}(),be=new he,re=function(ve,ce){return ve.x*ce.y-ve.y*ce.x},mt=function(ve,ce){return ve.x*ce.x+ve.y*ce.y},ze=function(ve,ce,ae){var Ot=re({x:ce.x-ve.x,y:ce.y-ve.y},{x:ae.x-ve.x,y:ae.y-ve.y});return Ne(Ot,0)},Oe=function(ve){return Math.sqrt(mt(ve,ve))},xe=function(ve,ce,ae){var Ie={x:ce.x-ve.x,y:ce.y-ve.y},ct={x:ae.x-ve.x,y:ae.y-ve.y};return re(ct,Ie)/Oe(ct)/Oe(Ie)},jt=function(ve,ce,ae){var Ie={x:ce.x-ve.x,y:ce.y-ve.y},ct={x:ae.x-ve.x,y:ae.y-ve.y};return mt(ct,Ie)/Oe(ct)/Oe(Ie)},Lt=function(ve,ce,ae){return 0===ce.y?null:{x:ve.x+ce.x/ce.y*(ae-ve.y),y:ae}},Ce=function(ve,ce,ae){return 0===ce.x?null:{x:ae,y:ve.y+ce.y/ce.x*(ae-ve.x)}},Pe=function(){function _t(ve,ce){gt(this,_t),void 0===ve.events?ve.events=[this]:ve.events.push(this),this.point=ve,this.isLeft=ce}return De(_t,null,[{key:"compare",value:function(ce,ae){var Ie=_t.comparePoints(ce.point,ae.point);return 0!==Ie?Ie:(ce.point!==ae.point&&ce.link(ae),ce.isLeft!==ae.isLeft?ce.isLeft?1:-1:Ke.compare(ce.segment,ae.segment))}},{key:"comparePoints",value:function(ce,ae){return ce.x<ae.x?-1:ce.x>ae.x?1:ce.y<ae.y?-1:ce.y>ae.y?1:0}}]),De(_t,[{key:"link",value:function(ce){if(ce.point===this.point)throw new Error("Tried to link already linked events");for(var ae=ce.point.events,Ie=0,ct=ae.length;Ie<ct;Ie++){var Ot=ae[Ie];this.point.events.push(Ot),Ot.point=this.point}this.checkForConsuming()}},{key:"checkForConsuming",value:function(){for(var ce=this.point.events.length,ae=0;ae<ce;ae++){var Ie=this.point.events[ae];if(void 0===Ie.segment.consumedBy)for(var ct=ae+1;ct<ce;ct++){var Ot=this.point.events[ct];void 0===Ot.consumedBy&&Ie.otherSE.point.events===Ot.otherSE.point.events&&Ie.segment.consume(Ot.segment)}}}},{key:"getAvailableLinkedEvents",value:function(){for(var ce=[],ae=0,Ie=this.point.events.length;ae<Ie;ae++){var ct=this.point.events[ae];ct!==this&&!ct.segment.ringOut&&ct.segment.isInResult()&&ce.push(ct)}return ce}},{key:"getLeftmostComparator",value:function(ce){var ae=this,Ie=new Map,ct=function(Kt){var Yt=Kt.otherSE;Ie.set(Kt,{sine:xe(ae.point,ce.point,Yt.point),cosine:jt(ae.point,ce.point,Yt.point)})};return function(Ot,Kt){Ie.has(Ot)||ct(Ot),Ie.has(Kt)||ct(Kt);var Yt=Ie.get(Ot),wt=Yt.sine,Qn=Yt.cosine,Er=Ie.get(Kt),Qt=Er.sine,jn=Er.cosine;return wt>=0&&Qt>=0?Qn<jn?1:Qn>jn?-1:0:wt<0&&Qt<0?Qn<jn?-1:Qn>jn?1:0:Qt<wt?-1:Qt>wt?1:0}}}]),_t}(),lt=0,Ke=function(){function _t(ve,ce,ae,Ie){gt(this,_t),this.id=++lt,this.leftSE=ve,ve.segment=this,ve.otherSE=ce,this.rightSE=ce,ce.segment=this,ce.otherSE=ve,this.rings=ae,this.windings=Ie}return De(_t,null,[{key:"compare",value:function(ce,ae){var Ie=ce.leftSE.point.x,ct=ae.leftSE.point.x,Ot=ce.rightSE.point.x,Kt=ae.rightSE.point.x;if(Kt<Ie)return 1;if(Ot<ct)return-1;var Yt=ce.leftSE.point.y,wt=ae.leftSE.point.y,Qn=ce.rightSE.point.y,Er=ae.rightSE.point.y;if(Ie<ct){if(wt<Yt&&wt<Qn)return 1;if(wt>Yt&&wt>Qn)return-1;var Qt=ce.comparePoint(ae.leftSE.point);if(Qt<0)return 1;if(Qt>0)return-1;var jn=ae.comparePoint(ce.rightSE.point);return 0!==jn?jn:-1}if(Ie>ct){if(Yt<wt&&Yt<Er)return-1;if(Yt>wt&&Yt>Er)return 1;var ar=ae.comparePoint(ce.leftSE.point);if(0!==ar)return ar;var Vr=ce.comparePoint(ae.rightSE.point);return Vr<0?1:Vr>0?-1:1}if(Yt<wt)return-1;if(Yt>wt)return 1;if(Ot<Kt){var ei=ae.comparePoint(ce.rightSE.point);if(0!==ei)return ei}if(Ot>Kt){var So=ce.comparePoint(ae.rightSE.point);if(So<0)return 1;if(So>0)return-1}if(Ot!==Kt){var Mo=Qn-Yt,jo=Ot-Ie,fi=Er-wt,Xo=Kt-ct;if(Mo>jo&&fi<Xo)return 1;if(Mo<jo&&fi>Xo)return-1}return Ot>Kt?1:Ot<Kt||Qn<Er?-1:Qn>Er?1:ce.id<ae.id?-1:ce.id>ae.id?1:0}}]),De(_t,[{key:"replaceRightSE",value:function(ce){this.rightSE=ce,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}},{key:"bbox",value:function(){var ce=this.leftSE.point.y,ae=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:ce<ae?ce:ae},ur:{x:this.rightSE.point.x,y:ce>ae?ce:ae}}}},{key:"vector",value:function(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}},{key:"isAnEndpoint",value:function(ce){return ce.x===this.leftSE.point.x&&ce.y===this.leftSE.point.y||ce.x===this.rightSE.point.x&&ce.y===this.rightSE.point.y}},{key:"comparePoint",value:function(ce){if(this.isAnEndpoint(ce))return 0;var ae=this.leftSE.point,Ie=this.rightSE.point,ct=this.vector();if(ae.x===Ie.x)return ce.x===ae.x?0:ce.x<ae.x?1:-1;if(ce.x===ae.x+(ce.y-ae.y)/ct.y*ct.x)return 0;var wt=ae.y+(ce.x-ae.x)/ct.x*ct.y;return ce.y===wt?0:ce.y<wt?-1:1}},{key:"getIntersection",value:function(ce){var ae=this.bbox(),Ie=ce.bbox(),ct=ue(ae,Ie);if(null===ct)return null;var Ot=this.leftSE.point,Kt=this.rightSE.point,Yt=ce.leftSE.point,wt=ce.rightSE.point,Qn=Se(ae,Yt)&&0===this.comparePoint(Yt),Er=Se(Ie,Ot)&&0===ce.comparePoint(Ot),Qt=Se(ae,wt)&&0===this.comparePoint(wt),jn=Se(Ie,Kt)&&0===ce.comparePoint(Kt);if(Er&&Qn)return jn&&!Qt?Kt:!jn&&Qt?wt:null;if(Er)return Qt&&Ot.x===wt.x&&Ot.y===wt.y?null:Ot;if(Qn)return jn&&Kt.x===Yt.x&&Kt.y===Yt.y?null:Yt;if(jn&&Qt)return null;if(jn)return Kt;if(Qt)return wt;var ar=function(ve,ce,ae,Ie){if(0===ce.x)return Ce(ae,Ie,ve.x);if(0===Ie.x)return Ce(ve,ce,ae.x);if(0===ce.y)return Lt(ae,Ie,ve.y);if(0===Ie.y)return Lt(ve,ce,ae.y);var ct=re(ce,Ie);if(0==ct)return null;var Ot={x:ae.x-ve.x,y:ae.y-ve.y},Kt=re(Ot,ce)/ct,Yt=re(Ot,Ie)/ct;return{x:(ve.x+Yt*ce.x+(ae.x+Kt*Ie.x))/2,y:(ve.y+Yt*ce.y+(ae.y+Kt*Ie.y))/2}}(Ot,this.vector(),Yt,ce.vector());return null!==ar&&Se(ct,ar)?be.round(ar.x,ar.y):null}},{key:"split",value:function(ce){var ae=[],Ie=void 0!==ce.events,ct=new Pe(ce,!0),Ot=new Pe(ce,!1),Kt=this.rightSE;this.replaceRightSE(Ot),ae.push(Ot),ae.push(ct);var Yt=new _t(ct,Kt,this.rings.slice(),this.windings.slice());return Pe.comparePoints(Yt.leftSE.point,Yt.rightSE.point)>0&&Yt.swapEvents(),Pe.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),Ie&&(ct.checkForConsuming(),Ot.checkForConsuming()),ae}},{key:"swapEvents",value:function(){var ce=this.rightSE;this.rightSE=this.leftSE,this.leftSE=ce,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(var ae=0,Ie=this.windings.length;ae<Ie;ae++)this.windings[ae]*=-1}},{key:"consume",value:function(ce){for(var ae=this,Ie=ce;ae.consumedBy;)ae=ae.consumedBy;for(;Ie.consumedBy;)Ie=Ie.consumedBy;var ct=_t.compare(ae,Ie);if(0!==ct){if(ct>0){var Ot=ae;ae=Ie,Ie=Ot}if(ae.prev===Ie){var Kt=ae;ae=Ie,Ie=Kt}for(var Yt=0,wt=Ie.rings.length;Yt<wt;Yt++){var Qn=Ie.rings[Yt],Er=Ie.windings[Yt],Qt=ae.rings.indexOf(Qn);-1===Qt?(ae.rings.push(Qn),ae.windings.push(Er)):ae.windings[Qt]+=Er}Ie.rings=null,Ie.windings=null,Ie.consumedBy=ae,Ie.leftSE.consumedBy=ae.leftSE,Ie.rightSE.consumedBy=ae.rightSE}}},{key:"prevInResult",value:function(){return void 0!==this._prevInResult||(this._prevInResult=this.prev?this.prev.isInResult()?this.prev:this.prev.prevInResult():null),this._prevInResult}},{key:"beforeState",value:function(){return void 0!==this._beforeState||(this._beforeState=this.prev?(this.prev.consumedBy||this.prev).afterState():{rings:[],windings:[],multiPolys:[]}),this._beforeState}},{key:"afterState",value:function(){if(void 0!==this._afterState)return this._afterState;var ce=this.beforeState();this._afterState={rings:ce.rings.slice(0),windings:ce.windings.slice(0),multiPolys:[]};for(var ae=this._afterState.rings,Ie=this._afterState.windings,ct=this._afterState.multiPolys,Ot=0,Kt=this.rings.length;Ot<Kt;Ot++){var Yt=this.rings[Ot],wt=this.windings[Ot],Qn=ae.indexOf(Yt);-1===Qn?(ae.push(Yt),Ie.push(wt)):Ie[Qn]+=wt}for(var Er=[],Qt=[],jn=0,ar=ae.length;jn<ar;jn++)if(0!==Ie[jn]){var Vr=ae[jn],ei=Vr.poly;if(-1===Qt.indexOf(ei))if(Vr.isExterior)Er.push(ei);else{-1===Qt.indexOf(ei)&&Qt.push(ei);var So=Er.indexOf(Vr.poly);-1!==So&&Er.splice(So,1)}}for(var Mo=0,jo=Er.length;Mo<jo;Mo++){var fi=Er[Mo].multiPoly;-1===ct.indexOf(fi)&&ct.push(fi)}return this._afterState}},{key:"isInResult",value:function(){if(this.consumedBy)return!1;if(void 0!==this._isInResult)return this._isInResult;var ce=this.beforeState().multiPolys,ae=this.afterState().multiPolys;switch(rn.type){case"union":this._isInResult=0===ce.length!=(0===ae.length);break;case"intersection":var Ot,Kt;ce.length<ae.length?(Ot=ce.length,Kt=ae.length):(Ot=ae.length,Kt=ce.length),this._isInResult=Kt===rn.numMultiPolys&&Ot<Kt;break;case"xor":var Yt=Math.abs(ce.length-ae.length);this._isInResult=Yt%2==1;break;case"difference":var wt=function(Er){return 1===Er.length&&Er[0].isSubject};this._isInResult=wt(ce)!==wt(ae);break;default:throw new Error("Unrecognized operation type found ".concat(rn.type))}return this._isInResult}}],[{key:"fromRing",value:function(ce,ae,Ie){var ct,Ot,Kt,Yt=Pe.comparePoints(ce,ae);if(Yt<0)ct=ce,Ot=ae,Kt=1;else{if(!(Yt>0))throw new Error("Tried to create degenerate segment at [".concat(ce.x,", ").concat(ce.y,"]"));ct=ae,Ot=ce,Kt=-1}return new _t(new Pe(ct,!0),new Pe(Ot,!1),[Ie],[Kt])}}]),_t}(),Me=function(){function _t(ve,ce,ae){if(gt(this,_t),!Array.isArray(ve)||0===ve.length)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=ce,this.isExterior=ae,this.segments=[],"number"!=typeof ve[0][0]||"number"!=typeof ve[0][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var Ie=be.round(ve[0][0],ve[0][1]);this.bbox={ll:{x:Ie.x,y:Ie.y},ur:{x:Ie.x,y:Ie.y}};for(var ct=Ie,Ot=1,Kt=ve.length;Ot<Kt;Ot++){if("number"!=typeof ve[Ot][0]||"number"!=typeof ve[Ot][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var Yt=be.round(ve[Ot][0],ve[Ot][1]);Yt.x===ct.x&&Yt.y===ct.y||(this.segments.push(Ke.fromRing(ct,Yt,this)),Yt.x<this.bbox.ll.x&&(this.bbox.ll.x=Yt.x),Yt.y<this.bbox.ll.y&&(this.bbox.ll.y=Yt.y),Yt.x>this.bbox.ur.x&&(this.bbox.ur.x=Yt.x),Yt.y>this.bbox.ur.y&&(this.bbox.ur.y=Yt.y),ct=Yt)}(Ie.x!==ct.x||Ie.y!==ct.y)&&this.segments.push(Ke.fromRing(ct,Ie,this))}return De(_t,[{key:"getSweepEvents",value:function(){for(var ce=[],ae=0,Ie=this.segments.length;ae<Ie;ae++){var ct=this.segments[ae];ce.push(ct.leftSE),ce.push(ct.rightSE)}return ce}}]),_t}(),Ft=function(){function _t(ve,ce){if(gt(this,_t),!Array.isArray(ve))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new Me(ve[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(var ae=1,Ie=ve.length;ae<Ie;ae++){var ct=new Me(ve[ae],this,!1);ct.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=ct.bbox.ll.x),ct.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=ct.bbox.ll.y),ct.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=ct.bbox.ur.x),ct.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=ct.bbox.ur.y),this.interiorRings.push(ct)}this.multiPoly=ce}return De(_t,[{key:"getSweepEvents",value:function(){for(var ce=this.exteriorRing.getSweepEvents(),ae=0,Ie=this.interiorRings.length;ae<Ie;ae++)for(var ct=this.interiorRings[ae].getSweepEvents(),Ot=0,Kt=ct.length;Ot<Kt;Ot++)ce.push(ct[Ot]);return ce}}]),_t}(),Ut=function(){function _t(ve,ce){if(gt(this,_t),!Array.isArray(ve))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{"number"==typeof ve[0][0][0]&&(ve=[ve])}catch(Ot){}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(var ae=0,Ie=ve.length;ae<Ie;ae++){var ct=new Ft(ve[ae],this);ct.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=ct.bbox.ll.x),ct.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=ct.bbox.ll.y),ct.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=ct.bbox.ur.x),ct.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=ct.bbox.ur.y),this.polys.push(ct)}this.isSubject=ce}return De(_t,[{key:"getSweepEvents",value:function(){for(var ce=[],ae=0,Ie=this.polys.length;ae<Ie;ae++)for(var ct=this.polys[ae].getSweepEvents(),Ot=0,Kt=ct.length;Ot<Kt;Ot++)ce.push(ct[Ot]);return ce}}]),_t}(),Sn=function(){function _t(ve){gt(this,_t),this.events=ve;for(var ce=0,ae=ve.length;ce<ae;ce++)ve[ce].segment.ringOut=this;this.poly=null}return De(_t,null,[{key:"factory",value:function(ce){for(var ae=[],Ie=0,ct=ce.length;Ie<ct;Ie++){var Ot=ce[Ie];if(Ot.isInResult()&&!Ot.ringOut){for(var Kt=null,Yt=Ot.leftSE,wt=Ot.rightSE,Qn=[Yt],Er=Yt.point,Qt=[];Kt=Yt,Qn.push(Yt=wt),Yt.point!==Er;)for(;;){var jn=Yt.getAvailableLinkedEvents();if(0===jn.length){var ar=Qn[0].point,Vr=Qn[Qn.length-1].point;throw new Error("Unable to complete output ring starting at [".concat(ar.x,",")+" ".concat(ar.y,"]. Last matching segment found ends at")+" [".concat(Vr.x,", ").concat(Vr.y,"]."))}if(1===jn.length){wt=jn[0].otherSE;break}for(var ei=null,So=0,Mo=Qt.length;So<Mo;So++)if(Qt[So].point===Yt.point){ei=So;break}if(null===ei){Qt.push({index:Qn.length,point:Yt.point});var Xo=Yt.getLeftmostComparator(Kt);wt=jn.sort(Xo)[0].otherSE;break}var jo=Qt.splice(ei)[0],fi=Qn.splice(jo.index);fi.unshift(fi[0].otherSE),ae.push(new _t(fi.reverse()))}ae.push(new _t(Qn))}}return ae}}]),De(_t,[{key:"getGeom",value:function(){for(var ce=this.events[0].point,ae=[ce],Ie=1,ct=this.events.length-1;Ie<ct;Ie++){var Ot=this.events[Ie].point;0!==ze(Ot,ce,this.events[Ie+1].point)&&(ae.push(Ot),ce=Ot)}if(1===ae.length)return null;0===ze(ae[0],ce,ae[1])&&ae.shift(),ae.push(ae[0]);for(var Qn=this.isExteriorRing()?1:-1,Er=this.isExteriorRing()?0:ae.length-1,Qt=this.isExteriorRing()?ae.length:-1,jn=[],ar=Er;ar!=Qt;ar+=Qn)jn.push([ae[ar].x,ae[ar].y]);return jn}},{key:"isExteriorRing",value:function(){if(void 0===this._isExteriorRing){var ce=this.enclosingRing();this._isExteriorRing=!ce||!ce.isExteriorRing()}return this._isExteriorRing}},{key:"enclosingRing",value:function(){return void 0===this._enclosingRing&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}},{key:"_calcEnclosingRing",value:function(){for(var ce=this.events[0],ae=1,Ie=this.events.length;ae<Ie;ae++){var ct=this.events[ae];Pe.compare(ce,ct)>0&&(ce=ct)}for(var Ot=ce.segment.prevInResult(),Kt=Ot?Ot.prevInResult():null;;){if(!Ot)return null;if(!Kt)return Ot.ringOut;if(Kt.ringOut!==Ot.ringOut)return Kt.ringOut.enclosingRing()!==Ot.ringOut?Ot.ringOut:Ot.ringOut.enclosingRing();Ot=Kt.prevInResult(),Kt=Ot?Ot.prevInResult():null}}}]),_t}(),Gt=function(){function _t(ve){gt(this,_t),this.exteriorRing=ve,ve.poly=this,this.interiorRings=[]}return De(_t,[{key:"addInterior",value:function(ce){this.interiorRings.push(ce),ce.poly=this}},{key:"getGeom",value:function(){var ce=[this.exteriorRing.getGeom()];if(null===ce[0])return null;for(var ae=0,Ie=this.interiorRings.length;ae<Ie;ae++){var ct=this.interiorRings[ae].getGeom();null!==ct&&ce.push(ct)}return ce}}]),_t}(),Mn=function(){function _t(ve){gt(this,_t),this.rings=ve,this.polys=this._composePolys(ve)}return De(_t,[{key:"getGeom",value:function(){for(var ce=[],ae=0,Ie=this.polys.length;ae<Ie;ae++){var ct=this.polys[ae].getGeom();null!==ct&&ce.push(ct)}return ce}},{key:"_composePolys",value:function(ce){for(var ae=[],Ie=0,ct=ce.length;Ie<ct;Ie++){var Ot=ce[Ie];if(!Ot.poly)if(Ot.isExteriorRing())ae.push(new Gt(Ot));else{var Kt=Ot.enclosingRing();Kt.poly||ae.push(new Gt(Kt)),Kt.poly.addInterior(Ot)}}return ae}}]),_t}(),hr=function(){function _t(ve){var ce=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ke.compare;gt(this,_t),this.queue=ve,this.tree=new Qe(ce),this.segments=[]}return De(_t,[{key:"process",value:function(ce){var ae=ce.segment,Ie=[];if(ce.consumedBy)return ce.isLeft?this.queue.remove(ce.otherSE):this.tree.remove(ae),Ie;var ct=ce.isLeft?this.tree.insert(ae):this.tree.find(ae);if(!ct)throw new Error("Unable to find segment #".concat(ae.id," ")+"[".concat(ae.leftSE.point.x,", ").concat(ae.leftSE.point.y,"] -> ")+"[".concat(ae.rightSE.point.x,", ").concat(ae.rightSE.point.y,"] ")+"in SweepLine tree. Please submit a bug report.");for(var Ot=ct,Kt=ct,Yt=void 0,wt=void 0;void 0===Yt;)null===(Ot=this.tree.prev(Ot))?Yt=null:void 0===Ot.key.consumedBy&&(Yt=Ot.key);for(;void 0===wt;)null===(Kt=this.tree.next(Kt))?wt=null:void 0===Kt.key.consumedBy&&(wt=Kt.key);if(ce.isLeft){var Qn=null;if(Yt){var Er=Yt.getIntersection(ae);if(null!==Er&&(ae.isAnEndpoint(Er)||(Qn=Er),!Yt.isAnEndpoint(Er)))for(var Qt=this._splitSafely(Yt,Er),jn=0,ar=Qt.length;jn<ar;jn++)Ie.push(Qt[jn])}var Vr=null;if(wt){var ei=wt.getIntersection(ae);if(null!==ei&&(ae.isAnEndpoint(ei)||(Vr=ei),!wt.isAnEndpoint(ei)))for(var So=this._splitSafely(wt,ei),Mo=0,jo=So.length;Mo<jo;Mo++)Ie.push(So[Mo])}if(null!==Qn||null!==Vr){var fi;fi=null===Qn?Vr:null===Vr||Pe.comparePoints(Qn,Vr)<=0?Qn:Vr,this.queue.remove(ae.rightSE),Ie.push(ae.rightSE);for(var qi=ae.split(fi),fa=0,fo=qi.length;fa<fo;fa++)Ie.push(qi[fa])}Ie.length>0?(this.tree.remove(ae),Ie.push(ce)):(this.segments.push(ae),ae.prev=Yt)}else{if(Yt&&wt){var ln=Yt.getIntersection(wt);if(null!==ln){if(!Yt.isAnEndpoint(ln))for(var al=this._splitSafely(Yt,ln),Fs=0,yr=al.length;Fs<yr;Fs++)Ie.push(al[Fs]);if(!wt.isAnEndpoint(ln))for(var Bs=this._splitSafely(wt,ln),Re=0,Q=Bs.length;Re<Q;Re++)Ie.push(Bs[Re])}}this.tree.remove(ae)}return Ie}},{key:"_splitSafely",value:function(ce,ae){this.tree.remove(ce);var Ie=ce.rightSE;this.queue.remove(Ie);var ct=ce.split(ae);return ct.push(Ie),void 0===ce.consumedBy&&this.tree.insert(ce),ct}}]),_t}(),sr="undefined"!=typeof process&&process.env.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,In="undefined"!=typeof process&&process.env.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6,rn=new(function(){function _t(){gt(this,_t)}return De(_t,[{key:"run",value:function(ce,ae,Ie){rn.type=ce,be.reset();for(var ct=[new Ut(ae,!0)],Ot=0,Kt=Ie.length;Ot<Kt;Ot++)ct.push(new Ut(Ie[Ot],!1));if(rn.numMultiPolys=ct.length,"difference"===rn.type)for(var Yt=ct[0],wt=1;wt<ct.length;)null!==ue(ct[wt].bbox,Yt.bbox)?wt++:ct.splice(wt,1);if("intersection"===rn.type)for(var Qn=0,Er=ct.length;Qn<Er;Qn++)for(var Qt=ct[Qn],jn=Qn+1,ar=ct.length;jn<ar;jn++)if(null===ue(Qt.bbox,ct[jn].bbox))return[];for(var Vr=new Qe(Pe.compare),ei=0,So=ct.length;ei<So;ei++)for(var Mo=ct[ei].getSweepEvents(),jo=0,fi=Mo.length;jo<fi;jo++)if(Vr.insert(Mo[jo]),Vr.size>sr)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big). Please file a bug report.");for(var Xo=new hr(Vr),qi=Vr.size,fa=Vr.pop();fa;){var fo=fa.key;if(Vr.size===qi){var ln=fo.segment;throw new Error("Unable to pop() ".concat(fo.isLeft?"left":"right"," SweepEvent ")+"[".concat(fo.point.x,", ").concat(fo.point.y,"] from segment #").concat(ln.id," ")+"[".concat(ln.leftSE.point.x,", ").concat(ln.leftSE.point.y,"] -> ")+"[".concat(ln.rightSE.point.x,", ").concat(ln.rightSE.point.y,"] from queue. ")+"Please file a bug report.")}if(Vr.size>sr)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big). Please file a bug report.");if(Xo.segments.length>In)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments). Please file a bug report.");for(var al=Xo.process(fo),Fs=0,yr=al.length;Fs<yr;Fs++){var Bs=al[Fs];void 0===Bs.consumedBy&&Vr.insert(Bs)}qi=Vr.size,fa=Vr.pop()}be.reset();var Re=Sn.factory(Xo.segments);return new Mn(Re).getGeom()}}]),_t}());return{union:function(ve){for(var ce=arguments.length,ae=new Array(ce>1?ce-1:0),Ie=1;Ie<ce;Ie++)ae[Ie-1]=arguments[Ie];return rn.run("union",ve,ae)},intersection:function(ve){for(var ce=arguments.length,ae=new Array(ce>1?ce-1:0),Ie=1;Ie<ce;Ie++)ae[Ie-1]=arguments[Ie];return rn.run("intersection",ve,ae)},xor:function(ve){for(var ce=arguments.length,ae=new Array(ce>1?ce-1:0),Ie=1;Ie<ce;Ie++)ae[Ie-1]=arguments[Ie];return rn.run("xor",ve,ae)},difference:function(ve){for(var ce=arguments.length,ae=new Array(ce>1?ce-1:0),Ie=1;Ie<ce;Ie++)ae[Ie-1]=arguments[Ie];return rn.run("difference",ve,ae)}}}()},7729:(Zt,gt,Ue)=>{"use strict";Zt.exports=Be,Zt.exports.default=Be;var De=Ue(5749);function Be(ue,pe){if(!(this instanceof Be))return new Be(ue,pe);this._maxEntries=Math.max(4,ue||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),pe&&this._initFormat(pe),this.clear()}function pt(ue,pe,le){if(!le)return pe.indexOf(ue);for(var Ne=0;Ne<pe.length;Ne++)if(le(ue,pe[Ne]))return Ne;return-1}function x(ue,pe){ut(ue,0,ue.children.length,pe,ue)}function ut(ue,pe,le,Ne,he){he||(he=fe(null)),he.minX=1/0,he.minY=1/0,he.maxX=-1/0,he.maxY=-1/0;for(var be,me=pe;me<le;me++)be=ue.children[me],qe(he,ue.leaf?Ne(be):be);return he}function qe(ue,pe){return ue.minX=Math.min(ue.minX,pe.minX),ue.minY=Math.min(ue.minY,pe.minY),ue.maxX=Math.max(ue.maxX,pe.maxX),ue.maxY=Math.max(ue.maxY,pe.maxY),ue}function dt(ue,pe){return ue.minX-pe.minX}function Ge(ue,pe){return ue.minY-pe.minY}function Qe(ue){return(ue.maxX-ue.minX)*(ue.maxY-ue.minY)}function It(ue){return ue.maxX-ue.minX+(ue.maxY-ue.minY)}function kt(ue,pe){return(Math.max(pe.maxX,ue.maxX)-Math.min(pe.minX,ue.minX))*(Math.max(pe.maxY,ue.maxY)-Math.min(pe.minY,ue.minY))}function vt(ue,pe){var le=Math.max(ue.minX,pe.minX),Ne=Math.max(ue.minY,pe.minY),he=Math.min(ue.maxX,pe.maxX),me=Math.min(ue.maxY,pe.maxY);return Math.max(0,he-le)*Math.max(0,me-Ne)}function At(ue,pe){return ue.minX<=pe.minX&&ue.minY<=pe.minY&&pe.maxX<=ue.maxX&&pe.maxY<=ue.maxY}function an(ue,pe){return pe.minX<=ue.maxX&&pe.minY<=ue.maxY&&pe.maxX>=ue.minX&&pe.maxY>=ue.minY}function fe(ue){return{children:ue,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function Se(ue,pe,le,Ne,he){for(var be,me=[pe,le];me.length;)!((le=me.pop())-(pe=me.pop())<=Ne)&&(be=pe+Math.ceil((le-pe)/Ne/2)*Ne,De(ue,be,pe,le,he),me.push(pe,be,be,le))}Be.prototype={all:function(){return this._all(this.data,[])},search:function(ue){var pe=this.data,le=[],Ne=this.toBBox;if(!an(ue,pe))return le;for(var me,be,re,mt,he=[];pe;){for(me=0,be=pe.children.length;me<be;me++)re=pe.children[me],an(ue,mt=pe.leaf?Ne(re):re)&&(pe.leaf?le.push(re):At(ue,mt)?this._all(re,le):he.push(re));pe=he.pop()}return le},collides:function(ue){var pe=this.data,le=this.toBBox;if(!an(ue,pe))return!1;for(var he,me,be,re,Ne=[];pe;){for(he=0,me=pe.children.length;he<me;he++)if(be=pe.children[he],an(ue,re=pe.leaf?le(be):be)){if(pe.leaf||At(ue,re))return!0;Ne.push(be)}pe=Ne.pop()}return!1},load:function(ue){if(!ue||!ue.length)return this;if(ue.length<this._minEntries){for(var pe=0,le=ue.length;pe<le;pe++)this.insert(ue[pe]);return this}var Ne=this._build(ue.slice(),0,ue.length-1,0);if(this.data.children.length)if(this.data.height===Ne.height)this._splitRoot(this.data,Ne);else{if(this.data.height<Ne.height){var he=this.data;this.data=Ne,Ne=he}this._insert(Ne,this.data.height-Ne.height-1,!0)}else this.data=Ne;return this},insert:function(ue){return ue&&this._insert(ue,this.data.height-1),this},clear:function(){return this.data=fe([]),this},remove:function(ue,pe){if(!ue)return this;for(var be,re,mt,ze,le=this.data,Ne=this.toBBox(ue),he=[],me=[];le||he.length;){if(le||(le=he.pop(),re=he[he.length-1],be=me.pop(),ze=!0),le.leaf&&-1!==(mt=pt(ue,le.children,pe)))return le.children.splice(mt,1),he.push(le),this._condense(he),this;ze||le.leaf||!At(le,Ne)?re?(be++,le=re.children[be],ze=!1):le=null:(he.push(le),me.push(be),be=0,re=le,le=le.children[0])}return this},toBBox:function(ue){return ue},compareMinX:dt,compareMinY:Ge,toJSON:function(){return this.data},fromJSON:function(ue){return this.data=ue,this},_all:function(ue,pe){for(var le=[];ue;)ue.leaf?pe.push.apply(pe,ue.children):le.push.apply(le,ue.children),ue=le.pop();return pe},_build:function(ue,pe,le,Ne){var be,he=le-pe+1,me=this._maxEntries;if(he<=me)return x(be=fe(ue.slice(pe,le+1)),this.toBBox),be;Ne||(Ne=Math.ceil(Math.log(he)/Math.log(me)),me=Math.ceil(he/Math.pow(me,Ne-1))),(be=fe([])).leaf=!1,be.height=Ne;var ze,Oe,xe,jt,re=Math.ceil(he/me),mt=re*Math.ceil(Math.sqrt(me));for(Se(ue,pe,le,mt,this.compareMinX),ze=pe;ze<=le;ze+=mt)for(Se(ue,ze,xe=Math.min(ze+mt-1,le),re,this.compareMinY),Oe=ze;Oe<=xe;Oe+=re)jt=Math.min(Oe+re-1,xe),be.children.push(this._build(ue,Oe,jt,Ne-1));return x(be,this.toBBox),be},_chooseSubtree:function(ue,pe,le,Ne){for(var he,me,be,re,mt,ze,Oe,xe;Ne.push(pe),!pe.leaf&&Ne.length-1!==le;){for(Oe=xe=1/0,he=0,me=pe.children.length;he<me;he++)mt=Qe(be=pe.children[he]),(ze=kt(ue,be)-mt)<xe?(xe=ze,Oe=mt<Oe?mt:Oe,re=be):ze===xe&&mt<Oe&&(Oe=mt,re=be);pe=re||pe.children[0]}return pe},_insert:function(ue,pe,le){var he=le?ue:(0,this.toBBox)(ue),me=[],be=this._chooseSubtree(he,this.data,pe,me);for(be.children.push(ue),qe(be,he);pe>=0&&me[pe].children.length>this._maxEntries;)this._split(me,pe),pe--;this._adjustParentBBoxes(he,me,pe)},_split:function(ue,pe){var le=ue[pe],Ne=le.children.length,he=this._minEntries;this._chooseSplitAxis(le,he,Ne);var me=this._chooseSplitIndex(le,he,Ne),be=fe(le.children.splice(me,le.children.length-me));be.height=le.height,be.leaf=le.leaf,x(le,this.toBBox),x(be,this.toBBox),pe?ue[pe-1].children.push(be):this._splitRoot(le,be)},_splitRoot:function(ue,pe){this.data=fe([ue,pe]),this.data.height=ue.height+1,this.data.leaf=!1,x(this.data,this.toBBox)},_chooseSplitIndex:function(ue,pe,le){var Ne,he,me,be,re,mt,ze,Oe;for(mt=ze=1/0,Ne=pe;Ne<=le-pe;Ne++)be=vt(he=ut(ue,0,Ne,this.toBBox),me=ut(ue,Ne,le,this.toBBox)),re=Qe(he)+Qe(me),be<mt?(mt=be,Oe=Ne,ze=re<ze?re:ze):be===mt&&re<ze&&(ze=re,Oe=Ne);return Oe},_chooseSplitAxis:function(ue,pe,le){var Ne=ue.leaf?this.compareMinX:dt,he=ue.leaf?this.compareMinY:Ge;this._allDistMargin(ue,pe,le,Ne)<this._allDistMargin(ue,pe,le,he)&&ue.children.sort(Ne)},_allDistMargin:function(ue,pe,le,Ne){ue.children.sort(Ne);var mt,ze,he=this.toBBox,me=ut(ue,0,pe,he),be=ut(ue,le-pe,le,he),re=It(me)+It(be);for(mt=pe;mt<le-pe;mt++)ze=ue.children[mt],qe(me,ue.leaf?he(ze):ze),re+=It(me);for(mt=le-pe-1;mt>=pe;mt--)ze=ue.children[mt],qe(be,ue.leaf?he(ze):ze),re+=It(be);return re},_adjustParentBBoxes:function(ue,pe,le){for(var Ne=le;Ne>=0;Ne--)qe(pe[Ne],ue)},_condense:function(ue){for(var le,pe=ue.length-1;pe>=0;pe--)0===ue[pe].children.length?pe>0?(le=ue[pe-1].children).splice(le.indexOf(ue[pe]),1):this.clear():x(ue[pe],this.toBBox)},_initFormat:function(ue){var pe=["return a"," - b",";"];this.compareMinX=new Function("a","b",pe.join(ue[0])),this.compareMinY=new Function("a","b",pe.join(ue[1])),this.toBBox=new Function("a","return {minX: a"+ue[0]+", minY: a"+ue[1]+", maxX: a"+ue[2]+", maxY: a"+ue[3]+"};")}}},5749:function(Zt){Zt.exports=function(){"use strict";function Ue(pt,x,ut,qe,dt){for(;qe>ut;){if(qe-ut>600){var Ge=qe-ut+1,Qe=x-ut+1,It=Math.log(Ge),kt=.5*Math.exp(2*It/3),vt=.5*Math.sqrt(It*kt*(Ge-kt)/Ge)*(Qe-Ge/2<0?-1:1);Ue(pt,x,Math.max(ut,Math.floor(x-Qe*kt/Ge+vt)),Math.min(qe,Math.floor(x+(Ge-Qe)*kt/Ge+vt)),dt)}var fe=pt[x],Se=ut,ue=qe;for(De(pt,ut,x),dt(pt[qe],fe)>0&&De(pt,ut,qe);Se<ue;){for(De(pt,Se,ue),Se++,ue--;dt(pt[Se],fe)<0;)Se++;for(;dt(pt[ue],fe)>0;)ue--}0===dt(pt[ut],fe)?De(pt,ut,ue):De(pt,++ue,qe),ue<=x&&(ut=ue+1),x<=ue&&(qe=ue-1)}}function De(pt,x,ut){var qe=pt[x];pt[x]=pt[ut],pt[ut]=qe}function Be(pt,x){return pt<x?-1:pt>x?1:0}return function(pt,x,ut,qe,dt){Ue(pt,x,ut||0,qe||pt.length-1,dt||Be)}}()},565:Zt=>{"use strict";var gt=Object,Ue=TypeError;Zt.exports=function(){if(null!=this&&this!==gt(this))throw new Ue("RegExp.prototype.flags getter called on non-object");var Be="";return this.global&&(Be+="g"),this.ignoreCase&&(Be+="i"),this.multiline&&(Be+="m"),this.dotAll&&(Be+="s"),this.unicode&&(Be+="u"),this.sticky&&(Be+="y"),Be}},437:(Zt,gt,Ue)=>{"use strict";var De=Ue(6886),Be=Ue(44),pt=Ue(565),x=Ue(3880),ut=Ue(9129),qe=Be(pt);De(qe,{getPolyfill:x,implementation:pt,shim:ut}),Zt.exports=qe},3880:(Zt,gt,Ue)=>{"use strict";var De=Ue(565),Be=Ue(6886).supportsDescriptors,pt=Object.getOwnPropertyDescriptor,x=TypeError;Zt.exports=function(){if(!Be)throw new x("RegExp.prototype.flags requires a true ES5 environment that supports property descriptors");if("gim"===/a/gim.flags){var qe=pt(RegExp.prototype,"flags");if(qe&&"function"==typeof qe.get&&"boolean"==typeof/a/.dotAll)return qe.get}return De}},9129:(Zt,gt,Ue)=>{"use strict";var De=Ue(6886).supportsDescriptors,Be=Ue(3880),pt=Object.getOwnPropertyDescriptor,x=Object.defineProperty,ut=TypeError,qe=Object.getPrototypeOf,dt=/a/;Zt.exports=function(){if(!De||!qe)throw new ut("RegExp.prototype.flags requires a true ES5 environment that supports property descriptors");var Qe=Be(),It=qe(dt),kt=pt(It,"flags");return(!kt||kt.get!==Qe)&&x(It,"flags",{configurable:!0,enumerable:!1,get:Qe}),Qe}},5322:function(Zt,gt){!function(Ue){"use strict";const De=134217729;function pt(At,an,fe,Se,ue){let pe,le,Ne,he,me=an[0],be=Se[0],re=0,mt=0;be>me==be>-me?(pe=me,me=an[++re]):(pe=be,be=Se[++mt]);let ze=0;if(re<At&&mt<fe)for(be>me==be>-me?(Ne=pe-((le=me+pe)-me),me=an[++re]):(Ne=pe-((le=be+pe)-be),be=Se[++mt]),pe=le,0!==Ne&&(ue[ze++]=Ne);re<At&&mt<fe;)be>me==be>-me?(Ne=pe-((le=pe+me)-(he=le-pe))+(me-he),me=an[++re]):(Ne=pe-((le=pe+be)-(he=le-pe))+(be-he),be=Se[++mt]),pe=le,0!==Ne&&(ue[ze++]=Ne);for(;re<At;)Ne=pe-((le=pe+me)-(he=le-pe))+(me-he),me=an[++re],pe=le,0!==Ne&&(ue[ze++]=Ne);for(;mt<fe;)Ne=pe-((le=pe+be)-(he=le-pe))+(be-he),be=Se[++mt],pe=le,0!==Ne&&(ue[ze++]=Ne);return 0===pe&&0!==ze||(ue[ze++]=pe),ze}function x(At){return new Float64Array(At)}const Ge=x(4),Qe=x(8),It=x(12),kt=x(16),vt=x(4);Ue.orient2d=function(At,an,fe,Se,ue,pe){const le=(an-pe)*(fe-ue),Ne=(At-ue)*(Se-pe),he=le-Ne;if(0===le||0===Ne||le>0!=Ne>0)return he;const me=Math.abs(le+Ne);return Math.abs(he)>=33306690738754716e-32*me?he:-function(be,re,mt,ze,Oe,xe,jt){let Lt,Ce,ht,Pe,lt,Ke,Me,Ft,Ut,Sn,Gt,Mn,hr,sr,In,Vn,rn,hi;const nr=be-Oe,ai=mt-Oe,Qr=re-xe,eo=ze-xe;lt=(In=(Ft=nr-(Me=(Ke=De*nr)-(Ke-nr)))*(Sn=eo-(Ut=(Ke=De*eo)-(Ke-eo)))-((sr=nr*eo)-Me*Ut-Ft*Ut-Me*Sn))-(Gt=In-(rn=(Ft=Qr-(Me=(Ke=De*Qr)-(Ke-Qr)))*(Sn=ai-(Ut=(Ke=De*ai)-(Ke-ai)))-((Vn=Qr*ai)-Me*Ut-Ft*Ut-Me*Sn))),Ge[0]=In-(Gt+lt)+(lt-rn),lt=(hr=sr-((Mn=sr+Gt)-(lt=Mn-sr))+(Gt-lt))-(Gt=hr-Vn),Ge[1]=hr-(Gt+lt)+(lt-Vn),lt=(hi=Mn+Gt)-Mn,Ge[2]=Mn-(hi-lt)+(Gt-lt),Ge[3]=hi;let _t=function(ct,Ot){let Kt=Ot[0];for(let Yt=1;Yt<4;Yt++)Kt+=Ot[Yt];return Kt}(0,Ge),ve=22204460492503146e-32*jt;if(_t>=ve||-_t>=ve||(Lt=be-(nr+(lt=be-nr))+(lt-Oe),ht=mt-(ai+(lt=mt-ai))+(lt-Oe),Ce=re-(Qr+(lt=re-Qr))+(lt-xe),Pe=ze-(eo+(lt=ze-eo))+(lt-xe),0===Lt&&0===Ce&&0===ht&&0===Pe)||(ve=11093356479670487e-47*jt+33306690738754706e-32*Math.abs(_t),(_t+=nr*Pe+eo*Lt-(Qr*ht+ai*Ce))>=ve||-_t>=ve))return _t;lt=(In=(Ft=Lt-(Me=(Ke=De*Lt)-(Ke-Lt)))*(Sn=eo-(Ut=(Ke=De*eo)-(Ke-eo)))-((sr=Lt*eo)-Me*Ut-Ft*Ut-Me*Sn))-(Gt=In-(rn=(Ft=Ce-(Me=(Ke=De*Ce)-(Ke-Ce)))*(Sn=ai-(Ut=(Ke=De*ai)-(Ke-ai)))-((Vn=Ce*ai)-Me*Ut-Ft*Ut-Me*Sn))),vt[0]=In-(Gt+lt)+(lt-rn),lt=(hr=sr-((Mn=sr+Gt)-(lt=Mn-sr))+(Gt-lt))-(Gt=hr-Vn),vt[1]=hr-(Gt+lt)+(lt-Vn),lt=(hi=Mn+Gt)-Mn,vt[2]=Mn-(hi-lt)+(Gt-lt),vt[3]=hi;const ce=pt(4,Ge,4,vt,Qe);lt=(In=(Ft=nr-(Me=(Ke=De*nr)-(Ke-nr)))*(Sn=Pe-(Ut=(Ke=De*Pe)-(Ke-Pe)))-((sr=nr*Pe)-Me*Ut-Ft*Ut-Me*Sn))-(Gt=In-(rn=(Ft=Qr-(Me=(Ke=De*Qr)-(Ke-Qr)))*(Sn=ht-(Ut=(Ke=De*ht)-(Ke-ht)))-((Vn=Qr*ht)-Me*Ut-Ft*Ut-Me*Sn))),vt[0]=In-(Gt+lt)+(lt-rn),lt=(hr=sr-((Mn=sr+Gt)-(lt=Mn-sr))+(Gt-lt))-(Gt=hr-Vn),vt[1]=hr-(Gt+lt)+(lt-Vn),lt=(hi=Mn+Gt)-Mn,vt[2]=Mn-(hi-lt)+(Gt-lt),vt[3]=hi;const ae=pt(ce,Qe,4,vt,It);lt=(In=(Ft=Lt-(Me=(Ke=De*Lt)-(Ke-Lt)))*(Sn=Pe-(Ut=(Ke=De*Pe)-(Ke-Pe)))-((sr=Lt*Pe)-Me*Ut-Ft*Ut-Me*Sn))-(Gt=In-(rn=(Ft=Ce-(Me=(Ke=De*Ce)-(Ke-Ce)))*(Sn=ht-(Ut=(Ke=De*ht)-(Ke-ht)))-((Vn=Ce*ht)-Me*Ut-Ft*Ut-Me*Sn))),vt[0]=In-(Gt+lt)+(lt-rn),lt=(hr=sr-((Mn=sr+Gt)-(lt=Mn-sr))+(Gt-lt))-(Gt=hr-Vn),vt[1]=hr-(Gt+lt)+(lt-Vn),lt=(hi=Mn+Gt)-Mn,vt[2]=Mn-(hi-lt)+(Gt-lt),vt[3]=hi;const Ie=pt(ae,It,4,vt,kt);return kt[Ie-1]}(At,an,fe,Se,ue,pe,me)},Ue.orient2dfast=function(At,an,fe,Se,ue,pe){return(an-pe)*(fe-ue)-(At-ue)*(Se-pe)},Object.defineProperty(Ue,"__esModule",{value:!0})}(gt)},6257:Zt=>{"use strict";Zt.exports={eudist:function(Ue,De,Be){for(var pt=Ue.length,x=0,ut=0;ut<pt;ut++){var qe=(Ue[ut]||0)-(De[ut]||0);x+=qe*qe}return Be?Math.sqrt(x):x},mandist:function(Ue,De,Be){for(var pt=Ue.length,x=0,ut=0;ut<pt;ut++)x+=Math.abs((Ue[ut]||0)-(De[ut]||0));return Be?Math.sqrt(x):x},dist:function(Ue,De,Be){var pt=Math.abs(Ue-De);return Be?pt:pt*pt}}},6019:(Zt,gt,Ue)=>{"use strict";var De=Ue(6257),Be=De.eudist,pt=De.dist;Zt.exports={kmrand:function(ut,qe){for(var dt={},Ge=[],Qe=qe<<2,It=ut.length,kt=ut[0].length>0;Ge.length<qe&&Qe-- >0;){var vt=ut[Math.floor(Math.random()*It)],At=kt?vt.join("_"):""+vt;dt[At]||(dt[At]=!0,Ge.push(vt))}if(Ge.length<qe)throw new Error("Error initializating clusters");return Ge},kmpp:function(ut,qe){var dt=ut[0].length?Be:pt,Ge=[],Qe=ut.length,It=ut[0].length>0,vt=ut[Math.floor(Math.random()*Qe)];for(It&&vt.join("_"),Ge.push(vt);Ge.length<qe;){for(var an=[],fe=Ge.length,Se=0,ue=[],pe=0;pe<Qe;pe++){for(var le=1/0,Ne=0;Ne<fe;Ne++){var he=dt(ut[pe],Ge[Ne]);he<=le&&(le=he)}an[pe]=le}for(var me=0;me<Qe;me++)Se+=an[me];for(var be=0;be<Qe;be++)ue[be]={i:be,v:ut[be],pr:an[be]/Se,cs:0};ue.sort(function(Oe,xe){return Oe.pr-xe.pr}),ue[0].cs=ue[0].pr;for(var re=1;re<Qe;re++)ue[re].cs=ue[re-1].cs+ue[re].pr;for(var mt=Math.random(),ze=0;ze<Qe-1&&ue[ze++].cs<mt;);Ge.push(ue[ze-1].v)}return Ge}}},3212:(Zt,gt,Ue)=>{"use strict";var De=Ue(6257),Be=Ue(6019),pt=De.eudist,qe=Be.kmrand,dt=Be.kmpp;function Qe(kt,vt,At){At=At||[];for(var an=0;an<kt;an++)At[an]=vt;return At}Zt.exports=function(kt,vt,At,an){var fe=[],Se=[],ue=[],pe=[],le=!1,Ne=an||1e4,he=kt.length,me=kt[0].length,be=me>0,re=[];if(At)fe="kmrand"==At?qe(kt,vt):"kmpp"==At?dt(kt,vt):At;else for(var mt={};fe.length<vt;){var ze=Math.floor(Math.random()*he);mt[ze]||(mt[ze]=!0,fe.push(kt[ze]))}do{Qe(vt,0,re);for(var Oe=0;Oe<he;Oe++){for(var xe=1/0,jt=0,Lt=0;Lt<vt;Lt++)(pe=be?pt(kt[Oe],fe[Lt]):Math.abs(kt[Oe]-fe[Lt]))<=xe&&(xe=pe,jt=Lt);ue[Oe]=jt,re[jt]++}for(var Ce=[],Pe=(Se=[],0);Pe<vt;Pe++)Ce[Pe]=be?Qe(me,0,Ce[Pe]):0,Se[Pe]=fe[Pe];if(be){for(var lt=0;lt<vt;lt++)fe[lt]=[];for(var Ke=0;Ke<he;Ke++)for(var Ft=Ce[ue[Ke]],Ut=kt[Ke],Sn=0;Sn<me;Sn++)Ft[Sn]+=Ut[Sn];le=!0;for(var Gt=0;Gt<vt;Gt++){for(var Mn=fe[Gt],hr=Ce[Gt],sr=Se[Gt],In=re[Gt],Vn=0;Vn<me;Vn++)Mn[Vn]=hr[Vn]/In||0;if(le)for(var rn=0;rn<me;rn++)if(sr[rn]!=Mn[rn]){le=!1;break}}}else{for(var hi=0;hi<he;hi++)Ce[ue[hi]]+=kt[hi];for(var ai=0;ai<vt;ai++)fe[ai]=Ce[ai]/re[ai]||0;le=!0;for(var Qr=0;Qr<vt;Qr++)if(Se[Qr]!=fe[Qr]){le=!1;break}}le=le||--Ne<=0}while(!le);return{it:1e4-Ne,k:vt,idxs:ue,centroids:fe}}},54:(Zt,gt,Ue)=>{"use strict";Ue.r(gt),Ue.d(gt,{default:()=>De});class De{constructor(x=[],ut=Be){if(this.data=x,this.length=this.data.length,this.compare=ut,this.length>0)for(let qe=(this.length>>1)-1;qe>=0;qe--)this._down(qe)}push(x){this.data.push(x),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const x=this.data[0],ut=this.data.pop();return this.length--,this.length>0&&(this.data[0]=ut,this._down(0)),x}peek(){return this.data[0]}_up(x){const{data:ut,compare:qe}=this,dt=ut[x];for(;x>0;){const Ge=x-1>>1,Qe=ut[Ge];if(qe(dt,Qe)>=0)break;ut[x]=Qe,x=Ge}ut[x]=dt}_down(x){const{data:ut,compare:qe}=this,dt=this.length>>1,Ge=ut[x];for(;x<dt;){let Qe=1+(x<<1),It=ut[Qe];const kt=Qe+1;if(kt<this.length&&qe(ut[kt],It)<0&&(Qe=kt,It=ut[kt]),qe(It,Ge)>=0)break;ut[x]=It,x=Qe}ut[x]=Ge}}function Be(pt,x){return pt<x?-1:pt>x?1:0}},7299:function(Zt,gt){!function(Ue){"use strict";function De(){}function Be(l){this.message=l||""}function pt(l){this.message=l||""}function x(l){this.message=l||""}function ut(){}function qe(l){return null===l?bt:l.color}function dt(l){return null===l?null:l.parent}function Ge(l,d){null!==l&&(l.color=d)}function Qe(l){return null===l?null:l.left}function It(l){return null===l?null:l.right}function kt(){this.root_=null,this.size_=0}function vt(){}function At(){this.array_=[],arguments[0]instanceof qi&&this.addAll(arguments[0])}function an(){}function fe(l){this.message=l||""}function Se(){this.array_=[]}"fill"in Array.prototype||Object.defineProperty(Array.prototype,"fill",{configurable:!0,value:function(l){if(null==this)throw new TypeError(this+" is not an object");var d=Object(this),_=Math.max(Math.min(d.length,9007199254740991),0)||0,b=1 in arguments&&parseInt(Number(arguments[1]),10)||0;b=b<0?Math.max(_+b,0):Math.min(b,_);var I=2 in arguments&&void 0!==arguments[2]?parseInt(Number(arguments[2]),10)||0:_;for(I=I<0?Math.max(_+arguments[2],0):Math.min(I,_);b<I;)d[b]=l,++b;return d},writable:!0}),Number.isFinite=Number.isFinite||function(l){return"number"==typeof l&&isFinite(l)},Number.isInteger=Number.isInteger||function(l){return"number"==typeof l&&isFinite(l)&&Math.floor(l)===l},Number.parseFloat=Number.parseFloat||parseFloat,Number.isNaN=Number.isNaN||function(l){return l!=l},Math.trunc=Math.trunc||function(l){return l<0?Math.ceil(l):Math.floor(l)};var ue=function(){};ue.prototype.interfaces_=function(){return[]},ue.prototype.getClass=function(){return ue},ue.prototype.equalsWithTolerance=function(l,d,_){return Math.abs(l-d)<=_};var pe=function(l){function d(_){l.call(this,_),this.name="IllegalArgumentException",this.message=_,this.stack=(new l).stack}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d}(Error),le=function(){},Ne={MAX_VALUE:{configurable:!0}};le.isNaN=function(l){return Number.isNaN(l)},le.doubleToLongBits=function(l){return l},le.longBitsToDouble=function(l){return l},le.isInfinite=function(l){return!Number.isFinite(l)},Ne.MAX_VALUE.get=function(){return Number.MAX_VALUE},Object.defineProperties(le,Ne);var he=function(){},me=function(){},be=function(){},re=function l(){if(this.x=null,this.y=null,this.z=null,0===arguments.length)this.x=0,this.y=0,this.z=l.NULL_ORDINATE;else if(1===arguments.length){var d=arguments[0];this.x=d.x,this.y=d.y,this.z=d.z}else 2===arguments.length?(this.x=arguments[0],this.y=arguments[1],this.z=l.NULL_ORDINATE):3===arguments.length&&(this.x=arguments[0],this.y=arguments[1],this.z=arguments[2])},mt={DimensionalComparator:{configurable:!0},serialVersionUID:{configurable:!0},NULL_ORDINATE:{configurable:!0},X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0}};re.prototype.setOrdinate=function(l,d){switch(l){case re.X:this.x=d;break;case re.Y:this.y=d;break;case re.Z:this.z=d;break;default:throw new pe("Invalid ordinate index: "+l)}},re.prototype.equals2D=function(){if(1===arguments.length){var l=arguments[0];return this.x===l.x&&this.y===l.y}if(2===arguments.length){var d=arguments[0],_=arguments[1];return!!ue.equalsWithTolerance(this.x,d.x,_)&&!!ue.equalsWithTolerance(this.y,d.y,_)}},re.prototype.getOrdinate=function(l){switch(l){case re.X:return this.x;case re.Y:return this.y;case re.Z:return this.z}throw new pe("Invalid ordinate index: "+l)},re.prototype.equals3D=function(l){return this.x===l.x&&this.y===l.y&&(this.z===l.z||le.isNaN(this.z))&&le.isNaN(l.z)},re.prototype.equals=function(l){return l instanceof re&&this.equals2D(l)},re.prototype.equalInZ=function(l,d){return ue.equalsWithTolerance(this.z,l.z,d)},re.prototype.compareTo=function(l){return this.x<l.x?-1:this.x>l.x?1:this.y<l.y?-1:this.y>l.y?1:0},re.prototype.clone=function(){},re.prototype.copy=function(){return new re(this)},re.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+")"},re.prototype.distance3D=function(l){var d=this.x-l.x,_=this.y-l.y,b=this.z-l.z;return Math.sqrt(d*d+_*_+b*b)},re.prototype.distance=function(l){var d=this.x-l.x,_=this.y-l.y;return Math.sqrt(d*d+_*_)},re.prototype.hashCode=function(){var l=17;return 37*(l=37*l+re.hashCode(this.x))+re.hashCode(this.y)},re.prototype.setCoordinate=function(l){this.x=l.x,this.y=l.y,this.z=l.z},re.prototype.interfaces_=function(){return[he,me,De]},re.prototype.getClass=function(){return re},re.hashCode=function(){if(1===arguments.length){var d=le.doubleToLongBits(arguments[0]);return Math.trunc((d^d)>>>32)}},mt.DimensionalComparator.get=function(){return ze},mt.serialVersionUID.get=function(){return 0x5cbf2c235c7e5800},mt.NULL_ORDINATE.get=function(){return le.NaN},mt.X.get=function(){return 0},mt.Y.get=function(){return 1},mt.Z.get=function(){return 2},Object.defineProperties(re,mt);var ze=function(l){if(this._dimensionsToTest=2,0!==arguments.length&&1===arguments.length){var d=arguments[0];if(2!==d&&3!==d)throw new pe("only 2 or 3 dimensions may be specified");this._dimensionsToTest=d}};ze.prototype.compare=function(l,d){var _=l,b=d,I=ze.compare(_.x,b.x);if(0!==I)return I;var N=ze.compare(_.y,b.y);return 0!==N?N:this._dimensionsToTest<=2?0:ze.compare(_.z,b.z)},ze.prototype.interfaces_=function(){return[be]},ze.prototype.getClass=function(){return ze},ze.compare=function(l,d){return l<d?-1:l>d?1:le.isNaN(l)?le.isNaN(d)?0:-1:le.isNaN(d)?1:0};var Oe=function(){};Oe.prototype.create=function(){},Oe.prototype.interfaces_=function(){return[]},Oe.prototype.getClass=function(){return Oe};var xe=function(){},jt={INTERIOR:{configurable:!0},BOUNDARY:{configurable:!0},EXTERIOR:{configurable:!0},NONE:{configurable:!0}};xe.prototype.interfaces_=function(){return[]},xe.prototype.getClass=function(){return xe},xe.toLocationSymbol=function(l){switch(l){case xe.EXTERIOR:return"e";case xe.BOUNDARY:return"b";case xe.INTERIOR:return"i";case xe.NONE:return"-"}throw new pe("Unknown location value: "+l)},jt.INTERIOR.get=function(){return 0},jt.BOUNDARY.get=function(){return 1},jt.EXTERIOR.get=function(){return 2},jt.NONE.get=function(){return-1},Object.defineProperties(xe,jt);var Lt=function(l,d){return l.interfaces_&&l.interfaces_().indexOf(d)>-1},Ce=function(){},ht={LOG_10:{configurable:!0}};Ce.prototype.interfaces_=function(){return[]},Ce.prototype.getClass=function(){return Ce},Ce.log10=function(l){var d=Math.log(l);return le.isInfinite(d)||le.isNaN(d)?d:d/Ce.LOG_10},Ce.min=function(l,d,_,b){var I=l;return d<I&&(I=d),_<I&&(I=_),b<I&&(I=b),I},Ce.clamp=function(){if("number"==typeof arguments[2]&&"number"==typeof arguments[0]&&"number"==typeof arguments[1]){var l=arguments[0],d=arguments[1],_=arguments[2];return l<d?d:l>_?_:l}if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var b=arguments[0],I=arguments[1],N=arguments[2];return b<I?I:b>N?N:b}},Ce.wrap=function(l,d){return l<0?d- -l%d:l%d},Ce.max=function(){if(3===arguments.length){var d=arguments[1],_=arguments[2],b=arguments[0];return d>b&&(b=d),_>b&&(b=_),b}if(4===arguments.length){var N=arguments[1],j=arguments[2],ne=arguments[3],Ee=arguments[0];return N>Ee&&(Ee=N),j>Ee&&(Ee=j),ne>Ee&&(Ee=ne),Ee}},Ce.average=function(l,d){return(l+d)/2},ht.LOG_10.get=function(){return Math.log(10)},Object.defineProperties(Ce,ht);var Pe=function(l){this.str=l};Pe.prototype.append=function(l){this.str+=l},Pe.prototype.setCharAt=function(l,d){this.str=this.str.substr(0,l)+d+this.str.substr(l+1)},Pe.prototype.toString=function(l){return this.str};var lt=function(l){this.value=l};lt.prototype.intValue=function(){return this.value},lt.prototype.compareTo=function(l){return this.value<l?-1:this.value>l?1:0},lt.isNaN=function(l){return Number.isNaN(l)};var Ke=function(){};Ke.isWhitespace=function(l){return l<=32&&l>=0||127===l},Ke.toUpperCase=function(l){return l.toUpperCase()};var Me=function l(){this._hi=0,this._lo=0,0===arguments.length?this.init(0):1===arguments.length?"number"==typeof arguments[0]||arguments[0]instanceof l?this.init(arguments[0]):"string"==typeof arguments[0]&&l.call(this,l.parse(arguments[0])):2===arguments.length&&this.init(arguments[0],arguments[1])},Ft={PI:{configurable:!0},TWO_PI:{configurable:!0},PI_2:{configurable:!0},E:{configurable:!0},NaN:{configurable:!0},EPS:{configurable:!0},SPLIT:{configurable:!0},MAX_PRINT_DIGITS:{configurable:!0},TEN:{configurable:!0},ONE:{configurable:!0},SCI_NOT_EXPONENT_CHAR:{configurable:!0},SCI_NOT_ZERO:{configurable:!0}};Me.prototype.le=function(l){return(this._hi<l._hi||this._hi===l._hi)&&this._lo<=l._lo},Me.prototype.extractSignificantDigits=function(l,d){var _=this.abs(),b=Me.magnitude(_._hi),I=Me.TEN.pow(b);(_=_.divide(I)).gt(Me.TEN)?(_=_.divide(Me.TEN),b+=1):_.lt(Me.ONE)&&(_=_.multiply(Me.TEN),b-=1);for(var N=b+1,j=new Pe,ne=Me.MAX_PRINT_DIGITS-1,Ee=0;Ee<=ne;Ee++){l&&Ee===N&&j.append(".");var it=Math.trunc(_._hi);if(it<0)break;var Bt=!1,zt=0;it>9?(Bt=!0,zt="9"):zt="0"+it,j.append(zt),_=_.subtract(Me.valueOf(it)).multiply(Me.TEN),Bt&&_.selfAdd(Me.TEN);var vn=!0,pn=Me.magnitude(_._hi);if(pn<0&&Math.abs(pn)>=ne-Ee&&(vn=!1),!vn)break}return d[0]=b,j.toString()},Me.prototype.sqr=function(){return this.multiply(this)},Me.prototype.doubleValue=function(){return this._hi+this._lo},Me.prototype.subtract=function(){return arguments[0]instanceof Me?this.add(arguments[0].negate()):"number"==typeof arguments[0]?this.add(-arguments[0]):void 0},Me.prototype.equals=function(){if(1===arguments.length){var l=arguments[0];return this._hi===l._hi&&this._lo===l._lo}},Me.prototype.isZero=function(){return 0===this._hi&&0===this._lo},Me.prototype.selfSubtract=function(){if(arguments[0]instanceof Me){var l=arguments[0];return this.isNaN()?this:this.selfAdd(-l._hi,-l._lo)}if("number"==typeof arguments[0]){var d=arguments[0];return this.isNaN()?this:this.selfAdd(-d,0)}},Me.prototype.getSpecialNumberString=function(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null},Me.prototype.min=function(l){return this.le(l)?this:l},Me.prototype.selfDivide=function(){if(1===arguments.length){if(arguments[0]instanceof Me){var l=arguments[0];return this.selfDivide(l._hi,l._lo)}if("number"==typeof arguments[0])return this.selfDivide(arguments[0],0)}else if(2===arguments.length){var _=arguments[0],I=null,N=null,j=null,ne=null,Ee=null,it=null,Bt=null,zt=null;return this._hi=zt=(Ee=this._hi/_)+(it=(this._hi-(Bt=Ee*_)-(zt=(I=(it=Me.SPLIT*Ee)-(I=it-Ee))*(j=(zt=Me.SPLIT*_)-(j=zt-_))-Bt+I*(ne=_-j)+(N=Ee-I)*j+N*ne)+this._lo-Ee*arguments[1])/_),this._lo=Ee-zt+it,this}},Me.prototype.dump=function(){return"DD<"+this._hi+", "+this._lo+">"},Me.prototype.divide=function(){if(arguments[0]instanceof Me){var l=arguments[0],d=null,_=null,b=null,I=null,N=null,j=null,ne=null,Ee=null;return _=(N=this._hi/l._hi)-(d=(j=Me.SPLIT*N)-(d=j-N)),Ee=d*(b=(Ee=Me.SPLIT*l._hi)-(b=Ee-l._hi))-(ne=N*l._hi)+d*(I=l._hi-b)+_*b+_*I,new Me(Ee=N+(j=(this._hi-ne-Ee+this._lo-N*l._lo)/l._hi),N-Ee+j)}if("number"==typeof arguments[0]){var it=arguments[0];return le.isNaN(it)?Me.createNaN():Me.copy(this).selfDivide(it,0)}},Me.prototype.ge=function(l){return(this._hi>l._hi||this._hi===l._hi)&&this._lo>=l._lo},Me.prototype.pow=function(l){if(0===l)return Me.valueOf(1);var d=new Me(this),_=Me.valueOf(1),b=Math.abs(l);if(b>1)for(;b>0;)b%2==1&&_.selfMultiply(d),(b/=2)>0&&(d=d.sqr());else _=d;return l<0?_.reciprocal():_},Me.prototype.ceil=function(){if(this.isNaN())return Me.NaN;var l=Math.ceil(this._hi),d=0;return l===this._hi&&(d=Math.ceil(this._lo)),new Me(l,d)},Me.prototype.compareTo=function(l){return this._hi<l._hi?-1:this._hi>l._hi?1:this._lo<l._lo?-1:this._lo>l._lo?1:0},Me.prototype.rint=function(){return this.isNaN()?this:this.add(.5).floor()},Me.prototype.setValue=function(){return arguments[0]instanceof Me||"number"==typeof arguments[0]?(this.init(arguments[0]),this):void 0},Me.prototype.max=function(l){return this.ge(l)?this:l},Me.prototype.sqrt=function(){if(this.isZero())return Me.valueOf(0);if(this.isNegative())return Me.NaN;var l=1/Math.sqrt(this._hi),_=Me.valueOf(this._hi*l),b=this.subtract(_.sqr())._hi*(.5*l);return _.add(b)},Me.prototype.selfAdd=function(){if(1===arguments.length){if(arguments[0]instanceof Me){var l=arguments[0];return this.selfAdd(l._hi,l._lo)}if("number"==typeof arguments[0]){var d=arguments[0],_=null,b=null,I=null,j=null,ne=null;return this._hi=(_=(I=this._hi+d)+(ne=d-(j=I-this._hi)+(this._hi-(I-j))+this._lo))+(b=ne+(I-_)),this._lo=b+(_-this._hi),this}}else if(2===arguments.length){var Ee=arguments[0],it=arguments[1],Bt=null,zt=null,vn=null,pn=null,Pn=null,rr=null,C=null;Pn=(pn=this._hi+Ee)-(rr=pn-this._hi),vn=(zt=this._lo+it)-(C=zt-this._lo);var c=(Bt=pn+(rr=(Pn=Ee-rr+(this._hi-Pn))+zt))+(rr=(vn=it-C+(this._lo-vn))+(rr+(pn-Bt))),y=rr+(Bt-c);return this._hi=c,this._lo=y,this}},Me.prototype.selfMultiply=function(){if(1===arguments.length){if(arguments[0]instanceof Me){var l=arguments[0];return this.selfMultiply(l._hi,l._lo)}if("number"==typeof arguments[0])return this.selfMultiply(arguments[0],0)}else if(2===arguments.length){var _=arguments[0],I=null,N=null,j=null,ne=null,Ee=null,it=null;I=(Ee=Me.SPLIT*this._hi)-this._hi,I=Ee-I;var Bt=(Ee=this._hi*_)+(it=I*(j=(it=Me.SPLIT*_)-(j=it-_))-Ee+I*(ne=_-j)+(N=this._hi-I)*j+N*ne+(this._hi*arguments[1]+this._lo*_)),zt=it+(I=Ee-Bt);return this._hi=Bt,this._lo=zt,this}},Me.prototype.selfSqr=function(){return this.selfMultiply(this)},Me.prototype.floor=function(){if(this.isNaN())return Me.NaN;var l=Math.floor(this._hi),d=0;return l===this._hi&&(d=Math.floor(this._lo)),new Me(l,d)},Me.prototype.negate=function(){return this.isNaN()?this:new Me(-this._hi,-this._lo)},Me.prototype.clone=function(){},Me.prototype.multiply=function(){if(arguments[0]instanceof Me){var l=arguments[0];return l.isNaN()?Me.createNaN():Me.copy(this).selfMultiply(l)}if("number"==typeof arguments[0]){var d=arguments[0];return le.isNaN(d)?Me.createNaN():Me.copy(this).selfMultiply(d,0)}},Me.prototype.isNaN=function(){return le.isNaN(this._hi)},Me.prototype.intValue=function(){return Math.trunc(this._hi)},Me.prototype.toString=function(){var l=Me.magnitude(this._hi);return l>=-3&&l<=20?this.toStandardNotation():this.toSciNotation()},Me.prototype.toStandardNotation=function(){var l=this.getSpecialNumberString();if(null!==l)return l;var d=new Array(1).fill(null),_=this.extractSignificantDigits(!0,d),b=d[0]+1,I=_;return"."===_.charAt(0)?I="0"+_:b<0?I="0."+Me.stringOfChar("0",-b)+_:-1===_.indexOf(".")&&(I=_+Me.stringOfChar("0",b-_.length)+".0"),this.isNegative()?"-"+I:I},Me.prototype.reciprocal=function(){var d,b,I,j,l=null,_=null,N=null,ne=null;d=(I=1/this._hi)-(l=(N=Me.SPLIT*I)-(l=N-I)),_=(ne=Me.SPLIT*this._hi)-this._hi;var Ee=I+(N=(1-(j=I*this._hi)-(ne=l*(_=ne-_)-j+l*(b=this._hi-_)+d*_+d*b)-I*this._lo)/this._hi);return new Me(Ee,I-Ee+N)},Me.prototype.toSciNotation=function(){if(this.isZero())return Me.SCI_NOT_ZERO;var l=this.getSpecialNumberString();if(null!==l)return l;var d=new Array(1).fill(null),_=this.extractSignificantDigits(!1,d),b=Me.SCI_NOT_EXPONENT_CHAR+d[0];if("0"===_.charAt(0))throw new Error("Found leading zero: "+_);var I="";_.length>1&&(I=_.substring(1));var N=_.charAt(0)+"."+I;return this.isNegative()?"-"+N+b:N+b},Me.prototype.abs=function(){return this.isNaN()?Me.NaN:this.isNegative()?this.negate():new Me(this)},Me.prototype.isPositive=function(){return(this._hi>0||0===this._hi)&&this._lo>0},Me.prototype.lt=function(l){return(this._hi<l._hi||this._hi===l._hi)&&this._lo<l._lo},Me.prototype.add=function(){if(arguments[0]instanceof Me){var l=arguments[0];return Me.copy(this).selfAdd(l)}if("number"==typeof arguments[0]){var d=arguments[0];return Me.copy(this).selfAdd(d)}},Me.prototype.init=function(){if(1===arguments.length){if("number"==typeof arguments[0])this._hi=arguments[0],this._lo=0;else if(arguments[0]instanceof Me){var d=arguments[0];this._hi=d._hi,this._lo=d._lo}}else if(2===arguments.length){var b=arguments[1];this._hi=arguments[0],this._lo=b}},Me.prototype.gt=function(l){return(this._hi>l._hi||this._hi===l._hi)&&this._lo>l._lo},Me.prototype.isNegative=function(){return(this._hi<0||0===this._hi)&&this._lo<0},Me.prototype.trunc=function(){return this.isNaN()?Me.NaN:this.isPositive()?this.floor():this.ceil()},Me.prototype.signum=function(){return this._hi>0?1:this._hi<0?-1:this._lo>0?1:this._lo<0?-1:0},Me.prototype.interfaces_=function(){return[De,he,me]},Me.prototype.getClass=function(){return Me},Me.sqr=function(l){return Me.valueOf(l).selfMultiply(l)},Me.valueOf=function(){return"string"==typeof arguments[0]?Me.parse(arguments[0]):"number"==typeof arguments[0]?new Me(arguments[0]):void 0},Me.sqrt=function(l){return Me.valueOf(l).sqrt()},Me.parse=function(l){for(var d=0,_=l.length;Ke.isWhitespace(l.charAt(d));)d++;var b=!1;if(d<_){var I=l.charAt(d);"-"!==I&&"+"!==I||(d++,"-"===I&&(b=!0))}for(var N=new Me,j=0,ne=0,Ee=0;!(d>=_);){var it=l.charAt(d);if(d++,Ke.isDigit(it)){var Bt=it-"0";N.selfMultiply(Me.TEN),N.selfAdd(Bt),j++}else{if("."!==it){if("e"===it||"E"===it){var zt=l.substring(d);try{Ee=lt.parseInt(zt)}catch(C){throw C instanceof Error?new Error("Invalid exponent "+zt+" in string "+l):C}break}throw new Error("Unexpected character '"+it+"' at position "+d+" in string "+l)}ne=j}}var vn=N,pn=j-ne-Ee;if(0===pn)vn=N;else if(pn>0){var Pn=Me.TEN.pow(pn);vn=N.divide(Pn)}else if(pn<0){var rr=Me.TEN.pow(-pn);vn=N.multiply(rr)}return b?vn.negate():vn},Me.createNaN=function(){return new Me(le.NaN,le.NaN)},Me.copy=function(l){return new Me(l)},Me.magnitude=function(l){var d=Math.abs(l),_=Math.log(d)/Math.log(10),b=Math.trunc(Math.floor(_));return 10*Math.pow(10,b)<=d&&(b+=1),b},Me.stringOfChar=function(l,d){for(var _=new Pe,b=0;b<d;b++)_.append(l);return _.toString()},Ft.PI.get=function(){return new Me(3.141592653589793,12246467991473532e-32)},Ft.TWO_PI.get=function(){return new Me(6.283185307179586,24492935982947064e-32)},Ft.PI_2.get=function(){return new Me(1.5707963267948966,6123233995736766e-32)},Ft.E.get=function(){return new Me(2.718281828459045,14456468917292502e-32)},Ft.NaN.get=function(){return new Me(le.NaN,le.NaN)},Ft.EPS.get=function(){return 123259516440783e-46},Ft.SPLIT.get=function(){return 134217729},Ft.MAX_PRINT_DIGITS.get=function(){return 32},Ft.TEN.get=function(){return Me.valueOf(10)},Ft.ONE.get=function(){return Me.valueOf(1)},Ft.SCI_NOT_EXPONENT_CHAR.get=function(){return"E"},Ft.SCI_NOT_ZERO.get=function(){return"0.0E0"},Object.defineProperties(Me,Ft);var Ut=function(){},Sn={DP_SAFE_EPSILON:{configurable:!0}};Ut.prototype.interfaces_=function(){return[]},Ut.prototype.getClass=function(){return Ut},Ut.orientationIndex=function(l,d,_){var b=Ut.orientationIndexFilter(l,d,_);if(b<=1)return b;var I=Me.valueOf(d.x).selfAdd(-l.x),N=Me.valueOf(d.y).selfAdd(-l.y),j=Me.valueOf(_.x).selfAdd(-d.x),ne=Me.valueOf(_.y).selfAdd(-d.y);return I.selfMultiply(ne).selfSubtract(N.selfMultiply(j)).signum()},Ut.signOfDet2x2=function(l,d,_,b){return l.multiply(b).selfSubtract(d.multiply(_)).signum()},Ut.intersection=function(l,d,_,b){var I=Me.valueOf(b.y).selfSubtract(_.y).selfMultiply(Me.valueOf(d.x).selfSubtract(l.x)),N=Me.valueOf(b.x).selfSubtract(_.x).selfMultiply(Me.valueOf(d.y).selfSubtract(l.y)),j=I.subtract(N),ne=Me.valueOf(b.x).selfSubtract(_.x).selfMultiply(Me.valueOf(l.y).selfSubtract(_.y)),Ee=Me.valueOf(b.y).selfSubtract(_.y).selfMultiply(Me.valueOf(l.x).selfSubtract(_.x)),it=ne.subtract(Ee).selfDivide(j).doubleValue(),Bt=Me.valueOf(l.x).selfAdd(Me.valueOf(d.x).selfSubtract(l.x).selfMultiply(it)).doubleValue(),zt=Me.valueOf(d.x).selfSubtract(l.x).selfMultiply(Me.valueOf(l.y).selfSubtract(_.y)),vn=Me.valueOf(d.y).selfSubtract(l.y).selfMultiply(Me.valueOf(l.x).selfSubtract(_.x)),pn=zt.subtract(vn).selfDivide(j).doubleValue(),Pn=Me.valueOf(_.y).selfAdd(Me.valueOf(b.y).selfSubtract(_.y).selfMultiply(pn)).doubleValue();return new re(Bt,Pn)},Ut.orientationIndexFilter=function(l,d,_){var b=null,I=(l.x-_.x)*(d.y-_.y),N=(l.y-_.y)*(d.x-_.x),j=I-N;if(I>0){if(N<=0)return Ut.signum(j);b=I+N}else{if(!(I<0)||N>=0)return Ut.signum(j);b=-I-N}var ne=Ut.DP_SAFE_EPSILON*b;return j>=ne||-j>=ne?Ut.signum(j):2},Ut.signum=function(l){return l>0?1:l<0?-1:0},Sn.DP_SAFE_EPSILON.get=function(){return 1e-15},Object.defineProperties(Ut,Sn);var Gt=function(){},Mn={X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0},M:{configurable:!0}};Mn.X.get=function(){return 0},Mn.Y.get=function(){return 1},Mn.Z.get=function(){return 2},Mn.M.get=function(){return 3},Gt.prototype.setOrdinate=function(l,d,_){},Gt.prototype.size=function(){},Gt.prototype.getOrdinate=function(l,d){},Gt.prototype.getCoordinate=function(){},Gt.prototype.getCoordinateCopy=function(l){},Gt.prototype.getDimension=function(){},Gt.prototype.getX=function(l){},Gt.prototype.clone=function(){},Gt.prototype.expandEnvelope=function(l){},Gt.prototype.copy=function(){},Gt.prototype.getY=function(l){},Gt.prototype.toCoordinateArray=function(){},Gt.prototype.interfaces_=function(){return[me]},Gt.prototype.getClass=function(){return Gt},Object.defineProperties(Gt,Mn);var hr=function(){},sr=function(l){function d(){l.call(this,"Projective point not representable on the Cartesian plane.")}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.interfaces_=function(){return[]},d.prototype.getClass=function(){return d},d}(hr),In=function(){};In.arraycopy=function(l,d,_,b,I){for(var N=0,j=d;j<d+I;j++)_[b+N]=l[j],N++},In.getProperty=function(l){return{"line.separator":"\n"}[l]};var Vn=function l(){if(this.x=null,this.y=null,this.w=null,0===arguments.length)this.x=0,this.y=0,this.w=1;else if(1===arguments.length){var d=arguments[0];this.x=d.x,this.y=d.y,this.w=1}else if(2===arguments.length){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var b=arguments[1];this.x=arguments[0],this.y=b,this.w=1}else if(arguments[0]instanceof l&&arguments[1]instanceof l){var I=arguments[0],N=arguments[1];this.x=I.y*N.w-N.y*I.w,this.y=N.x*I.w-I.x*N.w,this.w=I.x*N.y-N.x*I.y}else if(arguments[0]instanceof re&&arguments[1]instanceof re){var j=arguments[0],ne=arguments[1];this.x=j.y-ne.y,this.y=ne.x-j.x,this.w=j.x*ne.y-ne.x*j.y}}else if(3===arguments.length){var it=arguments[1],Bt=arguments[2];this.x=arguments[0],this.y=it,this.w=Bt}else if(4===arguments.length){var zt=arguments[0],vn=arguments[1],pn=arguments[2],Pn=arguments[3],rr=zt.y-vn.y,C=vn.x-zt.x,c=zt.x*vn.y-vn.x*zt.y,y=pn.y-Pn.y,S=Pn.x-pn.x,P=pn.x*Pn.y-Pn.x*pn.y;this.x=C*P-S*c,this.y=y*c-rr*P,this.w=rr*S-y*C}};Vn.prototype.getY=function(){var l=this.y/this.w;if(le.isNaN(l)||le.isInfinite(l))throw new sr;return l},Vn.prototype.getX=function(){var l=this.x/this.w;if(le.isNaN(l)||le.isInfinite(l))throw new sr;return l},Vn.prototype.getCoordinate=function(){var l=new re;return l.x=this.getX(),l.y=this.getY(),l},Vn.prototype.interfaces_=function(){return[]},Vn.prototype.getClass=function(){return Vn},Vn.intersection=function(l,d,_,b){var I=l.y-d.y,N=d.x-l.x,j=l.x*d.y-d.x*l.y,ne=_.y-b.y,Ee=b.x-_.x,it=_.x*b.y-b.x*_.y,Bt=I*Ee-ne*N,zt=(N*it-Ee*j)/Bt,vn=(ne*j-I*it)/Bt;if(le.isNaN(zt)||le.isInfinite(zt)||le.isNaN(vn)||le.isInfinite(vn))throw new sr;return new re(zt,vn)};var rn=function l(){if(this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,0===arguments.length)this.init();else if(1===arguments.length)if(arguments[0]instanceof re){var d=arguments[0];this.init(d.x,d.x,d.y,d.y)}else arguments[0]instanceof l&&this.init(arguments[0]);else if(2===arguments.length){var b=arguments[0],I=arguments[1];this.init(b.x,I.x,b.y,I.y)}else 4===arguments.length&&this.init(arguments[0],arguments[1],arguments[2],arguments[3])},hi={serialVersionUID:{configurable:!0}};rn.prototype.getArea=function(){return this.getWidth()*this.getHeight()},rn.prototype.equals=function(l){if(!(l instanceof rn))return!1;var d=l;return this.isNull()?d.isNull():this._maxx===d.getMaxX()&&this._maxy===d.getMaxY()&&this._minx===d.getMinX()&&this._miny===d.getMinY()},rn.prototype.intersection=function(l){return this.isNull()||l.isNull()||!this.intersects(l)?new rn:new rn(this._minx>l._minx?this._minx:l._minx,this._maxx<l._maxx?this._maxx:l._maxx,this._miny>l._miny?this._miny:l._miny,this._maxy<l._maxy?this._maxy:l._maxy)},rn.prototype.isNull=function(){return this._maxx<this._minx},rn.prototype.getMaxX=function(){return this._maxx},rn.prototype.covers=function(){if(1===arguments.length){if(arguments[0]instanceof re){var l=arguments[0];return this.covers(l.x,l.y)}if(arguments[0]instanceof rn){var d=arguments[0];return!this.isNull()&&!d.isNull()&&d.getMinX()>=this._minx&&d.getMaxX()<=this._maxx&&d.getMinY()>=this._miny&&d.getMaxY()<=this._maxy}}else if(2===arguments.length){var _=arguments[0],b=arguments[1];return!this.isNull()&&_>=this._minx&&_<=this._maxx&&b>=this._miny&&b<=this._maxy}},rn.prototype.intersects=function(){if(1===arguments.length){if(arguments[0]instanceof rn){var l=arguments[0];return!this.isNull()&&!l.isNull()&&!(l._minx>this._maxx||l._maxx<this._minx||l._miny>this._maxy||l._maxy<this._miny)}if(arguments[0]instanceof re){var d=arguments[0];return this.intersects(d.x,d.y)}}else if(2===arguments.length){var _=arguments[0],b=arguments[1];return!this.isNull()&&!(_>this._maxx||_<this._minx||b>this._maxy||b<this._miny)}},rn.prototype.getMinY=function(){return this._miny},rn.prototype.getMinX=function(){return this._minx},rn.prototype.expandToInclude=function(){if(1===arguments.length){if(arguments[0]instanceof re){var l=arguments[0];this.expandToInclude(l.x,l.y)}else if(arguments[0]instanceof rn){var d=arguments[0];if(d.isNull())return null;this.isNull()?(this._minx=d.getMinX(),this._maxx=d.getMaxX(),this._miny=d.getMinY(),this._maxy=d.getMaxY()):(d._minx<this._minx&&(this._minx=d._minx),d._maxx>this._maxx&&(this._maxx=d._maxx),d._miny<this._miny&&(this._miny=d._miny),d._maxy>this._maxy&&(this._maxy=d._maxy))}}else if(2===arguments.length){var _=arguments[0],b=arguments[1];this.isNull()?(this._minx=_,this._maxx=_,this._miny=b,this._maxy=b):(_<this._minx&&(this._minx=_),_>this._maxx&&(this._maxx=_),b<this._miny&&(this._miny=b),b>this._maxy&&(this._maxy=b))}},rn.prototype.minExtent=function(){if(this.isNull())return 0;var l=this.getWidth(),d=this.getHeight();return l<d?l:d},rn.prototype.getWidth=function(){return this.isNull()?0:this._maxx-this._minx},rn.prototype.compareTo=function(l){var d=l;return this.isNull()?d.isNull()?0:-1:d.isNull()?1:this._minx<d._minx?-1:this._minx>d._minx?1:this._miny<d._miny?-1:this._miny>d._miny?1:this._maxx<d._maxx?-1:this._maxx>d._maxx?1:this._maxy<d._maxy?-1:this._maxy>d._maxy?1:0},rn.prototype.translate=function(l,d){if(this.isNull())return null;this.init(this.getMinX()+l,this.getMaxX()+l,this.getMinY()+d,this.getMaxY()+d)},rn.prototype.toString=function(){return"Env["+this._minx+" : "+this._maxx+", "+this._miny+" : "+this._maxy+"]"},rn.prototype.setToNull=function(){this._minx=0,this._maxx=-1,this._miny=0,this._maxy=-1},rn.prototype.getHeight=function(){return this.isNull()?0:this._maxy-this._miny},rn.prototype.maxExtent=function(){if(this.isNull())return 0;var l=this.getWidth(),d=this.getHeight();return l>d?l:d},rn.prototype.expandBy=function(){if(1===arguments.length){var l=arguments[0];this.expandBy(l,l)}else if(2===arguments.length){var d=arguments[0],_=arguments[1];if(this.isNull())return null;this._minx-=d,this._maxx+=d,this._miny-=_,this._maxy+=_,(this._minx>this._maxx||this._miny>this._maxy)&&this.setToNull()}},rn.prototype.contains=function(){if(1===arguments.length){if(arguments[0]instanceof rn)return this.covers(arguments[0]);if(arguments[0]instanceof re)return this.covers(arguments[0])}else if(2===arguments.length)return this.covers(arguments[0],arguments[1])},rn.prototype.centre=function(){return this.isNull()?null:new re((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)},rn.prototype.init=function(){if(0===arguments.length)this.setToNull();else if(1===arguments.length){if(arguments[0]instanceof re){var l=arguments[0];this.init(l.x,l.x,l.y,l.y)}else if(arguments[0]instanceof rn){var d=arguments[0];this._minx=d._minx,this._maxx=d._maxx,this._miny=d._miny,this._maxy=d._maxy}}else if(2===arguments.length){var _=arguments[0],b=arguments[1];this.init(_.x,b.x,_.y,b.y)}else if(4===arguments.length){var I=arguments[0],N=arguments[1],j=arguments[2],ne=arguments[3];I<N?(this._minx=I,this._maxx=N):(this._minx=N,this._maxx=I),j<ne?(this._miny=j,this._maxy=ne):(this._miny=ne,this._maxy=j)}},rn.prototype.getMaxY=function(){return this._maxy},rn.prototype.distance=function(l){if(this.intersects(l))return 0;var d=0;this._maxx<l._minx?d=l._minx-this._maxx:this._minx>l._maxx&&(d=this._minx-l._maxx);var _=0;return this._maxy<l._miny?_=l._miny-this._maxy:this._miny>l._maxy&&(_=this._miny-l._maxy),0===d?_:0===_?d:Math.sqrt(d*d+_*_)},rn.prototype.hashCode=function(){var l=17;return 37*(l=37*(l=37*(l=37*l+re.hashCode(this._minx))+re.hashCode(this._maxx))+re.hashCode(this._miny))+re.hashCode(this._maxy)},rn.prototype.interfaces_=function(){return[he,De]},rn.prototype.getClass=function(){return rn},rn.intersects=function(){if(3===arguments.length){var l=arguments[0],d=arguments[1],_=arguments[2];return _.x>=(l.x<d.x?l.x:d.x)&&_.x<=(l.x>d.x?l.x:d.x)&&_.y>=(l.y<d.y?l.y:d.y)&&_.y<=(l.y>d.y?l.y:d.y)}if(4===arguments.length){var b=arguments[0],I=arguments[1],N=arguments[2],j=arguments[3],ne=Math.min(N.x,j.x),Ee=Math.max(N.x,j.x),it=Math.min(b.x,I.x),Bt=Math.max(b.x,I.x);return!(it>Ee||Bt<ne||(ne=Math.min(N.y,j.y),Ee=Math.max(N.y,j.y),it=Math.min(b.y,I.y),Bt=Math.max(b.y,I.y),it>Ee||Bt<ne))}},hi.serialVersionUID.get=function(){return 0x51845cd552189800},Object.defineProperties(rn,hi);var nr={typeStr:/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,emptyTypeStr:/^\s*(\w+)\s*EMPTY\s*$/,spaces:/\s+/,parenComma:/\)\s*,\s*\(/,doubleParenComma:/\)\s*\)\s*,\s*\(\s*\(/,trimParens:/^\s*\(?(.*?)\)?\s*$/},ai=function(l){this.geometryFactory=l||new fr};ai.prototype.read=function(l){var d,_;l=l.replace(/[\n\r]/g," ");var I=nr.typeStr.exec(l);if(-1!==l.search("EMPTY")&&((I=nr.emptyTypeStr.exec(l))[2]=void 0),I&&(_=I[1].toLowerCase(),eo[_]&&(d=eo[_].apply(this,[I[2]]))),void 0===d)throw new Error("Could not parse WKT "+l);return d},ai.prototype.write=function(l){return this.extractGeometry(l)},ai.prototype.extractGeometry=function(l){var d=l.getGeometryType().toLowerCase();if(!Qr[d])return null;var _=d.toUpperCase();return l.isEmpty()?_+" EMPTY":_+"("+Qr[d].apply(this,[l])+")"};var Qr={coordinate:function(l){return l.x+" "+l.y},point:function(l){return Qr.coordinate.call(this,l._coordinates._coordinates[0])},multipoint:function(l){for(var d=[],_=0,b=l._geometries.length;_<b;++_)d.push("("+Qr.point.apply(this,[l._geometries[_]])+")");return d.join(",")},linestring:function(l){for(var d=[],_=0,b=l._points._coordinates.length;_<b;++_)d.push(Qr.coordinate.apply(this,[l._points._coordinates[_]]));return d.join(",")},linearring:function(l){for(var d=[],_=0,b=l._points._coordinates.length;_<b;++_)d.push(Qr.coordinate.apply(this,[l._points._coordinates[_]]));return d.join(",")},multilinestring:function(l){for(var d=[],_=0,b=l._geometries.length;_<b;++_)d.push("("+Qr.linestring.apply(this,[l._geometries[_]])+")");return d.join(",")},polygon:function(l){var d=[];d.push("("+Qr.linestring.apply(this,[l._shell])+")");for(var _=0,b=l._holes.length;_<b;++_)d.push("("+Qr.linestring.apply(this,[l._holes[_]])+")");return d.join(",")},multipolygon:function(l){for(var d=[],_=0,b=l._geometries.length;_<b;++_)d.push("("+Qr.polygon.apply(this,[l._geometries[_]])+")");return d.join(",")},geometrycollection:function(l){for(var d=[],_=0,b=l._geometries.length;_<b;++_)d.push(this.extractGeometry(l._geometries[_]));return d.join(",")}},eo={point:function(l){if(void 0===l)return this.geometryFactory.createPoint();var d=l.trim().split(nr.spaces);return this.geometryFactory.createPoint(new re(Number.parseFloat(d[0]),Number.parseFloat(d[1])))},multipoint:function(l){if(void 0===l)return this.geometryFactory.createMultiPoint();for(var d,_=l.trim().split(","),b=[],I=0,N=_.length;I<N;++I)d=_[I].replace(nr.trimParens,"$1"),b.push(eo.point.apply(this,[d]));return this.geometryFactory.createMultiPoint(b)},linestring:function(l){if(void 0===l)return this.geometryFactory.createLineString();for(var d,_=l.trim().split(","),b=[],I=0,N=_.length;I<N;++I)d=_[I].trim().split(nr.spaces),b.push(new re(Number.parseFloat(d[0]),Number.parseFloat(d[1])));return this.geometryFactory.createLineString(b)},linearring:function(l){if(void 0===l)return this.geometryFactory.createLinearRing();for(var d,_=l.trim().split(","),b=[],I=0,N=_.length;I<N;++I)d=_[I].trim().split(nr.spaces),b.push(new re(Number.parseFloat(d[0]),Number.parseFloat(d[1])));return this.geometryFactory.createLinearRing(b)},multilinestring:function(l){if(void 0===l)return this.geometryFactory.createMultiLineString();for(var d,_=l.trim().split(nr.parenComma),b=[],I=0,N=_.length;I<N;++I)d=_[I].replace(nr.trimParens,"$1"),b.push(eo.linestring.apply(this,[d]));return this.geometryFactory.createMultiLineString(b)},polygon:function(l){if(void 0===l)return this.geometryFactory.createPolygon();for(var d,_,b,I,N=l.trim().split(nr.parenComma),j=[],ne=0,Ee=N.length;ne<Ee;++ne)d=N[ne].replace(nr.trimParens,"$1"),_=eo.linestring.apply(this,[d]),b=this.geometryFactory.createLinearRing(_._points),0===ne?I=b:j.push(b);return this.geometryFactory.createPolygon(I,j)},multipolygon:function(l){if(void 0===l)return this.geometryFactory.createMultiPolygon();for(var d,_=l.trim().split(nr.doubleParenComma),b=[],I=0,N=_.length;I<N;++I)d=_[I].replace(nr.trimParens,"$1"),b.push(eo.polygon.apply(this,[d]));return this.geometryFactory.createMultiPolygon(b)},geometrycollection:function(l){if(void 0===l)return this.geometryFactory.createGeometryCollection();for(var d=(l=l.replace(/,\s*([A-Za-z])/g,"|$1")).trim().split("|"),_=[],b=0,I=d.length;b<I;++b)_.push(this.read(d[b]));return this.geometryFactory.createGeometryCollection(_)}},_t=function(l){this.parser=new ai(l)};_t.prototype.write=function(l){return this.parser.write(l)},_t.toLineString=function(l,d){if(2!==arguments.length)throw new Error("Not implemented");return"LINESTRING ( "+l.x+" "+l.y+", "+d.x+" "+d.y+" )"};var ve=function(l){function d(_){l.call(this,_),this.name="RuntimeException",this.message=_,this.stack=(new l).stack}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d}(Error),ce=function(l){function d(){l.call(this),0===arguments.length?l.call(this):1===arguments.length&&l.call(this,arguments[0])}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.interfaces_=function(){return[]},d.prototype.getClass=function(){return d},d}(ve),ae=function(){};ae.prototype.interfaces_=function(){return[]},ae.prototype.getClass=function(){return ae},ae.shouldNeverReachHere=function(){if(0===arguments.length)ae.shouldNeverReachHere(null);else if(1===arguments.length){var l=arguments[0];throw new ce("Should never reach here"+(null!==l?": "+l:""))}},ae.isTrue=function(){var d;if(1===arguments.length)ae.isTrue(arguments[0],null);else if(2===arguments.length&&(d=arguments[1],!arguments[0]))throw null===d?new ce:new ce(d)},ae.equals=function(){var l,d,_;if(2===arguments.length)ae.equals(l=arguments[0],d=arguments[1],null);else if(3===arguments.length&&(_=arguments[2],!(d=arguments[1]).equals(l=arguments[0])))throw new ce("Expected "+l+" but encountered "+d+(null!==_?": "+_:""))};var Ie=function(){this._result=null,this._inputLines=Array(2).fill().map(function(){return Array(2)}),this._intPt=new Array(2).fill(null),this._intLineIndex=null,this._isProper=null,this._pa=null,this._pb=null,this._precisionModel=null,this._intPt[0]=new re,this._intPt[1]=new re,this._pa=this._intPt[0],this._pb=this._intPt[1],this._result=0},ct={DONT_INTERSECT:{configurable:!0},DO_INTERSECT:{configurable:!0},COLLINEAR:{configurable:!0},NO_INTERSECTION:{configurable:!0},POINT_INTERSECTION:{configurable:!0},COLLINEAR_INTERSECTION:{configurable:!0}};Ie.prototype.getIndexAlongSegment=function(l,d){return this.computeIntLineIndex(),this._intLineIndex[l][d]},Ie.prototype.getTopologySummary=function(){var l=new Pe;return this.isEndPoint()&&l.append(" endpoint"),this._isProper&&l.append(" proper"),this.isCollinear()&&l.append(" collinear"),l.toString()},Ie.prototype.computeIntersection=function(l,d,_,b){this._inputLines[0][0]=l,this._inputLines[0][1]=d,this._inputLines[1][0]=_,this._inputLines[1][1]=b,this._result=this.computeIntersect(l,d,_,b)},Ie.prototype.getIntersectionNum=function(){return this._result},Ie.prototype.computeIntLineIndex=function(){if(0===arguments.length)null===this._intLineIndex&&(this._intLineIndex=Array(2).fill().map(function(){return Array(2)}),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(1===arguments.length){var l=arguments[0];this.getEdgeDistance(l,0)>this.getEdgeDistance(l,1)?(this._intLineIndex[l][0]=0,this._intLineIndex[l][1]=1):(this._intLineIndex[l][0]=1,this._intLineIndex[l][1]=0)}},Ie.prototype.isProper=function(){return this.hasIntersection()&&this._isProper},Ie.prototype.setPrecisionModel=function(l){this._precisionModel=l},Ie.prototype.isInteriorIntersection=function(){if(0===arguments.length)return!!this.isInteriorIntersection(0)||!!this.isInteriorIntersection(1);if(1===arguments.length){for(var l=arguments[0],d=0;d<this._result;d++)if(!this._intPt[d].equals2D(this._inputLines[l][0])&&!this._intPt[d].equals2D(this._inputLines[l][1]))return!0;return!1}},Ie.prototype.getIntersection=function(l){return this._intPt[l]},Ie.prototype.isEndPoint=function(){return this.hasIntersection()&&!this._isProper},Ie.prototype.hasIntersection=function(){return this._result!==Ie.NO_INTERSECTION},Ie.prototype.getEdgeDistance=function(l,d){return Ie.computeEdgeDistance(this._intPt[d],this._inputLines[l][0],this._inputLines[l][1])},Ie.prototype.isCollinear=function(){return this._result===Ie.COLLINEAR_INTERSECTION},Ie.prototype.toString=function(){return _t.toLineString(this._inputLines[0][0],this._inputLines[0][1])+" - "+_t.toLineString(this._inputLines[1][0],this._inputLines[1][1])+this.getTopologySummary()},Ie.prototype.getEndpoint=function(l,d){return this._inputLines[l][d]},Ie.prototype.isIntersection=function(l){for(var d=0;d<this._result;d++)if(this._intPt[d].equals2D(l))return!0;return!1},Ie.prototype.getIntersectionAlongSegment=function(l,d){return this.computeIntLineIndex(),this._intPt[this._intLineIndex[l][d]]},Ie.prototype.interfaces_=function(){return[]},Ie.prototype.getClass=function(){return Ie},Ie.computeEdgeDistance=function(l,d,_){var b=Math.abs(_.x-d.x),I=Math.abs(_.y-d.y),N=-1;if(l.equals(d))N=0;else if(l.equals(_))N=b>I?b:I;else{var j=Math.abs(l.x-d.x),ne=Math.abs(l.y-d.y);0!==(N=b>I?j:ne)||l.equals(d)||(N=Math.max(j,ne))}return ae.isTrue(!(0===N&&!l.equals(d)),"Bad distance calculation"),N},Ie.nonRobustComputeEdgeDistance=function(l,d,_){var b=l.x-d.x,I=l.y-d.y,N=Math.sqrt(b*b+I*I);return ae.isTrue(!(0===N&&!l.equals(d)),"Invalid distance calculation"),N},ct.DONT_INTERSECT.get=function(){return 0},ct.DO_INTERSECT.get=function(){return 1},ct.COLLINEAR.get=function(){return 2},ct.NO_INTERSECTION.get=function(){return 0},ct.POINT_INTERSECTION.get=function(){return 1},ct.COLLINEAR_INTERSECTION.get=function(){return 2},Object.defineProperties(Ie,ct);var Ot=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.isInSegmentEnvelopes=function(_){var b=new rn(this._inputLines[0][0],this._inputLines[0][1]),I=new rn(this._inputLines[1][0],this._inputLines[1][1]);return b.contains(_)&&I.contains(_)},d.prototype.computeIntersection=function(){if(3!==arguments.length)return l.prototype.computeIntersection.apply(this,arguments);var _=arguments[0],b=arguments[1],I=arguments[2];if(this._isProper=!1,rn.intersects(b,I,_)&&0===wt.orientationIndex(b,I,_)&&0===wt.orientationIndex(I,b,_))return this._isProper=!0,(_.equals(b)||_.equals(I))&&(this._isProper=!1),this._result=l.POINT_INTERSECTION,null;this._result=l.NO_INTERSECTION},d.prototype.normalizeToMinimum=function(_,b,I,N,j){j.x=this.smallestInAbsValue(_.x,b.x,I.x,N.x),j.y=this.smallestInAbsValue(_.y,b.y,I.y,N.y),_.x-=j.x,_.y-=j.y,b.x-=j.x,b.y-=j.y,I.x-=j.x,I.y-=j.y,N.x-=j.x,N.y-=j.y},d.prototype.safeHCoordinateIntersection=function(_,b,I,N){var j=null;try{j=Vn.intersection(_,b,I,N)}catch(ne){if(!(ne instanceof sr))throw ne;j=d.nearestEndpoint(_,b,I,N)}return j},d.prototype.intersection=function(_,b,I,N){var j=this.intersectionWithNormalization(_,b,I,N);return this.isInSegmentEnvelopes(j)||(j=new re(d.nearestEndpoint(_,b,I,N))),null!==this._precisionModel&&this._precisionModel.makePrecise(j),j},d.prototype.smallestInAbsValue=function(_,b,I,N){var j=_,ne=Math.abs(j);return Math.abs(b)<ne&&(j=b,ne=Math.abs(b)),Math.abs(I)<ne&&(j=I,ne=Math.abs(I)),Math.abs(N)<ne&&(j=N),j},d.prototype.checkDD=function(_,b,I,N,j){var ne=Ut.intersection(_,b,I,N),Ee=this.isInSegmentEnvelopes(ne);In.out.println("DD in env = "+Ee+"  --------------------- "+ne),j.distance(ne)>1e-4&&In.out.println("Distance = "+j.distance(ne))},d.prototype.intersectionWithNormalization=function(_,b,I,N){var j=new re(_),ne=new re(b),Ee=new re(I),it=new re(N),Bt=new re;this.normalizeToEnvCentre(j,ne,Ee,it,Bt);var zt=this.safeHCoordinateIntersection(j,ne,Ee,it);return zt.x+=Bt.x,zt.y+=Bt.y,zt},d.prototype.computeCollinearIntersection=function(_,b,I,N){var j=rn.intersects(_,b,I),ne=rn.intersects(_,b,N),Ee=rn.intersects(I,N,_),it=rn.intersects(I,N,b);return j&&ne?(this._intPt[0]=I,this._intPt[1]=N,l.COLLINEAR_INTERSECTION):Ee&&it?(this._intPt[0]=_,this._intPt[1]=b,l.COLLINEAR_INTERSECTION):j&&Ee?(this._intPt[0]=I,this._intPt[1]=_,!I.equals(_)||ne||it?l.COLLINEAR_INTERSECTION:l.POINT_INTERSECTION):j&&it?(this._intPt[0]=I,this._intPt[1]=b,!I.equals(b)||ne||Ee?l.COLLINEAR_INTERSECTION:l.POINT_INTERSECTION):ne&&Ee?(this._intPt[0]=N,this._intPt[1]=_,!N.equals(_)||j||it?l.COLLINEAR_INTERSECTION:l.POINT_INTERSECTION):ne&&it?(this._intPt[0]=N,this._intPt[1]=b,!N.equals(b)||j||Ee?l.COLLINEAR_INTERSECTION:l.POINT_INTERSECTION):l.NO_INTERSECTION},d.prototype.normalizeToEnvCentre=function(_,b,I,N,j){var ne=_.x<b.x?_.x:b.x,Ee=_.y<b.y?_.y:b.y,it=_.x>b.x?_.x:b.x,Bt=_.y>b.y?_.y:b.y,zt=I.x<N.x?I.x:N.x,vn=I.y<N.y?I.y:N.y,pn=I.x>N.x?I.x:N.x,Pn=I.y>N.y?I.y:N.y,C=((Ee>vn?Ee:vn)+(Bt<Pn?Bt:Pn))/2;j.x=((ne>zt?ne:zt)+(it<pn?it:pn))/2,j.y=C,_.x-=j.x,_.y-=j.y,b.x-=j.x,b.y-=j.y,I.x-=j.x,I.y-=j.y,N.x-=j.x,N.y-=j.y},d.prototype.computeIntersect=function(_,b,I,N){if(this._isProper=!1,!rn.intersects(_,b,I,N))return l.NO_INTERSECTION;var j=wt.orientationIndex(_,b,I),ne=wt.orientationIndex(_,b,N);if(j>0&&ne>0||j<0&&ne<0)return l.NO_INTERSECTION;var Ee=wt.orientationIndex(I,N,_),it=wt.orientationIndex(I,N,b);return Ee>0&&it>0||Ee<0&&it<0?l.NO_INTERSECTION:0===j&&0===ne&&0===Ee&&0===it?this.computeCollinearIntersection(_,b,I,N):(0===j||0===ne||0===Ee||0===it?(this._isProper=!1,_.equals2D(I)||_.equals2D(N)?this._intPt[0]=_:b.equals2D(I)||b.equals2D(N)?this._intPt[0]=b:0===j?this._intPt[0]=new re(I):0===ne?this._intPt[0]=new re(N):0===Ee?this._intPt[0]=new re(_):0===it&&(this._intPt[0]=new re(b))):(this._isProper=!0,this._intPt[0]=this.intersection(_,b,I,N)),l.POINT_INTERSECTION)},d.prototype.interfaces_=function(){return[]},d.prototype.getClass=function(){return d},d.nearestEndpoint=function(_,b,I,N){var j=_,ne=wt.distancePointLine(_,I,N),Ee=wt.distancePointLine(b,I,N);return Ee<ne&&(ne=Ee,j=b),(Ee=wt.distancePointLine(I,_,b))<ne&&(ne=Ee,j=I),(Ee=wt.distancePointLine(N,_,b))<ne&&(ne=Ee,j=N),j},d}(Ie),Kt=function(){};Kt.prototype.interfaces_=function(){return[]},Kt.prototype.getClass=function(){return Kt},Kt.orientationIndex=function(l,d,_){return Kt.signOfDet2x2(d.x-l.x,d.y-l.y,_.x-d.x,_.y-d.y)},Kt.signOfDet2x2=function(l,d,_,b){var I=null,N=null,j=null;if(I=1,0===l||0===b)return 0===d||0===_?0:d>0?_>0?-I:I:_>0?I:-I;if(0===d||0===_)return b>0?l>0?I:-I:l>0?-I:I;if(d>0?b>0?d<=b||(I=-I,N=l,l=_,_=N,N=d,d=b,b=N):d<=-b?(I=-I,_=-_,b=-b):(N=l,l=-_,_=N,N=d,d=-b,b=N):b>0?-d<=b?(I=-I,l=-l,d=-d):(N=-l,l=_,_=N,N=-d,d=b,b=N):d>=b?(l=-l,d=-d,_=-_,b=-b):(I=-I,N=-l,l=-_,_=N,N=-d,d=-b,b=N),l>0){if(!(_>0&&l<=_))return I}else{if(_>0||!(l>=_))return-I;I=-I,l=-l,_=-_}for(;;){if((b-=(j=Math.floor(_/l))*d)<0)return-I;if(b>d)return I;if(l>(_-=j*l)+_){if(d<b+b)return I}else{if(d>b+b)return-I;_=l-_,b=d-b,I=-I}if(0===b)return 0===_?0:-I;if(0===_||(l-=(j=Math.floor(l/_))*_,(d-=j*b)<0))return I;if(d>b)return-I;if(_>l+l){if(b<d+d)return-I}else{if(b>d+d)return I;l=_-l,d=b-d,I=-I}if(0===d)return 0===l?0:I;if(0===l)return-I}};var Yt=function(){this._p=null,this._crossingCount=0,this._isPointOnSegment=!1,this._p=arguments[0]};Yt.prototype.countSegment=function(l,d){if(l.x<this._p.x&&d.x<this._p.x)return null;if(this._p.x===d.x&&this._p.y===d.y)return this._isPointOnSegment=!0,null;if(l.y===this._p.y&&d.y===this._p.y){var _=l.x,b=d.x;return _>b&&(_=d.x,b=l.x),this._p.x>=_&&this._p.x<=b&&(this._isPointOnSegment=!0),null}if(l.y>this._p.y&&d.y<=this._p.y||d.y>this._p.y&&l.y<=this._p.y){var N=l.y-this._p.y,ne=d.y-this._p.y,Ee=Kt.signOfDet2x2(l.x-this._p.x,N,d.x-this._p.x,ne);if(0===Ee)return this._isPointOnSegment=!0,null;ne<N&&(Ee=-Ee),Ee>0&&this._crossingCount++}},Yt.prototype.isPointInPolygon=function(){return this.getLocation()!==xe.EXTERIOR},Yt.prototype.getLocation=function(){return this._isPointOnSegment?xe.BOUNDARY:this._crossingCount%2==1?xe.INTERIOR:xe.EXTERIOR},Yt.prototype.isOnSegment=function(){return this._isPointOnSegment},Yt.prototype.interfaces_=function(){return[]},Yt.prototype.getClass=function(){return Yt},Yt.locatePointInRing=function(){if(arguments[0]instanceof re&&Lt(arguments[1],Gt)){for(var d=arguments[1],_=new Yt(arguments[0]),b=new re,I=new re,N=1;N<d.size();N++)if(d.getCoordinate(N,b),d.getCoordinate(N-1,I),_.countSegment(b,I),_.isOnSegment())return _.getLocation();return _.getLocation()}if(arguments[0]instanceof re&&arguments[1]instanceof Array){for(var ne=arguments[1],Ee=new Yt(arguments[0]),it=1;it<ne.length;it++)if(Ee.countSegment(ne[it],ne[it-1]),Ee.isOnSegment())return Ee.getLocation();return Ee.getLocation()}};var wt=function(){},Qn={CLOCKWISE:{configurable:!0},RIGHT:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},LEFT:{configurable:!0},COLLINEAR:{configurable:!0},STRAIGHT:{configurable:!0}};wt.prototype.interfaces_=function(){return[]},wt.prototype.getClass=function(){return wt},wt.orientationIndex=function(l,d,_){return Ut.orientationIndex(l,d,_)},wt.signedArea=function(){if(arguments[0]instanceof Array){var l=arguments[0];if(l.length<3)return 0;for(var d=0,_=l[0].x,b=1;b<l.length-1;b++)d+=(l[b].x-_)*(l[b-1].y-l[b+1].y);return d/2}if(Lt(arguments[0],Gt)){var j=arguments[0],ne=j.size();if(ne<3)return 0;var Ee=new re,it=new re,Bt=new re;j.getCoordinate(0,it),j.getCoordinate(1,Bt);var zt=it.x;Bt.x-=zt;for(var vn=0,pn=1;pn<ne-1;pn++)Ee.y=it.y,it.x=Bt.x,it.y=Bt.y,j.getCoordinate(pn+1,Bt),Bt.x-=zt,vn+=it.x*(Ee.y-Bt.y);return vn/2}},wt.distanceLineLine=function(l,d,_,b){if(l.equals(d))return wt.distancePointLine(l,_,b);if(_.equals(b))return wt.distancePointLine(b,l,d);var I=!1;if(rn.intersects(l,d,_,b)){var N=(d.x-l.x)*(b.y-_.y)-(d.y-l.y)*(b.x-_.x);if(0===N)I=!0;else{var ne=((l.y-_.y)*(d.x-l.x)-(l.x-_.x)*(d.y-l.y))/N,Ee=((l.y-_.y)*(b.x-_.x)-(l.x-_.x)*(b.y-_.y))/N;(Ee<0||Ee>1||ne<0||ne>1)&&(I=!0)}}else I=!0;return I?Ce.min(wt.distancePointLine(l,_,b),wt.distancePointLine(d,_,b),wt.distancePointLine(_,l,d),wt.distancePointLine(b,l,d)):0},wt.isPointInRing=function(l,d){return wt.locatePointInRing(l,d)!==xe.EXTERIOR},wt.computeLength=function(l){var d=l.size();if(d<=1)return 0;var _=0,b=new re;l.getCoordinate(0,b);for(var I=b.x,N=b.y,j=1;j<d;j++){l.getCoordinate(j,b);var ne=b.x,Ee=b.y,it=ne-I,Bt=Ee-N;_+=Math.sqrt(it*it+Bt*Bt),I=ne,N=Ee}return _},wt.isCCW=function(l){var d=l.length-1;if(d<3)throw new pe("Ring has fewer than 4 points, so orientation cannot be determined");for(var _=l[0],b=0,I=1;I<=d;I++){var N=l[I];N.y>_.y&&(_=N,b=I)}var j=b;do{(j-=1)<0&&(j=d)}while(l[j].equals2D(_)&&j!==b);var ne=b;do{ne=(ne+1)%d}while(l[ne].equals2D(_)&&ne!==b);var Ee=l[j],it=l[ne];if(Ee.equals2D(_)||it.equals2D(_)||Ee.equals2D(it))return!1;var Bt=wt.computeOrientation(Ee,_,it);return 0===Bt?Ee.x>it.x:Bt>0},wt.locatePointInRing=function(l,d){return Yt.locatePointInRing(l,d)},wt.distancePointLinePerpendicular=function(l,d,_){var b=(_.x-d.x)*(_.x-d.x)+(_.y-d.y)*(_.y-d.y);return Math.abs(((d.y-l.y)*(_.x-d.x)-(d.x-l.x)*(_.y-d.y))/b)*Math.sqrt(b)},wt.computeOrientation=function(l,d,_){return wt.orientationIndex(l,d,_)},wt.distancePointLine=function(){if(2===arguments.length){var l=arguments[0],d=arguments[1];if(0===d.length)throw new pe("Line array must contain at least one vertex");for(var _=l.distance(d[0]),b=0;b<d.length-1;b++){var I=wt.distancePointLine(l,d[b],d[b+1]);I<_&&(_=I)}return _}if(3===arguments.length){var N=arguments[0],j=arguments[1],ne=arguments[2];if(j.x===ne.x&&j.y===ne.y)return N.distance(j);var Ee=(ne.x-j.x)*(ne.x-j.x)+(ne.y-j.y)*(ne.y-j.y),it=((N.x-j.x)*(ne.x-j.x)+(N.y-j.y)*(ne.y-j.y))/Ee;return it<=0?N.distance(j):it>=1?N.distance(ne):Math.abs(((j.y-N.y)*(ne.x-j.x)-(j.x-N.x)*(ne.y-j.y))/Ee)*Math.sqrt(Ee)}},wt.isOnLine=function(l,d){for(var _=new Ot,b=1;b<d.length;b++)if(_.computeIntersection(l,d[b-1],d[b]),_.hasIntersection())return!0;return!1},Qn.CLOCKWISE.get=function(){return-1},Qn.RIGHT.get=function(){return wt.CLOCKWISE},Qn.COUNTERCLOCKWISE.get=function(){return 1},Qn.LEFT.get=function(){return wt.COUNTERCLOCKWISE},Qn.COLLINEAR.get=function(){return 0},Qn.STRAIGHT.get=function(){return wt.COLLINEAR},Object.defineProperties(wt,Qn);var Er=function(){};Er.prototype.filter=function(l){},Er.prototype.interfaces_=function(){return[]},Er.prototype.getClass=function(){return Er};var Qt=function(){var l=arguments[0];this._envelope=null,this._factory=null,this._SRID=null,this._userData=null,this._factory=l,this._SRID=l.getSRID()},jn={serialVersionUID:{configurable:!0},SORTINDEX_POINT:{configurable:!0},SORTINDEX_MULTIPOINT:{configurable:!0},SORTINDEX_LINESTRING:{configurable:!0},SORTINDEX_LINEARRING:{configurable:!0},SORTINDEX_MULTILINESTRING:{configurable:!0},SORTINDEX_POLYGON:{configurable:!0},SORTINDEX_MULTIPOLYGON:{configurable:!0},SORTINDEX_GEOMETRYCOLLECTION:{configurable:!0},geometryChangedFilter:{configurable:!0}};Qt.prototype.isGeometryCollection=function(){return this.getSortIndex()===Qt.SORTINDEX_GEOMETRYCOLLECTION},Qt.prototype.getFactory=function(){return this._factory},Qt.prototype.getGeometryN=function(l){return this},Qt.prototype.getArea=function(){return 0},Qt.prototype.isRectangle=function(){return!1},Qt.prototype.equals=function(){if(arguments[0]instanceof Qt){var l=arguments[0];return null!==l&&this.equalsTopo(l)}if(arguments[0]instanceof Object){var d=arguments[0];return d instanceof Qt&&this.equalsExact(d)}},Qt.prototype.equalsExact=function(l){return this===l||this.equalsExact(l,0)},Qt.prototype.geometryChanged=function(){this.apply(Qt.geometryChangedFilter)},Qt.prototype.geometryChangedAction=function(){this._envelope=null},Qt.prototype.equalsNorm=function(l){return null!==l&&this.norm().equalsExact(l.norm())},Qt.prototype.getLength=function(){return 0},Qt.prototype.getNumGeometries=function(){return 1},Qt.prototype.compareTo=function(){if(1===arguments.length){var l=arguments[0],d=l;return this.getSortIndex()!==d.getSortIndex()?this.getSortIndex()-d.getSortIndex():this.isEmpty()&&d.isEmpty()?0:this.isEmpty()?-1:d.isEmpty()?1:this.compareToSameClass(l)}if(2===arguments.length){var _=arguments[0],b=arguments[1];return this.getSortIndex()!==_.getSortIndex()?this.getSortIndex()-_.getSortIndex():this.isEmpty()&&_.isEmpty()?0:this.isEmpty()?-1:_.isEmpty()?1:this.compareToSameClass(_,b)}},Qt.prototype.getUserData=function(){return this._userData},Qt.prototype.getSRID=function(){return this._SRID},Qt.prototype.getEnvelope=function(){return this.getFactory().toGeometry(this.getEnvelopeInternal())},Qt.prototype.checkNotGeometryCollection=function(l){if(l.getSortIndex()===Qt.SORTINDEX_GEOMETRYCOLLECTION)throw new pe("This method does not support GeometryCollection arguments")},Qt.prototype.equal=function(l,d,_){return 0===_?l.equals(d):l.distance(d)<=_},Qt.prototype.norm=function(){var l=this.copy();return l.normalize(),l},Qt.prototype.getPrecisionModel=function(){return this._factory.getPrecisionModel()},Qt.prototype.getEnvelopeInternal=function(){return null===this._envelope&&(this._envelope=this.computeEnvelopeInternal()),new rn(this._envelope)},Qt.prototype.setSRID=function(l){this._SRID=l},Qt.prototype.setUserData=function(l){this._userData=l},Qt.prototype.compare=function(l,d){for(var _=l.iterator(),b=d.iterator();_.hasNext()&&b.hasNext();){var I=_.next(),N=b.next(),j=I.compareTo(N);if(0!==j)return j}return _.hasNext()?1:b.hasNext()?-1:0},Qt.prototype.hashCode=function(){return this.getEnvelopeInternal().hashCode()},Qt.prototype.isGeometryCollectionOrDerived=function(){return this.getSortIndex()===Qt.SORTINDEX_GEOMETRYCOLLECTION||this.getSortIndex()===Qt.SORTINDEX_MULTIPOINT||this.getSortIndex()===Qt.SORTINDEX_MULTILINESTRING||this.getSortIndex()===Qt.SORTINDEX_MULTIPOLYGON},Qt.prototype.interfaces_=function(){return[me,he,De]},Qt.prototype.getClass=function(){return Qt},Qt.hasNonEmptyElements=function(l){for(var d=0;d<l.length;d++)if(!l[d].isEmpty())return!0;return!1},Qt.hasNullElements=function(l){for(var d=0;d<l.length;d++)if(null===l[d])return!0;return!1},jn.serialVersionUID.get=function(){return 0x799ea46522854c00},jn.SORTINDEX_POINT.get=function(){return 0},jn.SORTINDEX_MULTIPOINT.get=function(){return 1},jn.SORTINDEX_LINESTRING.get=function(){return 2},jn.SORTINDEX_LINEARRING.get=function(){return 3},jn.SORTINDEX_MULTILINESTRING.get=function(){return 4},jn.SORTINDEX_POLYGON.get=function(){return 5},jn.SORTINDEX_MULTIPOLYGON.get=function(){return 6},jn.SORTINDEX_GEOMETRYCOLLECTION.get=function(){return 7},jn.geometryChangedFilter.get=function(){return ar},Object.defineProperties(Qt,jn);var ar=function(){};ar.interfaces_=function(){return[Er]},ar.filter=function(l){l.geometryChangedAction()};var Vr=function(){};Vr.prototype.filter=function(l){},Vr.prototype.interfaces_=function(){return[]},Vr.prototype.getClass=function(){return Vr};var ei=function(){},So={Mod2BoundaryNodeRule:{configurable:!0},EndPointBoundaryNodeRule:{configurable:!0},MultiValentEndPointBoundaryNodeRule:{configurable:!0},MonoValentEndPointBoundaryNodeRule:{configurable:!0},MOD2_BOUNDARY_RULE:{configurable:!0},ENDPOINT_BOUNDARY_RULE:{configurable:!0},MULTIVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},MONOVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},OGC_SFS_BOUNDARY_RULE:{configurable:!0}};ei.prototype.isInBoundary=function(l){},ei.prototype.interfaces_=function(){return[]},ei.prototype.getClass=function(){return ei},So.Mod2BoundaryNodeRule.get=function(){return Mo},So.EndPointBoundaryNodeRule.get=function(){return jo},So.MultiValentEndPointBoundaryNodeRule.get=function(){return fi},So.MonoValentEndPointBoundaryNodeRule.get=function(){return Xo},So.MOD2_BOUNDARY_RULE.get=function(){return new Mo},So.ENDPOINT_BOUNDARY_RULE.get=function(){return new jo},So.MULTIVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new fi},So.MONOVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new Xo},So.OGC_SFS_BOUNDARY_RULE.get=function(){return ei.MOD2_BOUNDARY_RULE},Object.defineProperties(ei,So);var Mo=function(){};Mo.prototype.isInBoundary=function(l){return l%2==1},Mo.prototype.interfaces_=function(){return[ei]},Mo.prototype.getClass=function(){return Mo};var jo=function(){};jo.prototype.isInBoundary=function(l){return l>0},jo.prototype.interfaces_=function(){return[ei]},jo.prototype.getClass=function(){return jo};var fi=function(){};fi.prototype.isInBoundary=function(l){return l>1},fi.prototype.interfaces_=function(){return[ei]},fi.prototype.getClass=function(){return fi};var Xo=function(){};Xo.prototype.isInBoundary=function(l){return 1===l},Xo.prototype.interfaces_=function(){return[ei]},Xo.prototype.getClass=function(){return Xo};var qi=function(){};qi.prototype.add=function(){},qi.prototype.addAll=function(){},qi.prototype.isEmpty=function(){},qi.prototype.iterator=function(){},qi.prototype.size=function(){},qi.prototype.toArray=function(){},qi.prototype.remove=function(){},(Be.prototype=new Error).name="IndexOutOfBoundsException";var fa=function(){};fa.prototype.hasNext=function(){},fa.prototype.next=function(){},fa.prototype.remove=function(){};var fo=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.get=function(){},d.prototype.set=function(){},d.prototype.isEmpty=function(){},d}(qi);(pt.prototype=new Error).name="NoSuchElementException";var ln=function(l){function d(){l.call(this),this.array_=[],arguments[0]instanceof qi&&this.addAll(arguments[0])}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.ensureCapacity=function(){},d.prototype.interfaces_=function(){return[l,qi]},d.prototype.add=function(_){return 1===arguments.length?this.array_.push(_):this.array_.splice(arguments[0],arguments[1]),!0},d.prototype.clear=function(){this.array_=[]},d.prototype.addAll=function(_){for(var b=_.iterator();b.hasNext();)this.add(b.next());return!0},d.prototype.set=function(_,b){var I=this.array_[_];return this.array_[_]=b,I},d.prototype.iterator=function(){return new al(this)},d.prototype.get=function(_){if(_<0||_>=this.size())throw new Be;return this.array_[_]},d.prototype.isEmpty=function(){return 0===this.array_.length},d.prototype.size=function(){return this.array_.length},d.prototype.toArray=function(){for(var _=[],b=0,I=this.array_.length;b<I;b++)_.push(this.array_[b]);return _},d.prototype.remove=function(_){for(var b=!1,I=0,N=this.array_.length;I<N;I++)if(this.array_[I]===_){this.array_.splice(I,1),b=!0;break}return b},d}(fo),al=function(l){function d(_){l.call(this),this.arrayList_=_,this.position_=0}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.next=function(){if(this.position_===this.arrayList_.size())throw new pt;return this.arrayList_.get(this.position_++)},d.prototype.hasNext=function(){return this.position_<this.arrayList_.size()},d.prototype.set=function(_){return this.arrayList_.set(this.position_-1,_)},d.prototype.remove=function(){this.arrayList_.remove(this.arrayList_.get(this.position_))},d}(fa),Fs=function(l){function d(){if(l.call(this),0!==arguments.length)if(1===arguments.length){var b=arguments[0];this.ensureCapacity(b.length),this.add(b,!0)}else if(2===arguments.length){var I=arguments[0],N=arguments[1];this.ensureCapacity(I.length),this.add(I,N)}}l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d;var _={coordArrayType:{configurable:!0}};return _.coordArrayType.get=function(){return new Array(0).fill(null)},d.prototype.getCoordinate=function(b){return this.get(b)},d.prototype.addAll=function(){if(2===arguments.length){for(var I=arguments[1],N=!1,j=arguments[0].iterator();j.hasNext();)this.add(j.next(),I),N=!0;return N}return l.prototype.addAll.apply(this,arguments)},d.prototype.clone=function(){for(var b=l.prototype.clone.call(this),I=0;I<this.size();I++)b.add(I,this.get(I).copy());return b},d.prototype.toCoordinateArray=function(){return this.toArray(d.coordArrayType)},d.prototype.add=function(){if(1===arguments.length)l.prototype.add.call(this,arguments[0]);else if(2===arguments.length){if(arguments[0]instanceof Array&&"boolean"==typeof arguments[1])return this.add(arguments[0],arguments[1],!0),!0;if(arguments[0]instanceof re&&"boolean"==typeof arguments[1]){var j=arguments[0];if(!arguments[1]&&this.size()>=1&&this.get(this.size()-1).equals2D(j))return null;l.prototype.add.call(this,j)}else if(arguments[0]instanceof Object&&"boolean"==typeof arguments[1])return this.add(arguments[0],arguments[1]),!0}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&arguments[0]instanceof Array&&"boolean"==typeof arguments[1]){var it=arguments[0],Bt=arguments[1];if(arguments[2])for(var zt=0;zt<it.length;zt++)this.add(it[zt],Bt);else for(var vn=it.length-1;vn>=0;vn--)this.add(it[vn],Bt);return!0}if("boolean"==typeof arguments[2]&&Number.isInteger(arguments[0])&&arguments[1]instanceof re){var pn=arguments[0],Pn=arguments[1];if(!arguments[2]){var rr=this.size();if(rr>0&&(pn>0&&this.get(pn-1).equals2D(Pn)||pn<rr&&this.get(pn).equals2D(Pn)))return null}l.prototype.add.call(this,pn,Pn)}}else if(4===arguments.length){var C=arguments[0],c=arguments[1],y=arguments[2],S=arguments[3],P=1;y>S&&(P=-1);for(var O=y;O!==S;O+=P)this.add(C[O],c);return!0}},d.prototype.closeRing=function(){this.size()>0&&this.add(new re(this.get(0)),!1)},d.prototype.interfaces_=function(){return[]},d.prototype.getClass=function(){return d},Object.defineProperties(d,_),d}(ln),yr=function(){},Bs={ForwardComparator:{configurable:!0},BidirectionalComparator:{configurable:!0},coordArrayType:{configurable:!0}};Bs.ForwardComparator.get=function(){return Re},Bs.BidirectionalComparator.get=function(){return Q},Bs.coordArrayType.get=function(){return new Array(0).fill(null)},yr.prototype.interfaces_=function(){return[]},yr.prototype.getClass=function(){return yr},yr.isRing=function(l){return!(l.length<4||!l[0].equals2D(l[l.length-1]))},yr.ptNotInList=function(l,d){for(var _=0;_<l.length;_++){var b=l[_];if(yr.indexOf(b,d)<0)return b}return null},yr.scroll=function(l,d){var _=yr.indexOf(d,l);if(_<0)return null;var b=new Array(l.length).fill(null);In.arraycopy(l,_,b,0,l.length-_),In.arraycopy(l,0,b,l.length-_,_),In.arraycopy(b,0,l,0,l.length)},yr.equals=function(){if(2===arguments.length){var l=arguments[0],d=arguments[1];if(l===d)return!0;if(null===l||null===d||l.length!==d.length)return!1;for(var _=0;_<l.length;_++)if(!l[_].equals(d[_]))return!1;return!0}if(3===arguments.length){var b=arguments[0],I=arguments[1],N=arguments[2];if(b===I)return!0;if(null===b||null===I||b.length!==I.length)return!1;for(var j=0;j<b.length;j++)if(0!==N.compare(b[j],I[j]))return!1;return!0}},yr.intersection=function(l,d){for(var _=new Fs,b=0;b<l.length;b++)d.intersects(l[b])&&_.add(l[b],!0);return _.toCoordinateArray()},yr.hasRepeatedPoints=function(l){for(var d=1;d<l.length;d++)if(l[d-1].equals(l[d]))return!0;return!1},yr.removeRepeatedPoints=function(l){return yr.hasRepeatedPoints(l)?new Fs(l,!1).toCoordinateArray():l},yr.reverse=function(l){for(var d=l.length-1,_=Math.trunc(d/2),b=0;b<=_;b++){var I=l[b];l[b]=l[d-b],l[d-b]=I}},yr.removeNull=function(l){for(var d=0,_=0;_<l.length;_++)null!==l[_]&&d++;var b=new Array(d).fill(null);if(0===d)return b;for(var I=0,N=0;N<l.length;N++)null!==l[N]&&(b[I++]=l[N]);return b},yr.copyDeep=function(){if(1===arguments.length){for(var l=arguments[0],d=new Array(l.length).fill(null),_=0;_<l.length;_++)d[_]=new re(l[_]);return d}if(5===arguments.length)for(var b=arguments[0],I=arguments[1],N=arguments[2],j=arguments[3],ne=arguments[4],Ee=0;Ee<ne;Ee++)N[j+Ee]=new re(b[I+Ee])},yr.isEqualReversed=function(l,d){for(var _=0;_<l.length;_++)if(0!==l[_].compareTo(d[l.length-_-1]))return!1;return!0},yr.envelope=function(l){for(var d=new rn,_=0;_<l.length;_++)d.expandToInclude(l[_]);return d},yr.toCoordinateArray=function(l){return l.toArray(yr.coordArrayType)},yr.atLeastNCoordinatesOrNothing=function(l,d){return d.length>=l?d:[]},yr.indexOf=function(l,d){for(var _=0;_<d.length;_++)if(l.equals(d[_]))return _;return-1},yr.increasingDirection=function(l){for(var d=0;d<Math.trunc(l.length/2);d++){var b=l[d].compareTo(l[l.length-1-d]);if(0!==b)return b}return 1},yr.compare=function(l,d){for(var _=0;_<l.length&&_<d.length;){var b=l[_].compareTo(d[_]);if(0!==b)return b;_++}return _<d.length?-1:_<l.length?1:0},yr.minCoordinate=function(l){for(var d=null,_=0;_<l.length;_++)(null===d||d.compareTo(l[_])>0)&&(d=l[_]);return d},yr.extract=function(l,d,_){d=Ce.clamp(d,0,l.length);var b=(_=Ce.clamp(_,-1,l.length))-d+1;_<0&&(b=0),d>=l.length&&(b=0),_<d&&(b=0);var I=new Array(b).fill(null);if(0===b)return I;for(var N=0,j=d;j<=_;j++)I[N++]=l[j];return I},Object.defineProperties(yr,Bs);var Re=function(){};Re.prototype.compare=function(l,d){return yr.compare(l,d)},Re.prototype.interfaces_=function(){return[be]},Re.prototype.getClass=function(){return Re};var Q=function(){};Q.prototype.compare=function(l,d){var _=l,b=d;if(_.length<b.length)return-1;if(_.length>b.length)return 1;if(0===_.length)return 0;var I=yr.compare(_,b);return yr.isEqualReversed(_,b)?0:I},Q.prototype.OLDcompare=function(l,d){var _=l,b=d;if(_.length<b.length)return-1;if(_.length>b.length)return 1;if(0===_.length)return 0;for(var I=yr.increasingDirection(_),N=yr.increasingDirection(b),j=I>0?0:_.length-1,ne=N>0?0:_.length-1,Ee=0;Ee<_.length;Ee++){var it=_[j].compareTo(b[ne]);if(0!==it)return it;j+=I,ne+=N}return 0},Q.prototype.interfaces_=function(){return[be]},Q.prototype.getClass=function(){return Q};var oe=function(){};oe.prototype.get=function(){},oe.prototype.put=function(){},oe.prototype.size=function(){},oe.prototype.values=function(){},oe.prototype.entrySet=function(){};var Ae=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d}(oe);(x.prototype=new Error).name="OperationNotSupported",(ut.prototype=new qi).contains=function(){};var je=function(l){function d(){l.call(this),this.array_=[],arguments[0]instanceof qi&&this.addAll(arguments[0])}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.contains=function(_){for(var b=0,I=this.array_.length;b<I;b++)if(this.array_[b]===_)return!0;return!1},d.prototype.add=function(_){return!this.contains(_)&&(this.array_.push(_),!0)},d.prototype.addAll=function(_){for(var b=_.iterator();b.hasNext();)this.add(b.next());return!0},d.prototype.remove=function(_){throw new Error},d.prototype.size=function(){return this.array_.length},d.prototype.isEmpty=function(){return 0===this.array_.length},d.prototype.toArray=function(){for(var _=[],b=0,I=this.array_.length;b<I;b++)_.push(this.array_[b]);return _},d.prototype.iterator=function(){return new at(this)},d}(ut),at=function(l){function d(_){l.call(this),this.hashSet_=_,this.position_=0}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.next=function(){if(this.position_===this.hashSet_.size())throw new pt;return this.hashSet_.array_[this.position_++]},d.prototype.hasNext=function(){return this.position_<this.hashSet_.size()},d.prototype.remove=function(){throw new x},d}(fa),bt=0;(kt.prototype=new Ae).get=function(l){for(var d=this.root_;null!==d;){var _=l.compareTo(d.key);if(_<0)d=d.left;else{if(!(_>0))return d.value;d=d.right}}return null},kt.prototype.put=function(l,d){if(null===this.root_)return this.root_={key:l,value:d,left:null,right:null,parent:null,color:bt,getValue:function(){return this.value},getKey:function(){return this.key}},this.size_=1,null;var _,b,I=this.root_;do{if(_=I,(b=l.compareTo(I.key))<0)I=I.left;else{if(!(b>0)){var N=I.value;return I.value=d,N}I=I.right}}while(null!==I);var j={key:l,left:null,right:null,value:d,parent:_,color:bt,getValue:function(){return this.value},getKey:function(){return this.key}};return b<0?_.left=j:_.right=j,this.fixAfterInsertion(j),this.size_++,null},kt.prototype.fixAfterInsertion=function(l){for(l.color=1;null!=l&&l!==this.root_&&1===l.parent.color;)if(dt(l)===Qe(dt(dt(l)))){var d=It(dt(dt(l)));1===qe(d)?(Ge(dt(l),bt),Ge(d,bt),Ge(dt(dt(l)),1),l=dt(dt(l))):(l===It(dt(l))&&(l=dt(l),this.rotateLeft(l)),Ge(dt(l),bt),Ge(dt(dt(l)),1),this.rotateRight(dt(dt(l))))}else{var _=Qe(dt(dt(l)));1===qe(_)?(Ge(dt(l),bt),Ge(_,bt),Ge(dt(dt(l)),1),l=dt(dt(l))):(l===Qe(dt(l))&&(l=dt(l),this.rotateRight(l)),Ge(dt(l),bt),Ge(dt(dt(l)),1),this.rotateLeft(dt(dt(l))))}this.root_.color=bt},kt.prototype.values=function(){var l=new ln,d=this.getFirstEntry();if(null!==d)for(l.add(d.value);null!==(d=kt.successor(d));)l.add(d.value);return l},kt.prototype.entrySet=function(){var l=new je,d=this.getFirstEntry();if(null!==d)for(l.add(d);null!==(d=kt.successor(d));)l.add(d);return l},kt.prototype.rotateLeft=function(l){if(null!=l){var d=l.right;l.right=d.left,null!=d.left&&(d.left.parent=l),d.parent=l.parent,null===l.parent?this.root_=d:l.parent.left===l?l.parent.left=d:l.parent.right=d,d.left=l,l.parent=d}},kt.prototype.rotateRight=function(l){if(null!=l){var d=l.left;l.left=d.right,null!=d.right&&(d.right.parent=l),d.parent=l.parent,null===l.parent?this.root_=d:l.parent.right===l?l.parent.right=d:l.parent.left=d,d.right=l,l.parent=d}},kt.prototype.getFirstEntry=function(){var l=this.root_;if(null!=l)for(;null!=l.left;)l=l.left;return l},kt.successor=function(l){if(null===l)return null;if(null!==l.right){for(var d=l.right;null!==d.left;)d=d.left;return d}for(var _=l.parent,b=l;null!==_&&b===_.right;)b=_,_=_.parent;return _},kt.prototype.size=function(){return this.size_};var Ct=function(){};Ct.prototype.interfaces_=function(){return[]},Ct.prototype.getClass=function(){return Ct},vt.prototype=new ut,(At.prototype=new vt).contains=function(l){for(var d=0,_=this.array_.length;d<_;d++)if(0===this.array_[d].compareTo(l))return!0;return!1},At.prototype.add=function(l){if(this.contains(l))return!1;for(var d=0,_=this.array_.length;d<_;d++)if(1===this.array_[d].compareTo(l))return this.array_.splice(d,0,l),!0;return this.array_.push(l),!0},At.prototype.addAll=function(l){for(var d=l.iterator();d.hasNext();)this.add(d.next());return!0},At.prototype.remove=function(l){throw new x},At.prototype.size=function(){return this.array_.length},At.prototype.isEmpty=function(){return 0===this.array_.length},At.prototype.toArray=function(){for(var l=[],d=0,_=this.array_.length;d<_;d++)l.push(this.array_[d]);return l},At.prototype.iterator=function(){return new ft(this)};var ft=function(l){this.treeSet_=l,this.position_=0};ft.prototype.next=function(){if(this.position_===this.treeSet_.size())throw new pt;return this.treeSet_.array_[this.position_++]},ft.prototype.hasNext=function(){return this.position_<this.treeSet_.size()},ft.prototype.remove=function(){throw new x};var Et=function(){};Et.sort=function(){var l,d,_,I=arguments[0];if(1===arguments.length)I.sort(function(j,ne){return j.compareTo(ne)});else if(2===arguments.length)_=arguments[1],I.sort(function(j,ne){return _.compare(j,ne)});else if(3===arguments.length){(d=I.slice(arguments[1],arguments[2])).sort();var N=I.slice(0,arguments[1]).concat(d,I.slice(arguments[2],I.length));for(I.splice(0,I.length),l=0;l<N.length;l++)I.push(N[l])}else if(4===arguments.length)for(d=I.slice(arguments[1],arguments[2]),_=arguments[3],d.sort(function(j,ne){return _.compare(j,ne)}),N=I.slice(0,arguments[1]).concat(d,I.slice(arguments[2],I.length)),I.splice(0,I.length),l=0;l<N.length;l++)I.push(N[l])},Et.asList=function(l){for(var d=new ln,_=0,b=l.length;_<b;_++)d.add(l[_]);return d};var Nt=function(){},fn={P:{configurable:!0},L:{configurable:!0},A:{configurable:!0},FALSE:{configurable:!0},TRUE:{configurable:!0},DONTCARE:{configurable:!0},SYM_FALSE:{configurable:!0},SYM_TRUE:{configurable:!0},SYM_DONTCARE:{configurable:!0},SYM_P:{configurable:!0},SYM_L:{configurable:!0},SYM_A:{configurable:!0}};fn.P.get=function(){return 0},fn.L.get=function(){return 1},fn.A.get=function(){return 2},fn.FALSE.get=function(){return-1},fn.TRUE.get=function(){return-2},fn.DONTCARE.get=function(){return-3},fn.SYM_FALSE.get=function(){return"F"},fn.SYM_TRUE.get=function(){return"T"},fn.SYM_DONTCARE.get=function(){return"*"},fn.SYM_P.get=function(){return"0"},fn.SYM_L.get=function(){return"1"},fn.SYM_A.get=function(){return"2"},Nt.prototype.interfaces_=function(){return[]},Nt.prototype.getClass=function(){return Nt},Nt.toDimensionSymbol=function(l){switch(l){case Nt.FALSE:return Nt.SYM_FALSE;case Nt.TRUE:return Nt.SYM_TRUE;case Nt.DONTCARE:return Nt.SYM_DONTCARE;case Nt.P:return Nt.SYM_P;case Nt.L:return Nt.SYM_L;case Nt.A:return Nt.SYM_A}throw new pe("Unknown dimension value: "+l)},Nt.toDimensionValue=function(l){switch(Ke.toUpperCase(l)){case Nt.SYM_FALSE:return Nt.FALSE;case Nt.SYM_TRUE:return Nt.TRUE;case Nt.SYM_DONTCARE:return Nt.DONTCARE;case Nt.SYM_P:return Nt.P;case Nt.SYM_L:return Nt.L;case Nt.SYM_A:return Nt.A}throw new pe("Unknown dimension symbol: "+l)},Object.defineProperties(Nt,fn);var Wt=function(){};Wt.prototype.filter=function(l){},Wt.prototype.interfaces_=function(){return[]},Wt.prototype.getClass=function(){return Wt};var bn=function(){};bn.prototype.filter=function(l,d){},bn.prototype.isDone=function(){},bn.prototype.isGeometryChanged=function(){},bn.prototype.interfaces_=function(){return[]},bn.prototype.getClass=function(){return bn};var tt=function(l){function d(b,I){if(l.call(this,I),this._geometries=b||[],l.hasNullElements(this._geometries))throw new pe("geometries must not contain null elements")}l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d;var _={serialVersionUID:{configurable:!0}};return d.prototype.computeEnvelopeInternal=function(){for(var b=new rn,I=0;I<this._geometries.length;I++)b.expandToInclude(this._geometries[I].getEnvelopeInternal());return b},d.prototype.getGeometryN=function(b){return this._geometries[b]},d.prototype.getSortIndex=function(){return l.SORTINDEX_GEOMETRYCOLLECTION},d.prototype.getCoordinates=function(){for(var b=new Array(this.getNumPoints()).fill(null),I=-1,N=0;N<this._geometries.length;N++)for(var j=this._geometries[N].getCoordinates(),ne=0;ne<j.length;ne++)b[++I]=j[ne];return b},d.prototype.getArea=function(){for(var b=0,I=0;I<this._geometries.length;I++)b+=this._geometries[I].getArea();return b},d.prototype.equalsExact=function(){if(2===arguments.length){var b=arguments[0],I=arguments[1];if(!this.isEquivalentClass(b))return!1;var N=b;if(this._geometries.length!==N._geometries.length)return!1;for(var j=0;j<this._geometries.length;j++)if(!this._geometries[j].equalsExact(N._geometries[j],I))return!1;return!0}return l.prototype.equalsExact.apply(this,arguments)},d.prototype.normalize=function(){for(var b=0;b<this._geometries.length;b++)this._geometries[b].normalize();Et.sort(this._geometries)},d.prototype.getCoordinate=function(){return this.isEmpty()?null:this._geometries[0].getCoordinate()},d.prototype.getBoundaryDimension=function(){for(var b=Nt.FALSE,I=0;I<this._geometries.length;I++)b=Math.max(b,this._geometries[I].getBoundaryDimension());return b},d.prototype.getDimension=function(){for(var b=Nt.FALSE,I=0;I<this._geometries.length;I++)b=Math.max(b,this._geometries[I].getDimension());return b},d.prototype.getLength=function(){for(var b=0,I=0;I<this._geometries.length;I++)b+=this._geometries[I].getLength();return b},d.prototype.getNumPoints=function(){for(var b=0,I=0;I<this._geometries.length;I++)b+=this._geometries[I].getNumPoints();return b},d.prototype.getNumGeometries=function(){return this._geometries.length},d.prototype.reverse=function(){for(var I=new Array(this._geometries.length).fill(null),N=0;N<this._geometries.length;N++)I[N]=this._geometries[N].reverse();return this.getFactory().createGeometryCollection(I)},d.prototype.compareToSameClass=function(){if(1===arguments.length){var b=arguments[0],I=new At(Et.asList(this._geometries)),N=new At(Et.asList(b._geometries));return this.compare(I,N)}if(2===arguments.length){for(var ne=arguments[1],Ee=arguments[0],it=this.getNumGeometries(),Bt=Ee.getNumGeometries(),zt=0;zt<it&&zt<Bt;){var vn=this.getGeometryN(zt),pn=Ee.getGeometryN(zt),Pn=vn.compareToSameClass(pn,ne);if(0!==Pn)return Pn;zt++}return zt<it?1:zt<Bt?-1:0}},d.prototype.apply=function(){if(Lt(arguments[0],Vr))for(var b=arguments[0],I=0;I<this._geometries.length;I++)this._geometries[I].apply(b);else if(Lt(arguments[0],bn)){var N=arguments[0];if(0===this._geometries.length)return null;for(var j=0;j<this._geometries.length&&(this._geometries[j].apply(N),!N.isDone());j++);N.isGeometryChanged()&&this.geometryChanged()}else if(Lt(arguments[0],Wt)){var ne=arguments[0];ne.filter(this);for(var Ee=0;Ee<this._geometries.length;Ee++)this._geometries[Ee].apply(ne)}else if(Lt(arguments[0],Er)){var it=arguments[0];it.filter(this);for(var Bt=0;Bt<this._geometries.length;Bt++)this._geometries[Bt].apply(it)}},d.prototype.getBoundary=function(){return this.checkNotGeometryCollection(this),ae.shouldNeverReachHere(),null},d.prototype.clone=function(){var b=l.prototype.clone.call(this);b._geometries=new Array(this._geometries.length).fill(null);for(var I=0;I<this._geometries.length;I++)b._geometries[I]=this._geometries[I].clone();return b},d.prototype.getGeometryType=function(){return"GeometryCollection"},d.prototype.copy=function(){for(var b=new Array(this._geometries.length).fill(null),I=0;I<b.length;I++)b[I]=this._geometries[I].copy();return new d(b,this._factory)},d.prototype.isEmpty=function(){for(var b=0;b<this._geometries.length;b++)if(!this._geometries[b].isEmpty())return!1;return!0},d.prototype.interfaces_=function(){return[]},d.prototype.getClass=function(){return d},_.serialVersionUID.get=function(){return-0x4f07bcb1f857d800},Object.defineProperties(d,_),d}(Qt),Vt=function(l){function d(){l.apply(this,arguments)}l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d;var _={serialVersionUID:{configurable:!0}};return d.prototype.getSortIndex=function(){return Qt.SORTINDEX_MULTILINESTRING},d.prototype.equalsExact=function(){if(2===arguments.length){var b=arguments[0],I=arguments[1];return!!this.isEquivalentClass(b)&&l.prototype.equalsExact.call(this,b,I)}return l.prototype.equalsExact.apply(this,arguments)},d.prototype.getBoundaryDimension=function(){return this.isClosed()?Nt.FALSE:0},d.prototype.isClosed=function(){if(this.isEmpty())return!1;for(var b=0;b<this._geometries.length;b++)if(!this._geometries[b].isClosed())return!1;return!0},d.prototype.getDimension=function(){return 1},d.prototype.reverse=function(){for(var b=this._geometries.length,I=new Array(b).fill(null),N=0;N<this._geometries.length;N++)I[b-1-N]=this._geometries[N].reverse();return this.getFactory().createMultiLineString(I)},d.prototype.getBoundary=function(){return new Wn(this).getBoundary()},d.prototype.getGeometryType=function(){return"MultiLineString"},d.prototype.copy=function(){for(var b=new Array(this._geometries.length).fill(null),I=0;I<b.length;I++)b[I]=this._geometries[I].copy();return new d(b,this._factory)},d.prototype.interfaces_=function(){return[Ct]},d.prototype.getClass=function(){return d},_.serialVersionUID.get=function(){return 0x7155d2ab4afa8000},Object.defineProperties(d,_),d}(tt),Wn=function(){if(this._geom=null,this._geomFact=null,this._bnRule=null,this._endpointMap=null,1===arguments.length){var l=arguments[0],d=ei.MOD2_BOUNDARY_RULE;this._geom=l,this._geomFact=l.getFactory(),this._bnRule=d}else if(2===arguments.length){var _=arguments[0],b=arguments[1];this._geom=_,this._geomFact=_.getFactory(),this._bnRule=b}};Wn.prototype.boundaryMultiLineString=function(l){if(this._geom.isEmpty())return this.getEmptyMultiPoint();var d=this.computeBoundaryCoordinates(l);return 1===d.length?this._geomFact.createPoint(d[0]):this._geomFact.createMultiPointFromCoords(d)},Wn.prototype.getBoundary=function(){return this._geom instanceof vr?this.boundaryLineString(this._geom):this._geom instanceof Vt?this.boundaryMultiLineString(this._geom):this._geom.getBoundary()},Wn.prototype.boundaryLineString=function(l){return this._geom.isEmpty()?this.getEmptyMultiPoint():l.isClosed()?this._bnRule.isInBoundary(2)?l.getStartPoint():this._geomFact.createMultiPoint():this._geomFact.createMultiPoint([l.getStartPoint(),l.getEndPoint()])},Wn.prototype.getEmptyMultiPoint=function(){return this._geomFact.createMultiPoint()},Wn.prototype.computeBoundaryCoordinates=function(l){var d=new ln;this._endpointMap=new kt;for(var _=0;_<l.getNumGeometries();_++){var b=l.getGeometryN(_);0!==b.getNumPoints()&&(this.addEndpoint(b.getCoordinateN(0)),this.addEndpoint(b.getCoordinateN(b.getNumPoints()-1)))}for(var I=this._endpointMap.entrySet().iterator();I.hasNext();){var N=I.next(),j=N.getValue().count;this._bnRule.isInBoundary(j)&&d.add(N.getKey())}return yr.toCoordinateArray(d)},Wn.prototype.addEndpoint=function(l){var d=this._endpointMap.get(l);null===d&&(d=new zr,this._endpointMap.put(l,d)),d.count++},Wn.prototype.interfaces_=function(){return[]},Wn.prototype.getClass=function(){return Wn},Wn.getBoundary=function(){return 1===arguments.length?new Wn(arguments[0]).getBoundary():2===arguments.length?new Wn(arguments[0],arguments[1]).getBoundary():void 0};var zr=function(){this.count=null};zr.prototype.interfaces_=function(){return[]},zr.prototype.getClass=function(){return zr};var lr=function(){},oi={NEWLINE:{configurable:!0},SIMPLE_ORDINATE_FORMAT:{configurable:!0}};lr.prototype.interfaces_=function(){return[]},lr.prototype.getClass=function(){return lr},lr.chars=function(l,d){for(var _=new Array(d).fill(null),b=0;b<d;b++)_[b]=l;return String(_)},lr.getStackTrace=function(){if(1===arguments.length){var l=arguments[0],d=new function(){},_=new function(){}(d);return l.printStackTrace(_),d.toString()}if(2===arguments.length){for(var I=arguments[1],N="",j=new function(){}(new function(){}(lr.getStackTrace(arguments[0]))),ne=0;ne<I;ne++)try{N+=j.readLine()+lr.NEWLINE}catch(Ee){if(!(Ee instanceof an))throw Ee;ae.shouldNeverReachHere()}return N}},lr.split=function(l,d){for(var _=d.length,b=new ln,I=""+l,N=I.indexOf(d);N>=0;){var j=I.substring(0,N);b.add(j),N=(I=I.substring(N+_)).indexOf(d)}I.length>0&&b.add(I);for(var ne=new Array(b.size()).fill(null),Ee=0;Ee<ne.length;Ee++)ne[Ee]=b.get(Ee);return ne},lr.toString=function(){if(1===arguments.length)return lr.SIMPLE_ORDINATE_FORMAT.format(arguments[0])},lr.spaces=function(l){return lr.chars(" ",l)},oi.NEWLINE.get=function(){return In.getProperty("line.separator")},oi.SIMPLE_ORDINATE_FORMAT.get=function(){return new function(){}("0.#")},Object.defineProperties(lr,oi);var ir=function(){};ir.prototype.interfaces_=function(){return[]},ir.prototype.getClass=function(){return ir},ir.copyCoord=function(l,d,_,b){for(var I=Math.min(l.getDimension(),_.getDimension()),N=0;N<I;N++)_.setOrdinate(b,N,l.getOrdinate(d,N))},ir.isRing=function(l){var d=l.size();return 0===d||!(d<=3)&&l.getOrdinate(0,Gt.X)===l.getOrdinate(d-1,Gt.X)&&l.getOrdinate(0,Gt.Y)===l.getOrdinate(d-1,Gt.Y)},ir.isEqual=function(l,d){var _=l.size();if(_!==d.size())return!1;for(var b=Math.min(l.getDimension(),d.getDimension()),I=0;I<_;I++)for(var N=0;N<b;N++){var j=l.getOrdinate(I,N),ne=d.getOrdinate(I,N);if(!(l.getOrdinate(I,N)===d.getOrdinate(I,N)||le.isNaN(j)&&le.isNaN(ne)))return!1}return!0},ir.extend=function(l,d,_){var b=l.create(_,d.getDimension()),I=d.size();if(ir.copy(d,0,b,0,I),I>0)for(var N=I;N<_;N++)ir.copy(d,I-1,b,N,1);return b},ir.reverse=function(l){for(var d=l.size()-1,_=Math.trunc(d/2),b=0;b<=_;b++)ir.swap(l,b,d-b)},ir.swap=function(l,d,_){if(d===_)return null;for(var b=0;b<l.getDimension();b++){var I=l.getOrdinate(d,b);l.setOrdinate(d,b,l.getOrdinate(_,b)),l.setOrdinate(_,b,I)}},ir.copy=function(l,d,_,b,I){for(var N=0;N<I;N++)ir.copyCoord(l,d+N,_,b+N)},ir.toString=function(){if(1===arguments.length){var l=arguments[0],d=l.size();if(0===d)return"()";var _=l.getDimension(),b=new Pe;b.append("(");for(var I=0;I<d;I++){I>0&&b.append(" ");for(var N=0;N<_;N++)N>0&&b.append(","),b.append(lr.toString(l.getOrdinate(I,N)))}return b.append(")"),b.toString()}},ir.ensureValidRing=function(l,d){var _=d.size();return 0===_?d:_<=3?ir.createClosedRing(l,d,4):d.getOrdinate(0,Gt.X)===d.getOrdinate(_-1,Gt.X)&&d.getOrdinate(0,Gt.Y)===d.getOrdinate(_-1,Gt.Y)?d:ir.createClosedRing(l,d,_+1)},ir.createClosedRing=function(l,d,_){var b=l.create(_,d.getDimension()),I=d.size();ir.copy(d,0,b,0,I);for(var N=I;N<_;N++)ir.copy(d,0,b,N,1);return b};var vr=function(l){function d(b,I){l.call(this,I),this._points=null,this.init(b)}l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d;var _={serialVersionUID:{configurable:!0}};return d.prototype.computeEnvelopeInternal=function(){return this.isEmpty()?new rn:this._points.expandEnvelope(new rn)},d.prototype.isRing=function(){return this.isClosed()&&this.isSimple()},d.prototype.getSortIndex=function(){return l.SORTINDEX_LINESTRING},d.prototype.getCoordinates=function(){return this._points.toCoordinateArray()},d.prototype.equalsExact=function(){if(2===arguments.length){var b=arguments[0],I=arguments[1];if(!this.isEquivalentClass(b))return!1;var N=b;if(this._points.size()!==N._points.size())return!1;for(var j=0;j<this._points.size();j++)if(!this.equal(this._points.getCoordinate(j),N._points.getCoordinate(j),I))return!1;return!0}return l.prototype.equalsExact.apply(this,arguments)},d.prototype.normalize=function(){for(var b=0;b<Math.trunc(this._points.size()/2);b++){var I=this._points.size()-1-b;if(!this._points.getCoordinate(b).equals(this._points.getCoordinate(I)))return this._points.getCoordinate(b).compareTo(this._points.getCoordinate(I))>0&&ir.reverse(this._points),null}},d.prototype.getCoordinate=function(){return this.isEmpty()?null:this._points.getCoordinate(0)},d.prototype.getBoundaryDimension=function(){return this.isClosed()?Nt.FALSE:0},d.prototype.isClosed=function(){return!this.isEmpty()&&this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))},d.prototype.getEndPoint=function(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)},d.prototype.getDimension=function(){return 1},d.prototype.getLength=function(){return wt.computeLength(this._points)},d.prototype.getNumPoints=function(){return this._points.size()},d.prototype.reverse=function(){var b=this._points.copy();return ir.reverse(b),this.getFactory().createLineString(b)},d.prototype.compareToSameClass=function(){if(1===arguments.length){for(var b=arguments[0],I=0,N=0;I<this._points.size()&&N<b._points.size();){var j=this._points.getCoordinate(I).compareTo(b._points.getCoordinate(N));if(0!==j)return j;I++,N++}return I<this._points.size()?1:N<b._points.size()?-1:0}if(2===arguments.length)return arguments[1].compare(this._points,arguments[0]._points)},d.prototype.apply=function(){if(Lt(arguments[0],Vr))for(var b=arguments[0],I=0;I<this._points.size();I++)b.filter(this._points.getCoordinate(I));else if(Lt(arguments[0],bn)){var N=arguments[0];if(0===this._points.size())return null;for(var j=0;j<this._points.size()&&(N.filter(this._points,j),!N.isDone());j++);N.isGeometryChanged()&&this.geometryChanged()}else(Lt(arguments[0],Wt)||Lt(arguments[0],Er))&&arguments[0].filter(this)},d.prototype.getBoundary=function(){return new Wn(this).getBoundary()},d.prototype.isEquivalentClass=function(b){return b instanceof d},d.prototype.clone=function(){var b=l.prototype.clone.call(this);return b._points=this._points.clone(),b},d.prototype.getCoordinateN=function(b){return this._points.getCoordinate(b)},d.prototype.getGeometryType=function(){return"LineString"},d.prototype.copy=function(){return new d(this._points.copy(),this._factory)},d.prototype.getCoordinateSequence=function(){return this._points},d.prototype.isEmpty=function(){return 0===this._points.size()},d.prototype.init=function(b){if(null===b&&(b=this.getFactory().getCoordinateSequenceFactory().create([])),1===b.size())throw new pe("Invalid number of points in LineString (found "+b.size()+" - must be 0 or >= 2)");this._points=b},d.prototype.isCoordinate=function(b){for(var I=0;I<this._points.size();I++)if(this._points.getCoordinate(I).equals(b))return!0;return!1},d.prototype.getStartPoint=function(){return this.isEmpty()?null:this.getPointN(0)},d.prototype.getPointN=function(b){return this.getFactory().createPoint(this._points.getCoordinate(b))},d.prototype.interfaces_=function(){return[Ct]},d.prototype.getClass=function(){return d},_.serialVersionUID.get=function(){return 0x2b2b51ba435c8e00},Object.defineProperties(d,_),d}(Qt),ba=function(){};ba.prototype.interfaces_=function(){return[]},ba.prototype.getClass=function(){return ba};var gn=function(l){function d(b,I){l.call(this,I),this._coordinates=b||null,this.init(this._coordinates)}l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d;var _={serialVersionUID:{configurable:!0}};return d.prototype.computeEnvelopeInternal=function(){if(this.isEmpty())return new rn;var b=new rn;return b.expandToInclude(this._coordinates.getX(0),this._coordinates.getY(0)),b},d.prototype.getSortIndex=function(){return l.SORTINDEX_POINT},d.prototype.getCoordinates=function(){return this.isEmpty()?[]:[this.getCoordinate()]},d.prototype.equalsExact=function(){if(2===arguments.length){var b=arguments[0],I=arguments[1];return!!this.isEquivalentClass(b)&&(!(!this.isEmpty()||!b.isEmpty())||this.isEmpty()===b.isEmpty()&&this.equal(b.getCoordinate(),this.getCoordinate(),I))}return l.prototype.equalsExact.apply(this,arguments)},d.prototype.normalize=function(){},d.prototype.getCoordinate=function(){return 0!==this._coordinates.size()?this._coordinates.getCoordinate(0):null},d.prototype.getBoundaryDimension=function(){return Nt.FALSE},d.prototype.getDimension=function(){return 0},d.prototype.getNumPoints=function(){return this.isEmpty()?0:1},d.prototype.reverse=function(){return this.copy()},d.prototype.getX=function(){if(null===this.getCoordinate())throw new Error("getX called on empty Point");return this.getCoordinate().x},d.prototype.compareToSameClass=function(){if(1===arguments.length){var b=arguments[0];return this.getCoordinate().compareTo(b.getCoordinate())}if(2===arguments.length)return arguments[1].compare(this._coordinates,arguments[0]._coordinates)},d.prototype.apply=function(){if(Lt(arguments[0],Vr)){var b=arguments[0];if(this.isEmpty())return null;b.filter(this.getCoordinate())}else if(Lt(arguments[0],bn)){var I=arguments[0];if(this.isEmpty())return null;I.filter(this._coordinates,0),I.isGeometryChanged()&&this.geometryChanged()}else(Lt(arguments[0],Wt)||Lt(arguments[0],Er))&&arguments[0].filter(this)},d.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},d.prototype.clone=function(){var b=l.prototype.clone.call(this);return b._coordinates=this._coordinates.clone(),b},d.prototype.getGeometryType=function(){return"Point"},d.prototype.copy=function(){return new d(this._coordinates.copy(),this._factory)},d.prototype.getCoordinateSequence=function(){return this._coordinates},d.prototype.getY=function(){if(null===this.getCoordinate())throw new Error("getY called on empty Point");return this.getCoordinate().y},d.prototype.isEmpty=function(){return 0===this._coordinates.size()},d.prototype.init=function(b){null===b&&(b=this.getFactory().getCoordinateSequenceFactory().create([])),ae.isTrue(b.size()<=1),this._coordinates=b},d.prototype.isSimple=function(){return!0},d.prototype.interfaces_=function(){return[ba]},d.prototype.getClass=function(){return d},_.serialVersionUID.get=function(){return 0x44077bad161cbc00},Object.defineProperties(d,_),d}(Qt),Tr=function(){};Tr.prototype.interfaces_=function(){return[]},Tr.prototype.getClass=function(){return Tr};var Xn=function(l){function d(b,I,N){if(l.call(this,N),this._shell=null,this._holes=null,null===b&&(b=this.getFactory().createLinearRing()),null===I&&(I=[]),l.hasNullElements(I))throw new pe("holes must not contain null elements");if(b.isEmpty()&&l.hasNonEmptyElements(I))throw new pe("shell is empty but holes are not");this._shell=b,this._holes=I}l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d;var _={serialVersionUID:{configurable:!0}};return d.prototype.computeEnvelopeInternal=function(){return this._shell.getEnvelopeInternal()},d.prototype.getSortIndex=function(){return l.SORTINDEX_POLYGON},d.prototype.getCoordinates=function(){if(this.isEmpty())return[];for(var b=new Array(this.getNumPoints()).fill(null),I=-1,N=this._shell.getCoordinates(),j=0;j<N.length;j++)b[++I]=N[j];for(var ne=0;ne<this._holes.length;ne++)for(var Ee=this._holes[ne].getCoordinates(),it=0;it<Ee.length;it++)b[++I]=Ee[it];return b},d.prototype.getArea=function(){var b=0;b+=Math.abs(wt.signedArea(this._shell.getCoordinateSequence()));for(var I=0;I<this._holes.length;I++)b-=Math.abs(wt.signedArea(this._holes[I].getCoordinateSequence()));return b},d.prototype.isRectangle=function(){if(0!==this.getNumInteriorRing()||null===this._shell||5!==this._shell.getNumPoints())return!1;for(var b=this._shell.getCoordinateSequence(),I=this.getEnvelopeInternal(),N=0;N<5;N++){var j=b.getX(N);if(j!==I.getMinX()&&j!==I.getMaxX())return!1;var ne=b.getY(N);if(ne!==I.getMinY()&&ne!==I.getMaxY())return!1}for(var Ee=b.getX(0),it=b.getY(0),Bt=1;Bt<=4;Bt++){var zt=b.getX(Bt),vn=b.getY(Bt);if(zt!==Ee==(vn!==it))return!1;Ee=zt,it=vn}return!0},d.prototype.equalsExact=function(){if(2===arguments.length){var b=arguments[0],I=arguments[1];if(!this.isEquivalentClass(b))return!1;var N=b;if(!this._shell.equalsExact(N._shell,I)||this._holes.length!==N._holes.length)return!1;for(var Ee=0;Ee<this._holes.length;Ee++)if(!this._holes[Ee].equalsExact(N._holes[Ee],I))return!1;return!0}return l.prototype.equalsExact.apply(this,arguments)},d.prototype.normalize=function(){if(0===arguments.length){this.normalize(this._shell,!0);for(var b=0;b<this._holes.length;b++)this.normalize(this._holes[b],!1);Et.sort(this._holes)}else if(2===arguments.length){var I=arguments[0],N=arguments[1];if(I.isEmpty())return null;var j=new Array(I.getCoordinates().length-1).fill(null);In.arraycopy(I.getCoordinates(),0,j,0,j.length);var ne=yr.minCoordinate(I.getCoordinates());yr.scroll(j,ne),In.arraycopy(j,0,I.getCoordinates(),0,j.length),I.getCoordinates()[j.length]=j[0],wt.isCCW(I.getCoordinates())===N&&yr.reverse(I.getCoordinates())}},d.prototype.getCoordinate=function(){return this._shell.getCoordinate()},d.prototype.getNumInteriorRing=function(){return this._holes.length},d.prototype.getBoundaryDimension=function(){return 1},d.prototype.getDimension=function(){return 2},d.prototype.getLength=function(){var b=0;b+=this._shell.getLength();for(var I=0;I<this._holes.length;I++)b+=this._holes[I].getLength();return b},d.prototype.getNumPoints=function(){for(var b=this._shell.getNumPoints(),I=0;I<this._holes.length;I++)b+=this._holes[I].getNumPoints();return b},d.prototype.reverse=function(){var b=this.copy();b._shell=this._shell.copy().reverse(),b._holes=new Array(this._holes.length).fill(null);for(var I=0;I<this._holes.length;I++)b._holes[I]=this._holes[I].copy().reverse();return b},d.prototype.convexHull=function(){return this.getExteriorRing().convexHull()},d.prototype.compareToSameClass=function(){if(1===arguments.length)return this._shell.compareToSameClass(arguments[0]._shell);if(2===arguments.length){var ne=arguments[1],Ee=arguments[0],zt=this._shell.compareToSameClass(Ee._shell,ne);if(0!==zt)return zt;for(var vn=this.getNumInteriorRing(),pn=Ee.getNumInteriorRing(),Pn=0;Pn<vn&&Pn<pn;){var rr=this.getInteriorRingN(Pn),C=Ee.getInteriorRingN(Pn),c=rr.compareToSameClass(C,ne);if(0!==c)return c;Pn++}return Pn<vn?1:Pn<pn?-1:0}},d.prototype.apply=function(b){if(Lt(b,Vr)){this._shell.apply(b);for(var I=0;I<this._holes.length;I++)this._holes[I].apply(b)}else if(Lt(b,bn)){if(this._shell.apply(b),!b.isDone())for(var N=0;N<this._holes.length&&(this._holes[N].apply(b),!b.isDone());N++);b.isGeometryChanged()&&this.geometryChanged()}else if(Lt(b,Wt))b.filter(this);else if(Lt(b,Er)){b.filter(this),this._shell.apply(b);for(var j=0;j<this._holes.length;j++)this._holes[j].apply(b)}},d.prototype.getBoundary=function(){if(this.isEmpty())return this.getFactory().createMultiLineString();var b=new Array(this._holes.length+1).fill(null);b[0]=this._shell;for(var I=0;I<this._holes.length;I++)b[I+1]=this._holes[I];return b.length<=1?this.getFactory().createLinearRing(b[0].getCoordinateSequence()):this.getFactory().createMultiLineString(b)},d.prototype.clone=function(){var b=l.prototype.clone.call(this);b._shell=this._shell.clone(),b._holes=new Array(this._holes.length).fill(null);for(var I=0;I<this._holes.length;I++)b._holes[I]=this._holes[I].clone();return b},d.prototype.getGeometryType=function(){return"Polygon"},d.prototype.copy=function(){for(var b=this._shell.copy(),I=new Array(this._holes.length).fill(null),N=0;N<I.length;N++)I[N]=this._holes[N].copy();return new d(b,I,this._factory)},d.prototype.getExteriorRing=function(){return this._shell},d.prototype.isEmpty=function(){return this._shell.isEmpty()},d.prototype.getInteriorRingN=function(b){return this._holes[b]},d.prototype.interfaces_=function(){return[Tr]},d.prototype.getClass=function(){return d},_.serialVersionUID.get=function(){return-0x307ffefd8dc97200},Object.defineProperties(d,_),d}(Qt),wa=function(l){function d(){l.apply(this,arguments)}l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d;var _={serialVersionUID:{configurable:!0}};return d.prototype.getSortIndex=function(){return Qt.SORTINDEX_MULTIPOINT},d.prototype.isValid=function(){return!0},d.prototype.equalsExact=function(){if(2===arguments.length){var b=arguments[0],I=arguments[1];return!!this.isEquivalentClass(b)&&l.prototype.equalsExact.call(this,b,I)}return l.prototype.equalsExact.apply(this,arguments)},d.prototype.getCoordinate=function(){return 1===arguments.length?this._geometries[arguments[0]].getCoordinate():l.prototype.getCoordinate.apply(this,arguments)},d.prototype.getBoundaryDimension=function(){return Nt.FALSE},d.prototype.getDimension=function(){return 0},d.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},d.prototype.getGeometryType=function(){return"MultiPoint"},d.prototype.copy=function(){for(var b=new Array(this._geometries.length).fill(null),I=0;I<b.length;I++)b[I]=this._geometries[I].copy();return new d(b,this._factory)},d.prototype.interfaces_=function(){return[ba]},d.prototype.getClass=function(){return d},_.serialVersionUID.get=function(){return-0x6fb1ed4162e0fc00},Object.defineProperties(d,_),d}(tt),po=function(l){function d(b,I){b instanceof re&&I instanceof fr&&(b=I.getCoordinateSequenceFactory().create(b)),l.call(this,b,I),this.validateConstruction()}l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d;var _={MINIMUM_VALID_SIZE:{configurable:!0},serialVersionUID:{configurable:!0}};return d.prototype.getSortIndex=function(){return Qt.SORTINDEX_LINEARRING},d.prototype.getBoundaryDimension=function(){return Nt.FALSE},d.prototype.isClosed=function(){return!!this.isEmpty()||l.prototype.isClosed.call(this)},d.prototype.reverse=function(){var b=this._points.copy();return ir.reverse(b),this.getFactory().createLinearRing(b)},d.prototype.validateConstruction=function(){if(!this.isEmpty()&&!l.prototype.isClosed.call(this))throw new pe("Points of LinearRing do not form a closed linestring");if(this.getCoordinateSequence().size()>=1&&this.getCoordinateSequence().size()<d.MINIMUM_VALID_SIZE)throw new pe("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")},d.prototype.getGeometryType=function(){return"LinearRing"},d.prototype.copy=function(){return new d(this._points.copy(),this._factory)},d.prototype.interfaces_=function(){return[]},d.prototype.getClass=function(){return d},_.MINIMUM_VALID_SIZE.get=function(){return 4},_.serialVersionUID.get=function(){return-0x3b229e262367a600},Object.defineProperties(d,_),d}(vr),Rn=function(l){function d(){l.apply(this,arguments)}l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d;var _={serialVersionUID:{configurable:!0}};return d.prototype.getSortIndex=function(){return Qt.SORTINDEX_MULTIPOLYGON},d.prototype.equalsExact=function(){if(2===arguments.length){var b=arguments[0],I=arguments[1];return!!this.isEquivalentClass(b)&&l.prototype.equalsExact.call(this,b,I)}return l.prototype.equalsExact.apply(this,arguments)},d.prototype.getBoundaryDimension=function(){return 1},d.prototype.getDimension=function(){return 2},d.prototype.reverse=function(){for(var I=new Array(this._geometries.length).fill(null),N=0;N<this._geometries.length;N++)I[N]=this._geometries[N].reverse();return this.getFactory().createMultiPolygon(I)},d.prototype.getBoundary=function(){if(this.isEmpty())return this.getFactory().createMultiLineString();for(var b=new ln,I=0;I<this._geometries.length;I++)for(var N=this._geometries[I].getBoundary(),j=0;j<N.getNumGeometries();j++)b.add(N.getGeometryN(j));var ne=new Array(b.size()).fill(null);return this.getFactory().createMultiLineString(b.toArray(ne))},d.prototype.getGeometryType=function(){return"MultiPolygon"},d.prototype.copy=function(){for(var b=new Array(this._geometries.length).fill(null),I=0;I<b.length;I++)b[I]=this._geometries[I].copy();return new d(b,this._factory)},d.prototype.interfaces_=function(){return[Tr]},d.prototype.getClass=function(){return d},_.serialVersionUID.get=function(){return-0x7a5aa1369171980},Object.defineProperties(d,_),d}(tt),Js=function(l){this._factory=l||null,this._isUserDataCopied=!1},Nr={NoOpGeometryOperation:{configurable:!0},CoordinateOperation:{configurable:!0},CoordinateSequenceOperation:{configurable:!0}};Js.prototype.setCopyUserData=function(l){this._isUserDataCopied=l},Js.prototype.edit=function(l,d){if(null===l)return null;var _=this.editInternal(l,d);return this._isUserDataCopied&&_.setUserData(l.getUserData()),_},Js.prototype.editInternal=function(l,d){return null===this._factory&&(this._factory=l.getFactory()),l instanceof tt?this.editGeometryCollection(l,d):l instanceof Xn?this.editPolygon(l,d):l instanceof gn||l instanceof vr?d.edit(l,this._factory):(ae.shouldNeverReachHere("Unsupported Geometry class: "+l.getClass().getName()),null)},Js.prototype.editGeometryCollection=function(l,d){for(var _=d.edit(l,this._factory),b=new ln,I=0;I<_.getNumGeometries();I++){var N=this.edit(_.getGeometryN(I),d);null===N||N.isEmpty()||b.add(N)}return _.getClass()===wa?this._factory.createMultiPoint(b.toArray([])):_.getClass()===Vt?this._factory.createMultiLineString(b.toArray([])):_.getClass()===Rn?this._factory.createMultiPolygon(b.toArray([])):this._factory.createGeometryCollection(b.toArray([]))},Js.prototype.editPolygon=function(l,d){var _=d.edit(l,this._factory);if(null===_&&(_=this._factory.createPolygon(null)),_.isEmpty())return _;var b=this.edit(_.getExteriorRing(),d);if(null===b||b.isEmpty())return this._factory.createPolygon();for(var I=new ln,N=0;N<_.getNumInteriorRing();N++){var j=this.edit(_.getInteriorRingN(N),d);null===j||j.isEmpty()||I.add(j)}return this._factory.createPolygon(b,I.toArray([]))},Js.prototype.interfaces_=function(){return[]},Js.prototype.getClass=function(){return Js},Js.GeometryEditorOperation=function(){},Nr.NoOpGeometryOperation.get=function(){return Gl},Nr.CoordinateOperation.get=function(){return Ea},Nr.CoordinateSequenceOperation.get=function(){return _r},Object.defineProperties(Js,Nr);var Gl=function(){};Gl.prototype.edit=function(l,d){return l},Gl.prototype.interfaces_=function(){return[Js.GeometryEditorOperation]},Gl.prototype.getClass=function(){return Gl};var Ea=function(){};Ea.prototype.edit=function(l,d){var _=this.editCoordinates(l.getCoordinates(),l);return null===_?l:l instanceof po?d.createLinearRing(_):l instanceof vr?d.createLineString(_):l instanceof gn?_.length>0?d.createPoint(_[0]):d.createPoint():l},Ea.prototype.interfaces_=function(){return[Js.GeometryEditorOperation]},Ea.prototype.getClass=function(){return Ea};var _r=function(){};_r.prototype.edit=function(l,d){return l instanceof po?d.createLinearRing(this.edit(l.getCoordinateSequence(),l)):l instanceof vr?d.createLineString(this.edit(l.getCoordinateSequence(),l)):l instanceof gn?d.createPoint(this.edit(l.getCoordinateSequence(),l)):l},_r.prototype.interfaces_=function(){return[Js.GeometryEditorOperation]},_r.prototype.getClass=function(){return _r};var Ln=function(){if(this._dimension=3,this._coordinates=null,1===arguments.length){if(arguments[0]instanceof Array)this._coordinates=arguments[0],this._dimension=3;else if(Number.isInteger(arguments[0])){var l=arguments[0];this._coordinates=new Array(l).fill(null);for(var d=0;d<l;d++)this._coordinates[d]=new re}else if(Lt(arguments[0],Gt)){var _=arguments[0];if(null===_)return this._coordinates=new Array(0).fill(null),null;this._dimension=_.getDimension(),this._coordinates=new Array(_.size()).fill(null);for(var b=0;b<this._coordinates.length;b++)this._coordinates[b]=_.getCoordinateCopy(b)}}else if(2===arguments.length)if(arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var I=arguments[0],N=arguments[1];this._coordinates=I,this._dimension=N,null===I&&(this._coordinates=new Array(0).fill(null))}else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var j=arguments[0],ne=arguments[1];this._coordinates=new Array(j).fill(null),this._dimension=ne;for(var Ee=0;Ee<j;Ee++)this._coordinates[Ee]=new re}},wu={serialVersionUID:{configurable:!0}};Ln.prototype.setOrdinate=function(l,d,_){switch(d){case Gt.X:this._coordinates[l].x=_;break;case Gt.Y:this._coordinates[l].y=_;break;case Gt.Z:this._coordinates[l].z=_;break;default:throw new pe("invalid ordinateIndex")}},Ln.prototype.size=function(){return this._coordinates.length},Ln.prototype.getOrdinate=function(l,d){switch(d){case Gt.X:return this._coordinates[l].x;case Gt.Y:return this._coordinates[l].y;case Gt.Z:return this._coordinates[l].z}return le.NaN},Ln.prototype.getCoordinate=function(){if(1===arguments.length)return this._coordinates[arguments[0]];if(2===arguments.length){var d=arguments[0],_=arguments[1];_.x=this._coordinates[d].x,_.y=this._coordinates[d].y,_.z=this._coordinates[d].z}},Ln.prototype.getCoordinateCopy=function(l){return new re(this._coordinates[l])},Ln.prototype.getDimension=function(){return this._dimension},Ln.prototype.getX=function(l){return this._coordinates[l].x},Ln.prototype.clone=function(){for(var l=new Array(this.size()).fill(null),d=0;d<this._coordinates.length;d++)l[d]=this._coordinates[d].clone();return new Ln(l,this._dimension)},Ln.prototype.expandEnvelope=function(l){for(var d=0;d<this._coordinates.length;d++)l.expandToInclude(this._coordinates[d]);return l},Ln.prototype.copy=function(){for(var l=new Array(this.size()).fill(null),d=0;d<this._coordinates.length;d++)l[d]=this._coordinates[d].copy();return new Ln(l,this._dimension)},Ln.prototype.toString=function(){if(this._coordinates.length>0){var l=new Pe(17*this._coordinates.length);l.append("("),l.append(this._coordinates[0]);for(var d=1;d<this._coordinates.length;d++)l.append(", "),l.append(this._coordinates[d]);return l.append(")"),l.toString()}return"()"},Ln.prototype.getY=function(l){return this._coordinates[l].y},Ln.prototype.toCoordinateArray=function(){return this._coordinates},Ln.prototype.interfaces_=function(){return[Gt,De]},Ln.prototype.getClass=function(){return Ln},wu.serialVersionUID.get=function(){return-0xcb44a778db18e00},Object.defineProperties(Ln,wu);var $l=function(){},Qs={serialVersionUID:{configurable:!0},instanceObject:{configurable:!0}};$l.prototype.readResolve=function(){return $l.instance()},$l.prototype.create=function(){if(1===arguments.length){if(arguments[0]instanceof Array)return new Ln(arguments[0]);if(Lt(arguments[0],Gt))return new Ln(arguments[0])}else if(2===arguments.length){var _=arguments[0],b=arguments[1];return b>3&&(b=3),b<2?new Ln(_):new Ln(_,b)}},$l.prototype.interfaces_=function(){return[Oe,De]},$l.prototype.getClass=function(){return $l},$l.instance=function(){return $l.instanceObject},Qs.serialVersionUID.get=function(){return-0x38e49fa6cf6f2e00},Qs.instanceObject.get=function(){return new $l},Object.defineProperties($l,Qs);var pd=function(l){function d(){l.call(this),this.map_=new Map}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.get=function(_){return this.map_.get(_)||null},d.prototype.put=function(_,b){return this.map_.set(_,b),b},d.prototype.values=function(){for(var _=new ln,b=this.map_.values(),I=b.next();!I.done;)_.add(I.value),I=b.next();return _},d.prototype.entrySet=function(){var _=new je;return this.map_.entries().forEach(function(b){return _.add(b)}),_},d.prototype.size=function(){return this.map_.size()},d}(oe),Or=function l(){if(this._modelType=null,this._scale=null,0===arguments.length)this._modelType=l.FLOATING;else if(1===arguments.length)if(arguments[0]instanceof go){var d=arguments[0];this._modelType=d,d===l.FIXED&&this.setScale(1)}else if("number"==typeof arguments[0]){var _=arguments[0];this._modelType=l.FIXED,this.setScale(_)}else if(arguments[0]instanceof l){var b=arguments[0];this._modelType=b._modelType,this._scale=b._scale}},Nn={serialVersionUID:{configurable:!0},maximumPreciseValue:{configurable:!0}};Or.prototype.equals=function(l){return l instanceof Or&&this._modelType===l._modelType&&this._scale===l._scale},Or.prototype.compareTo=function(l){var d=l,_=this.getMaximumSignificantDigits(),b=d.getMaximumSignificantDigits();return new lt(_).compareTo(new lt(b))},Or.prototype.getScale=function(){return this._scale},Or.prototype.isFloating=function(){return this._modelType===Or.FLOATING||this._modelType===Or.FLOATING_SINGLE},Or.prototype.getType=function(){return this._modelType},Or.prototype.toString=function(){var l="UNKNOWN";return this._modelType===Or.FLOATING?l="Floating":this._modelType===Or.FLOATING_SINGLE?l="Floating-Single":this._modelType===Or.FIXED&&(l="Fixed (Scale="+this.getScale()+")"),l},Or.prototype.makePrecise=function(){if("number"==typeof arguments[0]){var l=arguments[0];return le.isNaN(l)||this._modelType===Or.FLOATING_SINGLE?l:this._modelType===Or.FIXED?Math.round(l*this._scale)/this._scale:l}if(arguments[0]instanceof re){var d=arguments[0];if(this._modelType===Or.FLOATING)return null;d.x=this.makePrecise(d.x),d.y=this.makePrecise(d.y)}},Or.prototype.getMaximumSignificantDigits=function(){var l=16;return this._modelType===Or.FLOATING?l=16:this._modelType===Or.FLOATING_SINGLE?l=6:this._modelType===Or.FIXED&&(l=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),l},Or.prototype.setScale=function(l){this._scale=Math.abs(l)},Or.prototype.interfaces_=function(){return[De,he]},Or.prototype.getClass=function(){return Or},Or.mostPrecise=function(l,d){return l.compareTo(d)>=0?l:d},Nn.serialVersionUID.get=function(){return 0x6bee6404e9a25c00},Nn.maximumPreciseValue.get=function(){return 9007199254740992},Object.defineProperties(Or,Nn);var go=function l(d){this._name=d||null,l.nameToTypeMap.put(d,this)},Gu={serialVersionUID:{configurable:!0},nameToTypeMap:{configurable:!0}};go.prototype.readResolve=function(){return go.nameToTypeMap.get(this._name)},go.prototype.toString=function(){return this._name},go.prototype.interfaces_=function(){return[De]},go.prototype.getClass=function(){return go},Gu.serialVersionUID.get=function(){return-552860263173159e4},Gu.nameToTypeMap.get=function(){return new pd},Object.defineProperties(go,Gu),Or.Type=go,Or.FIXED=new go("FIXED"),Or.FLOATING=new go("FLOATING"),Or.FLOATING_SINGLE=new go("FLOATING SINGLE");var fr=function l(){this._precisionModel=new Or,this._SRID=0,this._coordinateSequenceFactory=l.getDefaultCoordinateSequenceFactory(),0===arguments.length||(1===arguments.length?Lt(arguments[0],Oe)?this._coordinateSequenceFactory=arguments[0]:arguments[0]instanceof Or&&(this._precisionModel=arguments[0]):2===arguments.length?(this._precisionModel=arguments[0],this._SRID=arguments[1]):3===arguments.length&&(this._precisionModel=arguments[0],this._SRID=arguments[1],this._coordinateSequenceFactory=arguments[2]))},Hl={serialVersionUID:{configurable:!0}};fr.prototype.toGeometry=function(l){return l.isNull()?this.createPoint(null):l.getMinX()===l.getMaxX()&&l.getMinY()===l.getMaxY()?this.createPoint(new re(l.getMinX(),l.getMinY())):l.getMinX()===l.getMaxX()||l.getMinY()===l.getMaxY()?this.createLineString([new re(l.getMinX(),l.getMinY()),new re(l.getMaxX(),l.getMaxY())]):this.createPolygon(this.createLinearRing([new re(l.getMinX(),l.getMinY()),new re(l.getMinX(),l.getMaxY()),new re(l.getMaxX(),l.getMaxY()),new re(l.getMaxX(),l.getMinY()),new re(l.getMinX(),l.getMinY())]),null)},fr.prototype.createLineString=function(l){return l?l instanceof Array?new vr(this.getCoordinateSequenceFactory().create(l),this):Lt(l,Gt)?new vr(l,this):void 0:new vr(this.getCoordinateSequenceFactory().create([]),this)},fr.prototype.createMultiLineString=function(){return 0===arguments.length?new Vt(null,this):1===arguments.length?new Vt(arguments[0],this):void 0},fr.prototype.buildGeometry=function(l){for(var d=null,_=!1,b=!1,I=l.iterator();I.hasNext();){var N=I.next(),j=N.getClass();null===d&&(d=j),j!==d&&(_=!0),N.isGeometryCollectionOrDerived()&&(b=!0)}if(null===d)return this.createGeometryCollection();if(_||b)return this.createGeometryCollection(fr.toGeometryArray(l));var ne=l.iterator().next();if(l.size()>1){if(ne instanceof Xn)return this.createMultiPolygon(fr.toPolygonArray(l));if(ne instanceof vr)return this.createMultiLineString(fr.toLineStringArray(l));if(ne instanceof gn)return this.createMultiPoint(fr.toPointArray(l));ae.shouldNeverReachHere("Unhandled class: "+ne.getClass().getName())}return ne},fr.prototype.createMultiPointFromCoords=function(l){return this.createMultiPoint(null!==l?this.getCoordinateSequenceFactory().create(l):null)},fr.prototype.createPoint=function(){if(0===arguments.length)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof re){var l=arguments[0];return this.createPoint(null!==l?this.getCoordinateSequenceFactory().create([l]):null)}if(Lt(arguments[0],Gt))return new gn(arguments[0],this)}},fr.prototype.getCoordinateSequenceFactory=function(){return this._coordinateSequenceFactory},fr.prototype.createPolygon=function(){if(0===arguments.length)return new Xn(null,null,this);if(1===arguments.length){if(Lt(arguments[0],Gt))return this.createPolygon(this.createLinearRing(arguments[0]));if(arguments[0]instanceof Array)return this.createPolygon(this.createLinearRing(arguments[0]));if(arguments[0]instanceof po)return this.createPolygon(arguments[0],null)}else if(2===arguments.length)return new Xn(arguments[0],arguments[1],this)},fr.prototype.getSRID=function(){return this._SRID},fr.prototype.createGeometryCollection=function(){return 0===arguments.length?new tt(null,this):1===arguments.length?new tt(arguments[0],this):void 0},fr.prototype.createGeometry=function(l){return new Js(this).edit(l,{edit:function(){if(2===arguments.length)return this._coordinateSequenceFactory.create(arguments[0])}})},fr.prototype.getPrecisionModel=function(){return this._precisionModel},fr.prototype.createLinearRing=function(){if(0===arguments.length)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof Array){var l=arguments[0];return this.createLinearRing(null!==l?this.getCoordinateSequenceFactory().create(l):null)}if(Lt(arguments[0],Gt))return new po(arguments[0],this)}},fr.prototype.createMultiPolygon=function(){return 0===arguments.length?new Rn(null,this):1===arguments.length?new Rn(arguments[0],this):void 0},fr.prototype.createMultiPoint=function(){if(0===arguments.length)return new wa(null,this);if(1===arguments.length){if(arguments[0]instanceof Array)return new wa(arguments[0],this);if(arguments[0]instanceof Array){var d=arguments[0];return this.createMultiPoint(null!==d?this.getCoordinateSequenceFactory().create(d):null)}if(Lt(arguments[0],Gt)){var _=arguments[0];if(null===_)return this.createMultiPoint(new Array(0).fill(null));for(var b=new Array(_.size()).fill(null),I=0;I<_.size();I++){var N=this.getCoordinateSequenceFactory().create(1,_.getDimension());ir.copy(_,I,N,0,1),b[I]=this.createPoint(N)}return this.createMultiPoint(b)}}},fr.prototype.interfaces_=function(){return[De]},fr.prototype.getClass=function(){return fr},fr.toMultiPolygonArray=function(l){var d=new Array(l.size()).fill(null);return l.toArray(d)},fr.toGeometryArray=function(l){if(null===l)return null;var d=new Array(l.size()).fill(null);return l.toArray(d)},fr.getDefaultCoordinateSequenceFactory=function(){return $l.instance()},fr.toMultiLineStringArray=function(l){var d=new Array(l.size()).fill(null);return l.toArray(d)},fr.toLineStringArray=function(l){var d=new Array(l.size()).fill(null);return l.toArray(d)},fr.toMultiPointArray=function(l){var d=new Array(l.size()).fill(null);return l.toArray(d)},fr.toLinearRingArray=function(l){var d=new Array(l.size()).fill(null);return l.toArray(d)},fr.toPointArray=function(l){var d=new Array(l.size()).fill(null);return l.toArray(d)},fr.toPolygonArray=function(l){var d=new Array(l.size()).fill(null);return l.toArray(d)},fr.createPointFromInternalCoord=function(l,d){return d.getPrecisionModel().makePrecise(l),d.getFactory().createPoint(l)},Hl.serialVersionUID.get=function(){return-0x5ea75f2051eeb400},Object.defineProperties(fr,Hl);var Oh=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],ea=function(l){this.geometryFactory=l||new fr};ea.prototype.read=function(l){var d,_=(d="string"==typeof l?JSON.parse(l):l).type;if(!to[_])throw new Error("Unknown GeoJSON type: "+d.type);return-1!==Oh.indexOf(_)?to[_].apply(this,[d.coordinates]):to[_].apply(this,"GeometryCollection"===_?[d.geometries]:[d])},ea.prototype.write=function(l){var d=l.getGeometryType();if(!za[d])throw new Error("Geometry is not supported");return za[d].apply(this,[l])};var to={Feature:function(l){var d={};for(var _ in l)d[_]=l[_];if(l.geometry){if(!to[l.geometry.type])throw new Error("Unknown GeoJSON type: "+l.type);d.geometry=this.read(l.geometry)}return l.bbox&&(d.bbox=to.bbox.apply(this,[l.bbox])),d},FeatureCollection:function(l){var d={};if(l.features){d.features=[];for(var _=0;_<l.features.length;++_)d.features.push(this.read(l.features[_]))}return l.bbox&&(d.bbox=this.parse.bbox.apply(this,[l.bbox])),d},coordinates:function(l){for(var d=[],_=0;_<l.length;++_){var b=l[_];d.push(new re(b[0],b[1]))}return d},bbox:function(l){return this.geometryFactory.createLinearRing([new re(l[0],l[1]),new re(l[2],l[1]),new re(l[2],l[3]),new re(l[0],l[3]),new re(l[0],l[1])])},Point:function(l){var d=new re(l[0],l[1]);return this.geometryFactory.createPoint(d)},MultiPoint:function(l){for(var d=[],_=0;_<l.length;++_)d.push(to.Point.apply(this,[l[_]]));return this.geometryFactory.createMultiPoint(d)},LineString:function(l){var d=to.coordinates.apply(this,[l]);return this.geometryFactory.createLineString(d)},MultiLineString:function(l){for(var d=[],_=0;_<l.length;++_)d.push(to.LineString.apply(this,[l[_]]));return this.geometryFactory.createMultiLineString(d)},Polygon:function(l){for(var d=to.coordinates.apply(this,[l[0]]),_=this.geometryFactory.createLinearRing(d),b=[],I=1;I<l.length;++I){var j=to.coordinates.apply(this,[l[I]]),ne=this.geometryFactory.createLinearRing(j);b.push(ne)}return this.geometryFactory.createPolygon(_,b)},MultiPolygon:function(l){for(var d=[],_=0;_<l.length;++_)d.push(to.Polygon.apply(this,[l[_]]));return this.geometryFactory.createMultiPolygon(d)},GeometryCollection:function(l){for(var d=[],_=0;_<l.length;++_)d.push(this.read(l[_]));return this.geometryFactory.createGeometryCollection(d)}},za={coordinate:function(l){return[l.x,l.y]},Point:function(l){return{type:"Point",coordinates:za.coordinate.apply(this,[l.getCoordinate()])}},MultiPoint:function(l){for(var d=[],_=0;_<l._geometries.length;++_){var I=za.Point.apply(this,[l._geometries[_]]);d.push(I.coordinates)}return{type:"MultiPoint",coordinates:d}},LineString:function(l){for(var d=[],_=l.getCoordinates(),b=0;b<_.length;++b)d.push(za.coordinate.apply(this,[_[b]]));return{type:"LineString",coordinates:d}},MultiLineString:function(l){for(var d=[],_=0;_<l._geometries.length;++_){var I=za.LineString.apply(this,[l._geometries[_]]);d.push(I.coordinates)}return{type:"MultiLineString",coordinates:d}},Polygon:function(l){var d=[],_=za.LineString.apply(this,[l._shell]);d.push(_.coordinates);for(var b=0;b<l._holes.length;++b){var N=za.LineString.apply(this,[l._holes[b]]);d.push(N.coordinates)}return{type:"Polygon",coordinates:d}},MultiPolygon:function(l){for(var d=[],_=0;_<l._geometries.length;++_){var I=za.Polygon.apply(this,[l._geometries[_]]);d.push(I.coordinates)}return{type:"MultiPolygon",coordinates:d}},GeometryCollection:function(l){for(var d=[],_=0;_<l._geometries.length;++_){var b=l._geometries[_],I=b.getGeometryType();d.push(za[I].apply(this,[b]))}return{type:"GeometryCollection",geometries:d}}},fc=function(l){this.geometryFactory=l||new fr,this.precisionModel=this.geometryFactory.getPrecisionModel(),this.parser=new ea(this.geometryFactory)};fc.prototype.read=function(l){var d=this.parser.read(l);return this.precisionModel.getType()===Or.FIXED&&this.reducePrecision(d),d},fc.prototype.reducePrecision=function(l){var d,_;if(l.coordinate)this.precisionModel.makePrecise(l.coordinate);else if(l.points)for(d=0,_=l.points.length;d<_;d++)this.precisionModel.makePrecise(l.points[d]);else if(l.geometries)for(d=0,_=l.geometries.length;d<_;d++)this.reducePrecision(l.geometries[d])};var mo=function(){this.parser=new ea(this.geometryFactory)};mo.prototype.write=function(l){return this.parser.write(l)};var mn=function(){},xl={ON:{configurable:!0},LEFT:{configurable:!0},RIGHT:{configurable:!0}};mn.prototype.interfaces_=function(){return[]},mn.prototype.getClass=function(){return mn},mn.opposite=function(l){return l===mn.LEFT?mn.RIGHT:l===mn.RIGHT?mn.LEFT:l},xl.ON.get=function(){return 0},xl.LEFT.get=function(){return 1},xl.RIGHT.get=function(){return 2},Object.defineProperties(mn,xl),(fe.prototype=new Error).name="EmptyStackException",(Se.prototype=new fo).add=function(l){return this.array_.push(l),!0},Se.prototype.get=function(l){if(l<0||l>=this.size())throw new Error;return this.array_[l]},Se.prototype.push=function(l){return this.array_.push(l),l},Se.prototype.pop=function(l){if(0===this.array_.length)throw new fe;return this.array_.pop()},Se.prototype.peek=function(){if(0===this.array_.length)throw new fe;return this.array_[this.array_.length-1]},Se.prototype.empty=function(){return 0===this.array_.length},Se.prototype.isEmpty=function(){return this.empty()},Se.prototype.search=function(l){return this.array_.indexOf(l)},Se.prototype.size=function(){return this.array_.length},Se.prototype.toArray=function(){for(var l=[],d=0,_=this.array_.length;d<_;d++)l.push(this.array_[d]);return l};var Za=function(){this._minIndex=-1,this._minCoord=null,this._minDe=null,this._orientedDe=null};Za.prototype.getCoordinate=function(){return this._minCoord},Za.prototype.getRightmostSide=function(l,d){var _=this.getRightmostSideOfSegment(l,d);return _<0&&(_=this.getRightmostSideOfSegment(l,d-1)),_<0&&(this._minCoord=null,this.checkForRightmostCoordinate(l)),_},Za.prototype.findRightmostEdgeAtVertex=function(){var l=this._minDe.getEdge().getCoordinates();ae.isTrue(this._minIndex>0&&this._minIndex<l.length,"rightmost point expected to be interior vertex of edge");var d=l[this._minIndex-1],_=l[this._minIndex+1],b=wt.computeOrientation(this._minCoord,_,d),I=!1;(d.y<this._minCoord.y&&_.y<this._minCoord.y&&b===wt.COUNTERCLOCKWISE||d.y>this._minCoord.y&&_.y>this._minCoord.y&&b===wt.CLOCKWISE)&&(I=!0),I&&(this._minIndex=this._minIndex-1)},Za.prototype.getRightmostSideOfSegment=function(l,d){var _=l.getEdge().getCoordinates();if(d<0||d+1>=_.length||_[d].y===_[d+1].y)return-1;var b=mn.LEFT;return _[d].y<_[d+1].y&&(b=mn.RIGHT),b},Za.prototype.getEdge=function(){return this._orientedDe},Za.prototype.checkForRightmostCoordinate=function(l){for(var d=l.getEdge().getCoordinates(),_=0;_<d.length-1;_++)(null===this._minCoord||d[_].x>this._minCoord.x)&&(this._minDe=l,this._minIndex=_,this._minCoord=d[_])},Za.prototype.findRightmostEdgeAtNode=function(){var l=this._minDe.getNode().getEdges();this._minDe=l.getRightmostEdge(),this._minDe.isForward()||(this._minDe=this._minDe.getSym(),this._minIndex=this._minDe.getEdge().getCoordinates().length-1)},Za.prototype.findEdge=function(l){for(var d=l.iterator();d.hasNext();){var _=d.next();_.isForward()&&this.checkForRightmostCoordinate(_)}ae.isTrue(0!==this._minIndex||this._minCoord.equals(this._minDe.getCoordinate()),"inconsistency in rightmost processing"),0===this._minIndex?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex(),this._orientedDe=this._minDe,this.getRightmostSide(this._minDe,this._minIndex)===mn.LEFT&&(this._orientedDe=this._minDe.getSym())},Za.prototype.interfaces_=function(){return[]},Za.prototype.getClass=function(){return Za};var ql=function(l){function d(_,b){l.call(this,d.msgWithCoord(_,b)),this.pt=b?new re(b):null,this.name="TopologyException"}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.getCoordinate=function(){return this.pt},d.prototype.interfaces_=function(){return[]},d.prototype.getClass=function(){return d},d.msgWithCoord=function(_,b){return b?_:_+" [ "+b+" ]"},d}(ve),gd=function(){this.array_=[]};gd.prototype.addLast=function(l){this.array_.push(l)},gd.prototype.removeFirst=function(){return this.array_.shift()},gd.prototype.isEmpty=function(){return 0===this.array_.length};var os=function(){this._finder=null,this._dirEdgeList=new ln,this._nodes=new ln,this._rightMostCoord=null,this._env=null,this._finder=new Za};os.prototype.clearVisitedEdges=function(){for(var l=this._dirEdgeList.iterator();l.hasNext();)l.next().setVisited(!1)},os.prototype.getRightmostCoordinate=function(){return this._rightMostCoord},os.prototype.computeNodeDepth=function(l){for(var d=null,_=l.getEdges().iterator();_.hasNext();){var b=_.next();if(b.isVisited()||b.getSym().isVisited()){d=b;break}}if(null===d)throw new ql("unable to find edge to compute depths at "+l.getCoordinate());l.getEdges().computeDepths(d);for(var I=l.getEdges().iterator();I.hasNext();){var N=I.next();N.setVisited(!0),this.copySymDepths(N)}},os.prototype.computeDepth=function(l){this.clearVisitedEdges();var d=this._finder.getEdge();d.setEdgeDepths(mn.RIGHT,l),this.copySymDepths(d),this.computeDepths(d)},os.prototype.create=function(l){this.addReachable(l),this._finder.findEdge(this._dirEdgeList),this._rightMostCoord=this._finder.getCoordinate()},os.prototype.findResultEdges=function(){for(var l=this._dirEdgeList.iterator();l.hasNext();){var d=l.next();d.getDepth(mn.RIGHT)>=1&&d.getDepth(mn.LEFT)<=0&&!d.isInteriorAreaEdge()&&d.setInResult(!0)}},os.prototype.computeDepths=function(l){var d=new je,_=new gd,b=l.getNode();for(_.addLast(b),d.add(b),l.setVisited(!0);!_.isEmpty();){var I=_.removeFirst();d.add(I),this.computeNodeDepth(I);for(var N=I.getEdges().iterator();N.hasNext();){var j=N.next().getSym();if(!j.isVisited()){var ne=j.getNode();d.contains(ne)||(_.addLast(ne),d.add(ne))}}}},os.prototype.compareTo=function(l){return this._rightMostCoord.x<l._rightMostCoord.x?-1:this._rightMostCoord.x>l._rightMostCoord.x?1:0},os.prototype.getEnvelope=function(){if(null===this._env){for(var l=new rn,d=this._dirEdgeList.iterator();d.hasNext();)for(var _=d.next().getEdge().getCoordinates(),b=0;b<_.length-1;b++)l.expandToInclude(_[b]);this._env=l}return this._env},os.prototype.addReachable=function(l){var d=new Se;for(d.add(l);!d.empty();){var _=d.pop();this.add(_,d)}},os.prototype.copySymDepths=function(l){var d=l.getSym();d.setDepth(mn.LEFT,l.getDepth(mn.RIGHT)),d.setDepth(mn.RIGHT,l.getDepth(mn.LEFT))},os.prototype.add=function(l,d){l.setVisited(!0),this._nodes.add(l);for(var _=l.getEdges().iterator();_.hasNext();){var b=_.next();this._dirEdgeList.add(b);var I=b.getSym().getNode();I.isVisited()||d.push(I)}},os.prototype.getNodes=function(){return this._nodes},os.prototype.getDirectedEdges=function(){return this._dirEdgeList},os.prototype.interfaces_=function(){return[he]},os.prototype.getClass=function(){return os};var no=function l(){if(this.location=null,1===arguments.length){if(arguments[0]instanceof Array)this.init(arguments[0].length);else if(Number.isInteger(arguments[0])){var _=arguments[0];this.init(1),this.location[mn.ON]=_}else if(arguments[0]instanceof l){var b=arguments[0];if(this.init(b.location.length),null!==b)for(var I=0;I<this.location.length;I++)this.location[I]=b.location[I]}}else if(3===arguments.length){var N=arguments[0],j=arguments[1],ne=arguments[2];this.init(3),this.location[mn.ON]=N,this.location[mn.LEFT]=j,this.location[mn.RIGHT]=ne}};no.prototype.setAllLocations=function(l){for(var d=0;d<this.location.length;d++)this.location[d]=l},no.prototype.isNull=function(){for(var l=0;l<this.location.length;l++)if(this.location[l]!==xe.NONE)return!1;return!0},no.prototype.setAllLocationsIfNull=function(l){for(var d=0;d<this.location.length;d++)this.location[d]===xe.NONE&&(this.location[d]=l)},no.prototype.isLine=function(){return 1===this.location.length},no.prototype.merge=function(l){if(l.location.length>this.location.length){var d=new Array(3).fill(null);d[mn.ON]=this.location[mn.ON],d[mn.LEFT]=xe.NONE,d[mn.RIGHT]=xe.NONE,this.location=d}for(var _=0;_<this.location.length;_++)this.location[_]===xe.NONE&&_<l.location.length&&(this.location[_]=l.location[_])},no.prototype.getLocations=function(){return this.location},no.prototype.flip=function(){if(this.location.length<=1)return null;var l=this.location[mn.LEFT];this.location[mn.LEFT]=this.location[mn.RIGHT],this.location[mn.RIGHT]=l},no.prototype.toString=function(){var l=new Pe;return this.location.length>1&&l.append(xe.toLocationSymbol(this.location[mn.LEFT])),l.append(xe.toLocationSymbol(this.location[mn.ON])),this.location.length>1&&l.append(xe.toLocationSymbol(this.location[mn.RIGHT])),l.toString()},no.prototype.setLocations=function(l,d,_){this.location[mn.ON]=l,this.location[mn.LEFT]=d,this.location[mn.RIGHT]=_},no.prototype.get=function(l){return l<this.location.length?this.location[l]:xe.NONE},no.prototype.isArea=function(){return this.location.length>1},no.prototype.isAnyNull=function(){for(var l=0;l<this.location.length;l++)if(this.location[l]===xe.NONE)return!0;return!1},no.prototype.setLocation=function(){1===arguments.length?this.setLocation(mn.ON,arguments[0]):2===arguments.length&&(this.location[arguments[0]]=arguments[1])},no.prototype.init=function(l){this.location=new Array(l).fill(null),this.setAllLocations(xe.NONE)},no.prototype.isEqualOnSide=function(l,d){return this.location[d]===l.location[d]},no.prototype.allPositionsEqual=function(l){for(var d=0;d<this.location.length;d++)if(this.location[d]!==l)return!1;return!0},no.prototype.interfaces_=function(){return[]},no.prototype.getClass=function(){return no};var li=function l(){if(this.elt=new Array(2).fill(null),1===arguments.length){if(Number.isInteger(arguments[0])){var d=arguments[0];this.elt[0]=new no(d),this.elt[1]=new no(d)}else if(arguments[0]instanceof l){var _=arguments[0];this.elt[0]=new no(_.elt[0]),this.elt[1]=new no(_.elt[1])}}else if(2===arguments.length){var b=arguments[0],I=arguments[1];this.elt[0]=new no(xe.NONE),this.elt[1]=new no(xe.NONE),this.elt[b].setLocation(I)}else if(3===arguments.length){var N=arguments[0],j=arguments[1],ne=arguments[2];this.elt[0]=new no(N,j,ne),this.elt[1]=new no(N,j,ne)}else if(4===arguments.length){var Ee=arguments[0],it=arguments[1],Bt=arguments[2],zt=arguments[3];this.elt[0]=new no(xe.NONE,xe.NONE,xe.NONE),this.elt[1]=new no(xe.NONE,xe.NONE,xe.NONE),this.elt[Ee].setLocations(it,Bt,zt)}};li.prototype.getGeometryCount=function(){var l=0;return this.elt[0].isNull()||l++,this.elt[1].isNull()||l++,l},li.prototype.setAllLocations=function(l,d){this.elt[l].setAllLocations(d)},li.prototype.isNull=function(l){return this.elt[l].isNull()},li.prototype.setAllLocationsIfNull=function(){if(1===arguments.length){var l=arguments[0];this.setAllLocationsIfNull(0,l),this.setAllLocationsIfNull(1,l)}else 2===arguments.length&&this.elt[arguments[0]].setAllLocationsIfNull(arguments[1])},li.prototype.isLine=function(l){return this.elt[l].isLine()},li.prototype.merge=function(l){for(var d=0;d<2;d++)null===this.elt[d]&&null!==l.elt[d]?this.elt[d]=new no(l.elt[d]):this.elt[d].merge(l.elt[d])},li.prototype.flip=function(){this.elt[0].flip(),this.elt[1].flip()},li.prototype.getLocation=function(){return 1===arguments.length?this.elt[arguments[0]].get(mn.ON):2===arguments.length?this.elt[arguments[0]].get(arguments[1]):void 0},li.prototype.toString=function(){var l=new Pe;return null!==this.elt[0]&&(l.append("A:"),l.append(this.elt[0].toString())),null!==this.elt[1]&&(l.append(" B:"),l.append(this.elt[1].toString())),l.toString()},li.prototype.isArea=function(){return 0===arguments.length?this.elt[0].isArea()||this.elt[1].isArea():1===arguments.length?this.elt[arguments[0]].isArea():void 0},li.prototype.isAnyNull=function(l){return this.elt[l].isAnyNull()},li.prototype.setLocation=function(){2===arguments.length?this.elt[arguments[0]].setLocation(mn.ON,arguments[1]):3===arguments.length&&this.elt[arguments[0]].setLocation(arguments[1],arguments[2])},li.prototype.isEqualOnSide=function(l,d){return this.elt[0].isEqualOnSide(l.elt[0],d)&&this.elt[1].isEqualOnSide(l.elt[1],d)},li.prototype.allPositionsEqual=function(l,d){return this.elt[l].allPositionsEqual(d)},li.prototype.toLine=function(l){this.elt[l].isArea()&&(this.elt[l]=new no(this.elt[l].location[0]))},li.prototype.interfaces_=function(){return[]},li.prototype.getClass=function(){return li},li.toLineLabel=function(l){for(var d=new li(xe.NONE),_=0;_<2;_++)d.setLocation(_,l.getLocation(_));return d};var Pr=function(){this._startDe=null,this._maxNodeDegree=-1,this._edges=new ln,this._pts=new ln,this._label=new li(xe.NONE),this._ring=null,this._isHole=null,this._shell=null,this._holes=new ln,this._geometryFactory=null;var l=arguments[0];this._geometryFactory=arguments[1],this.computePoints(l),this.computeRing()};Pr.prototype.computeRing=function(){if(null!==this._ring)return null;for(var l=new Array(this._pts.size()).fill(null),d=0;d<this._pts.size();d++)l[d]=this._pts.get(d);this._ring=this._geometryFactory.createLinearRing(l),this._isHole=wt.isCCW(this._ring.getCoordinates())},Pr.prototype.isIsolated=function(){return 1===this._label.getGeometryCount()},Pr.prototype.computePoints=function(l){this._startDe=l;var d=l,_=!0;do{if(null===d)throw new ql("Found null DirectedEdge");if(d.getEdgeRing()===this)throw new ql("Directed Edge visited twice during ring-building at "+d.getCoordinate());this._edges.add(d);var b=d.getLabel();ae.isTrue(b.isArea()),this.mergeLabel(b),this.addPoints(d.getEdge(),d.isForward(),_),_=!1,this.setEdgeRing(d,this),d=this.getNext(d)}while(d!==this._startDe)},Pr.prototype.getLinearRing=function(){return this._ring},Pr.prototype.getCoordinate=function(l){return this._pts.get(l)},Pr.prototype.computeMaxNodeDegree=function(){this._maxNodeDegree=0;var l=this._startDe;do{var d=l.getNode().getEdges().getOutgoingDegree(this);d>this._maxNodeDegree&&(this._maxNodeDegree=d),l=this.getNext(l)}while(l!==this._startDe);this._maxNodeDegree*=2},Pr.prototype.addPoints=function(l,d,_){var b=l.getCoordinates();if(d){var I=1;_&&(I=0);for(var N=I;N<b.length;N++)this._pts.add(b[N])}else{var j=b.length-2;_&&(j=b.length-1);for(var ne=j;ne>=0;ne--)this._pts.add(b[ne])}},Pr.prototype.isHole=function(){return this._isHole},Pr.prototype.setInResult=function(){var l=this._startDe;do{l.getEdge().setInResult(!0),l=l.getNext()}while(l!==this._startDe)},Pr.prototype.containsPoint=function(l){var d=this.getLinearRing();if(!d.getEnvelopeInternal().contains(l)||!wt.isPointInRing(l,d.getCoordinates()))return!1;for(var _=this._holes.iterator();_.hasNext();)if(_.next().containsPoint(l))return!1;return!0},Pr.prototype.addHole=function(l){this._holes.add(l)},Pr.prototype.isShell=function(){return null===this._shell},Pr.prototype.getLabel=function(){return this._label},Pr.prototype.getEdges=function(){return this._edges},Pr.prototype.getMaxNodeDegree=function(){return this._maxNodeDegree<0&&this.computeMaxNodeDegree(),this._maxNodeDegree},Pr.prototype.getShell=function(){return this._shell},Pr.prototype.mergeLabel=function(){if(1===arguments.length){var l=arguments[0];this.mergeLabel(l,0),this.mergeLabel(l,1)}else if(2===arguments.length){var _=arguments[1],b=arguments[0].getLocation(_,mn.RIGHT);if(b===xe.NONE)return null;if(this._label.getLocation(_)===xe.NONE)return this._label.setLocation(_,b),null}},Pr.prototype.setShell=function(l){this._shell=l,null!==l&&l.addHole(this)},Pr.prototype.toPolygon=function(l){for(var d=new Array(this._holes.size()).fill(null),_=0;_<this._holes.size();_++)d[_]=this._holes.get(_).getLinearRing();return l.createPolygon(this.getLinearRing(),d)},Pr.prototype.interfaces_=function(){return[]},Pr.prototype.getClass=function(){return Pr};var To=function(l){function d(){l.call(this,arguments[0],arguments[1])}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.setEdgeRing=function(_,b){_.setMinEdgeRing(b)},d.prototype.getNext=function(_){return _.getNextMin()},d.prototype.interfaces_=function(){return[]},d.prototype.getClass=function(){return d},d}(Pr),Ic=function(l){function d(){l.call(this,arguments[0],arguments[1])}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.buildMinimalRings=function(){var _=new ln,b=this._startDe;do{if(null===b.getMinEdgeRing()){var I=new To(b,this._geometryFactory);_.add(I)}b=b.getNext()}while(b!==this._startDe);return _},d.prototype.setEdgeRing=function(_,b){_.setEdgeRing(b)},d.prototype.linkDirectedEdgesForMinimalEdgeRings=function(){var _=this._startDe;do{_.getNode().getEdges().linkMinimalDirectedEdges(this),_=_.getNext()}while(_!==this._startDe)},d.prototype.getNext=function(_){return _.getNext()},d.prototype.interfaces_=function(){return[]},d.prototype.getClass=function(){return d},d}(Pr),Va=function(){this._label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,0!==arguments.length&&1===arguments.length&&(this._label=arguments[0])};Va.prototype.setVisited=function(l){this._isVisited=l},Va.prototype.setInResult=function(l){this._isInResult=l},Va.prototype.isCovered=function(){return this._isCovered},Va.prototype.isCoveredSet=function(){return this._isCoveredSet},Va.prototype.setLabel=function(l){this._label=l},Va.prototype.getLabel=function(){return this._label},Va.prototype.setCovered=function(l){this._isCovered=l,this._isCoveredSet=!0},Va.prototype.updateIM=function(l){ae.isTrue(this._label.getGeometryCount()>=2,"found partial label"),this.computeIM(l)},Va.prototype.isInResult=function(){return this._isInResult},Va.prototype.isVisited=function(){return this._isVisited},Va.prototype.interfaces_=function(){return[]},Va.prototype.getClass=function(){return Va};var Xc=function(l){function d(){l.call(this),this._coord=null,this._edges=null;var b=arguments[1];this._coord=arguments[0],this._edges=b,this._label=new li(0,xe.NONE)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.isIncidentEdgeInResult=function(){for(var _=this.getEdges().getEdges().iterator();_.hasNext();)if(_.next().getEdge().isInResult())return!0;return!1},d.prototype.isIsolated=function(){return 1===this._label.getGeometryCount()},d.prototype.getCoordinate=function(){return this._coord},d.prototype.print=function(_){_.println("node "+this._coord+" lbl: "+this._label)},d.prototype.computeIM=function(_){},d.prototype.computeMergedLocation=function(_,b){var I=xe.NONE;if(I=this._label.getLocation(b),!_.isNull(b)){var N=_.getLocation(b);I!==xe.BOUNDARY&&(I=N)}return I},d.prototype.setLabel=function(){if(2!==arguments.length)return l.prototype.setLabel.apply(this,arguments);var _=arguments[0],b=arguments[1];null===this._label?this._label=new li(_,b):this._label.setLocation(_,b)},d.prototype.getEdges=function(){return this._edges},d.prototype.mergeLabel=function(){if(arguments[0]instanceof d)this.mergeLabel(arguments[0]._label);else if(arguments[0]instanceof li)for(var b=arguments[0],I=0;I<2;I++){var N=this.computeMergedLocation(b,I);this._label.getLocation(I)===xe.NONE&&this._label.setLocation(I,N)}},d.prototype.add=function(_){this._edges.insert(_),_.setNode(this)},d.prototype.setLabelBoundary=function(_){if(null===this._label)return null;var b=xe.NONE;null!==this._label&&(b=this._label.getLocation(_));var I=null;switch(b){case xe.BOUNDARY:I=xe.INTERIOR;break;case xe.INTERIOR:default:I=xe.BOUNDARY}this._label.setLocation(_,I)},d.prototype.interfaces_=function(){return[]},d.prototype.getClass=function(){return d},d}(Va),Dn=function(){this.nodeMap=new kt,this.nodeFact=null,this.nodeFact=arguments[0]};Dn.prototype.find=function(l){return this.nodeMap.get(l)},Dn.prototype.addNode=function(){if(arguments[0]instanceof re){var l=arguments[0],d=this.nodeMap.get(l);return null===d&&(d=this.nodeFact.createNode(l),this.nodeMap.put(l,d)),d}if(arguments[0]instanceof Xc){var _=arguments[0],b=this.nodeMap.get(_.getCoordinate());return null===b?(this.nodeMap.put(_.getCoordinate(),_),_):(b.mergeLabel(_),b)}},Dn.prototype.print=function(l){for(var d=this.iterator();d.hasNext();)d.next().print(l)},Dn.prototype.iterator=function(){return this.nodeMap.values().iterator()},Dn.prototype.values=function(){return this.nodeMap.values()},Dn.prototype.getBoundaryNodes=function(l){for(var d=new ln,_=this.iterator();_.hasNext();){var b=_.next();b.getLabel().getLocation(l)===xe.BOUNDARY&&d.add(b)}return d},Dn.prototype.add=function(l){var d=l.getCoordinate();this.addNode(d).add(l)},Dn.prototype.interfaces_=function(){return[]},Dn.prototype.getClass=function(){return Dn};var Wi=function(){},Gr={NE:{configurable:!0},NW:{configurable:!0},SW:{configurable:!0},SE:{configurable:!0}};Wi.prototype.interfaces_=function(){return[]},Wi.prototype.getClass=function(){return Wi},Wi.isNorthern=function(l){return l===Wi.NE||l===Wi.NW},Wi.isOpposite=function(l,d){return l!==d&&(l-d+4)%4==2},Wi.commonHalfPlane=function(l,d){if(l===d)return l;if((l-d+4)%4==2)return-1;var _=l<d?l:d;return 0===_&&3===(l>d?l:d)?3:_},Wi.isInHalfPlane=function(l,d){return d===Wi.SE?l===Wi.SE||l===Wi.SW:l===d||l===d+1},Wi.quadrant=function(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var l=arguments[0],d=arguments[1];if(0===l&&0===d)throw new pe("Cannot compute the quadrant for point ( "+l+", "+d+" )");return l>=0?d>=0?Wi.NE:Wi.SE:d>=0?Wi.NW:Wi.SW}if(arguments[0]instanceof re&&arguments[1]instanceof re){var _=arguments[0],b=arguments[1];if(b.x===_.x&&b.y===_.y)throw new pe("Cannot compute the quadrant for two identical points "+_);return b.x>=_.x?b.y>=_.y?Wi.NE:Wi.SE:b.y>=_.y?Wi.NW:Wi.SW}},Gr.NE.get=function(){return 0},Gr.NW.get=function(){return 1},Gr.SW.get=function(){return 2},Gr.SE.get=function(){return 3},Object.defineProperties(Wi,Gr);var so=function(){if(this._edge=null,this._label=null,this._node=null,this._p0=null,this._p1=null,this._dx=null,this._dy=null,this._quadrant=null,1===arguments.length)this._edge=arguments[0];else if(3===arguments.length){var _=arguments[1],b=arguments[2];this._edge=arguments[0],this.init(_,b),this._label=null}else if(4===arguments.length){var N=arguments[1],j=arguments[2],ne=arguments[3];this._edge=arguments[0],this.init(N,j),this._label=ne}};so.prototype.compareDirection=function(l){return this._dx===l._dx&&this._dy===l._dy?0:this._quadrant>l._quadrant?1:this._quadrant<l._quadrant?-1:wt.computeOrientation(l._p0,l._p1,this._p1)},so.prototype.getDy=function(){return this._dy},so.prototype.getCoordinate=function(){return this._p0},so.prototype.setNode=function(l){this._node=l},so.prototype.print=function(l){var d=Math.atan2(this._dy,this._dx),_=this.getClass().getName(),b=_.lastIndexOf("."),I=_.substring(b+1);l.print("  "+I+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+d+"   "+this._label)},so.prototype.compareTo=function(l){return this.compareDirection(l)},so.prototype.getDirectedCoordinate=function(){return this._p1},so.prototype.getDx=function(){return this._dx},so.prototype.getLabel=function(){return this._label},so.prototype.getEdge=function(){return this._edge},so.prototype.getQuadrant=function(){return this._quadrant},so.prototype.getNode=function(){return this._node},so.prototype.toString=function(){var l=Math.atan2(this._dy,this._dx),d=this.getClass().getName(),_=d.lastIndexOf(".");return"  "+d.substring(_+1)+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+l+"   "+this._label},so.prototype.computeLabel=function(l){},so.prototype.init=function(l,d){this._p0=l,this._p1=d,this._dx=d.x-l.x,this._dy=d.y-l.y,this._quadrant=Wi.quadrant(this._dx,this._dy),ae.isTrue(!(0===this._dx&&0===this._dy),"EdgeEnd with identical endpoints found")},so.prototype.interfaces_=function(){return[he]},so.prototype.getClass=function(){return so};var kh=function(l){function d(){var _=arguments[0],b=arguments[1];if(l.call(this,_),this._isForward=null,this._isInResult=!1,this._isVisited=!1,this._sym=null,this._next=null,this._nextMin=null,this._edgeRing=null,this._minEdgeRing=null,this._depth=[0,-999,-999],this._isForward=b,b)this.init(_.getCoordinate(0),_.getCoordinate(1));else{var I=_.getNumPoints()-1;this.init(_.getCoordinate(I),_.getCoordinate(I-1))}this.computeDirectedLabel()}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.getNextMin=function(){return this._nextMin},d.prototype.getDepth=function(_){return this._depth[_]},d.prototype.setVisited=function(_){this._isVisited=_},d.prototype.computeDirectedLabel=function(){this._label=new li(this._edge.getLabel()),this._isForward||this._label.flip()},d.prototype.getNext=function(){return this._next},d.prototype.setDepth=function(_,b){if(-999!==this._depth[_]&&this._depth[_]!==b)throw new ql("assigned depths do not match",this.getCoordinate());this._depth[_]=b},d.prototype.isInteriorAreaEdge=function(){for(var _=!0,b=0;b<2;b++)this._label.isArea(b)&&this._label.getLocation(b,mn.LEFT)===xe.INTERIOR&&this._label.getLocation(b,mn.RIGHT)===xe.INTERIOR||(_=!1);return _},d.prototype.setNextMin=function(_){this._nextMin=_},d.prototype.print=function(_){l.prototype.print.call(this,_),_.print(" "+this._depth[mn.LEFT]+"/"+this._depth[mn.RIGHT]),_.print(" ("+this.getDepthDelta()+")"),this._isInResult&&_.print(" inResult")},d.prototype.setMinEdgeRing=function(_){this._minEdgeRing=_},d.prototype.isLineEdge=function(){var _=this._label.isLine(0)||this._label.isLine(1),b=!this._label.isArea(0)||this._label.allPositionsEqual(0,xe.EXTERIOR),I=!this._label.isArea(1)||this._label.allPositionsEqual(1,xe.EXTERIOR);return _&&b&&I},d.prototype.setEdgeRing=function(_){this._edgeRing=_},d.prototype.getMinEdgeRing=function(){return this._minEdgeRing},d.prototype.getDepthDelta=function(){var _=this._edge.getDepthDelta();return this._isForward||(_=-_),_},d.prototype.setInResult=function(_){this._isInResult=_},d.prototype.getSym=function(){return this._sym},d.prototype.isForward=function(){return this._isForward},d.prototype.getEdge=function(){return this._edge},d.prototype.printEdge=function(_){this.print(_),_.print(" "),this._isForward?this._edge.print(_):this._edge.printReverse(_)},d.prototype.setSym=function(_){this._sym=_},d.prototype.setVisitedEdge=function(_){this.setVisited(_),this._sym.setVisited(_)},d.prototype.setEdgeDepths=function(_,b){var I=this.getEdge().getDepthDelta();this._isForward||(I=-I);var N=1;_===mn.LEFT&&(N=-1);var j=mn.opposite(_),ne=b+I*N;this.setDepth(_,b),this.setDepth(j,ne)},d.prototype.getEdgeRing=function(){return this._edgeRing},d.prototype.isInResult=function(){return this._isInResult},d.prototype.setNext=function(_){this._next=_},d.prototype.isVisited=function(){return this._isVisited},d.prototype.interfaces_=function(){return[]},d.prototype.getClass=function(){return d},d.depthFactor=function(_,b){return _===xe.EXTERIOR&&b===xe.INTERIOR?1:_===xe.INTERIOR&&b===xe.EXTERIOR?-1:0},d}(so),Yc=function(){};Yc.prototype.createNode=function(l){return new Xc(l,null)},Yc.prototype.interfaces_=function(){return[]},Yc.prototype.getClass=function(){return Yc};var Do=function(){this._edges=new ln,this._nodes=null,this._edgeEndList=new ln,0===arguments.length?this._nodes=new Dn(new Yc):1===arguments.length&&(this._nodes=new Dn(arguments[0]))};Do.prototype.printEdges=function(l){l.println("Edges:");for(var d=0;d<this._edges.size();d++){l.println("edge "+d+":");var _=this._edges.get(d);_.print(l),_.eiList.print(l)}},Do.prototype.find=function(l){return this._nodes.find(l)},Do.prototype.addNode=function(){return arguments[0]instanceof Xc||arguments[0]instanceof re?this._nodes.addNode(arguments[0]):void 0},Do.prototype.getNodeIterator=function(){return this._nodes.iterator()},Do.prototype.linkResultDirectedEdges=function(){for(var l=this._nodes.iterator();l.hasNext();)l.next().getEdges().linkResultDirectedEdges()},Do.prototype.debugPrintln=function(l){In.out.println(l)},Do.prototype.isBoundaryNode=function(l,d){var _=this._nodes.find(d);if(null===_)return!1;var b=_.getLabel();return null!==b&&b.getLocation(l)===xe.BOUNDARY},Do.prototype.linkAllDirectedEdges=function(){for(var l=this._nodes.iterator();l.hasNext();)l.next().getEdges().linkAllDirectedEdges()},Do.prototype.matchInSameDirection=function(l,d,_,b){return!!l.equals(_)&&wt.computeOrientation(l,d,b)===wt.COLLINEAR&&Wi.quadrant(l,d)===Wi.quadrant(_,b)},Do.prototype.getEdgeEnds=function(){return this._edgeEndList},Do.prototype.debugPrint=function(l){In.out.print(l)},Do.prototype.getEdgeIterator=function(){return this._edges.iterator()},Do.prototype.findEdgeInSameDirection=function(l,d){for(var _=0;_<this._edges.size();_++){var b=this._edges.get(_),I=b.getCoordinates();if(this.matchInSameDirection(l,d,I[0],I[1])||this.matchInSameDirection(l,d,I[I.length-1],I[I.length-2]))return b}return null},Do.prototype.insertEdge=function(l){this._edges.add(l)},Do.prototype.findEdgeEnd=function(l){for(var d=this.getEdgeEnds().iterator();d.hasNext();){var _=d.next();if(_.getEdge()===l)return _}return null},Do.prototype.addEdges=function(l){for(var d=l.iterator();d.hasNext();){var _=d.next();this._edges.add(_);var b=new kh(_,!0),I=new kh(_,!1);b.setSym(I),I.setSym(b),this.add(b),this.add(I)}},Do.prototype.add=function(l){this._nodes.add(l),this._edgeEndList.add(l)},Do.prototype.getNodes=function(){return this._nodes.values()},Do.prototype.findEdge=function(l,d){for(var _=0;_<this._edges.size();_++){var b=this._edges.get(_),I=b.getCoordinates();if(l.equals(I[0])&&d.equals(I[1]))return b}return null},Do.prototype.interfaces_=function(){return[]},Do.prototype.getClass=function(){return Do},Do.linkResultDirectedEdges=function(l){for(var d=l.iterator();d.hasNext();)d.next().getEdges().linkResultDirectedEdges()};var Ca=function(){this._geometryFactory=null,this._shellList=new ln,this._geometryFactory=arguments[0]};Ca.prototype.sortShellsAndHoles=function(l,d,_){for(var b=l.iterator();b.hasNext();){var I=b.next();I.isHole()?_.add(I):d.add(I)}},Ca.prototype.computePolygons=function(l){for(var d=new ln,_=l.iterator();_.hasNext();){var b=_.next().toPolygon(this._geometryFactory);d.add(b)}return d},Ca.prototype.placeFreeHoles=function(l,d){for(var _=d.iterator();_.hasNext();){var b=_.next();if(null===b.getShell()){var I=this.findEdgeRingContaining(b,l);if(null===I)throw new ql("unable to assign hole to a shell",b.getCoordinate(0));b.setShell(I)}}},Ca.prototype.buildMinimalEdgeRings=function(l,d,_){for(var b=new ln,I=l.iterator();I.hasNext();){var N=I.next();if(N.getMaxNodeDegree()>2){N.linkDirectedEdgesForMinimalEdgeRings();var j=N.buildMinimalRings(),ne=this.findShell(j);null!==ne?(this.placePolygonHoles(ne,j),d.add(ne)):_.addAll(j)}else b.add(N)}return b},Ca.prototype.containsPoint=function(l){for(var d=this._shellList.iterator();d.hasNext();)if(d.next().containsPoint(l))return!0;return!1},Ca.prototype.buildMaximalEdgeRings=function(l){for(var d=new ln,_=l.iterator();_.hasNext();){var b=_.next();if(b.isInResult()&&b.getLabel().isArea()&&null===b.getEdgeRing()){var I=new Ic(b,this._geometryFactory);d.add(I),I.setInResult()}}return d},Ca.prototype.placePolygonHoles=function(l,d){for(var _=d.iterator();_.hasNext();){var b=_.next();b.isHole()&&b.setShell(l)}},Ca.prototype.getPolygons=function(){return this.computePolygons(this._shellList)},Ca.prototype.findEdgeRingContaining=function(l,d){for(var _=l.getLinearRing(),b=_.getEnvelopeInternal(),I=_.getCoordinateN(0),N=null,j=null,ne=d.iterator();ne.hasNext();){var Ee=ne.next(),it=Ee.getLinearRing(),Bt=it.getEnvelopeInternal();null!==N&&(j=N.getLinearRing().getEnvelopeInternal());var zt=!1;Bt.contains(b)&&wt.isPointInRing(I,it.getCoordinates())&&(zt=!0),zt&&(null===N||j.contains(Bt))&&(N=Ee)}return N},Ca.prototype.findShell=function(l){for(var d=0,_=null,b=l.iterator();b.hasNext();){var I=b.next();I.isHole()||(_=I,d++)}return ae.isTrue(d<=1,"found two shells in MinimalEdgeRing list"),_},Ca.prototype.add=function(){if(1===arguments.length){var l=arguments[0];this.add(l.getEdgeEnds(),l.getNodes())}else if(2===arguments.length){var d=arguments[0];Do.linkResultDirectedEdges(arguments[1]);var b=this.buildMaximalEdgeRings(d),I=new ln,N=this.buildMinimalEdgeRings(b,this._shellList,I);this.sortShellsAndHoles(N,this._shellList,I),this.placeFreeHoles(this._shellList,I)}},Ca.prototype.interfaces_=function(){return[]},Ca.prototype.getClass=function(){return Ca};var zs=function(){};zs.prototype.getBounds=function(){},zs.prototype.interfaces_=function(){return[]},zs.prototype.getClass=function(){return zs};var Sa=function(){this._bounds=null,this._item=null;var d=arguments[1];this._bounds=arguments[0],this._item=d};Sa.prototype.getItem=function(){return this._item},Sa.prototype.getBounds=function(){return this._bounds},Sa.prototype.interfaces_=function(){return[zs,De]},Sa.prototype.getClass=function(){return Sa};var bl=function(){this._size=null,this._items=null,this._size=0,this._items=new ln,this._items.add(null)};bl.prototype.poll=function(){if(this.isEmpty())return null;var l=this._items.get(1);return this._items.set(1,this._items.get(this._size)),this._size-=1,this.reorder(1),l},bl.prototype.size=function(){return this._size},bl.prototype.reorder=function(l){for(var d=null,_=this._items.get(l);2*l<=this._size&&((d=2*l)!==this._size&&this._items.get(d+1).compareTo(this._items.get(d))<0&&d++,this._items.get(d).compareTo(_)<0);l=d)this._items.set(l,this._items.get(d));this._items.set(l,_)},bl.prototype.clear=function(){this._size=0,this._items.clear()},bl.prototype.isEmpty=function(){return 0===this._size},bl.prototype.add=function(l){this._items.add(null),this._size+=1;var d=this._size;for(this._items.set(0,l);l.compareTo(this._items.get(Math.trunc(d/2)))<0;d/=2)this._items.set(d,this._items.get(Math.trunc(d/2)));this._items.set(d,l)},bl.prototype.interfaces_=function(){return[]},bl.prototype.getClass=function(){return bl};var wl=function(){};wl.prototype.visitItem=function(l){},wl.prototype.interfaces_=function(){return[]},wl.prototype.getClass=function(){return wl};var or=function(){};or.prototype.insert=function(l,d){},or.prototype.remove=function(l,d){},or.prototype.query=function(){},or.prototype.interfaces_=function(){return[]},or.prototype.getClass=function(){return or};var Xi=function(){this._childBoundables=new ln,this._bounds=null,this._level=null,0!==arguments.length&&1===arguments.length&&(this._level=arguments[0])},Zc={serialVersionUID:{configurable:!0}};Xi.prototype.getLevel=function(){return this._level},Xi.prototype.size=function(){return this._childBoundables.size()},Xi.prototype.getChildBoundables=function(){return this._childBoundables},Xi.prototype.addChildBoundable=function(l){ae.isTrue(null===this._bounds),this._childBoundables.add(l)},Xi.prototype.isEmpty=function(){return this._childBoundables.isEmpty()},Xi.prototype.getBounds=function(){return null===this._bounds&&(this._bounds=this.computeBounds()),this._bounds},Xi.prototype.interfaces_=function(){return[zs,De]},Xi.prototype.getClass=function(){return Xi},Zc.serialVersionUID.get=function(){return 0x5a1e55ec41369800},Object.defineProperties(Xi,Zc);var ss=function(){};ss.reverseOrder=function(){return{compare:function(l,d){return d.compareTo(l)}}},ss.min=function(l){return ss.sort(l),l.get(0)},ss.sort=function(l,d){var _=l.toArray();d?Et.sort(_,d):Et.sort(_);for(var b=l.iterator(),I=0,N=_.length;I<N;I++)b.next(),b.set(_[I])},ss.singletonList=function(l){var d=new ln;return d.add(l),d};var ur=function(){this._boundable1=null,this._boundable2=null,this._distance=null,this._itemDistance=null;var d=arguments[1],_=arguments[2];this._boundable1=arguments[0],this._boundable2=d,this._itemDistance=_,this._distance=this.distance()};ur.prototype.expandToQueue=function(l,d){var _=ur.isComposite(this._boundable1),b=ur.isComposite(this._boundable2);if(_&&b)return ur.area(this._boundable1)>ur.area(this._boundable2)?(this.expand(this._boundable1,this._boundable2,l,d),null):(this.expand(this._boundable2,this._boundable1,l,d),null);if(_)return this.expand(this._boundable1,this._boundable2,l,d),null;if(b)return this.expand(this._boundable2,this._boundable1,l,d),null;throw new pe("neither boundable is composite")},ur.prototype.isLeaves=function(){return!(ur.isComposite(this._boundable1)||ur.isComposite(this._boundable2))},ur.prototype.compareTo=function(l){return this._distance<l._distance?-1:this._distance>l._distance?1:0},ur.prototype.expand=function(l,d,_,b){for(var I=l.getChildBoundables().iterator();I.hasNext();){var N=I.next(),j=new ur(N,d,this._itemDistance);j.getDistance()<b&&_.add(j)}},ur.prototype.getBoundable=function(l){return 0===l?this._boundable1:this._boundable2},ur.prototype.getDistance=function(){return this._distance},ur.prototype.distance=function(){return this.isLeaves()?this._itemDistance.distance(this._boundable1,this._boundable2):this._boundable1.getBounds().distance(this._boundable2.getBounds())},ur.prototype.interfaces_=function(){return[he]},ur.prototype.getClass=function(){return ur},ur.area=function(l){return l.getBounds().getArea()},ur.isComposite=function(l){return l instanceof Xi};var hs=function l(){if(this._root=null,this._built=!1,this._itemBoundables=new ln,this._nodeCapacity=null,0===arguments.length)this._nodeCapacity=l.DEFAULT_NODE_CAPACITY;else if(1===arguments.length){var _=arguments[0];ae.isTrue(_>1,"Node capacity must be greater than 1"),this._nodeCapacity=_}},ll={IntersectsOp:{configurable:!0},serialVersionUID:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};hs.prototype.getNodeCapacity=function(){return this._nodeCapacity},hs.prototype.lastNode=function(l){return l.get(l.size()-1)},hs.prototype.size=function(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.size(this._root));if(1===arguments.length){for(var l=0,d=arguments[0].getChildBoundables().iterator();d.hasNext();){var _=d.next();_ instanceof Xi?l+=this.size(_):_ instanceof Sa&&(l+=1)}return l}},hs.prototype.removeItem=function(l,d){for(var _=null,b=l.getChildBoundables().iterator();b.hasNext();){var I=b.next();I instanceof Sa&&I.getItem()===d&&(_=I)}return null!==_&&(l.getChildBoundables().remove(_),!0)},hs.prototype.itemsTree=function(){if(0===arguments.length){this.build();var l=this.itemsTree(this._root);return null===l?new ln:l}if(1===arguments.length){for(var d=arguments[0],_=new ln,b=d.getChildBoundables().iterator();b.hasNext();){var I=b.next();if(I instanceof Xi){var N=this.itemsTree(I);null!==N&&_.add(N)}else I instanceof Sa?_.add(I.getItem()):ae.shouldNeverReachHere()}return _.size()<=0?null:_}},hs.prototype.insert=function(l,d){ae.isTrue(!this._built,"Cannot insert items into an STR packed R-tree after it has been built."),this._itemBoundables.add(new Sa(l,d))},hs.prototype.boundablesAtLevel=function(){if(1===arguments.length){var l=arguments[0],d=new ln;return this.boundablesAtLevel(l,this._root,d),d}if(3===arguments.length){var _=arguments[0],b=arguments[1],I=arguments[2];if(ae.isTrue(_>-2),b.getLevel()===_)return I.add(b),null;for(var N=b.getChildBoundables().iterator();N.hasNext();){var j=N.next();j instanceof Xi?this.boundablesAtLevel(_,j,I):(ae.isTrue(j instanceof Sa),-1===_&&I.add(j))}return null}},hs.prototype.query=function(){if(1===arguments.length){var l=arguments[0];this.build();var d=new ln;return this.isEmpty()||this.getIntersectsOp().intersects(this._root.getBounds(),l)&&this.query(l,this._root,d),d}if(2===arguments.length){var _=arguments[0],b=arguments[1];if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this._root.getBounds(),_)&&this.query(_,this._root,b)}else if(3===arguments.length)if(Lt(arguments[2],wl)&&arguments[0]instanceof Object&&arguments[1]instanceof Xi)for(var I=arguments[0],j=arguments[2],ne=arguments[1].getChildBoundables(),Ee=0;Ee<ne.size();Ee++){var it=ne.get(Ee);this.getIntersectsOp().intersects(it.getBounds(),I)&&(it instanceof Xi?this.query(I,it,j):it instanceof Sa?j.visitItem(it.getItem()):ae.shouldNeverReachHere())}else if(Lt(arguments[2],fo)&&arguments[0]instanceof Object&&arguments[1]instanceof Xi)for(var Bt=arguments[0],vn=arguments[2],pn=arguments[1].getChildBoundables(),Pn=0;Pn<pn.size();Pn++){var rr=pn.get(Pn);this.getIntersectsOp().intersects(rr.getBounds(),Bt)&&(rr instanceof Xi?this.query(Bt,rr,vn):rr instanceof Sa?vn.add(rr.getItem()):ae.shouldNeverReachHere())}},hs.prototype.build=function(){if(this._built)return null;this._root=this._itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this._itemBoundables,-1),this._itemBoundables=null,this._built=!0},hs.prototype.getRoot=function(){return this.build(),this._root},hs.prototype.remove=function(){if(2===arguments.length){var l=arguments[0],d=arguments[1];return this.build(),!!this.getIntersectsOp().intersects(this._root.getBounds(),l)&&this.remove(l,this._root,d)}if(3===arguments.length){var _=arguments[0],b=arguments[1],I=arguments[2],N=this.removeItem(b,I);if(N)return!0;for(var j=null,ne=b.getChildBoundables().iterator();ne.hasNext();){var Ee=ne.next();if(this.getIntersectsOp().intersects(Ee.getBounds(),_)&&Ee instanceof Xi&&(N=this.remove(_,Ee,I))){j=Ee;break}}return null!==j&&j.getChildBoundables().isEmpty()&&b.getChildBoundables().remove(j),N}},hs.prototype.createHigherLevels=function(l,d){ae.isTrue(!l.isEmpty());var _=this.createParentBoundables(l,d+1);return 1===_.size()?_.get(0):this.createHigherLevels(_,d+1)},hs.prototype.depth=function(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.depth(this._root));if(1===arguments.length){for(var l=0,d=arguments[0].getChildBoundables().iterator();d.hasNext();){var _=d.next();if(_ instanceof Xi){var b=this.depth(_);b>l&&(l=b)}}return l+1}},hs.prototype.createParentBoundables=function(l,d){ae.isTrue(!l.isEmpty());var _=new ln;_.add(this.createNode(d));var b=new ln(l);ss.sort(b,this.getComparator());for(var I=b.iterator();I.hasNext();){var N=I.next();this.lastNode(_).getChildBoundables().size()===this.getNodeCapacity()&&_.add(this.createNode(d)),this.lastNode(_).addChildBoundable(N)}return _},hs.prototype.isEmpty=function(){return this._built?this._root.isEmpty():this._itemBoundables.isEmpty()},hs.prototype.interfaces_=function(){return[De]},hs.prototype.getClass=function(){return hs},hs.compareDoubles=function(l,d){return l>d?1:l<d?-1:0},ll.IntersectsOp.get=function(){return ul},ll.serialVersionUID.get=function(){return-0x35ef64c82d4c5400},ll.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(hs,ll);var ul=function(){},$u=function(){};$u.prototype.distance=function(l,d){},$u.prototype.interfaces_=function(){return[]},$u.prototype.getClass=function(){return $u};var Lh=function(l){function d(b){l.call(this,b=b||d.DEFAULT_NODE_CAPACITY)}l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d;var _={STRtreeNode:{configurable:!0},serialVersionUID:{configurable:!0},xComparator:{configurable:!0},yComparator:{configurable:!0},intersectsOp:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};return d.prototype.createParentBoundablesFromVerticalSlices=function(b,I){ae.isTrue(b.length>0);for(var N=new ln,j=0;j<b.length;j++)N.addAll(this.createParentBoundablesFromVerticalSlice(b[j],I));return N},d.prototype.createNode=function(b){return new xr(b)},d.prototype.size=function(){return 0===arguments.length?l.prototype.size.call(this):l.prototype.size.apply(this,arguments)},d.prototype.insert=function(){if(2!==arguments.length)return l.prototype.insert.apply(this,arguments);var b=arguments[0],I=arguments[1];if(b.isNull())return null;l.prototype.insert.call(this,b,I)},d.prototype.getIntersectsOp=function(){return d.intersectsOp},d.prototype.verticalSlices=function(b,I){for(var N=Math.trunc(Math.ceil(b.size()/I)),j=new Array(I).fill(null),ne=b.iterator(),Ee=0;Ee<I;Ee++){j[Ee]=new ln;for(var it=0;ne.hasNext()&&it<N;){var Bt=ne.next();j[Ee].add(Bt),it++}}return j},d.prototype.query=function(){if(1===arguments.length)return l.prototype.query.call(this,arguments[0]);2===arguments.length?l.prototype.query.call(this,arguments[0],arguments[1]):3===arguments.length&&(Lt(arguments[2],wl)&&arguments[0]instanceof Object&&arguments[1]instanceof Xi||Lt(arguments[2],fo)&&arguments[0]instanceof Object&&arguments[1]instanceof Xi)&&l.prototype.query.call(this,arguments[0],arguments[1],arguments[2])},d.prototype.getComparator=function(){return d.yComparator},d.prototype.createParentBoundablesFromVerticalSlice=function(b,I){return l.prototype.createParentBoundables.call(this,b,I)},d.prototype.remove=function(){return 2===arguments.length?l.prototype.remove.call(this,arguments[0],arguments[1]):l.prototype.remove.apply(this,arguments)},d.prototype.depth=function(){return 0===arguments.length?l.prototype.depth.call(this):l.prototype.depth.apply(this,arguments)},d.prototype.createParentBoundables=function(b,I){ae.isTrue(!b.isEmpty());var N=Math.trunc(Math.ceil(b.size()/this.getNodeCapacity())),j=new ln(b);ss.sort(j,d.xComparator);var ne=this.verticalSlices(j,Math.trunc(Math.ceil(Math.sqrt(N))));return this.createParentBoundablesFromVerticalSlices(ne,I)},d.prototype.nearestNeighbour=function(){if(1===arguments.length){if(Lt(arguments[0],$u)){var b=arguments[0],I=new ur(this.getRoot(),this.getRoot(),b);return this.nearestNeighbour(I)}if(arguments[0]instanceof ur)return this.nearestNeighbour(arguments[0],le.POSITIVE_INFINITY)}else if(2===arguments.length){if(arguments[0]instanceof d&&Lt(arguments[1],$u)){var j=arguments[0],ne=arguments[1],Ee=new ur(this.getRoot(),j.getRoot(),ne);return this.nearestNeighbour(Ee)}if(arguments[0]instanceof ur&&"number"==typeof arguments[1]){var it=arguments[0],Bt=arguments[1],zt=null,vn=new bl;for(vn.add(it);!vn.isEmpty()&&Bt>0;){var pn=vn.poll(),Pn=pn.getDistance();if(Pn>=Bt)break;pn.isLeaves()?(Bt=Pn,zt=pn):pn.expandToQueue(vn,Bt)}return[zt.getBoundable(0).getItem(),zt.getBoundable(1).getItem()]}}else if(3===arguments.length){var c=arguments[2],y=new Sa(arguments[0],arguments[1]),S=new ur(this.getRoot(),y,c);return this.nearestNeighbour(S)[0]}},d.prototype.interfaces_=function(){return[or,De]},d.prototype.getClass=function(){return d},d.centreX=function(b){return d.avg(b.getMinX(),b.getMaxX())},d.avg=function(b,I){return(b+I)/2},d.centreY=function(b){return d.avg(b.getMinY(),b.getMaxY())},_.STRtreeNode.get=function(){return xr},_.serialVersionUID.get=function(){return 0x39920f7d5f261e0},_.xComparator.get=function(){return{interfaces_:function(){return[be]},compare:function(b,I){return l.compareDoubles(d.centreX(b.getBounds()),d.centreX(I.getBounds()))}}},_.yComparator.get=function(){return{interfaces_:function(){return[be]},compare:function(b,I){return l.compareDoubles(d.centreY(b.getBounds()),d.centreY(I.getBounds()))}}},_.intersectsOp.get=function(){return{interfaces_:function(){return[l.IntersectsOp]},intersects:function(b,I){return b.intersects(I)}}},_.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(d,_),d}(hs),xr=function(l){function d(){l.call(this,arguments[0])}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.computeBounds=function(){for(var _=null,b=this.getChildBoundables().iterator();b.hasNext();){var I=b.next();null===_?_=new rn(I.getBounds()):_.expandToInclude(I.getBounds())}return _},d.prototype.interfaces_=function(){return[]},d.prototype.getClass=function(){return d},d}(Xi),Ts=function(){};Ts.prototype.interfaces_=function(){return[]},Ts.prototype.getClass=function(){return Ts},Ts.relativeSign=function(l,d){return l<d?-1:l>d?1:0},Ts.compare=function(l,d,_){if(d.equals2D(_))return 0;var b=Ts.relativeSign(d.x,_.x),I=Ts.relativeSign(d.y,_.y);switch(l){case 0:return Ts.compareValue(b,I);case 1:return Ts.compareValue(I,b);case 2:return Ts.compareValue(I,-b);case 3:return Ts.compareValue(-b,I);case 4:return Ts.compareValue(-b,-I);case 5:return Ts.compareValue(-I,-b);case 6:return Ts.compareValue(-I,b);case 7:return Ts.compareValue(b,-I)}return ae.shouldNeverReachHere("invalid octant value"),0},Ts.compareValue=function(l,d){return l<0?-1:l>0?1:d<0?-1:d>0?1:0};var Wl=function(){this._segString=null,this.coord=null,this.segmentIndex=null,this._segmentOctant=null,this._isInterior=null;var l=arguments[0],d=arguments[1],_=arguments[2],b=arguments[3];this._segString=l,this.coord=new re(d),this.segmentIndex=_,this._segmentOctant=b,this._isInterior=!d.equals2D(l.getCoordinate(_))};Wl.prototype.getCoordinate=function(){return this.coord},Wl.prototype.print=function(l){l.print(this.coord),l.print(" seg # = "+this.segmentIndex)},Wl.prototype.compareTo=function(l){var d=l;return this.segmentIndex<d.segmentIndex?-1:this.segmentIndex>d.segmentIndex?1:this.coord.equals2D(d.coord)?0:Ts.compare(this._segmentOctant,this.coord,d.coord)},Wl.prototype.isEndPoint=function(l){return 0===this.segmentIndex&&!this._isInterior||this.segmentIndex===l},Wl.prototype.isInterior=function(){return this._isInterior},Wl.prototype.interfaces_=function(){return[he]},Wl.prototype.getClass=function(){return Wl};var Vs=function(){this._nodeMap=new kt,this._edge=null,this._edge=arguments[0]};Vs.prototype.getSplitCoordinates=function(){var l=new Fs;this.addEndpoints();for(var d=this.iterator(),_=d.next();d.hasNext();){var b=d.next();this.addEdgeCoordinates(_,b,l),_=b}return l.toCoordinateArray()},Vs.prototype.addCollapsedNodes=function(){var l=new ln;this.findCollapsesFromInsertedNodes(l),this.findCollapsesFromExistingVertices(l);for(var d=l.iterator();d.hasNext();){var _=d.next().intValue();this.add(this._edge.getCoordinate(_),_)}},Vs.prototype.print=function(l){l.println("Intersections:");for(var d=this.iterator();d.hasNext();)d.next().print(l)},Vs.prototype.findCollapsesFromExistingVertices=function(l){for(var d=0;d<this._edge.size()-2;d++){var _=this._edge.getCoordinate(d),b=this._edge.getCoordinate(d+2);_.equals2D(b)&&l.add(new lt(d+1))}},Vs.prototype.addEdgeCoordinates=function(l,d,_){var b=this._edge.getCoordinate(d.segmentIndex),I=d.isInterior()||!d.coord.equals2D(b);_.add(new re(l.coord),!1);for(var N=l.segmentIndex+1;N<=d.segmentIndex;N++)_.add(this._edge.getCoordinate(N));I&&_.add(new re(d.coord))},Vs.prototype.iterator=function(){return this._nodeMap.values().iterator()},Vs.prototype.addSplitEdges=function(l){this.addEndpoints(),this.addCollapsedNodes();for(var d=this.iterator(),_=d.next();d.hasNext();){var b=d.next(),I=this.createSplitEdge(_,b);l.add(I),_=b}},Vs.prototype.findCollapseIndex=function(l,d,_){if(!l.coord.equals2D(d.coord))return!1;var b=d.segmentIndex-l.segmentIndex;return d.isInterior()||b--,1===b&&(_[0]=l.segmentIndex+1,!0)},Vs.prototype.findCollapsesFromInsertedNodes=function(l){for(var d=new Array(1).fill(null),_=this.iterator(),b=_.next();_.hasNext();){var I=_.next();this.findCollapseIndex(b,I,d)&&l.add(new lt(d[0])),b=I}},Vs.prototype.getEdge=function(){return this._edge},Vs.prototype.addEndpoints=function(){var l=this._edge.size()-1;this.add(this._edge.getCoordinate(0),0),this.add(this._edge.getCoordinate(l),l)},Vs.prototype.createSplitEdge=function(l,d){var _=d.segmentIndex-l.segmentIndex+2,b=this._edge.getCoordinate(d.segmentIndex),I=d.isInterior()||!d.coord.equals2D(b);I||_--;var N=new Array(_).fill(null),j=0;N[j++]=new re(l.coord);for(var ne=l.segmentIndex+1;ne<=d.segmentIndex;ne++)N[j++]=this._edge.getCoordinate(ne);return I&&(N[j]=new re(d.coord)),new as(N,this._edge.getData())},Vs.prototype.add=function(l,d){var _=new Wl(this._edge,l,d,this._edge.getSegmentOctant(d)),b=this._nodeMap.get(_);return null!==b?(ae.isTrue(b.coord.equals2D(l),"Found equal nodes with different coordinates"),b):(this._nodeMap.put(_,_),_)},Vs.prototype.checkSplitEdgesCorrectness=function(l){var d=this._edge.getCoordinates(),_=l.get(0).getCoordinate(0);if(!_.equals2D(d[0]))throw new ve("bad split edge start point at "+_);var b=l.get(l.size()-1).getCoordinates(),I=b[b.length-1];if(!I.equals2D(d[d.length-1]))throw new ve("bad split edge end point at "+I)},Vs.prototype.interfaces_=function(){return[]},Vs.prototype.getClass=function(){return Vs};var pc=function(){};pc.prototype.interfaces_=function(){return[]},pc.prototype.getClass=function(){return pc},pc.octant=function(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var l=arguments[0],d=arguments[1];if(0===l&&0===d)throw new pe("Cannot compute the octant for point ( "+l+", "+d+" )");var _=Math.abs(l),b=Math.abs(d);return l>=0?d>=0?_>=b?0:1:_>=b?7:6:d>=0?_>=b?3:2:_>=b?4:5}if(arguments[0]instanceof re&&arguments[1]instanceof re){var I=arguments[0],N=arguments[1],j=N.x-I.x,ne=N.y-I.y;if(0===j&&0===ne)throw new pe("Cannot compute the octant for two identical points "+I);return pc.octant(j,ne)}};var jr=function(){};jr.prototype.getCoordinates=function(){},jr.prototype.size=function(){},jr.prototype.getCoordinate=function(l){},jr.prototype.isClosed=function(){},jr.prototype.setData=function(l){},jr.prototype.getData=function(){},jr.prototype.interfaces_=function(){return[]},jr.prototype.getClass=function(){return jr};var Kc=function(){};Kc.prototype.addIntersection=function(l,d){},Kc.prototype.interfaces_=function(){return[jr]},Kc.prototype.getClass=function(){return Kc};var as=function(){this._nodeList=new Vs(this),this._pts=null,this._data=null;var d=arguments[1];this._pts=arguments[0],this._data=d};as.prototype.getCoordinates=function(){return this._pts},as.prototype.size=function(){return this._pts.length},as.prototype.getCoordinate=function(l){return this._pts[l]},as.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])},as.prototype.getSegmentOctant=function(l){return l===this._pts.length-1?-1:this.safeOctant(this.getCoordinate(l),this.getCoordinate(l+1))},as.prototype.setData=function(l){this._data=l},as.prototype.safeOctant=function(l,d){return l.equals2D(d)?0:pc.octant(l,d)},as.prototype.getData=function(){return this._data},as.prototype.addIntersection=function(){if(2===arguments.length)this.addIntersectionNode(arguments[0],arguments[1]);else if(4===arguments.length){var b=arguments[1],N=new re(arguments[0].getIntersection(arguments[3]));this.addIntersection(N,b)}},as.prototype.toString=function(){return _t.toLineString(new Ln(this._pts))},as.prototype.getNodeList=function(){return this._nodeList},as.prototype.addIntersectionNode=function(l,d){var _=d,b=_+1;return b<this._pts.length&&l.equals2D(this._pts[b])&&(_=b),this._nodeList.add(l,_)},as.prototype.addIntersections=function(l,d,_){for(var b=0;b<l.getIntersectionNum();b++)this.addIntersection(l,d,_,b)},as.prototype.interfaces_=function(){return[Kc]},as.prototype.getClass=function(){return as},as.getNodedSubstrings=function(){if(1===arguments.length){var l=arguments[0],d=new ln;return as.getNodedSubstrings(l,d),d}if(2===arguments.length)for(var b=arguments[1],I=arguments[0].iterator();I.hasNext();)I.next().getNodeList().addSplitEdges(b)};var Yn=function(){if(this.p0=null,this.p1=null,0===arguments.length)this.p0=new re,this.p1=new re;else if(1===arguments.length){var l=arguments[0];this.p0=new re(l.p0),this.p1=new re(l.p1)}else if(2===arguments.length)this.p0=arguments[0],this.p1=arguments[1];else if(4===arguments.length){var b=arguments[2],I=arguments[3];this.p0=new re(arguments[0],arguments[1]),this.p1=new re(b,I)}},ro={serialVersionUID:{configurable:!0}};Yn.prototype.minX=function(){return Math.min(this.p0.x,this.p1.x)},Yn.prototype.orientationIndex=function(){if(arguments[0]instanceof Yn){var l=arguments[0],d=wt.orientationIndex(this.p0,this.p1,l.p0),_=wt.orientationIndex(this.p0,this.p1,l.p1);return d>=0&&_>=0||d<=0&&_<=0?Math.max(d,_):0}if(arguments[0]instanceof re)return wt.orientationIndex(this.p0,this.p1,arguments[0])},Yn.prototype.toGeometry=function(l){return l.createLineString([this.p0,this.p1])},Yn.prototype.isVertical=function(){return this.p0.x===this.p1.x},Yn.prototype.equals=function(l){if(!(l instanceof Yn))return!1;var d=l;return this.p0.equals(d.p0)&&this.p1.equals(d.p1)},Yn.prototype.intersection=function(l){var d=new Ot;return d.computeIntersection(this.p0,this.p1,l.p0,l.p1),d.hasIntersection()?d.getIntersection(0):null},Yn.prototype.project=function(){if(arguments[0]instanceof re){var l=arguments[0];if(l.equals(this.p0)||l.equals(this.p1))return new re(l);var d=this.projectionFactor(l),_=new re;return _.x=this.p0.x+d*(this.p1.x-this.p0.x),_.y=this.p0.y+d*(this.p1.y-this.p0.y),_}if(arguments[0]instanceof Yn){var b=arguments[0],I=this.projectionFactor(b.p0),N=this.projectionFactor(b.p1);if(I>=1&&N>=1||I<=0&&N<=0)return null;var j=this.project(b.p0);I<0&&(j=this.p0),I>1&&(j=this.p1);var ne=this.project(b.p1);return N<0&&(ne=this.p0),N>1&&(ne=this.p1),new Yn(j,ne)}},Yn.prototype.normalize=function(){this.p1.compareTo(this.p0)<0&&this.reverse()},Yn.prototype.angle=function(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)},Yn.prototype.getCoordinate=function(l){return 0===l?this.p0:this.p1},Yn.prototype.distancePerpendicular=function(l){return wt.distancePointLinePerpendicular(l,this.p0,this.p1)},Yn.prototype.minY=function(){return Math.min(this.p0.y,this.p1.y)},Yn.prototype.midPoint=function(){return Yn.midPoint(this.p0,this.p1)},Yn.prototype.projectionFactor=function(l){if(l.equals(this.p0))return 0;if(l.equals(this.p1))return 1;var d=this.p1.x-this.p0.x,_=this.p1.y-this.p0.y,b=d*d+_*_;return b<=0?le.NaN:((l.x-this.p0.x)*d+(l.y-this.p0.y)*_)/b},Yn.prototype.closestPoints=function(l){var d=this.intersection(l);if(null!==d)return[d,d];var _=new Array(2).fill(null),b=le.MAX_VALUE,I=null,N=this.closestPoint(l.p0);b=N.distance(l.p0),_[0]=N,_[1]=l.p0;var j=this.closestPoint(l.p1);(I=j.distance(l.p1))<b&&(b=I,_[0]=j,_[1]=l.p1);var ne=l.closestPoint(this.p0);(I=ne.distance(this.p0))<b&&(b=I,_[0]=this.p0,_[1]=ne);var Ee=l.closestPoint(this.p1);return(I=Ee.distance(this.p1))<b&&(b=I,_[0]=this.p1,_[1]=Ee),_},Yn.prototype.closestPoint=function(l){var d=this.projectionFactor(l);return d>0&&d<1?this.project(l):this.p0.distance(l)<this.p1.distance(l)?this.p0:this.p1},Yn.prototype.maxX=function(){return Math.max(this.p0.x,this.p1.x)},Yn.prototype.getLength=function(){return this.p0.distance(this.p1)},Yn.prototype.compareTo=function(l){var d=l,_=this.p0.compareTo(d.p0);return 0!==_?_:this.p1.compareTo(d.p1)},Yn.prototype.reverse=function(){var l=this.p0;this.p0=this.p1,this.p1=l},Yn.prototype.equalsTopo=function(l){return this.p0.equals(l.p0)&&(this.p1.equals(l.p1)||this.p0.equals(l.p1))&&this.p1.equals(l.p0)},Yn.prototype.lineIntersection=function(l){try{return Vn.intersection(this.p0,this.p1,l.p0,l.p1)}catch(d){if(!(d instanceof sr))throw d}return null},Yn.prototype.maxY=function(){return Math.max(this.p0.y,this.p1.y)},Yn.prototype.pointAlongOffset=function(l,d){var _=this.p0.x+l*(this.p1.x-this.p0.x),b=this.p0.y+l*(this.p1.y-this.p0.y),I=this.p1.x-this.p0.x,N=this.p1.y-this.p0.y,j=Math.sqrt(I*I+N*N),ne=0,Ee=0;if(0!==d){if(j<=0)throw new Error("Cannot compute offset from zero-length line segment");ne=d*I/j,Ee=d*N/j}return new re(_-Ee,b+ne)},Yn.prototype.setCoordinates=function(){if(1===arguments.length){var l=arguments[0];this.setCoordinates(l.p0,l.p1)}else if(2===arguments.length){var d=arguments[0],_=arguments[1];this.p0.x=d.x,this.p0.y=d.y,this.p1.x=_.x,this.p1.y=_.y}},Yn.prototype.segmentFraction=function(l){var d=this.projectionFactor(l);return d<0?d=0:(d>1||le.isNaN(d))&&(d=1),d},Yn.prototype.toString=function(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"},Yn.prototype.isHorizontal=function(){return this.p0.y===this.p1.y},Yn.prototype.distance=function(){if(arguments[0]instanceof Yn){var l=arguments[0];return wt.distanceLineLine(this.p0,this.p1,l.p0,l.p1)}if(arguments[0]instanceof re)return wt.distancePointLine(arguments[0],this.p0,this.p1)},Yn.prototype.pointAlong=function(l){var d=new re;return d.x=this.p0.x+l*(this.p1.x-this.p0.x),d.y=this.p0.y+l*(this.p1.y-this.p0.y),d},Yn.prototype.hashCode=function(){var l=le.doubleToLongBits(this.p0.x);l^=31*le.doubleToLongBits(this.p0.y);var d=Math.trunc(l)^Math.trunc(l>>32),_=le.doubleToLongBits(this.p1.x);return _^=31*le.doubleToLongBits(this.p1.y),d^Math.trunc(_)^Math.trunc(_>>32)},Yn.prototype.interfaces_=function(){return[he,De]},Yn.prototype.getClass=function(){return Yn},Yn.midPoint=function(l,d){return new re((l.x+d.x)/2,(l.y+d.y)/2)},ro.serialVersionUID.get=function(){return 0x2d2172135f411c00},Object.defineProperties(Yn,ro);var au=function(){this.tempEnv1=new rn,this.tempEnv2=new rn,this._overlapSeg1=new Yn,this._overlapSeg2=new Yn};au.prototype.overlap=function(){if(2!==arguments.length&&4===arguments.length){var _=arguments[2],b=arguments[3];arguments[0].getLineSegment(arguments[1],this._overlapSeg1),_.getLineSegment(b,this._overlapSeg2),this.overlap(this._overlapSeg1,this._overlapSeg2)}},au.prototype.interfaces_=function(){return[]},au.prototype.getClass=function(){return au};var Ds=function(){this._pts=null,this._start=null,this._end=null,this._env=null,this._context=null,this._id=null;var d=arguments[1],_=arguments[2],b=arguments[3];this._pts=arguments[0],this._start=d,this._end=_,this._context=b};Ds.prototype.getLineSegment=function(l,d){d.p0=this._pts[l],d.p1=this._pts[l+1]},Ds.prototype.computeSelect=function(l,d,_,b){if(b.tempEnv1.init(this._pts[d],this._pts[_]),_-d==1)return b.select(this,d),null;if(!l.intersects(b.tempEnv1))return null;var j=Math.trunc((d+_)/2);d<j&&this.computeSelect(l,d,j,b),j<_&&this.computeSelect(l,j,_,b)},Ds.prototype.getCoordinates=function(){for(var l=new Array(this._end-this._start+1).fill(null),d=0,_=this._start;_<=this._end;_++)l[d++]=this._pts[_];return l},Ds.prototype.computeOverlaps=function(l,d){this.computeOverlapsInternal(this._start,this._end,l,l._start,l._end,d)},Ds.prototype.setId=function(l){this._id=l},Ds.prototype.select=function(l,d){this.computeSelect(l,this._start,this._end,d)},Ds.prototype.getEnvelope=function(){return null===this._env&&(this._env=new rn(this._pts[this._start],this._pts[this._end])),this._env},Ds.prototype.getEndIndex=function(){return this._end},Ds.prototype.getStartIndex=function(){return this._start},Ds.prototype.getContext=function(){return this._context},Ds.prototype.getId=function(){return this._id},Ds.prototype.computeOverlapsInternal=function(l,d,_,b,I,N){var j=this._pts[l],ne=this._pts[d],Ee=_._pts[b],it=_._pts[I];if(d-l==1&&I-b==1)return N.overlap(this,l,_,b),null;if(N.tempEnv1.init(j,ne),N.tempEnv2.init(Ee,it),!N.tempEnv1.intersects(N.tempEnv2))return null;var Bt=Math.trunc((l+d)/2),zt=Math.trunc((b+I)/2);l<Bt&&(b<zt&&this.computeOverlapsInternal(l,Bt,_,b,zt,N),zt<I&&this.computeOverlapsInternal(l,Bt,_,zt,I,N)),Bt<d&&(b<zt&&this.computeOverlapsInternal(Bt,d,_,b,zt,N),zt<I&&this.computeOverlapsInternal(Bt,d,_,zt,I,N))},Ds.prototype.interfaces_=function(){return[]},Ds.prototype.getClass=function(){return Ds};var Ma=function(){};Ma.prototype.interfaces_=function(){return[]},Ma.prototype.getClass=function(){return Ma},Ma.getChainStartIndices=function(l){var d=0,_=new ln;_.add(new lt(d));do{var b=Ma.findChainEnd(l,d);_.add(new lt(b)),d=b}while(d<l.length-1);return Ma.toIntArray(_)},Ma.findChainEnd=function(l,d){for(var _=d;_<l.length-1&&l[_].equals2D(l[_+1]);)_++;if(_>=l.length-1)return l.length-1;for(var b=Wi.quadrant(l[_],l[_+1]),I=d+1;I<l.length&&(l[I-1].equals2D(l[I])||Wi.quadrant(l[I-1],l[I])===b);)I++;return I-1},Ma.getChains=function(){if(1===arguments.length)return Ma.getChains(arguments[0],null);if(2===arguments.length){for(var d=arguments[0],_=arguments[1],b=new ln,I=Ma.getChainStartIndices(d),N=0;N<I.length-1;N++){var j=new Ds(d,I[N],I[N+1],_);b.add(j)}return b}},Ma.toIntArray=function(l){for(var d=new Array(l.size()).fill(null),_=0;_<d.length;_++)d[_]=l.get(_).intValue();return d};var lu=function(){};lu.prototype.computeNodes=function(l){},lu.prototype.getNodedSubstrings=function(){},lu.prototype.interfaces_=function(){return[]},lu.prototype.getClass=function(){return lu};var Jc=function(){this._segInt=null,0!==arguments.length&&1===arguments.length&&this.setSegmentIntersector(arguments[0])};Jc.prototype.setSegmentIntersector=function(l){this._segInt=l},Jc.prototype.interfaces_=function(){return[lu]},Jc.prototype.getClass=function(){return Jc};var Xl=function(l){function d(b){b?l.call(this,b):l.call(this),this._monoChains=new ln,this._index=new Lh,this._idCounter=0,this._nodedSegStrings=null,this._nOverlaps=0}l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d;var _={SegmentOverlapAction:{configurable:!0}};return d.prototype.getMonotoneChains=function(){return this._monoChains},d.prototype.getNodedSubstrings=function(){return as.getNodedSubstrings(this._nodedSegStrings)},d.prototype.getIndex=function(){return this._index},d.prototype.add=function(b){for(var I=Ma.getChains(b.getCoordinates(),b).iterator();I.hasNext();){var N=I.next();N.setId(this._idCounter++),this._index.insert(N.getEnvelope(),N),this._monoChains.add(N)}},d.prototype.computeNodes=function(b){this._nodedSegStrings=b;for(var I=b.iterator();I.hasNext();)this.add(I.next());this.intersectChains()},d.prototype.intersectChains=function(){for(var b=new uu(this._segInt),I=this._monoChains.iterator();I.hasNext();)for(var N=I.next(),j=this._index.query(N.getEnvelope()).iterator();j.hasNext();){var ne=j.next();if(ne.getId()>N.getId()&&(N.computeOverlaps(ne,b),this._nOverlaps++),this._segInt.isDone())return null}},d.prototype.interfaces_=function(){return[]},d.prototype.getClass=function(){return d},_.SegmentOverlapAction.get=function(){return uu},Object.defineProperties(d,_),d}(Jc),uu=function(l){function d(){l.call(this),this._si=null,this._si=arguments[0]}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.overlap=function(){if(4!==arguments.length)return l.prototype.overlap.apply(this,arguments);var b=arguments[1],I=arguments[2],N=arguments[3],j=arguments[0].getContext(),ne=I.getContext();this._si.processIntersections(j,b,ne,N)},d.prototype.interfaces_=function(){return[]},d.prototype.getClass=function(){return d},d}(au),Yr=function l(){if(this._quadrantSegments=l.DEFAULT_QUADRANT_SEGMENTS,this._endCapStyle=l.CAP_ROUND,this._joinStyle=l.JOIN_ROUND,this._mitreLimit=l.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,this._simplifyFactor=l.DEFAULT_SIMPLIFY_FACTOR,0!==arguments.length)if(1===arguments.length)this.setQuadrantSegments(arguments[0]);else if(2===arguments.length){var b=arguments[1];this.setQuadrantSegments(arguments[0]),this.setEndCapStyle(b)}else if(4===arguments.length){var N=arguments[1],j=arguments[2],ne=arguments[3];this.setQuadrantSegments(arguments[0]),this.setEndCapStyle(N),this.setJoinStyle(j),this.setMitreLimit(ne)}},ao={CAP_ROUND:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},JOIN_ROUND:{configurable:!0},JOIN_MITRE:{configurable:!0},JOIN_BEVEL:{configurable:!0},DEFAULT_QUADRANT_SEGMENTS:{configurable:!0},DEFAULT_MITRE_LIMIT:{configurable:!0},DEFAULT_SIMPLIFY_FACTOR:{configurable:!0}};Yr.prototype.getEndCapStyle=function(){return this._endCapStyle},Yr.prototype.isSingleSided=function(){return this._isSingleSided},Yr.prototype.setQuadrantSegments=function(l){this._quadrantSegments=l,0===this._quadrantSegments&&(this._joinStyle=Yr.JOIN_BEVEL),this._quadrantSegments<0&&(this._joinStyle=Yr.JOIN_MITRE,this._mitreLimit=Math.abs(this._quadrantSegments)),l<=0&&(this._quadrantSegments=1),this._joinStyle!==Yr.JOIN_ROUND&&(this._quadrantSegments=Yr.DEFAULT_QUADRANT_SEGMENTS)},Yr.prototype.getJoinStyle=function(){return this._joinStyle},Yr.prototype.setJoinStyle=function(l){this._joinStyle=l},Yr.prototype.setSimplifyFactor=function(l){this._simplifyFactor=l<0?0:l},Yr.prototype.getSimplifyFactor=function(){return this._simplifyFactor},Yr.prototype.getQuadrantSegments=function(){return this._quadrantSegments},Yr.prototype.setEndCapStyle=function(l){this._endCapStyle=l},Yr.prototype.getMitreLimit=function(){return this._mitreLimit},Yr.prototype.setMitreLimit=function(l){this._mitreLimit=l},Yr.prototype.setSingleSided=function(l){this._isSingleSided=l},Yr.prototype.interfaces_=function(){return[]},Yr.prototype.getClass=function(){return Yr},Yr.bufferDistanceError=function(l){var d=Math.PI/2/l;return 1-Math.cos(d/2)},ao.CAP_ROUND.get=function(){return 1},ao.CAP_FLAT.get=function(){return 2},ao.CAP_SQUARE.get=function(){return 3},ao.JOIN_ROUND.get=function(){return 1},ao.JOIN_MITRE.get=function(){return 2},ao.JOIN_BEVEL.get=function(){return 3},ao.DEFAULT_QUADRANT_SEGMENTS.get=function(){return 8},ao.DEFAULT_MITRE_LIMIT.get=function(){return 5},ao.DEFAULT_SIMPLIFY_FACTOR.get=function(){return.01},Object.defineProperties(Yr,ao);var ii=function(l){this._distanceTol=null,this._isDeleted=null,this._angleOrientation=wt.COUNTERCLOCKWISE,this._inputLine=l||null},gc={INIT:{configurable:!0},DELETE:{configurable:!0},KEEP:{configurable:!0},NUM_PTS_TO_CHECK:{configurable:!0}};ii.prototype.isDeletable=function(l,d,_,b){var I=this._inputLine[l],N=this._inputLine[d],j=this._inputLine[_];return!!this.isConcave(I,N,j)&&!!this.isShallow(I,N,j,b)&&this.isShallowSampled(I,N,l,_,b)},ii.prototype.deleteShallowConcavities=function(){for(var l=1,d=this.findNextNonDeletedIndex(l),_=this.findNextNonDeletedIndex(d),b=!1;_<this._inputLine.length;){var I=!1;this.isDeletable(l,d,_,this._distanceTol)&&(this._isDeleted[d]=ii.DELETE,I=!0,b=!0),d=this.findNextNonDeletedIndex(l=I?_:d),_=this.findNextNonDeletedIndex(d)}return b},ii.prototype.isShallowConcavity=function(l,d,_,b){return wt.computeOrientation(l,d,_)===this._angleOrientation&&wt.distancePointLine(d,l,_)<b},ii.prototype.isShallowSampled=function(l,d,_,b,I){var N=Math.trunc((b-_)/ii.NUM_PTS_TO_CHECK);N<=0&&(N=1);for(var j=_;j<b;j+=N)if(!this.isShallow(l,d,this._inputLine[j],I))return!1;return!0},ii.prototype.isConcave=function(l,d,_){return wt.computeOrientation(l,d,_)===this._angleOrientation},ii.prototype.simplify=function(l){this._distanceTol=Math.abs(l),l<0&&(this._angleOrientation=wt.CLOCKWISE),this._isDeleted=new Array(this._inputLine.length).fill(null);var d=!1;do{d=this.deleteShallowConcavities()}while(d);return this.collapseLine()},ii.prototype.findNextNonDeletedIndex=function(l){for(var d=l+1;d<this._inputLine.length&&this._isDeleted[d]===ii.DELETE;)d++;return d},ii.prototype.isShallow=function(l,d,_,b){return wt.distancePointLine(d,l,_)<b},ii.prototype.collapseLine=function(){for(var l=new Fs,d=0;d<this._inputLine.length;d++)this._isDeleted[d]!==ii.DELETE&&l.add(this._inputLine[d]);return l.toCoordinateArray()},ii.prototype.interfaces_=function(){return[]},ii.prototype.getClass=function(){return ii},ii.simplify=function(l,d){return new ii(l).simplify(d)},gc.INIT.get=function(){return 0},gc.DELETE.get=function(){return 1},gc.KEEP.get=function(){return 1},gc.NUM_PTS_TO_CHECK.get=function(){return 10},Object.defineProperties(ii,gc);var ta=function(){this._ptList=null,this._precisionModel=null,this._minimimVertexDistance=0,this._ptList=new ln},Ac={COORDINATE_ARRAY_TYPE:{configurable:!0}};ta.prototype.getCoordinates=function(){return this._ptList.toArray(ta.COORDINATE_ARRAY_TYPE)},ta.prototype.setPrecisionModel=function(l){this._precisionModel=l},ta.prototype.addPt=function(l){var d=new re(l);if(this._precisionModel.makePrecise(d),this.isRedundant(d))return null;this._ptList.add(d)},ta.prototype.revere=function(){},ta.prototype.addPts=function(l,d){if(d)for(var _=0;_<l.length;_++)this.addPt(l[_]);else for(var b=l.length-1;b>=0;b--)this.addPt(l[b])},ta.prototype.isRedundant=function(l){if(this._ptList.size()<1)return!1;var d=this._ptList.get(this._ptList.size()-1);return l.distance(d)<this._minimimVertexDistance},ta.prototype.toString=function(){return(new fr).createLineString(this.getCoordinates()).toString()},ta.prototype.closeRing=function(){if(this._ptList.size()<1)return null;var l=new re(this._ptList.get(0)),d=this._ptList.get(this._ptList.size()-1);if(l.equals(d))return null;this._ptList.add(l)},ta.prototype.setMinimumVertexDistance=function(l){this._minimimVertexDistance=l},ta.prototype.interfaces_=function(){return[]},ta.prototype.getClass=function(){return ta},Ac.COORDINATE_ARRAY_TYPE.get=function(){return new Array(0).fill(null)},Object.defineProperties(ta,Ac);var Gn=function(){},cu={PI_TIMES_2:{configurable:!0},PI_OVER_2:{configurable:!0},PI_OVER_4:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},CLOCKWISE:{configurable:!0},NONE:{configurable:!0}};Gn.prototype.interfaces_=function(){return[]},Gn.prototype.getClass=function(){return Gn},Gn.toDegrees=function(l){return 180*l/Math.PI},Gn.normalize=function(l){for(;l>Math.PI;)l-=Gn.PI_TIMES_2;for(;l<=-Math.PI;)l+=Gn.PI_TIMES_2;return l},Gn.angle=function(){if(1===arguments.length){var l=arguments[0];return Math.atan2(l.y,l.x)}if(2===arguments.length){var d=arguments[0],_=arguments[1];return Math.atan2(_.y-d.y,_.x-d.x)}},Gn.isAcute=function(l,d,_){return(l.x-d.x)*(_.x-d.x)+(l.y-d.y)*(_.y-d.y)>0},Gn.isObtuse=function(l,d,_){return(l.x-d.x)*(_.x-d.x)+(l.y-d.y)*(_.y-d.y)<0},Gn.interiorAngle=function(l,d,_){var b=Gn.angle(d,l),I=Gn.angle(d,_);return Math.abs(I-b)},Gn.normalizePositive=function(l){if(l<0){for(;l<0;)l+=Gn.PI_TIMES_2;l>=Gn.PI_TIMES_2&&(l=0)}else{for(;l>=Gn.PI_TIMES_2;)l-=Gn.PI_TIMES_2;l<0&&(l=0)}return l},Gn.angleBetween=function(l,d,_){var b=Gn.angle(d,l),I=Gn.angle(d,_);return Gn.diff(b,I)},Gn.diff=function(l,d){var _=null;return(_=l<d?d-l:l-d)>Math.PI&&(_=2*Math.PI-_),_},Gn.toRadians=function(l){return l*Math.PI/180},Gn.getTurn=function(l,d){var _=Math.sin(d-l);return _>0?Gn.COUNTERCLOCKWISE:_<0?Gn.CLOCKWISE:Gn.NONE},Gn.angleBetweenOriented=function(l,d,_){var b=Gn.angle(d,l),I=Gn.angle(d,_)-b;return I<=-Math.PI?I+Gn.PI_TIMES_2:I>Math.PI?I-Gn.PI_TIMES_2:I},cu.PI_TIMES_2.get=function(){return 2*Math.PI},cu.PI_OVER_2.get=function(){return Math.PI/2},cu.PI_OVER_4.get=function(){return Math.PI/4},cu.COUNTERCLOCKWISE.get=function(){return wt.COUNTERCLOCKWISE},cu.CLOCKWISE.get=function(){return wt.CLOCKWISE},cu.NONE.get=function(){return wt.COLLINEAR},Object.defineProperties(Gn,cu);var _i=function l(){this._maxCurveSegmentError=0,this._filletAngleQuantum=null,this._closingSegLengthFactor=1,this._segList=null,this._distance=0,this._precisionModel=null,this._bufParams=null,this._li=null,this._s0=null,this._s1=null,this._s2=null,this._seg0=new Yn,this._seg1=new Yn,this._offset0=new Yn,this._offset1=new Yn,this._side=0,this._hasNarrowConcaveAngle=!1;var _=arguments[1],b=arguments[2];this._precisionModel=arguments[0],this._bufParams=_,this._li=new Ot,this._filletAngleQuantum=Math.PI/2/_.getQuadrantSegments(),_.getQuadrantSegments()>=8&&_.getJoinStyle()===Yr.JOIN_ROUND&&(this._closingSegLengthFactor=l.MAX_CLOSING_SEG_LEN_FACTOR),this.init(b)},Fn={OFFSET_SEGMENT_SEPARATION_FACTOR:{configurable:!0},INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},CURVE_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},MAX_CLOSING_SEG_LEN_FACTOR:{configurable:!0}};_i.prototype.addNextSegment=function(l,d){if(this._s0=this._s1,this._s1=this._s2,this._s2=l,this._seg0.setCoordinates(this._s0,this._s1),this.computeOffsetSegment(this._seg0,this._side,this._distance,this._offset0),this._seg1.setCoordinates(this._s1,this._s2),this.computeOffsetSegment(this._seg1,this._side,this._distance,this._offset1),this._s1.equals(this._s2))return null;var _=wt.computeOrientation(this._s0,this._s1,this._s2),b=_===wt.CLOCKWISE&&this._side===mn.LEFT||_===wt.COUNTERCLOCKWISE&&this._side===mn.RIGHT;0===_?this.addCollinear(d):b?this.addOutsideTurn(_,d):this.addInsideTurn(_,d)},_i.prototype.addLineEndCap=function(l,d){var _=new Yn(l,d),b=new Yn;this.computeOffsetSegment(_,mn.LEFT,this._distance,b);var I=new Yn;this.computeOffsetSegment(_,mn.RIGHT,this._distance,I);var ne=Math.atan2(d.y-l.y,d.x-l.x);switch(this._bufParams.getEndCapStyle()){case Yr.CAP_ROUND:this._segList.addPt(b.p1),this.addFilletArc(d,ne+Math.PI/2,ne-Math.PI/2,wt.CLOCKWISE,this._distance),this._segList.addPt(I.p1);break;case Yr.CAP_FLAT:this._segList.addPt(b.p1),this._segList.addPt(I.p1);break;case Yr.CAP_SQUARE:var Ee=new re;Ee.x=Math.abs(this._distance)*Math.cos(ne),Ee.y=Math.abs(this._distance)*Math.sin(ne);var it=new re(b.p1.x+Ee.x,b.p1.y+Ee.y),Bt=new re(I.p1.x+Ee.x,I.p1.y+Ee.y);this._segList.addPt(it),this._segList.addPt(Bt)}},_i.prototype.getCoordinates=function(){return this._segList.getCoordinates()},_i.prototype.addMitreJoin=function(l,d,_,b){var I=!0,N=null;try{N=Vn.intersection(d.p0,d.p1,_.p0,_.p1),(b<=0?1:N.distance(l)/Math.abs(b))>this._bufParams.getMitreLimit()&&(I=!1)}catch(j){if(!(j instanceof sr))throw j;N=new re(0,0),I=!1}I?this._segList.addPt(N):this.addLimitedMitreJoin(d,_,b,this._bufParams.getMitreLimit())},_i.prototype.addFilletCorner=function(l,d,_,b,I){var ne=Math.atan2(d.y-l.y,d.x-l.x),Bt=Math.atan2(_.y-l.y,_.x-l.x);b===wt.CLOCKWISE?ne<=Bt&&(ne+=2*Math.PI):ne>=Bt&&(ne-=2*Math.PI),this._segList.addPt(d),this.addFilletArc(l,ne,Bt,b,I),this._segList.addPt(_)},_i.prototype.addOutsideTurn=function(l,d){if(this._offset0.p1.distance(this._offset1.p0)<this._distance*_i.OFFSET_SEGMENT_SEPARATION_FACTOR)return this._segList.addPt(this._offset0.p1),null;this._bufParams.getJoinStyle()===Yr.JOIN_MITRE?this.addMitreJoin(this._s1,this._offset0,this._offset1,this._distance):this._bufParams.getJoinStyle()===Yr.JOIN_BEVEL?this.addBevelJoin(this._offset0,this._offset1):(d&&this._segList.addPt(this._offset0.p1),this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,l,this._distance),this._segList.addPt(this._offset1.p0))},_i.prototype.createSquare=function(l){this._segList.addPt(new re(l.x+this._distance,l.y+this._distance)),this._segList.addPt(new re(l.x+this._distance,l.y-this._distance)),this._segList.addPt(new re(l.x-this._distance,l.y-this._distance)),this._segList.addPt(new re(l.x-this._distance,l.y+this._distance)),this._segList.closeRing()},_i.prototype.addSegments=function(l,d){this._segList.addPts(l,d)},_i.prototype.addFirstSegment=function(){this._segList.addPt(this._offset1.p0)},_i.prototype.addLastSegment=function(){this._segList.addPt(this._offset1.p1)},_i.prototype.initSideSegments=function(l,d,_){this._s1=l,this._s2=d,this._side=_,this._seg1.setCoordinates(l,d),this.computeOffsetSegment(this._seg1,_,this._distance,this._offset1)},_i.prototype.addLimitedMitreJoin=function(l,d,_,b){var I=this._seg0.p1,N=Gn.angle(I,this._seg0.p0),j=Gn.angleBetweenOriented(this._seg0.p0,I,this._seg1.p1)/2,ne=Gn.normalize(N+j),Ee=Gn.normalize(ne+Math.PI),it=b*_,Bt=_-it*Math.abs(Math.sin(j)),zt=I.x+it*Math.cos(Ee),vn=I.y+it*Math.sin(Ee),pn=new re(zt,vn),Pn=new Yn(I,pn),rr=Pn.pointAlongOffset(1,Bt),C=Pn.pointAlongOffset(1,-Bt);this._side===mn.LEFT?(this._segList.addPt(rr),this._segList.addPt(C)):(this._segList.addPt(C),this._segList.addPt(rr))},_i.prototype.computeOffsetSegment=function(l,d,_,b){var I=d===mn.LEFT?1:-1,N=l.p1.x-l.p0.x,j=l.p1.y-l.p0.y,ne=Math.sqrt(N*N+j*j),Ee=I*_*N/ne,it=I*_*j/ne;b.p0.x=l.p0.x-it,b.p0.y=l.p0.y+Ee,b.p1.x=l.p1.x-it,b.p1.y=l.p1.y+Ee},_i.prototype.addFilletArc=function(l,d,_,b,I){var N=b===wt.CLOCKWISE?-1:1,j=Math.abs(d-_),ne=Math.trunc(j/this._filletAngleQuantum+.5);if(ne<1)return null;for(var Ee=j/ne,it=0,Bt=new re;it<j;){var zt=d+N*it;Bt.x=l.x+I*Math.cos(zt),Bt.y=l.y+I*Math.sin(zt),this._segList.addPt(Bt),it+=Ee}},_i.prototype.addInsideTurn=function(l,d){if(this._li.computeIntersection(this._offset0.p0,this._offset0.p1,this._offset1.p0,this._offset1.p1),this._li.hasIntersection())this._segList.addPt(this._li.getIntersection(0));else if(this._hasNarrowConcaveAngle=!0,this._offset0.p1.distance(this._offset1.p0)<this._distance*_i.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)this._segList.addPt(this._offset0.p1);else{if(this._segList.addPt(this._offset0.p1),this._closingSegLengthFactor>0){var _=new re((this._closingSegLengthFactor*this._offset0.p1.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset0.p1.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(_);var b=new re((this._closingSegLengthFactor*this._offset1.p0.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset1.p0.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(b)}else this._segList.addPt(this._s1);this._segList.addPt(this._offset1.p0)}},_i.prototype.createCircle=function(l){var d=new re(l.x+this._distance,l.y);this._segList.addPt(d),this.addFilletArc(l,0,2*Math.PI,-1,this._distance),this._segList.closeRing()},_i.prototype.addBevelJoin=function(l,d){this._segList.addPt(l.p1),this._segList.addPt(d.p0)},_i.prototype.init=function(l){this._distance=l,this._maxCurveSegmentError=l*(1-Math.cos(this._filletAngleQuantum/2)),this._segList=new ta,this._segList.setPrecisionModel(this._precisionModel),this._segList.setMinimumVertexDistance(l*_i.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)},_i.prototype.addCollinear=function(l){this._li.computeIntersection(this._s0,this._s1,this._s1,this._s2),this._li.getIntersectionNum()>=2&&(this._bufParams.getJoinStyle()===Yr.JOIN_BEVEL||this._bufParams.getJoinStyle()===Yr.JOIN_MITRE?(l&&this._segList.addPt(this._offset0.p1),this._segList.addPt(this._offset1.p0)):this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,wt.CLOCKWISE,this._distance))},_i.prototype.closeRing=function(){this._segList.closeRing()},_i.prototype.hasNarrowConcaveAngle=function(){return this._hasNarrowConcaveAngle},_i.prototype.interfaces_=function(){return[]},_i.prototype.getClass=function(){return _i},Fn.OFFSET_SEGMENT_SEPARATION_FACTOR.get=function(){return.001},Fn.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return.001},Fn.CURVE_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return 1e-6},Fn.MAX_CLOSING_SEG_LEN_FACTOR.get=function(){return 80},Object.defineProperties(_i,Fn);var Yi=function(){this._distance=0,this._precisionModel=null,this._bufParams=null;var d=arguments[1];this._precisionModel=arguments[0],this._bufParams=d};Yi.prototype.getOffsetCurve=function(l,d){if(this._distance=d,0===d)return null;var _=d<0,b=Math.abs(d),I=this.getSegGen(b);l.length<=1?this.computePointCurve(l[0],I):this.computeOffsetCurve(l,_,I);var N=I.getCoordinates();return _&&yr.reverse(N),N},Yi.prototype.computeSingleSidedBufferCurve=function(l,d,_){var b=this.simplifyTolerance(this._distance);if(d){_.addSegments(l,!0);var I=ii.simplify(l,-b),N=I.length-1;_.initSideSegments(I[N],I[N-1],mn.LEFT),_.addFirstSegment();for(var j=N-2;j>=0;j--)_.addNextSegment(I[j],!0)}else{_.addSegments(l,!1);var ne=ii.simplify(l,b),Ee=ne.length-1;_.initSideSegments(ne[0],ne[1],mn.LEFT),_.addFirstSegment();for(var it=2;it<=Ee;it++)_.addNextSegment(ne[it],!0)}_.addLastSegment(),_.closeRing()},Yi.prototype.computeRingBufferCurve=function(l,d,_){var b=this.simplifyTolerance(this._distance);d===mn.RIGHT&&(b=-b);var I=ii.simplify(l,b),N=I.length-1;_.initSideSegments(I[N-1],I[0],d);for(var j=1;j<=N;j++)_.addNextSegment(I[j],1!==j);_.closeRing()},Yi.prototype.computeLineBufferCurve=function(l,d){var _=this.simplifyTolerance(this._distance),b=ii.simplify(l,_),I=b.length-1;d.initSideSegments(b[0],b[1],mn.LEFT);for(var N=2;N<=I;N++)d.addNextSegment(b[N],!0);d.addLastSegment(),d.addLineEndCap(b[I-1],b[I]);var j=ii.simplify(l,-_),ne=j.length-1;d.initSideSegments(j[ne],j[ne-1],mn.LEFT);for(var Ee=ne-2;Ee>=0;Ee--)d.addNextSegment(j[Ee],!0);d.addLastSegment(),d.addLineEndCap(j[1],j[0]),d.closeRing()},Yi.prototype.computePointCurve=function(l,d){switch(this._bufParams.getEndCapStyle()){case Yr.CAP_ROUND:d.createCircle(l);break;case Yr.CAP_SQUARE:d.createSquare(l)}},Yi.prototype.getLineCurve=function(l,d){if(this._distance=d,d<0&&!this._bufParams.isSingleSided()||0===d)return null;var _=Math.abs(d),b=this.getSegGen(_);return l.length<=1?this.computePointCurve(l[0],b):this._bufParams.isSingleSided()?this.computeSingleSidedBufferCurve(l,d<0,b):this.computeLineBufferCurve(l,b),b.getCoordinates()},Yi.prototype.getBufferParameters=function(){return this._bufParams},Yi.prototype.simplifyTolerance=function(l){return l*this._bufParams.getSimplifyFactor()},Yi.prototype.getRingCurve=function(l,d,_){if(this._distance=_,l.length<=2)return this.getLineCurve(l,_);if(0===_)return Yi.copyCoordinates(l);var b=this.getSegGen(_);return this.computeRingBufferCurve(l,d,b),b.getCoordinates()},Yi.prototype.computeOffsetCurve=function(l,d,_){var b=this.simplifyTolerance(this._distance);if(d){var I=ii.simplify(l,-b),N=I.length-1;_.initSideSegments(I[N],I[N-1],mn.LEFT),_.addFirstSegment();for(var j=N-2;j>=0;j--)_.addNextSegment(I[j],!0)}else{var ne=ii.simplify(l,b),Ee=ne.length-1;_.initSideSegments(ne[0],ne[1],mn.LEFT),_.addFirstSegment();for(var it=2;it<=Ee;it++)_.addNextSegment(ne[it],!0)}_.addLastSegment()},Yi.prototype.getSegGen=function(l){return new _i(this._precisionModel,this._bufParams,l)},Yi.prototype.interfaces_=function(){return[]},Yi.prototype.getClass=function(){return Yi},Yi.copyCoordinates=function(l){for(var d=new Array(l.length).fill(null),_=0;_<d.length;_++)d[_]=new re(l[_]);return d};var Yo=function(){this._subgraphs=null,this._seg=new Yn,this._cga=new wt,this._subgraphs=arguments[0]},hu={DepthSegment:{configurable:!0}};Yo.prototype.findStabbedSegments=function(){if(1===arguments.length){for(var l=arguments[0],d=new ln,_=this._subgraphs.iterator();_.hasNext();){var b=_.next(),I=b.getEnvelope();l.y<I.getMinY()||l.y>I.getMaxY()||this.findStabbedSegments(l,b.getDirectedEdges(),d)}return d}if(3===arguments.length)if(Lt(arguments[2],fo)&&arguments[0]instanceof re&&arguments[1]instanceof kh){for(var N=arguments[0],j=arguments[1],ne=arguments[2],Ee=j.getEdge().getCoordinates(),it=0;it<Ee.length-1;it++)if(this._seg.p0=Ee[it],this._seg.p1=Ee[it+1],this._seg.p0.y>this._seg.p1.y&&this._seg.reverse(),!(Math.max(this._seg.p0.x,this._seg.p1.x)<N.x||this._seg.isHorizontal()||N.y<this._seg.p0.y||N.y>this._seg.p1.y||wt.computeOrientation(this._seg.p0,this._seg.p1,N)===wt.RIGHT)){var Bt=j.getDepth(mn.LEFT);this._seg.p0.equals(Ee[it])||(Bt=j.getDepth(mn.RIGHT));var zt=new Ka(this._seg,Bt);ne.add(zt)}}else if(Lt(arguments[2],fo)&&arguments[0]instanceof re&&Lt(arguments[1],fo))for(var vn=arguments[0],Pn=arguments[2],rr=arguments[1].iterator();rr.hasNext();){var C=rr.next();C.isForward()&&this.findStabbedSegments(vn,C,Pn)}},Yo.prototype.getDepth=function(l){var d=this.findStabbedSegments(l);return 0===d.size()?0:ss.min(d)._leftDepth},Yo.prototype.interfaces_=function(){return[]},Yo.prototype.getClass=function(){return Yo},hu.DepthSegment.get=function(){return Ka},Object.defineProperties(Yo,hu);var Ka=function(){this._upwardSeg=null,this._leftDepth=null;var d=arguments[1];this._upwardSeg=new Yn(arguments[0]),this._leftDepth=d};Ka.prototype.compareTo=function(l){var d=l;if(this._upwardSeg.minX()>=d._upwardSeg.maxX())return 1;if(this._upwardSeg.maxX()<=d._upwardSeg.minX())return-1;var _=this._upwardSeg.orientationIndex(d._upwardSeg);return 0!==_||0!=(_=-1*d._upwardSeg.orientationIndex(this._upwardSeg))?_:this._upwardSeg.compareTo(d._upwardSeg)},Ka.prototype.compareX=function(l,d){var _=l.p0.compareTo(d.p0);return 0!==_?_:l.p1.compareTo(d.p1)},Ka.prototype.toString=function(){return this._upwardSeg.toString()},Ka.prototype.interfaces_=function(){return[he]},Ka.prototype.getClass=function(){return Ka};var Cr=function(l,d,_){this.p0=l||null,this.p1=d||null,this.p2=_||null};Cr.prototype.area=function(){return Cr.area(this.p0,this.p1,this.p2)},Cr.prototype.signedArea=function(){return Cr.signedArea(this.p0,this.p1,this.p2)},Cr.prototype.interpolateZ=function(l){if(null===l)throw new pe("Supplied point is null.");return Cr.interpolateZ(l,this.p0,this.p1,this.p2)},Cr.prototype.longestSideLength=function(){return Cr.longestSideLength(this.p0,this.p1,this.p2)},Cr.prototype.isAcute=function(){return Cr.isAcute(this.p0,this.p1,this.p2)},Cr.prototype.circumcentre=function(){return Cr.circumcentre(this.p0,this.p1,this.p2)},Cr.prototype.area3D=function(){return Cr.area3D(this.p0,this.p1,this.p2)},Cr.prototype.centroid=function(){return Cr.centroid(this.p0,this.p1,this.p2)},Cr.prototype.inCentre=function(){return Cr.inCentre(this.p0,this.p1,this.p2)},Cr.prototype.interfaces_=function(){return[]},Cr.prototype.getClass=function(){return Cr},Cr.area=function(l,d,_){return Math.abs(((_.x-l.x)*(d.y-l.y)-(d.x-l.x)*(_.y-l.y))/2)},Cr.signedArea=function(l,d,_){return((_.x-l.x)*(d.y-l.y)-(d.x-l.x)*(_.y-l.y))/2},Cr.det=function(l,d,_,b){return l*b-d*_},Cr.interpolateZ=function(l,d,_,b){var I=d.x,N=d.y,j=_.x-I,ne=b.x-I,Ee=_.y-N,it=b.y-N,Bt=j*it-ne*Ee,zt=l.x-I,vn=l.y-N;return d.z+(it*zt-ne*vn)/Bt*(_.z-d.z)+(-Ee*zt+j*vn)/Bt*(b.z-d.z)},Cr.longestSideLength=function(l,d,_){var b=l.distance(d),I=d.distance(_),N=_.distance(l),j=b;return I>j&&(j=I),N>j&&(j=N),j},Cr.isAcute=function(l,d,_){return!!Gn.isAcute(l,d,_)&&!!Gn.isAcute(d,_,l)&&!!Gn.isAcute(_,l,d)},Cr.circumcentre=function(l,d,_){var b=_.x,I=_.y,N=l.x-b,j=l.y-I,ne=d.x-b,Ee=d.y-I,it=2*Cr.det(N,j,ne,Ee),Bt=Cr.det(j,N*N+j*j,Ee,ne*ne+Ee*Ee),zt=Cr.det(N,N*N+j*j,ne,ne*ne+Ee*Ee);return new re(b-Bt/it,I+zt/it)},Cr.perpendicularBisector=function(l,d){var _=d.x-l.x,b=d.y-l.y,I=new Vn(l.x+_/2,l.y+b/2,1),N=new Vn(l.x-b+_/2,l.y+_+b/2,1);return new Vn(I,N)},Cr.angleBisector=function(l,d,_){var b=d.distance(l),I=b/(b+d.distance(_));return new re(l.x+I*(_.x-l.x),l.y+I*(_.y-l.y))},Cr.area3D=function(l,d,_){var b=d.x-l.x,I=d.y-l.y,N=d.z-l.z,j=_.x-l.x,ne=_.y-l.y,Ee=_.z-l.z,it=I*Ee-N*ne,Bt=N*j-b*Ee,zt=b*ne-I*j;return Math.sqrt(it*it+Bt*Bt+zt*zt)/2},Cr.centroid=function(l,d,_){return new re((l.x+d.x+_.x)/3,(l.y+d.y+_.y)/3)},Cr.inCentre=function(l,d,_){var b=d.distance(_),I=l.distance(_),N=l.distance(d),j=b+I+N;return new re((b*l.x+I*d.x+N*_.x)/j,(b*l.y+I*d.y+N*_.y)/j)};var Ja=function(){this._inputGeom=null,this._distance=null,this._curveBuilder=null,this._curveList=new ln;var d=arguments[1],_=arguments[2];this._inputGeom=arguments[0],this._distance=d,this._curveBuilder=_};Ja.prototype.addPoint=function(l){if(this._distance<=0)return null;var d=l.getCoordinates(),_=this._curveBuilder.getLineCurve(d,this._distance);this.addCurve(_,xe.EXTERIOR,xe.INTERIOR)},Ja.prototype.addPolygon=function(l){var d=this._distance,_=mn.LEFT;this._distance<0&&(d=-this._distance,_=mn.RIGHT);var b=l.getExteriorRing(),I=yr.removeRepeatedPoints(b.getCoordinates());if(this._distance<0&&this.isErodedCompletely(b,this._distance)||this._distance<=0&&I.length<3)return null;this.addPolygonRing(I,d,_,xe.EXTERIOR,xe.INTERIOR);for(var N=0;N<l.getNumInteriorRing();N++){var j=l.getInteriorRingN(N),ne=yr.removeRepeatedPoints(j.getCoordinates());this._distance>0&&this.isErodedCompletely(j,-this._distance)||this.addPolygonRing(ne,d,mn.opposite(_),xe.INTERIOR,xe.EXTERIOR)}},Ja.prototype.isTriangleErodedCompletely=function(l,d){var _=new Cr(l[0],l[1],l[2]),b=_.inCentre();return wt.distancePointLine(b,_.p0,_.p1)<Math.abs(d)},Ja.prototype.addLineString=function(l){if(this._distance<=0&&!this._curveBuilder.getBufferParameters().isSingleSided())return null;var d=yr.removeRepeatedPoints(l.getCoordinates()),_=this._curveBuilder.getLineCurve(d,this._distance);this.addCurve(_,xe.EXTERIOR,xe.INTERIOR)},Ja.prototype.addCurve=function(l,d,_){if(null===l||l.length<2)return null;var b=new as(l,new li(0,xe.BOUNDARY,d,_));this._curveList.add(b)},Ja.prototype.getCurves=function(){return this.add(this._inputGeom),this._curveList},Ja.prototype.addPolygonRing=function(l,d,_,b,I){if(0===d&&l.length<po.MINIMUM_VALID_SIZE)return null;var N=b,j=I;l.length>=po.MINIMUM_VALID_SIZE&&wt.isCCW(l)&&(N=I,j=b,_=mn.opposite(_));var ne=this._curveBuilder.getRingCurve(l,_,d);this.addCurve(ne,N,j)},Ja.prototype.add=function(l){if(l.isEmpty())return null;l instanceof Xn?this.addPolygon(l):l instanceof vr?this.addLineString(l):l instanceof gn?this.addPoint(l):(l instanceof wa||l instanceof Vt||l instanceof Rn||l instanceof tt)&&this.addCollection(l)},Ja.prototype.isErodedCompletely=function(l,d){var _=l.getCoordinates();if(_.length<4)return d<0;if(4===_.length)return this.isTriangleErodedCompletely(_,d);var b=l.getEnvelopeInternal(),I=Math.min(b.getHeight(),b.getWidth());return d<0&&2*Math.abs(d)>I},Ja.prototype.addCollection=function(l){for(var d=0;d<l.getNumGeometries();d++){var _=l.getGeometryN(d);this.add(_)}},Ja.prototype.interfaces_=function(){return[]},Ja.prototype.getClass=function(){return Ja};var pa=function(){};pa.prototype.locate=function(l){},pa.prototype.interfaces_=function(){return[]},pa.prototype.getClass=function(){return pa};var On=function(){this._parent=null,this._atStart=null,this._max=null,this._index=null,this._subcollectionIterator=null;var l=arguments[0];this._parent=l,this._atStart=!0,this._index=0,this._max=l.getNumGeometries()};On.prototype.next=function(){if(this._atStart)return this._atStart=!1,On.isAtomic(this._parent)&&this._index++,this._parent;if(null!==this._subcollectionIterator){if(this._subcollectionIterator.hasNext())return this._subcollectionIterator.next();this._subcollectionIterator=null}if(this._index>=this._max)throw new pt;var l=this._parent.getGeometryN(this._index++);return l instanceof tt?(this._subcollectionIterator=new On(l),this._subcollectionIterator.next()):l},On.prototype.remove=function(){throw new Error(this.getClass().getName())},On.prototype.hasNext=function(){if(this._atStart)return!0;if(null!==this._subcollectionIterator){if(this._subcollectionIterator.hasNext())return!0;this._subcollectionIterator=null}return!(this._index>=this._max)},On.prototype.interfaces_=function(){return[fa]},On.prototype.getClass=function(){return On},On.isAtomic=function(l){return!(l instanceof tt)};var Dr=function(){this._geom=null,this._geom=arguments[0]};Dr.prototype.locate=function(l){return Dr.locate(l,this._geom)},Dr.prototype.interfaces_=function(){return[pa]},Dr.prototype.getClass=function(){return Dr},Dr.isPointInRing=function(l,d){return!!d.getEnvelopeInternal().intersects(l)&&wt.isPointInRing(l,d.getCoordinates())},Dr.containsPointInPolygon=function(l,d){if(d.isEmpty())return!1;var _=d.getExteriorRing();if(!Dr.isPointInRing(l,_))return!1;for(var b=0;b<d.getNumInteriorRing();b++){var I=d.getInteriorRingN(b);if(Dr.isPointInRing(l,I))return!1}return!0},Dr.containsPoint=function(l,d){if(d instanceof Xn)return Dr.containsPointInPolygon(l,d);if(d instanceof tt)for(var _=new On(d);_.hasNext();){var b=_.next();if(b!==d&&Dr.containsPoint(l,b))return!0}return!1},Dr.locate=function(l,d){return d.isEmpty()?xe.EXTERIOR:Dr.containsPoint(l,d)?xe.INTERIOR:xe.EXTERIOR};var Wr=function(){this._edgeMap=new kt,this._edgeList=null,this._ptInAreaLocation=[xe.NONE,xe.NONE]};Wr.prototype.getNextCW=function(l){this.getEdges();var d=this._edgeList.indexOf(l),_=d-1;return 0===d&&(_=this._edgeList.size()-1),this._edgeList.get(_)},Wr.prototype.propagateSideLabels=function(l){for(var d=xe.NONE,_=this.iterator();_.hasNext();){var b=_.next().getLabel();b.isArea(l)&&b.getLocation(l,mn.LEFT)!==xe.NONE&&(d=b.getLocation(l,mn.LEFT))}if(d===xe.NONE)return null;for(var I=d,N=this.iterator();N.hasNext();){var j=N.next(),ne=j.getLabel();if(ne.getLocation(l,mn.ON)===xe.NONE&&ne.setLocation(l,mn.ON,I),ne.isArea(l)){var Ee=ne.getLocation(l,mn.LEFT),it=ne.getLocation(l,mn.RIGHT);if(it!==xe.NONE){if(it!==I)throw new ql("side location conflict",j.getCoordinate());Ee===xe.NONE&&ae.shouldNeverReachHere("found single null side (at "+j.getCoordinate()+")"),I=Ee}else ae.isTrue(ne.getLocation(l,mn.LEFT)===xe.NONE,"found single null side"),ne.setLocation(l,mn.RIGHT,I),ne.setLocation(l,mn.LEFT,I)}}},Wr.prototype.getCoordinate=function(){var l=this.iterator();return l.hasNext()?l.next().getCoordinate():null},Wr.prototype.print=function(l){In.out.println("EdgeEndStar:   "+this.getCoordinate());for(var d=this.iterator();d.hasNext();)d.next().print(l)},Wr.prototype.isAreaLabelsConsistent=function(l){return this.computeEdgeEndLabels(l.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)},Wr.prototype.checkAreaLabelsConsistent=function(l){var d=this.getEdges();if(d.size()<=0)return!0;var _=d.size()-1,b=d.get(_).getLabel().getLocation(l,mn.LEFT);ae.isTrue(b!==xe.NONE,"Found unlabelled area edge");for(var I=b,N=this.iterator();N.hasNext();){var j=N.next().getLabel();ae.isTrue(j.isArea(l),"Found non-area edge");var ne=j.getLocation(l,mn.LEFT),Ee=j.getLocation(l,mn.RIGHT);if(ne===Ee||Ee!==I)return!1;I=ne}return!0},Wr.prototype.findIndex=function(l){this.iterator();for(var d=0;d<this._edgeList.size();d++)if(this._edgeList.get(d)===l)return d;return-1},Wr.prototype.iterator=function(){return this.getEdges().iterator()},Wr.prototype.getEdges=function(){return null===this._edgeList&&(this._edgeList=new ln(this._edgeMap.values())),this._edgeList},Wr.prototype.getLocation=function(l,d,_){return this._ptInAreaLocation[l]===xe.NONE&&(this._ptInAreaLocation[l]=Dr.locate(d,_[l].getGeometry())),this._ptInAreaLocation[l]},Wr.prototype.toString=function(){var l=new Pe;l.append("EdgeEndStar:   "+this.getCoordinate()),l.append("\n");for(var d=this.iterator();d.hasNext();){var _=d.next();l.append(_),l.append("\n")}return l.toString()},Wr.prototype.computeEdgeEndLabels=function(l){for(var d=this.iterator();d.hasNext();)d.next().computeLabel(l)},Wr.prototype.computeLabelling=function(l){this.computeEdgeEndLabels(l[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);for(var d=[!1,!1],_=this.iterator();_.hasNext();)for(var b=_.next().getLabel(),I=0;I<2;I++)b.isLine(I)&&b.getLocation(I)===xe.BOUNDARY&&(d[I]=!0);for(var N=this.iterator();N.hasNext();)for(var j=N.next(),ne=j.getLabel(),Ee=0;Ee<2;Ee++)if(ne.isAnyNull(Ee)){var it=xe.NONE;if(d[Ee])it=xe.EXTERIOR;else{var Bt=j.getCoordinate();it=this.getLocation(Ee,Bt,l)}ne.setAllLocationsIfNull(Ee,it)}},Wr.prototype.getDegree=function(){return this._edgeMap.size()},Wr.prototype.insertEdgeEnd=function(l,d){this._edgeMap.put(l,d),this._edgeList=null},Wr.prototype.interfaces_=function(){return[]},Wr.prototype.getClass=function(){return Wr};var El=function(l){function d(){l.call(this),this._resultAreaEdgeList=null,this._label=null,this._SCANNING_FOR_INCOMING=1,this._LINKING_TO_OUTGOING=2}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.linkResultDirectedEdges=function(){this.getResultAreaEdges();for(var _=null,b=null,I=this._SCANNING_FOR_INCOMING,N=0;N<this._resultAreaEdgeList.size();N++){var j=this._resultAreaEdgeList.get(N),ne=j.getSym();if(j.getLabel().isArea())switch(null===_&&j.isInResult()&&(_=j),I){case this._SCANNING_FOR_INCOMING:if(!ne.isInResult())continue;b=ne,I=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(!j.isInResult())continue;b.setNext(j),I=this._SCANNING_FOR_INCOMING}}if(I===this._LINKING_TO_OUTGOING){if(null===_)throw new ql("no outgoing dirEdge found",this.getCoordinate());ae.isTrue(_.isInResult(),"unable to link last incoming dirEdge"),b.setNext(_)}},d.prototype.insert=function(_){this.insertEdgeEnd(_,_)},d.prototype.getRightmostEdge=function(){var _=this.getEdges(),b=_.size();if(b<1)return null;var I=_.get(0);if(1===b)return I;var N=_.get(b-1),j=I.getQuadrant(),ne=N.getQuadrant();return Wi.isNorthern(j)&&Wi.isNorthern(ne)?I:Wi.isNorthern(j)||Wi.isNorthern(ne)?0!==I.getDy()?I:0!==N.getDy()?N:(ae.shouldNeverReachHere("found two horizontal edges incident on node"),null):N},d.prototype.print=function(_){In.out.println("DirectedEdgeStar: "+this.getCoordinate());for(var b=this.iterator();b.hasNext();){var I=b.next();_.print("out "),I.print(_),_.println(),_.print("in "),I.getSym().print(_),_.println()}},d.prototype.getResultAreaEdges=function(){if(null!==this._resultAreaEdgeList)return this._resultAreaEdgeList;this._resultAreaEdgeList=new ln;for(var _=this.iterator();_.hasNext();){var b=_.next();(b.isInResult()||b.getSym().isInResult())&&this._resultAreaEdgeList.add(b)}return this._resultAreaEdgeList},d.prototype.updateLabelling=function(_){for(var b=this.iterator();b.hasNext();){var I=b.next().getLabel();I.setAllLocationsIfNull(0,_.getLocation(0)),I.setAllLocationsIfNull(1,_.getLocation(1))}},d.prototype.linkAllDirectedEdges=function(){this.getEdges();for(var _=null,b=null,I=this._edgeList.size()-1;I>=0;I--){var N=this._edgeList.get(I),j=N.getSym();null===b&&(b=j),null!==_&&j.setNext(_),_=N}b.setNext(_)},d.prototype.computeDepths=function(){if(1===arguments.length){var _=arguments[0],b=this.findIndex(_),I=_.getDepth(mn.LEFT),N=_.getDepth(mn.RIGHT),j=this.computeDepths(b+1,this._edgeList.size(),I);if(this.computeDepths(0,b,j)!==N)throw new ql("depth mismatch at "+_.getCoordinate())}else if(3===arguments.length){for(var Ee=arguments[1],it=arguments[2],Bt=arguments[0];Bt<Ee;Bt++){var zt=this._edgeList.get(Bt);zt.setEdgeDepths(mn.RIGHT,it),it=zt.getDepth(mn.LEFT)}return it}},d.prototype.mergeSymLabels=function(){for(var _=this.iterator();_.hasNext();){var b=_.next();b.getLabel().merge(b.getSym().getLabel())}},d.prototype.linkMinimalDirectedEdges=function(_){for(var b=null,I=null,N=this._SCANNING_FOR_INCOMING,j=this._resultAreaEdgeList.size()-1;j>=0;j--){var ne=this._resultAreaEdgeList.get(j),Ee=ne.getSym();switch(null===b&&ne.getEdgeRing()===_&&(b=ne),N){case this._SCANNING_FOR_INCOMING:if(Ee.getEdgeRing()!==_)continue;I=Ee,N=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(ne.getEdgeRing()!==_)continue;I.setNextMin(ne),N=this._SCANNING_FOR_INCOMING}}N===this._LINKING_TO_OUTGOING&&(ae.isTrue(null!==b,"found null for first outgoing dirEdge"),ae.isTrue(b.getEdgeRing()===_,"unable to link last incoming dirEdge"),I.setNextMin(b))},d.prototype.getOutgoingDegree=function(){if(0===arguments.length){for(var _=0,b=this.iterator();b.hasNext();)b.next().isInResult()&&_++;return _}if(1===arguments.length){for(var I=arguments[0],N=0,j=this.iterator();j.hasNext();)j.next().getEdgeRing()===I&&N++;return N}},d.prototype.getLabel=function(){return this._label},d.prototype.findCoveredLineEdges=function(){for(var _=xe.NONE,b=this.iterator();b.hasNext();){var I=b.next(),N=I.getSym();if(!I.isLineEdge()){if(I.isInResult()){_=xe.INTERIOR;break}if(N.isInResult()){_=xe.EXTERIOR;break}}}if(_===xe.NONE)return null;for(var j=_,ne=this.iterator();ne.hasNext();){var Ee=ne.next(),it=Ee.getSym();Ee.isLineEdge()?Ee.getEdge().setCovered(j===xe.INTERIOR):(Ee.isInResult()&&(j=xe.EXTERIOR),it.isInResult()&&(j=xe.INTERIOR))}},d.prototype.computeLabelling=function(_){l.prototype.computeLabelling.call(this,_),this._label=new li(xe.NONE);for(var b=this.iterator();b.hasNext();)for(var I=b.next().getEdge().getLabel(),N=0;N<2;N++){var j=I.getLocation(N);j!==xe.INTERIOR&&j!==xe.BOUNDARY||this._label.setLocation(N,xe.INTERIOR)}},d.prototype.interfaces_=function(){return[]},d.prototype.getClass=function(){return d},d}(Wr),Cl=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.createNode=function(_){return new Xc(_,new El)},d.prototype.interfaces_=function(){return[]},d.prototype.getClass=function(){return d},d}(Yc),_o=function l(){this._pts=null,this._orientation=null;var d=arguments[0];this._pts=d,this._orientation=l.orientation(d)};_o.prototype.compareTo=function(l){return _o.compareOriented(this._pts,this._orientation,l._pts,l._orientation)},_o.prototype.interfaces_=function(){return[he]},_o.prototype.getClass=function(){return _o},_o.orientation=function(l){return 1===yr.increasingDirection(l)},_o.compareOriented=function(l,d,_,b){for(var I=d?1:-1,N=b?1:-1,j=d?l.length:-1,ne=b?_.length:-1,Ee=d?0:l.length-1,it=b?0:_.length-1;;){var Bt=l[Ee].compareTo(_[it]);if(0!==Bt)return Bt;var zt=(Ee+=I)===j,vn=(it+=N)===ne;if(zt&&!vn)return-1;if(!zt&&vn)return 1;if(zt&&vn)return 0}};var Zo=function(){this._edges=new ln,this._ocaMap=new kt};Zo.prototype.print=function(l){l.print("MULTILINESTRING ( ");for(var d=0;d<this._edges.size();d++){var _=this._edges.get(d);d>0&&l.print(","),l.print("(");for(var b=_.getCoordinates(),I=0;I<b.length;I++)I>0&&l.print(","),l.print(b[I].x+" "+b[I].y);l.println(")")}l.print(")  ")},Zo.prototype.addAll=function(l){for(var d=l.iterator();d.hasNext();)this.add(d.next())},Zo.prototype.findEdgeIndex=function(l){for(var d=0;d<this._edges.size();d++)if(this._edges.get(d).equals(l))return d;return-1},Zo.prototype.iterator=function(){return this._edges.iterator()},Zo.prototype.getEdges=function(){return this._edges},Zo.prototype.get=function(l){return this._edges.get(l)},Zo.prototype.findEqualEdge=function(l){var d=new _o(l.getCoordinates());return this._ocaMap.get(d)},Zo.prototype.add=function(l){this._edges.add(l);var d=new _o(l.getCoordinates());this._ocaMap.put(d,l)},Zo.prototype.interfaces_=function(){return[]},Zo.prototype.getClass=function(){return Zo};var yo=function(){};yo.prototype.processIntersections=function(l,d,_,b){},yo.prototype.isDone=function(){},yo.prototype.interfaces_=function(){return[]},yo.prototype.getClass=function(){return yo};var Us=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._hasInterior=!1,this._properIntersectionPoint=null,this._li=null,this._isSelfIntersection=null,this.numIntersections=0,this.numInteriorIntersections=0,this.numProperIntersections=0,this.numTests=0,this._li=arguments[0]};Us.prototype.isTrivialIntersection=function(l,d,_,b){if(l===_&&1===this._li.getIntersectionNum()){if(Us.isAdjacentSegments(d,b))return!0;if(l.isClosed()){var I=l.size()-1;if(0===d&&b===I||0===b&&d===I)return!0}}return!1},Us.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint},Us.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior},Us.prototype.getLineIntersector=function(){return this._li},Us.prototype.hasProperIntersection=function(){return this._hasProper},Us.prototype.processIntersections=function(l,d,_,b){if(l===_&&d===b)return null;this.numTests++;var I=l.getCoordinates()[d],N=l.getCoordinates()[d+1],j=_.getCoordinates()[b],ne=_.getCoordinates()[b+1];this._li.computeIntersection(I,N,j,ne),this._li.hasIntersection()&&(this.numIntersections++,this._li.isInteriorIntersection()&&(this.numInteriorIntersections++,this._hasInterior=!0),this.isTrivialIntersection(l,d,_,b)||(this._hasIntersection=!0,l.addIntersections(this._li,d,0),_.addIntersections(this._li,b,1),this._li.isProper()&&(this.numProperIntersections++,this._hasProper=!0,this._hasProperInterior=!0)))},Us.prototype.hasIntersection=function(){return this._hasIntersection},Us.prototype.isDone=function(){return!1},Us.prototype.hasInteriorIntersection=function(){return this._hasInterior},Us.prototype.interfaces_=function(){return[yo]},Us.prototype.getClass=function(){return Us},Us.isAdjacentSegments=function(l,d){return 1===Math.abs(l-d)};var na=function(){this.coord=null,this.segmentIndex=null,this.dist=null;var d=arguments[1],_=arguments[2];this.coord=new re(arguments[0]),this.segmentIndex=d,this.dist=_};na.prototype.getSegmentIndex=function(){return this.segmentIndex},na.prototype.getCoordinate=function(){return this.coord},na.prototype.print=function(l){l.print(this.coord),l.print(" seg # = "+this.segmentIndex),l.println(" dist = "+this.dist)},na.prototype.compareTo=function(l){return this.compare(l.segmentIndex,l.dist)},na.prototype.isEndPoint=function(l){return 0===this.segmentIndex&&0===this.dist||this.segmentIndex===l},na.prototype.toString=function(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist},na.prototype.getDistance=function(){return this.dist},na.prototype.compare=function(l,d){return this.segmentIndex<l?-1:this.segmentIndex>l?1:this.dist<d?-1:this.dist>d?1:0},na.prototype.interfaces_=function(){return[he]},na.prototype.getClass=function(){return na};var dr=function(){this._nodeMap=new kt,this.edge=null,this.edge=arguments[0]};dr.prototype.print=function(l){l.println("Intersections:");for(var d=this.iterator();d.hasNext();)d.next().print(l)},dr.prototype.iterator=function(){return this._nodeMap.values().iterator()},dr.prototype.addSplitEdges=function(l){this.addEndpoints();for(var d=this.iterator(),_=d.next();d.hasNext();){var b=d.next(),I=this.createSplitEdge(_,b);l.add(I),_=b}},dr.prototype.addEndpoints=function(){var l=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[l],l,0)},dr.prototype.createSplitEdge=function(l,d){var _=d.segmentIndex-l.segmentIndex+2,I=d.dist>0||!d.coord.equals2D(this.edge.pts[d.segmentIndex]);I||_--;var N=new Array(_).fill(null),j=0;N[j++]=new re(l.coord);for(var ne=l.segmentIndex+1;ne<=d.segmentIndex;ne++)N[j++]=this.edge.pts[ne];return I&&(N[j]=d.coord),new ra(N,new li(this.edge._label))},dr.prototype.add=function(l,d,_){var b=new na(l,d,_),I=this._nodeMap.get(b);return null!==I?I:(this._nodeMap.put(b,b),b)},dr.prototype.isIntersection=function(l){for(var d=this.iterator();d.hasNext();)if(d.next().coord.equals(l))return!0;return!1},dr.prototype.interfaces_=function(){return[]},dr.prototype.getClass=function(){return dr};var Sl=function(){};Sl.prototype.getChainStartIndices=function(l){var d=0,_=new ln;_.add(new lt(d));do{var b=this.findChainEnd(l,d);_.add(new lt(b)),d=b}while(d<l.length-1);return Sl.toIntArray(_)},Sl.prototype.findChainEnd=function(l,d){for(var _=Wi.quadrant(l[d],l[d+1]),b=d+1;b<l.length&&Wi.quadrant(l[b-1],l[b])===_;)b++;return b-1},Sl.prototype.interfaces_=function(){return[]},Sl.prototype.getClass=function(){return Sl},Sl.toIntArray=function(l){for(var d=new Array(l.size()).fill(null),_=0;_<d.length;_++)d[_]=l.get(_).intValue();return d};var Is=function(){this.e=null,this.pts=null,this.startIndex=null,this.env1=new rn,this.env2=new rn;var l=arguments[0];this.e=l,this.pts=l.getCoordinates();var d=new Sl;this.startIndex=d.getChainStartIndices(this.pts)};Is.prototype.getCoordinates=function(){return this.pts},Is.prototype.getMaxX=function(l){var d=this.pts[this.startIndex[l]].x,_=this.pts[this.startIndex[l+1]].x;return d>_?d:_},Is.prototype.getMinX=function(l){var d=this.pts[this.startIndex[l]].x,_=this.pts[this.startIndex[l+1]].x;return d<_?d:_},Is.prototype.computeIntersectsForChain=function(){if(4===arguments.length){var l=arguments[0],d=arguments[1],_=arguments[2];this.computeIntersectsForChain(this.startIndex[l],this.startIndex[l+1],d,d.startIndex[_],d.startIndex[_+1],arguments[3])}else if(6===arguments.length){var I=arguments[0],N=arguments[1],j=arguments[2],ne=arguments[3],Ee=arguments[4],it=arguments[5],Bt=this.pts[I],zt=this.pts[N],vn=j.pts[ne],pn=j.pts[Ee];if(N-I==1&&Ee-ne==1)return it.addIntersections(this.e,I,j.e,ne),null;if(this.env1.init(Bt,zt),this.env2.init(vn,pn),!this.env1.intersects(this.env2))return null;var Pn=Math.trunc((I+N)/2),rr=Math.trunc((ne+Ee)/2);I<Pn&&(ne<rr&&this.computeIntersectsForChain(I,Pn,j,ne,rr,it),rr<Ee&&this.computeIntersectsForChain(I,Pn,j,rr,Ee,it)),Pn<N&&(ne<rr&&this.computeIntersectsForChain(Pn,N,j,ne,rr,it),rr<Ee&&this.computeIntersectsForChain(Pn,N,j,rr,Ee,it))}},Is.prototype.getStartIndexes=function(){return this.startIndex},Is.prototype.computeIntersects=function(l,d){for(var _=0;_<this.startIndex.length-1;_++)for(var b=0;b<l.startIndex.length-1;b++)this.computeIntersectsForChain(_,l,b,d)},Is.prototype.interfaces_=function(){return[]},Is.prototype.getClass=function(){return Is};var vo=function l(){this._depth=Array(2).fill().map(function(){return Array(3)});for(var d=0;d<2;d++)for(var _=0;_<3;_++)this._depth[d][_]=l.NULL_VALUE},mc={NULL_VALUE:{configurable:!0}};vo.prototype.getDepth=function(l,d){return this._depth[l][d]},vo.prototype.setDepth=function(l,d,_){this._depth[l][d]=_},vo.prototype.isNull=function(){if(0===arguments.length){for(var l=0;l<2;l++)for(var d=0;d<3;d++)if(this._depth[l][d]!==vo.NULL_VALUE)return!1;return!0}return 1===arguments.length?this._depth[arguments[0]][1]===vo.NULL_VALUE:2===arguments.length?this._depth[arguments[0]][arguments[1]]===vo.NULL_VALUE:void 0},vo.prototype.normalize=function(){for(var l=0;l<2;l++)if(!this.isNull(l)){var d=this._depth[l][1];this._depth[l][2]<d&&(d=this._depth[l][2]),d<0&&(d=0);for(var _=1;_<3;_++){var b=0;this._depth[l][_]>d&&(b=1),this._depth[l][_]=b}}},vo.prototype.getDelta=function(l){return this._depth[l][mn.RIGHT]-this._depth[l][mn.LEFT]},vo.prototype.getLocation=function(l,d){return this._depth[l][d]<=0?xe.EXTERIOR:xe.INTERIOR},vo.prototype.toString=function(){return"A: "+this._depth[0][1]+","+this._depth[0][2]+" B: "+this._depth[1][1]+","+this._depth[1][2]},vo.prototype.add=function(){if(1===arguments.length)for(var l=arguments[0],d=0;d<2;d++)for(var _=1;_<3;_++){var b=l.getLocation(d,_);b!==xe.EXTERIOR&&b!==xe.INTERIOR||(this.isNull(d,_)?this._depth[d][_]=vo.depthAtLocation(b):this._depth[d][_]+=vo.depthAtLocation(b))}else 3===arguments.length&&arguments[2]===xe.INTERIOR&&this._depth[arguments[0]][arguments[1]]++},vo.prototype.interfaces_=function(){return[]},vo.prototype.getClass=function(){return vo},vo.depthAtLocation=function(l){return l===xe.EXTERIOR?0:l===xe.INTERIOR?1:vo.NULL_VALUE},mc.NULL_VALUE.get=function(){return-1},Object.defineProperties(vo,mc);var ra=function(l){function d(){if(l.call(this),this.pts=null,this._env=null,this.eiList=new dr(this),this._name=null,this._mce=null,this._isIsolated=!0,this._depth=new vo,this._depthDelta=0,1===arguments.length)d.call(this,arguments[0],null);else if(2===arguments.length){var I=arguments[1];this.pts=arguments[0],this._label=I}}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.getDepth=function(){return this._depth},d.prototype.getCollapsedEdge=function(){var _=new Array(2).fill(null);return _[0]=this.pts[0],_[1]=this.pts[1],new d(_,li.toLineLabel(this._label))},d.prototype.isIsolated=function(){return this._isIsolated},d.prototype.getCoordinates=function(){return this.pts},d.prototype.setIsolated=function(_){this._isIsolated=_},d.prototype.setName=function(_){this._name=_},d.prototype.equals=function(_){if(!(_ instanceof d))return!1;var b=_;if(this.pts.length!==b.pts.length)return!1;for(var I=!0,N=!0,j=this.pts.length,ne=0;ne<this.pts.length;ne++)if(this.pts[ne].equals2D(b.pts[ne])||(I=!1),this.pts[ne].equals2D(b.pts[--j])||(N=!1),!I&&!N)return!1;return!0},d.prototype.getCoordinate=function(){return 0===arguments.length?this.pts.length>0?this.pts[0]:null:1===arguments.length?this.pts[arguments[0]]:void 0},d.prototype.print=function(_){_.print("edge "+this._name+": "),_.print("LINESTRING (");for(var b=0;b<this.pts.length;b++)b>0&&_.print(","),_.print(this.pts[b].x+" "+this.pts[b].y);_.print(")  "+this._label+" "+this._depthDelta)},d.prototype.computeIM=function(_){d.updateIM(this._label,_)},d.prototype.isCollapsed=function(){return!!this._label.isArea()&&3===this.pts.length&&!!this.pts[0].equals(this.pts[2])},d.prototype.isClosed=function(){return this.pts[0].equals(this.pts[this.pts.length-1])},d.prototype.getMaximumSegmentIndex=function(){return this.pts.length-1},d.prototype.getDepthDelta=function(){return this._depthDelta},d.prototype.getNumPoints=function(){return this.pts.length},d.prototype.printReverse=function(_){_.print("edge "+this._name+": ");for(var b=this.pts.length-1;b>=0;b--)_.print(this.pts[b]+" ");_.println("")},d.prototype.getMonotoneChainEdge=function(){return null===this._mce&&(this._mce=new Is(this)),this._mce},d.prototype.getEnvelope=function(){if(null===this._env){this._env=new rn;for(var _=0;_<this.pts.length;_++)this._env.expandToInclude(this.pts[_])}return this._env},d.prototype.addIntersection=function(_,b,I,N){var j=new re(_.getIntersection(N)),ne=b,Ee=_.getEdgeDistance(I,N),it=ne+1;it<this.pts.length&&j.equals2D(this.pts[it])&&(ne=it,Ee=0),this.eiList.add(j,ne,Ee)},d.prototype.toString=function(){var _=new Pe;_.append("edge "+this._name+": "),_.append("LINESTRING (");for(var b=0;b<this.pts.length;b++)b>0&&_.append(","),_.append(this.pts[b].x+" "+this.pts[b].y);return _.append(")  "+this._label+" "+this._depthDelta),_.toString()},d.prototype.isPointwiseEqual=function(_){if(this.pts.length!==_.pts.length)return!1;for(var b=0;b<this.pts.length;b++)if(!this.pts[b].equals2D(_.pts[b]))return!1;return!0},d.prototype.setDepthDelta=function(_){this._depthDelta=_},d.prototype.getEdgeIntersectionList=function(){return this.eiList},d.prototype.addIntersections=function(_,b,I){for(var N=0;N<_.getIntersectionNum();N++)this.addIntersection(_,b,I,N)},d.prototype.interfaces_=function(){return[]},d.prototype.getClass=function(){return d},d.updateIM=function(){if(2!==arguments.length)return l.prototype.updateIM.apply(this,arguments);var _=arguments[0],b=arguments[1];b.setAtLeastIfValid(_.getLocation(0,mn.ON),_.getLocation(1,mn.ON),1),_.isArea()&&(b.setAtLeastIfValid(_.getLocation(0,mn.LEFT),_.getLocation(1,mn.LEFT),2),b.setAtLeastIfValid(_.getLocation(0,mn.RIGHT),_.getLocation(1,mn.RIGHT),2))},d}(Va),br=function(l){this._workingPrecisionModel=null,this._workingNoder=null,this._geomFact=null,this._graph=null,this._edgeList=new Zo,this._bufParams=l||null};br.prototype.setWorkingPrecisionModel=function(l){this._workingPrecisionModel=l},br.prototype.insertUniqueEdge=function(l){var d=this._edgeList.findEqualEdge(l);if(null!==d){var _=d.getLabel(),b=l.getLabel();d.isPointwiseEqual(l)||(b=new li(l.getLabel())).flip(),_.merge(b);var I=br.depthDelta(b),N=d.getDepthDelta()+I;d.setDepthDelta(N)}else this._edgeList.add(l),l.setDepthDelta(br.depthDelta(l.getLabel()))},br.prototype.buildSubgraphs=function(l,d){for(var _=new ln,b=l.iterator();b.hasNext();){var I=b.next(),N=I.getRightmostCoordinate(),j=new Yo(_).getDepth(N);I.computeDepth(j),I.findResultEdges(),_.add(I),d.add(I.getDirectedEdges(),I.getNodes())}},br.prototype.createSubgraphs=function(l){for(var d=new ln,_=l.getNodes().iterator();_.hasNext();){var b=_.next();if(!b.isVisited()){var I=new os;I.create(b),d.add(I)}}return ss.sort(d,ss.reverseOrder()),d},br.prototype.createEmptyResultGeometry=function(){return this._geomFact.createPolygon()},br.prototype.getNoder=function(l){if(null!==this._workingNoder)return this._workingNoder;var d=new Xl,_=new Ot;return _.setPrecisionModel(l),d.setSegmentIntersector(new Us(_)),d},br.prototype.buffer=function(l,d){var _=this._workingPrecisionModel;null===_&&(_=l.getPrecisionModel()),this._geomFact=l.getFactory();var b=new Yi(_,this._bufParams),I=new Ja(l,d,b).getCurves();if(I.size()<=0)return this.createEmptyResultGeometry();this.computeNodedEdges(I,_),this._graph=new Do(new Cl),this._graph.addEdges(this._edgeList.getEdges());var N=this.createSubgraphs(this._graph),j=new Ca(this._geomFact);this.buildSubgraphs(N,j);var ne=j.getPolygons();return ne.size()<=0?this.createEmptyResultGeometry():this._geomFact.buildGeometry(ne)},br.prototype.computeNodedEdges=function(l,d){var _=this.getNoder(d);_.computeNodes(l);for(var b=_.getNodedSubstrings().iterator();b.hasNext();){var I=b.next(),N=I.getCoordinates();if(2!==N.length||!N[0].equals2D(N[1])){var j=I.getData(),ne=new ra(I.getCoordinates(),new li(j));this.insertUniqueEdge(ne)}}},br.prototype.setNoder=function(l){this._workingNoder=l},br.prototype.interfaces_=function(){return[]},br.prototype.getClass=function(){return br},br.depthDelta=function(l){var d=l.getLocation(0,mn.LEFT),_=l.getLocation(0,mn.RIGHT);return d===xe.INTERIOR&&_===xe.EXTERIOR?1:d===xe.EXTERIOR&&_===xe.INTERIOR?-1:0},br.convertSegStrings=function(l){for(var d=new fr,_=new ln;l.hasNext();){var b=l.next(),I=d.createLineString(b.getCoordinates());_.add(I)}return d.buildGeometry(_)};var Ta=function(){if(this._noder=null,this._scaleFactor=null,this._offsetX=null,this._offsetY=null,this._isScaled=!1,2===arguments.length){var d=arguments[1];this._noder=arguments[0],this._scaleFactor=d,this._offsetX=0,this._offsetY=0,this._isScaled=!this.isIntegerPrecision()}else if(4===arguments.length){var b=arguments[1],I=arguments[2],N=arguments[3];this._noder=arguments[0],this._scaleFactor=b,this._offsetX=I,this._offsetY=N,this._isScaled=!this.isIntegerPrecision()}};Ta.prototype.rescale=function(){if(Lt(arguments[0],qi))for(var l=arguments[0].iterator();l.hasNext();){var d=l.next();this.rescale(d.getCoordinates())}else if(arguments[0]instanceof Array){for(var _=arguments[0],b=0;b<_.length;b++)_[b].x=_[b].x/this._scaleFactor+this._offsetX,_[b].y=_[b].y/this._scaleFactor+this._offsetY;2===_.length&&_[0].equals2D(_[1])&&In.out.println(_)}},Ta.prototype.scale=function(){if(Lt(arguments[0],qi)){for(var l=arguments[0],d=new ln,_=l.iterator();_.hasNext();){var b=_.next();d.add(new as(this.scale(b.getCoordinates()),b.getData()))}return d}if(arguments[0]instanceof Array){for(var I=arguments[0],N=new Array(I.length).fill(null),j=0;j<I.length;j++)N[j]=new re(Math.round((I[j].x-this._offsetX)*this._scaleFactor),Math.round((I[j].y-this._offsetY)*this._scaleFactor),I[j].z);return yr.removeRepeatedPoints(N)}},Ta.prototype.isIntegerPrecision=function(){return 1===this._scaleFactor},Ta.prototype.getNodedSubstrings=function(){var l=this._noder.getNodedSubstrings();return this._isScaled&&this.rescale(l),l},Ta.prototype.computeNodes=function(l){var d=l;this._isScaled&&(d=this.scale(l)),this._noder.computeNodes(d)},Ta.prototype.interfaces_=function(){return[lu]},Ta.prototype.getClass=function(){return Ta};var ws=function(){this._li=new Ot,this._segStrings=null,this._segStrings=arguments[0]},Io={fact:{configurable:!0}};ws.prototype.checkEndPtVertexIntersections=function(){if(0===arguments.length)for(var l=this._segStrings.iterator();l.hasNext();){var d=l.next().getCoordinates();this.checkEndPtVertexIntersections(d[0],this._segStrings),this.checkEndPtVertexIntersections(d[d.length-1],this._segStrings)}else if(2===arguments.length)for(var _=arguments[0],b=arguments[1].iterator();b.hasNext();)for(var I=b.next().getCoordinates(),N=1;N<I.length-1;N++)if(I[N].equals(_))throw new ve("found endpt/interior pt intersection at index "+N+" :pt "+_)},ws.prototype.checkInteriorIntersections=function(){if(0===arguments.length)for(var l=this._segStrings.iterator();l.hasNext();)for(var d=l.next(),_=this._segStrings.iterator();_.hasNext();){var b=_.next();this.checkInteriorIntersections(d,b)}else if(2===arguments.length)for(var I=arguments[0],N=arguments[1],j=I.getCoordinates(),ne=N.getCoordinates(),Ee=0;Ee<j.length-1;Ee++)for(var it=0;it<ne.length-1;it++)this.checkInteriorIntersections(I,Ee,N,it);else if(4===arguments.length){var Bt=arguments[0],zt=arguments[1],vn=arguments[2],pn=arguments[3];if(Bt===vn&&zt===pn)return null;var Pn=Bt.getCoordinates()[zt],rr=Bt.getCoordinates()[zt+1],C=vn.getCoordinates()[pn],c=vn.getCoordinates()[pn+1];if(this._li.computeIntersection(Pn,rr,C,c),this._li.hasIntersection()&&(this._li.isProper()||this.hasInteriorIntersection(this._li,Pn,rr)||this.hasInteriorIntersection(this._li,C,c)))throw new ve("found non-noded intersection at "+Pn+"-"+rr+" and "+C+"-"+c)}},ws.prototype.checkValid=function(){this.checkEndPtVertexIntersections(),this.checkInteriorIntersections(),this.checkCollapses()},ws.prototype.checkCollapses=function(){if(0===arguments.length)for(var l=this._segStrings.iterator();l.hasNext();){var d=l.next();this.checkCollapses(d)}else if(1===arguments.length)for(var _=arguments[0].getCoordinates(),b=0;b<_.length-2;b++)this.checkCollapse(_[b],_[b+1],_[b+2])},ws.prototype.hasInteriorIntersection=function(l,d,_){for(var b=0;b<l.getIntersectionNum();b++){var I=l.getIntersection(b);if(!I.equals(d)&&!I.equals(_))return!0}return!1},ws.prototype.checkCollapse=function(l,d,_){if(l.equals(_))throw new ve("found non-noded collapse at "+ws.fact.createLineString([l,d,_]))},ws.prototype.interfaces_=function(){return[]},ws.prototype.getClass=function(){return ws},Io.fact.get=function(){return new fr},Object.defineProperties(ws,Io);var Es=function(){this._li=null,this._pt=null,this._originalPt=null,this._ptScaled=null,this._p0Scaled=null,this._p1Scaled=null,this._scaleFactor=null,this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,this._corner=new Array(4).fill(null),this._safeEnv=null;var l=arguments[0],d=arguments[1],_=arguments[2];if(this._originalPt=l,this._pt=l,this._scaleFactor=d,this._li=_,d<=0)throw new pe("Scale factor must be non-zero");1!==d&&(this._pt=new re(this.scale(l.x),this.scale(l.y)),this._p0Scaled=new re,this._p1Scaled=new re),this.initCorners(this._pt)},Wd={SAFE_ENV_EXPANSION_FACTOR:{configurable:!0}};Es.prototype.intersectsScaled=function(l,d){var _=Math.min(l.x,d.x),b=Math.max(l.x,d.x),I=Math.min(l.y,d.y),N=Math.max(l.y,d.y),j=this._maxx<_||this._minx>b||this._maxy<I||this._miny>N;if(j)return!1;var ne=this.intersectsToleranceSquare(l,d);return ae.isTrue(!(j&&ne),"Found bad envelope test"),ne},Es.prototype.initCorners=function(l){this._minx=l.x-.5,this._maxx=l.x+.5,this._miny=l.y-.5,this._maxy=l.y+.5,this._corner[0]=new re(this._maxx,this._maxy),this._corner[1]=new re(this._minx,this._maxy),this._corner[2]=new re(this._minx,this._miny),this._corner[3]=new re(this._maxx,this._miny)},Es.prototype.intersects=function(l,d){return 1===this._scaleFactor?this.intersectsScaled(l,d):(this.copyScaled(l,this._p0Scaled),this.copyScaled(d,this._p1Scaled),this.intersectsScaled(this._p0Scaled,this._p1Scaled))},Es.prototype.scale=function(l){return Math.round(l*this._scaleFactor)},Es.prototype.getCoordinate=function(){return this._originalPt},Es.prototype.copyScaled=function(l,d){d.x=this.scale(l.x),d.y=this.scale(l.y)},Es.prototype.getSafeEnvelope=function(){if(null===this._safeEnv){var l=Es.SAFE_ENV_EXPANSION_FACTOR/this._scaleFactor;this._safeEnv=new rn(this._originalPt.x-l,this._originalPt.x+l,this._originalPt.y-l,this._originalPt.y+l)}return this._safeEnv},Es.prototype.intersectsPixelClosure=function(l,d){return this._li.computeIntersection(l,d,this._corner[0],this._corner[1]),!!(this._li.hasIntersection()||(this._li.computeIntersection(l,d,this._corner[1],this._corner[2]),this._li.hasIntersection()||(this._li.computeIntersection(l,d,this._corner[2],this._corner[3]),this._li.hasIntersection()||(this._li.computeIntersection(l,d,this._corner[3],this._corner[0]),this._li.hasIntersection()))))},Es.prototype.intersectsToleranceSquare=function(l,d){var _=!1,b=!1;return this._li.computeIntersection(l,d,this._corner[0],this._corner[1]),!!(this._li.isProper()||(this._li.computeIntersection(l,d,this._corner[1],this._corner[2]),this._li.isProper()||(this._li.hasIntersection()&&(_=!0),this._li.computeIntersection(l,d,this._corner[2],this._corner[3]),this._li.isProper()||(this._li.hasIntersection()&&(b=!0),this._li.computeIntersection(l,d,this._corner[3],this._corner[0]),this._li.isProper()||_&&b||l.equals(this._pt)||d.equals(this._pt)))))},Es.prototype.addSnappedNode=function(l,d){var _=l.getCoordinate(d),b=l.getCoordinate(d+1);return!!this.intersects(_,b)&&(l.addIntersection(this.getCoordinate(),d),!0)},Es.prototype.interfaces_=function(){return[]},Es.prototype.getClass=function(){return Es},Wd.SAFE_ENV_EXPANSION_FACTOR.get=function(){return.75},Object.defineProperties(Es,Wd);var du=function(){this.tempEnv1=new rn,this.selectedSegment=new Yn};du.prototype.select=function(){1!==arguments.length&&2===arguments.length&&(arguments[0].getLineSegment(arguments[1],this.selectedSegment),this.select(this.selectedSegment))},du.prototype.interfaces_=function(){return[]},du.prototype.getClass=function(){return du};var Hu=function(){this._index=null,this._index=arguments[0]},Qc={HotPixelSnapAction:{configurable:!0}};Hu.prototype.snap=function(){if(1===arguments.length)return this.snap(arguments[0],null,-1);if(3===arguments.length){var d=arguments[0],_=arguments[1],b=arguments[2],I=d.getSafeEnvelope(),N=new Pc(d,_,b);return this._index.query(I,{interfaces_:function(){return[wl]},visitItem:function(j){j.select(I,N)}}),N.isNodeAdded()}},Hu.prototype.interfaces_=function(){return[]},Hu.prototype.getClass=function(){return Hu},Qc.HotPixelSnapAction.get=function(){return Pc},Object.defineProperties(Hu,Qc);var Pc=function(l){function d(){l.call(this),this._hotPixel=null,this._parentEdge=null,this._hotPixelVertexIndex=null,this._isNodeAdded=!1;var b=arguments[1],I=arguments[2];this._hotPixel=arguments[0],this._parentEdge=b,this._hotPixelVertexIndex=I}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.isNodeAdded=function(){return this._isNodeAdded},d.prototype.select=function(){if(2!==arguments.length)return l.prototype.select.apply(this,arguments);var b=arguments[1],I=arguments[0].getContext();if(null!==this._parentEdge&&I===this._parentEdge&&b===this._hotPixelVertexIndex)return null;this._isNodeAdded=this._hotPixel.addSnappedNode(I,b)},d.prototype.interfaces_=function(){return[]},d.prototype.getClass=function(){return d},d}(du),ds=function(){this._li=null,this._interiorIntersections=null,this._li=arguments[0],this._interiorIntersections=new ln};ds.prototype.processIntersections=function(l,d,_,b){if(l===_&&d===b)return null;var I=l.getCoordinates()[d],N=l.getCoordinates()[d+1],j=_.getCoordinates()[b],ne=_.getCoordinates()[b+1];if(this._li.computeIntersection(I,N,j,ne),this._li.hasIntersection()&&this._li.isInteriorIntersection()){for(var Ee=0;Ee<this._li.getIntersectionNum();Ee++)this._interiorIntersections.add(this._li.getIntersection(Ee));l.addIntersections(this._li,d,0),_.addIntersections(this._li,b,1)}},ds.prototype.isDone=function(){return!1},ds.prototype.getInteriorIntersections=function(){return this._interiorIntersections},ds.prototype.interfaces_=function(){return[yo]},ds.prototype.getClass=function(){return ds};var lo=function(){this._pm=null,this._li=null,this._scaleFactor=null,this._noder=null,this._pointSnapper=null,this._nodedSegStrings=null;var l=arguments[0];this._pm=l,this._li=new Ot,this._li.setPrecisionModel(l),this._scaleFactor=l.getScale()};lo.prototype.checkCorrectness=function(l){var d=as.getNodedSubstrings(l),_=new ws(d);try{_.checkValid()}catch(b){if(!(b instanceof hr))throw b;b.printStackTrace()}},lo.prototype.getNodedSubstrings=function(){return as.getNodedSubstrings(this._nodedSegStrings)},lo.prototype.snapRound=function(l,d){var _=this.findInteriorIntersections(l,d);this.computeIntersectionSnaps(_),this.computeVertexSnaps(l)},lo.prototype.findInteriorIntersections=function(l,d){var _=new ds(d);return this._noder.setSegmentIntersector(_),this._noder.computeNodes(l),_.getInteriorIntersections()},lo.prototype.computeVertexSnaps=function(){if(Lt(arguments[0],qi))for(var l=arguments[0].iterator();l.hasNext();){var d=l.next();this.computeVertexSnaps(d)}else if(arguments[0]instanceof as)for(var _=arguments[0],b=_.getCoordinates(),I=0;I<b.length;I++){var N=new Es(b[I],this._scaleFactor,this._li);this._pointSnapper.snap(N,_,I)&&_.addIntersection(b[I],I)}},lo.prototype.computeNodes=function(l){this._nodedSegStrings=l,this._noder=new Xl,this._pointSnapper=new Hu(this._noder.getIndex()),this.snapRound(l,this._li)},lo.prototype.computeIntersectionSnaps=function(l){for(var d=l.iterator();d.hasNext();){var _=d.next(),b=new Es(_,this._scaleFactor,this._li);this._pointSnapper.snap(b)}},lo.prototype.interfaces_=function(){return[lu]},lo.prototype.getClass=function(){return lo};var Oo=function(){if(this._argGeom=null,this._distance=null,this._bufParams=new Yr,this._resultGeometry=null,this._saveException=null,1===arguments.length)this._argGeom=arguments[0];else if(2===arguments.length){var _=arguments[1];this._argGeom=arguments[0],this._bufParams=_}},ga={CAP_ROUND:{configurable:!0},CAP_BUTT:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},MAX_PRECISION_DIGITS:{configurable:!0}};Oo.prototype.bufferFixedPrecision=function(l){var d=new Ta(new lo(new Or(1)),l.getScale()),_=new br(this._bufParams);_.setWorkingPrecisionModel(l),_.setNoder(d),this._resultGeometry=_.buffer(this._argGeom,this._distance)},Oo.prototype.bufferReducedPrecision=function(){var l=this;if(0===arguments.length){for(var d=Oo.MAX_PRECISION_DIGITS;d>=0;d--){try{l.bufferReducedPrecision(d)}catch(N){if(!(N instanceof ql))throw N;l._saveException=N}if(null!==l._resultGeometry)return null}throw this._saveException}if(1===arguments.length){var b=Oo.precisionScaleFactor(this._argGeom,this._distance,arguments[0]),I=new Or(b);this.bufferFixedPrecision(I)}},Oo.prototype.computeGeometry=function(){if(this.bufferOriginalPrecision(),null!==this._resultGeometry)return null;var l=this._argGeom.getFactory().getPrecisionModel();l.getType()===Or.FIXED?this.bufferFixedPrecision(l):this.bufferReducedPrecision()},Oo.prototype.setQuadrantSegments=function(l){this._bufParams.setQuadrantSegments(l)},Oo.prototype.bufferOriginalPrecision=function(){try{var l=new br(this._bufParams);this._resultGeometry=l.buffer(this._argGeom,this._distance)}catch(d){if(!(d instanceof ve))throw d;this._saveException=d}},Oo.prototype.getResultGeometry=function(l){return this._distance=l,this.computeGeometry(),this._resultGeometry},Oo.prototype.setEndCapStyle=function(l){this._bufParams.setEndCapStyle(l)},Oo.prototype.interfaces_=function(){return[]},Oo.prototype.getClass=function(){return Oo},Oo.bufferOp=function(){if(2===arguments.length){var d=arguments[1];return new Oo(arguments[0]).getResultGeometry(d)}if(3===arguments.length){if(Number.isInteger(arguments[2])&&arguments[0]instanceof Qt&&"number"==typeof arguments[1]){var b=arguments[1],I=arguments[2],N=new Oo(arguments[0]);return N.setQuadrantSegments(I),N.getResultGeometry(b)}if(arguments[2]instanceof Yr&&arguments[0]instanceof Qt&&"number"==typeof arguments[1]){var ne=arguments[1];return new Oo(arguments[0],arguments[2]).getResultGeometry(ne)}}else if(4===arguments.length){var Bt=arguments[1],zt=arguments[2],vn=arguments[3],pn=new Oo(arguments[0]);return pn.setQuadrantSegments(zt),pn.setEndCapStyle(vn),pn.getResultGeometry(Bt)}},Oo.precisionScaleFactor=function(l,d,_){var b=l.getEnvelopeInternal(),I=Ce.max(Math.abs(b.getMaxX()),Math.abs(b.getMaxY()),Math.abs(b.getMinX()),Math.abs(b.getMinY()))+2*(d>0?d:0),N=_-Math.trunc(Math.log(I)/Math.log(10)+1);return Math.pow(10,N)},ga.CAP_ROUND.get=function(){return Yr.CAP_ROUND},ga.CAP_BUTT.get=function(){return Yr.CAP_FLAT},ga.CAP_FLAT.get=function(){return Yr.CAP_FLAT},ga.CAP_SQUARE.get=function(){return Yr.CAP_SQUARE},ga.MAX_PRECISION_DIGITS.get=function(){return 12},Object.defineProperties(Oo,ga);var xo=function(){this._pt=[new re,new re],this._distance=le.NaN,this._isNull=!0};xo.prototype.getCoordinates=function(){return this._pt},xo.prototype.getCoordinate=function(l){return this._pt[l]},xo.prototype.setMinimum=function(){if(1===arguments.length){var l=arguments[0];this.setMinimum(l._pt[0],l._pt[1])}else if(2===arguments.length){var d=arguments[0],_=arguments[1];if(this._isNull)return this.initialize(d,_),null;var b=d.distance(_);b<this._distance&&this.initialize(d,_,b)}},xo.prototype.initialize=function(){if(0===arguments.length)this._isNull=!0;else if(2===arguments.length){var l=arguments[0],d=arguments[1];this._pt[0].setCoordinate(l),this._pt[1].setCoordinate(d),this._distance=l.distance(d),this._isNull=!1}else if(3===arguments.length){var b=arguments[1],I=arguments[2];this._pt[0].setCoordinate(arguments[0]),this._pt[1].setCoordinate(b),this._distance=I,this._isNull=!1}},xo.prototype.getDistance=function(){return this._distance},xo.prototype.setMaximum=function(){if(1===arguments.length){var l=arguments[0];this.setMaximum(l._pt[0],l._pt[1])}else if(2===arguments.length){var d=arguments[0],_=arguments[1];if(this._isNull)return this.initialize(d,_),null;var b=d.distance(_);b>this._distance&&this.initialize(d,_,b)}},xo.prototype.interfaces_=function(){return[]},xo.prototype.getClass=function(){return xo};var ma=function(){};ma.prototype.interfaces_=function(){return[]},ma.prototype.getClass=function(){return ma},ma.computeDistance=function(){if(arguments[2]instanceof xo&&arguments[0]instanceof vr&&arguments[1]instanceof re)for(var d=arguments[1],_=arguments[2],b=arguments[0].getCoordinates(),I=new Yn,N=0;N<b.length-1;N++){I.setCoordinates(b[N],b[N+1]);var j=I.closestPoint(d);_.setMinimum(j,d)}else if(arguments[2]instanceof xo&&arguments[0]instanceof Xn&&arguments[1]instanceof re){var ne=arguments[0],Ee=arguments[1],it=arguments[2];ma.computeDistance(ne.getExteriorRing(),Ee,it);for(var Bt=0;Bt<ne.getNumInteriorRing();Bt++)ma.computeDistance(ne.getInteriorRingN(Bt),Ee,it)}else if(arguments[2]instanceof xo&&arguments[0]instanceof Qt&&arguments[1]instanceof re){var zt=arguments[0],vn=arguments[1],pn=arguments[2];if(zt instanceof vr)ma.computeDistance(zt,vn,pn);else if(zt instanceof Xn)ma.computeDistance(zt,vn,pn);else if(zt instanceof tt)for(var Pn=zt,rr=0;rr<Pn.getNumGeometries();rr++){var C=Pn.getGeometryN(rr);ma.computeDistance(C,vn,pn)}else pn.setMinimum(zt.getCoordinate(),vn)}else if(arguments[2]instanceof xo&&arguments[0]instanceof Yn&&arguments[1]instanceof re){var y=arguments[1],S=arguments[2],P=arguments[0].closestPoint(y);S.setMinimum(P,y)}};var _a=function(l){this._maxPtDist=new xo,this._inputGeom=l||null},Da={MaxPointDistanceFilter:{configurable:!0},MaxMidpointDistanceFilter:{configurable:!0}};_a.prototype.computeMaxMidpointDistance=function(l){var d=new fu(this._inputGeom);l.apply(d),this._maxPtDist.setMaximum(d.getMaxPointDistance())},_a.prototype.computeMaxVertexDistance=function(l){var d=new js(this._inputGeom);l.apply(d),this._maxPtDist.setMaximum(d.getMaxPointDistance())},_a.prototype.findDistance=function(l){return this.computeMaxVertexDistance(l),this.computeMaxMidpointDistance(l),this._maxPtDist.getDistance()},_a.prototype.getDistancePoints=function(){return this._maxPtDist},_a.prototype.interfaces_=function(){return[]},_a.prototype.getClass=function(){return _a},Da.MaxPointDistanceFilter.get=function(){return js},Da.MaxMidpointDistanceFilter.get=function(){return fu},Object.defineProperties(_a,Da);var js=function(l){this._maxPtDist=new xo,this._minPtDist=new xo,this._geom=l||null};js.prototype.filter=function(l){this._minPtDist.initialize(),ma.computeDistance(this._geom,l,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},js.prototype.getMaxPointDistance=function(){return this._maxPtDist},js.prototype.interfaces_=function(){return[Vr]},js.prototype.getClass=function(){return js};var fu=function(l){this._maxPtDist=new xo,this._minPtDist=new xo,this._geom=l||null};fu.prototype.filter=function(l,d){if(0===d)return null;var _=l.getCoordinate(d-1),b=l.getCoordinate(d),I=new re((_.x+b.x)/2,(_.y+b.y)/2);this._minPtDist.initialize(),ma.computeDistance(this._geom,I,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},fu.prototype.isDone=function(){return!1},fu.prototype.isGeometryChanged=function(){return!1},fu.prototype.getMaxPointDistance=function(){return this._maxPtDist},fu.prototype.interfaces_=function(){return[bn]},fu.prototype.getClass=function(){return fu};var Yl=function(l){this._comps=l||null};Yl.prototype.filter=function(l){l instanceof Xn&&this._comps.add(l)},Yl.prototype.interfaces_=function(){return[Wt]},Yl.prototype.getClass=function(){return Yl},Yl.getPolygons=function(){if(1===arguments.length)return Yl.getPolygons(arguments[0],new ln);if(2===arguments.length){var d=arguments[0],_=arguments[1];return d instanceof Xn?_.add(d):d instanceof tt&&d.apply(new Yl(_)),_}};var ko=function(){if(this._lines=null,this._isForcedToLineString=!1,1===arguments.length)this._lines=arguments[0];else if(2===arguments.length){var _=arguments[1];this._lines=arguments[0],this._isForcedToLineString=_}};ko.prototype.filter=function(l){if(this._isForcedToLineString&&l instanceof po){var d=l.getFactory().createLineString(l.getCoordinateSequence());return this._lines.add(d),null}l instanceof vr&&this._lines.add(l)},ko.prototype.setForceToLineString=function(l){this._isForcedToLineString=l},ko.prototype.interfaces_=function(){return[Er]},ko.prototype.getClass=function(){return ko},ko.getGeometry=function(){if(1===arguments.length){var l=arguments[0];return l.getFactory().buildGeometry(ko.getLines(l))}if(2===arguments.length){var d=arguments[0],_=arguments[1];return d.getFactory().buildGeometry(ko.getLines(d,_))}},ko.getLines=function(){if(1===arguments.length)return ko.getLines(arguments[0],!1);if(2===arguments.length){if(Lt(arguments[0],qi)&&Lt(arguments[1],qi)){for(var _=arguments[1],b=arguments[0].iterator();b.hasNext();){var I=b.next();ko.getLines(I,_)}return _}if(arguments[0]instanceof Qt&&"boolean"==typeof arguments[1]){var N=arguments[0],j=arguments[1],ne=new ln;return N.apply(new ko(ne,j)),ne}if(arguments[0]instanceof Qt&&Lt(arguments[1],qi)){var Ee=arguments[0],it=arguments[1];return Ee instanceof vr?it.add(Ee):Ee.apply(new ko(it)),it}}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&Lt(arguments[0],qi)&&Lt(arguments[1],qi)){for(var zt=arguments[1],vn=arguments[2],pn=arguments[0].iterator();pn.hasNext();){var Pn=pn.next();ko.getLines(Pn,zt,vn)}return zt}if("boolean"==typeof arguments[2]&&arguments[0]instanceof Qt&&Lt(arguments[1],qi)){var C=arguments[1];return arguments[0].apply(new ko(C,arguments[2])),C}}};var Ia=function(){if(this._boundaryRule=ei.OGC_SFS_BOUNDARY_RULE,this._isIn=null,this._numBoundaries=null,0!==arguments.length&&1===arguments.length){var l=arguments[0];if(null===l)throw new pe("Rule must be non-null");this._boundaryRule=l}};Ia.prototype.locateInternal=function(){if(arguments[0]instanceof re&&arguments[1]instanceof Xn){var l=arguments[0],d=arguments[1];if(d.isEmpty())return xe.EXTERIOR;var _=d.getExteriorRing(),b=this.locateInPolygonRing(l,_);if(b===xe.EXTERIOR)return xe.EXTERIOR;if(b===xe.BOUNDARY)return xe.BOUNDARY;for(var I=0;I<d.getNumInteriorRing();I++){var N=d.getInteriorRingN(I),j=this.locateInPolygonRing(l,N);if(j===xe.INTERIOR)return xe.EXTERIOR;if(j===xe.BOUNDARY)return xe.BOUNDARY}return xe.INTERIOR}if(arguments[0]instanceof re&&arguments[1]instanceof vr){var ne=arguments[0],Ee=arguments[1];if(!Ee.getEnvelopeInternal().intersects(ne))return xe.EXTERIOR;var it=Ee.getCoordinates();return Ee.isClosed()||!ne.equals(it[0])&&!ne.equals(it[it.length-1])?wt.isOnLine(ne,it)?xe.INTERIOR:xe.EXTERIOR:xe.BOUNDARY}if(arguments[0]instanceof re&&arguments[1]instanceof gn){var Bt=arguments[0];return arguments[1].getCoordinate().equals2D(Bt)?xe.INTERIOR:xe.EXTERIOR}},Ia.prototype.locateInPolygonRing=function(l,d){return d.getEnvelopeInternal().intersects(l)?wt.locatePointInRing(l,d.getCoordinates()):xe.EXTERIOR},Ia.prototype.intersects=function(l,d){return this.locate(l,d)!==xe.EXTERIOR},Ia.prototype.updateLocationInfo=function(l){l===xe.INTERIOR&&(this._isIn=!0),l===xe.BOUNDARY&&this._numBoundaries++},Ia.prototype.computeLocation=function(l,d){if(d instanceof gn&&this.updateLocationInfo(this.locateInternal(l,d)),d instanceof vr)this.updateLocationInfo(this.locateInternal(l,d));else if(d instanceof Xn)this.updateLocationInfo(this.locateInternal(l,d));else if(d instanceof Vt)for(var _=d,b=0;b<_.getNumGeometries();b++){var I=_.getGeometryN(b);this.updateLocationInfo(this.locateInternal(l,I))}else if(d instanceof Rn)for(var N=d,j=0;j<N.getNumGeometries();j++){var ne=N.getGeometryN(j);this.updateLocationInfo(this.locateInternal(l,ne))}else if(d instanceof tt)for(var Ee=new On(d);Ee.hasNext();){var it=Ee.next();it!==d&&this.computeLocation(l,it)}},Ia.prototype.locate=function(l,d){return d.isEmpty()?xe.EXTERIOR:d instanceof vr||d instanceof Xn?this.locateInternal(l,d):(this._isIn=!1,this._numBoundaries=0,this.computeLocation(l,d),this._boundaryRule.isInBoundary(this._numBoundaries)?xe.BOUNDARY:this._numBoundaries>0||this._isIn?xe.INTERIOR:xe.EXTERIOR)},Ia.prototype.interfaces_=function(){return[]},Ia.prototype.getClass=function(){return Ia};var As=function l(){if(this._component=null,this._segIndex=null,this._pt=null,2===arguments.length)l.call(this,arguments[0],l.INSIDE_AREA,arguments[1]);else if(3===arguments.length){var I=arguments[1],N=arguments[2];this._component=arguments[0],this._segIndex=I,this._pt=N}},Xd={INSIDE_AREA:{configurable:!0}};As.prototype.isInsideArea=function(){return this._segIndex===As.INSIDE_AREA},As.prototype.getCoordinate=function(){return this._pt},As.prototype.getGeometryComponent=function(){return this._component},As.prototype.getSegmentIndex=function(){return this._segIndex},As.prototype.interfaces_=function(){return[]},As.prototype.getClass=function(){return As},Xd.INSIDE_AREA.get=function(){return-1},Object.defineProperties(As,Xd);var Zl=function(l){this._pts=l||null};Zl.prototype.filter=function(l){l instanceof gn&&this._pts.add(l)},Zl.prototype.interfaces_=function(){return[Wt]},Zl.prototype.getClass=function(){return Zl},Zl.getPoints=function(){if(1===arguments.length){var l=arguments[0];return l instanceof gn?ss.singletonList(l):Zl.getPoints(l,new ln)}if(2===arguments.length){var d=arguments[0],_=arguments[1];return d instanceof gn?_.add(d):d instanceof tt&&d.apply(new Zl(_)),_}};var eh=function(){this._locations=null,this._locations=arguments[0]};eh.prototype.filter=function(l){(l instanceof gn||l instanceof vr||l instanceof Xn)&&this._locations.add(new As(l,0,l.getCoordinate()))},eh.prototype.interfaces_=function(){return[Wt]},eh.prototype.getClass=function(){return eh},eh.getLocations=function(l){var d=new ln;return l.apply(new eh(d)),d};var fs=function(){if(this._geom=null,this._terminateDistance=0,this._ptLocator=new Ia,this._minDistanceLocation=null,this._minDistance=le.MAX_VALUE,2===arguments.length)this._geom=[arguments[0],arguments[1]],this._terminateDistance=0;else if(3===arguments.length){var _=arguments[0],b=arguments[1],I=arguments[2];this._geom=new Array(2).fill(null),this._geom[0]=_,this._geom[1]=b,this._terminateDistance=I}};fs.prototype.computeContainmentDistance=function(){if(0===arguments.length){var l=new Array(2).fill(null);if(this.computeContainmentDistance(0,l),this._minDistance<=this._terminateDistance)return null;this.computeContainmentDistance(1,l)}else if(2===arguments.length){var d=arguments[0],_=arguments[1],b=1-d,I=Yl.getPolygons(this._geom[d]);if(I.size()>0){var N=eh.getLocations(this._geom[b]);if(this.computeContainmentDistance(N,I,_),this._minDistance<=this._terminateDistance)return this._minDistanceLocation[b]=_[0],this._minDistanceLocation[d]=_[1],null}}else if(3===arguments.length)if(arguments[2]instanceof Array&&Lt(arguments[0],fo)&&Lt(arguments[1],fo)){for(var j=arguments[0],ne=arguments[1],Ee=arguments[2],it=0;it<j.size();it++)for(var Bt=j.get(it),zt=0;zt<ne.size();zt++)if(this.computeContainmentDistance(Bt,ne.get(zt),Ee),this._minDistance<=this._terminateDistance)return null}else if(arguments[2]instanceof Array&&arguments[0]instanceof As&&arguments[1]instanceof Xn){var vn=arguments[0],pn=arguments[1],Pn=arguments[2],rr=vn.getCoordinate();if(xe.EXTERIOR!==this._ptLocator.locate(rr,pn))return this._minDistance=0,Pn[0]=vn,Pn[1]=new As(pn,rr),null}},fs.prototype.computeMinDistanceLinesPoints=function(l,d,_){for(var b=0;b<l.size();b++)for(var I=l.get(b),N=0;N<d.size();N++){var j=d.get(N);if(this.computeMinDistance(I,j,_),this._minDistance<=this._terminateDistance)return null}},fs.prototype.computeFacetDistance=function(){var l=new Array(2).fill(null),d=ko.getLines(this._geom[0]),_=ko.getLines(this._geom[1]),b=Zl.getPoints(this._geom[0]),I=Zl.getPoints(this._geom[1]);return this.computeMinDistanceLines(d,_,l),this.updateMinDistance(l,!1),this._minDistance<=this._terminateDistance?null:(l[0]=null,l[1]=null,this.computeMinDistanceLinesPoints(d,I,l),this.updateMinDistance(l,!1),this._minDistance<=this._terminateDistance?null:(l[0]=null,l[1]=null,this.computeMinDistanceLinesPoints(_,b,l),this.updateMinDistance(l,!0),this._minDistance<=this._terminateDistance?null:(l[0]=null,l[1]=null,this.computeMinDistancePoints(b,I,l),void this.updateMinDistance(l,!1))))},fs.prototype.nearestLocations=function(){return this.computeMinDistance(),this._minDistanceLocation},fs.prototype.updateMinDistance=function(l,d){if(null===l[0])return null;d?(this._minDistanceLocation[0]=l[1],this._minDistanceLocation[1]=l[0]):(this._minDistanceLocation[0]=l[0],this._minDistanceLocation[1]=l[1])},fs.prototype.nearestPoints=function(){return this.computeMinDistance(),[this._minDistanceLocation[0].getCoordinate(),this._minDistanceLocation[1].getCoordinate()]},fs.prototype.computeMinDistance=function(){if(0===arguments.length){if(null!==this._minDistanceLocation||(this._minDistanceLocation=new Array(2).fill(null),this.computeContainmentDistance(),this._minDistance<=this._terminateDistance))return null;this.computeFacetDistance()}else if(3===arguments.length)if(arguments[2]instanceof Array&&arguments[0]instanceof vr&&arguments[1]instanceof gn){var l=arguments[0],d=arguments[1],_=arguments[2];if(l.getEnvelopeInternal().distance(d.getEnvelopeInternal())>this._minDistance)return null;for(var b=l.getCoordinates(),I=d.getCoordinate(),N=0;N<b.length-1;N++){var j=wt.distancePointLine(I,b[N],b[N+1]);if(j<this._minDistance){this._minDistance=j;var ne=new Yn(b[N],b[N+1]).closestPoint(I);_[0]=new As(l,N,ne),_[1]=new As(d,0,I)}if(this._minDistance<=this._terminateDistance)return null}}else if(arguments[2]instanceof Array&&arguments[0]instanceof vr&&arguments[1]instanceof vr){var Ee=arguments[0],it=arguments[1],Bt=arguments[2];if(Ee.getEnvelopeInternal().distance(it.getEnvelopeInternal())>this._minDistance)return null;for(var zt=Ee.getCoordinates(),vn=it.getCoordinates(),pn=0;pn<zt.length-1;pn++)for(var Pn=0;Pn<vn.length-1;Pn++){var rr=wt.distanceLineLine(zt[pn],zt[pn+1],vn[Pn],vn[Pn+1]);if(rr<this._minDistance){this._minDistance=rr;var C=new Yn(zt[pn],zt[pn+1]),c=new Yn(vn[Pn],vn[Pn+1]),y=C.closestPoints(c);Bt[0]=new As(Ee,pn,y[0]),Bt[1]=new As(it,Pn,y[1])}if(this._minDistance<=this._terminateDistance)return null}}},fs.prototype.computeMinDistancePoints=function(l,d,_){for(var b=0;b<l.size();b++)for(var I=l.get(b),N=0;N<d.size();N++){var j=d.get(N),ne=I.getCoordinate().distance(j.getCoordinate());if(ne<this._minDistance&&(this._minDistance=ne,_[0]=new As(I,0,I.getCoordinate()),_[1]=new As(j,0,j.getCoordinate())),this._minDistance<=this._terminateDistance)return null}},fs.prototype.distance=function(){if(null===this._geom[0]||null===this._geom[1])throw new pe("null geometries are not supported");return this._geom[0].isEmpty()||this._geom[1].isEmpty()?0:(this.computeMinDistance(),this._minDistance)},fs.prototype.computeMinDistanceLines=function(l,d,_){for(var b=0;b<l.size();b++)for(var I=l.get(b),N=0;N<d.size();N++){var j=d.get(N);if(this.computeMinDistance(I,j,_),this._minDistance<=this._terminateDistance)return null}},fs.prototype.interfaces_=function(){return[]},fs.prototype.getClass=function(){return fs},fs.distance=function(l,d){return new fs(l,d).distance()},fs.isWithinDistance=function(l,d,_){return new fs(l,d,_).distance()<=_},fs.nearestPoints=function(l,d){return new fs(l,d).nearestPoints()};var Ps=function(){this._pt=[new re,new re],this._distance=le.NaN,this._isNull=!0};Ps.prototype.getCoordinates=function(){return this._pt},Ps.prototype.getCoordinate=function(l){return this._pt[l]},Ps.prototype.setMinimum=function(){if(1===arguments.length){var l=arguments[0];this.setMinimum(l._pt[0],l._pt[1])}else if(2===arguments.length){var d=arguments[0],_=arguments[1];if(this._isNull)return this.initialize(d,_),null;var b=d.distance(_);b<this._distance&&this.initialize(d,_,b)}},Ps.prototype.initialize=function(){if(0===arguments.length)this._isNull=!0;else if(2===arguments.length){var l=arguments[0],d=arguments[1];this._pt[0].setCoordinate(l),this._pt[1].setCoordinate(d),this._distance=l.distance(d),this._isNull=!1}else if(3===arguments.length){var b=arguments[1],I=arguments[2];this._pt[0].setCoordinate(arguments[0]),this._pt[1].setCoordinate(b),this._distance=I,this._isNull=!1}},Ps.prototype.toString=function(){return _t.toLineString(this._pt[0],this._pt[1])},Ps.prototype.getDistance=function(){return this._distance},Ps.prototype.setMaximum=function(){if(1===arguments.length){var l=arguments[0];this.setMaximum(l._pt[0],l._pt[1])}else if(2===arguments.length){var d=arguments[0],_=arguments[1];if(this._isNull)return this.initialize(d,_),null;var b=d.distance(_);b>this._distance&&this.initialize(d,_,b)}},Ps.prototype.interfaces_=function(){return[]},Ps.prototype.getClass=function(){return Ps};var Ml=function(){};Ml.prototype.interfaces_=function(){return[]},Ml.prototype.getClass=function(){return Ml},Ml.computeDistance=function(){if(arguments[2]instanceof Ps&&arguments[0]instanceof vr&&arguments[1]instanceof re)for(var l=arguments[0],d=arguments[1],_=arguments[2],b=new Yn,I=l.getCoordinates(),N=0;N<I.length-1;N++){b.setCoordinates(I[N],I[N+1]);var j=b.closestPoint(d);_.setMinimum(j,d)}else if(arguments[2]instanceof Ps&&arguments[0]instanceof Xn&&arguments[1]instanceof re){var ne=arguments[0],Ee=arguments[1],it=arguments[2];Ml.computeDistance(ne.getExteriorRing(),Ee,it);for(var Bt=0;Bt<ne.getNumInteriorRing();Bt++)Ml.computeDistance(ne.getInteriorRingN(Bt),Ee,it)}else if(arguments[2]instanceof Ps&&arguments[0]instanceof Qt&&arguments[1]instanceof re){var zt=arguments[0],vn=arguments[1],pn=arguments[2];if(zt instanceof vr)Ml.computeDistance(zt,vn,pn);else if(zt instanceof Xn)Ml.computeDistance(zt,vn,pn);else if(zt instanceof tt)for(var Pn=zt,rr=0;rr<Pn.getNumGeometries();rr++){var C=Pn.getGeometryN(rr);Ml.computeDistance(C,vn,pn)}else pn.setMinimum(zt.getCoordinate(),vn)}else if(arguments[2]instanceof Ps&&arguments[0]instanceof Yn&&arguments[1]instanceof re){var y=arguments[1],S=arguments[2],P=arguments[0].closestPoint(y);S.setMinimum(P,y)}};var cl=function(){this._g0=null,this._g1=null,this._ptDist=new Ps,this._densifyFrac=0;var d=arguments[1];this._g0=arguments[0],this._g1=d},Yd={MaxPointDistanceFilter:{configurable:!0},MaxDensifiedByFractionDistanceFilter:{configurable:!0}};cl.prototype.getCoordinates=function(){return this._ptDist.getCoordinates()},cl.prototype.setDensifyFraction=function(l){if(l>1||l<=0)throw new pe("Fraction is not in range (0.0 - 1.0]");this._densifyFrac=l},cl.prototype.compute=function(l,d){this.computeOrientedDistance(l,d,this._ptDist),this.computeOrientedDistance(d,l,this._ptDist)},cl.prototype.distance=function(){return this.compute(this._g0,this._g1),this._ptDist.getDistance()},cl.prototype.computeOrientedDistance=function(l,d,_){var b=new qu(d);if(l.apply(b),_.setMaximum(b.getMaxPointDistance()),this._densifyFrac>0){var I=new Tl(d,this._densifyFrac);l.apply(I),_.setMaximum(I.getMaxPointDistance())}},cl.prototype.orientedDistance=function(){return this.computeOrientedDistance(this._g0,this._g1,this._ptDist),this._ptDist.getDistance()},cl.prototype.interfaces_=function(){return[]},cl.prototype.getClass=function(){return cl},cl.distance=function(){if(2===arguments.length)return new cl(arguments[0],arguments[1]).distance();if(3===arguments.length){var I=arguments[2],N=new cl(arguments[0],arguments[1]);return N.setDensifyFraction(I),N.distance()}},Yd.MaxPointDistanceFilter.get=function(){return qu},Yd.MaxDensifiedByFractionDistanceFilter.get=function(){return Tl},Object.defineProperties(cl,Yd);var qu=function(){this._maxPtDist=new Ps,this._minPtDist=new Ps,this._euclideanDist=new Ml,this._geom=null,this._geom=arguments[0]};qu.prototype.filter=function(l){this._minPtDist.initialize(),Ml.computeDistance(this._geom,l,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},qu.prototype.getMaxPointDistance=function(){return this._maxPtDist},qu.prototype.interfaces_=function(){return[Vr]},qu.prototype.getClass=function(){return qu};var Tl=function(){this._maxPtDist=new Ps,this._minPtDist=new Ps,this._geom=null,this._numSubSegs=0;var d=arguments[1];this._geom=arguments[0],this._numSubSegs=Math.trunc(Math.round(1/d))};Tl.prototype.filter=function(l,d){if(0===d)return null;for(var _=l.getCoordinate(d-1),b=l.getCoordinate(d),I=(b.x-_.x)/this._numSubSegs,N=(b.y-_.y)/this._numSubSegs,j=0;j<this._numSubSegs;j++){var it=new re(_.x+j*I,_.y+j*N);this._minPtDist.initialize(),Ml.computeDistance(this._geom,it,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)}},Tl.prototype.isDone=function(){return!1},Tl.prototype.isGeometryChanged=function(){return!1},Tl.prototype.getMaxPointDistance=function(){return this._maxPtDist},Tl.prototype.interfaces_=function(){return[bn]},Tl.prototype.getClass=function(){return Tl};var ia=function(l,d,_){this._minValidDistance=null,this._maxValidDistance=null,this._minDistanceFound=null,this._maxDistanceFound=null,this._isValid=!0,this._errMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=l||null,this._bufDistance=d||null,this._result=_||null},hl={VERBOSE:{configurable:!0},MAX_DISTANCE_DIFF_FRAC:{configurable:!0}};ia.prototype.checkMaximumDistance=function(l,d,_){var b=new cl(d,l);if(b.setDensifyFraction(.25),this._maxDistanceFound=b.orientedDistance(),this._maxDistanceFound>_){this._isValid=!1;var I=b.getCoordinates();this._errorLocation=I[1],this._errorIndicator=l.getFactory().createLineString(I),this._errMsg="Distance between buffer curve and input is too large ("+this._maxDistanceFound+" at "+_t.toLineString(I[0],I[1])+")"}},ia.prototype.isValid=function(){var l=Math.abs(this._bufDistance),d=ia.MAX_DISTANCE_DIFF_FRAC*l;return this._minValidDistance=l-d,this._maxValidDistance=l+d,!(!this._input.isEmpty()&&!this._result.isEmpty())||(this._bufDistance>0?this.checkPositiveValid():this.checkNegativeValid(),ia.VERBOSE&&In.out.println("Min Dist= "+this._minDistanceFound+"  err= "+(1-this._minDistanceFound/this._bufDistance)+"  Max Dist= "+this._maxDistanceFound+"  err= "+(this._maxDistanceFound/this._bufDistance-1)),this._isValid)},ia.prototype.checkNegativeValid=function(){if(!(this._input instanceof Xn||this._input instanceof Rn||this._input instanceof tt))return null;var l=this.getPolygonLines(this._input);if(this.checkMinimumDistance(l,this._result,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(l,this._result,this._maxValidDistance)},ia.prototype.getErrorIndicator=function(){return this._errorIndicator},ia.prototype.checkMinimumDistance=function(l,d,_){var b=new fs(l,d,_);if(this._minDistanceFound=b.distance(),this._minDistanceFound<_){this._isValid=!1;var I=b.nearestPoints();this._errorLocation=b.nearestPoints()[1],this._errorIndicator=l.getFactory().createLineString(I),this._errMsg="Distance between buffer curve and input is too small ("+this._minDistanceFound+" at "+_t.toLineString(I[0],I[1])+" )"}},ia.prototype.checkPositiveValid=function(){var l=this._result.getBoundary();if(this.checkMinimumDistance(this._input,l,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(this._input,l,this._maxValidDistance)},ia.prototype.getErrorLocation=function(){return this._errorLocation},ia.prototype.getPolygonLines=function(l){for(var d=new ln,_=new ko(d),b=Yl.getPolygons(l).iterator();b.hasNext();)b.next().apply(_);return l.getFactory().buildGeometry(d)},ia.prototype.getErrorMessage=function(){return this._errMsg},ia.prototype.interfaces_=function(){return[]},ia.prototype.getClass=function(){return ia},hl.VERBOSE.get=function(){return!1},hl.MAX_DISTANCE_DIFF_FRAC.get=function(){return.012},Object.defineProperties(ia,hl);var ps=function(l,d,_){this._isValid=!0,this._errorMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=l||null,this._distance=d||null,this._result=_||null},Nh={VERBOSE:{configurable:!0},MAX_ENV_DIFF_FRAC:{configurable:!0}};ps.prototype.isValid=function(){return this.checkPolygonal(),this._isValid?(this.checkExpectedEmpty(),this._isValid?(this.checkEnvelope(),this._isValid?(this.checkArea(),this._isValid?(this.checkDistance(),this._isValid):this._isValid):this._isValid):this._isValid):this._isValid},ps.prototype.checkEnvelope=function(){if(this._distance<0)return null;var l=this._distance*ps.MAX_ENV_DIFF_FRAC;0===l&&(l=.001);var d=new rn(this._input.getEnvelopeInternal());d.expandBy(this._distance);var _=new rn(this._result.getEnvelopeInternal());_.expandBy(l),_.contains(d)||(this._isValid=!1,this._errorMsg="Buffer envelope is incorrect",this._errorIndicator=this._input.getFactory().toGeometry(_)),this.report("Envelope")},ps.prototype.checkDistance=function(){var l=new ia(this._input,this._distance,this._result);l.isValid()||(this._isValid=!1,this._errorMsg=l.getErrorMessage(),this._errorLocation=l.getErrorLocation(),this._errorIndicator=l.getErrorIndicator()),this.report("Distance")},ps.prototype.checkArea=function(){var l=this._input.getArea(),d=this._result.getArea();this._distance>0&&l>d&&(this._isValid=!1,this._errorMsg="Area of positive buffer is smaller than input",this._errorIndicator=this._result),this._distance<0&&l<d&&(this._isValid=!1,this._errorMsg="Area of negative buffer is larger than input",this._errorIndicator=this._result),this.report("Area")},ps.prototype.checkPolygonal=function(){this._result instanceof Xn||this._result instanceof Rn||(this._isValid=!1),this._errorMsg="Result is not polygonal",this._errorIndicator=this._result,this.report("Polygonal")},ps.prototype.getErrorIndicator=function(){return this._errorIndicator},ps.prototype.getErrorLocation=function(){return this._errorLocation},ps.prototype.checkExpectedEmpty=function(){return this._input.getDimension()>=2||this._distance>0?null:(this._result.isEmpty()||(this._isValid=!1,this._errorMsg="Result is non-empty",this._errorIndicator=this._result),void this.report("ExpectedEmpty"))},ps.prototype.report=function(l){if(!ps.VERBOSE)return null;In.out.println("Check "+l+": "+(this._isValid?"passed":"FAILED"))},ps.prototype.getErrorMessage=function(){return this._errorMsg},ps.prototype.interfaces_=function(){return[]},ps.prototype.getClass=function(){return ps},ps.isValidMsg=function(l,d,_){var b=new ps(l,d,_);return b.isValid()?null:b.getErrorMessage()},ps.isValid=function(l,d,_){return!!new ps(l,d,_).isValid()},Nh.VERBOSE.get=function(){return!1},Nh.MAX_ENV_DIFF_FRAC.get=function(){return.012},Object.defineProperties(ps,Nh);var Qa=function(){this._pts=null,this._data=null;var d=arguments[1];this._pts=arguments[0],this._data=d};Qa.prototype.getCoordinates=function(){return this._pts},Qa.prototype.size=function(){return this._pts.length},Qa.prototype.getCoordinate=function(l){return this._pts[l]},Qa.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])},Qa.prototype.getSegmentOctant=function(l){return l===this._pts.length-1?-1:pc.octant(this.getCoordinate(l),this.getCoordinate(l+1))},Qa.prototype.setData=function(l){this._data=l},Qa.prototype.getData=function(){return this._data},Qa.prototype.toString=function(){return _t.toLineString(new Ln(this._pts))},Qa.prototype.interfaces_=function(){return[jr]},Qa.prototype.getClass=function(){return Qa};var Ko=function(){this._findAllIntersections=!1,this._isCheckEndSegmentsOnly=!1,this._li=null,this._interiorIntersection=null,this._intSegments=null,this._intersections=new ln,this._intersectionCount=0,this._keepIntersections=!0,this._li=arguments[0],this._interiorIntersection=null};Ko.prototype.getInteriorIntersection=function(){return this._interiorIntersection},Ko.prototype.setCheckEndSegmentsOnly=function(l){this._isCheckEndSegmentsOnly=l},Ko.prototype.getIntersectionSegments=function(){return this._intSegments},Ko.prototype.count=function(){return this._intersectionCount},Ko.prototype.getIntersections=function(){return this._intersections},Ko.prototype.setFindAllIntersections=function(l){this._findAllIntersections=l},Ko.prototype.setKeepIntersections=function(l){this._keepIntersections=l},Ko.prototype.processIntersections=function(l,d,_,b){if(!this._findAllIntersections&&this.hasIntersection()||l===_&&d===b||this._isCheckEndSegmentsOnly&&!this.isEndSegment(l,d)&&!this.isEndSegment(_,b))return null;var I=l.getCoordinates()[d],N=l.getCoordinates()[d+1],j=_.getCoordinates()[b],ne=_.getCoordinates()[b+1];this._li.computeIntersection(I,N,j,ne),this._li.hasIntersection()&&this._li.isInteriorIntersection()&&(this._intSegments=new Array(4).fill(null),this._intSegments[0]=I,this._intSegments[1]=N,this._intSegments[2]=j,this._intSegments[3]=ne,this._interiorIntersection=this._li.getIntersection(0),this._keepIntersections&&this._intersections.add(this._interiorIntersection),this._intersectionCount++)},Ko.prototype.isEndSegment=function(l,d){return 0===d||d>=l.size()-2},Ko.prototype.hasIntersection=function(){return null!==this._interiorIntersection},Ko.prototype.isDone=function(){return!this._findAllIntersections&&null!==this._interiorIntersection},Ko.prototype.interfaces_=function(){return[yo]},Ko.prototype.getClass=function(){return Ko},Ko.createAllIntersectionsFinder=function(l){var d=new Ko(l);return d.setFindAllIntersections(!0),d},Ko.createAnyIntersectionFinder=function(l){return new Ko(l)},Ko.createIntersectionCounter=function(l){var d=new Ko(l);return d.setFindAllIntersections(!0),d.setKeepIntersections(!1),d};var Dl=function(){this._li=new Ot,this._segStrings=null,this._findAllIntersections=!1,this._segInt=null,this._isValid=!0,this._segStrings=arguments[0]};Dl.prototype.execute=function(){if(null!==this._segInt)return null;this.checkInteriorIntersections()},Dl.prototype.getIntersections=function(){return this._segInt.getIntersections()},Dl.prototype.isValid=function(){return this.execute(),this._isValid},Dl.prototype.setFindAllIntersections=function(l){this._findAllIntersections=l},Dl.prototype.checkInteriorIntersections=function(){this._isValid=!0,this._segInt=new Ko(this._li),this._segInt.setFindAllIntersections(this._findAllIntersections);var l=new Xl;if(l.setSegmentIntersector(this._segInt),l.computeNodes(this._segStrings),this._segInt.hasIntersection())return this._isValid=!1,null},Dl.prototype.checkValid=function(){if(this.execute(),!this._isValid)throw new ql(this.getErrorMessage(),this._segInt.getInteriorIntersection())},Dl.prototype.getErrorMessage=function(){if(this._isValid)return"no intersections found";var l=this._segInt.getIntersectionSegments();return"found non-noded intersection between "+_t.toLineString(l[0],l[1])+" and "+_t.toLineString(l[2],l[3])},Dl.prototype.interfaces_=function(){return[]},Dl.prototype.getClass=function(){return Dl},Dl.computeIntersections=function(l){var d=new Dl(l);return d.setFindAllIntersections(!0),d.isValid(),d.getIntersections()};var Eu=function l(){this._nv=null,this._nv=new Dl(l.toSegmentStrings(arguments[0]))};Eu.prototype.checkValid=function(){this._nv.checkValid()},Eu.prototype.interfaces_=function(){return[]},Eu.prototype.getClass=function(){return Eu},Eu.toSegmentStrings=function(l){for(var d=new ln,_=l.iterator();_.hasNext();){var b=_.next();d.add(new Qa(b.getCoordinates(),b))}return d},Eu.checkValid=function(l){new Eu(l).checkValid()};var dl=function(l){this._mapOp=l};dl.prototype.map=function(l){for(var d=new ln,_=0;_<l.getNumGeometries();_++){var b=this._mapOp.map(l.getGeometryN(_));b.isEmpty()||d.add(b)}return l.getFactory().createGeometryCollection(fr.toGeometryArray(d))},dl.prototype.interfaces_=function(){return[]},dl.prototype.getClass=function(){return dl},dl.map=function(l,d){return new dl(d).map(l)};var Ua=function(){this._op=null,this._geometryFactory=null,this._ptLocator=null,this._lineEdgesList=new ln,this._resultLineList=new ln;var d=arguments[1],_=arguments[2];this._op=arguments[0],this._geometryFactory=d,this._ptLocator=_};Ua.prototype.collectLines=function(l){for(var d=this._op.getGraph().getEdgeEnds().iterator();d.hasNext();){var _=d.next();this.collectLineEdge(_,l,this._lineEdgesList),this.collectBoundaryTouchEdge(_,l,this._lineEdgesList)}},Ua.prototype.labelIsolatedLine=function(l,d){var _=this._ptLocator.locate(l.getCoordinate(),this._op.getArgGeometry(d));l.getLabel().setLocation(d,_)},Ua.prototype.build=function(l){return this.findCoveredLineEdges(),this.collectLines(l),this.buildLines(l),this._resultLineList},Ua.prototype.collectLineEdge=function(l,d,_){var b=l.getLabel(),I=l.getEdge();l.isLineEdge()&&(l.isVisited()||!wr.isResultOfOp(b,d)||I.isCovered()||(_.add(I),l.setVisitedEdge(!0)))},Ua.prototype.findCoveredLineEdges=function(){for(var l=this._op.getGraph().getNodes().iterator();l.hasNext();)l.next().getEdges().findCoveredLineEdges();for(var d=this._op.getGraph().getEdgeEnds().iterator();d.hasNext();){var _=d.next(),b=_.getEdge();if(_.isLineEdge()&&!b.isCoveredSet()){var I=this._op.isCoveredByA(_.getCoordinate());b.setCovered(I)}}},Ua.prototype.labelIsolatedLines=function(l){for(var d=l.iterator();d.hasNext();){var _=d.next(),b=_.getLabel();_.isIsolated()&&(b.isNull(0)?this.labelIsolatedLine(_,0):this.labelIsolatedLine(_,1))}},Ua.prototype.buildLines=function(l){for(var d=this._lineEdgesList.iterator();d.hasNext();){var _=d.next(),b=this._geometryFactory.createLineString(_.getCoordinates());this._resultLineList.add(b),_.setInResult(!0)}},Ua.prototype.collectBoundaryTouchEdge=function(l,d,_){var b=l.getLabel();return l.isLineEdge()||l.isVisited()||l.isInteriorAreaEdge()||l.getEdge().isInResult()?null:(ae.isTrue(!(l.isInResult()||l.getSym().isInResult())||!l.getEdge().isInResult()),void(wr.isResultOfOp(b,d)&&d===wr.INTERSECTION&&(_.add(l.getEdge()),l.setVisitedEdge(!0))))},Ua.prototype.interfaces_=function(){return[]},Ua.prototype.getClass=function(){return Ua};var Lo=function(){this._op=null,this._geometryFactory=null,this._resultPointList=new ln;var d=arguments[1];this._op=arguments[0],this._geometryFactory=d};Lo.prototype.filterCoveredNodeToPoint=function(l){var d=l.getCoordinate();if(!this._op.isCoveredByLA(d)){var _=this._geometryFactory.createPoint(d);this._resultPointList.add(_)}},Lo.prototype.extractNonCoveredResultNodes=function(l){for(var d=this._op.getGraph().getNodes().iterator();d.hasNext();){var _=d.next();if(!(_.isInResult()||_.isIncidentEdgeInResult()||0!==_.getEdges().getDegree()&&l!==wr.INTERSECTION)){var b=_.getLabel();wr.isResultOfOp(b,l)&&this.filterCoveredNodeToPoint(_)}}},Lo.prototype.build=function(l){return this.extractNonCoveredResultNodes(l),this._resultPointList},Lo.prototype.interfaces_=function(){return[]},Lo.prototype.getClass=function(){return Lo};var oa=function(){this._inputGeom=null,this._factory=null,this._pruneEmptyGeometry=!0,this._preserveGeometryCollectionType=!0,this._preserveCollections=!1,this._preserveType=!1};oa.prototype.transformPoint=function(l,d){return this._factory.createPoint(this.transformCoordinates(l.getCoordinateSequence(),l))},oa.prototype.transformPolygon=function(l,d){var _=!0,b=this.transformLinearRing(l.getExteriorRing(),l);null!==b&&b instanceof po&&!b.isEmpty()||(_=!1);for(var I=new ln,N=0;N<l.getNumInteriorRing();N++){var j=this.transformLinearRing(l.getInteriorRingN(N),l);null===j||j.isEmpty()||(j instanceof po||(_=!1),I.add(j))}if(_)return this._factory.createPolygon(b,I.toArray([]));var ne=new ln;return null!==b&&ne.add(b),ne.addAll(I),this._factory.buildGeometry(ne)},oa.prototype.createCoordinateSequence=function(l){return this._factory.getCoordinateSequenceFactory().create(l)},oa.prototype.getInputGeometry=function(){return this._inputGeom},oa.prototype.transformMultiLineString=function(l,d){for(var _=new ln,b=0;b<l.getNumGeometries();b++){var I=this.transformLineString(l.getGeometryN(b),l);null!==I&&(I.isEmpty()||_.add(I))}return this._factory.buildGeometry(_)},oa.prototype.transformCoordinates=function(l,d){return this.copy(l)},oa.prototype.transformLineString=function(l,d){return this._factory.createLineString(this.transformCoordinates(l.getCoordinateSequence(),l))},oa.prototype.transformMultiPoint=function(l,d){for(var _=new ln,b=0;b<l.getNumGeometries();b++){var I=this.transformPoint(l.getGeometryN(b),l);null!==I&&(I.isEmpty()||_.add(I))}return this._factory.buildGeometry(_)},oa.prototype.transformMultiPolygon=function(l,d){for(var _=new ln,b=0;b<l.getNumGeometries();b++){var I=this.transformPolygon(l.getGeometryN(b),l);null!==I&&(I.isEmpty()||_.add(I))}return this._factory.buildGeometry(_)},oa.prototype.copy=function(l){return l.copy()},oa.prototype.transformGeometryCollection=function(l,d){for(var _=new ln,b=0;b<l.getNumGeometries();b++){var I=this.transform(l.getGeometryN(b));null!==I&&(this._pruneEmptyGeometry&&I.isEmpty()||_.add(I))}return this._preserveGeometryCollectionType?this._factory.createGeometryCollection(fr.toGeometryArray(_)):this._factory.buildGeometry(_)},oa.prototype.transform=function(l){if(this._inputGeom=l,this._factory=l.getFactory(),l instanceof gn)return this.transformPoint(l,null);if(l instanceof wa)return this.transformMultiPoint(l,null);if(l instanceof po)return this.transformLinearRing(l,null);if(l instanceof vr)return this.transformLineString(l,null);if(l instanceof Vt)return this.transformMultiLineString(l,null);if(l instanceof Xn)return this.transformPolygon(l,null);if(l instanceof Rn)return this.transformMultiPolygon(l,null);if(l instanceof tt)return this.transformGeometryCollection(l,null);throw new pe("Unknown Geometry subtype: "+l.getClass().getName())},oa.prototype.transformLinearRing=function(l,d){var _=this.transformCoordinates(l.getCoordinateSequence(),l);if(null===_)return this._factory.createLinearRing(null);var b=_.size();return b>0&&b<4&&!this._preserveType?this._factory.createLineString(_):this._factory.createLinearRing(_)},oa.prototype.interfaces_=function(){return[]},oa.prototype.getClass=function(){return oa};var No=function l(){if(this._snapTolerance=0,this._srcPts=null,this._seg=new Yn,this._allowSnappingToSourceVertices=!1,this._isClosed=!1,arguments[0]instanceof vr&&"number"==typeof arguments[1]){var _=arguments[1];l.call(this,arguments[0].getCoordinates(),_)}else if(arguments[0]instanceof Array&&"number"==typeof arguments[1]){var b=arguments[0],I=arguments[1];this._srcPts=b,this._isClosed=l.isClosed(b),this._snapTolerance=I}};No.prototype.snapVertices=function(l,d){for(var _=this._isClosed?l.size()-1:l.size(),b=0;b<_;b++){var I=l.get(b),N=this.findSnapForVertex(I,d);null!==N&&(l.set(b,new re(N)),0===b&&this._isClosed&&l.set(l.size()-1,new re(N)))}},No.prototype.findSnapForVertex=function(l,d){for(var _=0;_<d.length;_++){if(l.equals2D(d[_]))return null;if(l.distance(d[_])<this._snapTolerance)return d[_]}return null},No.prototype.snapTo=function(l){var d=new Fs(this._srcPts);return this.snapVertices(d,l),this.snapSegments(d,l),d.toCoordinateArray()},No.prototype.snapSegments=function(l,d){if(0===d.length)return null;var _=d.length;d[0].equals2D(d[d.length-1])&&(_=d.length-1);for(var b=0;b<_;b++){var I=d[b],N=this.findSegmentIndexToSnap(I,l);N>=0&&l.add(N+1,new re(I),!1)}},No.prototype.findSegmentIndexToSnap=function(l,d){for(var _=le.MAX_VALUE,b=-1,I=0;I<d.size()-1;I++){if(this._seg.p0=d.get(I),this._seg.p1=d.get(I+1),this._seg.p0.equals2D(l)||this._seg.p1.equals2D(l)){if(this._allowSnappingToSourceVertices)continue;return-1}var N=this._seg.distance(l);N<this._snapTolerance&&N<_&&(_=N,b=I)}return b},No.prototype.setAllowSnappingToSourceVertices=function(l){this._allowSnappingToSourceVertices=l},No.prototype.interfaces_=function(){return[]},No.prototype.getClass=function(){return No},No.isClosed=function(l){return!(l.length<=1)&&l[0].equals2D(l[l.length-1])};var Jo=function(l){this._srcGeom=l||null},Kl={SNAP_PRECISION_FACTOR:{configurable:!0}};Jo.prototype.snapTo=function(l,d){var _=this.extractTargetCoordinates(l);return new Fh(d,_).transform(this._srcGeom)},Jo.prototype.snapToSelf=function(l,d){var _=this.extractTargetCoordinates(this._srcGeom),b=new Fh(l,_,!0).transform(this._srcGeom),I=b;return d&&Lt(I,Tr)&&(I=b.buffer(0)),I},Jo.prototype.computeSnapTolerance=function(l){return this.computeMinimumSegmentLength(l)/10},Jo.prototype.extractTargetCoordinates=function(l){for(var d=new At,_=l.getCoordinates(),b=0;b<_.length;b++)d.add(_[b]);return d.toArray(new Array(0).fill(null))},Jo.prototype.computeMinimumSegmentLength=function(l){for(var d=le.MAX_VALUE,_=0;_<l.length-1;_++){var b=l[_].distance(l[_+1]);b<d&&(d=b)}return d},Jo.prototype.interfaces_=function(){return[]},Jo.prototype.getClass=function(){return Jo},Jo.snap=function(l,d,_){var b=new Array(2).fill(null),I=new Jo(l);b[0]=I.snapTo(d,_);var N=new Jo(d);return b[1]=N.snapTo(b[0],_),b},Jo.computeOverlaySnapTolerance=function(){if(1===arguments.length){var l=arguments[0],d=Jo.computeSizeBasedSnapTolerance(l),_=l.getPrecisionModel();if(_.getType()===Or.FIXED){var b=1/_.getScale()*2/1.415;b>d&&(d=b)}return d}if(2===arguments.length){var N=arguments[1];return Math.min(Jo.computeOverlaySnapTolerance(arguments[0]),Jo.computeOverlaySnapTolerance(N))}},Jo.computeSizeBasedSnapTolerance=function(l){var d=l.getEnvelopeInternal();return Math.min(d.getHeight(),d.getWidth())*Jo.SNAP_PRECISION_FACTOR},Jo.snapToSelf=function(l,d,_){return new Jo(l).snapToSelf(d,_)},Kl.SNAP_PRECISION_FACTOR.get=function(){return 1e-9},Object.defineProperties(Jo,Kl);var Fh=function(l){function d(_,b,I){l.call(this),this._snapTolerance=_||null,this._snapPts=b||null,this._isSelfSnap=void 0!==I&&I}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.snapLine=function(_,b){var I=new No(_,this._snapTolerance);return I.setAllowSnappingToSourceVertices(this._isSelfSnap),I.snapTo(b)},d.prototype.transformCoordinates=function(_,b){var I=_.toCoordinateArray(),N=this.snapLine(I,this._snapPts);return this._factory.getCoordinateSequenceFactory().create(N)},d.prototype.interfaces_=function(){return[]},d.prototype.getClass=function(){return d},d}(oa),Qo=function(){this._isFirst=!0,this._commonMantissaBitsCount=53,this._commonBits=0,this._commonSignExp=null};Qo.prototype.getCommon=function(){return le.longBitsToDouble(this._commonBits)},Qo.prototype.add=function(l){var d=le.doubleToLongBits(l);return this._isFirst?(this._commonBits=d,this._commonSignExp=Qo.signExpBits(this._commonBits),this._isFirst=!1,null):Qo.signExpBits(d)!==this._commonSignExp?(this._commonBits=0,null):(this._commonMantissaBitsCount=Qo.numCommonMostSigMantissaBits(this._commonBits,d),void(this._commonBits=Qo.zeroLowerBits(this._commonBits,64-(12+this._commonMantissaBitsCount))))},Qo.prototype.toString=function(){if(1===arguments.length){var l=arguments[0],d=le.longBitsToDouble(l),_="0000000000000000000000000000000000000000000000000000000000000000"+le.toBinaryString(l),b=_.substring(_.length-64);return b.substring(0,1)+"  "+b.substring(1,12)+"(exp) "+b.substring(12)+" [ "+d+" ]"}},Qo.prototype.interfaces_=function(){return[]},Qo.prototype.getClass=function(){return Qo},Qo.getBit=function(l,d){return 0!=(l&1<<d)?1:0},Qo.signExpBits=function(l){return l>>52},Qo.zeroLowerBits=function(l,d){return l&~((1<<d)-1)},Qo.numCommonMostSigMantissaBits=function(l,d){for(var _=0,b=52;b>=0;b--){if(Qo.getBit(l,b)!==Qo.getBit(d,b))return _;_++}return 52};var ya=function(){this._commonCoord=null,this._ccFilter=new sa},th={CommonCoordinateFilter:{configurable:!0},Translater:{configurable:!0}};ya.prototype.addCommonBits=function(l){var d=new Cu(this._commonCoord);l.apply(d),l.geometryChanged()},ya.prototype.removeCommonBits=function(l){if(0===this._commonCoord.x&&0===this._commonCoord.y)return l;var d=new re(this._commonCoord);d.x=-d.x,d.y=-d.y;var _=new Cu(d);return l.apply(_),l.geometryChanged(),l},ya.prototype.getCommonCoordinate=function(){return this._commonCoord},ya.prototype.add=function(l){l.apply(this._ccFilter),this._commonCoord=this._ccFilter.getCommonCoordinate()},ya.prototype.interfaces_=function(){return[]},ya.prototype.getClass=function(){return ya},th.CommonCoordinateFilter.get=function(){return sa},th.Translater.get=function(){return Cu},Object.defineProperties(ya,th);var sa=function(){this._commonBitsX=new Qo,this._commonBitsY=new Qo};sa.prototype.filter=function(l){this._commonBitsX.add(l.x),this._commonBitsY.add(l.y)},sa.prototype.getCommonCoordinate=function(){return new re(this._commonBitsX.getCommon(),this._commonBitsY.getCommon())},sa.prototype.interfaces_=function(){return[Vr]},sa.prototype.getClass=function(){return sa};var Cu=function(){this.trans=null,this.trans=arguments[0]};Cu.prototype.filter=function(l,d){var _=l.getOrdinate(d,0)+this.trans.x,b=l.getOrdinate(d,1)+this.trans.y;l.setOrdinate(d,0,_),l.setOrdinate(d,1,b)},Cu.prototype.isDone=function(){return!1},Cu.prototype.isGeometryChanged=function(){return!0},Cu.prototype.interfaces_=function(){return[bn]},Cu.prototype.getClass=function(){return Cu};var gs=function(l,d){this._geom=new Array(2).fill(null),this._snapTolerance=null,this._cbr=null,this._geom[0]=l,this._geom[1]=d,this.computeSnapTolerance()};gs.prototype.selfSnap=function(l){return new Jo(l).snapTo(l,this._snapTolerance)},gs.prototype.removeCommonBits=function(l){this._cbr=new ya,this._cbr.add(l[0]),this._cbr.add(l[1]);var d=new Array(2).fill(null);return d[0]=this._cbr.removeCommonBits(l[0].copy()),d[1]=this._cbr.removeCommonBits(l[1].copy()),d},gs.prototype.prepareResult=function(l){return this._cbr.addCommonBits(l),l},gs.prototype.getResultGeometry=function(l){var d=this.snap(this._geom),_=wr.overlayOp(d[0],d[1],l);return this.prepareResult(_)},gs.prototype.checkValid=function(l){l.isValid()||In.out.println("Snapped geometry is invalid")},gs.prototype.computeSnapTolerance=function(){this._snapTolerance=Jo.computeOverlaySnapTolerance(this._geom[0],this._geom[1])},gs.prototype.snap=function(l){var d=this.removeCommonBits(l);return Jo.snap(d[0],d[1],this._snapTolerance)},gs.prototype.interfaces_=function(){return[]},gs.prototype.getClass=function(){return gs},gs.overlayOp=function(l,d,_){return new gs(l,d).getResultGeometry(_)},gs.union=function(l,d){return gs.overlayOp(l,d,wr.UNION)},gs.intersection=function(l,d){return gs.overlayOp(l,d,wr.INTERSECTION)},gs.symDifference=function(l,d){return gs.overlayOp(l,d,wr.SYMDIFFERENCE)},gs.difference=function(l,d){return gs.overlayOp(l,d,wr.DIFFERENCE)};var Rs=function(l,d){this._geom=new Array(2).fill(null),this._geom[0]=l,this._geom[1]=d};Rs.prototype.getResultGeometry=function(l){var d=null,_=!1,b=null;try{d=wr.overlayOp(this._geom[0],this._geom[1],l),_=!0}catch(I){if(!(I instanceof ve))throw I;b=I}if(!_)try{d=gs.overlayOp(this._geom[0],this._geom[1],l)}catch(I){throw I instanceof ve?b:I}return d},Rs.prototype.interfaces_=function(){return[]},Rs.prototype.getClass=function(){return Rs},Rs.overlayOp=function(l,d,_){return new Rs(l,d).getResultGeometry(_)},Rs.union=function(l,d){return Rs.overlayOp(l,d,wr.UNION)},Rs.intersection=function(l,d){return Rs.overlayOp(l,d,wr.INTERSECTION)},Rs.symDifference=function(l,d){return Rs.overlayOp(l,d,wr.SYMDIFFERENCE)},Rs.difference=function(l,d){return Rs.overlayOp(l,d,wr.DIFFERENCE)};var pu=function(){this.mce=null,this.chainIndex=null;var d=arguments[1];this.mce=arguments[0],this.chainIndex=d};pu.prototype.computeIntersections=function(l,d){this.mce.computeIntersectsForChain(this.chainIndex,l.mce,l.chainIndex,d)},pu.prototype.interfaces_=function(){return[]},pu.prototype.getClass=function(){return pu};var Fo=function l(){if(this._label=null,this._xValue=null,this._eventType=null,this._insertEvent=null,this._deleteEventIndex=null,this._obj=null,2===arguments.length){var d=arguments[0],_=arguments[1];this._eventType=l.DELETE,this._xValue=d,this._insertEvent=_}else if(3===arguments.length){var b=arguments[0],I=arguments[1],N=arguments[2];this._eventType=l.INSERT,this._label=b,this._xValue=I,this._obj=N}},Zd={INSERT:{configurable:!0},DELETE:{configurable:!0}};Fo.prototype.isDelete=function(){return this._eventType===Fo.DELETE},Fo.prototype.setDeleteEventIndex=function(l){this._deleteEventIndex=l},Fo.prototype.getObject=function(){return this._obj},Fo.prototype.compareTo=function(l){return this._xValue<l._xValue?-1:this._xValue>l._xValue?1:this._eventType<l._eventType?-1:this._eventType>l._eventType?1:0},Fo.prototype.getInsertEvent=function(){return this._insertEvent},Fo.prototype.isInsert=function(){return this._eventType===Fo.INSERT},Fo.prototype.isSameLabel=function(l){return null!==this._label&&this._label===l._label},Fo.prototype.getDeleteEventIndex=function(){return this._deleteEventIndex},Fo.prototype.interfaces_=function(){return[he]},Fo.prototype.getClass=function(){return Fo},Zd.INSERT.get=function(){return 1},Zd.DELETE.get=function(){return 2},Object.defineProperties(Fo,Zd);var Go=function(){};Go.prototype.interfaces_=function(){return[]},Go.prototype.getClass=function(){return Go};var ms=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._properIntersectionPoint=null,this._li=null,this._includeProper=null,this._recordIsolated=null,this._isSelfIntersection=null,this._numIntersections=0,this.numTests=0,this._bdyNodes=null,this._isDone=!1,this._isDoneWhenProperInt=!1;var d=arguments[1],_=arguments[2];this._li=arguments[0],this._includeProper=d,this._recordIsolated=_};ms.prototype.isTrivialIntersection=function(l,d,_,b){if(l===_&&1===this._li.getIntersectionNum()){if(ms.isAdjacentSegments(d,b))return!0;if(l.isClosed()){var I=l.getNumPoints()-1;if(0===d&&b===I||0===b&&d===I)return!0}}return!1},ms.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint},ms.prototype.setIsDoneIfProperInt=function(l){this._isDoneWhenProperInt=l},ms.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior},ms.prototype.isBoundaryPointInternal=function(l,d){for(var _=d.iterator();_.hasNext();){var b=_.next().getCoordinate();if(l.isIntersection(b))return!0}return!1},ms.prototype.hasProperIntersection=function(){return this._hasProper},ms.prototype.hasIntersection=function(){return this._hasIntersection},ms.prototype.isDone=function(){return this._isDone},ms.prototype.isBoundaryPoint=function(l,d){return!(null===d||!this.isBoundaryPointInternal(l,d[0])&&!this.isBoundaryPointInternal(l,d[1]))},ms.prototype.setBoundaryNodes=function(l,d){this._bdyNodes=new Array(2).fill(null),this._bdyNodes[0]=l,this._bdyNodes[1]=d},ms.prototype.addIntersections=function(l,d,_,b){if(l===_&&d===b)return null;this.numTests++;var I=l.getCoordinates()[d],N=l.getCoordinates()[d+1],j=_.getCoordinates()[b],ne=_.getCoordinates()[b+1];this._li.computeIntersection(I,N,j,ne),this._li.hasIntersection()&&(this._recordIsolated&&(l.setIsolated(!1),_.setIsolated(!1)),this._numIntersections++,this.isTrivialIntersection(l,d,_,b)||(this._hasIntersection=!0,!this._includeProper&&this._li.isProper()||(l.addIntersections(this._li,d,0),_.addIntersections(this._li,b,1)),this._li.isProper()&&(this._properIntersectionPoint=this._li.getIntersection(0).copy(),this._hasProper=!0,this._isDoneWhenProperInt&&(this._isDone=!0),this.isBoundaryPoint(this._li,this._bdyNodes)||(this._hasProperInterior=!0))))},ms.prototype.interfaces_=function(){return[]},ms.prototype.getClass=function(){return ms},ms.isAdjacentSegments=function(l,d){return 1===Math.abs(l-d)};var Bn=function(l){function d(){l.call(this),this.events=new ln,this.nOverlaps=null}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.prepareEvents=function(){ss.sort(this.events);for(var _=0;_<this.events.size();_++){var b=this.events.get(_);b.isDelete()&&b.getInsertEvent().setDeleteEventIndex(_)}},d.prototype.computeIntersections=function(){if(1===arguments.length){var _=arguments[0];this.nOverlaps=0,this.prepareEvents();for(var b=0;b<this.events.size();b++){var I=this.events.get(b);if(I.isInsert()&&this.processOverlaps(b,I.getDeleteEventIndex(),I,_),_.isDone())break}}else if(3===arguments.length)if(arguments[2]instanceof ms&&Lt(arguments[0],fo)&&Lt(arguments[1],fo)){var N=arguments[0],j=arguments[1],ne=arguments[2];this.addEdges(N,N),this.addEdges(j,j),this.computeIntersections(ne)}else if("boolean"==typeof arguments[2]&&Lt(arguments[0],fo)&&arguments[1]instanceof ms){var Ee=arguments[0],it=arguments[1];arguments[2]?this.addEdges(Ee,null):this.addEdges(Ee),this.computeIntersections(it)}},d.prototype.addEdge=function(_,b){for(var I=_.getMonotoneChainEdge(),N=I.getStartIndexes(),j=0;j<N.length-1;j++){var ne=new pu(I,j),Ee=new Fo(b,I.getMinX(j),ne);this.events.add(Ee),this.events.add(new Fo(I.getMaxX(j),Ee))}},d.prototype.processOverlaps=function(_,b,I,N){for(var j=I.getObject(),ne=_;ne<b;ne++){var Ee=this.events.get(ne);if(Ee.isInsert()){var it=Ee.getObject();I.isSameLabel(Ee)||(j.computeIntersections(it,N),this.nOverlaps++)}}},d.prototype.addEdges=function(){if(1===arguments.length)for(var _=arguments[0].iterator();_.hasNext();){var b=_.next();this.addEdge(b,b)}else if(2===arguments.length)for(var N=arguments[1],j=arguments[0].iterator();j.hasNext();){var ne=j.next();this.addEdge(ne,N)}},d.prototype.interfaces_=function(){return[]},d.prototype.getClass=function(){return d},d}(Go),Jl=function(){this._min=le.POSITIVE_INFINITY,this._max=le.NEGATIVE_INFINITY},Cs={NodeComparator:{configurable:!0}};Jl.prototype.getMin=function(){return this._min},Jl.prototype.intersects=function(l,d){return!(this._min>d||this._max<l)},Jl.prototype.getMax=function(){return this._max},Jl.prototype.toString=function(){return _t.toLineString(new re(this._min,0),new re(this._max,0))},Jl.prototype.interfaces_=function(){return[]},Jl.prototype.getClass=function(){return Jl},Cs.NodeComparator.get=function(){return Wu},Object.defineProperties(Jl,Cs);var Wu=function(){};Wu.prototype.compare=function(l,d){var I=(l._min+l._max)/2,N=(d._min+d._max)/2;return I<N?-1:I>N?1:0},Wu.prototype.interfaces_=function(){return[be]},Wu.prototype.getClass=function(){return Wu};var md=function(l){function d(){l.call(this),this._item=null;var b=arguments[1],I=arguments[2];this._min=arguments[0],this._max=b,this._item=I}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.query=function(_,b,I){if(!this.intersects(_,b))return null;I.visitItem(this._item)},d.prototype.interfaces_=function(){return[]},d.prototype.getClass=function(){return d},d}(Jl),Bh=function(l){function d(){l.call(this),this._node1=null,this._node2=null;var b=arguments[1];this._node1=arguments[0],this._node2=b,this.buildExtent(this._node1,this._node2)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.buildExtent=function(_,b){this._min=Math.min(_._min,b._min),this._max=Math.max(_._max,b._max)},d.prototype.query=function(_,b,I){if(!this.intersects(_,b))return null;null!==this._node1&&this._node1.query(_,b,I),null!==this._node2&&this._node2.query(_,b,I)},d.prototype.interfaces_=function(){return[]},d.prototype.getClass=function(){return d},d}(Jl),_s=function(){this._leaves=new ln,this._root=null,this._level=0};_s.prototype.buildTree=function(){ss.sort(this._leaves,new Jl.NodeComparator);for(var l=this._leaves,d=null,_=new ln;;){if(this.buildLevel(l,_),1===_.size())return _.get(0);d=l,l=_,_=d}},_s.prototype.insert=function(l,d,_){if(null!==this._root)throw new Error("Index cannot be added to once it has been queried");this._leaves.add(new md(l,d,_))},_s.prototype.query=function(l,d,_){this.init(),this._root.query(l,d,_)},_s.prototype.buildRoot=function(){if(null!==this._root)return null;this._root=this.buildTree()},_s.prototype.printNode=function(l){In.out.println(_t.toLineString(new re(l._min,this._level),new re(l._max,this._level)))},_s.prototype.init=function(){if(null!==this._root)return null;this.buildRoot()},_s.prototype.buildLevel=function(l,d){this._level++,d.clear();for(var _=0;_<l.size();_+=2){var b=l.get(_);if(null===(_+1<l.size()?l.get(_):null))d.add(b);else{var I=new Bh(l.get(_),l.get(_+1));d.add(I)}}},_s.prototype.interfaces_=function(){return[]},_s.prototype.getClass=function(){return _s};var Rc=function(){this._items=new ln};Rc.prototype.visitItem=function(l){this._items.add(l)},Rc.prototype.getItems=function(){return this._items},Rc.prototype.interfaces_=function(){return[wl]},Rc.prototype.getClass=function(){return Rc};var Ql=function(){this._index=null;var l=arguments[0];if(!Lt(l,Tr))throw new pe("Argument must be Polygonal");this._index=new Il(l)},Xu={SegmentVisitor:{configurable:!0},IntervalIndexedGeometry:{configurable:!0}};Ql.prototype.locate=function(l){var d=new Yt(l),_=new aa(d);return this._index.query(l.y,l.y,_),d.getLocation()},Ql.prototype.interfaces_=function(){return[pa]},Ql.prototype.getClass=function(){return Ql},Xu.SegmentVisitor.get=function(){return aa},Xu.IntervalIndexedGeometry.get=function(){return Il},Object.defineProperties(Ql,Xu);var aa=function(){this._counter=null,this._counter=arguments[0]};aa.prototype.visitItem=function(l){var d=l;this._counter.countSegment(d.getCoordinate(0),d.getCoordinate(1))},aa.prototype.interfaces_=function(){return[wl]},aa.prototype.getClass=function(){return aa};var Il=function(){this._index=new _s,this.init(arguments[0])};Il.prototype.init=function(l){for(var d=ko.getLines(l).iterator();d.hasNext();){var _=d.next().getCoordinates();this.addLine(_)}},Il.prototype.addLine=function(l){for(var d=1;d<l.length;d++){var _=new Yn(l[d-1],l[d]),b=Math.min(_.p0.y,_.p1.y),I=Math.max(_.p0.y,_.p1.y);this._index.insert(b,I,_)}},Il.prototype.query=function(){if(2===arguments.length){var l=arguments[0],d=arguments[1],_=new Rc;return this._index.query(l,d,_),_.getItems()}3===arguments.length&&this._index.query(arguments[0],arguments[1],arguments[2])},Il.prototype.interfaces_=function(){return[]},Il.prototype.getClass=function(){return Il};var Su=function(l){function d(){if(l.call(this),this._parentGeom=null,this._lineEdgeMap=new pd,this._boundaryNodeRule=null,this._useBoundaryDeterminationRule=!0,this._argIndex=null,this._boundaryNodes=null,this._hasTooFewPoints=!1,this._invalidPoint=null,this._areaPtLocator=null,this._ptLocator=new Ia,2===arguments.length){var b=arguments[1],I=ei.OGC_SFS_BOUNDARY_RULE;this._argIndex=arguments[0],this._parentGeom=b,this._boundaryNodeRule=I,null!==b&&this.add(b)}else if(3===arguments.length){var j=arguments[1],ne=arguments[2];this._argIndex=arguments[0],this._parentGeom=j,this._boundaryNodeRule=ne,null!==j&&this.add(j)}}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.insertBoundaryPoint=function(_,b){var I=this._nodes.addNode(b).getLabel(),N=1;I.getLocation(_,mn.ON)===xe.BOUNDARY&&N++;var j=d.determineBoundary(this._boundaryNodeRule,N);I.setLocation(_,j)},d.prototype.computeSelfNodes=function(){if(2===arguments.length)return this.computeSelfNodes(arguments[0],arguments[1],!1);if(3===arguments.length){var N=arguments[1],j=arguments[2],ne=new ms(arguments[0],!0,!1);return ne.setIsDoneIfProperInt(j),this.createEdgeSetIntersector().computeIntersections(this._edges,ne,N||!(this._parentGeom instanceof po||this._parentGeom instanceof Xn||this._parentGeom instanceof Rn)),this.addSelfIntersectionNodes(this._argIndex),ne}},d.prototype.computeSplitEdges=function(_){for(var b=this._edges.iterator();b.hasNext();)b.next().eiList.addSplitEdges(_)},d.prototype.computeEdgeIntersections=function(_,b,I){var N=new ms(b,I,!0);return N.setBoundaryNodes(this.getBoundaryNodes(),_.getBoundaryNodes()),this.createEdgeSetIntersector().computeIntersections(this._edges,_._edges,N),N},d.prototype.getGeometry=function(){return this._parentGeom},d.prototype.getBoundaryNodeRule=function(){return this._boundaryNodeRule},d.prototype.hasTooFewPoints=function(){return this._hasTooFewPoints},d.prototype.addPoint=function(){if(arguments[0]instanceof gn){var _=arguments[0].getCoordinate();this.insertPoint(this._argIndex,_,xe.INTERIOR)}else arguments[0]instanceof re&&this.insertPoint(this._argIndex,arguments[0],xe.INTERIOR)},d.prototype.addPolygon=function(_){this.addPolygonRing(_.getExteriorRing(),xe.EXTERIOR,xe.INTERIOR);for(var b=0;b<_.getNumInteriorRing();b++){var I=_.getInteriorRingN(b);this.addPolygonRing(I,xe.INTERIOR,xe.EXTERIOR)}},d.prototype.addEdge=function(_){this.insertEdge(_);var b=_.getCoordinates();this.insertPoint(this._argIndex,b[0],xe.BOUNDARY),this.insertPoint(this._argIndex,b[b.length-1],xe.BOUNDARY)},d.prototype.addLineString=function(_){var b=yr.removeRepeatedPoints(_.getCoordinates());if(b.length<2)return this._hasTooFewPoints=!0,this._invalidPoint=b[0],null;var I=new ra(b,new li(this._argIndex,xe.INTERIOR));this._lineEdgeMap.put(_,I),this.insertEdge(I),ae.isTrue(b.length>=2,"found LineString with single point"),this.insertBoundaryPoint(this._argIndex,b[0]),this.insertBoundaryPoint(this._argIndex,b[b.length-1])},d.prototype.getInvalidPoint=function(){return this._invalidPoint},d.prototype.getBoundaryPoints=function(){for(var _=this.getBoundaryNodes(),b=new Array(_.size()).fill(null),I=0,N=_.iterator();N.hasNext();){var j=N.next();b[I++]=j.getCoordinate().copy()}return b},d.prototype.getBoundaryNodes=function(){return null===this._boundaryNodes&&(this._boundaryNodes=this._nodes.getBoundaryNodes(this._argIndex)),this._boundaryNodes},d.prototype.addSelfIntersectionNode=function(_,b,I){if(this.isBoundaryNode(_,b))return null;I===xe.BOUNDARY&&this._useBoundaryDeterminationRule?this.insertBoundaryPoint(_,b):this.insertPoint(_,b,I)},d.prototype.addPolygonRing=function(_,b,I){if(_.isEmpty())return null;var N=yr.removeRepeatedPoints(_.getCoordinates());if(N.length<4)return this._hasTooFewPoints=!0,this._invalidPoint=N[0],null;var j=b,ne=I;wt.isCCW(N)&&(j=I,ne=b);var Ee=new ra(N,new li(this._argIndex,xe.BOUNDARY,j,ne));this._lineEdgeMap.put(_,Ee),this.insertEdge(Ee),this.insertPoint(this._argIndex,N[0],xe.BOUNDARY)},d.prototype.insertPoint=function(_,b,I){var N=this._nodes.addNode(b),j=N.getLabel();null===j?N._label=new li(_,I):j.setLocation(_,I)},d.prototype.createEdgeSetIntersector=function(){return new Bn},d.prototype.addSelfIntersectionNodes=function(_){for(var b=this._edges.iterator();b.hasNext();)for(var I=b.next(),N=I.getLabel().getLocation(_),j=I.eiList.iterator();j.hasNext();){var ne=j.next();this.addSelfIntersectionNode(_,ne.coord,N)}},d.prototype.add=function(){if(1!==arguments.length)return l.prototype.add.apply(this,arguments);var _=arguments[0];if(_.isEmpty())return null;if(_ instanceof Rn&&(this._useBoundaryDeterminationRule=!1),_ instanceof Xn)this.addPolygon(_);else if(_ instanceof vr)this.addLineString(_);else if(_ instanceof gn)this.addPoint(_);else if(_ instanceof wa)this.addCollection(_);else if(_ instanceof Vt)this.addCollection(_);else if(_ instanceof Rn)this.addCollection(_);else{if(!(_ instanceof tt))throw new Error(_.getClass().getName());this.addCollection(_)}},d.prototype.addCollection=function(_){for(var b=0;b<_.getNumGeometries();b++){var I=_.getGeometryN(b);this.add(I)}},d.prototype.locate=function(_){return Lt(this._parentGeom,Tr)&&this._parentGeom.getNumGeometries()>50?(null===this._areaPtLocator&&(this._areaPtLocator=new Ql(this._parentGeom)),this._areaPtLocator.locate(_)):this._ptLocator.locate(_,this._parentGeom)},d.prototype.findEdge=function(){return 1===arguments.length?this._lineEdgeMap.get(arguments[0]):l.prototype.findEdge.apply(this,arguments)},d.prototype.interfaces_=function(){return[]},d.prototype.getClass=function(){return d},d.determineBoundary=function(_,b){return _.isInBoundary(b)?xe.BOUNDARY:xe.INTERIOR},d}(Do),_c=function(){if(this._li=new Ot,this._resultPrecisionModel=null,this._arg=null,1===arguments.length){var l=arguments[0];this.setComputationPrecision(l.getPrecisionModel()),this._arg=new Array(1).fill(null),this._arg[0]=new Su(0,l)}else if(2===arguments.length){var d=arguments[0],_=arguments[1],b=ei.OGC_SFS_BOUNDARY_RULE;d.getPrecisionModel().compareTo(_.getPrecisionModel())>=0?this.setComputationPrecision(d.getPrecisionModel()):this.setComputationPrecision(_.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new Su(0,d,b),this._arg[1]=new Su(1,_,b)}else if(3===arguments.length){var I=arguments[0],N=arguments[1],j=arguments[2];I.getPrecisionModel().compareTo(N.getPrecisionModel())>=0?this.setComputationPrecision(I.getPrecisionModel()):this.setComputationPrecision(N.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new Su(0,I,j),this._arg[1]=new Su(1,N,j)}};_c.prototype.getArgGeometry=function(l){return this._arg[l].getGeometry()},_c.prototype.setComputationPrecision=function(l){this._resultPrecisionModel=l,this._li.setPrecisionModel(this._resultPrecisionModel)},_c.prototype.interfaces_=function(){return[]},_c.prototype.getClass=function(){return _c};var la=function(){};la.prototype.interfaces_=function(){return[]},la.prototype.getClass=function(){return la},la.map=function(){if(arguments[0]instanceof Qt&&Lt(arguments[1],la.MapOp)){for(var l=arguments[0],d=arguments[1],_=new ln,b=0;b<l.getNumGeometries();b++){var I=d.map(l.getGeometryN(b));null!==I&&_.add(I)}return l.getFactory().buildGeometry(_)}if(Lt(arguments[0],qi)&&Lt(arguments[1],la.MapOp)){for(var N=arguments[0],j=arguments[1],ne=new ln,Ee=N.iterator();Ee.hasNext();){var it=Ee.next(),Bt=j.map(it);null!==Bt&&ne.add(Bt)}return ne}},la.MapOp=function(){};var wr=function(l){function d(){var _=arguments[0];l.call(this,_,arguments[1]),this._ptLocator=new Ia,this._geomFact=null,this._resultGeom=null,this._graph=null,this._edgeList=new Zo,this._resultPolyList=new ln,this._resultLineList=new ln,this._resultPointList=new ln,this._graph=new Do(new Cl),this._geomFact=_.getFactory()}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.insertUniqueEdge=function(_){var b=this._edgeList.findEqualEdge(_);if(null!==b){var I=b.getLabel(),N=_.getLabel();b.isPointwiseEqual(_)||(N=new li(_.getLabel())).flip();var j=b.getDepth();j.isNull()&&j.add(I),j.add(N),I.merge(N)}else this._edgeList.add(_)},d.prototype.getGraph=function(){return this._graph},d.prototype.cancelDuplicateResultEdges=function(){for(var _=this._graph.getEdgeEnds().iterator();_.hasNext();){var b=_.next(),I=b.getSym();b.isInResult()&&I.isInResult()&&(b.setInResult(!1),I.setInResult(!1))}},d.prototype.isCoveredByLA=function(_){return!!this.isCovered(_,this._resultLineList)||!!this.isCovered(_,this._resultPolyList)},d.prototype.computeGeometry=function(_,b,I,N){var j=new ln;return j.addAll(_),j.addAll(b),j.addAll(I),j.isEmpty()?d.createEmptyResult(N,this._arg[0].getGeometry(),this._arg[1].getGeometry(),this._geomFact):this._geomFact.buildGeometry(j)},d.prototype.mergeSymLabels=function(){for(var _=this._graph.getNodes().iterator();_.hasNext();)_.next().getEdges().mergeSymLabels()},d.prototype.isCovered=function(_,b){for(var I=b.iterator();I.hasNext();){var N=I.next();if(this._ptLocator.locate(_,N)!==xe.EXTERIOR)return!0}return!1},d.prototype.replaceCollapsedEdges=function(){for(var _=new ln,b=this._edgeList.iterator();b.hasNext();){var I=b.next();I.isCollapsed()&&(b.remove(),_.add(I.getCollapsedEdge()))}this._edgeList.addAll(_)},d.prototype.updateNodeLabelling=function(){for(var _=this._graph.getNodes().iterator();_.hasNext();){var b=_.next(),I=b.getEdges().getLabel();b.getLabel().merge(I)}},d.prototype.getResultGeometry=function(_){return this.computeOverlay(_),this._resultGeom},d.prototype.insertUniqueEdges=function(_){for(var b=_.iterator();b.hasNext();){var I=b.next();this.insertUniqueEdge(I)}},d.prototype.computeOverlay=function(_){this.copyPoints(0),this.copyPoints(1),this._arg[0].computeSelfNodes(this._li,!1),this._arg[1].computeSelfNodes(this._li,!1),this._arg[0].computeEdgeIntersections(this._arg[1],this._li,!0);var b=new ln;this._arg[0].computeSplitEdges(b),this._arg[1].computeSplitEdges(b),this.insertUniqueEdges(b),this.computeLabelsFromDepths(),this.replaceCollapsedEdges(),Eu.checkValid(this._edgeList.getEdges()),this._graph.addEdges(this._edgeList.getEdges()),this.computeLabelling(),this.labelIncompleteNodes(),this.findResultAreaEdges(_),this.cancelDuplicateResultEdges();var I=new Ca(this._geomFact);I.add(this._graph),this._resultPolyList=I.getPolygons();var N=new Ua(this,this._geomFact,this._ptLocator);this._resultLineList=N.build(_);var j=new Lo(this,this._geomFact,this._ptLocator);this._resultPointList=j.build(_),this._resultGeom=this.computeGeometry(this._resultPointList,this._resultLineList,this._resultPolyList,_)},d.prototype.labelIncompleteNode=function(_,b){var I=this._ptLocator.locate(_.getCoordinate(),this._arg[b].getGeometry());_.getLabel().setLocation(b,I)},d.prototype.copyPoints=function(_){for(var b=this._arg[_].getNodeIterator();b.hasNext();){var I=b.next();this._graph.addNode(I.getCoordinate()).setLabel(_,I.getLabel().getLocation(_))}},d.prototype.findResultAreaEdges=function(_){for(var b=this._graph.getEdgeEnds().iterator();b.hasNext();){var I=b.next(),N=I.getLabel();N.isArea()&&!I.isInteriorAreaEdge()&&d.isResultOfOp(N.getLocation(0,mn.RIGHT),N.getLocation(1,mn.RIGHT),_)&&I.setInResult(!0)}},d.prototype.computeLabelsFromDepths=function(){for(var _=this._edgeList.iterator();_.hasNext();){var b=_.next(),I=b.getLabel(),N=b.getDepth();if(!N.isNull()){N.normalize();for(var j=0;j<2;j++)I.isNull(j)||!I.isArea()||N.isNull(j)||(0===N.getDelta(j)?I.toLine(j):(ae.isTrue(!N.isNull(j,mn.LEFT),"depth of LEFT side has not been initialized"),I.setLocation(j,mn.LEFT,N.getLocation(j,mn.LEFT)),ae.isTrue(!N.isNull(j,mn.RIGHT),"depth of RIGHT side has not been initialized"),I.setLocation(j,mn.RIGHT,N.getLocation(j,mn.RIGHT))))}}},d.prototype.computeLabelling=function(){for(var _=this._graph.getNodes().iterator();_.hasNext();)_.next().getEdges().computeLabelling(this._arg);this.mergeSymLabels(),this.updateNodeLabelling()},d.prototype.labelIncompleteNodes=function(){for(var _=this._graph.getNodes().iterator();_.hasNext();){var b=_.next(),I=b.getLabel();b.isIsolated()&&(I.isNull(0)?this.labelIncompleteNode(b,0):this.labelIncompleteNode(b,1)),b.getEdges().updateLabelling(I)}},d.prototype.isCoveredByA=function(_){return!!this.isCovered(_,this._resultPolyList)},d.prototype.interfaces_=function(){return[]},d.prototype.getClass=function(){return d},d}(_c);wr.overlayOp=function(l,d,_){return new wr(l,d).getResultGeometry(_)},wr.intersection=function(l,d){if(l.isEmpty()||d.isEmpty())return wr.createEmptyResult(wr.INTERSECTION,l,d,l.getFactory());if(l.isGeometryCollection()){var _=d;return dl.map(l,{interfaces_:function(){return[la.MapOp]},map:function(b){return b.intersection(_)}})}return l.checkNotGeometryCollection(l),l.checkNotGeometryCollection(d),Rs.overlayOp(l,d,wr.INTERSECTION)},wr.symDifference=function(l,d){if(l.isEmpty()||d.isEmpty()){if(l.isEmpty()&&d.isEmpty())return wr.createEmptyResult(wr.SYMDIFFERENCE,l,d,l.getFactory());if(l.isEmpty())return d.copy();if(d.isEmpty())return l.copy()}return l.checkNotGeometryCollection(l),l.checkNotGeometryCollection(d),Rs.overlayOp(l,d,wr.SYMDIFFERENCE)},wr.resultDimension=function(l,d,_){var b=d.getDimension(),I=_.getDimension(),N=-1;switch(l){case wr.INTERSECTION:N=Math.min(b,I);break;case wr.UNION:N=Math.max(b,I);break;case wr.DIFFERENCE:N=b;break;case wr.SYMDIFFERENCE:N=Math.max(b,I)}return N},wr.createEmptyResult=function(l,d,_,b){var I=null;switch(wr.resultDimension(l,d,_)){case-1:I=b.createGeometryCollection(new Array(0).fill(null));break;case 0:I=b.createPoint();break;case 1:I=b.createLineString();break;case 2:I=b.createPolygon()}return I},wr.difference=function(l,d){return l.isEmpty()?wr.createEmptyResult(wr.DIFFERENCE,l,d,l.getFactory()):d.isEmpty()?l.copy():(l.checkNotGeometryCollection(l),l.checkNotGeometryCollection(d),Rs.overlayOp(l,d,wr.DIFFERENCE))},wr.isResultOfOp=function(){if(2===arguments.length){var l=arguments[0],d=arguments[1],_=l.getLocation(0),b=l.getLocation(1);return wr.isResultOfOp(_,b,d)}if(3===arguments.length){var I=arguments[0],N=arguments[1];switch(I===xe.BOUNDARY&&(I=xe.INTERIOR),N===xe.BOUNDARY&&(N=xe.INTERIOR),arguments[2]){case wr.INTERSECTION:return I===xe.INTERIOR&&N===xe.INTERIOR;case wr.UNION:return I===xe.INTERIOR||N===xe.INTERIOR;case wr.DIFFERENCE:return I===xe.INTERIOR&&N!==xe.INTERIOR;case wr.SYMDIFFERENCE:return I===xe.INTERIOR&&N!==xe.INTERIOR||I!==xe.INTERIOR&&N===xe.INTERIOR}return!1}},wr.INTERSECTION=1,wr.UNION=2,wr.DIFFERENCE=3,wr.SYMDIFFERENCE=4;var Al=function(){this._g=null,this._boundaryDistanceTolerance=null,this._linework=null,this._ptLocator=new Ia,this._seg=new Yn;var l=arguments[0],d=arguments[1];this._g=l,this._boundaryDistanceTolerance=d,this._linework=this.extractLinework(l)};Al.prototype.isWithinToleranceOfBoundary=function(l){for(var d=0;d<this._linework.getNumGeometries();d++)for(var _=this._linework.getGeometryN(d).getCoordinateSequence(),b=0;b<_.size()-1;b++)if(_.getCoordinate(b,this._seg.p0),_.getCoordinate(b+1,this._seg.p1),this._seg.distance(l)<=this._boundaryDistanceTolerance)return!0;return!1},Al.prototype.getLocation=function(l){return this.isWithinToleranceOfBoundary(l)?xe.BOUNDARY:this._ptLocator.locate(l,this._g)},Al.prototype.extractLinework=function(l){var d=new Sr;l.apply(d);var _=d.getLinework(),b=fr.toLineStringArray(_);return l.getFactory().createMultiLineString(b)},Al.prototype.interfaces_=function(){return[]},Al.prototype.getClass=function(){return Al};var Sr=function(){this._linework=null,this._linework=new ln};Sr.prototype.getLinework=function(){return this._linework},Sr.prototype.filter=function(l){if(l instanceof Xn){var d=l;this._linework.add(d.getExteriorRing());for(var _=0;_<d.getNumInteriorRing();_++)this._linework.add(d.getInteriorRingN(_))}},Sr.prototype.interfaces_=function(){return[Wt]},Sr.prototype.getClass=function(){return Sr};var Mu=function(){this._g=null,this._doLeft=!0,this._doRight=!0,this._g=arguments[0]};Mu.prototype.extractPoints=function(l,d,_){for(var b=l.getCoordinates(),I=0;I<b.length-1;I++)this.computeOffsetPoints(b[I],b[I+1],d,_)},Mu.prototype.setSidesToGenerate=function(l,d){this._doLeft=l,this._doRight=d},Mu.prototype.getPoints=function(l){for(var d=new ln,_=ko.getLines(this._g).iterator();_.hasNext();){var b=_.next();this.extractPoints(b,l,d)}return d},Mu.prototype.computeOffsetPoints=function(l,d,_,b){var I=d.x-l.x,N=d.y-l.y,j=Math.sqrt(I*I+N*N),ne=_*I/j,Ee=_*N/j,it=(d.x+l.x)/2,Bt=(d.y+l.y)/2;if(this._doLeft){var zt=new re(it-Ee,Bt+ne);b.add(zt)}if(this._doRight){var vn=new re(it+Ee,Bt-ne);b.add(vn)}},Mu.prototype.interfaces_=function(){return[]},Mu.prototype.getClass=function(){return Mu};var Aa=function l(){this._geom=null,this._locFinder=null,this._location=new Array(3).fill(null),this._invalidLocation=null,this._boundaryDistanceTolerance=l.TOLERANCE,this._testCoords=new ln;var d=arguments[0],_=arguments[1],b=arguments[2];this._boundaryDistanceTolerance=l.computeBoundaryDistanceTolerance(d,_),this._geom=[d,_,b],this._locFinder=[new Al(this._geom[0],this._boundaryDistanceTolerance),new Al(this._geom[1],this._boundaryDistanceTolerance),new Al(this._geom[2],this._boundaryDistanceTolerance)]},zh={TOLERANCE:{configurable:!0}};Aa.prototype.reportResult=function(l,d,_){In.out.println("Overlay result invalid - A:"+xe.toLocationSymbol(d[0])+" B:"+xe.toLocationSymbol(d[1])+" expected:"+(_?"i":"e")+" actual:"+xe.toLocationSymbol(d[2]))},Aa.prototype.isValid=function(l){return this.addTestPts(this._geom[0]),this.addTestPts(this._geom[1]),this.checkValid(l)},Aa.prototype.checkValid=function(){if(1===arguments.length){for(var l=arguments[0],d=0;d<this._testCoords.size();d++){var _=this._testCoords.get(d);if(!this.checkValid(l,_))return this._invalidLocation=_,!1}return!0}if(2===arguments.length){var b=arguments[0],I=arguments[1];return this._location[0]=this._locFinder[0].getLocation(I),this._location[1]=this._locFinder[1].getLocation(I),this._location[2]=this._locFinder[2].getLocation(I),!!Aa.hasLocation(this._location,xe.BOUNDARY)||this.isValidResult(b,this._location)}},Aa.prototype.addTestPts=function(l){var d=new Mu(l);this._testCoords.addAll(d.getPoints(5*this._boundaryDistanceTolerance))},Aa.prototype.isValidResult=function(l,d){var _=wr.isResultOfOp(d[0],d[1],l),b=!(_^d[2]===xe.INTERIOR);return b||this.reportResult(l,d,_),b},Aa.prototype.getInvalidLocation=function(){return this._invalidLocation},Aa.prototype.interfaces_=function(){return[]},Aa.prototype.getClass=function(){return Aa},Aa.hasLocation=function(l,d){for(var _=0;_<3;_++)if(l[_]===d)return!0;return!1},Aa.computeBoundaryDistanceTolerance=function(l,d){return Math.min(Jo.computeSizeBasedSnapTolerance(l),Jo.computeSizeBasedSnapTolerance(d))},Aa.isValid=function(l,d,_,b){return new Aa(l,d,b).isValid(_)},zh.TOLERANCE.get=function(){return 1e-6},Object.defineProperties(Aa,zh);var ja=function l(d){this._geomFactory=null,this._skipEmpty=!1,this._inputGeoms=null,this._geomFactory=l.extractFactory(d),this._inputGeoms=d};ja.prototype.extractElements=function(l,d){if(null===l)return null;for(var _=0;_<l.getNumGeometries();_++){var b=l.getGeometryN(_);this._skipEmpty&&b.isEmpty()||d.add(b)}},ja.prototype.combine=function(){for(var l=new ln,d=this._inputGeoms.iterator();d.hasNext();){var _=d.next();this.extractElements(_,l)}return 0===l.size()?null!==this._geomFactory?this._geomFactory.createGeometryCollection(null):null:this._geomFactory.buildGeometry(l)},ja.prototype.interfaces_=function(){return[]},ja.prototype.getClass=function(){return ja},ja.combine=function(){return 1===arguments.length?new ja(arguments[0]).combine():2===arguments.length?new ja(ja.createList(arguments[0],arguments[1])).combine():3===arguments.length?new ja(ja.createList(arguments[0],arguments[1],arguments[2])).combine():void 0},ja.extractFactory=function(l){return l.isEmpty()?null:l.iterator().next().getFactory()},ja.createList=function(){if(2===arguments.length){var l=arguments[0],d=arguments[1],_=new ln;return _.add(l),_.add(d),_}if(3===arguments.length){var b=arguments[0],I=arguments[1],N=arguments[2],j=new ln;return j.add(b),j.add(I),j.add(N),j}};var Bo=function(){this._inputPolys=null,this._geomFactory=null,this._inputPolys=arguments[0],null===this._inputPolys&&(this._inputPolys=new ln)},nh={STRTREE_NODE_CAPACITY:{configurable:!0}};Bo.prototype.reduceToGeometries=function(l){for(var d=new ln,_=l.iterator();_.hasNext();){var b=_.next(),I=null;Lt(b,fo)?I=this.unionTree(b):b instanceof Qt&&(I=b),d.add(I)}return d},Bo.prototype.extractByEnvelope=function(l,d,_){for(var b=new ln,I=0;I<d.getNumGeometries();I++){var N=d.getGeometryN(I);N.getEnvelopeInternal().intersects(l)?b.add(N):_.add(N)}return this._geomFactory.buildGeometry(b)},Bo.prototype.unionOptimized=function(l,d){var _=l.getEnvelopeInternal(),b=d.getEnvelopeInternal();if(!_.intersects(b))return ja.combine(l,d);if(l.getNumGeometries()<=1&&d.getNumGeometries()<=1)return this.unionActual(l,d);var I=_.intersection(b);return this.unionUsingEnvelopeIntersection(l,d,I)},Bo.prototype.union=function(){if(null===this._inputPolys)throw new Error("union() method cannot be called twice");if(this._inputPolys.isEmpty())return null;this._geomFactory=this._inputPolys.iterator().next().getFactory();for(var l=new Lh(Bo.STRTREE_NODE_CAPACITY),d=this._inputPolys.iterator();d.hasNext();){var _=d.next();l.insert(_.getEnvelopeInternal(),_)}this._inputPolys=null;var b=l.itemsTree();return this.unionTree(b)},Bo.prototype.binaryUnion=function(){if(1===arguments.length){var l=arguments[0];return this.binaryUnion(l,0,l.size())}if(3===arguments.length){var d=arguments[0],_=arguments[1],b=arguments[2];if(b-_<=1){var I=Bo.getGeometry(d,_);return this.unionSafe(I,null)}if(b-_==2)return this.unionSafe(Bo.getGeometry(d,_),Bo.getGeometry(d,_+1));var N=Math.trunc((b+_)/2),j=this.binaryUnion(d,_,N),ne=this.binaryUnion(d,N,b);return this.unionSafe(j,ne)}},Bo.prototype.repeatedUnion=function(l){for(var d=null,_=l.iterator();_.hasNext();){var b=_.next();d=null===d?b.copy():d.union(b)}return d},Bo.prototype.unionSafe=function(l,d){return null===l&&null===d?null:null===l?d.copy():null===d?l.copy():this.unionOptimized(l,d)},Bo.prototype.unionActual=function(l,d){return Bo.restrictToPolygons(l.union(d))},Bo.prototype.unionTree=function(l){var d=this.reduceToGeometries(l);return this.binaryUnion(d)},Bo.prototype.unionUsingEnvelopeIntersection=function(l,d,_){var b=new ln,I=this.extractByEnvelope(_,l,b),N=this.extractByEnvelope(_,d,b),j=this.unionActual(I,N);return b.add(j),ja.combine(b)},Bo.prototype.bufferUnion=function(){if(1===arguments.length){var l=arguments[0];return l.get(0).getFactory().buildGeometry(l).buffer(0)}if(2===arguments.length){var d=arguments[0],_=arguments[1];return d.getFactory().createGeometryCollection([d,_]).buffer(0)}},Bo.prototype.interfaces_=function(){return[]},Bo.prototype.getClass=function(){return Bo},Bo.restrictToPolygons=function(l){if(Lt(l,Tr))return l;var d=Yl.getPolygons(l);return 1===d.size()?d.get(0):l.getFactory().createMultiPolygon(fr.toPolygonArray(d))},Bo.getGeometry=function(l,d){return d>=l.size()?null:l.get(d)},Bo.union=function(l){return new Bo(l).union()},nh.STRTREE_NODE_CAPACITY.get=function(){return 4},Object.defineProperties(Bo,nh);var rh=function(){};rh.prototype.interfaces_=function(){return[]},rh.prototype.getClass=function(){return rh},rh.union=function(l,d){if(l.isEmpty()||d.isEmpty()){if(l.isEmpty()&&d.isEmpty())return wr.createEmptyResult(wr.UNION,l,d,l.getFactory());if(l.isEmpty())return d.copy();if(d.isEmpty())return l.copy()}return l.checkNotGeometryCollection(l),l.checkNotGeometryCollection(d),Rs.overlayOp(l,d,wr.UNION)},Ue.GeoJSONReader=fc,Ue.GeoJSONWriter=mo,Ue.OverlayOp=wr,Ue.UnionOp=rh,Ue.BufferOp=Oo,Object.defineProperty(Ue,"__esModule",{value:!0})}(gt)},2400:(Zt,gt,Ue)=>{"use strict";var De=function(n,e){return(De=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])})(n,e)};function Be(n,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function t(){this.constructor=n}De(n,e),n.prototype=null===e?Object.create(e):(t.prototype=e.prototype,new t)}var pt=function(){return(pt=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function Qe(n,e){var r,i,o,s,t={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function u(g){return function(v){return function(g){if(r)throw new TypeError("Generator is already executing.");for(;t;)try{if(r=1,i&&(o=2&g[0]?i.return:g[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,g[1])).done)return o;switch(i=0,o&&(g=[2&g[0],o.value]),g[0]){case 0:case 1:o=g;break;case 4:return t.label++,{value:g[1],done:!1};case 5:t.label++,i=g[1],g=[0];continue;case 7:g=t.ops.pop(),t.trys.pop();continue;default:if(!(o=(o=t.trys).length>0&&o[o.length-1])&&(6===g[0]||2===g[0])){t=0;continue}if(3===g[0]&&(!o||g[1]>o[0]&&g[1]<o[3])){t.label=g[1];break}if(6===g[0]&&t.label<o[1]){t.label=o[1],o=g;break}if(o&&t.label<o[2]){t.label=o[2],t.ops.push(g);break}o[2]&&t.ops.pop(),t.trys.pop();continue}g=e.call(n,t)}catch(v){g=[6,v],i=0}finally{r=o=0}if(5&g[0])throw g[1];return{value:g[0]?g[1]:void 0,done:!0}}([g,v])}}}function vt(n){var e="function"==typeof Symbol&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&"number"==typeof n.length)return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function At(n,e){var t="function"==typeof Symbol&&n[Symbol.iterator];if(!t)return n;var i,s,r=t.call(n),o=[];try{for(;(void 0===e||e-- >0)&&!(i=r.next()).done;)o.push(i.value)}catch(u){s={error:u}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(s)throw s.error}}return o}function Se(n,e){for(var t=0,r=e.length,i=n.length;t<r;t++,i++)n[i]=e[t];return n}function ue(n){return this instanceof ue?(this.v=n,this):new ue(n)}function pe(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,r=t.apply(n,e||[]),o=[];return i={},s("next"),s("throw"),s("return"),i[Symbol.asyncIterator]=function(){return this},i;function s(T){r[T]&&(i[T]=function(R){return new Promise(function(B,z){o.push([T,R,B,z])>1||u(T,R)})})}function u(T,R){try{!function(T){T.value instanceof ue?Promise.resolve(T.value.v).then(g,v):E(o[0][2],T)}(r[T](R))}catch(B){E(o[0][3],B)}}function g(T){u("next",T)}function v(T){u("throw",T)}function E(T,R){T(R),o.shift(),o.length&&u(o[0][0],o[0][1])}}function Oe(n){return"function"==typeof n}function xe(n){var t=n(function(r){Error.call(r),r.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var jt=xe(function(n){return function(t){n(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map(function(r,i){return i+1+") "+r.toString()}).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t}});function Lt(n,e){if(n){var t=n.indexOf(e);0<=t&&n.splice(t,1)}}var Ce=function(){function n(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._teardowns=null}return n.prototype.unsubscribe=function(){var e,t,r,i,o;if(!this.closed){this.closed=!0;var s=this._parentage;if(s)if(this._parentage=null,Array.isArray(s))try{for(var u=vt(s),f=u.next();!f.done;f=u.next())f.value.remove(this)}catch(z){e={error:z}}finally{try{f&&!f.done&&(t=u.return)&&t.call(u)}finally{if(e)throw e.error}}else s.remove(this);var v=this.initialTeardown;if(Oe(v))try{v()}catch(z){o=z instanceof jt?z.errors:[z]}var E=this._teardowns;if(E){this._teardowns=null;try{for(var T=vt(E),R=T.next();!R.done;R=T.next()){var B=R.value;try{lt(B)}catch(z){o=null!=o?o:[],z instanceof jt?o=Se(Se([],At(o)),At(z.errors)):o.push(z)}}}catch(z){r={error:z}}finally{try{R&&!R.done&&(i=T.return)&&i.call(T)}finally{if(r)throw r.error}}}if(o)throw new jt(o)}},n.prototype.add=function(e){var t;if(e&&e!==this)if(this.closed)lt(e);else{if(e instanceof n){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._teardowns=null!==(t=this._teardowns)&&void 0!==t?t:[]).push(e)}},n.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},n.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},n.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&Lt(t,e)},n.prototype.remove=function(e){var t=this._teardowns;t&&Lt(t,e),e instanceof n&&e._removeParent(this)},n.EMPTY=((e=new n).closed=!0,e),n;var e}(),ht=Ce.EMPTY;function Pe(n){return n instanceof Ce||n&&"closed"in n&&Oe(n.remove)&&Oe(n.add)&&Oe(n.unsubscribe)}function lt(n){Oe(n)?n():n.unsubscribe()}var Me={setTimeout:function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var t=Me.delegate;return((null==t?void 0:t.setTimeout)||setTimeout).apply(void 0,Se([],At(n)))},clearTimeout:function(n){var e=Me.delegate;return((null==e?void 0:e.clearTimeout)||clearTimeout)(n)},delegate:void 0};function Ft(n){Me.setTimeout(function(){throw n})}function Ut(){}var Sn=hr("C",void 0,void 0);function hr(n,e,t){return{kind:n,value:e,error:t}}function In(n){n()}var rn=function(n){function e(t){var r=n.call(this)||this;return r.isStopped=!1,t?(r.destination=t,Pe(t)&&t.add(r)):r.destination=eo,r}return Be(e,n),e.create=function(t,r,i){return new hi(t,r,i)},e.prototype.next=function(t){this.isStopped?Qr(function(n){return hr("N",n,void 0)}(t),this):this._next(t)},e.prototype.error=function(t){this.isStopped?Qr(function(n){return hr("E",void 0,n)}(t),this):(this.isStopped=!0,this._error(t))},e.prototype.complete=function(){this.isStopped?Qr(Sn,this):(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,n.prototype.unsubscribe.call(this),this.destination=null)},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){try{this.destination.error(t)}finally{this.unsubscribe()}},e.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},e}(Ce),hi=function(n){function e(t,r,i){var s,o=n.call(this)||this;if(Oe(t))s=t;else if(t){var u;r=t.error,i=t.complete,u=t,s=null==(s=t.next)?void 0:s.bind(u),r=null==r?void 0:r.bind(u),i=null==i?void 0:i.bind(u)}return o.destination={next:s?nr(s):Ut,error:nr(null!=r?r:ai),complete:i?nr(i):Ut},o}return Be(e,n),e}(rn);function nr(n,e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];try{n.apply(void 0,Se([],At(t)))}catch(i){Ft(i)}}}function ai(n){throw n}function Qr(n,e){var t=null;t&&Me.setTimeout(function(){return t(n,e)})}var eo={closed:!0,next:Ut,error:ai,complete:Ut},_t="function"==typeof Symbol&&Symbol.observable||"@@observable";function ve(n){return n}function ae(n){return 0===n.length?ve:1===n.length?n[0]:function(t){return n.reduce(function(r,i){return i(r)},t)}}var Ie=function(){function n(e){e&&(this._subscribe=e)}return n.prototype.lift=function(e){var t=new n;return t.source=this,t.operator=e,t},n.prototype.subscribe=function(e,t,r){var i=this,o=function(n){return n&&n instanceof rn||function(n){return n&&Oe(n.next)&&Oe(n.error)&&Oe(n.complete)}(n)&&Pe(n)}(e)?e:new hi(e,t,r);return In(function(){var u=i.operator,f=i.source;o.add(u?u.call(o,f):f?i._subscribe(o):i._trySubscribe(o))}),o},n.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},n.prototype.forEach=function(e,t){var r=this;return new(t=ct(t))(function(i,o){var s;s=r.subscribe(function(u){try{e(u)}catch(f){o(f),null==s||s.unsubscribe()}},o,i)})},n.prototype._subscribe=function(e){var t;return null===(t=this.source)||void 0===t?void 0:t.subscribe(e)},n.prototype[_t]=function(){return this},n.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return ae(e)(this)},n.prototype.toPromise=function(e){var t=this;return new(e=ct(e))(function(r,i){var o;t.subscribe(function(s){return o=s},function(s){return i(s)},function(){return r(o)})})},n.create=function(e){return new n(e)},n}();function ct(n){var e;return null!==(e=null!=n?n:undefined)&&void 0!==e?e:Promise}var Yt=xe(function(n){return function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),wt=function(n){function e(){var t=n.call(this)||this;return t.closed=!1,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return Be(e,n),e.prototype.lift=function(t){var r=new Qn(this,this);return r.operator=t,r},e.prototype._throwIfClosed=function(){if(this.closed)throw new Yt},e.prototype.next=function(t){var r=this;In(function(){var i,o;if(r._throwIfClosed(),!r.isStopped){var s=r.observers.slice();try{for(var u=vt(s),f=u.next();!f.done;f=u.next())f.value.next(t)}catch(v){i={error:v}}finally{try{f&&!f.done&&(o=u.return)&&o.call(u)}finally{if(i)throw i.error}}}})},e.prototype.error=function(t){var r=this;In(function(){if(r._throwIfClosed(),!r.isStopped){r.hasError=r.isStopped=!0,r.thrownError=t;for(var i=r.observers;i.length;)i.shift().error(t)}})},e.prototype.complete=function(){var t=this;In(function(){if(t._throwIfClosed(),!t.isStopped){t.isStopped=!0;for(var r=t.observers;r.length;)r.shift().complete()}})},e.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=null},Object.defineProperty(e.prototype,"observed",{get:function(){var t;return(null===(t=this.observers)||void 0===t?void 0:t.length)>0},enumerable:!1,configurable:!0}),e.prototype._trySubscribe=function(t){return this._throwIfClosed(),n.prototype._trySubscribe.call(this,t)},e.prototype._subscribe=function(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)},e.prototype._innerSubscribe=function(t){var r=this,s=r.observers;return r.hasError||r.isStopped?ht:(s.push(t),new Ce(function(){return Lt(s,t)}))},e.prototype._checkFinalizedStatuses=function(t){var r=this,s=r.isStopped;r.hasError?t.error(r.thrownError):s&&t.complete()},e.prototype.asObservable=function(){var t=new Ie;return t.source=this,t},e.create=function(t,r){return new Qn(t,r)},e}(Ie),Qn=function(n){function e(t,r){var i=n.call(this)||this;return i.destination=t,i.source=r,i}return Be(e,n),e.prototype.next=function(t){var r,i;null===(i=null===(r=this.destination)||void 0===r?void 0:r.next)||void 0===i||i.call(r,t)},e.prototype.error=function(t){var r,i;null===(i=null===(r=this.destination)||void 0===r?void 0:r.error)||void 0===i||i.call(r,t)},e.prototype.complete=function(){var t,r;null===(r=null===(t=this.destination)||void 0===t?void 0:t.complete)||void 0===r||r.call(t)},e.prototype._subscribe=function(t){var r,i;return null!==(i=null===(r=this.source)||void 0===r?void 0:r.subscribe(t))&&void 0!==i?i:ht},e}(wt);function Er(n){return Oe(null==n?void 0:n.lift)}function Qt(n){return function(e){if(Er(e))return e.lift(function(t){try{return n(t,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}var jn=function(n){function e(t,r,i,o,s){var u=n.call(this,t)||this;return u.onFinalize=s,u._next=r?function(f){try{r(f)}catch(g){t.error(g)}}:n.prototype._next,u._error=o?function(f){try{o(f)}catch(g){t.error(g)}finally{this.unsubscribe()}}:n.prototype._error,u._complete=i?function(){try{i()}catch(f){t.error(f)}finally{this.unsubscribe()}}:n.prototype._complete,u}return Be(e,n),e.prototype.unsubscribe=function(){var t,r=this.closed;n.prototype.unsubscribe.call(this),!r&&(null===(t=this.onFinalize)||void 0===t||t.call(this))},e}(rn);function ar(n,e){return Qt(function(t,r){var i=0;t.subscribe(new jn(r,function(o){r.next(n.call(e,o,i++))}))})}var Vr=function(n){return n&&"number"==typeof n.length&&"function"!=typeof n};function ei(n){return Oe(null==n?void 0:n.then)}function jo(n,e){return new Ie(function(t){var r=0;return e.schedule(function(){r===n.length?t.complete():(t.next(n[r++]),t.closed||this.schedule())})})}var Xo="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator";function fo(n,e){if(!n)throw new Error("Iterable cannot be null");return new Ie(function(t){var r=new Ce;return r.add(e.schedule(function(){var i=n[Symbol.asyncIterator]();r.add(e.schedule(function(){var o=this;i.next().then(function(s){s.done?t.complete():(t.next(s.value),o.schedule())})}))})),r})}function ln(n){return Oe(n[_t])}function al(n){return Oe(null==n?void 0:n[Xo])}function Fs(n){return Symbol.asyncIterator&&Oe(null==n?void 0:n[Symbol.asyncIterator])}function yr(n){return new TypeError("You provided "+(null!==n&&"object"==typeof n?"an invalid object":"'"+n+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function Bs(n){return pe(this,arguments,function(){var t,r,i;return Qe(this,function(s){switch(s.label){case 0:t=n.getReader(),s.label=1;case 1:s.trys.push([1,,9,10]),s.label=2;case 2:return[4,ue(t.read())];case 3:return r=s.sent(),i=r.value,r.done?[4,ue(void 0)]:[3,5];case 4:return[2,s.sent()];case 5:return[4,ue(i)];case 6:return[4,s.sent()];case 7:return s.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}})})}function Re(n){return Oe(null==n?void 0:n.getReader)}function Ae(n,e){return e?function(n,e){if(null!=n){if(ln(n))return function(n,e){return new Ie(function(t){var r=new Ce;return r.add(e.schedule(function(){var i=n[_t]();r.add(i.subscribe({next:function(o){r.add(e.schedule(function(){return t.next(o)}))},error:function(o){r.add(e.schedule(function(){return t.error(o)}))},complete:function(){r.add(e.schedule(function(){return t.complete()}))}}))})),r})}(n,e);if(Vr(n))return jo(n,e);if(ei(n))return function(n,e){return new Ie(function(t){return e.schedule(function(){return n.then(function(r){t.add(e.schedule(function(){t.next(r),t.add(e.schedule(function(){return t.complete()}))}))},function(r){t.add(e.schedule(function(){return t.error(r)}))})})})}(n,e);if(Fs(n))return fo(n,e);if(al(n))return function(n,e){return new Ie(function(t){var r;return t.add(e.schedule(function(){r=n[Xo](),function(n,e,t,r){void 0===r&&(r=0);var i=e.schedule(function(){try{t.call(this)}catch(o){n.error(o)}},r);n.add(i)}(t,e,function(){var i=r.next(),o=i.value;i.done?t.complete():(t.next(o),this.schedule())})})),function(){return Oe(null==r?void 0:r.return)&&r.return()}})}(n,e);if(Re(n))return function(n,e){return fo(Bs(n),e)}(n,e)}throw yr(n)}(n,e):je(n)}function je(n){if(n instanceof Ie)return n;if(null!=n){if(ln(n))return function(n){return new Ie(function(e){var t=n[_t]();if(Oe(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(n);if(Vr(n))return bt(n);if(ei(n))return function(n){return new Ie(function(e){n.then(function(t){e.closed||(e.next(t),e.complete())},function(t){return e.error(t)}).then(null,Ft)})}(n);if(Fs(n))return Et(n);if(al(n))return function(n){return new Ie(function(e){var t,r;try{for(var i=vt(n),o=i.next();!o.done;o=i.next())if(e.next(o.value),e.closed)return}catch(u){t={error:u}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}e.complete()})}(n);if(Re(n))return function(n){return Et(Bs(n))}(n)}throw yr(n)}function bt(n){return new Ie(function(e){for(var t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}function Et(n){return new Ie(function(e){(function(n,e){var t,r,i,o;return function(n,e,t,r){return new(t||(t=Promise))(function(o,s){function u(v){try{g(r.next(v))}catch(E){s(E)}}function f(v){try{g(r.throw(v))}catch(E){s(E)}}function g(v){v.done?o(v.value):function(o){return o instanceof t?o:new t(function(s){s(o)})}(v.value).then(u,f)}g((r=r.apply(n,e||[])).next())})}(this,void 0,void 0,function(){var u;return Qe(this,function(f){switch(f.label){case 0:f.trys.push([0,5,6,11]),t=function(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,e=n[Symbol.asyncIterator];return e?e.call(n):(n=vt(n),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(o){t[o]=n[o]&&function(s){return new Promise(function(u,f){!function(o,s,u,f){Promise.resolve(f).then(function(g){o({value:g,done:u})},s)}(u,f,(s=n[o](s)).done,s.value)})}}}(n),f.label=1;case 1:return[4,t.next()];case 2:if((r=f.sent()).done)return[3,4];if(e.next(r.value),e.closed)return[2];f.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return u=f.sent(),i={error:u},[3,11];case 6:return f.trys.push([6,,9,10]),r&&!r.done&&(o=t.return)?[4,o.call(t)]:[3,8];case 7:f.sent(),f.label=8;case 8:return[3,10];case 9:if(i)throw i.error;return[7];case 10:return[7];case 11:return e.complete(),[2]}})})})(n,e).catch(function(t){return e.error(t)})})}function bn(n,e,t){return void 0===t&&(t=1/0),Oe(e)?bn(function(r,i){return ar(function(o,s){return e(r,o,i,s)})(je(n(r,i)))},t):("number"==typeof e&&(t=e),Qt(function(r,i){return function(n,e,t,r,i,o,s,u){var f=[],g=0,v=0,E=!1,T=function(){E&&!f.length&&!g&&e.complete()},R=function(z){return g<r?B(z):f.push(z)},B=function(z){g++;var G=!1;je(t(z,v++)).subscribe(new jn(e,function(W){e.next(W)},function(){G=!0},void 0,function(){if(G)try{g--;for(;f.length&&g<r;)H=void 0,H=f.shift(),B(H);T()}catch(H){e.error(H)}var H}))};return n.subscribe(new jn(e,R,function(){E=!0,T()})),function(){}}(r,i,n,t)}))}function tt(n){return void 0===n&&(n=1/0),bn(ve,n)}function Vt(n,e){return e?jo(n,e):bt(n)}var Wn=new Ie(function(n){return n.complete()});function oi(n){return n&&Oe(n.schedule)}function ir(n){return n[n.length-1]}function vr(n){return Oe(ir(n))?n.pop():void 0}function ba(n){return oi(ir(n))?n.pop():void 0}function gn(n,e){return"number"==typeof ir(n)?n.pop():e}function Tr(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var t=ba(n),r=gn(n,1/0),i=n;return i.length?1===i.length?je(i[0]):tt(r)(Vt(i,t)):Wn}function Xn(n){return n<=0?function(){return Wn}:Qt(function(e,t){var r=0;e.subscribe(new jn(t,function(i){++r<=n&&(t.next(i),n<=r&&t.complete())}))})}function wa(n){void 0===n&&(n={});var e=n.connector,t=void 0===e?function(){return new wt}:e,r=n.resetOnError,i=void 0===r||r,o=n.resetOnComplete,s=void 0===o||o,u=n.resetOnRefCountZero,f=void 0===u||u;return function(g){var v=null,E=null,T=null,R=0,B=!1,z=!1,G=function(){null==E||E.unsubscribe(),E=null},W=function(){G(),v=T=null,B=z=!1},H=function(){var ee=v;W(),null==ee||ee.unsubscribe()};return Qt(function(ee,_e){R++,!z&&!B&&G();var ye=T=null!=T?T:t();_e.add(function(){0==--R&&!z&&!B&&(E=po(H,f))}),ye.subscribe(_e),v||(v=new hi({next:function($e){return ye.next($e)},error:function($e){z=!0,G(),E=po(W,i,$e),ye.error($e)},complete:function(){B=!0,G(),E=po(W,s),ye.complete()}}),Ae(ee).subscribe(v))})(g)}}function po(n,e){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];return!0===e?(n(),null):!1===e?null:e.apply(void 0,Se([],At(t))).pipe(Xn(1)).subscribe(function(){return n()})}function Rn(n){for(let e in n)if(n[e]===Rn)return e;throw Error("Could not find renamed property on target object.")}function Js(n,e){for(const t in e)e.hasOwnProperty(t)&&!n.hasOwnProperty(t)&&(n[t]=e[t])}function Nr(n){if("string"==typeof n)return n;if(Array.isArray(n))return"["+n.map(Nr).join(", ")+"]";if(null==n)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const e=n.toString();if(null==e)return""+e;const t=e.indexOf("\n");return-1===t?e:e.substring(0,t)}function Gl(n,e){return null==n||""===n?null===e?"":e:null==e||""===e?n:n+" "+e}const Ea=Rn({__forward_ref__:Rn});function _r(n){return n.__forward_ref__=_r,n.toString=function(){return Nr(this())},n}function Ln(n){return wu(n)?n():n}function wu(n){return"function"==typeof n&&n.hasOwnProperty(Ea)&&n.__forward_ref__===_r}class Qs extends Error{constructor(e,t){super(function(n,e){return`${n?`NG0${n}: `:""}${e}`}(e,t)),this.code=e}}function Nn(n){return"string"==typeof n?n:null==n?"":String(n)}function go(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():Nn(n)}function Oh(n,e){const t=e?` in ${e}`:"";throw new Qs("201",`No provider for ${go(n)} found${t}`)}function Pr(n,e){null==n&&function(n,e,t,r){throw new Error(`ASSERTION ERROR: ${n}`+(null==r?"":` [Expected=> ${t} ${r} ${e} <=Actual]`))}(e,n,null,"!=")}function Dn(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function Gr(n){return{providers:n.providers||[],imports:n.imports||[]}}function so(n){return kh(n,zs)||kh(n,bl)}function kh(n,e){return n.hasOwnProperty(e)?n[e]:null}function Ca(n){return n&&(n.hasOwnProperty(Sa)||n.hasOwnProperty(wl))?n[Sa]:null}const zs=Rn({\u0275prov:Rn}),Sa=Rn({\u0275inj:Rn}),bl=Rn({ngInjectableDef:Rn}),wl=Rn({ngInjectorDef:Rn});var or=(()=>((or=or||{})[or.Default=0]="Default",or[or.Host=1]="Host",or[or.Self=2]="Self",or[or.SkipSelf=4]="SkipSelf",or[or.Optional=8]="Optional",or))();let Xi;function ss(n){const e=Xi;return Xi=n,e}function ur(n,e,t){const r=so(n);return r&&"root"==r.providedIn?void 0===r.value?r.value=r.factory():r.value:t&or.Optional?null:void 0!==e?e:void Oh(Nr(n),"Injector")}function ll(n){return{toString:n}.toString()}var ul=(()=>((ul=ul||{})[ul.OnPush=0]="OnPush",ul[ul.Default=1]="Default",ul))(),xr=(()=>((xr=xr||{})[xr.Emulated=0]="Emulated",xr[xr.None=2]="None",xr[xr.ShadowDom=3]="ShadowDom",xr))();const Ts="undefined"!=typeof globalThis&&globalThis,Wl="undefined"!=typeof window&&window,Vs="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,pc="undefined"!=typeof global&&global,jr=Ts||pc||Wl||Vs,Yn={},ro=[],au=Rn({\u0275cmp:Rn}),Ds=Rn({\u0275dir:Rn}),Ma=Rn({\u0275pipe:Rn}),lu=Rn({\u0275mod:Rn}),Jc=Rn({\u0275loc:Rn}),Xl=Rn({\u0275fac:Rn}),uu=Rn({__NG_ELEMENT_ID__:Rn});let Yr=0;function ao(n){return ll(()=>{const t={},r={type:n.type,providersResolver:null,decls:n.decls,vars:n.vars,factory:null,template:n.template||null,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:t,inputs:null,outputs:null,exportAs:n.exportAs||null,onPush:n.changeDetection===ul.OnPush,directiveDefs:null,pipeDefs:null,selectors:n.selectors||ro,viewQuery:n.viewQuery||null,features:n.features||null,data:n.data||{},encapsulation:n.encapsulation||xr.Emulated,id:"c",styles:n.styles||ro,_:null,setInput:null,schemas:n.schemas||null,tView:null},i=n.directives,o=n.features,s=n.pipes;return r.id+=Yr++,r.inputs=_i(n.inputs,t),r.outputs=_i(n.outputs),o&&o.forEach(u=>u(r)),r.directiveDefs=i?()=>("function"==typeof i?i():i).map(gc):null,r.pipeDefs=s?()=>("function"==typeof s?s():s).map(ta):null,r})}function gc(n){return Yo(n)||function(n){return n[Ds]||null}(n)}function ta(n){return function(n){return n[Ma]||null}(n)}const Ac={};function Gn(n){return ll(()=>{const e={type:n.type,bootstrap:n.bootstrap||ro,declarations:n.declarations||ro,imports:n.imports||ro,exports:n.exports||ro,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null};return null!=n.id&&(Ac[n.id]=n.type),e})}function _i(n,e){if(null==n)return Yn;const t={};for(const r in n)if(n.hasOwnProperty(r)){let i=n[r],o=i;Array.isArray(i)&&(o=i[1],i=i[0]),t[i]=r,e&&(e[i]=o)}return t}const Fn=ao;function Yi(n){return{type:n.type,name:n.name,factory:null,pure:!1!==n.pure,onDestroy:n.type.prototype.ngOnDestroy||null}}function Yo(n){return n[au]||null}function Cr(n,e){const t=n[lu]||null;if(!t&&!0===e)throw new Error(`Type ${Nr(n)} does not have '\u0275mod' property.`);return t}function ga(n){return Array.isArray(n)&&"object"==typeof n[1]}function xo(n){return Array.isArray(n)&&!0===n[1]}function ma(n){return 0!=(8&n.flags)}function _a(n){return 2==(2&n.flags)}function Da(n){return 1==(1&n.flags)}function js(n){return null!==n.template}function fu(n){return 0!=(512&n[2])}function dl(n,e){return n.hasOwnProperty(Xl)?n[Xl]:null}class Ua{constructor(e,t,r){this.previousValue=e,this.currentValue=t,this.firstChange=r}isFirstChange(){return this.firstChange}}function Lo(){return oa}function oa(n){return n.type.prototype.ngOnChanges&&(n.setInput=Jo),No}function No(){const n=Fh(this),e=null==n?void 0:n.current;if(e){const t=n.previous;if(t===Yn)n.previous=e;else for(let r in e)t[r]=e[r];n.current=null,this.ngOnChanges(e)}}function Jo(n,e,t,r){const i=Fh(n)||function(n,e){return n[Kl]=e}(n,{previous:Yn,current:null}),o=i.current||(i.current={}),s=i.previous,u=this.declaredInputs[t],f=s[u];o[u]=new Ua(f&&f.currentValue,e,s===Yn),n[r]=e}Lo.ngInherit=!0;const Kl="__ngSimpleChanges__";function Fh(n){return n[Kl]||null}let Rs;function Go(n){return!!n.listen}const Bn={createRenderer:(n,e)=>void 0!==Rs?Rs:"undefined"!=typeof document?document:void 0};function Cs(n){for(;Array.isArray(n);)n=n[0];return n}function Bh(n,e){return Cs(e[n])}function _s(n,e){return Cs(e[n.index])}function Ql(n,e){return n.data[e]}function aa(n,e){const t=e[n];return ga(t)?t:t[0]}function Il(n){return 4==(4&n[2])}function Su(n){return 128==(128&n[2])}function la(n,e){return null==e?null:n[e]}function wr(n){n[18]=0}function Al(n,e){n[5]+=e;let t=n,r=n[3];for(;null!==r&&(1===e&&1===t[5]||-1===e&&0===t[5]);)r[5]+=e,t=r,r=r[3]}const Sr={lFrame:Fe(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function Bo(){return Sr.bindingsEnabled}function l(){return Sr.lFrame.lView}function d(){return Sr.lFrame.tView}function _(n){return Sr.lFrame.contextLView=n,n[8]}function b(){let n=I();for(;null!==n&&64===n.type;)n=n.parent;return n}function I(){return Sr.lFrame.currentTNode}function j(n,e){const t=Sr.lFrame;t.currentTNode=n,t.isParent=e}function ne(){return Sr.lFrame.isParent}function Ee(){Sr.lFrame.isParent=!1}function zt(){return Sr.isInCheckNoChangesMode}function vn(n){Sr.isInCheckNoChangesMode=n}function pn(){const n=Sr.lFrame;let e=n.bindingRootIndex;return-1===e&&(e=n.bindingRootIndex=n.tView.bindingStartIndex),e}function C(){return Sr.lFrame.bindingIndex++}function P(n,e){const t=Sr.lFrame;t.bindingIndex=t.bindingRootIndex=n,F(e)}function F(n){Sr.lFrame.currentDirectiveIndex=n}function U(n){const e=Sr.lFrame.currentDirectiveIndex;return-1===e?null:n[e]}function q(){return Sr.lFrame.currentQueryIndex}function Y(n){Sr.lFrame.currentQueryIndex=n}function te(n){const e=n[1];return 2===e.type?e.declTNode:1===e.type?n[6]:null}function ie(n,e,t){if(t&or.SkipSelf){let i=e,o=n;for(;!(i=i.parent,null!==i||t&or.Host||(i=te(o),null===i||(o=o[15],10&i.type))););if(null===i)return!1;e=i,n=o}const r=Sr.lFrame=we();return r.currentTNode=e,r.lView=n,!0}function se(n){const e=we(),t=n[1];Sr.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function we(){const n=Sr.lFrame,e=null===n?null:n.child;return null===e?Fe(n):e}function Fe(n){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=e),e}function Ve(){const n=Sr.lFrame;return Sr.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const nt=Ve;function Te(){const n=Ve();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function ot(){return Sr.lFrame.selectedIndex}function Xe(n){Sr.lFrame.selectedIndex=n}function Ye(){const n=Sr.lFrame;return Ql(n.tView,n.selectedIndex)}function Kn(n,e){for(let t=e.directiveStart,r=e.directiveEnd;t<r;t++){const o=n.data[t].type.prototype,{ngAfterContentInit:s,ngAfterContentChecked:u,ngAfterViewInit:f,ngAfterViewChecked:g,ngOnDestroy:v}=o;s&&(n.contentHooks||(n.contentHooks=[])).push(-t,s),u&&((n.contentHooks||(n.contentHooks=[])).push(t,u),(n.contentCheckHooks||(n.contentCheckHooks=[])).push(t,u)),f&&(n.viewHooks||(n.viewHooks=[])).push(-t,f),g&&((n.viewHooks||(n.viewHooks=[])).push(t,g),(n.viewCheckHooks||(n.viewCheckHooks=[])).push(t,g)),null!=v&&(n.destroyHooks||(n.destroyHooks=[])).push(t,v)}}function En(n,e,t){pr(n,e,3,t)}function wn(n,e,t,r){(3&n[2])===t&&pr(n,e,t,r)}function Ir(n,e){let t=n[2];(3&t)===e&&(t&=2047,t+=1,n[2]=t)}function pr(n,e,t,r){const o=null!=r?r:-1,s=e.length-1;let u=0;for(let f=void 0!==r?65535&n[18]:0;f<s;f++)if("number"==typeof e[f+1]){if(u=e[f],null!=r&&u>=r)break}else e[f]<0&&(n[18]+=65536),(u<o||-1==o)&&(gi(n,t,e,f),n[18]=(4294901760&n[18])+f+2),f++}function gi(n,e,t,r){const i=t[r]<0,o=t[r+1],u=n[i?-t[r]:t[r]];if(i){if(n[2]>>11<n[18]>>16&&(3&n[2])===e){n[2]+=2048;try{o.call(u)}finally{}}}else try{o.call(u)}finally{}}class uo{constructor(e,t,r){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=r}}function ts(n,e,t){const r=Go(n);let i=0;for(;i<t.length;){const o=t[i];if("number"==typeof o){if(0!==o)break;i++;const s=t[i++],u=t[i++],f=t[i++];r?n.setAttribute(e,u,f,s):e.setAttributeNS(s,u,f)}else{const s=o,u=t[++i];ui(s)?r&&n.setProperty(e,s,u):r?n.setAttribute(e,s,u):e.setAttribute(s,u),i++}}return i}function ns(n){return 3===n||4===n||6===n}function ui(n){return 64===n.charCodeAt(0)}function ys(n,e){if(null!==e&&0!==e.length)if(null===n||0===n.length)n=e.slice();else{let t=-1;for(let r=0;r<e.length;r++){const i=e[r];"number"==typeof i?t=i:0===t||Ga(n,t,i,null,-1===t||2===t?e[++r]:null)}}return n}function Ga(n,e,t,r,i){let o=0,s=n.length;if(-1===e)s=-1;else for(;o<n.length;){const u=n[o++];if("number"==typeof u){if(u===e){s=-1;break}if(u>e){s=o-1;break}}}for(;o<n.length;){const u=n[o];if("number"==typeof u)break;if(u===t){if(null===r)return void(null!==i&&(n[o+1]=i));if(r===n[o+1])return void(n[o+2]=i)}o++,null!==r&&o++,null!==i&&o++}-1!==s&&(n.splice(s,0,e),o=s+1),n.splice(o++,0,t),null!==r&&n.splice(o++,0,r),null!==i&&n.splice(o++,0,i)}function rs(n){return-1!==n}function $a(n){return 32767&n}function Pa(n,e){let t=function(n){return n>>16}(n),r=e;for(;t>0;)r=r[15],t--;return r}let Zu=!0;function Kd(n){const e=Zu;return Zu=n,e}let Jd=0;function jf(n,e){const t=Jg(n,e);if(-1!==t)return t;const r=e[1];r.firstCreatePass&&(n.injectorIndex=e.length,Kg(r.data,n),Kg(e,null),Kg(r.blueprint,null));const i=Bp(n,e),o=n.injectorIndex;if(rs(i)){const s=$a(i),u=Pa(i,e),f=u[1].data;for(let g=0;g<8;g++)e[o+g]=u[s+g]|f[s+g]}return e[o+8]=i,o}function Kg(n,e){n.push(0,0,0,0,0,0,0,0,e)}function Jg(n,e){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===e[n.injectorIndex+8]?-1:n.injectorIndex}function Bp(n,e){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let t=0,r=null,i=e;for(;null!==i;){const o=i[1],s=o.type;if(r=2===s?o.declTNode:1===s?i[6]:null,null===r)return-1;if(t++,i=i[15],-1!==r.injectorIndex)return r.injectorIndex|t<<16}return-1}function zp(n,e,t){!function(n,e,t){let r;"string"==typeof t?r=t.charCodeAt(0)||0:t.hasOwnProperty(uu)&&(r=t[uu]),null==r&&(r=t[uu]=Jd++);const i=255&r;e.data[n+(i>>5)]|=1<<i}(n,e,t)}function h1(n,e,t){if(t&or.Optional)return n;Oh(e,"NodeInjector")}function d1(n,e,t,r){if(t&or.Optional&&void 0===r&&(r=null),0==(t&(or.Self|or.Host))){const i=n[9],o=ss(void 0);try{return i?i.get(e,r,t&or.Optional):ur(e,r,t&or.Optional)}finally{ss(o)}}return h1(r,e,t)}function iy(n,e,t,r=or.Default,i){if(null!==n){const o=function(n){if("string"==typeof n)return n.charCodeAt(0)||0;const e=n.hasOwnProperty(uu)?n[uu]:void 0;return"number"==typeof e?e>=0?255&e:Vp:e}(t);if("function"==typeof o){if(!ie(e,n,r))return r&or.Host?h1(i,t,r):d1(e,t,r,i);try{const s=o(r);if(null!=s||r&or.Optional)return s;Oh(t)}finally{nt()}}else if("number"==typeof o){let s=null,u=Jg(n,e),f=-1,g=r&or.Host?e[16][6]:null;for((-1===u||r&or.SkipSelf)&&(f=-1===u?Bp(n,e):e[u+8],-1!==f&&Uh(r,!1)?(s=e[1],u=$a(f),e=Pa(f,e)):u=-1);-1!==u;){const v=e[1];if(Up(o,u,v.data)){const E=kE(u,e,t,s,r,g);if(E!==f1)return E}f=e[u+8],-1!==f&&Uh(r,e[1].data[u+8]===g)&&Up(o,u,e)?(s=v,u=$a(f),e=Pa(f,e)):u=-1}}}return d1(e,t,r,i)}const f1={};function Vp(){return new jh(b(),l())}function kE(n,e,t,r,i,o){const s=e[1],u=s.data[n+8],v=Qd(u,s,t,null==r?_a(u)&&Zu:r!=s&&0!=(3&u.type),i&or.Host&&o===u);return null!==v?Gf(e,s,v,u):f1}function Qd(n,e,t,r,i){const o=n.providerIndexes,s=e.data,u=1048575&o,f=n.directiveStart,v=o>>20,T=i?u+v:n.directiveEnd;for(let R=r?u:u+v;R<T;R++){const B=s[R];if(R<f&&t===B||R>=f&&B.type===t)return R}if(i){const R=s[f];if(R&&js(R)&&R.type===t)return f}return null}function Gf(n,e,t,r){let i=n[t];const o=e.data;if(function(n){return n instanceof uo}(i)){const s=i;s.resolving&&function(n,e){throw new Qs("200",`Circular dependency in DI detected for ${n}`)}(go(o[t]));const u=Kd(s.canSeeViewProviders);s.resolving=!0;const f=s.injectImpl?ss(s.injectImpl):null;ie(n,r,or.Default);try{i=n[t]=s.factory(void 0,o,n,r),e.firstCreatePass&&t>=r.directiveStart&&function(n,e,t){const{ngOnChanges:r,ngOnInit:i,ngDoCheck:o}=e.type.prototype;if(r){const s=oa(e);(t.preOrderHooks||(t.preOrderHooks=[])).push(n,s),(t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(n,s)}i&&(t.preOrderHooks||(t.preOrderHooks=[])).push(0-n,i),o&&((t.preOrderHooks||(t.preOrderHooks=[])).push(n,o),(t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(n,o))}(t,o[t],e)}finally{null!==f&&ss(f),Kd(u),s.resolving=!1,nt()}}return i}function Up(n,e,t){return!!(t[e+(n>>5)]&1<<n)}function Uh(n,e){return!(n&or.Self||n&or.Host&&e)}class jh{constructor(e,t){this._tNode=e,this._lView=t}get(e,t){return iy(this._tNode,this._lView,e,void 0,t)}}function Ol(n){return ll(()=>{const e=n.prototype.constructor,t=e[Xl]||Qg(e),r=Object.prototype;let i=Object.getPrototypeOf(n.prototype).constructor;for(;i&&i!==r;){const o=i[Xl]||Qg(i);if(o&&o!==t)return o;i=Object.getPrototypeOf(i)}return o=>new o})}function Qg(n){return wu(n)?()=>{const e=Qg(Ln(n));return e&&e()}:dl(n)}function jp(n){return function(n,e){if("class"===e)return n.classes;if("style"===e)return n.styles;const t=n.attrs;if(t){const r=t.length;let i=0;for(;i<r;){const o=t[i];if(ns(o))break;if(0===o)i+=2;else if("number"==typeof o)for(i++;i<r&&"string"==typeof t[i];)i++;else{if(o===e)return t[i+1];i+=2}}}return null}(b(),n)}const _d="__parameters__";function kl(n,e,t){return ll(()=>{const r=function(n){return function(...t){if(n){const r=n(...t);for(const i in r)this[i]=r[i]}}}(e);function i(...o){if(this instanceof i)return r.apply(this,o),this;const s=new i(...o);return u.annotation=s,u;function u(f,g,v){const E=f.hasOwnProperty(_d)?f[_d]:Object.defineProperty(f,_d,{value:[]})[_d];for(;E.length<=v;)E.push(null);return(E[v]=E[v]||[]).push(s),f}}return t&&(i.prototype=Object.create(t.prototype)),i.prototype.ngMetadataName=n,i.annotationCls=i,i})}class gr{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=Dn({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}toString(){return`InjectionToken ${this._desc}`}}const NE=new gr("AnalyzeForEntryComponents"),nf=Function;function Tu(n,e){void 0===e&&(e=n);for(let t=0;t<n.length;t++){let r=n[t];Array.isArray(r)?(e===n&&(e=n.slice(0,t)),Tu(r,e)):e!==n&&e.push(r)}return e}function ah(n,e){n.forEach(t=>Array.isArray(t)?ah(t,e):e(t))}function qf(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function vd(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}function Du(n,e,t){let r=Wf(n,e);return r>=0?n[1|r]=t:(r=~r,function(n,e,t,r){let i=n.length;if(i==e)n.push(t,r);else if(1===i)n.push(r,n[0]),n[0]=t;else{for(i--,n.push(n[i-1],n[i]);i>e;)n[i]=n[i-2],i--;n[e]=t,n[e+1]=r}}(n,r,e,t)),r}function hy(n,e){const t=Wf(n,e);if(t>=0)return n[1|t]}function Wf(n,e){return function(n,e,t){let r=0,i=n.length>>t;for(;i!==r;){const o=r+(i-r>>1),s=n[o<<t];if(e===s)return o<<t;s>e?i=o:r=o+1}return~(i<<t)}(n,e,1)}const Xf={},im="__NG_DI_FLAG__",uh="ngTempTokenPath",$E=/\n/gm,of="__source",om=Rn({provide:String,useValue:Rn});let Yf;function Zf(n){const e=Yf;return Yf=n,e}function v1(n,e=or.Default){if(void 0===Yf)throw new Error("inject() must be called from an injection context");return null===Yf?ur(n,void 0,e):Yf.get(n,e&or.Optional?null:void 0,e)}function yt(n,e=or.Default){return(Xi||v1)(Ln(n),e)}const py=yt;function $h(n){const e=[];for(let t=0;t<n.length;t++){const r=Ln(n[t]);if(Array.isArray(r)){if(0===r.length)throw new Error("Arguments array must have arguments.");let i,o=or.Default;for(let s=0;s<r.length;s++){const u=r[s],f=gy(u);"number"==typeof f?-1===f?i=u.token:o|=f:i=u}e.push(yt(i,o))}else e.push(yt(r))}return e}function Kf(n,e){return n[im]=e,n.prototype[im]=e,n}function gy(n){return n[im]}function Hh(n,e,t,r){const i=n[uh];throw e[of]&&i.unshift(e[of]),n.message=function(n,e,t,r=null){n=n&&"\n"===n.charAt(0)&&"\u0275"==n.charAt(1)?n.substr(2):n;let i=Nr(e);if(Array.isArray(e))i=e.map(Nr).join(" -> ");else if("object"==typeof e){let o=[];for(let s in e)if(e.hasOwnProperty(s)){let u=e[s];o.push(s+":"+("string"==typeof u?JSON.stringify(u):Nr(u)))}i=`{${o.join(", ")}}`}return`${t}${r?"("+r+")":""}[${i}]: ${n.replace($E,"\n  ")}`}("\n"+n.message,i,t,r),n.ngTokenPath=i,n[uh]=null,n}const xd=Kf(kl("Inject",n=>({token:n})),-1),Au=Kf(kl("Optional"),8),bd=Kf(kl("SkipSelf"),4);class af{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}function mu(n){return n instanceof af?n.changingThisBreaksApplicationSecurity:n}function vc(n,e){const t=function(n){return n instanceof af&&n.getTypeName()||null}(n);if(null!=t&&t!==e){if("ResourceURL"===t&&"URL"===e)return!0;throw new Error(`Required a safe ${e}, got a ${t} (see https://g.co/ng/security#xss)`)}return t===e}const S1=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,aC=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;var vs=(()=>((vs=vs||{})[vs.NONE=0]="NONE",vs[vs.HTML=1]="HTML",vs[vs.STYLE=2]="STYLE",vs[vs.SCRIPT=3]="SCRIPT",vs[vs.URL=4]="URL",vs[vs.RESOURCE_URL=5]="RESOURCE_URL",vs))();function Jp(n){const e=function(){const n=l();return n&&n[12]}();return e?e.sanitize(vs.URL,n)||"":vc(n,"URL")?mu(n):function(n){return(n=String(n)).match(S1)||n.match(aC)?n:"unsafe:"+n}(Nn(n))}const My="__ngContext__";function Ha(n,e){n[My]=e}function Qp(n){const e=function(n){return n[My]||null}(n);return e?Array.isArray(e)?e:e.lView:null}function eg(n){return n.ngOriginalError}function xC(n,...e){n.error(...e)}class uf{constructor(){this._console=console}handleError(e){const t=this._findOriginalError(e),r=this._findContext(e),i=(n=e)&&n.ngErrorLogger||xC;var n;i(this._console,"ERROR",e),t&&i(this._console,"ORIGINAL ERROR",t),r&&i(this._console,"ERROR CONTEXT",r)}_findContext(e){return e?function(n){return n.ngDebugContext}(e)||this._findContext(eg(e)):null}_findOriginalError(e){let t=e&&eg(e);for(;t&&eg(t);)t=eg(t);return t||null}}const Oy=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(jr))();function fh(n){return n instanceof Function?n():n}var Ru=(()=>((Ru=Ru||{})[Ru.Important=1]="Important",Ru[Ru.DashCase=2]="DashCase",Ru))();function Fy(n,e){return undefined(n,e)}function ap(n){const e=n[3];return xo(e)?e[3]:e}function Ed(n){return Vy(n[13])}function df(n){return Vy(n[4])}function Vy(n){for(;null!==n&&!xo(n);)n=n[4];return n}function Cd(n,e,t,r,i){if(null!=r){let o,s=!1;xo(r)?o=r:ga(r)&&(s=!0,r=r[0]);const u=Cs(r);0===n&&null!==t?null==i?Gy(e,t,u):Ou(e,t,u,i||null,!0):1===n&&null!==t?Ou(e,t,u,i||null,!0):2===n?function(n,e,t){const r=lp(n,e);r&&function(n,e,t,r){Go(n)?n.removeChild(e,t,r):e.removeChild(t)}(n,r,e,t)}(e,u,s):3===n&&e.destroyNode(u),null!=o&&function(n,e,t,r,i){const o=t[7];o!==Cs(t)&&Cd(e,n,r,o,i);for(let u=10;u<t.length;u++){const f=t[u];Td(f[1],f,n,e,r,o)}}(e,n,o,t,i)}}function wm(n,e,t){return Go(n)?n.createElement(e,t):null===t?n.createElement(e):n.createElementNS(t,e)}function B1(n,e){const t=n[9],r=t.indexOf(e),i=e[3];1024&e[2]&&(e[2]&=-1025,Al(i,-1)),t.splice(r,1)}function Md(n,e){if(n.length<=10)return;const t=10+e,r=n[t];if(r){const i=r[17];null!==i&&i!==n&&B1(i,r),e>0&&(n[t-1][4]=r[4]);const o=vd(n,10+e);!function(n,e){Td(n,e,e[11],2,null,null),e[0]=null,e[6]=null}(r[1],r);const s=o[19];null!==s&&s.detachView(o[1]),r[3]=null,r[4]=null,r[2]&=-129}return r}function Sm(n,e){if(!(256&e[2])){const t=e[11];Go(t)&&t.destroyNode&&Td(n,e,t,3,null,null),function(n){let e=n[13];if(!e)return jy(n[1],n);for(;e;){let t=null;if(ga(e))t=e[13];else{const r=e[10];r&&(t=r)}if(!t){for(;e&&!e[4]&&e!==n;)ga(e)&&jy(e[1],e),e=e[3];null===e&&(e=n),ga(e)&&jy(e[1],e),t=e&&e[4]}e=t}}(e)}}function jy(n,e){if(!(256&e[2])){e[2]&=-129,e[2]|=256,function(n,e){let t;if(null!=n&&null!=(t=n.destroyHooks))for(let r=0;r<t.length;r+=2){const i=e[t[r]];if(!(i instanceof uo)){const o=t[r+1];if(Array.isArray(o))for(let s=0;s<o.length;s+=2){const u=i[o[s]],f=o[s+1];try{f.call(u)}finally{}}else try{o.call(i)}finally{}}}}(n,e),function(n,e){const t=n.cleanup,r=e[7];let i=-1;if(null!==t)for(let o=0;o<t.length-1;o+=2)if("string"==typeof t[o]){const s=t[o+1],u="function"==typeof s?s(e):Cs(e[s]),f=r[i=t[o+2]],g=t[o+3];"boolean"==typeof g?u.removeEventListener(t[o],f,g):g>=0?r[i=g]():r[i=-g].unsubscribe(),o+=2}else{const s=r[i=t[o+1]];t[o].call(s)}if(null!==r){for(let o=i+1;o<r.length;o++)r[o]();e[7]=null}}(n,e),1===e[1].type&&Go(e[11])&&e[11].destroy();const t=e[17];if(null!==t&&xo(e[3])){t!==e[3]&&B1(t,e);const r=e[19];null!==r&&r.detachView(n)}}}function Mm(n,e,t){return function(n,e,t){let r=e;for(;null!==r&&40&r.type;)r=(e=r).parent;if(null===r)return t[0];if(2&r.flags){const i=n.data[r.directiveStart].encapsulation;if(i===xr.None||i===xr.Emulated)return null}return _s(r,t)}(n,e.parent,t)}function Ou(n,e,t,r,i){Go(n)?n.insertBefore(e,t,r,i):e.insertBefore(t,r,i)}function Gy(n,e,t){Go(n)?n.appendChild(e,t):e.appendChild(t)}function $y(n,e,t,r,i){null!==r?Ou(n,e,t,r,i):Gy(n,e,t)}function lp(n,e){return Go(n)?n.parentNode(e):e.parentNode}let rg=function(n,e,t){return 40&n.type?_s(n,t):null};function up(n,e,t,r){const i=Mm(n,r,e),o=e[11],u=function(n,e,t){return rg(n,e,t)}(r.parent||e[6],r,e);if(null!=i)if(Array.isArray(t))for(let f=0;f<t.length;f++)$y(o,i,t[f],u,!1);else $y(o,i,t,u,!1)}function cp(n,e){if(null!==e){const t=e.type;if(3&t)return _s(e,n);if(4&t)return Hy(-1,n[e.index]);if(8&t){const r=e.child;if(null!==r)return cp(n,r);{const i=n[e.index];return xo(i)?Hy(-1,i):Cs(i)}}if(32&t)return Fy(e,n)()||Cs(n[e.index]);{const r=Yh(n,e);return null!==r?Array.isArray(r)?r[0]:cp(ap(n[16]),r):cp(n,e.next)}}return null}function Yh(n,e){return null!==e?n[16][6].projection[e.projection]:null}function Hy(n,e){const t=10+n+1;if(t<e.length){const r=e[t],i=r[1].firstChild;if(null!==i)return cp(r,i)}return e[7]}function Im(n,e,t,r,i,o,s){for(;null!=t;){const u=r[t.index],f=t.type;if(s&&0===e&&(u&&Ha(Cs(u),r),t.flags|=4),64!=(64&t.flags))if(8&f)Im(n,e,t.child,r,i,o,!1),Cd(e,n,i,u,o);else if(32&f){const g=Fy(t,r);let v;for(;v=g();)Cd(e,n,i,v,o);Cd(e,n,i,u,o)}else 16&f?$1(n,e,r,t,i,o):Cd(e,n,i,u,o);t=s?t.projectionNext:t.next}}function Td(n,e,t,r,i,o){Im(t,r,n.firstChild,e,i,o,!1)}function $1(n,e,t,r,i,o){const s=t[16],f=s[6].projection[r.projection];if(Array.isArray(f))for(let g=0;g<f.length;g++)Cd(e,n,i,f[g],o);else Im(n,e,f,s[3],i,o,!0)}function Am(n,e,t){Go(n)?n.setAttribute(e,"style",t):e.style.cssText=t}function qy(n,e,t){Go(n)?""===t?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t):e.className=t}function Wy(n,e,t){let r=n.length;for(;;){const i=n.indexOf(e,t);if(-1===i)return i;if(0===i||n.charCodeAt(i-1)<=32){const o=e.length;if(i+o===r||n.charCodeAt(i+o)<=32)return i}t=i+1}}const Xy="ng-template";function H1(n,e,t){let r=0;for(;r<n.length;){let i=n[r++];if(t&&"class"===i){if(i=n[r],-1!==Wy(i.toLowerCase(),e,0))return!0}else if(1===i){for(;r<n.length&&"string"==typeof(i=n[r++]);)if(i.toLowerCase()===e)return!0;return!1}}return!1}function og(n){return 4===n.type&&n.value!==Xy}function Pm(n,e,t){return e===(4!==n.type||t?n.value:Xy)}function ff(n,e,t){let r=4;const i=n.attrs||[],o=function(n){for(let e=0;e<n.length;e++)if(ns(n[e]))return e;return n.length}(i);let s=!1;for(let u=0;u<e.length;u++){const f=e[u];if("number"!=typeof f){if(!s)if(4&r){if(r=2|1&r,""!==f&&!Pm(n,f,t)||""===f&&1===e.length){if(xc(r))return!1;s=!0}}else{const g=8&r?f:e[++u];if(8&r&&null!==n.attrs){if(!H1(n.attrs,g,t)){if(xc(r))return!1;s=!0}continue}const E=Gs(8&r?"class":f,i,og(n),t);if(-1===E){if(xc(r))return!1;s=!0;continue}if(""!==g){let T;T=E>o?"":i[E+1].toLowerCase();const R=8&r?T:null;if(R&&-1!==Wy(R,g,0)||2&r&&g!==T){if(xc(r))return!1;s=!0}}}}else{if(!s&&!xc(r)&&!xc(f))return!1;if(s&&xc(f))continue;s=!1,r=f|1&r}}return xc(r)||s}function xc(n){return 0==(1&n)}function Gs(n,e,t,r){if(null===e)return-1;let i=0;if(r||!t){let o=!1;for(;i<e.length;){const s=e[i];if(s===n)return i;if(3===s||6===s)o=!0;else{if(1===s||2===s){let u=e[++i];for(;"string"==typeof u;)u=e[++i];continue}if(4===s)break;if(0===s){i+=4;continue}}i+=o?1:2}return-1}return function(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){const r=n[t];if("number"==typeof r)return-1;if(r===e)return t;t++}return-1}(e,n)}function Yy(n,e,t=!1){for(let r=0;r<e.length;r++)if(ff(n,e[r],t))return!0;return!1}function sg(n,e){return n?":not("+e.trim()+")":e}function Ky(n){let e=n[0],t=1,r=2,i="",o=!1;for(;t<n.length;){let s=n[t];if("string"==typeof s)if(2&r){const u=n[++t];i+="["+s+(u.length>0?'="'+u+'"':"")+"]"}else 8&r?i+="."+s:4&r&&(i+=" "+s);else""!==i&&!xc(s)&&(e+=sg(o,i),i=""),r=s,o=o||!xc(r);t++}return""!==i&&(e+=sg(o,i)),e}const Zr={};function $o(n){Qy(d(),l(),ot()+n,zt())}function Qy(n,e,t,r){if(!r)if(3==(3&e[2])){const o=n.preOrderCheckHooks;null!==o&&En(e,o,t)}else{const o=n.preOrderHooks;null!==o&&wn(e,o,0,t)}Xe(t)}function Rm(n,e){return n<<17|e<<2}function bc(n){return n>>17&32767}function Ll(n){return 2|n}function Qu(n){return(131068&n)>>2}function km(n,e){return-131069&n|e<<2}function tv(n){return 1|n}function $(n,e){const t=n.contentQueries;if(null!==t)for(let r=0;r<t.length;r+=2){const i=t[r],o=t[r+1];if(-1!==o){const s=n.data[o];Y(i),s.contentQueries(2,e[o],o)}}}function J(n,e,t,r,i,o,s,u,f,g){const v=e.blueprint.slice();return v[0]=i,v[2]=140|r,wr(v),v[3]=v[15]=n,v[8]=t,v[10]=s||n&&n[10],v[11]=u||n&&n[11],v[12]=f||n&&n[12]||null,v[9]=g||n&&n[9]||null,v[6]=o,v[16]=2==e.type?n[16]:v,v}function ge(n,e,t,r,i){let o=n.data[e];if(null===o)o=function(n,e,t,r,i){const o=I(),s=ne(),f=n.data[e]=function(n,e,t,r,i,o){return{type:t,index:r,insertBeforeIndex:null,injectorIndex:e?e.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:i,attrs:o,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,s?o:o&&o.parent,t,e,r,i);return null===n.firstChild&&(n.firstChild=f),null!==o&&(s?null==o.child&&null!==f.parent&&(o.child=f):null===o.next&&(o.next=f)),f}(n,e,t,r,i),Sr.lFrame.inI18n&&(o.flags|=64);else if(64&o.type){o.type=t,o.value=r,o.attrs=i;const s=function(){const n=Sr.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}();o.injectorIndex=null===s?-1:s.injectorIndex}return j(o,!0),o}function Ze(n,e,t,r){if(0===t)return-1;const i=e.length;for(let o=0;o<t;o++)e.push(r),n.blueprint.push(r),n.data.push(null);return i}function st(n,e,t){se(e);try{const r=n.viewQuery;null!==r&&nu(1,r,t);const i=n.template;null!==i&&Dt(n,e,i,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),n.staticContentQueries&&$(n,e),n.staticViewQueries&&nu(2,n.viewQuery,t);const o=n.components;null!==o&&function(n,e){for(let t=0;t<e.length;t++)_h(n,e[t])}(e,o)}catch(r){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),r}finally{e[2]&=-5,Te()}}function xt(n,e,t,r){const i=e[2];if(256==(256&i))return;se(e);const o=zt();try{wr(e),function(n){Sr.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==t&&Dt(n,e,t,2,r);const s=3==(3&i);if(!o)if(s){const g=n.preOrderCheckHooks;null!==g&&En(e,g,null)}else{const g=n.preOrderHooks;null!==g&&wn(e,g,0,null),Ir(e,0)}if(function(n){for(let e=Ed(n);null!==e;e=df(e)){if(!e[2])continue;const t=e[9];for(let r=0;r<t.length;r++){const i=t[r],o=i[3];0==(1024&i[2])&&Al(o,1),i[2]|=1024}}}(e),function(n){for(let e=Ed(n);null!==e;e=df(e))for(let t=10;t<e.length;t++){const r=e[t],i=r[1];Su(r)&&xt(i,r,i.template,r[8])}}(e),null!==n.contentQueries&&$(n,e),!o)if(s){const g=n.contentCheckHooks;null!==g&&En(e,g)}else{const g=n.contentHooks;null!==g&&wn(e,g,1),Ir(e,1)}!function(n,e){const t=n.hostBindingOpCodes;if(null!==t)try{for(let r=0;r<t.length;r++){const i=t[r];if(i<0)Xe(~i);else{const o=i,s=t[++r],u=t[++r];P(s,o),u(2,e[o])}}}finally{Xe(-1)}}(n,e);const u=n.components;null!==u&&function(n,e){for(let t=0;t<e.length;t++)mh(n,e[t])}(e,u);const f=n.viewQuery;if(null!==f&&nu(2,f,r),!o)if(s){const g=n.viewCheckHooks;null!==g&&En(e,g)}else{const g=n.viewHooks;null!==g&&wn(e,g,2),Ir(e,2)}!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),o||(e[2]&=-73),1024&e[2]&&(e[2]&=-1025,Al(e[3],-1))}finally{Te()}}function St(n,e,t,r){const i=e[10],o=!zt(),s=Il(e);try{o&&!s&&i.begin&&i.begin(),s&&st(n,e,r),xt(n,e,t,r)}finally{o&&!s&&i.end&&i.end()}}function Dt(n,e,t,r,i){const o=ot(),s=2&r;try{Xe(-1),s&&e.length>20&&Qy(n,e,20,zt()),t(r,i)}finally{Xe(o)}}function Rt(n,e,t){if(ma(e)){const i=e.directiveEnd;for(let o=e.directiveStart;o<i;o++){const s=n.data[o];s.contentQueries&&s.contentQueries(1,t[o],o)}}}function Pt(n,e,t){!Bo()||(function(n,e,t,r){const i=t.directiveStart,o=t.directiveEnd;n.firstCreatePass||jf(t,e),Ha(r,e);const s=t.initialInputs;for(let u=i;u<o;u++){const f=n.data[u],g=js(f);g&&ec(e,t,f);const v=Gf(e,n,u,t);Ha(v,e),null!==s&&Ws(0,u-i,v,f,0,s),g&&(aa(t.index,e)[8]=v)}}(n,e,t,_s(t,e)),128==(128&t.flags)&&function(n,e,t){const r=t.directiveStart,i=t.directiveEnd,s=t.index,u=Sr.lFrame.currentDirectiveIndex;try{Xe(s);for(let f=r;f<i;f++){const g=n.data[f],v=e[f];F(f),(null!==g.hostBindings||0!==g.hostVars||null!==g.hostAttrs)&&qa(g,v)}}finally{Xe(-1),F(u)}}(n,e,t))}function tn(n,e,t=_s){const r=e.localNames;if(null!==r){let i=e.index+1;for(let o=0;o<r.length;o+=2){const s=r[o+1],u=-1===s?t(e,n):n[s];n[i++]=u}}}function dn(n){const e=n.tView;return null===e||e.incompleteFirstPass?n.tView=en(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts):e}function en(n,e,t,r,i,o,s,u,f,g){const v=20+r,E=v+i,T=function(n,e){const t=[];for(let r=0;r<e;r++)t.push(r<n?null:Zr);return t}(v,E),R="function"==typeof g?g():g;return T[1]={type:n,blueprint:T,template:t,queries:null,viewQuery:u,declTNode:e,data:T.slice().fill(null,v),bindingStartIndex:v,expandoStartIndex:E,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof o?o():o,pipeRegistry:"function"==typeof s?s():s,firstChild:null,schemas:f,consts:R,incompleteFirstPass:!1}}function Ht(n,e,t,r){const i=av(e);null===t?i.push(r):(i.push(t),n.firstCreatePass&&Ad(n).push(r,i.length-1))}function $r(n,e,t){for(let r in n)if(n.hasOwnProperty(r)){const i=n[r];(t=null===t?{}:t).hasOwnProperty(r)?t[r].push(e,i):t[r]=[e,i]}return t}function $n(n,e,t,r,i,o,s,u){const f=_s(e,t);let v,g=e.inputs;!u&&null!=g&&(v=g[r])?(aP(n,t,v,r,i),_a(e)&&function(n,e){const t=aa(e,n);16&t[2]||(t[2]|=64)}(t,e.index)):3&e.type&&(r=function(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(r),i=null!=s?s(i,e.value||"",r):i,Go(o)?o.setProperty(f,r,i):ui(r)||(f.setProperty?f.setProperty(r,i):f[r]=i))}function xs(n,e,t,r){let i=!1;if(Bo()){const o=function(n,e,t){const r=n.directiveRegistry;let i=null;if(r)for(let o=0;o<r.length;o++){const s=r[o];Yy(t,s.selectors,!1)&&(i||(i=[]),zp(jf(t,e),n,s.type),js(s)?(ua(n,t),i.unshift(s)):i.push(s))}return i}(n,e,t),s=null===r?null:{"":-1};if(null!==o){i=!0,pl(t,n.data.length,o.length);for(let v=0;v<o.length;v++){const E=o[v];E.providersResolver&&E.providersResolver(E)}let u=!1,f=!1,g=Ze(n,e,o.length,null);for(let v=0;v<o.length;v++){const E=o[v];t.mergedAttrs=ys(t.mergedAttrs,E.hostAttrs),Ls(n,t,e,g,E),ca(g,E,s),null!==E.contentQueries&&(t.flags|=8),(null!==E.hostBindings||null!==E.hostAttrs||0!==E.hostVars)&&(t.flags|=128);const T=E.type.prototype;!u&&(T.ngOnChanges||T.ngOnInit||T.ngDoCheck)&&((n.preOrderHooks||(n.preOrderHooks=[])).push(t.index),u=!0),!f&&(T.ngOnChanges||T.ngDoCheck)&&((n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(t.index),f=!0),g++}!function(n,e){const r=e.directiveEnd,i=n.data,o=e.attrs,s=[];let u=null,f=null;for(let g=e.directiveStart;g<r;g++){const v=i[g],E=v.inputs,T=null===o||og(e)?null:yu(E,o);s.push(T),u=$r(E,g,u),f=$r(v.outputs,g,f)}null!==u&&(u.hasOwnProperty("class")&&(e.flags|=16),u.hasOwnProperty("style")&&(e.flags|=32)),e.initialInputs=s,e.inputs=u,e.outputs=f}(n,t)}s&&function(n,e,t){if(e){const r=n.localNames=[];for(let i=0;i<e.length;i+=2){const o=t[e[i+1]];if(null==o)throw new Qs("301",`Export of name '${e[i+1]}' not found!`);r.push(e[i],o)}}}(t,r,s)}return t.mergedAttrs=ys(t.mergedAttrs,t.attrs),i}function zo(n,e,t,r,i,o){const s=o.hostBindings;if(s){let u=n.hostBindingOpCodes;null===u&&(u=n.hostBindingOpCodes=[]);const f=~e.index;(function(n){let e=n.length;for(;e>0;){const t=n[--e];if("number"==typeof t&&t<0)return t}return 0})(u)!=f&&u.push(f),u.push(r,i,s)}}function qa(n,e){null!==n.hostBindings&&n.hostBindings(1,e)}function ua(n,e){e.flags|=2,(n.components||(n.components=[])).push(e.index)}function ca(n,e,t){if(t){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)t[e.exportAs[r]]=n;js(e)&&(t[""]=n)}}function pl(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}function Ls(n,e,t,r,i){n.data[r]=i;const o=i.factory||(i.factory=dl(i.type)),s=new uo(o,js(i),null);n.blueprint[r]=s,t[r]=s,zo(n,e,0,r,Ze(n,t,i.hostVars,Zr),i)}function ec(n,e,t){const r=_s(e,n),i=dn(t),o=n[10],s=tu(n,J(n,i,null,t.onPush?64:16,r,e,o,o.createRenderer(r,t),null,null));n[e.index]=s}function ls(n,e,t,r,i,o){const s=_s(n,e);!function(n,e,t,r,i,o,s){if(null==o)Go(n)?n.removeAttribute(e,i,t):e.removeAttribute(i);else{const u=null==s?Nn(o):s(o,r||"",i);Go(n)?n.setAttribute(e,i,u,t):t?e.setAttributeNS(t,i,u):e.setAttribute(i,u)}}(e[11],s,o,n.value,t,r,i)}function Ws(n,e,t,r,i,o){const s=o[e];if(null!==s){const u=r.setInput;for(let f=0;f<s.length;){const g=s[f++],v=s[f++],E=s[f++];null!==u?r.setInput(t,E,g,v):t[v]=E}}}function yu(n,e){let t=null,r=0;for(;r<e.length;){const i=e[r];if(0!==i)if(5!==i){if("number"==typeof i)break;n.hasOwnProperty(i)&&(null===t&&(t=[]),t.push(i,n[i],e[r+1])),r+=2}else r+=2;else r+=4}return t}function Nc(n,e,t,r){return new Array(n,!0,!1,e,null,0,r,t,null,null)}function mh(n,e){const t=aa(e,n);if(Su(t)){const r=t[1];80&t[2]?xt(r,t,r.template,t[8]):t[5]>0&&tl(t)}}function tl(n){for(let r=Ed(n);null!==r;r=df(r))for(let i=10;i<r.length;i++){const o=r[i];if(1024&o[2]){const s=o[1];xt(s,o,s.template,o[8])}else o[5]>0&&tl(o)}const t=n[1].components;if(null!==t)for(let r=0;r<t.length;r++){const i=aa(t[r],n);Su(i)&&i[5]>0&&tl(i)}}function _h(n,e){const t=aa(e,n),r=t[1];(function(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])})(r,t),st(r,t,t[8])}function tu(n,e){return n[13]?n[14][4]=e:n[13]=e,n[14]=e,e}function mf(n){for(;n;){n[2]|=64;const e=ap(n);if(fu(n)&&!e)return n;n=e}return null}function Bc(n,e,t){const r=e[10];r.begin&&r.begin();try{xt(n,e,n.template,t)}catch(i){throw sP(e,i),i}finally{r.end&&r.end()}}function Bm(n){!function(n){for(let e=0;e<n.components.length;e++){const t=n.components[e],r=Qp(t),i=r[1];St(i,r,i.template,t)}}(n[8])}function nu(n,e,t){Y(0),e(n,t)}const sv=(()=>Promise.resolve(null))();function av(n){return n[7]||(n[7]=[])}function Ad(n){return n.cleanup||(n.cleanup=[])}function oP(n,e,t){return(null===n||js(n))&&(t=function(n){for(;Array.isArray(n);){if("object"==typeof n[1])return n;n=n[0]}return null}(t[e.index])),t[11]}function sP(n,e){const t=n[9],r=t?t.get(uf,null):null;r&&r.handleError(e)}function aP(n,e,t,r,i){for(let o=0;o<t.length;){const s=t[o++],u=t[o++],f=e[s],g=n.data[s];null!==g.setInput?g.setInput(f,i,r,u):f[u]=i}}function _f(n,e,t){const r=Bh(e,n);!function(n,e,t){Go(n)?n.setValue(e,t):e.textContent=t}(n[11],r,t)}function nx(n,e,t){let r=t?n.styles:null,i=t?n.classes:null,o=0;if(null!==e)for(let s=0;s<e.length;s++){const u=e[s];"number"==typeof u?o=u:1==o?i=Gl(i,u):2==o&&(r=Gl(r,u+": "+e[++s]+";"))}t?n.styles=r:n.stylesWithoutHost=r,t?n.classes=i:n.classesWithoutHost=i}const Vm=new gr("INJECTOR",-1);class lP{get(e,t=Xf){if(t===Xf){const r=new Error(`NullInjectorError: No provider for ${Nr(e)}!`);throw r.name="NullInjectorError",r}return t}}const lv=new gr("Set Injector scope."),uv={},EU={};let HC;function uP(){return void 0===HC&&(HC=new lP),HC}function cP(n,e=null,t=null,r){return new SU(n,t,e||uP(),r)}class SU{constructor(e,t,r,i=null){this.parent=r,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const o=[];t&&ah(t,u=>this.processProvider(u,e,t)),ah([e],u=>this.processInjectorType(u,[],o)),this.records.set(Vm,Um(void 0,this));const s=this.records.get(lv);this.scope=null!=s?s.value:null,this.source=i||("object"==typeof e?null:Nr(e))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(e=>e.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(e,t=Xf,r=or.Default){this.assertNotDestroyed();const i=Zf(this),o=ss(void 0);try{if(!(r&or.SkipSelf)){let u=this.records.get(e);if(void 0===u){const f=("function"==typeof(n=e)||"object"==typeof n&&n instanceof gr)&&so(e);u=f&&this.injectableDefInScope(f)?Um(qC(e),uv):null,this.records.set(e,u)}if(null!=u)return this.hydrate(e,u)}return(r&or.Self?uP():this.parent).get(e,t=r&or.Optional&&t===Xf?null:t)}catch(s){if("NullInjectorError"===s.name){if((s[uh]=s[uh]||[]).unshift(Nr(e)),i)throw s;return Hh(s,e,"R3InjectorError",this.source)}throw s}finally{ss(o),Zf(i)}var n}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(e=>this.get(e))}toString(){const e=[];return this.records.forEach((r,i)=>e.push(Nr(i))),`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Error("Injector has already been destroyed.")}processInjectorType(e,t,r){if(!(e=Ln(e)))return!1;let i=Ca(e);const o=null==i&&e.ngModule||void 0,s=void 0===o?e:o,u=-1!==r.indexOf(s);if(void 0!==o&&(i=Ca(o)),null==i)return!1;if(null!=i.imports&&!u){let v;r.push(s);try{ah(i.imports,E=>{this.processInjectorType(E,t,r)&&(void 0===v&&(v=[]),v.push(E))})}finally{}if(void 0!==v)for(let E=0;E<v.length;E++){const{ngModule:T,providers:R}=v[E];ah(R,B=>this.processProvider(B,T,R||ro))}}this.injectorDefTypes.add(s);const f=dl(s)||(()=>new s);this.records.set(s,Um(f,uv));const g=i.providers;if(null!=g&&!u){const v=e;ah(g,E=>this.processProvider(E,v,g))}return void 0!==o&&void 0!==e.providers}processProvider(e,t,r){let i=jm(e=Ln(e))?e:Ln(e&&e.provide);const o=function(n,e,t){return dP(n)?Um(void 0,n.useValue):Um(hP(n),uv)}(e);if(jm(e)||!0!==e.multi)this.records.get(i);else{let s=this.records.get(i);s||(s=Um(void 0,uv,!0),s.factory=()=>$h(s.multi),this.records.set(i,s)),i=e,s.multi.push(e)}this.records.set(i,o)}hydrate(e,t){return t.value===uv&&(t.value=EU,t.value=t.factory()),"object"==typeof t.value&&t.value&&null!==(n=t.value)&&"object"==typeof n&&"function"==typeof n.ngOnDestroy&&this.onDestroy.add(t.value),t.value;var n}injectableDefInScope(e){if(!e.providedIn)return!1;const t=Ln(e.providedIn);return"string"==typeof t?"any"===t||t===this.scope:this.injectorDefTypes.has(t)}}function qC(n){const e=so(n),t=null!==e?e.factory:dl(n);if(null!==t)return t;if(n instanceof gr)throw new Error(`Token ${Nr(n)} is missing a \u0275prov definition.`);if(n instanceof Function)return function(n){const e=n.length;if(e>0){const r=function(n,e){const t=[];for(let r=0;r<n;r++)t.push(e);return t}(e,"?");throw new Error(`Can't resolve all parameters for ${Nr(n)}: (${r.join(", ")}).`)}const t=function(n){const e=n&&(n[zs]||n[bl]);if(e){const t=function(n){if(n.hasOwnProperty("name"))return n.name;const e=(""+n).match(/^function\s*([^\s(]+)/);return null===e?"":e[1]}(n);return console.warn(`DEPRECATED: DI is instantiating a token "${t}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${t}" class.`),e}return null}(n);return null!==t?()=>t.factory(n):()=>new n}(n);throw new Error("unreachable")}function hP(n,e,t){let r;if(jm(n)){const i=Ln(n);return dl(i)||qC(i)}if(dP(n))r=()=>Ln(n.useValue);else if(function(n){return!(!n||!n.useFactory)}(n))r=()=>n.useFactory(...$h(n.deps||[]));else if(function(n){return!(!n||!n.useExisting)}(n))r=()=>yt(Ln(n.useExisting));else{const i=Ln(n&&(n.useClass||n.provide));if(!function(n){return!!n.deps}(n))return dl(i)||qC(i);r=()=>new i(...$h(n.deps))}return r}function Um(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function dP(n){return null!==n&&"object"==typeof n&&om in n}function jm(n){return"function"==typeof n}const fP=function(n,e,t){return function(n,e=null,t=null,r){const i=cP(n,e,t,r);return i._resolveInjectorDefTypes(),i}({name:t},e,n,t)};class mi{static create(e,t){return Array.isArray(e)?fP(e,t,""):fP(e.providers,e.parent,e.name||"")}}function qU(n,e){Kn(Qp(n)[1],b())}function Eo(n){let e=function(n){return Object.getPrototypeOf(n.prototype).constructor}(n.type),t=!0;const r=[n];for(;e;){let i;if(js(n))i=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new Error("Directives cannot inherit Components");i=e.\u0275dir}if(i){if(t){r.push(i);const s=n;s.inputs=JC(n.inputs),s.declaredInputs=JC(n.declaredInputs),s.outputs=JC(n.outputs);const u=i.hostBindings;u&&ZU(n,u);const f=i.viewQuery,g=i.contentQueries;if(f&&XU(n,f),g&&YU(n,g),Js(n.inputs,i.inputs),Js(n.declaredInputs,i.declaredInputs),Js(n.outputs,i.outputs),js(i)&&i.data.animation){const v=n.data;v.animation=(v.animation||[]).concat(i.data.animation)}}const o=i.features;if(o)for(let s=0;s<o.length;s++){const u=o[s];u&&u.ngInherit&&u(n),u===Eo&&(t=!1)}}e=Object.getPrototypeOf(e)}!function(n){let e=0,t=null;for(let r=n.length-1;r>=0;r--){const i=n[r];i.hostVars=e+=i.hostVars,i.hostAttrs=ys(i.hostAttrs,t=ys(t,i.hostAttrs))}}(r)}function JC(n){return n===Yn?{}:n===ro?[]:n}function XU(n,e){const t=n.viewQuery;n.viewQuery=t?(r,i)=>{e(r,i),t(r,i)}:e}function YU(n,e){const t=n.contentQueries;n.contentQueries=t?(r,i,o)=>{e(r,i,o),t(r,i,o)}:e}function ZU(n,e){const t=n.hostBindings;n.hostBindings=t?(r,i)=>{e(r,i),t(r,i)}:e}mi.THROW_IF_NOT_FOUND=Xf,mi.NULL=new lP,mi.\u0275prov=Dn({token:mi,providedIn:"any",factory:()=>yt(Vm)}),mi.__NG_ELEMENT_ID__=-1;let rx=null;function Gm(){if(!rx){const n=jr.Symbol;if(n&&n.iterator)rx=n.iterator;else{const e=Object.getOwnPropertyNames(Map.prototype);for(let t=0;t<e.length;++t){const r=e[t];"entries"!==r&&"size"!==r&&Map.prototype[r]===Map.prototype.entries&&(rx=r)}}}return rx}class Jh{constructor(e){this.wrapped=e}static wrap(e){return new Jh(e)}static unwrap(e){return Jh.isWrapped(e)?e.wrapped:e}static isWrapped(e){return e instanceof Jh}}function hv(n){return!!QC(n)&&(Array.isArray(n)||!(n instanceof Map)&&Gm()in n)}function QC(n){return null!==n&&("function"==typeof n||"object"==typeof n)}function Lu(n,e,t){return!Object.is(n[e],t)&&(n[e]=t,!0)}function nc(n,e,t,r){const i=l();return Lu(i,C(),e)&&(d(),ls(Ye(),i,n,e,t,r)),nc}function Hm(n,e,t,r){return Lu(n,C(),t)?e+Nn(t)+r:Zr}function Qh(n,e,t,r,i,o,s,u){const f=l(),g=d(),v=n+20,E=g.firstCreatePass?function(n,e,t,r,i,o,s,u,f){const g=e.consts,v=ge(e,n,4,s||null,la(g,u));xs(e,t,v,la(g,f)),Kn(e,v);const E=v.tViews=en(2,v,r,i,o,e.directiveRegistry,e.pipeRegistry,null,e.schemas,g);return null!==e.queries&&(e.queries.template(e,v),E.queries=e.queries.embeddedTView(v)),v}(v,g,f,e,t,r,i,o,s):g.data[v];j(E,!1);const T=f[11].createComment("");up(g,f,T,E),Ha(T,f),tu(f,f[v]=Nc(T,f,T,E)),Da(E)&&Pt(g,f,E),null!=s&&tn(f,E,u)}function Mt(n,e=or.Default){const t=l();return null===t?yt(n,e):iy(b(),t,Ln(n),e)}function va(n,e,t){const r=l();return Lu(r,C(),e)&&$n(d(),Ye(),r,n,e,r[11],t,!1),va}function iS(n,e,t,r,i){const s=i?"class":"style";aP(n,t,e.inputs[s],s,r)}function cn(n,e,t,r){const i=l(),o=d(),s=20+n,u=i[11],f=i[s]=wm(u,e,Sr.lFrame.currentNamespace),g=o.firstCreatePass?function(n,e,t,r,i,o,s){const u=e.consts,g=ge(e,n,2,i,la(u,o));return xs(e,t,g,la(u,s)),null!==g.attrs&&nx(g,g.attrs,!1),null!==g.mergedAttrs&&nx(g,g.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,g),g}(s,o,i,0,e,t,r):o.data[s];j(g,!0);const v=g.mergedAttrs;null!==v&&ts(u,f,v);const E=g.classes;null!==E&&qy(u,f,E);const T=g.styles;null!==T&&Am(u,f,T),64!=(64&g.flags)&&up(o,i,f,g),0===Sr.lFrame.elementDepthCount&&Ha(f,i),Sr.lFrame.elementDepthCount++,Da(g)&&(Pt(o,i,g),Rt(o,g,i)),null!==r&&tn(i,g)}function hn(){let n=b();ne()?Ee():(n=n.parent,j(n,!1));const e=n;Sr.lFrame.elementDepthCount--;const t=d();t.firstCreatePass&&(Kn(t,n),ma(n)&&t.queries.elementEnd(n)),null!=e.classesWithoutHost&&function(n){return 0!=(16&n.flags)}(e)&&iS(t,e,l(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function(n){return 0!=(32&n.flags)}(e)&&iS(t,e,l(),e.stylesWithoutHost,!1)}function Ar(n,e,t,r){cn(n,e,t,r),hn()}function fv(n){return!!n&&"function"==typeof n.then}function JP(n){return!!n&&"function"==typeof n.subscribe}const sx=JP;function Xs(n,e,t,r){const i=l(),o=d(),s=b();return QP(o,i,i[11],s,n,e,!!t,r),Xs}function aS(n,e){const t=b(),r=l(),i=d();return QP(i,r,oP(U(i.data),t,r),t,n,e,!1),aS}function QP(n,e,t,r,i,o,s,u){const f=Da(r),v=n.firstCreatePass&&Ad(n),E=e[8],T=av(e);let R=!0;if(3&r.type||u){const G=_s(r,e),W=u?u(G):G,H=T.length,ee=u?_e=>u(Cs(_e[r.index])):r.index;if(Go(t)){let _e=null;if(!u&&f&&(_e=function(n,e,t,r){const i=n.cleanup;if(null!=i)for(let o=0;o<i.length-1;o+=2){const s=i[o];if(s===t&&i[o+1]===r){const u=e[7],f=i[o+2];return u.length>f?u[f]:null}"string"==typeof s&&(o+=2)}return null}(n,e,i,r.index)),null!==_e)(_e.__ngLastListenerFn__||_e).__ngNextListenerFn__=o,_e.__ngLastListenerFn__=o,R=!1;else{o=lS(r,e,E,o,!1);const ye=t.listen(W,i,o);T.push(o,ye),v&&v.push(i,ee,H,H+1)}}else o=lS(r,e,E,o,!0),W.addEventListener(i,o,s),T.push(o),v&&v.push(i,ee,H,s)}else o=lS(r,e,E,o,!1);const B=r.outputs;let z;if(R&&null!==B&&(z=B[i])){const G=z.length;if(G)for(let W=0;W<G;W+=2){const $e=e[z[W]][z[W+1]].subscribe(o),We=T.length;T.push(o,$e),v&&v.push(i,r.index,We,-(We+1))}}}function e2(n,e,t,r){try{return!1!==t(r)}catch(i){return sP(n,i),!1}}function lS(n,e,t,r,i){return function o(s){if(s===Function)return r;const u=2&n.flags?aa(n.index,e):e;0==(32&e[2])&&mf(u);let f=e2(e,0,r,s),g=o.__ngNextListenerFn__;for(;g;)f=e2(e,0,g,s)&&f,g=g.__ngNextListenerFn__;return i&&!1===f&&(s.preventDefault(),s.returnValue=!1),f}}function vf(n=1){return function(n){return(Sr.lFrame.contextLView=function(n,e){for(;n>0;)e=e[15],n--;return e}(n,Sr.lFrame.contextLView))[8]}(n)}function e_(n,e,t){return uS(n,"",e,"",t),e_}function uS(n,e,t,r,i){const o=l(),s=Hm(o,e,t,r);return s!==Zr&&$n(d(),Ye(),o,n,s,o[11],i,!1),uS}function c2(n,e,t,r,i){const o=n[t+1],s=null===e;let u=r?bc(o):Qu(o),f=!1;for(;0!==u&&(!1===f||s);){const v=n[u+1];L6(n[u],e)&&(f=!0,n[u+1]=r?tv(v):Ll(v)),u=r?bc(v):Qu(v)}f&&(n[t+1]=r?Ll(o):tv(o))}function L6(n,e){return null===n||null==e||(Array.isArray(n)?n[1]:n)===e||!(!Array.isArray(n)||"string"!=typeof e)&&Wf(n,e)>=0}function xf(n,e){return function(n,e,t,r){const i=l(),o=d(),s=function(n){const e=Sr.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}(2);o.firstUpdatePass&&function(n,e,t,r){const i=n.data;if(null===i[t+1]){const o=i[ot()],s=function(n,e){return e>=n.expandoStartIndex}(n,t);(function(n,e){return 0!=(n.flags&(e?16:32))})(o,r)&&null===e&&!s&&(e=!1),e=function(n,e,t,r){const i=U(n);let o=r?e.residualClasses:e.residualStyles;if(null===i)0===(r?e.classBindings:e.styleBindings)&&(t=gv(t=hS(null,n,e,t,r),e.attrs,r),o=null);else{const s=e.directiveStylingLast;if(-1===s||n[s]!==i)if(t=hS(i,n,e,t,r),null===o){let f=function(n,e,t){const r=t?e.classBindings:e.styleBindings;if(0!==Qu(r))return n[bc(r)]}(n,e,r);void 0!==f&&Array.isArray(f)&&(f=hS(null,n,e,f[1],r),f=gv(f,e.attrs,r),function(n,e,t,r){n[bc(t?e.classBindings:e.styleBindings)]=r}(n,e,r,f))}else o=function(n,e,t){let r;const i=e.directiveEnd;for(let o=1+e.directiveStylingLast;o<i;o++)r=gv(r,n[o].hostAttrs,t);return gv(r,e.attrs,t)}(n,e,r)}return void 0!==o&&(r?e.residualClasses=o:e.residualStyles=o),t}(i,o,e,r),function(n,e,t,r,i,o){let s=o?e.classBindings:e.styleBindings,u=bc(s),f=Qu(s);n[r]=t;let v,g=!1;if(Array.isArray(t)){const E=t;v=E[1],(null===v||Wf(E,v)>0)&&(g=!0)}else v=t;if(i)if(0!==f){const T=bc(n[u+1]);n[r+1]=Rm(T,u),0!==T&&(n[T+1]=km(n[T+1],r)),n[u+1]=function(n,e){return 131071&n|e<<17}(n[u+1],r)}else n[r+1]=Rm(u,0),0!==u&&(n[u+1]=km(n[u+1],r)),u=r;else n[r+1]=Rm(f,0),0===u?u=r:n[f+1]=km(n[f+1],r),f=r;g&&(n[r+1]=Ll(n[r+1])),c2(n,v,r,!0),c2(n,v,r,!1),function(n,e,t,r,i){const o=i?n.residualClasses:n.residualStyles;null!=o&&"string"==typeof e&&Wf(o,e)>=0&&(t[r+1]=tv(t[r+1]))}(e,v,n,r,o),s=Rm(u,f),o?e.classBindings=s:e.styleBindings=s}(i,o,e,t,s,r)}}(o,n,s,r),e!==Zr&&Lu(i,s,e)&&function(n,e,t,r,i,o,s,u){if(!(3&e.type))return;const f=n.data,g=f[u+1];lx(function(n){return 1==(1&n)}(g)?b2(f,e,t,i,Qu(g),s):void 0)||(lx(o)||function(n){return 2==(2&n)}(g)&&(o=b2(f,null,t,i,u,s)),function(n,e,t,r,i){const o=Go(n);if(e)i?o?n.addClass(t,r):t.classList.add(r):o?n.removeClass(t,r):t.classList.remove(r);else{let s=-1===r.indexOf("-")?void 0:Ru.DashCase;if(null==i)o?n.removeStyle(t,r,s):t.style.removeProperty(r);else{const u="string"==typeof i&&i.endsWith("!important");u&&(i=i.slice(0,-10),s|=Ru.Important),o?n.setStyle(t,r,i,s):t.style.setProperty(r,i,u?"important":"")}}}(r,s,Bh(ot(),t),i,o))}(o,o.data[ot()],i,i[11],n,i[s+1]=function(n,e){return null==n||("string"==typeof e?n+=e:"object"==typeof n&&(n=Nr(mu(n)))),n}(e,t),r,s)}(n,e,null,!0),xf}function hS(n,e,t,r,i){let o=null;const s=t.directiveEnd;let u=t.directiveStylingLast;for(-1===u?u=t.directiveStart:u++;u<s&&(o=e[u],r=gv(r,o.hostAttrs,i),o!==n);)u++;return null!==n&&(t.directiveStylingLast=u),r}function gv(n,e,t){const r=t?1:2;let i=-1;if(null!==e)for(let o=0;o<e.length;o++){const s=e[o];"number"==typeof s?i=s:i===r&&(Array.isArray(n)||(n=void 0===n?[]:["",n]),Du(n,s,!!t||e[++o]))}return void 0===n?null:n}function b2(n,e,t,r,i,o){const s=null===e;let u;for(;i>0;){const f=n[i],g=Array.isArray(f),v=g?f[1]:f,E=null===v;let T=t[i+1];T===Zr&&(T=E?ro:void 0);let R=E?hy(T,r):v===r?T:void 0;if(g&&!lx(R)&&(R=hy(f,r)),lx(R)&&(u=R,s))return u;const B=n[i+1];i=s?bc(B):Qu(B)}if(null!==e){let f=o?e.residualClasses:e.residualStyles;null!=f&&(u=hy(f,r))}return u}function lx(n){return void 0!==n}function Zn(n,e=""){const t=l(),r=d(),i=n+20,o=r.firstCreatePass?ge(r,i,1,e,null):r.data[i],s=t[i]=function(n,e){return Go(n)?n.createText(e):n.createTextNode(e)}(t[11],e);up(r,t,s,o),j(o,!1)}function mv(n){return dg("",n,""),mv}function dg(n,e,t){const r=l(),i=Hm(r,n,e,t);return i!==Zr&&_f(r,ot(),i),dg}function n_(n,e,t){const r=l();return Lu(r,C(),e)&&$n(d(),Ye(),r,n,e,r[11],t,!0),n_}function dS(n,e,t){const r=l();if(Lu(r,C(),e)){const o=d(),s=Ye();$n(o,s,r,n,e,oP(U(o.data),s,r),t,!0)}return dS}const fg=void 0;var m8=["en",[["a","p"],["AM","PM"],fg],[["AM","PM"],fg,fg],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],fg,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],fg,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",fg,"{1} 'at' {0}",fg],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function(n){const e=Math.floor(Math.abs(n)),t=n.toString().replace(/^[^.]*\.?/,"").length;return 1===e&&0===t?1:5}];let r_={};function U2(n){return n in r_||(r_[n]=jr.ng&&jr.ng.common&&jr.ng.common.locales&&jr.ng.common.locales[n]),r_[n]}var er=(()=>((er=er||{})[er.LocaleId=0]="LocaleId",er[er.DayPeriodsFormat=1]="DayPeriodsFormat",er[er.DayPeriodsStandalone=2]="DayPeriodsStandalone",er[er.DaysFormat=3]="DaysFormat",er[er.DaysStandalone=4]="DaysStandalone",er[er.MonthsFormat=5]="MonthsFormat",er[er.MonthsStandalone=6]="MonthsStandalone",er[er.Eras=7]="Eras",er[er.FirstDayOfWeek=8]="FirstDayOfWeek",er[er.WeekendRange=9]="WeekendRange",er[er.DateFormat=10]="DateFormat",er[er.TimeFormat=11]="TimeFormat",er[er.DateTimeFormat=12]="DateTimeFormat",er[er.NumberSymbols=13]="NumberSymbols",er[er.NumberFormats=14]="NumberFormats",er[er.CurrencyCode=15]="CurrencyCode",er[er.CurrencySymbol=16]="CurrencySymbol",er[er.CurrencyName=17]="CurrencyName",er[er.Currencies=18]="Currencies",er[er.Directionality=19]="Directionality",er[er.PluralCase=20]="PluralCase",er[er.ExtraData=21]="ExtraData",er))();const ux="en-US";let j2=ux;function fS(n){Pr(n,"Expected localeId to be defined"),"string"==typeof n&&(j2=n.toLowerCase().replace(/_/g,"-"))}function mS(n,e,t,r,i){if(n=Ln(n),Array.isArray(n))for(let o=0;o<n.length;o++)mS(n[o],e,t,r,i);else{const o=d(),s=l();let u=jm(n)?n:Ln(n.provide),f=hP(n);const g=b(),v=1048575&g.providerIndexes,E=g.directiveStart,T=g.providerIndexes>>20;if(jm(n)||!n.multi){const R=new uo(f,i,Mt),B=yS(u,e,i?v:v+T,E);-1===B?(zp(jf(g,s),o,u),_S(o,n,e.length),e.push(u),g.directiveStart++,g.directiveEnd++,i&&(g.providerIndexes+=1048576),t.push(R),s.push(R)):(t[B]=R,s[B]=R)}else{const R=yS(u,e,v+T,E),B=yS(u,e,v,v+T),z=R>=0&&t[R],G=B>=0&&t[B];if(i&&!G||!i&&!z){zp(jf(g,s),o,u);const W=function(n,e,t,r,i){const o=new uo(n,t,Mt);return o.multi=[],o.index=e,o.componentProviders=0,dR(o,i,r&&!t),o}(i?fj:dj,t.length,i,r,f);!i&&G&&(t[B].providerFactory=W),_S(o,n,e.length,0),e.push(u),g.directiveStart++,g.directiveEnd++,i&&(g.providerIndexes+=1048576),t.push(W),s.push(W)}else _S(o,n,R>-1?R:B,dR(t[i?B:R],f,!i&&r));!i&&r&&G&&t[B].componentProviders++}}}function _S(n,e,t,r){const i=jm(e);if(i||function(n){return!!n.useClass}(e)){const s=(e.useClass||e).prototype.ngOnDestroy;if(s){const u=n.destroyHooks||(n.destroyHooks=[]);if(!i&&e.multi){const f=u.indexOf(t);-1===f?u.push(t,[r,s]):u[f+1].push(r,s)}else u.push(t,s)}}}function dR(n,e,t){return t&&n.componentProviders++,n.multi.push(e)-1}function yS(n,e,t,r){for(let i=t;i<r;i++)if(e[i]===n)return i;return-1}function dj(n,e,t,r){return vS(this.multi,[])}function fj(n,e,t,r){const i=this.multi;let o;if(this.providerFactory){const s=this.providerFactory.componentProviders,u=Gf(t,t[1],this.providerFactory.index,r);o=u.slice(0,s),vS(i,o);for(let f=s;f<u.length;f++)o.push(u[f])}else o=[],vS(i,o);return o}function vS(n,e){for(let t=0;t<n.length;t++)e.push((0,n[t])());return e}function is(n,e=[]){return t=>{t.providersResolver=(r,i)=>function(n,e,t){const r=d();if(r.firstCreatePass){const i=js(n);mS(t,r.data,r.blueprint,i,!0),mS(e,r.data,r.blueprint,i,!1)}}(r,i?i(n):n,e)}}class fR{}const gR="ngComponent";class mj{resolveComponentFactory(e){throw function(n){const e=Error(`No component factory found for ${Nr(n)}. Did you add it to @NgModule.entryComponents?`);return e[gR]=n,e}(e)}}class kd{}function px(...n){}function o_(n,e){return new Po(_s(n,e))}kd.NULL=new mj;const vj=function(){return o_(b(),l())};let Po=(()=>{class n{constructor(t){this.nativeElement=t}}return n.__NG_ELEMENT_ID__=vj,n})();function mR(n){return n instanceof Po?n.nativeElement:n}class pg{}let bf=(()=>{class n{}return n.__NG_ELEMENT_ID__=()=>bj(),n})();const bj=function(){const n=l(),t=aa(b().index,n);return function(n){return n[11]}(ga(t)?t:n)};let bS=(()=>{class n{}return n.\u0275prov=Dn({token:n,providedIn:"root",factory:()=>null}),n})();class fp{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}}const _R=new fp("12.2.1");class yR{constructor(){}supports(e){return hv(e)}create(e){return new Sj(e)}}const Cj=(n,e)=>e;class Sj{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||Cj}forEachItem(e){let t;for(t=this._itHead;null!==t;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,r=this._removalsHead,i=0,o=null;for(;t||r;){const s=!r||t&&t.currentIndex<xR(r,i,o)?t:r,u=xR(s,i,o),f=s.currentIndex;if(s===r)i--,r=r._nextRemoved;else if(t=t._next,null==s.previousIndex)i++;else{o||(o=[]);const g=u-i,v=f-i;if(g!=v){for(let T=0;T<g;T++){const R=T<o.length?o[T]:o[T]=0,B=R+T;v<=B&&B<g&&(o[T]=R+1)}o[s.previousIndex]=v-g}}u!==f&&e(s,u,f)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)}diff(e){if(null==e&&(e=[]),!hv(e))throw new Error(`Error trying to diff '${Nr(e)}'. Only arrays and iterables are allowed`);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let i,o,s,t=this._itHead,r=!1;if(Array.isArray(e)){this.length=e.length;for(let u=0;u<this.length;u++)o=e[u],s=this._trackByFn(u,o),null!==t&&Object.is(t.trackById,s)?(r&&(t=this._verifyReinsertion(t,o,s,u)),Object.is(t.item,o)||this._addIdentityChange(t,o)):(t=this._mismatch(t,o,s,u),r=!0),t=t._next}else i=0,function(n,e){if(Array.isArray(n))for(let t=0;t<n.length;t++)e(n[t]);else{const t=n[Gm()]();let r;for(;!(r=t.next()).done;)e(r.value)}}(e,u=>{s=this._trackByFn(i,u),null!==t&&Object.is(t.trackById,s)?(r&&(t=this._verifyReinsertion(t,u,s,i)),Object.is(t.item,u)||this._addIdentityChange(t,u)):(t=this._mismatch(t,u,s,i),r=!0),t=t._next,i++}),this.length=i;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,r,i){let o;return null===e?o=this._itTail:(o=e._prev,this._remove(e)),null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(r,null))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,o,i)):null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(r,i))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,o,i)):e=this._addAfter(new Mj(t,r),o,i),e}_verifyReinsertion(e,t,r,i){let o=null===this._unlinkedRecords?null:this._unlinkedRecords.get(r,null);return null!==o?e=this._reinsertAfter(o,e._prev,i):e.currentIndex!=i&&(e.currentIndex=i,this._addToMoves(e,i)),e}_truncate(e){for(;null!==e;){const t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,r){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);const i=e._prevRemoved,o=e._nextRemoved;return null===i?this._removalsHead=o:i._nextRemoved=o,null===o?this._removalsTail=i:o._prevRemoved=i,this._insertAfter(e,t,r),this._addToMoves(e,r),e}_moveAfter(e,t,r){return this._unlink(e),this._insertAfter(e,t,r),this._addToMoves(e,r),e}_addAfter(e,t,r){return this._insertAfter(e,t,r),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}_insertAfter(e,t,r){const i=null===t?this._itHead:t._next;return e._next=i,e._prev=t,null===i?this._itTail=e:i._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new vR),this._linkedRecords.put(e),e.currentIndex=r,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);const t=e._prev,r=e._next;return null===t?this._itHead=r:t._next=r,null===r?this._itTail=t:r._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}_addToRemovals(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new vR),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}class Mj{constructor(e,t){this.item=e,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class Tj{constructor(){this._head=null,this._tail=null}add(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let r;for(r=this._head;null!==r;r=r._nextDup)if((null===t||t<=r.currentIndex)&&Object.is(r.trackById,e))return r;return null}remove(e){const t=e._prevDup,r=e._nextDup;return null===t?this._head=r:t._nextDup=r,null===r?this._tail=t:r._prevDup=t,null===this._head}}class vR{constructor(){this.map=new Map}put(e){const t=e.trackById;let r=this.map.get(t);r||(r=new Tj,this.map.set(t,r)),r.add(e)}get(e,t){const i=this.map.get(e);return i?i.get(e,t):null}remove(e){const t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function xR(n,e,t){const r=n.previousIndex;if(null===r)return r;let i=0;return t&&r<t.length&&(i=t[r]),r+e+i}class bR{constructor(){}supports(e){return e instanceof Map||QC(e)}create(){return new Dj}}class Dj{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(e){let t;for(t=this._mapHead;null!==t;t=t._next)e(t)}forEachPreviousItem(e){let t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)e(t)}forEachChangedItem(e){let t;for(t=this._changesHead;null!==t;t=t._nextChanged)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}diff(e){if(e){if(!(e instanceof Map||QC(e)))throw new Error(`Error trying to diff '${Nr(e)}'. Only maps and objects are allowed`)}else e=new Map;return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._mapHead;if(this._appendAfter=null,this._forEach(e,(r,i)=>{if(t&&t.key===i)this._maybeAddToChanges(t,r),this._appendAfter=t,t=t._next;else{const o=this._getOrCreateRecordForKey(i,r);t=this._insertBeforeOrAppend(t,o)}}),t){t._prev&&(t._prev._next=null),this._removalsHead=t;for(let r=t;null!==r;r=r._nextRemoved)r===this._mapHead&&(this._mapHead=null),this._records.delete(r.key),r._nextRemoved=r._next,r.previousValue=r.currentValue,r.currentValue=null,r._prev=null,r._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(e,t){if(e){const r=e._prev;return t._next=e,t._prev=r,e._prev=t,r&&(r._next=t),e===this._mapHead&&(this._mapHead=t),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}_getOrCreateRecordForKey(e,t){if(this._records.has(e)){const i=this._records.get(e);this._maybeAddToChanges(i,t);const o=i._prev,s=i._next;return o&&(o._next=s),s&&(s._prev=o),i._next=null,i._prev=null,i}const r=new Ij(e);return this._records.set(e,r),r.currentValue=t,this._addToAdditions(r),r}_reset(){if(this.isDirty){let e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(e,t){Object.is(t,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=t,this._addToChanges(e))}_addToAdditions(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}_addToChanges(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}_forEach(e,t){e instanceof Map?e.forEach(t):Object.keys(e).forEach(r=>t(e[r],r))}}class Ij{constructor(e){this.key=e,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function wR(){return new s_([new yR])}let s_=(()=>{class n{constructor(t){this.factories=t}static create(t,r){if(null!=r){const i=r.factories.slice();t=t.concat(i)}return new n(t)}static extend(t){return{provide:n,useFactory:r=>n.create(t,r||wR()),deps:[[n,new bd,new Au]]}}find(t){const r=this.factories.find(i=>i.supports(t));if(null!=r)return r;throw new Error(`Cannot find a differ supporting object '${t}' of type '${function(n){return n.name||typeof n}(t)}'`)}}return n.\u0275prov=Dn({token:n,providedIn:"root",factory:wR}),n})();function ER(){return new a_([new bR])}let a_=(()=>{class n{constructor(t){this.factories=t}static create(t,r){if(r){const i=r.factories.slice();t=t.concat(i)}return new n(t)}static extend(t){return{provide:n,useFactory:r=>n.create(t,r||ER()),deps:[[n,new bd,new Au]]}}find(t){const r=this.factories.find(i=>i.supports(t));if(r)return r;throw new Error(`Cannot find a differ supporting object '${t}'`)}}return n.\u0275prov=Dn({token:n,providedIn:"root",factory:ER}),n})();function gx(n,e,t,r,i=!1){for(;null!==t;){const o=e[t.index];if(null!==o&&r.push(Cs(o)),xo(o))for(let u=10;u<o.length;u++){const f=o[u],g=f[1].firstChild;null!==g&&gx(f[1],f,g,r)}const s=t.type;if(8&s)gx(n,e,t.child,r);else if(32&s){const u=Fy(t,e);let f;for(;f=u();)r.push(f)}else if(16&s){const u=Yh(e,t);if(Array.isArray(u))r.push(...u);else{const f=ap(e[16]);gx(f[1],f,u,r,!0)}}t=i?t.projectionNext:t.next}return r}class bv{constructor(e,t){this._lView=e,this._cdRefInjectingView=t,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const e=this._lView,t=e[1];return gx(t,e,t.firstChild,[])}get context(){return this._lView[8]}set context(e){this._lView[8]=e}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[3];if(xo(e)){const t=e[8],r=t?t.indexOf(this):-1;r>-1&&(Md(e,r),vd(t,r))}this._attachedToViewContainer=!1}Sm(this._lView[1],this._lView)}onDestroy(e){Ht(this._lView[1],this._lView,null,e)}markForCheck(){mf(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){Bc(this._lView[1],this._lView,this.context)}checkNoChanges(){!function(n,e,t){vn(!0);try{Bc(n,e,t)}finally{vn(!1)}}(this._lView[1],this._lView,this.context)}attachToViewContainerRef(){if(this._appRef)throw new Error("This view is already attached directly to the ApplicationRef!");this._attachedToViewContainer=!0}detachFromAppRef(){var e;this._appRef=null,Td(this._lView[1],e=this._lView,e[11],2,null,null)}attachToAppRef(e){if(this._attachedToViewContainer)throw new Error("This view is already attached to a ViewContainer!");this._appRef=e}}class Pj extends bv{constructor(e){super(e),this._view=e}detectChanges(){Bm(this._view)}checkNoChanges(){!function(n){vn(!0);try{Bm(n)}finally{vn(!1)}}(this._view)}get context(){return null}}const Oj=function(n){return function(n,e,t){if(_a(n)&&!t){const r=aa(n.index,e);return new bv(r,r)}return 47&n.type?new bv(e[16],e):null}(b(),l(),16==(16&n))};let gg=(()=>{class n{}return n.__NG_ELEMENT_ID__=Oj,n})();const Nj=[new bR],Bj=new s_([new yR]),zj=new a_(Nj),Uj=function(){return mx(b(),l())};let zc=(()=>{class n{}return n.__NG_ELEMENT_ID__=Uj,n})();const jj=zc,Gj=class extends jj{constructor(e,t,r){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=r}createEmbeddedView(e){const t=this._declarationTContainer.tViews,r=J(this._declarationLView,t,e,16,null,t.declTNode,null,null,null,null);r[17]=this._declarationLView[this._declarationTContainer.index];const o=this._declarationLView[19];return null!==o&&(r[19]=o.createEmbeddedView(t)),st(t,r,e),new bv(r)}};function mx(n,e){return 4&n.type?new Gj(e,n,o_(n,e)):null}class Ld{}class CR{}const qj=function(){return TR(b(),l())};let ic=(()=>{class n{}return n.__NG_ELEMENT_ID__=qj,n})();const Xj=ic,SR=class extends Xj{constructor(e,t,r){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=r}get element(){return o_(this._hostTNode,this._hostLView)}get injector(){return new jh(this._hostTNode,this._hostLView)}get parentInjector(){const e=Bp(this._hostTNode,this._hostLView);if(rs(e)){const t=Pa(e,this._hostLView),r=$a(e);return new jh(t[1].data[r+8],t)}return new jh(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const t=MR(this._lContainer);return null!==t&&t[e]||null}get length(){return this._lContainer.length-10}createEmbeddedView(e,t,r){const i=e.createEmbeddedView(t||{});return this.insert(i,r),i}createComponent(e,t,r,i,o){const s=r||this.parentInjector;if(!o&&null==e.ngModule&&s){const f=s.get(Ld,null);f&&(o=f)}const u=e.create(s,i,void 0,o);return this.insert(u.hostView,t),u}insert(e,t){const r=e._lView,i=r[1];if(xo(r[3])){const v=this.indexOf(e);if(-1!==v)this.detach(v);else{const E=r[3],T=new SR(E,E[6],E[3]);T.detach(T.indexOf(e))}}const o=this._adjustIndex(t),s=this._lContainer;!function(n,e,t,r){const i=10+r,o=t.length;r>0&&(t[i-1][4]=e),r<o-10?(e[4]=t[i],qf(t,10+r,e)):(t.push(e),e[4]=null),e[3]=t;const s=e[17];null!==s&&t!==s&&function(n,e){const t=n[9];e[16]!==e[3][3][16]&&(n[2]=!0),null===t?n[9]=[e]:t.push(e)}(s,e);const u=e[19];null!==u&&u.insertView(n),e[2]|=128}(i,r,s,o);const u=Hy(o,s),f=r[11],g=lp(f,s[7]);return null!==g&&function(n,e,t,r,i,o){r[0]=i,r[6]=e,Td(n,r,t,1,i,o)}(i,s[6],f,r,g,u),e.attachToViewContainerRef(),qf(wS(s),o,e),e}move(e,t){return this.insert(e,t)}indexOf(e){const t=MR(this._lContainer);return null!==t?t.indexOf(e):-1}remove(e){const t=this._adjustIndex(e,-1),r=Md(this._lContainer,t);r&&(vd(wS(this._lContainer),t),Sm(r[1],r))}detach(e){const t=this._adjustIndex(e,-1),r=Md(this._lContainer,t);return r&&null!=vd(wS(this._lContainer),t)?new bv(r):null}_adjustIndex(e,t=0){return null==e?this.length+t:e}};function MR(n){return n[8]}function wS(n){return n[8]||(n[8]=[])}function TR(n,e){let t;const r=e[n.index];if(xo(r))t=r;else{let i;if(8&n.type)i=Cs(r);else{const o=e[11];i=o.createComment("");const s=_s(n,e);Ou(o,lp(o,s),i,function(n,e){return Go(n)?n.nextSibling(e):e.nextSibling}(o,s),!1)}e[n.index]=t=Nc(r,e,i,n),tu(e,t)}return new SR(t,n,e)}const h_={};class WR extends kd{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const t=Yo(e);return new YR(t,this.ngModule)}}function XR(n){const e=[];for(let t in n)n.hasOwnProperty(t)&&e.push({propName:n[t],templateName:t});return e}const $G=new gr("SCHEDULER_TOKEN",{providedIn:"root",factory:()=>Oy});class YR extends fR{constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=e.selectors.map(Ky).join(","),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}get inputs(){return XR(this.componentDef.inputs)}get outputs(){return XR(this.componentDef.outputs)}create(e,t,r,i){const o=(i=i||this.ngModule)?function(n,e){return{get:(t,r,i)=>{const o=n.get(t,h_,i);return o!==h_||r===h_?o:e.get(t,r,i)}}}(e,i.injector):e,s=o.get(pg,Bn),u=o.get(bS,null),f=s.createRenderer(null,this.componentDef),g=this.componentDef.selectors[0][0]||"div",v=r?function(n,e,t){if(Go(n))return n.selectRootElement(e,t===xr.ShadowDom);let r="string"==typeof e?n.querySelector(e):e;return r.textContent="",r}(f,r,this.componentDef.encapsulation):wm(s.createRenderer(null,this.componentDef),g,function(n){const e=n.toLowerCase();return"svg"===e?"http://www.w3.org/2000/svg":"math"===e?"http://www.w3.org/1998/MathML/":null}(g)),E=this.componentDef.onPush?576:528,T=function(n,e){return{components:[],scheduler:n||Oy,clean:sv,playerHandler:e||null,flags:0}}(),R=en(0,null,null,1,0,null,null,null,null,null),B=J(null,R,T,E,null,null,s,f,u,o);let z,G;se(B);try{const W=function(n,e,t,r,i,o){const s=t[1];t[20]=n;const f=ge(s,20,2,"#host",null),g=f.mergedAttrs=e.hostAttrs;null!==g&&(nx(f,g,!0),null!==n&&(ts(i,n,g),null!==f.classes&&qy(i,n,f.classes),null!==f.styles&&Am(i,n,f.styles)));const v=r.createRenderer(n,e),E=J(t,dn(e),null,e.onPush?64:16,t[20],f,r,v,o||null,null);return s.firstCreatePass&&(zp(jf(f,t),s,e.type),ua(s,f),pl(f,t.length,1)),tu(t,E),t[20]=E}(v,this.componentDef,B,s,f);if(v)if(r)ts(f,v,["ng-version",_R.full]);else{const{attrs:H,classes:ee}=function(n){const e=[],t=[];let r=1,i=2;for(;r<n.length;){let o=n[r];if("string"==typeof o)2===i?""!==o&&e.push(o,n[++r]):8===i&&t.push(o);else{if(!xc(i))break;i=o}r++}return{attrs:e,classes:t}}(this.componentDef.selectors[0]);H&&ts(f,v,H),ee&&ee.length>0&&qy(f,v,ee.join(" "))}if(G=Ql(R,20),void 0!==t){const H=G.projection=[];for(let ee=0;ee<this.ngContentSelectors.length;ee++){const _e=t[ee];H.push(null!=_e?Array.from(_e):null)}}z=function(n,e,t,r,i){const o=t[1],s=function(n,e,t){const r=b();n.firstCreatePass&&(t.providersResolver&&t.providersResolver(t),Ls(n,r,e,Ze(n,e,1,null),t));const i=Gf(e,n,r.directiveStart,r);Ha(i,e);const o=_s(r,e);return o&&Ha(o,e),i}(o,t,e);if(r.components.push(s),n[8]=s,i&&i.forEach(f=>f(s,e)),e.contentQueries){const f=b();e.contentQueries(1,s,f.directiveStart)}const u=b();return!o.firstCreatePass||null===e.hostBindings&&null===e.hostAttrs||(Xe(u.index),zo(t[1],u,0,u.directiveStart,u.directiveEnd,e),qa(e,s)),s}(W,this.componentDef,B,T,[qU]),st(R,B,null)}finally{Te()}return new WG(this.componentType,z,o_(G,B),B,G)}}class WG extends class{}{constructor(e,t,r,i,o){super(),this.location=r,this._rootLView=i,this._tNode=o,this.instance=t,this.hostView=this.changeDetectorRef=new Pj(i),this.componentType=e}get injector(){return new jh(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}const d_=new Map;class ZG extends Ld{constructor(e,t){super(),this._parent=t,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new WR(this);const r=Cr(e),i=e[Jc]||null;i&&fS(i),this._bootstrapComponents=fh(r.bootstrap),this._r3Injector=cP(e,t,[{provide:Ld,useValue:this},{provide:kd,useValue:this.componentFactoryResolver}],Nr(e)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(e)}get(e,t=mi.THROW_IF_NOT_FOUND,r=or.Default){return e===mi||e===Ld||e===Vm?this:this._r3Injector.get(e,t,r)}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class LS extends CR{constructor(e){super(),this.moduleType=e,null!==Cr(e)&&function(n){const e=new Set;!function t(r){const i=Cr(r,!0),o=i.id;null!==o&&(function(n,e,t){if(e&&e!==t)throw new Error(`Duplicate module registered for ${n} - ${Nr(e)} vs ${Nr(e.name)}`)}(o,d_.get(o),r),d_.set(o,r));const s=fh(i.imports);for(const u of s)e.has(u)||(e.add(u),t(u))}(n)}(e)}create(e){return new ZG(this.moduleType,e)}}function f_(n,e,t,r){return JR(l(),pn(),n,e,t,r)}function JR(n,e,t,r,i,o){const s=e+t;return Lu(n,s,i)?function(n,e,t){return n[e]=t}(n,s+1,o?r.call(o,i):r(i)):function(n,e){const t=n[e];return t===Zr?void 0:t}(n,s+1)}function bx(n,e){const t=d();let r;const i=n+20;t.firstCreatePass?(r=function(n,e){if(e)for(let t=e.length-1;t>=0;t--){const r=e[t];if(n===r.name)return r}throw new Qs("302",`The pipe '${n}' could not be found!`)}(e,t.pipeRegistry),t.data[i]=r,r.onDestroy&&(t.destroyHooks||(t.destroyHooks=[])).push(i,r.onDestroy)):r=t.data[i];const o=r.factory||(r.factory=dl(r.type)),s=ss(Mt);try{const u=Kd(!1),f=o();return Kd(u),function(n,e,t,r){t>=n.data.length&&(n.data[t]=null,n.blueprint[t]=null),e[t]=r}(t,l(),i,f),f}finally{ss(s)}}function wx(n,e,t){const r=n+20,i=l(),o=function(n,e){return n[e]}(i,r);return function(n,e){Jh.isWrapped(e)&&(e=Jh.unwrap(e),n[Sr.lFrame.bindingIndex]=Zr);return e}(i,function(n,e){return n[1].data[e].pure}(i,r)?JR(i,pn(),e,o.transform,t,o):o.transform(t))}function NS(n){return e=>{setTimeout(n,void 0,e)}}const Ro=class extends wt{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,t,r){var i,o,s;let u=e,f=t||(()=>null),g=r;if(e&&"object"==typeof e){const E=e;u=null===(i=E.next)||void 0===i?void 0:i.bind(E),f=null===(o=E.error)||void 0===o?void 0:o.bind(E),g=null===(s=E.complete)||void 0===s?void 0:s.bind(E)}this.__isAsync&&(f=NS(f),u&&(u=NS(u)),g&&(g=NS(g)));const v=super.subscribe({next:u,error:f,complete:g});return e instanceof Ce&&e.add(v),v}};function d$(){return this._results[Gm()]()}class Ex{constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const t=Gm(),r=Ex.prototype;r[t]||(r[t]=d$)}get changes(){return this._changes||(this._changes=new Ro)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){const r=this;r.dirty=!1;const i=Tu(e);(this._changesDetected=!function(n,e,t){if(n.length!==e.length)return!1;for(let r=0;r<n.length;r++){let i=n[r],o=e[r];if(t&&(i=t(i),o=t(o)),o!==i)return!1}return!0}(r._results,i,t))&&(r._results=i,r.length=i.length,r.last=i[this.length-1],r.first=i[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}Symbol;class FS{constructor(e){this.queryList=e,this.matches=null}clone(){return new FS(this.queryList)}setDirty(){this.queryList.setDirty()}}class BS{constructor(e=[]){this.queries=e}createEmbeddedView(e){const t=e.queries;if(null!==t){const r=null!==e.contentQueries?e.contentQueries[0]:t.length,i=[];for(let o=0;o<r;o++){const s=t.getByIndex(o);i.push(this.queries[s.indexInDeclarationView].clone())}return new BS(i)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)null!==aO(e,t).matches&&this.queries[t].setDirty()}}class rO{constructor(e,t,r=null){this.predicate=e,this.flags=t,this.read=r}}class zS{constructor(e=[]){this.queries=e}elementStart(e,t){for(let r=0;r<this.queries.length;r++)this.queries[r].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let r=0;r<this.length;r++){const i=null!==t?t.length:0,o=this.getByIndex(r).embeddedTView(e,i);o&&(o.indexInDeclarationView=r,null!==t?t.push(o):t=[o])}return null!==t?new zS(t):null}template(e,t){for(let r=0;r<this.queries.length;r++)this.queries[r].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}}class VS{constructor(e,t=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new VS(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const t=this._declarationNodeIndex;let r=e.parent;for(;null!==r&&8&r.type&&r.index!==t;)r=r.parent;return t===(null!==r?r.index:-1)}return this._appliesToNextNode}matchTNode(e,t){const r=this.metadata.predicate;if(Array.isArray(r))for(let i=0;i<r.length;i++){const o=r[i];this.matchTNodeWithReadOption(e,t,g$(t,o)),this.matchTNodeWithReadOption(e,t,Qd(t,e,o,!1,!1))}else r===zc?4&t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,Qd(t,e,r,!1,!1))}matchTNodeWithReadOption(e,t,r){if(null!==r){const i=this.metadata.read;if(null!==i)if(i===Po||i===ic||i===zc&&4&t.type)this.addMatch(t.index,-2);else{const o=Qd(t,e,i,!1,!1);null!==o&&this.addMatch(t.index,o)}else this.addMatch(t.index,r)}}addMatch(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}function g$(n,e){const t=n.localNames;if(null!==t)for(let r=0;r<t.length;r+=2)if(t[r]===e)return t[r+1];return null}function _$(n,e,t,r){return-1===t?function(n,e){return 11&n.type?o_(n,e):4&n.type?mx(n,e):null}(e,n):-2===t?function(n,e,t){return t===Po?o_(e,n):t===zc?mx(e,n):t===ic?TR(e,n):void 0}(n,e,r):Gf(n,n[1],t,e)}function iO(n,e,t,r){const i=e[19].queries[r];if(null===i.matches){const o=n.data,s=t.matches,u=[];for(let f=0;f<s.length;f+=2){const g=s[f];u.push(g<0?null:_$(e,o[g],s[f+1],t.metadata.read))}i.matches=u}return i.matches}function US(n,e,t,r){const i=n.queries.getByIndex(t),o=i.matches;if(null!==o){const s=iO(n,e,i,t);for(let u=0;u<o.length;u+=2){const f=o[u];if(f>0)r.push(s[u/2]);else{const g=o[u+1],v=e[-f];for(let E=10;E<v.length;E++){const T=v[E];T[17]===T[3]&&US(T[1],T,g,r)}if(null!==v[9]){const E=v[9];for(let T=0;T<E.length;T++){const R=E[T];US(R[1],R,g,r)}}}}}return r}function p_(n){const e=l(),t=d(),r=q();Y(r+1);const i=aO(t,r);if(n.dirty&&Il(e)===(2==(2&i.metadata.flags))){if(null===i.matches)n.reset([]);else{const o=i.crossesNgTemplate?US(t,e,r,[]):iO(t,e,i,r);n.reset(o,mR),n.notifyOnChanges()}return!0}return!1}function Cx(n,e,t){const r=d();r.firstCreatePass&&(sO(r,new rO(n,e,t),-1),2==(2&e)&&(r.staticViewQueries=!0)),oO(r,l(),e)}function jS(n,e,t,r){const i=d();if(i.firstCreatePass){const o=b();sO(i,new rO(e,t,r),o.index),function(n,e){const t=n.contentQueries||(n.contentQueries=[]);e!==(t.length?t[t.length-1]:-1)&&t.push(n.queries.length-1,e)}(i,n),2==(2&t)&&(i.staticContentQueries=!0)}oO(i,l(),t)}function g_(){return n=l(),e=q(),n[19].queries[e].queryList;var n,e}function oO(n,e,t){const r=new Ex(4==(4&t));Ht(n,e,r,r.destroy),null===e[19]&&(e[19]=new BS),e[19].queries.push(new FS(r))}function sO(n,e,t){null===n.queries&&(n.queries=new zS),n.queries.track(new VS(e,t))}function aO(n,e){return n.queries.getByIndex(e)}const Ov=new gr("Application Initializer");let __=(()=>{class n{constructor(t){this.appInits=t,this.resolve=px,this.reject=px,this.initialized=!1,this.done=!1,this.donePromise=new Promise((r,i)=>{this.resolve=r,this.reject=i})}runInitializers(){if(this.initialized)return;const t=[],r=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let i=0;i<this.appInits.length;i++){const o=this.appInits[i]();if(fv(o))t.push(o);else if(sx(o)){const s=new Promise((u,f)=>{o.subscribe({complete:u,error:f})});t.push(s)}}Promise.all(t).then(()=>{r()}).catch(i=>{this.reject(i)}),0===t.length&&r(),this.initialized=!0}}return n.\u0275fac=function(t){return new(t||n)(yt(Ov,8))},n.\u0275prov=Dn({token:n,factory:n.\u0275fac}),n})();const kv=new gr("AppId"),X$={provide:kv,useFactory:function(){return`${XS()}${XS()}${XS()}`},deps:[]};function XS(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const SO=new gr("Platform Initializer"),y_=new gr("Platform ID"),MO=new gr("appBootstrapListener");let Tx=(()=>{class n{log(t){console.log(t)}warn(t){console.warn(t)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Dn({token:n,factory:n.\u0275fac}),n})();const wf=new gr("LocaleId"),TO=new gr("DefaultCurrencyCode");class Z${constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}}const YS=function(n){return new LS(n)},K$=YS,J$=function(n){return Promise.resolve(YS(n))},DO=function(n){const e=YS(n),r=fh(Cr(n).declarations).reduce((i,o)=>{const s=Yo(o);return s&&i.push(new YR(s)),i},[]);return new Z$(e,r)},Q$=DO,eH=function(n){return Promise.resolve(DO(n))};let yg=(()=>{class n{constructor(){this.compileModuleSync=K$,this.compileModuleAsync=J$,this.compileModuleAndAllComponentsSync=Q$,this.compileModuleAndAllComponentsAsync=eH}clearCache(){}clearCacheFor(t){}getModuleId(t){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Dn({token:n,factory:n.\u0275fac}),n})();const rH=(()=>Promise.resolve(0))();function ZS(n){"undefined"==typeof Zone?rH.then(()=>{n&&n.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",n)}class si{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:r=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Ro(!1),this.onMicrotaskEmpty=new Ro(!1),this.onStable=new Ro(!1),this.onError=new Ro(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const i=this;i._nesting=0,i._outer=i._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(i._inner=i._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(i._inner=i._inner.fork(Zone.longStackTraceZoneSpec)),i.shouldCoalesceEventChangeDetection=!r&&t,i.shouldCoalesceRunChangeDetection=r,i.lastRequestAnimationFrameId=-1,i.nativeRequestAnimationFrame=function(){let n=jr.requestAnimationFrame,e=jr.cancelAnimationFrame;if("undefined"!=typeof Zone&&n&&e){const t=n[Zone.__symbol__("OriginalDelegate")];t&&(n=t);const r=e[Zone.__symbol__("OriginalDelegate")];r&&(e=r)}return{nativeRequestAnimationFrame:n,nativeCancelAnimationFrame:e}}().nativeRequestAnimationFrame,function(n){const e=()=>{!function(n){n.isCheckStableRunning||-1!==n.lastRequestAnimationFrameId||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(jr,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,JS(n),n.isCheckStableRunning=!0,KS(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),JS(n))}(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,r,i,o,s,u)=>{try{return IO(n),t.invokeTask(i,o,s,u)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===o.type||n.shouldCoalesceRunChangeDetection)&&e(),AO(n)}},onInvoke:(t,r,i,o,s,u,f)=>{try{return IO(n),t.invoke(i,o,s,u,f)}finally{n.shouldCoalesceRunChangeDetection&&e(),AO(n)}},onHasTask:(t,r,i,o)=>{t.hasTask(i,o),r===i&&("microTask"==o.change?(n._hasPendingMicrotasks=o.microTask,JS(n),KS(n)):"macroTask"==o.change&&(n.hasPendingMacrotasks=o.macroTask))},onHandleError:(t,r,i,o)=>(t.handleError(i,o),n.runOutsideAngular(()=>n.onError.emit(o)),!1)})}(i)}static isInAngularZone(){return!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!si.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(si.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(e,t,r){return this._inner.run(e,t,r)}runTask(e,t,r,i){const o=this._inner,s=o.scheduleEventTask("NgZoneEvent: "+i,e,oH,px,px);try{return o.runTask(s,t,r)}finally{o.cancelTask(s)}}runGuarded(e,t,r){return this._inner.runGuarded(e,t,r)}runOutsideAngular(e){return this._outer.run(e)}}const oH={};function KS(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function JS(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&-1!==n.lastRequestAnimationFrameId)}function IO(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function AO(n){n._nesting--,KS(n)}class lH{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Ro,this.onMicrotaskEmpty=new Ro,this.onStable=new Ro,this.onError=new Ro}run(e,t,r){return e.apply(t,r)}runGuarded(e,t,r){return e.apply(t,r)}runOutsideAngular(e){return e()}runTask(e,t,r,i){return e.apply(t,r)}}let QS=(()=>{class n{constructor(t){this._ngZone=t,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{si.assertNotInAngularZone(),ZS(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())ZS(()=>{for(;0!==this._callbacks.length;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(this._didWork)}this._didWork=!1});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(r=>!r.updateCb||!r.updateCb(t)||(clearTimeout(r.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,r,i){let o=-1;r&&r>0&&(o=setTimeout(()=>{this._callbacks=this._callbacks.filter(s=>s.timeoutId!==o),t(this._didWork,this.getPendingTasks())},r)),this._callbacks.push({doneCb:t,timeoutId:o,updateCb:i})}whenStable(t,r,i){if(i&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(t,r,i),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(t,r,i){return[]}}return n.\u0275fac=function(t){return new(t||n)(yt(si))},n.\u0275prov=Dn({token:n,factory:n.\u0275fac}),n})(),PO=(()=>{class n{constructor(){this._applications=new Map,eM.addToWindow(this)}registerApplication(t,r){this._applications.set(t,r)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,r=!0){return eM.findTestabilityInTree(this,t,r)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Dn({token:n,factory:n.\u0275fac}),n})();class uH{addToWindow(e){}findTestabilityInTree(e,t,r){return null}}let eM=new uH,RO=!0,OO=!1;function tM(){return OO=!0,RO}let id;const kO=new gr("AllowMultipleToken");class nM{constructor(e,t){this.name=e,this.token=t}}function LO(n,e,t=[]){const r=`Platform: ${e}`,i=new gr(r);return(o=[])=>{let s=NO();if(!s||s.injector.get(kO,!1))if(n)n(t.concat(o).concat({provide:i,useValue:!0}));else{const u=t.concat(o).concat({provide:i,useValue:!0},{provide:lv,useValue:"platform"});!function(n){if(id&&!id.destroyed&&!id.injector.get(kO,!1))throw new Error("There can be only one platform. Destroy the previous one to create a new one.");id=n.get(FO);const e=n.get(SO,null);e&&e.forEach(t=>t())}(mi.create({providers:u,name:r}))}return function(n){const e=NO();if(!e)throw new Error("No platform exists!");if(!e.injector.get(n,null))throw new Error("A platform with a different configuration has been created. Please destroy it first.");return e}(i)}}function NO(){return id&&!id.destroyed?id:null}let FO=(()=>{class n{constructor(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(t,r){const u=function(n,e){let t;return t="noop"===n?new lH:("zone.js"===n?void 0:n)||new si({enableLongStackTrace:tM(),shouldCoalesceEventChangeDetection:!!(null==e?void 0:e.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==e?void 0:e.ngZoneRunCoalescing)}),t}(r?r.ngZone:void 0,{ngZoneEventCoalescing:r&&r.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:r&&r.ngZoneRunCoalescing||!1}),f=[{provide:si,useValue:u}];return u.run(()=>{const g=mi.create({providers:f,parent:this.injector,name:t.moduleType.name}),v=t.create(g),E=v.injector.get(uf,null);if(!E)throw new Error("No ErrorHandler. Is platform module (BrowserModule) included?");return u.runOutsideAngular(()=>{const T=u.onError.subscribe({next:R=>{E.handleError(R)}});v.onDestroy(()=>{rM(this._modules,v),T.unsubscribe()})}),function(n,e,t){try{const r=t();return fv(r)?r.catch(i=>{throw e.runOutsideAngular(()=>n.handleError(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>n.handleError(r)),r}}(E,u,()=>{const T=v.injector.get(__);return T.runInitializers(),T.donePromise.then(()=>(fS(v.injector.get(wf,ux)||ux),this._moduleDoBootstrap(v),v))})})}bootstrapModule(t,r=[]){const i=BO({},r);return function(n,e,t){const r=new LS(t);return Promise.resolve(r)}(0,0,t).then(o=>this.bootstrapModuleFactory(o,i))}_moduleDoBootstrap(t){const r=t.injector.get(vg);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(i=>r.bootstrap(i));else{if(!t.instance.ngDoBootstrap)throw new Error(`The module ${Nr(t.instance.constructor)} was bootstrapped, but it does not declare "@NgModule.bootstrap" components nor a "ngDoBootstrap" method. Please define one of these.`);t.instance.ngDoBootstrap(r)}this._modules.push(t)}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Error("The platform has already been destroyed!");this._modules.slice().forEach(t=>t.destroy()),this._destroyListeners.forEach(t=>t()),this._destroyed=!0}get destroyed(){return this._destroyed}}return n.\u0275fac=function(t){return new(t||n)(yt(mi))},n.\u0275prov=Dn({token:n,factory:n.\u0275fac}),n})();function BO(n,e){return Array.isArray(e)?e.reduce(BO,n):Object.assign(Object.assign({},n),e)}let vg=(()=>{class n{constructor(t,r,i,o,s){this._zone=t,this._injector=r,this._exceptionHandler=i,this._componentFactoryResolver=o,this._initStatus=s,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const u=new Ie(g=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{g.next(this._stable),g.complete()})}),f=new Ie(g=>{let v;this._zone.runOutsideAngular(()=>{v=this._zone.onStable.subscribe(()=>{si.assertNotInAngularZone(),ZS(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,g.next(!0))})})});const E=this._zone.onUnstable.subscribe(()=>{si.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{g.next(!1)}))});return()=>{v.unsubscribe(),E.unsubscribe()}});this.isStable=Tr(u,f.pipe(wa()))}bootstrap(t,r){if(!this._initStatus.done)throw new Error("Cannot bootstrap as there are still asynchronous initializers running. Bootstrap components in the `ngDoBootstrap` method of the root module.");let i;i=t instanceof fR?t:this._componentFactoryResolver.resolveComponentFactory(t),this.componentTypes.push(i.componentType);const o=function(n){return n.isBoundToModule}(i)?void 0:this._injector.get(Ld),u=i.create(mi.NULL,[],r||i.selector,o),f=u.location.nativeElement,g=u.injector.get(QS,null),v=g&&u.injector.get(PO);return g&&v&&v.registerApplication(f,g),u.onDestroy(()=>{this.detachView(u.hostView),rM(this.components,u),v&&v.unregisterApplication(f)}),this._loadComponent(u),u}tick(){if(this._runningTick)throw new Error("ApplicationRef.tick is called recursively");try{this._runningTick=!0;for(let t of this._views)t.detectChanges()}catch(t){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(t))}finally{this._runningTick=!1}}attachView(t){const r=t;this._views.push(r),r.attachToAppRef(this)}detachView(t){const r=t;rM(this._views,r),r.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t),this._injector.get(MO,[]).concat(this._bootstrapListeners).forEach(i=>i(t))}ngOnDestroy(){this._views.slice().forEach(t=>t.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return n.\u0275fac=function(t){return new(t||n)(yt(si),yt(mi),yt(uf),yt(kd),yt(__))},n.\u0275prov=Dn({token:n,factory:n.\u0275fac}),n})();function rM(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}class Ix{}class CH{}const SH={factoryPathPrefix:"",factoryPathSuffix:".ngfactory"};let MH=(()=>{class n{constructor(t,r){this._compiler=t,this._config=r||SH}load(t){return this.loadAndCompile(t)}loadAndCompile(t){let[r,i]=t.split("#");return void 0===i&&(i="default"),Ue(8255)(r).then(o=>o[i]).then(o=>jO(o,r,i)).then(o=>this._compiler.compileModuleAsync(o))}loadFactory(t){let[r,i]=t.split("#"),o="NgFactory";return void 0===i&&(i="default",o=""),Ue(8255)(this._config.factoryPathPrefix+r+this._config.factoryPathSuffix).then(s=>s[i+o]).then(s=>jO(s,r,i))}}return n.\u0275fac=function(t){return new(t||n)(yt(yg),yt(CH,8))},n.\u0275prov=Dn({token:n,factory:n.\u0275fac}),n})();function jO(n,e,t){if(!n)throw new Error(`Cannot find '${t}' in '${e}'`);return n}const NH=LO(null,"core",[{provide:y_,useValue:"unknown"},{provide:FO,deps:[mi]},{provide:PO,deps:[]},{provide:Tx,deps:[]}]),UH=[{provide:vg,useClass:vg,deps:[si,mi,uf,kd,__]},{provide:$G,deps:[si],useFactory:function(n){let e=[];return n.onStable.subscribe(()=>{for(;e.length;)e.pop()()}),function(t){e.push(t)}}},{provide:__,useClass:__,deps:[[new Au,Ov]]},{provide:yg,useClass:yg,deps:[]},X$,{provide:s_,useFactory:function(){return Bj},deps:[]},{provide:a_,useFactory:function(){return zj},deps:[]},{provide:wf,useFactory:function(n){return fS(n=n||"undefined"!=typeof $localize&&$localize.locale||ux),n},deps:[[new xd(wf),new Au,new bd]]},{provide:TO,useValue:"USD"}];let GH=(()=>{class n{constructor(t){}}return n.\u0275fac=function(t){return new(t||n)(yt(vg))},n.\u0275mod=Gn({type:n}),n.\u0275inj=Gr({providers:UH}),n})(),zx=null;function Nd(){return zx}const Fr=new gr("DocumentToken");let wg=(()=>{class n{historyGo(t){throw new Error("Not implemented")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Dn({factory:jq,token:n,providedIn:"platform"}),n})();function jq(){return yt(dk)}const Gq=new gr("Location Initialized");let dk=(()=>{class n extends wg{constructor(t){super(),this._doc=t,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Nd().getBaseHref(this._doc)}onPopState(t){const r=Nd().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",t,!1),()=>r.removeEventListener("popstate",t)}onHashChange(t){const r=Nd().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",t,!1),()=>r.removeEventListener("hashchange",t)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(t){this.location.pathname=t}pushState(t,r,i){fk()?this._history.pushState(t,r,i):this.location.hash=i}replaceState(t,r,i){fk()?this._history.replaceState(t,r,i):this.location.hash=i}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}}return n.\u0275fac=function(t){return new(t||n)(yt(Fr))},n.\u0275prov=Dn({factory:$q,token:n,providedIn:"platform"}),n})();function fk(){return!!window.history.pushState}function $q(){return new dk(yt(Fr))}function yM(n,e){if(0==n.length)return e;if(0==e.length)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,2==t?n+e.substring(1):1==t?n+e:n+"/"+e}function pk(n){const e=n.match(/#|\?|$/),t=e&&e.index||n.length;return n.slice(0,t-("/"===n[t-1]?1:0))+n.slice(t)}function Cf(n){return n&&"?"!==n[0]?"?"+n:n}let b_=(()=>{class n{historyGo(t){throw new Error("Not implemented")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Dn({factory:Hq,token:n,providedIn:"root"}),n})();function Hq(n){const e=yt(Fr).location;return new gk(yt(wg),e&&e.origin||"")}const vM=new gr("appBaseHref");let gk=(()=>{class n extends b_{constructor(t,r){if(super(),this._platformLocation=t,this._removeListenerFns=[],null==r&&(r=this._platformLocation.getBaseHrefFromDOM()),null==r)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=r}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return yM(this._baseHref,t)}path(t=!1){const r=this._platformLocation.pathname+Cf(this._platformLocation.search),i=this._platformLocation.hash;return i&&t?`${r}${i}`:r}pushState(t,r,i,o){const s=this.prepareExternalUrl(i+Cf(o));this._platformLocation.pushState(t,r,s)}replaceState(t,r,i,o){const s=this.prepareExternalUrl(i+Cf(o));this._platformLocation.replaceState(t,r,s)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(t=0){var r,i;null===(i=(r=this._platformLocation).historyGo)||void 0===i||i.call(r,t)}}return n.\u0275fac=function(t){return new(t||n)(yt(wg),yt(vM,8))},n.\u0275prov=Dn({token:n,factory:n.\u0275fac}),n})(),qq=(()=>{class n extends b_{constructor(t,r){super(),this._platformLocation=t,this._baseHref="",this._removeListenerFns=[],null!=r&&(this._baseHref=r)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let r=this._platformLocation.hash;return null==r&&(r="#"),r.length>0?r.substring(1):r}prepareExternalUrl(t){const r=yM(this._baseHref,t);return r.length>0?"#"+r:r}pushState(t,r,i,o){let s=this.prepareExternalUrl(i+Cf(o));0==s.length&&(s=this._platformLocation.pathname),this._platformLocation.pushState(t,r,s)}replaceState(t,r,i,o){let s=this.prepareExternalUrl(i+Cf(o));0==s.length&&(s=this._platformLocation.pathname),this._platformLocation.replaceState(t,r,s)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(t=0){var r,i;null===(i=(r=this._platformLocation).historyGo)||void 0===i||i.call(r,t)}}return n.\u0275fac=function(t){return new(t||n)(yt(wg),yt(vM,8))},n.\u0275prov=Dn({token:n,factory:n.\u0275fac}),n})(),w_=(()=>{class n{constructor(t,r){this._subject=new Ro,this._urlChangeListeners=[],this._platformStrategy=t;const i=this._platformStrategy.getBaseHref();this._platformLocation=r,this._baseHref=pk(mk(i)),this._platformStrategy.onPopState(o=>{this._subject.emit({url:this.path(!0),pop:!0,state:o.state,type:o.type})})}path(t=!1){return this.normalize(this._platformStrategy.path(t))}getState(){return this._platformLocation.getState()}isCurrentPathEqualTo(t,r=""){return this.path()==this.normalize(t+Cf(r))}normalize(t){return n.stripTrailingSlash(function(n,e){return n&&e.startsWith(n)?e.substring(n.length):e}(this._baseHref,mk(t)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._platformStrategy.prepareExternalUrl(t)}go(t,r="",i=null){this._platformStrategy.pushState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Cf(r)),i)}replaceState(t,r="",i=null){this._platformStrategy.replaceState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Cf(r)),i)}forward(){this._platformStrategy.forward()}back(){this._platformStrategy.back()}historyGo(t=0){var r,i;null===(i=(r=this._platformStrategy).historyGo)||void 0===i||i.call(r,t)}onUrlChange(t){this._urlChangeListeners.push(t),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)}))}_notifyUrlChangeListeners(t="",r){this._urlChangeListeners.forEach(i=>i(t,r))}subscribe(t,r,i){return this._subject.subscribe({next:t,error:r,complete:i})}}return n.\u0275fac=function(t){return new(t||n)(yt(b_),yt(wg))},n.normalizeQueryParams=Cf,n.joinWithSlash=yM,n.stripTrailingSlash=pk,n.\u0275prov=Dn({factory:Wq,token:n,providedIn:"root"}),n})();function Wq(){return new w_(yt(b_),yt(wg))}function mk(n){return n.replace(/\/index.html$/,"")}var gl=(()=>((gl=gl||{})[gl.Zero=0]="Zero",gl[gl.One=1]="One",gl[gl.Two=2]="Two",gl[gl.Few=3]="Few",gl[gl.Many=4]="Many",gl[gl.Other=5]="Other",gl))();const t9=function(n){return function(n){const e=function(n){return n.toLowerCase().replace(/_/g,"-")}(n);let t=U2(e);if(t)return t;const r=e.split("-")[0];if(t=U2(r),t)return t;if("en"===r)return m8;throw new Error(`Missing locale data for the locale "${n}".`)}(n)[er.PluralCase]};class Yx{}let A9=(()=>{class n extends Yx{constructor(t){super(),this.locale=t}getPluralCategory(t,r){switch(t9(r||this.locale)(t)){case gl.Zero:return"zero";case gl.One:return"one";case gl.Two:return"two";case gl.Few:return"few";case gl.Many:return"many";default:return"other"}}}return n.\u0275fac=function(t){return new(t||n)(yt(wf))},n.\u0275prov=Dn({token:n,factory:n.\u0275fac}),n})();function Sk(n,e){e=encodeURIComponent(e);for(const t of n.split(";")){const r=t.indexOf("="),[i,o]=-1==r?[t,""]:[t.slice(0,r),t.slice(r+1)];if(i.trim()===e)return decodeURIComponent(o)}return null}class O9{constructor(e,t,r,i){this.$implicit=e,this.ngForOf=t,this.index=r,this.count=i}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let Mk=(()=>{class n{constructor(t,r,i){this._viewContainer=t,this._template=r,this._differs=i,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const t=this._ngForOf;if(!this._differ&&t)try{this._differ=this._differs.find(t).create(this.ngForTrackBy)}catch(r){throw new Error(`Cannot find a differ supporting object '${t}' of type '${function(n){return n.name||typeof n}(t)}'. NgFor only supports binding to Iterables such as Arrays.`)}}if(this._differ){const t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){const r=[];t.forEachOperation((i,o,s)=>{if(null==i.previousIndex){const u=this._viewContainer.createEmbeddedView(this._template,new O9(null,this._ngForOf,-1,-1),null===s?void 0:s),f=new Tk(i,u);r.push(f)}else if(null==s)this._viewContainer.remove(null===o?void 0:o);else if(null!==o){const u=this._viewContainer.get(o);this._viewContainer.move(u,s);const f=new Tk(i,u);r.push(f)}});for(let i=0;i<r.length;i++)this._perViewChange(r[i].view,r[i].record);for(let i=0,o=this._viewContainer.length;i<o;i++){const s=this._viewContainer.get(i);s.context.index=i,s.context.count=o,s.context.ngForOf=this._ngForOf}t.forEachIdentityChange(i=>{this._viewContainer.get(i.currentIndex).context.$implicit=i.item})}_perViewChange(t,r){t.context.$implicit=r.item}static ngTemplateContextGuard(t,r){return!0}}return n.\u0275fac=function(t){return new(t||n)(Mt(ic),Mt(zc),Mt(s_))},n.\u0275dir=Fn({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),n})();class Tk{constructor(e,t){this.record=e,this.view=t}}let DM=(()=>{class n{constructor(t,r){this._viewContainer=t,this._context=new L9,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=r}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){Dk("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){Dk("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,r){return!0}}return n.\u0275fac=function(t){return new(t||n)(Mt(ic),Mt(zc))},n.\u0275dir=Fn({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),n})();class L9{constructor(){this.$implicit=null,this.ngIf=null}}function Dk(n,e){if(e&&!e.createEmbeddedView)throw new Error(`${n} must be a TemplateRef, but received '${Nr(e)}'.`)}class U9{createSubscription(e,t){return e.subscribe({next:t,error:r=>{throw r}})}dispose(e){e.unsubscribe()}onDestroy(e){e.unsubscribe()}}class j9{createSubscription(e,t){return e.then(t,r=>{throw r})}dispose(e){}onDestroy(e){}}const G9=new j9,$9=new U9;let PM=(()=>{class n{constructor(t){this._ref=t,this._latestValue=null,this._subscription=null,this._obj=null,this._strategy=null}ngOnDestroy(){this._subscription&&this._dispose()}transform(t){return this._obj?t!==this._obj?(this._dispose(),this.transform(t)):this._latestValue:(t&&this._subscribe(t),this._latestValue)}_subscribe(t){this._obj=t,this._strategy=this._selectStrategy(t),this._subscription=this._strategy.createSubscription(t,r=>this._updateLatestValue(t,r))}_selectStrategy(t){if(fv(t))return G9;if(JP(t))return $9;throw function(n,e){return Error(`InvalidPipeArgument: '${e}' for pipe '${Nr(n)}'`)}(n,t)}_dispose(){this._strategy.dispose(this._subscription),this._latestValue=null,this._subscription=null,this._obj=null}_updateLatestValue(t,r){t===this._obj&&(this._latestValue=r,this._ref.markForCheck())}}return n.\u0275fac=function(t){return new(t||n)(Mt(gg,16))},n.\u0275pipe=Yi({name:"async",type:n,pure:!1}),n})(),Zx=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Gn({type:n}),n.\u0275inj=Gr({providers:[{provide:Yx,useClass:A9}]}),n})();const Pk="browser";let Rk=(()=>{class n{}return n.\u0275prov=Dn({token:n,providedIn:"root",factory:()=>new cW(yt(Fr),window)}),n})();class cW{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){if(!this.supportsScrolling())return;const t=function(n,e){const t=n.getElementById(e)||n.getElementsByName(e)[0];if(t)return t;if("function"==typeof n.createTreeWalker&&n.body&&(n.body.createShadowRoot||n.body.attachShadow)){const r=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT);let i=r.currentNode;for(;i;){const o=i.shadowRoot;if(o){const s=o.getElementById(e)||o.querySelector(`[name="${e}"]`);if(s)return s}i=r.nextNode()}}return null}(this.document,e);t&&(this.scrollToElement(t),this.attemptFocus(t))}setHistoryScrollRestoration(e){if(this.supportScrollRestoration()){const t=this.window.history;t&&t.scrollRestoration&&(t.scrollRestoration=e)}}scrollToElement(e){const t=e.getBoundingClientRect(),r=t.left+this.window.pageXOffset,i=t.top+this.window.pageYOffset,o=this.offset();this.window.scrollTo(r-o[0],i-o[1])}attemptFocus(e){return e.focus(),this.document.activeElement===e}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const e=Ok(this.window.history)||Ok(Object.getPrototypeOf(this.window.history));return!(!e||!e.writable&&!e.set)}catch(e){return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch(e){return!1}}}function Ok(n){return Object.getOwnPropertyDescriptor(n,"scrollRestoration")}class kk{}class kM extends class extends class{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){var n;n=new kM,zx||(zx=n)}onAndCancel(e,t,r){return e.addEventListener(t,r,!1),()=>{e.removeEventListener(t,r,!1)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=(Uv=Uv||document.querySelector("base"),Uv?Uv.getAttribute("href"):null);return null==t?null:function(n){Kx=Kx||document.createElement("a"),Kx.setAttribute("href",n);const e=Kx.pathname;return"/"===e.charAt(0)?e:`/${e}`}(t)}resetBaseElement(){Uv=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return Sk(document.cookie,e)}}let Kx,Uv=null;const Lk=new gr("TRANSITION_ID"),mW=[{provide:Ov,useFactory:function(n,e,t){return()=>{t.get(__).donePromise.then(()=>{const r=Nd();Array.prototype.slice.apply(e.querySelectorAll("style[ng-transition]")).filter(o=>o.getAttribute("ng-transition")===n).forEach(o=>r.remove(o))})}},deps:[Lk,Fr,mi],multi:!0}];class LM{static init(){var n;n=new LM,eM=n}addToWindow(e){jr.getAngularTestability=(r,i=!0)=>{const o=e.findTestabilityInTree(r,i);if(null==o)throw new Error("Could not find testability for element.");return o},jr.getAllAngularTestabilities=()=>e.getAllTestabilities(),jr.getAllAngularRootElements=()=>e.getAllRootElements(),jr.frameworkStabilizers||(jr.frameworkStabilizers=[]),jr.frameworkStabilizers.push(r=>{const i=jr.getAllAngularTestabilities();let o=i.length,s=!1;const u=function(f){s=s||f,o--,0==o&&r(s)};i.forEach(function(f){f.whenStable(u)})})}findTestabilityInTree(e,t,r){if(null==t)return null;const i=e.getTestability(t);return null!=i?i:r?Nd().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null}}let _W=(()=>{class n{build(){return new XMLHttpRequest}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Dn({token:n,factory:n.\u0275fac}),n})();const jv=new gr("EventManagerPlugins");let Qx=(()=>{class n{constructor(t,r){this._zone=r,this._eventNameToPlugin=new Map,t.forEach(i=>i.manager=this),this._plugins=t.slice().reverse()}addEventListener(t,r,i){return this._findPluginFor(r).addEventListener(t,r,i)}addGlobalEventListener(t,r,i){return this._findPluginFor(r).addGlobalEventListener(t,r,i)}getZone(){return this._zone}_findPluginFor(t){const r=this._eventNameToPlugin.get(t);if(r)return r;const i=this._plugins;for(let o=0;o<i.length;o++){const s=i[o];if(s.supports(t))return this._eventNameToPlugin.set(t,s),s}throw new Error(`No event manager plugin found for event ${t}`)}}return n.\u0275fac=function(t){return new(t||n)(yt(jv),yt(si))},n.\u0275prov=Dn({token:n,factory:n.\u0275fac}),n})();class NM{constructor(e){this._doc=e}addGlobalEventListener(e,t,r){const i=Nd().getGlobalEventTarget(this._doc,e);if(!i)throw new Error(`Unsupported event target ${i} for event ${t}`);return this.addEventListener(i,t,r)}}let Fk=(()=>{class n{constructor(){this._stylesSet=new Set}addStyles(t){const r=new Set;t.forEach(i=>{this._stylesSet.has(i)||(this._stylesSet.add(i),r.add(i))}),this.onStylesAdded(r)}onStylesAdded(t){}getAllStyles(){return Array.from(this._stylesSet)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Dn({token:n,factory:n.\u0275fac}),n})(),Gv=(()=>{class n extends Fk{constructor(t){super(),this._doc=t,this._hostNodes=new Map,this._hostNodes.set(t.head,[])}_addStylesToHost(t,r,i){t.forEach(o=>{const s=this._doc.createElement("style");s.textContent=o,i.push(r.appendChild(s))})}addHost(t){const r=[];this._addStylesToHost(this._stylesSet,t,r),this._hostNodes.set(t,r)}removeHost(t){const r=this._hostNodes.get(t);r&&r.forEach(Bk),this._hostNodes.delete(t)}onStylesAdded(t){this._hostNodes.forEach((r,i)=>{this._addStylesToHost(t,i,r)})}ngOnDestroy(){this._hostNodes.forEach(t=>t.forEach(Bk))}}return n.\u0275fac=function(t){return new(t||n)(yt(Fr))},n.\u0275prov=Dn({token:n,factory:n.\u0275fac}),n})();function Bk(n){Nd().remove(n)}const FM={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},BM=/%COMP%/g;function eb(n,e,t){for(let r=0;r<e.length;r++){let i=e[r];Array.isArray(i)?eb(n,i,t):(i=i.replace(BM,n),t.push(i))}return t}function Uk(n){return e=>{if("__ngUnwrap__"===e)return n;!1===n(e)&&(e.preventDefault(),e.returnValue=!1)}}let tb=(()=>{class n{constructor(t,r,i){this.eventManager=t,this.sharedStylesHost=r,this.appId=i,this.rendererByCompId=new Map,this.defaultRenderer=new zM(t)}createRenderer(t,r){if(!t||!r)return this.defaultRenderer;switch(r.encapsulation){case xr.Emulated:{let i=this.rendererByCompId.get(r.id);return i||(i=new RW(this.eventManager,this.sharedStylesHost,r,this.appId),this.rendererByCompId.set(r.id,i)),i.applyToHost(t),i}case 1:case xr.ShadowDom:return new OW(this.eventManager,this.sharedStylesHost,t,r);default:if(!this.rendererByCompId.has(r.id)){const i=eb(r.id,r.styles,[]);this.sharedStylesHost.addStyles(i),this.rendererByCompId.set(r.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return n.\u0275fac=function(t){return new(t||n)(yt(Qx),yt(Gv),yt(kv))},n.\u0275prov=Dn({token:n,factory:n.\u0275fac}),n})();class zM{constructor(e){this.eventManager=e,this.data=Object.create(null)}destroy(){}createElement(e,t){return t?document.createElementNS(FM[t]||t,e):document.createElement(e)}createComment(e){return document.createComment(e)}createText(e){return document.createTextNode(e)}appendChild(e,t){e.appendChild(t)}insertBefore(e,t,r){e&&e.insertBefore(t,r)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let r="string"==typeof e?document.querySelector(e):e;if(!r)throw new Error(`The selector "${e}" did not match any elements`);return t||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,r,i){if(i){t=i+":"+t;const o=FM[i];o?e.setAttributeNS(o,t,r):e.setAttribute(t,r)}else e.setAttribute(t,r)}removeAttribute(e,t,r){if(r){const i=FM[r];i?e.removeAttributeNS(i,t):e.removeAttribute(`${r}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,r,i){i&(Ru.DashCase|Ru.Important)?e.style.setProperty(t,r,i&Ru.Important?"important":""):e.style[t]=r}removeStyle(e,t,r){r&Ru.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,r){e[t]=r}setValue(e,t){e.nodeValue=t}listen(e,t,r){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,Uk(r)):this.eventManager.addEventListener(e,t,Uk(r))}}class RW extends zM{constructor(e,t,r,i){super(e),this.component=r;const o=eb(i+"-"+r.id,r.styles,[]);t.addStyles(o),this.contentAttr="_ngcontent-%COMP%".replace(BM,i+"-"+r.id),this.hostAttr=function(n){return"_nghost-%COMP%".replace(BM,n)}(i+"-"+r.id)}applyToHost(e){super.setAttribute(e,this.hostAttr,"")}createElement(e,t){const r=super.createElement(e,t);return super.setAttribute(r,this.contentAttr,""),r}}class OW extends zM{constructor(e,t,r,i){super(e),this.sharedStylesHost=t,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const o=eb(i.id,i.styles,[]);for(let s=0;s<o.length;s++){const u=document.createElement("style");u.textContent=o[s],this.shadowRoot.appendChild(u)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,r){return super.insertBefore(this.nodeOrShadowRoot(e),t,r)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}}let kW=(()=>{class n extends NM{constructor(t){super(t)}supports(t){return!0}addEventListener(t,r,i){return t.addEventListener(r,i,!1),()=>this.removeEventListener(t,r,i)}removeEventListener(t,r,i){return t.removeEventListener(r,i)}}return n.\u0275fac=function(t){return new(t||n)(yt(Fr))},n.\u0275prov=Dn({token:n,factory:n.\u0275fac}),n})();const $k=["alt","control","meta","shift"],UW={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Hk={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},jW={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let GW=(()=>{class n extends NM{constructor(t){super(t)}supports(t){return null!=n.parseEventName(t)}addEventListener(t,r,i){const o=n.parseEventName(r),s=n.eventCallback(o.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Nd().onAndCancel(t,o.domEventName,s))}static parseEventName(t){const r=t.toLowerCase().split("."),i=r.shift();if(0===r.length||"keydown"!==i&&"keyup"!==i)return null;const o=n._normalizeKey(r.pop());let s="";if($k.forEach(f=>{const g=r.indexOf(f);g>-1&&(r.splice(g,1),s+=f+".")}),s+=o,0!=r.length||0===o.length)return null;const u={};return u.domEventName=i,u.fullKey=s,u}static getEventFullKey(t){let r="",i=function(n){let e=n.key;if(null==e){if(e=n.keyIdentifier,null==e)return"Unidentified";e.startsWith("U+")&&(e=String.fromCharCode(parseInt(e.substring(2),16)),3===n.location&&Hk.hasOwnProperty(e)&&(e=Hk[e]))}return UW[e]||e}(t);return i=i.toLowerCase()," "===i?i="space":"."===i&&(i="dot"),$k.forEach(o=>{o!=i&&jW[o](t)&&(r+=o+".")}),r+=i,r}static eventCallback(t,r,i){return o=>{n.getEventFullKey(o)===t&&i.runGuarded(()=>r(o))}}static _normalizeKey(t){switch(t){case"esc":return"escape";default:return t}}}return n.\u0275fac=function(t){return new(t||n)(yt(Fr))},n.\u0275prov=Dn({token:n,factory:n.\u0275fac}),n})();const KW=LO(NH,"browser",[{provide:y_,useValue:Pk},{provide:SO,useValue:function(){kM.makeCurrent(),LM.init()},multi:!0},{provide:Fr,useFactory:function(){return n=document,Rs=n,document;var n},deps:[]}]),JW=[[],{provide:lv,useValue:"root"},{provide:uf,useFactory:function(){return new uf},deps:[]},{provide:jv,useClass:kW,multi:!0,deps:[Fr,si,y_]},{provide:jv,useClass:GW,multi:!0,deps:[Fr]},[],{provide:tb,useClass:tb,deps:[Qx,Gv,kv]},{provide:pg,useExisting:tb},{provide:Fk,useExisting:Gv},{provide:Gv,useClass:Gv,deps:[Fr]},{provide:QS,useClass:QS,deps:[si]},{provide:Qx,useClass:Qx,deps:[jv,si]},{provide:kk,useClass:_W,deps:[]},[]];let GM=(()=>{class n{constructor(t){if(t)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(t){return{ngModule:n,providers:[{provide:kv,useValue:t.appId},{provide:Lk,useExisting:kv},mW]}}}return n.\u0275fac=function(t){return new(t||n)(yt(n,12))},n.\u0275mod=Gn({type:n}),n.\u0275inj=Gr({providers:JW,imports:[Zx,GH]}),n})();function Wk(n){return Array.isArray(n)?n:[n]}function _l(n){return null==n?"":"string"==typeof n?n:`${n}px`}function Eg(n){return n instanceof Po?n.nativeElement:n}function Jr(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var t=ba(n);return t?jo(n,t):Vt(n)}"undefined"!=typeof window&&window;var a7=Array.isArray;function HM(n){return ar(function(e){return function(n,e){return a7(e)?n.apply(void 0,Se([],At(e))):n(e)}(n,e)})}var u7=["addListener","removeListener"],c7=["addEventListener","removeEventListener"],h7=["on","off"];function nb(n,e,t,r){if(Oe(t)&&(r=t,t=void 0),r)return nb(n,e,t).pipe(HM(r));var i=At(function(n){return Oe(n.addEventListener)&&Oe(n.removeEventListener)}(n)?c7.map(function(u){return function(f){return n[u](e,f,t)}}):function(n){return Oe(n.addListener)&&Oe(n.removeListener)}(n)?u7.map(Xk(n,e)):function(n){return Oe(n.on)&&Oe(n.off)}(n)?h7.map(Xk(n,e)):[],2),o=i[0],s=i[1];if(!o&&Vr(n))return bn(function(u){return nb(u,e,t)})(Vt(n));if(!o)throw new TypeError("Invalid event target");return new Ie(function(u){var f=function(){for(var g=[],v=0;v<arguments.length;v++)g[v]=arguments[v];return u.next(1<g.length?g:g[0])};return o(f),function(){return s(f)}})}function Xk(n,e){return function(t){return function(r){return n[t](e,r)}}}var YM,g7=function(n){function e(t,r){return n.call(this)||this}return Be(e,n),e.prototype.schedule=function(t,r){return void 0===r&&(r=0),this},e}(Ce),rb={setInterval:function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var t=rb.delegate;return((null==t?void 0:t.setInterval)||setInterval).apply(void 0,Se([],At(n)))},clearInterval:function(n){var e=rb.delegate;return((null==e?void 0:e.clearInterval)||clearInterval)(n)},delegate:void 0},qM=function(n){function e(t,r){var i=n.call(this,t,r)||this;return i.scheduler=t,i.work=r,i.pending=!1,i}return Be(e,n),e.prototype.schedule=function(t,r){if(void 0===r&&(r=0),this.closed)return this;this.state=t;var i=this.id,o=this.scheduler;return null!=i&&(this.id=this.recycleAsyncId(o,i,r)),this.pending=!0,this.delay=r,this.id=this.id||this.requestAsyncId(o,this.id,r),this},e.prototype.requestAsyncId=function(t,r,i){return void 0===i&&(i=0),rb.setInterval(t.flush.bind(t,this),i)},e.prototype.recycleAsyncId=function(t,r,i){if(void 0===i&&(i=0),null!=i&&this.delay===i&&!1===this.pending)return r;rb.clearInterval(r)},e.prototype.execute=function(t,r){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var i=this._execute(t,r);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},e.prototype._execute=function(t,r){var o,i=!1;try{this.work(t)}catch(s){i=!0,o=!!s&&s||new Error(s)}if(i)return this.unsubscribe(),o},e.prototype.unsubscribe=function(){if(!this.closed){var r=this.id,i=this.scheduler,o=i.actions;this.work=this.state=this.scheduler=null,this.pending=!1,Lt(o,this),null!=r&&(this.id=this.recycleAsyncId(i,r,null)),this.delay=null,n.prototype.unsubscribe.call(this)}},e}(g7),Hv={schedule:function(n){var e=requestAnimationFrame,t=cancelAnimationFrame,r=Hv.delegate;r&&(e=r.requestAnimationFrame,t=r.cancelAnimationFrame);var i=e(function(o){t=void 0,n(o)});return new Ce(function(){return null==t?void 0:t(i)})},requestAnimationFrame:function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var t=Hv.delegate;return((null==t?void 0:t.requestAnimationFrame)||requestAnimationFrame).apply(void 0,Se([],At(n)))},cancelAnimationFrame:function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var t=Hv.delegate;return((null==t?void 0:t.cancelAnimationFrame)||cancelAnimationFrame).apply(void 0,Se([],At(n)))},delegate:void 0},m7=function(n){function e(t,r){var i=n.call(this,t,r)||this;return i.scheduler=t,i.work=r,i}return Be(e,n),e.prototype.requestAsyncId=function(t,r,i){return void 0===i&&(i=0),null!==i&&i>0?n.prototype.requestAsyncId.call(this,t,r,i):(t.actions.push(this),t._scheduled||(t._scheduled=Hv.requestAnimationFrame(function(){return t.flush(void 0)})))},e.prototype.recycleAsyncId=function(t,r,i){if(void 0===i&&(i=0),null!=i&&i>0||null==i&&this.delay>0)return n.prototype.recycleAsyncId.call(this,t,r,i);0===t.actions.length&&(Hv.cancelAnimationFrame(r),t._scheduled=void 0)},e}(qM),WM={now:function(){return(WM.delegate||Date).now()},delegate:void 0},Yk=function(){function n(e,t){void 0===t&&(t=n.now),this.schedulerActionCtor=e,this.now=t}return n.prototype.schedule=function(e,t,r){return void 0===t&&(t=0),new this.schedulerActionCtor(this,e).schedule(r,t)},n.now=WM.now,n}(),XM=function(n){function e(t,r){void 0===r&&(r=Yk.now);var i=n.call(this,t,r)||this;return i.actions=[],i._active=!1,i._scheduled=void 0,i}return Be(e,n),e.prototype.flush=function(t){var r=this.actions;if(this._active)r.push(t);else{var i;this._active=!0;do{if(i=t.execute(t.state,t.delay))break}while(t=r.shift());if(this._active=!1,i){for(;t=r.shift();)t.unsubscribe();throw i}}},e}(Yk),v7=(new(function(n){function e(){return null!==n&&n.apply(this,arguments)||this}return Be(e,n),e.prototype.flush=function(t){this._active=!0,this._scheduled=void 0;var i,r=this.actions,o=-1;t=t||r.shift();var s=r.length;do{if(i=t.execute(t.state,t.delay))break}while(++o<s&&(t=r.shift()));if(this._active=!1,i){for(;++o<s&&(t=r.shift());)t.unsubscribe();throw i}},e}(XM))(m7),1),ib={};function Zk(n){return n in ib&&(delete ib[n],!0)}var x7=function(n){var e=v7++;return ib[e]=!0,YM||(YM=Promise.resolve()),YM.then(function(){return Zk(e)&&n()}),e},b7=function(n){Zk(n)},ob={setImmediate:function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var t=ob.delegate;return((null==t?void 0:t.setImmediate)||x7).apply(void 0,Se([],At(n)))},clearImmediate:function(n){var e=ob.delegate;return((null==e?void 0:e.clearImmediate)||b7)(n)},delegate:void 0},w7=function(n){function e(t,r){var i=n.call(this,t,r)||this;return i.scheduler=t,i.work=r,i}return Be(e,n),e.prototype.requestAsyncId=function(t,r,i){return void 0===i&&(i=0),null!==i&&i>0?n.prototype.requestAsyncId.call(this,t,r,i):(t.actions.push(this),t._scheduled||(t._scheduled=ob.setImmediate(t.flush.bind(t,void 0))))},e.prototype.recycleAsyncId=function(t,r,i){if(void 0===i&&(i=0),null!=i&&i>0||null==i&&this.delay>0)return n.prototype.recycleAsyncId.call(this,t,r,i);0===t.actions.length&&(ob.clearImmediate(r),t._scheduled=void 0)},e}(qM);new(function(n){function e(){return null!==n&&n.apply(this,arguments)||this}return Be(e,n),e.prototype.flush=function(t){this._active=!0,this._scheduled=void 0;var i,r=this.actions,o=-1;t=t||r.shift();var s=r.length;do{if(i=t.execute(t.state,t.delay))break}while(++o<s&&(t=r.shift()));if(this._active=!1,i){for(;++o<s&&(t=r.shift());)t.unsubscribe();throw i}},e}(XM))(w7);function S7(n,e){return n===e}var tL=new XM(qM);function nL(n,e,t){void 0===n&&(n=0),void 0===t&&(t=tL);var r=-1;return null!=e&&(oi(e)?t=e:r=e),new Ie(function(i){var o=function(n){return n instanceof Date&&!isNaN(n)}(n)?+n-t.now():n;o<0&&(o=0);var s=0;return t.schedule(function(){i.closed||(i.next(s++),0<=r?this.schedule(void 0,r):i.complete())},o)})}function ZM(n,e){return void 0===e&&(e=tL),function(n){return Qt(function(e,t){var r=!1,i=null,o=null,s=!1,u=function(){if(null==o||o.unsubscribe(),o=null,r){r=!1;var g=i;i=null,t.next(g)}s&&t.complete()},f=function(){o=null,s&&t.complete()};e.subscribe(new jn(t,function(g){r=!0,i=g,o||je(n()).subscribe(o=new jn(t,u,f))},function(){s=!0,(!r||!o||o.closed)&&t.complete()}))})}(function(){return nL(n,e)})}function Vc(n,e){return Qt(function(t,r){var i=0;t.subscribe(new jn(r,function(o){return n.call(e,o,i++)&&r.next(o)}))})}function qv(n){return Qt(function(e,t){je(n).subscribe(new jn(t,function(){return t.complete()},Ut)),!t.closed&&e.subscribe(t)})}function D7(){return tt(1)}function KM(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return D7()(Vt(n,ba(n)))}function sb(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var t=ba(n);return Qt(function(r,i){(t?KM(n,r,t):KM(n,r)).subscribe(i)})}function _p(n,e){return Qt(function(t,r){var i=null,o=0,s=!1,u=function(){return s&&!i&&r.complete()};t.subscribe(new jn(r,function(f){null==i||i.unsubscribe();var g=0,v=o++;je(n(f,v)).subscribe(i=new jn(r,function(E){return r.next(e?e(f,E,v,g++):E)},function(){i=null,u()}))},function(){s=!0,u()}))})}var ab=function(n){function e(t,r,i){void 0===t&&(t=1/0),void 0===r&&(r=1/0),void 0===i&&(i=WM);var o=n.call(this)||this;return o._bufferSize=t,o._windowTime=r,o._timestampProvider=i,o._buffer=[],o._infiniteTimeWindow=!0,o._infiniteTimeWindow=r===1/0,o._bufferSize=Math.max(1,t),o._windowTime=Math.max(1,r),o}return Be(e,n),e.prototype.next=function(t){var r=this,o=r._buffer,s=r._infiniteTimeWindow,u=r._timestampProvider,f=r._windowTime;r.isStopped||(o.push(t),!s&&o.push(u.now()+f)),this._trimBuffer(),n.prototype.next.call(this,t)},e.prototype._subscribe=function(t){this._throwIfClosed(),this._trimBuffer();for(var r=this._innerSubscribe(t),o=this._infiniteTimeWindow,u=this._buffer.slice(),f=0;f<u.length&&!t.closed;f+=o?1:2)t.next(u[f]);return this._checkFinalizedStatuses(t),r},e.prototype._trimBuffer=function(){var t=this,r=t._bufferSize,i=t._timestampProvider,o=t._buffer,s=t._infiniteTimeWindow,u=(s?1:2)*r;if(r<1/0&&u<o.length&&o.splice(0,o.length-u),!s){for(var f=i.now(),g=0,v=1;v<o.length&&o[v]<=f;v+=2)g=v;g&&o.splice(0,g+1)}},e}(wt);function Cc(n,e,t){var r,i,o,s=!1;return n&&"object"==typeof n?(o=null!==(r=n.bufferSize)&&void 0!==r?r:1/0,e=null!==(i=n.windowTime)&&void 0!==i?i:1/0,s=!!n.refCount,t=n.scheduler):o=null!=n?n:1/0,wa({connector:function(){return new ab(o,e,t)},resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:s})}let JM;try{JM="undefined"!=typeof Intl&&Intl.v8BreakIterator}catch(n){JM=!1}let Wv,Cg,eT,yl=(()=>{class n{constructor(t){this._platformId=t,this.isBrowser=this._platformId?function(n){return n===Pk}(this._platformId):"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!JM)&&"undefined"!=typeof CSS&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}}return n.\u0275fac=function(t){return new(t||n)(yt(y_))},n.\u0275prov=Dn({factory:function(){return new n(yt(y_))},token:n,providedIn:"root"}),n})(),lb=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Gn({type:n}),n.\u0275inj=Gr({}),n})();function QM(n){return function(){if(null==Wv&&"undefined"!=typeof window)try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>Wv=!0}))}finally{Wv=Wv||!1}return Wv}()?n:!!n.capture}function iL(){if(null==Cg){if("object"!=typeof document||!document||"function"!=typeof Element||!Element)return Cg=!1,Cg;if("scrollBehavior"in document.documentElement.style)Cg=!0;else{const n=Element.prototype.scrollTo;Cg=!!n&&!/\{\s*\[native code\]\s*\}/.test(n.toString())}}return Cg}function cb(){let n="undefined"!=typeof document&&document?document.activeElement:null;for(;n&&n.shadowRoot;){const e=n.shadowRoot.activeElement;if(e===n)break;n=e}return n}function C_(n){return n.composedPath?n.composedPath()[0]:n.target}const oL=new gr("cdk-dir-doc",{providedIn:"root",factory:function(){return py(Fr)}});let Sg=(()=>{class n{constructor(t){if(this.value="ltr",this.change=new Ro,t){const i=t.documentElement?t.documentElement.dir:null,o=(t.body?t.body.dir:null)||i;this.value="ltr"===o||"rtl"===o?o:"ltr"}}ngOnDestroy(){this.change.complete()}}return n.\u0275fac=function(t){return new(t||n)(yt(oL,8))},n.\u0275prov=Dn({factory:function(){return new n(yt(oL,8))},token:n,providedIn:"root"}),n})(),Yv=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Gn({type:n}),n.\u0275inj=Gr({}),n})(),hb=(()=>{class n{constructor(t,r,i){this._ngZone=t,this._platform=r,this._scrolled=new wt,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map,this._document=i}register(t){this.scrollContainers.has(t)||this.scrollContainers.set(t,t.elementScrolled().subscribe(()=>this._scrolled.next(t)))}deregister(t){const r=this.scrollContainers.get(t);r&&(r.unsubscribe(),this.scrollContainers.delete(t))}scrolled(t=20){return this._platform.isBrowser?new Ie(r=>{this._globalSubscription||this._addGlobalListener();const i=t>0?this._scrolled.pipe(ZM(t)).subscribe(r):this._scrolled.subscribe(r);return this._scrolledCount++,()=>{i.unsubscribe(),this._scrolledCount--,this._scrolledCount||this._removeGlobalListener()}}):Jr()}ngOnDestroy(){this._removeGlobalListener(),this.scrollContainers.forEach((t,r)=>this.deregister(r)),this._scrolled.complete()}ancestorScrolled(t,r){const i=this.getAncestorScrollContainers(t);return this.scrolled(r).pipe(Vc(o=>!o||i.indexOf(o)>-1))}getAncestorScrollContainers(t){const r=[];return this.scrollContainers.forEach((i,o)=>{this._scrollableContainsElement(o,t)&&r.push(o)}),r}_getWindow(){return this._document.defaultView||window}_scrollableContainsElement(t,r){let i=Eg(r),o=t.getElementRef().nativeElement;do{if(i==o)return!0}while(i=i.parentElement);return!1}_addGlobalListener(){this._globalSubscription=this._ngZone.runOutsideAngular(()=>nb(this._getWindow().document,"scroll").subscribe(()=>this._scrolled.next()))}_removeGlobalListener(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}}return n.\u0275fac=function(t){return new(t||n)(yt(si),yt(yl),yt(Fr,8))},n.\u0275prov=Dn({factory:function(){return new n(yt(si),yt(yl),yt(Fr,8))},token:n,providedIn:"root"}),n})(),Zv=(()=>{class n{constructor(t,r,i){this._platform=t,this._change=new wt,this._changeListener=o=>{this._change.next(o)},this._document=i,r.runOutsideAngular(()=>{if(t.isBrowser){const o=this._getWindow();o.addEventListener("resize",this._changeListener),o.addEventListener("orientationchange",this._changeListener)}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){if(this._platform.isBrowser){const t=this._getWindow();t.removeEventListener("resize",this._changeListener),t.removeEventListener("orientationchange",this._changeListener)}this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();const t={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),t}getViewportRect(){const t=this.getViewportScrollPosition(),{width:r,height:i}=this.getViewportSize();return{top:t.top,left:t.left,bottom:t.top+i,right:t.left+r,height:i,width:r}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};const t=this._document,r=this._getWindow(),i=t.documentElement,o=i.getBoundingClientRect();return{top:-o.top||t.body.scrollTop||r.scrollY||i.scrollTop||0,left:-o.left||t.body.scrollLeft||r.scrollX||i.scrollLeft||0}}change(t=20){return t>0?this._change.pipe(ZM(t)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){const t=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:t.innerWidth,height:t.innerHeight}:{width:0,height:0}}}return n.\u0275fac=function(t){return new(t||n)(yt(yl),yt(si),yt(Fr,8))},n.\u0275prov=Dn({factory:function(){return new n(yt(yl),yt(si),yt(Fr,8))},token:n,providedIn:"root"}),n})(),cL=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Gn({type:n}),n.\u0275inj=Gr({}),n})(),hL=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Gn({type:n}),n.\u0275inj=Gr({imports:[[Yv,lb,cL],Yv,cL]}),n})();class tT{attach(e){return this._attachedHost=e,e.attach(this)}detach(){let e=this._attachedHost;null!=e&&(this._attachedHost=null,e.detach())}get isAttached(){return null!=this._attachedHost}setAttachedHost(e){this._attachedHost=e}}class nT extends tT{constructor(e,t,r,i){super(),this.component=e,this.viewContainerRef=t,this.injector=r,this.componentFactoryResolver=i}}class db extends tT{constructor(e,t,r){super(),this.templateRef=e,this.viewContainerRef=t,this.context=r}get origin(){return this.templateRef.elementRef}attach(e,t=this.context){return this.context=t,super.attach(e)}detach(){return this.context=void 0,super.detach()}}class W7 extends tT{constructor(e){super(),this.element=e instanceof Po?e.nativeElement:e}}class rT{constructor(){this._isDisposed=!1,this.attachDomPortal=null}hasAttached(){return!!this._attachedPortal}attach(e){return e instanceof nT?(this._attachedPortal=e,this.attachComponentPortal(e)):e instanceof db?(this._attachedPortal=e,this.attachTemplatePortal(e)):this.attachDomPortal&&e instanceof W7?(this._attachedPortal=e,this.attachDomPortal(e)):void 0}detach(){this._attachedPortal&&(this._attachedPortal.setAttachedHost(null),this._attachedPortal=null),this._invokeDisposeFn()}dispose(){this.hasAttached()&&this.detach(),this._invokeDisposeFn(),this._isDisposed=!0}setDisposeFn(e){this._disposeFn=e}_invokeDisposeFn(){this._disposeFn&&(this._disposeFn(),this._disposeFn=null)}}class X7 extends rT{constructor(e,t,r,i,o){super(),this.outletElement=e,this._componentFactoryResolver=t,this._appRef=r,this._defaultInjector=i,this.attachDomPortal=s=>{const u=s.element,f=this._document.createComment("dom-portal");u.parentNode.insertBefore(f,u),this.outletElement.appendChild(u),this._attachedPortal=s,super.setDisposeFn(()=>{f.parentNode&&f.parentNode.replaceChild(u,f)})},this._document=o}attachComponentPortal(e){const r=(e.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(e.component);let i;return e.viewContainerRef?(i=e.viewContainerRef.createComponent(r,e.viewContainerRef.length,e.injector||e.viewContainerRef.injector),this.setDisposeFn(()=>i.destroy())):(i=r.create(e.injector||this._defaultInjector),this._appRef.attachView(i.hostView),this.setDisposeFn(()=>{this._appRef.detachView(i.hostView),i.destroy()})),this.outletElement.appendChild(this._getComponentRootNode(i)),this._attachedPortal=e,i}attachTemplatePortal(e){let t=e.viewContainerRef,r=t.createEmbeddedView(e.templateRef,e.context);return r.rootNodes.forEach(i=>this.outletElement.appendChild(i)),r.detectChanges(),this.setDisposeFn(()=>{let i=t.indexOf(r);-1!==i&&t.remove(i)}),this._attachedPortal=e,r}dispose(){super.dispose(),null!=this.outletElement.parentNode&&this.outletElement.parentNode.removeChild(this.outletElement)}_getComponentRootNode(e){return e.hostView.rootNodes[0]}}let fb=(()=>{class n extends rT{constructor(t,r,i){super(),this._componentFactoryResolver=t,this._viewContainerRef=r,this._isInitialized=!1,this.attached=new Ro,this.attachDomPortal=o=>{const s=o.element,u=this._document.createComment("dom-portal");o.setAttachedHost(this),s.parentNode.insertBefore(u,s),this._getRootNode().appendChild(s),this._attachedPortal=o,super.setDisposeFn(()=>{u.parentNode&&u.parentNode.replaceChild(s,u)})},this._document=i}get portal(){return this._attachedPortal}set portal(t){this.hasAttached()&&!t&&!this._isInitialized||(this.hasAttached()&&super.detach(),t&&super.attach(t),this._attachedPortal=t)}get attachedRef(){return this._attachedRef}ngOnInit(){this._isInitialized=!0}ngOnDestroy(){super.dispose(),this._attachedPortal=null,this._attachedRef=null}attachComponentPortal(t){t.setAttachedHost(this);const r=null!=t.viewContainerRef?t.viewContainerRef:this._viewContainerRef,o=(t.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(t.component),s=r.createComponent(o,r.length,t.injector||r.injector);return r!==this._viewContainerRef&&this._getRootNode().appendChild(s.hostView.rootNodes[0]),super.setDisposeFn(()=>s.destroy()),this._attachedPortal=t,this._attachedRef=s,this.attached.emit(s),s}attachTemplatePortal(t){t.setAttachedHost(this);const r=this._viewContainerRef.createEmbeddedView(t.templateRef,t.context);return super.setDisposeFn(()=>this._viewContainerRef.clear()),this._attachedPortal=t,this._attachedRef=r,this.attached.emit(r),r}_getRootNode(){const t=this._viewContainerRef.element.nativeElement;return t.nodeType===t.ELEMENT_NODE?t:t.parentNode}}return n.\u0275fac=function(t){return new(t||n)(Mt(kd),Mt(ic),Mt(Fr))},n.\u0275dir=Fn({type:n,selectors:[["","cdkPortalOutlet",""]],inputs:{portal:["cdkPortalOutlet","portal"]},outputs:{attached:"attached"},exportAs:["cdkPortalOutlet"],features:[Eo]}),n})(),fL=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Gn({type:n}),n.\u0275inj=Gr({}),n})();const gL=iL();class rX{constructor(e,t){this._viewportRuler=e,this._previousHTMLStyles={top:"",left:""},this._isEnabled=!1,this._document=t}attach(){}enable(){if(this._canBeEnabled()){const e=this._document.documentElement;this._previousScrollPosition=this._viewportRuler.getViewportScrollPosition(),this._previousHTMLStyles.left=e.style.left||"",this._previousHTMLStyles.top=e.style.top||"",e.style.left=_l(-this._previousScrollPosition.left),e.style.top=_l(-this._previousScrollPosition.top),e.classList.add("cdk-global-scrollblock"),this._isEnabled=!0}}disable(){if(this._isEnabled){const e=this._document.documentElement,r=e.style,i=this._document.body.style,o=r.scrollBehavior||"",s=i.scrollBehavior||"";this._isEnabled=!1,r.left=this._previousHTMLStyles.left,r.top=this._previousHTMLStyles.top,e.classList.remove("cdk-global-scrollblock"),gL&&(r.scrollBehavior=i.scrollBehavior="auto"),window.scroll(this._previousScrollPosition.left,this._previousScrollPosition.top),gL&&(r.scrollBehavior=o,i.scrollBehavior=s)}}_canBeEnabled(){if(this._document.documentElement.classList.contains("cdk-global-scrollblock")||this._isEnabled)return!1;const t=this._document.body,r=this._viewportRuler.getViewportSize();return t.scrollHeight>r.height||t.scrollWidth>r.width}}class iX{constructor(e,t,r,i){this._scrollDispatcher=e,this._ngZone=t,this._viewportRuler=r,this._config=i,this._scrollSubscription=null,this._detach=()=>{this.disable(),this._overlayRef.hasAttached()&&this._ngZone.run(()=>this._overlayRef.detach())}}attach(e){this._overlayRef=e}enable(){if(this._scrollSubscription)return;const e=this._scrollDispatcher.scrolled(0);this._config&&this._config.threshold&&this._config.threshold>1?(this._initialScrollPosition=this._viewportRuler.getViewportScrollPosition().top,this._scrollSubscription=e.subscribe(()=>{const t=this._viewportRuler.getViewportScrollPosition().top;Math.abs(t-this._initialScrollPosition)>this._config.threshold?this._detach():this._overlayRef.updatePosition()})):this._scrollSubscription=e.subscribe(this._detach)}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}class mL{enable(){}disable(){}attach(){}}function oT(n,e){return e.some(t=>n.bottom<t.top||n.top>t.bottom||n.right<t.left||n.left>t.right)}function _L(n,e){return e.some(t=>n.top<t.top||n.bottom>t.bottom||n.left<t.left||n.right>t.right)}class oX{constructor(e,t,r,i){this._scrollDispatcher=e,this._viewportRuler=t,this._ngZone=r,this._config=i,this._scrollSubscription=null}attach(e){this._overlayRef=e}enable(){this._scrollSubscription||(this._scrollSubscription=this._scrollDispatcher.scrolled(this._config?this._config.scrollThrottle:0).subscribe(()=>{if(this._overlayRef.updatePosition(),this._config&&this._config.autoClose){const t=this._overlayRef.overlayElement.getBoundingClientRect(),{width:r,height:i}=this._viewportRuler.getViewportSize();oT(t,[{width:r,height:i,bottom:i,right:r,top:0,left:0}])&&(this.disable(),this._ngZone.run(()=>this._overlayRef.detach()))}}))}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}let sX=(()=>{class n{constructor(t,r,i,o){this._scrollDispatcher=t,this._viewportRuler=r,this._ngZone=i,this.noop=()=>new mL,this.close=s=>new iX(this._scrollDispatcher,this._ngZone,this._viewportRuler,s),this.block=()=>new rX(this._viewportRuler,this._document),this.reposition=s=>new oX(this._scrollDispatcher,this._viewportRuler,this._ngZone,s),this._document=o}}return n.\u0275fac=function(t){return new(t||n)(yt(hb),yt(Zv),yt(si),yt(Fr))},n.\u0275prov=Dn({factory:function(){return new n(yt(hb),yt(Zv),yt(si),yt(Fr))},token:n,providedIn:"root"}),n})();class sT{constructor(e){if(this.scrollStrategy=new mL,this.panelClass="",this.hasBackdrop=!1,this.backdropClass="cdk-overlay-dark-backdrop",this.disposeOnNavigation=!1,e){const t=Object.keys(e);for(const r of t)void 0!==e[r]&&(this[r]=e[r])}}}class aX{constructor(e,t,r,i,o){this.offsetX=r,this.offsetY=i,this.panelClass=o,this.originX=e.originX,this.originY=e.originY,this.overlayX=t.overlayX,this.overlayY=t.overlayY}}class lX{constructor(e,t){this.connectionPair=e,this.scrollableViewProperties=t}}let yL=(()=>{class n{constructor(t){this._attachedOverlays=[],this._document=t}ngOnDestroy(){this.detach()}add(t){this.remove(t),this._attachedOverlays.push(t)}remove(t){const r=this._attachedOverlays.indexOf(t);r>-1&&this._attachedOverlays.splice(r,1),0===this._attachedOverlays.length&&this.detach()}}return n.\u0275fac=function(t){return new(t||n)(yt(Fr))},n.\u0275prov=Dn({factory:function(){return new n(yt(Fr))},token:n,providedIn:"root"}),n})(),uX=(()=>{class n extends yL{constructor(t){super(t),this._keydownListener=r=>{const i=this._attachedOverlays;for(let o=i.length-1;o>-1;o--)if(i[o]._keydownEvents.observers.length>0){i[o]._keydownEvents.next(r);break}}}add(t){super.add(t),this._isAttached||(this._document.body.addEventListener("keydown",this._keydownListener),this._isAttached=!0)}detach(){this._isAttached&&(this._document.body.removeEventListener("keydown",this._keydownListener),this._isAttached=!1)}}return n.\u0275fac=function(t){return new(t||n)(yt(Fr))},n.\u0275prov=Dn({factory:function(){return new n(yt(Fr))},token:n,providedIn:"root"}),n})(),cX=(()=>{class n extends yL{constructor(t,r){super(t),this._platform=r,this._cursorStyleIsSet=!1,this._clickListener=i=>{const o=C_(i),s=this._attachedOverlays.slice();for(let u=s.length-1;u>-1;u--){const f=s[u];if(!(f._outsidePointerEvents.observers.length<1)&&f.hasAttached()){if(f.overlayElement.contains(o))break;f._outsidePointerEvents.next(i)}}}}add(t){if(super.add(t),!this._isAttached){const r=this._document.body;r.addEventListener("click",this._clickListener,!0),r.addEventListener("auxclick",this._clickListener,!0),r.addEventListener("contextmenu",this._clickListener,!0),this._platform.IOS&&!this._cursorStyleIsSet&&(this._cursorOriginalValue=r.style.cursor,r.style.cursor="pointer",this._cursorStyleIsSet=!0),this._isAttached=!0}}detach(){if(this._isAttached){const t=this._document.body;t.removeEventListener("click",this._clickListener,!0),t.removeEventListener("auxclick",this._clickListener,!0),t.removeEventListener("contextmenu",this._clickListener,!0),this._platform.IOS&&this._cursorStyleIsSet&&(t.style.cursor=this._cursorOriginalValue,this._cursorStyleIsSet=!1),this._isAttached=!1}}}return n.\u0275fac=function(t){return new(t||n)(yt(Fr),yt(yl))},n.\u0275prov=Dn({factory:function(){return new n(yt(Fr),yt(yl))},token:n,providedIn:"root"}),n})();const yp="undefined"!=typeof window?window:{},vL=void 0!==yp.__karma__&&!!yp.__karma__||void 0!==yp.jasmine&&!!yp.jasmine||void 0!==yp.jest&&!!yp.jest||void 0!==yp.Mocha&&!!yp.Mocha;let Kv=(()=>{class n{constructor(t,r){this._platform=r,this._document=t}ngOnDestroy(){const t=this._containerElement;t&&t.parentNode&&t.parentNode.removeChild(t)}getContainerElement(){return this._containerElement||this._createContainer(),this._containerElement}_createContainer(){const t="cdk-overlay-container";if(this._platform.isBrowser||vL){const i=this._document.querySelectorAll(`.${t}[platform="server"], .${t}[platform="test"]`);for(let o=0;o<i.length;o++)i[o].parentNode.removeChild(i[o])}const r=this._document.createElement("div");r.classList.add(t),vL?r.setAttribute("platform","test"):this._platform.isBrowser||r.setAttribute("platform","server"),this._document.body.appendChild(r),this._containerElement=r}}return n.\u0275fac=function(t){return new(t||n)(yt(Fr),yt(yl))},n.\u0275prov=Dn({factory:function(){return new n(yt(Fr),yt(yl))},token:n,providedIn:"root"}),n})();class hX{constructor(e,t,r,i,o,s,u,f,g){this._portalOutlet=e,this._host=t,this._pane=r,this._config=i,this._ngZone=o,this._keyboardDispatcher=s,this._document=u,this._location=f,this._outsideClickDispatcher=g,this._backdropElement=null,this._backdropClick=new wt,this._attachments=new wt,this._detachments=new wt,this._locationChanges=Ce.EMPTY,this._backdropClickHandler=v=>this._backdropClick.next(v),this._keydownEvents=new wt,this._outsidePointerEvents=new wt,i.scrollStrategy&&(this._scrollStrategy=i.scrollStrategy,this._scrollStrategy.attach(this)),this._positionStrategy=i.positionStrategy}get overlayElement(){return this._pane}get backdropElement(){return this._backdropElement}get hostElement(){return this._host}attach(e){let t=this._portalOutlet.attach(e);return!this._host.parentElement&&this._previousHostParent&&this._previousHostParent.appendChild(this._host),this._positionStrategy&&this._positionStrategy.attach(this),this._updateStackingOrder(),this._updateElementSize(),this._updateElementDirection(),this._scrollStrategy&&this._scrollStrategy.enable(),this._ngZone.onStable.pipe(Xn(1)).subscribe(()=>{this.hasAttached()&&this.updatePosition()}),this._togglePointerEvents(!0),this._config.hasBackdrop&&this._attachBackdrop(),this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!0),this._attachments.next(),this._keyboardDispatcher.add(this),this._config.disposeOnNavigation&&(this._locationChanges=this._location.subscribe(()=>this.dispose())),this._outsideClickDispatcher.add(this),t}detach(){if(!this.hasAttached())return;this.detachBackdrop(),this._togglePointerEvents(!1),this._positionStrategy&&this._positionStrategy.detach&&this._positionStrategy.detach(),this._scrollStrategy&&this._scrollStrategy.disable();const e=this._portalOutlet.detach();return this._detachments.next(),this._keyboardDispatcher.remove(this),this._detachContentWhenStable(),this._locationChanges.unsubscribe(),this._outsideClickDispatcher.remove(this),e}dispose(){const e=this.hasAttached();this._positionStrategy&&this._positionStrategy.dispose(),this._disposeScrollStrategy(),this.detachBackdrop(),this._locationChanges.unsubscribe(),this._keyboardDispatcher.remove(this),this._portalOutlet.dispose(),this._attachments.complete(),this._backdropClick.complete(),this._keydownEvents.complete(),this._outsidePointerEvents.complete(),this._outsideClickDispatcher.remove(this),this._host&&this._host.parentNode&&(this._host.parentNode.removeChild(this._host),this._host=null),this._previousHostParent=this._pane=null,e&&this._detachments.next(),this._detachments.complete()}hasAttached(){return this._portalOutlet.hasAttached()}backdropClick(){return this._backdropClick}attachments(){return this._attachments}detachments(){return this._detachments}keydownEvents(){return this._keydownEvents}outsidePointerEvents(){return this._outsidePointerEvents}getConfig(){return this._config}updatePosition(){this._positionStrategy&&this._positionStrategy.apply()}updatePositionStrategy(e){e!==this._positionStrategy&&(this._positionStrategy&&this._positionStrategy.dispose(),this._positionStrategy=e,this.hasAttached()&&(e.attach(this),this.updatePosition()))}updateSize(e){this._config=Object.assign(Object.assign({},this._config),e),this._updateElementSize()}setDirection(e){this._config=Object.assign(Object.assign({},this._config),{direction:e}),this._updateElementDirection()}addPanelClass(e){this._pane&&this._toggleClasses(this._pane,e,!0)}removePanelClass(e){this._pane&&this._toggleClasses(this._pane,e,!1)}getDirection(){const e=this._config.direction;return e?"string"==typeof e?e:e.value:"ltr"}updateScrollStrategy(e){e!==this._scrollStrategy&&(this._disposeScrollStrategy(),this._scrollStrategy=e,this.hasAttached()&&(e.attach(this),e.enable()))}_updateElementDirection(){this._host.setAttribute("dir",this.getDirection())}_updateElementSize(){if(!this._pane)return;const e=this._pane.style;e.width=_l(this._config.width),e.height=_l(this._config.height),e.minWidth=_l(this._config.minWidth),e.minHeight=_l(this._config.minHeight),e.maxWidth=_l(this._config.maxWidth),e.maxHeight=_l(this._config.maxHeight)}_togglePointerEvents(e){this._pane.style.pointerEvents=e?"":"none"}_attachBackdrop(){const e="cdk-overlay-backdrop-showing";this._backdropElement=this._document.createElement("div"),this._backdropElement.classList.add("cdk-overlay-backdrop"),this._config.backdropClass&&this._toggleClasses(this._backdropElement,this._config.backdropClass,!0),this._host.parentElement.insertBefore(this._backdropElement,this._host),this._backdropElement.addEventListener("click",this._backdropClickHandler),"undefined"!=typeof requestAnimationFrame?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>{this._backdropElement&&this._backdropElement.classList.add(e)})}):this._backdropElement.classList.add(e)}_updateStackingOrder(){this._host.nextSibling&&this._host.parentNode.appendChild(this._host)}detachBackdrop(){let e=this._backdropElement;if(!e)return;let t,r=()=>{e&&(e.removeEventListener("click",this._backdropClickHandler),e.removeEventListener("transitionend",r),e.parentNode&&e.parentNode.removeChild(e)),this._backdropElement==e&&(this._backdropElement=null),this._config.backdropClass&&this._toggleClasses(e,this._config.backdropClass,!1),clearTimeout(t)};e.classList.remove("cdk-overlay-backdrop-showing"),this._ngZone.runOutsideAngular(()=>{e.addEventListener("transitionend",r)}),e.style.pointerEvents="none",t=this._ngZone.runOutsideAngular(()=>setTimeout(r,500))}_toggleClasses(e,t,r){const i=e.classList;Wk(t).forEach(o=>{o&&(r?i.add(o):i.remove(o))})}_detachContentWhenStable(){this._ngZone.runOutsideAngular(()=>{const e=this._ngZone.onStable.pipe(qv(Tr(this._attachments,this._detachments))).subscribe(()=>{(!this._pane||!this._host||0===this._pane.children.length)&&(this._pane&&this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!1),this._host&&this._host.parentElement&&(this._previousHostParent=this._host.parentElement,this._previousHostParent.removeChild(this._host)),e.unsubscribe())})})}_disposeScrollStrategy(){const e=this._scrollStrategy;e&&(e.disable(),e.detach&&e.detach())}}const xL="cdk-overlay-connected-position-bounding-box",dX=/([A-Za-z%]+)$/;class bL{constructor(e,t,r,i,o){this._viewportRuler=t,this._document=r,this._platform=i,this._overlayContainer=o,this._lastBoundingBoxSize={width:0,height:0},this._isPushed=!1,this._canPush=!0,this._growAfterOpen=!1,this._hasFlexibleDimensions=!0,this._positionLocked=!1,this._viewportMargin=0,this._scrollables=[],this._preferredPositions=[],this._positionChanges=new wt,this._resizeSubscription=Ce.EMPTY,this._offsetX=0,this._offsetY=0,this._appliedPanelClasses=[],this.positionChanges=this._positionChanges,this.setOrigin(e)}get positions(){return this._preferredPositions}attach(e){this._validatePositions(),e.hostElement.classList.add(xL),this._overlayRef=e,this._boundingBox=e.hostElement,this._pane=e.overlayElement,this._isDisposed=!1,this._isInitialRender=!0,this._lastPosition=null,this._resizeSubscription.unsubscribe(),this._resizeSubscription=this._viewportRuler.change().subscribe(()=>{this._isInitialRender=!0,this.apply()})}apply(){if(this._isDisposed||!this._platform.isBrowser)return;if(!this._isInitialRender&&this._positionLocked&&this._lastPosition)return void this.reapplyLastPosition();this._clearPanelClasses(),this._resetOverlayElementStyles(),this._resetBoundingBoxStyles(),this._viewportRect=this._getNarrowedViewportRect(),this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect();const e=this._originRect,t=this._overlayRect,r=this._viewportRect,i=[];let o;for(let s of this._preferredPositions){let u=this._getOriginPoint(e,s),f=this._getOverlayPoint(u,t,s),g=this._getOverlayFit(f,t,r,s);if(g.isCompletelyWithinViewport)return this._isPushed=!1,void this._applyPosition(s,u);this._canFitWithFlexibleDimensions(g,f,r)?i.push({position:s,origin:u,overlayRect:t,boundingBoxRect:this._calculateBoundingBoxRect(u,s)}):(!o||o.overlayFit.visibleArea<g.visibleArea)&&(o={overlayFit:g,overlayPoint:f,originPoint:u,position:s,overlayRect:t})}if(i.length){let s=null,u=-1;for(const f of i){const g=f.boundingBoxRect.width*f.boundingBoxRect.height*(f.position.weight||1);g>u&&(u=g,s=f)}return this._isPushed=!1,void this._applyPosition(s.position,s.origin)}if(this._canPush)return this._isPushed=!0,void this._applyPosition(o.position,o.originPoint);this._applyPosition(o.position,o.originPoint)}detach(){this._clearPanelClasses(),this._lastPosition=null,this._previousPushAmount=null,this._resizeSubscription.unsubscribe()}dispose(){this._isDisposed||(this._boundingBox&&Mg(this._boundingBox.style,{top:"",left:"",right:"",bottom:"",height:"",width:"",alignItems:"",justifyContent:""}),this._pane&&this._resetOverlayElementStyles(),this._overlayRef&&this._overlayRef.hostElement.classList.remove(xL),this.detach(),this._positionChanges.complete(),this._overlayRef=this._boundingBox=null,this._isDisposed=!0)}reapplyLastPosition(){if(!this._isDisposed&&(!this._platform||this._platform.isBrowser)){this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._viewportRect=this._getNarrowedViewportRect();const e=this._lastPosition||this._preferredPositions[0],t=this._getOriginPoint(this._originRect,e);this._applyPosition(e,t)}}withScrollableContainers(e){return this._scrollables=e,this}withPositions(e){return this._preferredPositions=e,-1===e.indexOf(this._lastPosition)&&(this._lastPosition=null),this._validatePositions(),this}withViewportMargin(e){return this._viewportMargin=e,this}withFlexibleDimensions(e=!0){return this._hasFlexibleDimensions=e,this}withGrowAfterOpen(e=!0){return this._growAfterOpen=e,this}withPush(e=!0){return this._canPush=e,this}withLockedPosition(e=!0){return this._positionLocked=e,this}setOrigin(e){return this._origin=e,this}withDefaultOffsetX(e){return this._offsetX=e,this}withDefaultOffsetY(e){return this._offsetY=e,this}withTransformOriginOn(e){return this._transformOriginSelector=e,this}_getOriginPoint(e,t){let r,i;if("center"==t.originX)r=e.left+e.width/2;else{const o=this._isRtl()?e.right:e.left,s=this._isRtl()?e.left:e.right;r="start"==t.originX?o:s}return i="center"==t.originY?e.top+e.height/2:"top"==t.originY?e.top:e.bottom,{x:r,y:i}}_getOverlayPoint(e,t,r){let i,o;return i="center"==r.overlayX?-t.width/2:"start"===r.overlayX?this._isRtl()?-t.width:0:this._isRtl()?0:-t.width,o="center"==r.overlayY?-t.height/2:"top"==r.overlayY?0:-t.height,{x:e.x+i,y:e.y+o}}_getOverlayFit(e,t,r,i){const o=EL(t);let{x:s,y:u}=e,f=this._getOffset(i,"x"),g=this._getOffset(i,"y");f&&(s+=f),g&&(u+=g);let T=0-u,R=u+o.height-r.height,B=this._subtractOverflows(o.width,0-s,s+o.width-r.width),z=this._subtractOverflows(o.height,T,R),G=B*z;return{visibleArea:G,isCompletelyWithinViewport:o.width*o.height===G,fitsInViewportVertically:z===o.height,fitsInViewportHorizontally:B==o.width}}_canFitWithFlexibleDimensions(e,t,r){if(this._hasFlexibleDimensions){const i=r.bottom-t.y,o=r.right-t.x,s=wL(this._overlayRef.getConfig().minHeight),u=wL(this._overlayRef.getConfig().minWidth),g=e.fitsInViewportHorizontally||null!=u&&u<=o;return(e.fitsInViewportVertically||null!=s&&s<=i)&&g}return!1}_pushOverlayOnScreen(e,t,r){if(this._previousPushAmount&&this._positionLocked)return{x:e.x+this._previousPushAmount.x,y:e.y+this._previousPushAmount.y};const i=EL(t),o=this._viewportRect,s=Math.max(e.x+i.width-o.width,0),u=Math.max(e.y+i.height-o.height,0),f=Math.max(o.top-r.top-e.y,0),g=Math.max(o.left-r.left-e.x,0);let v=0,E=0;return v=i.width<=o.width?g||-s:e.x<this._viewportMargin?o.left-r.left-e.x:0,E=i.height<=o.height?f||-u:e.y<this._viewportMargin?o.top-r.top-e.y:0,this._previousPushAmount={x:v,y:E},{x:e.x+v,y:e.y+E}}_applyPosition(e,t){if(this._setTransformOrigin(e),this._setOverlayElementStyles(t,e),this._setBoundingBoxStyles(t,e),e.panelClass&&this._addPanelClasses(e.panelClass),this._lastPosition=e,this._positionChanges.observers.length){const r=this._getScrollVisibility(),i=new lX(e,r);this._positionChanges.next(i)}this._isInitialRender=!1}_setTransformOrigin(e){if(!this._transformOriginSelector)return;const t=this._boundingBox.querySelectorAll(this._transformOriginSelector);let r,i=e.overlayY;r="center"===e.overlayX?"center":this._isRtl()?"start"===e.overlayX?"right":"left":"start"===e.overlayX?"left":"right";for(let o=0;o<t.length;o++)t[o].style.transformOrigin=`${r} ${i}`}_calculateBoundingBoxRect(e,t){const r=this._viewportRect,i=this._isRtl();let o,s,u,v,E,T;if("top"===t.overlayY)s=e.y,o=r.height-s+this._viewportMargin;else if("bottom"===t.overlayY)u=r.height-e.y+2*this._viewportMargin,o=r.height-u+this._viewportMargin;else{const R=Math.min(r.bottom-e.y+r.top,e.y),B=this._lastBoundingBoxSize.height;o=2*R,s=e.y-R,o>B&&!this._isInitialRender&&!this._growAfterOpen&&(s=e.y-B/2)}if("end"===t.overlayX&&!i||"start"===t.overlayX&&i)T=r.width-e.x+this._viewportMargin,v=e.x-this._viewportMargin;else if("start"===t.overlayX&&!i||"end"===t.overlayX&&i)E=e.x,v=r.right-e.x;else{const R=Math.min(r.right-e.x+r.left,e.x),B=this._lastBoundingBoxSize.width;v=2*R,E=e.x-R,v>B&&!this._isInitialRender&&!this._growAfterOpen&&(E=e.x-B/2)}return{top:s,left:E,bottom:u,right:T,width:v,height:o}}_setBoundingBoxStyles(e,t){const r=this._calculateBoundingBoxRect(e,t);!this._isInitialRender&&!this._growAfterOpen&&(r.height=Math.min(r.height,this._lastBoundingBoxSize.height),r.width=Math.min(r.width,this._lastBoundingBoxSize.width));const i={};if(this._hasExactPosition())i.top=i.left="0",i.bottom=i.right=i.maxHeight=i.maxWidth="",i.width=i.height="100%";else{const o=this._overlayRef.getConfig().maxHeight,s=this._overlayRef.getConfig().maxWidth;i.height=_l(r.height),i.top=_l(r.top),i.bottom=_l(r.bottom),i.width=_l(r.width),i.left=_l(r.left),i.right=_l(r.right),i.alignItems="center"===t.overlayX?"center":"end"===t.overlayX?"flex-end":"flex-start",i.justifyContent="center"===t.overlayY?"center":"bottom"===t.overlayY?"flex-end":"flex-start",o&&(i.maxHeight=_l(o)),s&&(i.maxWidth=_l(s))}this._lastBoundingBoxSize=r,Mg(this._boundingBox.style,i)}_resetBoundingBoxStyles(){Mg(this._boundingBox.style,{top:"0",left:"0",right:"0",bottom:"0",height:"",width:"",alignItems:"",justifyContent:""})}_resetOverlayElementStyles(){Mg(this._pane.style,{top:"",left:"",bottom:"",right:"",position:"",transform:""})}_setOverlayElementStyles(e,t){const r={},i=this._hasExactPosition(),o=this._hasFlexibleDimensions,s=this._overlayRef.getConfig();if(i){const v=this._viewportRuler.getViewportScrollPosition();Mg(r,this._getExactOverlayY(t,e,v)),Mg(r,this._getExactOverlayX(t,e,v))}else r.position="static";let u="",f=this._getOffset(t,"x"),g=this._getOffset(t,"y");f&&(u+=`translateX(${f}px) `),g&&(u+=`translateY(${g}px)`),r.transform=u.trim(),s.maxHeight&&(i?r.maxHeight=_l(s.maxHeight):o&&(r.maxHeight="")),s.maxWidth&&(i?r.maxWidth=_l(s.maxWidth):o&&(r.maxWidth="")),Mg(this._pane.style,r)}_getExactOverlayY(e,t,r){let i={top:"",bottom:""},o=this._getOverlayPoint(t,this._overlayRect,e);this._isPushed&&(o=this._pushOverlayOnScreen(o,this._overlayRect,r));let s=this._overlayContainer.getContainerElement().getBoundingClientRect().top;return o.y-=s,"bottom"===e.overlayY?i.bottom=this._document.documentElement.clientHeight-(o.y+this._overlayRect.height)+"px":i.top=_l(o.y),i}_getExactOverlayX(e,t,r){let s,i={left:"",right:""},o=this._getOverlayPoint(t,this._overlayRect,e);return this._isPushed&&(o=this._pushOverlayOnScreen(o,this._overlayRect,r)),s=this._isRtl()?"end"===e.overlayX?"left":"right":"end"===e.overlayX?"right":"left","right"===s?i.right=this._document.documentElement.clientWidth-(o.x+this._overlayRect.width)+"px":i.left=_l(o.x),i}_getScrollVisibility(){const e=this._getOriginRect(),t=this._pane.getBoundingClientRect(),r=this._scrollables.map(i=>i.getElementRef().nativeElement.getBoundingClientRect());return{isOriginClipped:_L(e,r),isOriginOutsideView:oT(e,r),isOverlayClipped:_L(t,r),isOverlayOutsideView:oT(t,r)}}_subtractOverflows(e,...t){return t.reduce((r,i)=>r-Math.max(i,0),e)}_getNarrowedViewportRect(){const e=this._document.documentElement.clientWidth,t=this._document.documentElement.clientHeight,r=this._viewportRuler.getViewportScrollPosition();return{top:r.top+this._viewportMargin,left:r.left+this._viewportMargin,right:r.left+e-this._viewportMargin,bottom:r.top+t-this._viewportMargin,width:e-2*this._viewportMargin,height:t-2*this._viewportMargin}}_isRtl(){return"rtl"===this._overlayRef.getDirection()}_hasExactPosition(){return!this._hasFlexibleDimensions||this._isPushed}_getOffset(e,t){return"x"===t?null==e.offsetX?this._offsetX:e.offsetX:null==e.offsetY?this._offsetY:e.offsetY}_validatePositions(){}_addPanelClasses(e){this._pane&&Wk(e).forEach(t=>{""!==t&&-1===this._appliedPanelClasses.indexOf(t)&&(this._appliedPanelClasses.push(t),this._pane.classList.add(t))})}_clearPanelClasses(){this._pane&&(this._appliedPanelClasses.forEach(e=>{this._pane.classList.remove(e)}),this._appliedPanelClasses=[])}_getOriginRect(){const e=this._origin;if(e instanceof Po)return e.nativeElement.getBoundingClientRect();if(e instanceof Element)return e.getBoundingClientRect();const t=e.width||0,r=e.height||0;return{top:e.y,bottom:e.y+r,left:e.x,right:e.x+t,height:r,width:t}}}function Mg(n,e){for(let t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);return n}function wL(n){if("number"!=typeof n&&null!=n){const[e,t]=n.split(dX);return t&&"px"!==t?null:parseFloat(e)}return n||null}function EL(n){return{top:Math.floor(n.top),right:Math.floor(n.right),bottom:Math.floor(n.bottom),left:Math.floor(n.left),width:Math.floor(n.width),height:Math.floor(n.height)}}class fX{constructor(e,t,r,i,o,s,u){this._preferredPositions=[],this._positionStrategy=new bL(r,i,o,s,u).withFlexibleDimensions(!1).withPush(!1).withViewportMargin(0),this.withFallbackPosition(e,t),this.onPositionChange=this._positionStrategy.positionChanges}get positions(){return this._preferredPositions}attach(e){this._overlayRef=e,this._positionStrategy.attach(e),this._direction&&(e.setDirection(this._direction),this._direction=null)}dispose(){this._positionStrategy.dispose()}detach(){this._positionStrategy.detach()}apply(){this._positionStrategy.apply()}recalculateLastPosition(){this._positionStrategy.reapplyLastPosition()}withScrollableContainers(e){this._positionStrategy.withScrollableContainers(e)}withFallbackPosition(e,t,r,i){const o=new aX(e,t,r,i);return this._preferredPositions.push(o),this._positionStrategy.withPositions(this._preferredPositions),this}withDirection(e){return this._overlayRef?this._overlayRef.setDirection(e):this._direction=e,this}withOffsetX(e){return this._positionStrategy.withDefaultOffsetX(e),this}withOffsetY(e){return this._positionStrategy.withDefaultOffsetY(e),this}withLockedPosition(e){return this._positionStrategy.withLockedPosition(e),this}withPositions(e){return this._preferredPositions=e.slice(),this._positionStrategy.withPositions(this._preferredPositions),this}setOrigin(e){return this._positionStrategy.setOrigin(e),this}}const CL="cdk-global-overlay-wrapper";class pX{constructor(){this._cssPosition="static",this._topOffset="",this._bottomOffset="",this._leftOffset="",this._rightOffset="",this._alignItems="",this._justifyContent="",this._width="",this._height=""}attach(e){const t=e.getConfig();this._overlayRef=e,this._width&&!t.width&&e.updateSize({width:this._width}),this._height&&!t.height&&e.updateSize({height:this._height}),e.hostElement.classList.add(CL),this._isDisposed=!1}top(e=""){return this._bottomOffset="",this._topOffset=e,this._alignItems="flex-start",this}left(e=""){return this._rightOffset="",this._leftOffset=e,this._justifyContent="flex-start",this}bottom(e=""){return this._topOffset="",this._bottomOffset=e,this._alignItems="flex-end",this}right(e=""){return this._leftOffset="",this._rightOffset=e,this._justifyContent="flex-end",this}width(e=""){return this._overlayRef?this._overlayRef.updateSize({width:e}):this._width=e,this}height(e=""){return this._overlayRef?this._overlayRef.updateSize({height:e}):this._height=e,this}centerHorizontally(e=""){return this.left(e),this._justifyContent="center",this}centerVertically(e=""){return this.top(e),this._alignItems="center",this}apply(){if(!this._overlayRef||!this._overlayRef.hasAttached())return;const e=this._overlayRef.overlayElement.style,t=this._overlayRef.hostElement.style,r=this._overlayRef.getConfig(),{width:i,height:o,maxWidth:s,maxHeight:u}=r,f=!("100%"!==i&&"100vw"!==i||s&&"100%"!==s&&"100vw"!==s),g=!("100%"!==o&&"100vh"!==o||u&&"100%"!==u&&"100vh"!==u);e.position=this._cssPosition,e.marginLeft=f?"0":this._leftOffset,e.marginTop=g?"0":this._topOffset,e.marginBottom=this._bottomOffset,e.marginRight=this._rightOffset,f?t.justifyContent="flex-start":"center"===this._justifyContent?t.justifyContent="center":"rtl"===this._overlayRef.getConfig().direction?"flex-start"===this._justifyContent?t.justifyContent="flex-end":"flex-end"===this._justifyContent&&(t.justifyContent="flex-start"):t.justifyContent=this._justifyContent,t.alignItems=g?"flex-start":this._alignItems}dispose(){if(this._isDisposed||!this._overlayRef)return;const e=this._overlayRef.overlayElement.style,t=this._overlayRef.hostElement,r=t.style;t.classList.remove(CL),r.justifyContent=r.alignItems=e.marginTop=e.marginBottom=e.marginLeft=e.marginRight=e.position="",this._overlayRef=null,this._isDisposed=!0}}let gX=(()=>{class n{constructor(t,r,i,o){this._viewportRuler=t,this._document=r,this._platform=i,this._overlayContainer=o}global(){return new pX}connectedTo(t,r,i){return new fX(r,i,t,this._viewportRuler,this._document,this._platform,this._overlayContainer)}flexibleConnectedTo(t){return new bL(t,this._viewportRuler,this._document,this._platform,this._overlayContainer)}}return n.\u0275fac=function(t){return new(t||n)(yt(Zv),yt(Fr),yt(yl),yt(Kv))},n.\u0275prov=Dn({factory:function(){return new n(yt(Zv),yt(Fr),yt(yl),yt(Kv))},token:n,providedIn:"root"}),n})(),mX=0,S_=(()=>{class n{constructor(t,r,i,o,s,u,f,g,v,E,T){this.scrollStrategies=t,this._overlayContainer=r,this._componentFactoryResolver=i,this._positionBuilder=o,this._keyboardDispatcher=s,this._injector=u,this._ngZone=f,this._document=g,this._directionality=v,this._location=E,this._outsideClickDispatcher=T}create(t){const r=this._createHostElement(),i=this._createPaneElement(r),o=this._createPortalOutlet(i),s=new sT(t);return s.direction=s.direction||this._directionality.value,new hX(o,r,i,s,this._ngZone,this._keyboardDispatcher,this._document,this._location,this._outsideClickDispatcher)}position(){return this._positionBuilder}_createPaneElement(t){const r=this._document.createElement("div");return r.id="cdk-overlay-"+mX++,r.classList.add("cdk-overlay-pane"),t.appendChild(r),r}_createHostElement(){const t=this._document.createElement("div");return this._overlayContainer.getContainerElement().appendChild(t),t}_createPortalOutlet(t){return this._appRef||(this._appRef=this._injector.get(vg)),new X7(t,this._componentFactoryResolver,this._appRef,this._injector,this._document)}}return n.\u0275fac=function(t){return new(t||n)(yt(sX),yt(Kv),yt(kd),yt(gX),yt(uX),yt(mi),yt(si),yt(Fr),yt(Sg),yt(w_),yt(cX))},n.\u0275prov=Dn({token:n,factory:n.\u0275fac}),n})();const vX={provide:new gr("cdk-connected-overlay-scroll-strategy"),deps:[S_],useFactory:function(n){return()=>n.scrollStrategies.reposition()}};let xX=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Gn({type:n}),n.\u0275inj=Gr({providers:[S_,vX],imports:[[Yv,fL,hL],hL]}),n})();var Eh=function(n){function e(t){var r=n.call(this)||this;return r._value=t,r}return Be(e,n),Object.defineProperty(e.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),e.prototype._subscribe=function(t){var r=n.prototype._subscribe.call(this,t);return!r.closed&&t.next(this._value),r},e.prototype.getValue=function(){var t=this,o=t._value;if(t.hasError)throw t.thrownError;return this._throwIfClosed(),o},e.prototype.next=function(t){n.prototype.next.call(this,this._value=t)},e}(wt);let IL=(()=>{class n{constructor(t){this._platform=t}isDisabled(t){return t.hasAttribute("disabled")}isVisible(t){return function(n){return!!(n.offsetWidth||n.offsetHeight||"function"==typeof n.getClientRects&&n.getClientRects().length)}(t)&&"visible"===getComputedStyle(t).visibility}isTabbable(t){if(!this._platform.isBrowser)return!1;const r=function(n){try{return n.frameElement}catch(e){return null}}(function(n){return n.ownerDocument&&n.ownerDocument.defaultView||window}(t));if(r&&(-1===PL(r)||!this.isVisible(r)))return!1;let i=t.nodeName.toLowerCase(),o=PL(t);return t.hasAttribute("contenteditable")?-1!==o:!("iframe"===i||"object"===i||this._platform.WEBKIT&&this._platform.IOS&&!function(n){let e=n.nodeName.toLowerCase(),t="input"===e&&n.type;return"text"===t||"password"===t||"select"===e||"textarea"===e}(t))&&("audio"===i?!!t.hasAttribute("controls")&&-1!==o:"video"===i?-1!==o&&(null!==o||this._platform.FIREFOX||t.hasAttribute("controls")):t.tabIndex>=0)}isFocusable(t,r){return function(n){return!function(n){return function(n){return"input"==n.nodeName.toLowerCase()}(n)&&"hidden"==n.type}(n)&&(function(n){let e=n.nodeName.toLowerCase();return"input"===e||"select"===e||"button"===e||"textarea"===e}(n)||function(n){return function(n){return"a"==n.nodeName.toLowerCase()}(n)&&n.hasAttribute("href")}(n)||n.hasAttribute("contenteditable")||AL(n))}(t)&&!this.isDisabled(t)&&((null==r?void 0:r.ignoreVisibility)||this.isVisible(t))}}return n.\u0275fac=function(t){return new(t||n)(yt(yl))},n.\u0275prov=Dn({factory:function(){return new n(yt(yl))},token:n,providedIn:"root"}),n})();function AL(n){if(!n.hasAttribute("tabindex")||void 0===n.tabIndex)return!1;let e=n.getAttribute("tabindex");return"-32768"!=e&&!(!e||isNaN(parseInt(e,10)))}function PL(n){if(!AL(n))return null;const e=parseInt(n.getAttribute("tabindex")||"",10);return isNaN(e)?-1:e}class NX{constructor(e,t,r,i,o=!1){this._element=e,this._checker=t,this._ngZone=r,this._document=i,this._hasAttached=!1,this.startAnchorListener=()=>this.focusLastTabbableElement(),this.endAnchorListener=()=>this.focusFirstTabbableElement(),this._enabled=!0,o||this.attachAnchors()}get enabled(){return this._enabled}set enabled(e){this._enabled=e,this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(e,this._startAnchor),this._toggleAnchorTabIndex(e,this._endAnchor))}destroy(){const e=this._startAnchor,t=this._endAnchor;e&&(e.removeEventListener("focus",this.startAnchorListener),e.parentNode&&e.parentNode.removeChild(e)),t&&(t.removeEventListener("focus",this.endAnchorListener),t.parentNode&&t.parentNode.removeChild(t)),this._startAnchor=this._endAnchor=null,this._hasAttached=!1}attachAnchors(){return!!this._hasAttached||(this._ngZone.runOutsideAngular(()=>{this._startAnchor||(this._startAnchor=this._createAnchor(),this._startAnchor.addEventListener("focus",this.startAnchorListener)),this._endAnchor||(this._endAnchor=this._createAnchor(),this._endAnchor.addEventListener("focus",this.endAnchorListener))}),this._element.parentNode&&(this._element.parentNode.insertBefore(this._startAnchor,this._element),this._element.parentNode.insertBefore(this._endAnchor,this._element.nextSibling),this._hasAttached=!0),this._hasAttached)}focusInitialElementWhenReady(e){return new Promise(t=>{this._executeOnStable(()=>t(this.focusInitialElement(e)))})}focusFirstTabbableElementWhenReady(e){return new Promise(t=>{this._executeOnStable(()=>t(this.focusFirstTabbableElement(e)))})}focusLastTabbableElementWhenReady(e){return new Promise(t=>{this._executeOnStable(()=>t(this.focusLastTabbableElement(e)))})}_getRegionBoundary(e){let t=this._element.querySelectorAll(`[cdk-focus-region-${e}], [cdkFocusRegion${e}], [cdk-focus-${e}]`);for(let r=0;r<t.length;r++)t[r].hasAttribute(`cdk-focus-${e}`)?console.warn(`Found use of deprecated attribute 'cdk-focus-${e}', use 'cdkFocusRegion${e}' instead. The deprecated attribute will be removed in 8.0.0.`,t[r]):t[r].hasAttribute(`cdk-focus-region-${e}`)&&console.warn(`Found use of deprecated attribute 'cdk-focus-region-${e}', use 'cdkFocusRegion${e}' instead. The deprecated attribute will be removed in 8.0.0.`,t[r]);return"start"==e?t.length?t[0]:this._getFirstTabbableElement(this._element):t.length?t[t.length-1]:this._getLastTabbableElement(this._element)}focusInitialElement(e){const t=this._element.querySelector("[cdk-focus-initial], [cdkFocusInitial]");if(t){if(t.hasAttribute("cdk-focus-initial")&&console.warn("Found use of deprecated attribute 'cdk-focus-initial', use 'cdkFocusInitial' instead. The deprecated attribute will be removed in 8.0.0",t),!this._checker.isFocusable(t)){const r=this._getFirstTabbableElement(t);return null==r||r.focus(e),!!r}return t.focus(e),!0}return this.focusFirstTabbableElement(e)}focusFirstTabbableElement(e){const t=this._getRegionBoundary("start");return t&&t.focus(e),!!t}focusLastTabbableElement(e){const t=this._getRegionBoundary("end");return t&&t.focus(e),!!t}hasAttached(){return this._hasAttached}_getFirstTabbableElement(e){if(this._checker.isFocusable(e)&&this._checker.isTabbable(e))return e;let t=e.children||e.childNodes;for(let r=0;r<t.length;r++){let i=t[r].nodeType===this._document.ELEMENT_NODE?this._getFirstTabbableElement(t[r]):null;if(i)return i}return null}_getLastTabbableElement(e){if(this._checker.isFocusable(e)&&this._checker.isTabbable(e))return e;let t=e.children||e.childNodes;for(let r=t.length-1;r>=0;r--){let i=t[r].nodeType===this._document.ELEMENT_NODE?this._getLastTabbableElement(t[r]):null;if(i)return i}return null}_createAnchor(){const e=this._document.createElement("div");return this._toggleAnchorTabIndex(this._enabled,e),e.classList.add("cdk-visually-hidden"),e.classList.add("cdk-focus-trap-anchor"),e.setAttribute("aria-hidden","true"),e}_toggleAnchorTabIndex(e,t){e?t.setAttribute("tabindex","0"):t.removeAttribute("tabindex")}toggleAnchors(e){this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(e,this._startAnchor),this._toggleAnchorTabIndex(e,this._endAnchor))}_executeOnStable(e){this._ngZone.isStable?e():this._ngZone.onStable.pipe(Xn(1)).subscribe(e)}}let RL=(()=>{class n{constructor(t,r,i){this._checker=t,this._ngZone=r,this._document=i}create(t,r=!1){return new NX(t,this._checker,this._ngZone,this._document,r)}}return n.\u0275fac=function(t){return new(t||n)(yt(IL),yt(si),yt(Fr))},n.\u0275prov=Dn({factory:function(){return new n(yt(IL),yt(si),yt(Fr))},token:n,providedIn:"root"}),n})();"undefined"!=typeof Element&&Element;const LL=new gr("cdk-input-modality-detector-options"),UX={ignoreKeys:[18,17,224,91,16]},M_=QM({passive:!0,capture:!0});let FL=(()=>{class n{constructor(t,r,i,o){this._platform=t,this._mostRecentTarget=null,this._modality=new Eh(null),this._lastTouchMs=0,this._onKeydown=s=>{var u,f;(null===(f=null===(u=this._options)||void 0===u?void 0:u.ignoreKeys)||void 0===f?void 0:f.some(g=>g===s.keyCode))||(this._modality.next("keyboard"),this._mostRecentTarget=C_(s))},this._onMousedown=s=>{Date.now()-this._lastTouchMs<650||(this._modality.next(function(n){return 0===n.offsetX&&0===n.offsetY}(s)?"keyboard":"mouse"),this._mostRecentTarget=C_(s))},this._onTouchstart=s=>{!function(n){const e=n.touches&&n.touches[0]||n.changedTouches&&n.changedTouches[0];return!(!e||-1!==e.identifier||null!=e.radiusX&&1!==e.radiusX||null!=e.radiusY&&1!==e.radiusY)}(s)?(this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=C_(s)):this._modality.next("keyboard")},this._options=Object.assign(Object.assign({},UX),o),this.modalityDetected=this._modality.pipe(Vc(function(e,t){return 1<=t})),this.modalityChanged=this.modalityDetected.pipe(function(n,e){return void 0===e&&(e=ve),n=null!=n?n:S7,Qt(function(t,r){var i,o=!0;t.subscribe(new jn(r,function(s){var u=e(s);(o||!n(i,u))&&(o=!1,i=u,r.next(s))}))})}()),t.isBrowser&&r.runOutsideAngular(()=>{i.addEventListener("keydown",this._onKeydown,M_),i.addEventListener("mousedown",this._onMousedown,M_),i.addEventListener("touchstart",this._onTouchstart,M_)})}get mostRecentModality(){return this._modality.value}ngOnDestroy(){!this._platform.isBrowser||(document.removeEventListener("keydown",this._onKeydown,M_),document.removeEventListener("mousedown",this._onMousedown,M_),document.removeEventListener("touchstart",this._onTouchstart,M_))}}return n.\u0275fac=function(t){return new(t||n)(yt(yl),yt(si),yt(Fr),yt(LL,8))},n.\u0275prov=Dn({factory:function(){return new n(yt(yl),yt(si),yt(Fr),yt(LL,8))},token:n,providedIn:"root"}),n})();const VL=new gr("cdk-focus-monitor-default-options"),pb=QM({passive:!0,capture:!0});let UL=(()=>{class n{constructor(t,r,i,o,s){this._ngZone=t,this._platform=r,this._inputModalityDetector=i,this._origin=null,this._windowFocused=!1,this._originFromTouchInteraction=!1,this._elementInfo=new Map,this._monitoredElementCount=0,this._rootNodeFocusListenerCount=new Map,this._windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=setTimeout(()=>this._windowFocused=!1)},this._stopInputModalityDetector=new wt,this._rootNodeFocusAndBlurListener=u=>{const f=C_(u),g="focus"===u.type?this._onFocus:this._onBlur;for(let v=f;v;v=v.parentElement)g.call(this,u,v)},this._document=o,this._detectionMode=(null==s?void 0:s.detectionMode)||0}monitor(t,r=!1){const i=Eg(t);if(!this._platform.isBrowser||1!==i.nodeType)return Jr(null);const o=function(n){if(function(){if(null==eT){const n="undefined"!=typeof document?document.head:null;eT=!(!n||!n.createShadowRoot&&!n.attachShadow)}return eT}()){const e=n.getRootNode?n.getRootNode():null;if("undefined"!=typeof ShadowRoot&&ShadowRoot&&e instanceof ShadowRoot)return e}return null}(i)||this._getDocument(),s=this._elementInfo.get(i);if(s)return r&&(s.checkChildren=!0),s.subject;const u={checkChildren:r,subject:new wt,rootNode:o};return this._elementInfo.set(i,u),this._registerGlobalListeners(u),u.subject}stopMonitoring(t){const r=Eg(t),i=this._elementInfo.get(r);i&&(i.subject.complete(),this._setClasses(r),this._elementInfo.delete(r),this._removeGlobalListeners(i))}focusVia(t,r,i){const o=Eg(t);o===this._getDocument().activeElement?this._getClosestElementsInfo(o).forEach(([u,f])=>this._originChanged(u,r,f)):(this._setOrigin(r),"function"==typeof o.focus&&o.focus(i))}ngOnDestroy(){this._elementInfo.forEach((t,r)=>this.stopMonitoring(r))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_toggleClass(t,r,i){i?t.classList.add(r):t.classList.remove(r)}_getFocusOrigin(t){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(t)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:"program"}_shouldBeAttributedToTouch(t){return 1===this._detectionMode||!!(null==t?void 0:t.contains(this._inputModalityDetector._mostRecentTarget))}_setClasses(t,r){this._toggleClass(t,"cdk-focused",!!r),this._toggleClass(t,"cdk-touch-focused","touch"===r),this._toggleClass(t,"cdk-keyboard-focused","keyboard"===r),this._toggleClass(t,"cdk-mouse-focused","mouse"===r),this._toggleClass(t,"cdk-program-focused","program"===r)}_setOrigin(t,r=!1){this._ngZone.runOutsideAngular(()=>{this._origin=t,this._originFromTouchInteraction="touch"===t&&r,0===this._detectionMode&&(clearTimeout(this._originTimeoutId),this._originTimeoutId=setTimeout(()=>this._origin=null,this._originFromTouchInteraction?650:1))})}_onFocus(t,r){const i=this._elementInfo.get(r),o=C_(t);!i||!i.checkChildren&&r!==o||this._originChanged(r,this._getFocusOrigin(o),i)}_onBlur(t,r){const i=this._elementInfo.get(r);!i||i.checkChildren&&t.relatedTarget instanceof Node&&r.contains(t.relatedTarget)||(this._setClasses(r),this._emitOrigin(i.subject,null))}_emitOrigin(t,r){this._ngZone.run(()=>t.next(r))}_registerGlobalListeners(t){if(!this._platform.isBrowser)return;const r=t.rootNode,i=this._rootNodeFocusListenerCount.get(r)||0;i||this._ngZone.runOutsideAngular(()=>{r.addEventListener("focus",this._rootNodeFocusAndBlurListener,pb),r.addEventListener("blur",this._rootNodeFocusAndBlurListener,pb)}),this._rootNodeFocusListenerCount.set(r,i+1),1==++this._monitoredElementCount&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe(qv(this._stopInputModalityDetector)).subscribe(o=>{this._setOrigin(o,!0)}))}_removeGlobalListeners(t){const r=t.rootNode;if(this._rootNodeFocusListenerCount.has(r)){const i=this._rootNodeFocusListenerCount.get(r);i>1?this._rootNodeFocusListenerCount.set(r,i-1):(r.removeEventListener("focus",this._rootNodeFocusAndBlurListener,pb),r.removeEventListener("blur",this._rootNodeFocusAndBlurListener,pb),this._rootNodeFocusListenerCount.delete(r))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(t,r,i){this._setClasses(t,r),this._emitOrigin(i.subject,r),this._lastFocusOrigin=r}_getClosestElementsInfo(t){const r=[];return this._elementInfo.forEach((i,o)=>{(o===t||i.checkChildren&&o.contains(t))&&r.push([o,i])}),r}}return n.\u0275fac=function(t){return new(t||n)(yt(si),yt(yl),yt(FL),yt(Fr,8),yt(VL,8))},n.\u0275prov=Dn({factory:function(){return new n(yt(si),yt(yl),yt(FL),yt(Fr,8),yt(VL,8))},token:n,providedIn:"root"}),n})();const jL="cdk-high-contrast-black-on-white",GL="cdk-high-contrast-white-on-black",lT="cdk-high-contrast-active";let $L=(()=>{class n{constructor(t,r){this._platform=t,this._document=r}getHighContrastMode(){if(!this._platform.isBrowser)return 0;const t=this._document.createElement("div");t.style.backgroundColor="rgb(1,2,3)",t.style.position="absolute",this._document.body.appendChild(t);const r=this._document.defaultView||window,i=r&&r.getComputedStyle?r.getComputedStyle(t):null,o=(i&&i.backgroundColor||"").replace(/ /g,"");switch(this._document.body.removeChild(t),o){case"rgb(0,0,0)":return 2;case"rgb(255,255,255)":return 1}return 0}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){const t=this._document.body.classList;t.remove(lT),t.remove(jL),t.remove(GL),this._hasCheckedHighContrastMode=!0;const r=this.getHighContrastMode();1===r?(t.add(lT),t.add(jL)):2===r&&(t.add(lT),t.add(GL))}}}return n.\u0275fac=function(t){return new(t||n)(yt(yl),yt(Fr))},n.\u0275prov=Dn({factory:function(){return new n(yt(yl),yt(Fr))},token:n,providedIn:"root"}),n})();const HL=new fp("12.2.3");function HX(n,e){return{type:7,name:n,definitions:e,options:{}}}function WL(n,e=null){return{type:4,styles:e,timings:n}}function T_(n){return{type:6,styles:n,offset:null}}function YL(n,e,t){return{type:0,name:n,styles:e,options:t}}function ZL(n,e,t=null){return{type:1,expr:n,animation:e,options:t}}function KL(n){Promise.resolve(null).then(n)}class D_{constructor(e=0,t=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=e+t}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}onStart(e){this._onStartFns.push(e)}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){KL(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(e=>e()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this._started=!1}setPosition(e){this._position=this.totalTime?e*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(r=>r()),t.length=0}}function QL(){return"undefined"!=typeof window&&void 0!==window.document}function cT(){return"undefined"!=typeof process&&"[object process]"==={}.toString.call(process)}let pT=(n,e)=>!1,gT=(n,e)=>!1,nN=(n,e,t)=>[];const rN=cT();(rN||"undefined"!=typeof Element)&&(pT=QL()?(n,e)=>{for(;e&&e!==document.documentElement;){if(e===n)return!0;e=e.parentNode||e.host}return!1}:(n,e)=>n.contains(e),gT=(()=>{if(rN||Element.prototype.matches)return(n,e)=>n.matches(e);{const n=Element.prototype,e=n.matchesSelector||n.mozMatchesSelector||n.msMatchesSelector||n.oMatchesSelector||n.webkitMatchesSelector;return e?(t,r)=>e.apply(t,[r]):gT}})(),nN=(n,e,t)=>{let r=[];if(t){const i=n.querySelectorAll(e);for(let o=0;o<i.length;o++)r.push(i[o])}else{const i=n.querySelector(e);i&&r.push(i)}return r});let Tg=null,iN=!1;function mT(n){Tg||(Tg=("undefined"!=typeof document?document.body:null)||{},iN=!!Tg.style&&"WebkitAppearance"in Tg.style);let e=!0;return Tg.style&&!function(n){return"ebkit"==n.substring(1,6)}(n)&&(e=n in Tg.style,!e&&iN&&(e="Webkit"+n.charAt(0).toUpperCase()+n.substr(1)in Tg.style)),e}const _T=gT,yT=pT,vT=nN;let sN=(()=>{class n{validateStyleProperty(t){return mT(t)}matchesElement(t,r){return _T(t,r)}containsElement(t,r){return yT(t,r)}query(t,r,i){return vT(t,r,i)}computeStyle(t,r,i){return i||""}animate(t,r,i,o,s,u=[],f){return new D_(i,o)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Dn({token:n,factory:n.\u0275fac}),n})();class gb{}gb.NOOP=new sN;function cN(n,e,t){return t?e+":"+t+";":""}function hN(n){let e="";for(let t=0;t<n.style.length;t++){const r=n.style.item(t);e+=cN(0,r,n.style.getPropertyValue(r))}for(const t in n.style)n.style.hasOwnProperty(t)&&!t.startsWith("_")&&(e+=cN(0,QX(t),n.style[t]));n.setAttribute("style",e)}function Fd(n,e,t){n.style&&(Object.keys(e).forEach(r=>{const i=CT(r);t&&!t.hasOwnProperty(r)&&(t[r]=n.style[i]),n.style[i]=e[r]}),cT()&&hN(n))}function Ig(n,e){n.style&&(Object.keys(e).forEach(t=>{const r=CT(t);n.style[r]=""}),cT()&&hN(n))}const JX=/-+([a-z0-9])/g;function CT(n){return n.replace(JX,(...e)=>e[1].toUpperCase())}function QX(n){return n.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}class P_{constructor(e,t,r){this._element=e,this._startStyles=t,this._endStyles=r,this._state=0;let i=P_.initialStylesByElement.get(e);i||P_.initialStylesByElement.set(e,i={}),this._initialStyles=i}start(){this._state<1&&(this._startStyles&&Fd(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(Fd(this._element,this._initialStyles),this._endStyles&&(Fd(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(P_.initialStylesByElement.delete(this._element),this._startStyles&&(Ig(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(Ig(this._element,this._endStyles),this._endStyles=null),Fd(this._element,this._initialStyles),this._state=3)}}P_.initialStylesByElement=new WeakMap;const YN=new fp("12.2.3"),xZ=new gr("mat-sanity-checks",{providedIn:"root",factory:function(){return!0}});let Pg,bp=(()=>{class n{constructor(t,r,i){this._hasDoneGlobalChecks=!1,this._document=i,t._applyBodyHighContrastModeCssClasses(),this._sanityChecks=r,this._hasDoneGlobalChecks||(this._checkDoctypeIsDefined(),this._checkThemeIsPresent(),this._checkCdkVersionMatch(),this._hasDoneGlobalChecks=!0)}_getWindow(){const t=this._document.defaultView||window;return"object"==typeof t&&t?t:null}_checkIsEnabled(t){return!(!tM()||this._isTestEnv())&&("boolean"==typeof this._sanityChecks?this._sanityChecks:!!this._sanityChecks[t])}_isTestEnv(){const t=this._getWindow();return t&&(t.__karma__||t.jasmine)}_checkDoctypeIsDefined(){this._checkIsEnabled("doctype")&&!this._document.doctype&&console.warn("Current document does not have a doctype. This may cause some Angular Material components not to behave as expected.")}_checkThemeIsPresent(){if(!this._checkIsEnabled("theme")||!this._document.body||"function"!=typeof getComputedStyle)return;const t=this._document.createElement("div");t.classList.add("mat-theme-loaded-marker"),this._document.body.appendChild(t);const r=getComputedStyle(t);r&&"none"!==r.display&&console.warn("Could not find Angular Material core theme. Most Material components may not work as expected. For more info refer to the theming guide: https://material.angular.io/guide/theming"),this._document.body.removeChild(t)}_checkCdkVersionMatch(){this._checkIsEnabled("version")&&YN.full!==HL.full&&console.warn("The Angular Material version ("+YN.full+") does not match the Angular CDK version ("+HL.full+").\nPlease ensure the versions of these two packages exactly match.")}}return n.\u0275fac=function(t){return new(t||n)(yt($L),yt(xZ,8),yt(Fr))},n.\u0275mod=Gn({type:n}),n.\u0275inj=Gr({imports:[[Yv],Yv]}),n})();try{Pg="undefined"!=typeof Intl}catch(n){Pg=!1}function VT(n){return new Ie(function(e){je(n()).subscribe(e)})}function XZ(n,e){}class Nb{constructor(){this.role="dialog",this.panelClass="",this.hasBackdrop=!0,this.backdropClass="",this.disableClose=!1,this.width="",this.height="",this.maxWidth="80vw",this.data=null,this.ariaDescribedBy=null,this.ariaLabelledBy=null,this.ariaLabel=null,this.autoFocus=!0,this.restoreFocus=!0,this.closeOnNavigation=!0}}const YZ={dialogContainer:HX("dialogContainer",[YL("void, exit",T_({opacity:0,transform:"scale(0.7)"})),YL("enter",T_({transform:"none"})),ZL("* => enter",WL("150ms cubic-bezier(0, 0, 0.2, 1)",T_({transform:"none",opacity:1}))),ZL("* => void, * => exit",WL("75ms cubic-bezier(0.4, 0.0, 0.2, 1)",T_({opacity:0})))])};let ZZ=(()=>{class n extends rT{constructor(t,r,i,o,s,u){super(),this._elementRef=t,this._focusTrapFactory=r,this._changeDetectorRef=i,this._config=s,this._focusMonitor=u,this._animationStateChanged=new Ro,this._elementFocusedBeforeDialogWasOpened=null,this._closeInteractionType=null,this.attachDomPortal=f=>(this._portalOutlet.hasAttached(),this._portalOutlet.attachDomPortal(f)),this._ariaLabelledBy=s.ariaLabelledBy||null,this._document=o}_initializeWithAttachedContent(){this._setupFocusTrap(),this._capturePreviouslyFocusedElement(),this._focusDialogContainer()}attachComponentPortal(t){return this._portalOutlet.hasAttached(),this._portalOutlet.attachComponentPortal(t)}attachTemplatePortal(t){return this._portalOutlet.hasAttached(),this._portalOutlet.attachTemplatePortal(t)}_recaptureFocus(){this._containsFocus()||(!this._config.autoFocus||!this._focusTrap.focusInitialElement())&&this._elementRef.nativeElement.focus()}_trapFocus(){this._config.autoFocus?this._focusTrap.focusInitialElementWhenReady():this._containsFocus()||this._elementRef.nativeElement.focus()}_restoreFocus(){const t=this._elementFocusedBeforeDialogWasOpened;if(this._config.restoreFocus&&t&&"function"==typeof t.focus){const r=cb(),i=this._elementRef.nativeElement;(!r||r===this._document.body||r===i||i.contains(r))&&(this._focusMonitor?(this._focusMonitor.focusVia(t,this._closeInteractionType),this._closeInteractionType=null):t.focus())}this._focusTrap&&this._focusTrap.destroy()}_setupFocusTrap(){this._focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement)}_capturePreviouslyFocusedElement(){this._document&&(this._elementFocusedBeforeDialogWasOpened=cb())}_focusDialogContainer(){this._elementRef.nativeElement.focus&&this._elementRef.nativeElement.focus()}_containsFocus(){const t=this._elementRef.nativeElement,r=cb();return t===r||t.contains(r)}}return n.\u0275fac=function(t){return new(t||n)(Mt(Po),Mt(RL),Mt(gg),Mt(Fr,8),Mt(Nb),Mt(UL))},n.\u0275dir=Fn({type:n,viewQuery:function(t,r){if(1&t&&Cx(fb,7),2&t){let i;p_(i=g_())&&(r._portalOutlet=i.first)}},features:[Eo]}),n})(),KZ=(()=>{class n extends ZZ{constructor(){super(...arguments),this._state="enter"}_onAnimationDone({toState:t,totalTime:r}){"enter"===t?(this._trapFocus(),this._animationStateChanged.next({state:"opened",totalTime:r})):"exit"===t&&(this._restoreFocus(),this._animationStateChanged.next({state:"closed",totalTime:r}))}_onAnimationStart({toState:t,totalTime:r}){"enter"===t?this._animationStateChanged.next({state:"opening",totalTime:r}):("exit"===t||"void"===t)&&this._animationStateChanged.next({state:"closing",totalTime:r})}_startExitAnimation(){this._state="exit",this._changeDetectorRef.markForCheck()}}return n.\u0275fac=function(){let e;return function(r){return(e||(e=Ol(n)))(r||n)}}(),n.\u0275cmp=ao({type:n,selectors:[["mat-dialog-container"]],hostAttrs:["tabindex","-1","aria-modal","true",1,"mat-dialog-container"],hostVars:6,hostBindings:function(t,r){1&t&&aS("@dialogContainer.start",function(o){return r._onAnimationStart(o)})("@dialogContainer.done",function(o){return r._onAnimationDone(o)}),2&t&&(n_("id",r._id),nc("role",r._config.role)("aria-labelledby",r._config.ariaLabel?null:r._ariaLabelledBy)("aria-label",r._config.ariaLabel)("aria-describedby",r._config.ariaDescribedBy||null),dS("@dialogContainer",r._state))},features:[Eo],decls:1,vars:0,consts:[["cdkPortalOutlet",""]],template:function(t,r){1&t&&Qh(0,XZ,0,0,"ng-template",0)},directives:[fb],styles:[".mat-dialog-container{display:block;padding:24px;border-radius:4px;box-sizing:border-box;overflow:auto;outline:0;width:100%;height:100%;min-height:inherit;max-height:inherit}.cdk-high-contrast-active .mat-dialog-container{outline:solid 1px}.mat-dialog-content{display:block;margin:0 -24px;padding:0 24px;max-height:65vh;overflow:auto;-webkit-overflow-scrolling:touch}.mat-dialog-title{margin:0 0 20px;display:block}.mat-dialog-actions{padding:8px 0;display:flex;flex-wrap:wrap;min-height:52px;align-items:center;box-sizing:content-box;margin-bottom:-24px}.mat-dialog-actions[align=end]{justify-content:flex-end}.mat-dialog-actions[align=center]{justify-content:center}.mat-dialog-actions .mat-button-base+.mat-button-base,.mat-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:8px}[dir=rtl] .mat-dialog-actions .mat-button-base+.mat-button-base,[dir=rtl] .mat-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:0;margin-right:8px}\n"],encapsulation:2,data:{animation:[YZ.dialogContainer]}}),n})(),JZ=0;class UT{constructor(e,t,r="mat-dialog-"+JZ++){this._overlayRef=e,this._containerInstance=t,this.id=r,this.disableClose=this._containerInstance._config.disableClose,this._afterOpened=new wt,this._afterClosed=new wt,this._beforeClosed=new wt,this._state=0,t._id=r,t._animationStateChanged.pipe(Vc(i=>"opened"===i.state),Xn(1)).subscribe(()=>{this._afterOpened.next(),this._afterOpened.complete()}),t._animationStateChanged.pipe(Vc(i=>"closed"===i.state),Xn(1)).subscribe(()=>{clearTimeout(this._closeFallbackTimeout),this._finishDialogClose()}),e.detachments().subscribe(()=>{this._beforeClosed.next(this._result),this._beforeClosed.complete(),this._afterClosed.next(this._result),this._afterClosed.complete(),this.componentInstance=null,this._overlayRef.dispose()}),e.keydownEvents().pipe(Vc(i=>27===i.keyCode&&!this.disableClose&&!function(n,...e){return e.length?e.some(t=>n[t]):n.altKey||n.shiftKey||n.ctrlKey||n.metaKey}(i))).subscribe(i=>{i.preventDefault(),jT(this,"keyboard")}),e.backdropClick().subscribe(()=>{this.disableClose?this._containerInstance._recaptureFocus():jT(this,"mouse")})}close(e){this._result=e,this._containerInstance._animationStateChanged.pipe(Vc(t=>"closing"===t.state),Xn(1)).subscribe(t=>{this._beforeClosed.next(e),this._beforeClosed.complete(),this._overlayRef.detachBackdrop(),this._closeFallbackTimeout=setTimeout(()=>this._finishDialogClose(),t.totalTime+100)}),this._state=1,this._containerInstance._startExitAnimation()}afterOpened(){return this._afterOpened}afterClosed(){return this._afterClosed}beforeClosed(){return this._beforeClosed}backdropClick(){return this._overlayRef.backdropClick()}keydownEvents(){return this._overlayRef.keydownEvents()}updatePosition(e){let t=this._getPositionStrategy();return e&&(e.left||e.right)?e.left?t.left(e.left):t.right(e.right):t.centerHorizontally(),e&&(e.top||e.bottom)?e.top?t.top(e.top):t.bottom(e.bottom):t.centerVertically(),this._overlayRef.updatePosition(),this}updateSize(e="",t=""){return this._overlayRef.updateSize({width:e,height:t}),this._overlayRef.updatePosition(),this}addPanelClass(e){return this._overlayRef.addPanelClass(e),this}removePanelClass(e){return this._overlayRef.removePanelClass(e),this}getState(){return this._state}_finishDialogClose(){this._state=2,this._overlayRef.dispose()}_getPositionStrategy(){return this._overlayRef.getConfig().positionStrategy}}function jT(n,e,t){return void 0!==n._containerInstance&&(n._containerInstance._closeInteractionType=e),n.close(t)}const QZ=new gr("MatDialogData"),eK=new gr("mat-dialog-default-options"),rF=new gr("mat-dialog-scroll-strategy"),nK={provide:rF,deps:[S_],useFactory:function(n){return()=>n.scrollStrategies.block()}};let rK=(()=>{class n{constructor(t,r,i,o,s,u,f,g,v){this._overlay=t,this._injector=r,this._defaultOptions=i,this._parentDialog=o,this._overlayContainer=s,this._dialogRefConstructor=f,this._dialogContainerType=g,this._dialogDataToken=v,this._openDialogsAtThisLevel=[],this._afterAllClosedAtThisLevel=new wt,this._afterOpenedAtThisLevel=new wt,this._ariaHiddenElements=new Map,this.afterAllClosed=VT(()=>this.openDialogs.length?this._getAfterAllClosed():this._getAfterAllClosed().pipe(sb(void 0))),this._scrollStrategy=u}get openDialogs(){return this._parentDialog?this._parentDialog.openDialogs:this._openDialogsAtThisLevel}get afterOpened(){return this._parentDialog?this._parentDialog.afterOpened:this._afterOpenedAtThisLevel}_getAfterAllClosed(){const t=this._parentDialog;return t?t._getAfterAllClosed():this._afterAllClosedAtThisLevel}open(t,r){(r=function(n,e){return Object.assign(Object.assign({},e),n)}(r,this._defaultOptions||new Nb)).id&&this.getDialogById(r.id);const i=this._createOverlay(r),o=this._attachDialogContainer(i,r),s=this._attachDialogContent(t,o,i,r);return this.openDialogs.length||this._hideNonDialogContentFromAssistiveTechnology(),this.openDialogs.push(s),s.afterClosed().subscribe(()=>this._removeOpenDialog(s)),this.afterOpened.next(s),o._initializeWithAttachedContent(),s}closeAll(){this._closeDialogs(this.openDialogs)}getDialogById(t){return this.openDialogs.find(r=>r.id===t)}ngOnDestroy(){this._closeDialogs(this._openDialogsAtThisLevel),this._afterAllClosedAtThisLevel.complete(),this._afterOpenedAtThisLevel.complete()}_createOverlay(t){const r=this._getOverlayConfig(t);return this._overlay.create(r)}_getOverlayConfig(t){const r=new sT({positionStrategy:this._overlay.position().global(),scrollStrategy:t.scrollStrategy||this._scrollStrategy(),panelClass:t.panelClass,hasBackdrop:t.hasBackdrop,direction:t.direction,minWidth:t.minWidth,minHeight:t.minHeight,maxWidth:t.maxWidth,maxHeight:t.maxHeight,disposeOnNavigation:t.closeOnNavigation});return t.backdropClass&&(r.backdropClass=t.backdropClass),r}_attachDialogContainer(t,r){const o=mi.create({parent:r&&r.viewContainerRef&&r.viewContainerRef.injector||this._injector,providers:[{provide:Nb,useValue:r}]}),s=new nT(this._dialogContainerType,r.viewContainerRef,o,r.componentFactoryResolver);return t.attach(s).instance}_attachDialogContent(t,r,i,o){const s=new this._dialogRefConstructor(i,r,o.id);if(t instanceof zc)r.attachTemplatePortal(new db(t,null,{$implicit:o.data,dialogRef:s}));else{const u=this._createInjector(o,s,r),f=r.attachComponentPortal(new nT(t,o.viewContainerRef,u));s.componentInstance=f.instance}return s.updateSize(o.width,o.height).updatePosition(o.position),s}_createInjector(t,r,i){const o=t&&t.viewContainerRef&&t.viewContainerRef.injector,s=[{provide:this._dialogContainerType,useValue:i},{provide:this._dialogDataToken,useValue:t.data},{provide:this._dialogRefConstructor,useValue:r}];return t.direction&&(!o||!o.get(Sg,null,or.Optional))&&s.push({provide:Sg,useValue:{value:t.direction,change:Jr()}}),mi.create({parent:o||this._injector,providers:s})}_removeOpenDialog(t){const r=this.openDialogs.indexOf(t);r>-1&&(this.openDialogs.splice(r,1),this.openDialogs.length||(this._ariaHiddenElements.forEach((i,o)=>{i?o.setAttribute("aria-hidden",i):o.removeAttribute("aria-hidden")}),this._ariaHiddenElements.clear(),this._getAfterAllClosed().next()))}_hideNonDialogContentFromAssistiveTechnology(){const t=this._overlayContainer.getContainerElement();if(t.parentElement){const r=t.parentElement.children;for(let i=r.length-1;i>-1;i--){let o=r[i];o!==t&&"SCRIPT"!==o.nodeName&&"STYLE"!==o.nodeName&&!o.hasAttribute("aria-live")&&(this._ariaHiddenElements.set(o,o.getAttribute("aria-hidden")),o.setAttribute("aria-hidden","true"))}}}_closeDialogs(t){let r=t.length;for(;r--;)t[r].close()}}return n.\u0275fac=function(t){return new(t||n)(Mt(S_),Mt(mi),Mt(void 0),Mt(void 0),Mt(Kv),Mt(void 0),Mt(nf),Mt(nf),Mt(gr))},n.\u0275dir=Fn({type:n}),n})(),t0=(()=>{class n extends rK{constructor(t,r,i,o,s,u,f){super(t,r,o,u,f,s,UT,KZ,QZ)}}return n.\u0275fac=function(t){return new(t||n)(yt(S_),yt(mi),yt(w_,8),yt(eK,8),yt(rF),yt(n,12),yt(Kv))},n.\u0275prov=Dn({token:n,factory:n.\u0275fac}),n})(),oF=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Gn({type:n}),n.\u0275inj=Gr({providers:[t0,nK],imports:[[xX,fL,bp],bp]}),n})();var sK=Array.isArray,aK=Object.getPrototypeOf,lK=Object.prototype,uK=Object.keys;function sF(n){if(1===n.length){var e=n[0];if(sK(e))return{args:e,keys:null};if(function(n){return n&&"object"==typeof n&&aK(n)===lK}(e)){var t=uK(e);return{args:t.map(function(r){return e[r]}),keys:t}}}return{args:n,keys:null}}function aF(n,e){return n.reduce(function(t,r,i){return t[r]=e[i],t},{})}let lF=(()=>{class n{constructor(t,r){this._renderer=t,this._elementRef=r,this.onChange=i=>{},this.onTouched=()=>{}}setProperty(t,r){this._renderer.setProperty(this._elementRef.nativeElement,t,r)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}}return n.\u0275fac=function(t){return new(t||n)(Mt(bf),Mt(Po))},n.\u0275dir=Fn({type:n}),n})(),Rg=(()=>{class n extends lF{}return n.\u0275fac=function(){let e;return function(r){return(e||(e=Ol(n)))(r||n)}}(),n.\u0275dir=Fn({type:n,features:[Eo]}),n})();const Bd=new gr("NgValueAccessor"),fK={provide:Bd,useExisting:_r(()=>R_),multi:!0},gK=new gr("CompositionEventMode");let R_=(()=>{class n extends lF{constructor(t,r,i){super(t,r),this._compositionMode=i,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function(){const n=Nd()?Nd().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}())}writeValue(t){this.setProperty("value",null==t?"":t)}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}}return n.\u0275fac=function(t){return new(t||n)(Mt(bf),Mt(Po),Mt(gK,8))},n.\u0275dir=Fn({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(t,r){1&t&&Xs("input",function(o){return r._handleInput(o.target.value)})("blur",function(){return r.onTouched()})("compositionstart",function(){return r._compositionStart()})("compositionend",function(o){return r._compositionEnd(o.target.value)})},features:[is([fK]),Eo]}),n})();function wp(n){return null==n||0===n.length}function cF(n){return null!=n&&"number"==typeof n.length}const Bu=new gr("NgValidators"),Ep=new gr("NgAsyncValidators"),mK=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class hF{static min(e){return dF(e)}static max(e){return fF(e)}static required(e){return pF(e)}static requiredTrue(e){return function(n){return!0===n.value?null:{required:!0}}(e)}static email(e){return function(n){return wp(n.value)||mK.test(n.value)?null:{email:!0}}(e)}static minLength(e){return function(n){return e=>wp(e.value)||!cF(e.value)?null:e.value.length<n?{minlength:{requiredLength:n,actualLength:e.value.length}}:null}(e)}static maxLength(e){return function(n){return e=>cF(e.value)&&e.value.length>n?{maxlength:{requiredLength:n,actualLength:e.value.length}}:null}(e)}static pattern(e){return function(n){if(!n)return Cp;let e,t;return"string"==typeof n?(t="","^"!==n.charAt(0)&&(t+="^"),t+=n,"$"!==n.charAt(n.length-1)&&(t+="$"),e=new RegExp(t)):(t=n.toString(),e=n),r=>{if(wp(r.value))return null;const i=r.value;return e.test(i)?null:{pattern:{requiredPattern:t,actualValue:i}}}}(e)}static nullValidator(e){return null}static compose(e){return SF(e)}static composeAsync(e){return MF(e)}}function dF(n){return e=>{if(wp(e.value)||wp(n))return null;const t=parseFloat(e.value);return!isNaN(t)&&t<n?{min:{min:n,actual:e.value}}:null}}function fF(n){return e=>{if(wp(e.value)||wp(n))return null;const t=parseFloat(e.value);return!isNaN(t)&&t>n?{max:{max:n,actual:e.value}}:null}}function pF(n){return wp(n.value)?{required:!0}:null}function Cp(n){return null}function xF(n){return null!=n}function bF(n){const e=fv(n)?Ae(n):n;return sx(e),e}function wF(n){let e={};return n.forEach(t=>{e=null!=t?Object.assign(Object.assign({},e),t):e}),0===Object.keys(e).length?null:e}function EF(n,e){return e.map(t=>t(n))}function CF(n){return n.map(e=>function(n){return!n.validate}(e)?e:t=>e.validate(t))}function SF(n){if(!n)return null;const e=n.filter(xF);return 0==e.length?null:function(t){return wF(EF(t,e))}}function GT(n){return null!=n?SF(CF(n)):null}function MF(n){if(!n)return null;const e=n.filter(xF);return 0==e.length?null:function(t){return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var t=vr(n),r=sF(n),i=r.args,o=r.keys,s=new Ie(function(u){var f=i.length;if(f)for(var g=new Array(f),v=f,E=f,T=function(B){var z=!1;je(i[B]).subscribe(new jn(u,function(G){z||(z=!0,E--),g[B]=G},function(){(!--v||!z)&&(E||u.next(o?aF(o,g):g),u.complete())}))},R=0;R<f;R++)T(R);else u.complete()});return t?s.pipe(HM(t)):s}(EF(t,e).map(bF)).pipe(ar(wF))}}function $T(n){return null!=n?MF(CF(n)):null}function TF(n,e){return null===n?[e]:Array.isArray(n)?[...n,e]:[n,e]}function DF(n){return n._rawValidators}function IF(n){return n._rawAsyncValidators}function HT(n){return n?Array.isArray(n)?n:[n]:[]}function Fb(n,e){return Array.isArray(n)?n.includes(e):n===e}function AF(n,e){const t=HT(e);return HT(n).forEach(i=>{Fb(t,i)||t.push(i)}),t}function PF(n,e){return HT(e).filter(t=>!Fb(n,t))}let RF=(()=>{class n{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(t){this._rawValidators=t||[],this._composedValidatorFn=GT(this._rawValidators)}_setAsyncValidators(t){this._rawAsyncValidators=t||[],this._composedAsyncValidatorFn=$T(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(t){this._onDestroyCallbacks.push(t)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(t=>t()),this._onDestroyCallbacks=[]}reset(t){this.control&&this.control.reset(t)}hasError(t,r){return!!this.control&&this.control.hasError(t,r)}getError(t,r){return this.control?this.control.getError(t,r):null}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275dir=Fn({type:n}),n})(),ac=(()=>{class n extends RF{get formDirective(){return null}get path(){return null}}return n.\u0275fac=function(){let e;return function(r){return(e||(e=Ol(n)))(r||n)}}(),n.\u0275dir=Fn({type:n,features:[Eo]}),n})();class Sp extends RF{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class OF{constructor(e){this._cd=e}is(e){var t,r,i;return"submitted"===e?!!(null===(t=this._cd)||void 0===t?void 0:t.submitted):!!(null===(i=null===(r=this._cd)||void 0===r?void 0:r.control)||void 0===i?void 0:i[e])}}let Bb=(()=>{class n extends OF{constructor(t){super(t)}}return n.\u0275fac=function(t){return new(t||n)(Mt(Sp,2))},n.\u0275dir=Fn({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(t,r){2&t&&xf("ng-untouched",r.is("untouched"))("ng-touched",r.is("touched"))("ng-pristine",r.is("pristine"))("ng-dirty",r.is("dirty"))("ng-valid",r.is("valid"))("ng-invalid",r.is("invalid"))("ng-pending",r.is("pending"))},features:[Eo]}),n})(),qT=(()=>{class n extends OF{constructor(t){super(t)}}return n.\u0275fac=function(t){return new(t||n)(Mt(ac,10))},n.\u0275dir=Fn({type:n,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(t,r){2&t&&xf("ng-untouched",r.is("untouched"))("ng-touched",r.is("touched"))("ng-pristine",r.is("pristine"))("ng-dirty",r.is("dirty"))("ng-valid",r.is("valid"))("ng-invalid",r.is("invalid"))("ng-pending",r.is("pending"))("ng-submitted",r.is("submitted"))},features:[Eo]}),n})();function n0(n,e){WT(n,e),e.valueAccessor.writeValue(n.value),function(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,"change"===n.updateOn&&kF(n,e)})}(n,e),function(n,e){const t=(r,i)=>{e.valueAccessor.writeValue(r),i&&e.viewToModelUpdate(r)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}(n,e),function(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,"blur"===n.updateOn&&n._pendingChange&&kF(n,e),"submit"!==n.updateOn&&n.markAsTouched()})}(n,e),function(n,e){if(e.valueAccessor.setDisabledState){const t=r=>{e.valueAccessor.setDisabledState(r)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}(n,e)}function Vb(n,e,t=!0){const r=()=>{};e.valueAccessor&&(e.valueAccessor.registerOnChange(r),e.valueAccessor.registerOnTouched(r)),jb(n,e),n&&(e._invokeOnDestroyCallbacks(),n._registerOnCollectionChange(()=>{}))}function Ub(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function WT(n,e){const t=DF(n);null!==e.validator?n.setValidators(TF(t,e.validator)):"function"==typeof t&&n.setValidators([t]);const r=IF(n);null!==e.asyncValidator?n.setAsyncValidators(TF(r,e.asyncValidator)):"function"==typeof r&&n.setAsyncValidators([r]);const i=()=>n.updateValueAndValidity();Ub(e._rawValidators,i),Ub(e._rawAsyncValidators,i)}function jb(n,e){let t=!1;if(null!==n){if(null!==e.validator){const i=DF(n);if(Array.isArray(i)&&i.length>0){const o=i.filter(s=>s!==e.validator);o.length!==i.length&&(t=!0,n.setValidators(o))}}if(null!==e.asyncValidator){const i=IF(n);if(Array.isArray(i)&&i.length>0){const o=i.filter(s=>s!==e.asyncValidator);o.length!==i.length&&(t=!0,n.setAsyncValidators(o))}}}const r=()=>{};return Ub(e._rawValidators,r),Ub(e._rawAsyncValidators,r),t}function kF(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function XT(n,e){if(!n.hasOwnProperty("model"))return!1;const t=n.model;return!!t.isFirstChange()||!Object.is(e,t.currentValue)}function YT(n,e){if(!e)return null;let t,r,i;return Array.isArray(e),e.forEach(o=>{o.constructor===R_?t=o:function(n){return Object.getPrototypeOf(n.constructor)===Rg}(o)?r=o:i=o}),i||r||t||null}function Gb(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}const r0="VALID",$b="INVALID",O_="PENDING",o0="DISABLED";function ZT(n){return(JT(n)?n.validators:n)||null}function FF(n){return Array.isArray(n)?GT(n):n||null}function KT(n,e){return(JT(e)?e.asyncValidators:n)||null}function BF(n){return Array.isArray(n)?$T(n):n||null}function JT(n){return null!=n&&!Array.isArray(n)&&"object"==typeof n}class QT{constructor(e,t){this._hasOwnPendingAsyncValidator=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=e,this._rawAsyncValidators=t,this._composedValidatorFn=FF(this._rawValidators),this._composedAsyncValidatorFn=BF(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===r0}get invalid(){return this.status===$b}get pending(){return this.status==O_}get disabled(){return this.status===o0}get enabled(){return this.status!==o0}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._rawValidators=e,this._composedValidatorFn=FF(e)}setAsyncValidators(e){this._rawAsyncValidators=e,this._composedAsyncValidatorFn=BF(e)}addValidators(e){this.setValidators(AF(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(AF(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(PF(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(PF(e,this._rawAsyncValidators))}hasValidator(e){return Fb(this._rawValidators,e)}hasAsyncValidator(e){return Fb(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(t=>{t.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(t=>{t.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=O_,!1!==e.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=o0,this.errors=null,this._forEachChild(r=>{r.disable(Object.assign(Object.assign({},e),{onlySelf:!0}))}),this._updateValue(),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Object.assign(Object.assign({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(r=>r(!0))}enable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=r0,this._forEachChild(r=>{r.enable(Object.assign(Object.assign({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(Object.assign(Object.assign({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===r0||this.status===O_)&&this._runAsyncValidator(e.emitEvent)),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?o0:r0}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=O_,this._hasOwnPendingAsyncValidator=!0;const t=bF(this.asyncValidator(this));this._asyncValidationSubscription=t.subscribe(r=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(r,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(!1!==t.emitEvent)}get(e){return function(n,e,t){if(null==e||(Array.isArray(e)||(e=e.split(".")),Array.isArray(e)&&0===e.length))return null;let r=n;return e.forEach(i=>{r=r instanceof s0?r.controls.hasOwnProperty(i)?r.controls[i]:null:r instanceof eD&&r.at(i)||null}),r}(this,e)}getError(e,t){const r=t?this.get(t):this;return r&&r.errors?r.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new Ro,this.statusChanges=new Ro}_calculateStatus(){return this._allControlsDisabled()?o0:this.errors?$b:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(O_)?O_:this._anyControlsHaveStatus($b)?$b:r0}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_isBoxedValue(e){return"object"==typeof e&&null!==e&&2===Object.keys(e).length&&"value"in e&&"disabled"in e}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){JT(e)&&null!=e.updateOn&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){return!e&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}}class Mp extends QT{constructor(e=null,t,r){super(ZT(t),KT(r,t)),this._onChange=[],this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&!1!==t.emitModelToViewChange&&this._onChange.forEach(r=>r(this.value,!1!==t.emitViewToModelChange)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=null,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){Gb(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){Gb(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(e){this._isBoxedValue(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}}class s0 extends QT{constructor(e,t,r){super(ZT(t),KT(r,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t,r={}){this.registerControl(e,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}removeControl(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(e,t,r={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){this._checkAllValuesPresent(e),Object.keys(e).forEach(r=>{this._throwIfControlMissing(r),this.controls[r].setValue(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){null!=e&&(Object.keys(e).forEach(r=>{this.controls[r]&&this.controls[r].patchValue(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e={},t={}){this._forEachChild((r,i)=>{r.reset(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this._reduceChildren({},(e,t,r)=>(e[r]=t instanceof Mp?t.value:t.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(t,r)=>!!r._syncPendingControls()||t);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_throwIfControlMissing(e){if(!Object.keys(this.controls).length)throw new Error("\n        There are no form controls registered with this group yet. If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.controls[e])throw new Error(`Cannot find form control with name: ${e}.`)}_forEachChild(e){Object.keys(this.controls).forEach(t=>{const r=this.controls[t];r&&e(r,t)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(const t of Object.keys(this.controls)){const r=this.controls[t];if(this.contains(t)&&e(r))return!0}return!1}_reduceValue(){return this._reduceChildren({},(e,t,r)=>((t.enabled||this.disabled)&&(e[r]=t.value),e))}_reduceChildren(e,t){let r=e;return this._forEachChild((i,o)=>{r=t(r,i,o)}),r}_allControlsDisabled(){for(const e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_checkAllValuesPresent(e){this._forEachChild((t,r)=>{if(void 0===e[r])throw new Error(`Must supply a value for form control with name: '${r}'.`)})}}class eD extends QT{constructor(e,t,r){super(ZT(t),KT(r,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(e){return this.controls[e]}push(e,t={}){this.controls.push(e),this._registerControl(e),this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}insert(e,t,r={}){this.controls.splice(e,0,t),this._registerControl(t),this.updateValueAndValidity({emitEvent:r.emitEvent})}removeAt(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),this.controls.splice(e,1),this.updateValueAndValidity({emitEvent:t.emitEvent})}setControl(e,t,r={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),this.controls.splice(e,1),t&&(this.controls.splice(e,0,t),this._registerControl(t)),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(e,t={}){this._checkAllValuesPresent(e),e.forEach((r,i)=>{this._throwIfControlMissing(i),this.at(i).setValue(r,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){null!=e&&(e.forEach((r,i)=>{this.at(i)&&this.at(i).patchValue(r,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e=[],t={}){this._forEachChild((r,i)=>{r.reset(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this.controls.map(e=>e instanceof Mp?e.value:e.getRawValue())}clear(e={}){this.controls.length<1||(this._forEachChild(t=>t._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:e.emitEvent}))}_syncPendingControls(){let e=this.controls.reduce((t,r)=>!!r._syncPendingControls()||t,!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_throwIfControlMissing(e){if(!this.controls.length)throw new Error("\n        There are no form controls registered with this array yet. If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.at(e))throw new Error(`Cannot find form control at index ${e}`)}_forEachChild(e){this.controls.forEach((t,r)=>{e(t,r)})}_updateValue(){this.value=this.controls.filter(e=>e.enabled||this.disabled).map(e=>e.value)}_anyControls(e){return this.controls.some(t=>t.enabled&&e(t))}_setUpControls(){this._forEachChild(e=>this._registerControl(e))}_checkAllValuesPresent(e){this._forEachChild((t,r)=>{if(void 0===e[r])throw new Error(`Must supply a value for form control at index: ${r}.`)})}_allControlsDisabled(){for(const e of this.controls)if(e.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}}let nD=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275dir=Fn({type:n,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),n})();const AK={provide:Bd,useExisting:_r(()=>rD),multi:!0};let rD=(()=>{class n extends Rg{writeValue(t){this.setProperty("value",null==t?"":t)}registerOnChange(t){this.onChange=r=>{t(""==r?null:parseFloat(r))}}}return n.\u0275fac=function(){let e;return function(r){return(e||(e=Ol(n)))(r||n)}}(),n.\u0275dir=Fn({type:n,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(t,r){1&t&&Xs("input",function(o){return r.onChange(o.target.value)})("blur",function(){return r.onTouched()})},features:[is([AK]),Eo]}),n})();const PK={provide:Bd,useExisting:_r(()=>iD),multi:!0};let GF=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Gn({type:n}),n.\u0275inj=Gr({}),n})(),RK=(()=>{class n{constructor(){this._accessors=[]}add(t,r){this._accessors.push([t,r])}remove(t){for(let r=this._accessors.length-1;r>=0;--r)if(this._accessors[r][1]===t)return void this._accessors.splice(r,1)}select(t){this._accessors.forEach(r=>{this._isSameGroup(r,t)&&r[1]!==t&&r[1].fireUncheck(t.value)})}_isSameGroup(t,r){return!!t[0].control&&t[0]._parent===r._control._parent&&t[1].name===r.name}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Dn({factory:function(){return new n},token:n,providedIn:GF}),n})(),iD=(()=>{class n extends Rg{constructor(t,r,i,o){super(t,r),this._registry=i,this._injector=o,this.onChange=()=>{}}ngOnInit(){this._control=this._injector.get(Sp),this._checkName(),this._registry.add(this._control,this)}ngOnDestroy(){this._registry.remove(this)}writeValue(t){this._state=t===this.value,this.setProperty("checked",this._state)}registerOnChange(t){this._fn=t,this.onChange=()=>{t(this.value),this._registry.select(this)}}fireUncheck(t){this.writeValue(t)}_checkName(){!this.name&&this.formControlName&&(this.name=this.formControlName)}}return n.\u0275fac=function(t){return new(t||n)(Mt(bf),Mt(Po),Mt(RK),Mt(mi))},n.\u0275dir=Fn({type:n,selectors:[["input","type","radio","formControlName",""],["input","type","radio","formControl",""],["input","type","radio","ngModel",""]],hostBindings:function(t,r){1&t&&Xs("change",function(){return r.onChange()})("blur",function(){return r.onTouched()})},inputs:{name:"name",formControlName:"formControlName",value:"value"},features:[is([PK]),Eo]}),n})();const OK={provide:Bd,useExisting:_r(()=>oD),multi:!0};let oD=(()=>{class n extends Rg{writeValue(t){this.setProperty("value",parseFloat(t))}registerOnChange(t){this.onChange=r=>{t(""==r?null:parseFloat(r))}}}return n.\u0275fac=function(){let e;return function(r){return(e||(e=Ol(n)))(r||n)}}(),n.\u0275dir=Fn({type:n,selectors:[["input","type","range","formControlName",""],["input","type","range","formControl",""],["input","type","range","ngModel",""]],hostBindings:function(t,r){1&t&&Xs("change",function(o){return r.onChange(o.target.value)})("input",function(o){return r.onChange(o.target.value)})("blur",function(){return r.onTouched()})},features:[is([OK]),Eo]}),n})();const sD=new gr("NgModelWithFormControlWarning"),kK={provide:Sp,useExisting:_r(()=>aD)};let aD=(()=>{class n extends Sp{constructor(t,r,i,o){super(),this._ngModelWarningConfig=o,this.update=new Ro,this._ngModelWarningSent=!1,this._setValidators(t),this._setAsyncValidators(r),this.valueAccessor=YT(0,i)}set isDisabled(t){}ngOnChanges(t){if(this._isControlChanged(t)){const r=t.form.previousValue;r&&Vb(r,this,!1),n0(this.form,this),this.control.disabled&&this.valueAccessor.setDisabledState&&this.valueAccessor.setDisabledState(!0),this.form.updateValueAndValidity({emitEvent:!1})}XT(t,this.viewModel)&&(this.form.setValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.form&&Vb(this.form,this,!1)}get path(){return[]}get control(){return this.form}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_isControlChanged(t){return t.hasOwnProperty("form")}}return n.\u0275fac=function(t){return new(t||n)(Mt(Bu,10),Mt(Ep,10),Mt(Bd,10),Mt(sD,8))},n.\u0275dir=Fn({type:n,selectors:[["","formControl",""]],inputs:{isDisabled:["disabled","isDisabled"],form:["formControl","form"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},exportAs:["ngForm"],features:[is([kK]),Eo,Lo]}),n._ngModelWarningSentOnce=!1,n})();const LK={provide:ac,useExisting:_r(()=>l0)};let l0=(()=>{class n extends ac{constructor(t,r){super(),this.validators=t,this.asyncValidators=r,this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new Ro,this._setValidators(t),this._setAsyncValidators(r)}ngOnChanges(t){this._checkFormPresent(),t.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(jb(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(t){const r=this.form.get(t.path);return n0(r,t),r.updateValueAndValidity({emitEvent:!1}),this.directives.push(t),r}getControl(t){return this.form.get(t.path)}removeControl(t){Vb(t.control||null,t,!1),Gb(this.directives,t)}addFormGroup(t){this._setUpFormContainer(t)}removeFormGroup(t){this._cleanUpFormContainer(t)}getFormGroup(t){return this.form.get(t.path)}addFormArray(t){this._setUpFormContainer(t)}removeFormArray(t){this._cleanUpFormContainer(t)}getFormArray(t){return this.form.get(t.path)}updateModel(t,r){this.form.get(t.path).setValue(r)}onSubmit(t){return this.submitted=!0,function(n,e){n._syncPendingControls(),e.forEach(t=>{const r=t.control;"submit"===r.updateOn&&r._pendingChange&&(t.viewToModelUpdate(r._pendingValue),r._pendingChange=!1)})}(this.form,this.directives),this.ngSubmit.emit(t),!1}onReset(){this.resetForm()}resetForm(t){this.form.reset(t),this.submitted=!1}_updateDomValue(){this.directives.forEach(t=>{const r=t.control,i=this.form.get(t.path);r!==i&&(Vb(r||null,t),i instanceof Mp&&(n0(i,t),t.control=i))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(t){const r=this.form.get(t.path);(function(n,e){WT(n,e)})(r,t),r.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(t){if(this.form){const r=this.form.get(t.path);r&&function(n,e){return jb(n,e)}(r,t)&&r.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){WT(this.form,this),this._oldForm&&jb(this._oldForm,this)}_checkFormPresent(){}}return n.\u0275fac=function(t){return new(t||n)(Mt(Bu,10),Mt(Ep,10))},n.\u0275dir=Fn({type:n,selectors:[["","formGroup",""]],hostBindings:function(t,r){1&t&&Xs("submit",function(o){return r.onSubmit(o)})("reset",function(){return r.onReset()})},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[is([LK]),Eo,Lo]}),n})();const BK={provide:Sp,useExisting:_r(()=>Hb)};let Hb=(()=>{class n extends Sp{constructor(t,r,i,o,s){super(),this._ngModelWarningConfig=s,this._added=!1,this.update=new Ro,this._ngModelWarningSent=!1,this._parent=t,this._setValidators(r),this._setAsyncValidators(i),this.valueAccessor=YT(0,o)}set isDisabled(t){}ngOnChanges(t){this._added||this._setUpControl(),XT(t,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}get path(){return function(n,e){return[...e.path,n]}(null==this.name?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this.control.disabled&&this.valueAccessor.setDisabledState&&this.valueAccessor.setDisabledState(!0),this._added=!0}}return n.\u0275fac=function(t){return new(t||n)(Mt(ac,13),Mt(Bu,10),Mt(Ep,10),Mt(Bd,10),Mt(sD,8))},n.\u0275dir=Fn({type:n,selectors:[["","formControlName",""]],inputs:{isDisabled:["disabled","isDisabled"],name:["formControlName","name"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},features:[is([BK]),Eo,Lo]}),n._ngModelWarningSentOnce=!1,n})();const zK={provide:Bd,useExisting:_r(()=>qb),multi:!0};function HF(n,e){return null==n?`${e}`:(e&&"object"==typeof e&&(e="Object"),`${n}: ${e}`.slice(0,50))}let qb=(()=>{class n extends Rg{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(t){this._compareWith=t}writeValue(t){this.value=t;const r=this._getOptionId(t);null==r&&this.setProperty("selectedIndex",-1);const i=HF(r,t);this.setProperty("value",i)}registerOnChange(t){this.onChange=r=>{this.value=this._getOptionValue(r),t(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(t){for(const r of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(r),t))return r;return null}_getOptionValue(t){const r=function(n){return n.split(":")[0]}(t);return this._optionMap.has(r)?this._optionMap.get(r):t}}return n.\u0275fac=function(){let e;return function(r){return(e||(e=Ol(n)))(r||n)}}(),n.\u0275dir=Fn({type:n,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(t,r){1&t&&Xs("change",function(o){return r.onChange(o.target.value)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},features:[is([zK]),Eo]}),n})(),qF=(()=>{class n{constructor(t,r,i){this._element=t,this._renderer=r,this._select=i,this._select&&(this.id=this._select._registerOption())}set ngValue(t){null!=this._select&&(this._select._optionMap.set(this.id,t),this._setElementValue(HF(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._setElementValue(t),this._select&&this._select.writeValue(this._select.value)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return n.\u0275fac=function(t){return new(t||n)(Mt(Po),Mt(bf),Mt(qb,9))},n.\u0275dir=Fn({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),n})();const UK={provide:Bd,useExisting:_r(()=>cD),multi:!0};function WF(n,e){return null==n?`${e}`:("string"==typeof e&&(e=`'${e}'`),e&&"object"==typeof e&&(e="Object"),`${n}: ${e}`.slice(0,50))}let cD=(()=>{class n extends Rg{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(t){this._compareWith=t}writeValue(t){let r;if(this.value=t,Array.isArray(t)){const i=t.map(o=>this._getOptionId(o));r=(o,s)=>{o._setSelected(i.indexOf(s.toString())>-1)}}else r=(i,o)=>{i._setSelected(!1)};this._optionMap.forEach(r)}registerOnChange(t){this.onChange=r=>{const i=[];if(void 0!==r.selectedOptions){const o=r.selectedOptions;for(let s=0;s<o.length;s++){const u=o.item(s),f=this._getOptionValue(u.value);i.push(f)}}else{const o=r.options;for(let s=0;s<o.length;s++){const u=o.item(s);if(u.selected){const f=this._getOptionValue(u.value);i.push(f)}}}this.value=i,t(i)}}_registerOption(t){const r=(this._idCounter++).toString();return this._optionMap.set(r,t),r}_getOptionId(t){for(const r of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(r)._value,t))return r;return null}_getOptionValue(t){const r=function(n){return n.split(":")[0]}(t);return this._optionMap.has(r)?this._optionMap.get(r)._value:t}}return n.\u0275fac=function(){let e;return function(r){return(e||(e=Ol(n)))(r||n)}}(),n.\u0275dir=Fn({type:n,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(t,r){1&t&&Xs("change",function(o){return r.onChange(o.target)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},features:[is([UK]),Eo]}),n})(),XF=(()=>{class n{constructor(t,r,i){this._element=t,this._renderer=r,this._select=i,this._select&&(this.id=this._select._registerOption(this))}set ngValue(t){null!=this._select&&(this._value=t,this._setElementValue(WF(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._select?(this._value=t,this._setElementValue(WF(this.id,t)),this._select.writeValue(this._select.value)):this._setElementValue(t)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}_setSelected(t){this._renderer.setProperty(this._element.nativeElement,"selected",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return n.\u0275fac=function(t){return new(t||n)(Mt(Po),Mt(bf),Mt(cD,9))},n.\u0275dir=Fn({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),n})(),ZF=(()=>{class n{constructor(){this._validator=Cp}handleChanges(t){if(this.inputName in t){const r=this.normalizeInput(t[this.inputName].currentValue);this._validator=this.createValidator(r),this._onChange&&this._onChange()}}validate(t){return this._validator(t)}registerOnValidatorChange(t){this._onChange=t}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275dir=Fn({type:n}),n})();const GK={provide:Bu,useExisting:_r(()=>hD),multi:!0};let hD=(()=>{class n extends ZF{constructor(){super(...arguments),this.inputName="max",this.normalizeInput=t=>parseFloat(t),this.createValidator=t=>fF(t)}ngOnChanges(t){this.handleChanges(t)}}return n.\u0275fac=function(){let e;return function(r){return(e||(e=Ol(n)))(r||n)}}(),n.\u0275dir=Fn({type:n,selectors:[["input","type","number","max","","formControlName",""],["input","type","number","max","","formControl",""],["input","type","number","max","","ngModel",""]],hostVars:1,hostBindings:function(t,r){if(2&t){let i;nc("max",null!==(i=r.max)&&void 0!==i?i:null)}},inputs:{max:"max"},features:[is([GK]),Eo,Lo]}),n})();const $K={provide:Bu,useExisting:_r(()=>dD),multi:!0};let dD=(()=>{class n extends ZF{constructor(){super(...arguments),this.inputName="min",this.normalizeInput=t=>parseFloat(t),this.createValidator=t=>dF(t)}ngOnChanges(t){this.handleChanges(t)}}return n.\u0275fac=function(){let e;return function(r){return(e||(e=Ol(n)))(r||n)}}(),n.\u0275dir=Fn({type:n,selectors:[["input","type","number","min","","formControlName",""],["input","type","number","min","","formControl",""],["input","type","number","min","","ngModel",""]],hostVars:1,hostBindings:function(t,r){if(2&t){let i;nc("min",null!==(i=r.min)&&void 0!==i?i:null)}},inputs:{min:"min"},features:[is([$K]),Eo,Lo]}),n})();const HK={provide:Bu,useExisting:_r(()=>Wb),multi:!0};let Wb=(()=>{class n{constructor(){this._required=!1}get required(){return this._required}set required(t){this._required=null!=t&&!1!==t&&"false"!=`${t}`,this._onChange&&this._onChange()}validate(t){return this.required?pF(t):null}registerOnValidatorChange(t){this._onChange=t}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275dir=Fn({type:n,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(t,r){2&t&&nc("required",r.required?"":null)},inputs:{required:"required"},features:[is([HK])]}),n})(),nB=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Gn({type:n}),n.\u0275inj=Gr({imports:[[GF]]}),n})(),fD=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:sD,useValue:t.warnOnNgModelWithFormControl}]}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Gn({type:n}),n.\u0275inj=Gr({imports:[nB]}),n})(),rB=(()=>{class n{group(t,r=null){const i=this._reduceControls(t);let u,o=null,s=null;return null!=r&&(function(n){return void 0!==n.asyncValidators||void 0!==n.validators||void 0!==n.updateOn}(r)?(o=null!=r.validators?r.validators:null,s=null!=r.asyncValidators?r.asyncValidators:null,u=null!=r.updateOn?r.updateOn:void 0):(o=null!=r.validator?r.validator:null,s=null!=r.asyncValidator?r.asyncValidator:null)),new s0(i,{asyncValidators:s,updateOn:u,validators:o})}control(t,r,i){return new Mp(t,r,i)}array(t,r,i){const o=t.map(s=>this._createControl(s));return new eD(o,r,i)}_reduceControls(t){const r={};return Object.keys(t).forEach(i=>{r[i]=this._createControl(t[i])}),r}_createControl(t){return t instanceof Mp||t instanceof s0||t instanceof eD?t:Array.isArray(t)?this.control(t[0],t.length>1?t[1]:null,t.length>2?t[2]:null):this.control(t)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Dn({factory:function(){return new n},token:n,providedIn:fD}),n})();function k_(n,e){return Oe(e)?bn(n,e,1):bn(n,1)}class iB{}class oB{}class Bl{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?this.lazyInit="string"==typeof e?()=>{this.headers=new Map,e.split("\n").forEach(t=>{const r=t.indexOf(":");if(r>0){const i=t.slice(0,r),o=i.toLowerCase(),s=t.slice(r+1).trim();this.maybeSetNormalizedName(i,o),this.headers.has(o)?this.headers.get(o).push(s):this.headers.set(o,[s])}})}:()=>{this.headers=new Map,Object.keys(e).forEach(t=>{let r=e[t];const i=t.toLowerCase();"string"==typeof r&&(r=[r]),r.length>0&&(this.headers.set(i,r),this.maybeSetNormalizedName(t,i))})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();const t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof Bl?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){const t=new Bl;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof Bl?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){const t=e.name.toLowerCase();switch(e.op){case"a":case"s":let r=e.value;if("string"==typeof r&&(r=[r]),0===r.length)return;this.maybeSetNormalizedName(e.name,t);const i=("a"===e.op?this.headers.get(t):void 0)||[];i.push(...r),this.headers.set(t,i);break;case"d":const o=e.value;if(o){let s=this.headers.get(t);if(!s)return;s=s.filter(u=>-1===o.indexOf(u)),0===s.length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,s)}else this.headers.delete(t),this.normalizedNames.delete(t)}}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}}class JK{encodeKey(e){return sB(e)}encodeValue(e){return sB(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}}function sB(n){return encodeURIComponent(n).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/gi,"$").replace(/%2C/gi,",").replace(/%3B/gi,";").replace(/%2B/gi,"+").replace(/%3D/gi,"=").replace(/%3F/gi,"?").replace(/%2F/gi,"/")}function aB(n){return`${n}`}class Tp{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new JK,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function(n,e){const t=new Map;return n.length>0&&n.replace(/^\?/,"").split("&").forEach(i=>{const o=i.indexOf("="),[s,u]=-1==o?[e.decodeKey(i),""]:[e.decodeKey(i.slice(0,o)),e.decodeValue(i.slice(o+1))],f=t.get(s)||[];f.push(u),t.set(s,f)}),t}(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{const r=e.fromObject[t];this.map.set(t,Array.isArray(r)?r:[r])})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();const t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){const t=[];return Object.keys(e).forEach(r=>{const i=e[r];Array.isArray(i)?i.forEach(o=>{t.push({param:r,value:o,op:"a"})}):t.push({param:r,value:i,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{const t=this.encoder.encodeKey(e);return this.map.get(e).map(r=>t+"="+this.encoder.encodeValue(r)).join("&")}).filter(e=>""!==e).join("&")}clone(e){const t=new Tp({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":const t=("a"===e.op?this.map.get(e.param):void 0)||[];t.push(aB(e.value)),this.map.set(e.param,t);break;case"d":if(void 0===e.value){this.map.delete(e.param);break}{let r=this.map.get(e.param)||[];const i=r.indexOf(aB(e.value));-1!==i&&r.splice(i,1),r.length>0?this.map.set(e.param,r):this.map.delete(e.param)}}}),this.cloneFrom=this.updates=null)}}class eJ{constructor(){this.map=new Map}set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}keys(){return this.map.keys()}}function lB(n){return"undefined"!=typeof ArrayBuffer&&n instanceof ArrayBuffer}function uB(n){return"undefined"!=typeof Blob&&n instanceof Blob}function cB(n){return"undefined"!=typeof FormData&&n instanceof FormData}class u0{constructor(e,t,r,i){let o;if(this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase(),function(n){switch(n){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||i?(this.body=void 0!==r?r:null,o=i):o=r,o&&(this.reportProgress=!!o.reportProgress,this.withCredentials=!!o.withCredentials,o.responseType&&(this.responseType=o.responseType),o.headers&&(this.headers=o.headers),o.context&&(this.context=o.context),o.params&&(this.params=o.params)),this.headers||(this.headers=new Bl),this.context||(this.context=new eJ),this.params){const s=this.params.toString();if(0===s.length)this.urlWithParams=t;else{const u=t.indexOf("?");this.urlWithParams=t+(-1===u?"?":u<t.length-1?"&":"")+s}}else this.params=new Tp,this.urlWithParams=t}serializeBody(){return null===this.body?null:lB(this.body)||uB(this.body)||cB(this.body)||"undefined"!=typeof URLSearchParams&&this.body instanceof URLSearchParams||"string"==typeof this.body?this.body:this.body instanceof Tp?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||cB(this.body)?null:uB(this.body)?this.body.type||null:lB(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof Tp?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(e={}){var t;const r=e.method||this.method,i=e.url||this.url,o=e.responseType||this.responseType,s=void 0!==e.body?e.body:this.body,u=void 0!==e.withCredentials?e.withCredentials:this.withCredentials,f=void 0!==e.reportProgress?e.reportProgress:this.reportProgress;let g=e.headers||this.headers,v=e.params||this.params;const E=null!==(t=e.context)&&void 0!==t?t:this.context;return void 0!==e.setHeaders&&(g=Object.keys(e.setHeaders).reduce((T,R)=>T.set(R,e.setHeaders[R]),g)),e.setParams&&(v=Object.keys(e.setParams).reduce((T,R)=>T.set(R,e.setParams[R]),v)),new u0(r,i,s,{params:v,headers:g,context:E,reportProgress:f,responseType:o,withCredentials:u})}}var vl=(()=>((vl=vl||{})[vl.Sent=0]="Sent",vl[vl.UploadProgress=1]="UploadProgress",vl[vl.ResponseHeader=2]="ResponseHeader",vl[vl.DownloadProgress=3]="DownloadProgress",vl[vl.Response=4]="Response",vl[vl.User=5]="User",vl))();class pD{constructor(e,t=200,r="OK"){this.headers=e.headers||new Bl,this.status=void 0!==e.status?e.status:t,this.statusText=e.statusText||r,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}}class gD extends pD{constructor(e={}){super(e),this.type=vl.ResponseHeader}clone(e={}){return new gD({headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class Xb extends pD{constructor(e={}){super(e),this.type=vl.Response,this.body=void 0!==e.body?e.body:null}clone(e={}){return new Xb({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class hB extends pD{constructor(e){super(e,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${e.url||"(unknown url)"}`:`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}}function mD(n,e){return{body:e,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials}}let c0=(()=>{class n{constructor(t){this.handler=t}request(t,r,i={}){let o;if(t instanceof u0)o=t;else{let f,g;f=i.headers instanceof Bl?i.headers:new Bl(i.headers),i.params&&(g=i.params instanceof Tp?i.params:new Tp({fromObject:i.params})),o=new u0(t,r,void 0!==i.body?i.body:null,{headers:f,context:i.context,params:g,reportProgress:i.reportProgress,responseType:i.responseType||"json",withCredentials:i.withCredentials})}const s=Jr(o).pipe(k_(f=>this.handler.handle(f)));if(t instanceof u0||"events"===i.observe)return s;const u=s.pipe(Vc(f=>f instanceof Xb));switch(i.observe||"body"){case"body":switch(o.responseType){case"arraybuffer":return u.pipe(ar(f=>{if(null!==f.body&&!(f.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return f.body}));case"blob":return u.pipe(ar(f=>{if(null!==f.body&&!(f.body instanceof Blob))throw new Error("Response is not a Blob.");return f.body}));case"text":return u.pipe(ar(f=>{if(null!==f.body&&"string"!=typeof f.body)throw new Error("Response is not a string.");return f.body}));case"json":default:return u.pipe(ar(f=>f.body))}case"response":return u;default:throw new Error(`Unreachable: unhandled observe type ${i.observe}}`)}}delete(t,r={}){return this.request("DELETE",t,r)}get(t,r={}){return this.request("GET",t,r)}head(t,r={}){return this.request("HEAD",t,r)}jsonp(t,r){return this.request("JSONP",t,{params:(new Tp).append(r,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,r={}){return this.request("OPTIONS",t,r)}patch(t,r,i={}){return this.request("PATCH",t,mD(i,r))}post(t,r,i={}){return this.request("POST",t,mD(i,r))}put(t,r,i={}){return this.request("PUT",t,mD(i,r))}}return n.\u0275fac=function(t){return new(t||n)(yt(iB))},n.\u0275prov=Dn({token:n,factory:n.\u0275fac}),n})();class dB{constructor(e,t){this.next=e,this.interceptor=t}handle(e){return this.interceptor.intercept(e,this.next)}}const Yb=new gr("HTTP_INTERCEPTORS");let rJ=(()=>{class n{intercept(t,r){return r.handle(t)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Dn({token:n,factory:n.\u0275fac}),n})();const iJ=/^\)\]\}',?\n/;let fB=(()=>{class n{constructor(t){this.xhrFactory=t}handle(t){if("JSONP"===t.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new Ie(r=>{const i=this.xhrFactory.build();if(i.open(t.method,t.urlWithParams),t.withCredentials&&(i.withCredentials=!0),t.headers.forEach((R,B)=>i.setRequestHeader(R,B.join(","))),t.headers.has("Accept")||i.setRequestHeader("Accept","application/json, text/plain, */*"),!t.headers.has("Content-Type")){const R=t.detectContentTypeHeader();null!==R&&i.setRequestHeader("Content-Type",R)}if(t.responseType){const R=t.responseType.toLowerCase();i.responseType="json"!==R?R:"text"}const o=t.serializeBody();let s=null;const u=()=>{if(null!==s)return s;const R=1223===i.status?204:i.status,B=i.statusText||"OK",z=new Bl(i.getAllResponseHeaders()),G=function(n){return"responseURL"in n&&n.responseURL?n.responseURL:/^X-Request-URL:/m.test(n.getAllResponseHeaders())?n.getResponseHeader("X-Request-URL"):null}(i)||t.url;return s=new gD({headers:z,status:R,statusText:B,url:G}),s},f=()=>{let{headers:R,status:B,statusText:z,url:G}=u(),W=null;204!==B&&(W=void 0===i.response?i.responseText:i.response),0===B&&(B=W?200:0);let H=B>=200&&B<300;if("json"===t.responseType&&"string"==typeof W){const ee=W;W=W.replace(iJ,"");try{W=""!==W?JSON.parse(W):null}catch(_e){W=ee,H&&(H=!1,W={error:_e,text:W})}}H?(r.next(new Xb({body:W,headers:R,status:B,statusText:z,url:G||void 0})),r.complete()):r.error(new hB({error:W,headers:R,status:B,statusText:z,url:G||void 0}))},g=R=>{const{url:B}=u(),z=new hB({error:R,status:i.status||0,statusText:i.statusText||"Unknown Error",url:B||void 0});r.error(z)};let v=!1;const E=R=>{v||(r.next(u()),v=!0);let B={type:vl.DownloadProgress,loaded:R.loaded};R.lengthComputable&&(B.total=R.total),"text"===t.responseType&&!!i.responseText&&(B.partialText=i.responseText),r.next(B)},T=R=>{let B={type:vl.UploadProgress,loaded:R.loaded};R.lengthComputable&&(B.total=R.total),r.next(B)};return i.addEventListener("load",f),i.addEventListener("error",g),i.addEventListener("timeout",g),i.addEventListener("abort",g),t.reportProgress&&(i.addEventListener("progress",E),null!==o&&i.upload&&i.upload.addEventListener("progress",T)),i.send(o),r.next({type:vl.Sent}),()=>{i.removeEventListener("error",g),i.removeEventListener("abort",g),i.removeEventListener("load",f),i.removeEventListener("timeout",g),t.reportProgress&&(i.removeEventListener("progress",E),null!==o&&i.upload&&i.upload.removeEventListener("progress",T)),i.readyState!==i.DONE&&i.abort()}})}}return n.\u0275fac=function(t){return new(t||n)(yt(kk))},n.\u0275prov=Dn({token:n,factory:n.\u0275fac}),n})();const _D=new gr("XSRF_COOKIE_NAME"),yD=new gr("XSRF_HEADER_NAME");class pB{}let sJ=(()=>{class n{constructor(t,r,i){this.doc=t,this.platform=r,this.cookieName=i,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=Sk(t,this.cookieName),this.lastCookieString=t),this.lastToken}}return n.\u0275fac=function(t){return new(t||n)(yt(Fr),yt(y_),yt(_D))},n.\u0275prov=Dn({token:n,factory:n.\u0275fac}),n})(),vD=(()=>{class n{constructor(t,r){this.tokenService=t,this.headerName=r}intercept(t,r){const i=t.url.toLowerCase();if("GET"===t.method||"HEAD"===t.method||i.startsWith("http://")||i.startsWith("https://"))return r.handle(t);const o=this.tokenService.getToken();return null!==o&&!t.headers.has(this.headerName)&&(t=t.clone({headers:t.headers.set(this.headerName,o)})),r.handle(t)}}return n.\u0275fac=function(t){return new(t||n)(yt(pB),yt(yD))},n.\u0275prov=Dn({token:n,factory:n.\u0275fac}),n})(),aJ=(()=>{class n{constructor(t,r){this.backend=t,this.injector=r,this.chain=null}handle(t){if(null===this.chain){const r=this.injector.get(Yb,[]);this.chain=r.reduceRight((i,o)=>new dB(i,o),this.backend)}return this.chain.handle(t)}}return n.\u0275fac=function(t){return new(t||n)(yt(oB),yt(mi))},n.\u0275prov=Dn({token:n,factory:n.\u0275fac}),n})(),lJ=(()=>{class n{static disable(){return{ngModule:n,providers:[{provide:vD,useClass:rJ}]}}static withOptions(t={}){return{ngModule:n,providers:[t.cookieName?{provide:_D,useValue:t.cookieName}:[],t.headerName?{provide:yD,useValue:t.headerName}:[]]}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Gn({type:n}),n.\u0275inj=Gr({providers:[vD,{provide:Yb,useExisting:vD,multi:!0},{provide:pB,useClass:sJ},{provide:_D,useValue:"XSRF-TOKEN"},{provide:yD,useValue:"X-XSRF-TOKEN"}]}),n})(),gB=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Gn({type:n}),n.\u0275inj=Gr({providers:[c0,{provide:iB,useClass:aJ},fB,{provide:oB,useExisting:fB}],imports:[[lJ.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]]}),n})();const xD=new gr("JWT_OPTIONS");let bD=(()=>{class n{constructor(t=null){this.tokenGetter=t&&t.tokenGetter||function(){}}urlBase64Decode(t){let r=t.replace(/-/g,"+").replace(/_/g,"/");switch(r.length%4){case 0:break;case 2:r+="==";break;case 3:r+="=";break;default:throw new Error("Illegal base64url string!")}return this.b64DecodeUnicode(r)}b64decode(t){let i="";if((t=String(t).replace(/=+$/,"")).length%4==1)throw new Error("'atob' failed: The string to be decoded is not correctly encoded.");for(let s,u,o=0,f=0;u=t.charAt(f++);~u&&(s=o%4?64*s+u:u,o++%4)?i+=String.fromCharCode(255&s>>(-2*o&6)):0)u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(u);return i}b64DecodeUnicode(t){return decodeURIComponent(Array.prototype.map.call(this.b64decode(t),r=>"%"+("00"+r.charCodeAt(0).toString(16)).slice(-2)).join(""))}decodeToken(t=this.tokenGetter()){if(!t||""===t)return null;const r=t.split(".");if(3!==r.length)throw new Error("The inspected token doesn't appear to be a JWT. Check to make sure it has three parts and see https://jwt.io for more.");const i=this.urlBase64Decode(r[1]);if(!i)throw new Error("Cannot decode the token.");return JSON.parse(i)}getTokenExpirationDate(t=this.tokenGetter()){let r;if(r=this.decodeToken(t),!r||!r.hasOwnProperty("exp"))return null;const i=new Date(0);return i.setUTCSeconds(r.exp),i}isTokenExpired(t=this.tokenGetter(),r){if(!t||""===t)return!0;const i=this.getTokenExpirationDate(t);return r=r||0,null!==i&&!(i.valueOf()>(new Date).valueOf()+1e3*r)}getAuthScheme(t,r){return"function"==typeof t?t(r):t}}return n.\u0275fac=function(t){return new(t||n)(yt(xD))},n.\u0275prov=Dn({token:n,factory:n.\u0275fac}),n})(),uJ=(()=>{class n{constructor(t,r,i){this.jwtHelper=r,this.document=i,this.standardPorts=["80","443"],this.tokenGetter=t.tokenGetter,this.headerName=t.headerName||"Authorization",this.authScheme=t.authScheme||""===t.authScheme?t.authScheme:"Bearer ",this.allowedDomains=t.allowedDomains||[],this.disallowedRoutes=t.disallowedRoutes||[],this.throwNoTokenError=t.throwNoTokenError||!1,this.skipWhenExpired=t.skipWhenExpired}isAllowedDomain(t){const r=new URL(t.url,this.document.location.origin);if(r.host===this.document.location.host)return!0;const i=`${r.hostname}${r.port&&!this.standardPorts.includes(r.port)?":"+r.port:""}`;return this.allowedDomains.findIndex(o=>"string"==typeof o?o===i:o instanceof RegExp&&o.test(i))>-1}isDisallowedRoute(t){const r=new URL(t.url,this.document.location.origin);return this.disallowedRoutes.findIndex(i=>{if("string"==typeof i){const o=new URL(i,this.document.location.origin);return o.hostname===r.hostname&&o.pathname===r.pathname}return i instanceof RegExp&&i.test(t.url)})>-1}handleInterception(t,r,i){const o=this.jwtHelper.getAuthScheme(this.authScheme,r);let s=!1;if(!t&&this.throwNoTokenError)throw new Error("Could not get token from tokenGetter function.");return this.skipWhenExpired&&(s=!t||this.jwtHelper.isTokenExpired(t)),t&&s&&this.skipWhenExpired?r=r.clone():t&&(r=r.clone({setHeaders:{[this.headerName]:`${o}${t}`}})),i.handle(r)}intercept(t,r){if(!this.isAllowedDomain(t)||this.isDisallowedRoute(t))return r.handle(t);const i=this.tokenGetter(t);return i instanceof Promise?Ae(i).pipe(bn(o=>this.handleInterception(o,t,r))):this.handleInterception(i,t,r)}}return n.\u0275fac=function(t){return new(t||n)(yt(xD),yt(bD),yt(Fr))},n.\u0275prov=Dn({token:n,factory:n.\u0275fac}),n})(),cJ=(()=>{class n{constructor(t){if(t)throw new Error("JwtModule is already loaded. It should only be imported in your application's main module.")}static forRoot(t){return{ngModule:n,providers:[{provide:Yb,useClass:uJ,multi:!0},t.jwtOptionsProvider||{provide:xD,useValue:t.config},bD]}}}return n.\u0275fac=function(t){return new(t||n)(yt(n,12))},n.\u0275mod=Gn({type:n}),n.\u0275inj=Gr({}),n})();function dJ(n,e,t){return void 0===t&&(t=ve),function(r){mB(e,function(){for(var i=n.length,o=new Array(i),s=i,u=i,f=function(v){mB(e,function(){var E=Ae(n[v],e),T=!1;E.subscribe(new jn(r,function(R){o[v]=R,T||(T=!0,u--),u||r.next(t(o.slice()))},function(){--s||r.complete()}))},r)},g=0;g<i;g++)f(g)},r)}}function mB(n,e,t){n?t.add(n.schedule(e)):e()}var h0=xe(function(n){return function(){n(this),this.name="EmptyError",this.message="no elements in sequence"}});function _B(){return Qt(function(n,e){var t=null;n._refCount++;var r=new jn(e,void 0,void 0,void 0,function(){if(!n||n._refCount<=0||0<--n._refCount)t=null;else{var i=n._connection,o=t;t=null,i&&(!o||i===o)&&i.unsubscribe(),e.unsubscribe()}});n.subscribe(r),r.closed||(t=n.connect())})}var fJ=function(n){function e(t,r){var i=n.call(this)||this;return i.source=t,i.subjectFactory=r,i._subject=null,i._refCount=0,i._connection=null,Er(t)&&(i.lift=t.lift),i}return Be(e,n),e.prototype._subscribe=function(t){return this.getSubject().subscribe(t)},e.prototype.getSubject=function(){var t=this._subject;return(!t||t.isStopped)&&(this._subject=this.subjectFactory()),this._subject},e.prototype._teardown=function(){this._refCount=0;var t=this._connection;this._subject=this._connection=null,null==t||t.unsubscribe()},e.prototype.connect=function(){var t=this,r=this._connection;if(!r){r=this._connection=new Ce;var i=this.getSubject();r.add(this.source.subscribe(new jn(i,void 0,function(){t._teardown(),i.complete()},function(o){t._teardown(),i.error(o)},function(){return t._teardown()}))),r.closed&&(this._connection=null,r=Ce.EMPTY)}return r},e.prototype.refCount=function(){return _B()(this)},e}(Ie);function pJ(n,e,t,r,i){return function(o,s){var u=t,f=e,g=0;o.subscribe(new jn(s,function(v){var E=g++;f=u?n(f,v,E):(u=!0,v),r&&s.next(f)},i&&function(){u&&s.next(f),s.complete()}))}}function yB(n,e){return Qt(pJ(n,e,arguments.length>=2,!0))}function Tf(n){return Qt(function(e,t){var o,r=null,i=!1;r=e.subscribe(new jn(t,void 0,void 0,function(s){o=je(n(s,Tf(n)(e))),r?(r.unsubscribe(),r=null,o.subscribe(t)):i=!0})),i&&(r.unsubscribe(),r=null,o.subscribe(t))})}function wD(n){return n<=0?function(){return Wn}:Qt(function(e,t){var r=[];e.subscribe(new jn(t,function(i){r.push(i),n<r.length&&r.shift()},function(){var i,o;try{for(var s=vt(r),u=s.next();!u.done;u=s.next())t.next(u.value)}catch(g){i={error:g}}finally{try{u&&!u.done&&(o=s.return)&&o.call(s)}finally{if(i)throw i.error}}t.complete()},void 0,function(){r=null}))})}function vB(n){return void 0===n&&(n=gJ),Qt(function(e,t){var r=!1;e.subscribe(new jn(t,function(i){r=!0,t.next(i)},function(){return r?t.complete():t.error(n())}))})}function gJ(){return new h0}function xB(n){return Qt(function(e,t){var r=!1;e.subscribe(new jn(t,function(i){r=!0,t.next(i)},function(){r||t.next(n),t.complete()}))})}function L_(n,e){var t=arguments.length>=2;return function(r){return r.pipe(n?Vc(function(i,o){return n(i,o,r)}):ve,Xn(1),t?xB(e):vB(function(){return new h0}))}}function Gc(n,e,t){var r=Oe(n)||e||t?{next:n,error:e,complete:t}:n;return r?Qt(function(i,o){var s;null===(s=r.subscribe)||void 0===s||s.call(r);var u=!0;i.subscribe(new jn(o,function(f){var g;null===(g=r.next)||void 0===g||g.call(r,f),o.next(f)},function(){var f;u=!1,null===(f=r.complete)||void 0===f||f.call(r),o.complete()},function(f){var g;u=!1,null===(g=r.error)||void 0===g||g.call(r,f),o.error(f)},function(){var f,g;u&&(null===(f=r.unsubscribe)||void 0===f||f.call(r)),null===(g=r.finalize)||void 0===g||g.call(r)}))}):ve}class Df{constructor(e,t){this.id=e,this.url=t}}class ED extends Df{constructor(e,t,r="imperative",i=null){super(e,t),this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class d0 extends Df{constructor(e,t,r){super(e,t),this.urlAfterRedirects=r}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class bB extends Df{constructor(e,t,r){super(e,t),this.reason=r}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class yJ extends Df{constructor(e,t,r){super(e,t),this.error=r}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class vJ extends Df{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class xJ extends Df{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class bJ extends Df{constructor(e,t,r,i,o){super(e,t),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=o}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class wJ extends Df{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class EJ extends Df{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class wB{constructor(e){this.route=e}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class EB{constructor(e){this.route=e}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class CJ{constructor(e){this.snapshot=e}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class SJ{constructor(e){this.snapshot=e}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class MJ{constructor(e){this.snapshot=e}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class TJ{constructor(e){this.snapshot=e}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class CB{constructor(e,t,r){this.routerEvent=e,this.position=t,this.anchor=r}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}const Zi="primary";class DJ{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}}function N_(n){return new DJ(n)}const SB="ngNavigationCancelingError";function CD(n){const e=Error("NavigationCancelingError: "+n);return e[SB]=!0,e}function AJ(n,e,t){const r=t.path.split("/");if(r.length>n.length||"full"===t.pathMatch&&(e.hasChildren()||r.length<n.length))return null;const i={};for(let o=0;o<r.length;o++){const s=r[o],u=n[o];if(s.startsWith(":"))i[s.substring(1)]=u;else if(s!==u.path)return null}return{consumed:n.slice(0,r.length),posParams:i}}function zd(n,e){const t=n?Object.keys(n):void 0,r=e?Object.keys(e):void 0;if(!t||!r||t.length!=r.length)return!1;let i;for(let o=0;o<t.length;o++)if(i=t[o],!MB(n[i],e[i]))return!1;return!0}function MB(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;const t=[...n].sort(),r=[...e].sort();return t.every((i,o)=>r[o]===i)}return n===e}function TB(n){return Array.prototype.concat.apply([],n)}function DB(n){return n.length>0?n[n.length-1]:null}function vu(n,e){for(const t in n)n.hasOwnProperty(t)&&e(n[t],t)}function Vd(n){return sx(n)?n:fv(n)?Ae(Promise.resolve(n)):Jr(n)}const OJ={exact:function PB(n,e,t){if(!kg(n.segments,e.segments)||!Zb(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(const r in e.children)if(!n.children[r]||!PB(n.children[r],e.children[r],t))return!1;return!0},subset:RB},IB={exact:function(n,e){return zd(n,e)},subset:function(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>MB(n[t],e[t]))},ignored:()=>!0};function AB(n,e,t){return OJ[t.paths](n.root,e.root,t.matrixParams)&&IB[t.queryParams](n.queryParams,e.queryParams)&&!("exact"===t.fragment&&n.fragment!==e.fragment)}function RB(n,e,t){return OB(n,e,e.segments,t)}function OB(n,e,t,r){if(n.segments.length>t.length){const i=n.segments.slice(0,t.length);return!(!kg(i,t)||e.hasChildren()||!Zb(i,t,r))}if(n.segments.length===t.length){if(!kg(n.segments,t)||!Zb(n.segments,t,r))return!1;for(const i in e.children)if(!n.children[i]||!RB(n.children[i],e.children[i],r))return!1;return!0}{const i=t.slice(0,n.segments.length),o=t.slice(n.segments.length);return!!(kg(n.segments,i)&&Zb(n.segments,i,r)&&n.children[Zi])&&OB(n.children[Zi],e,o,r)}}function Zb(n,e,t){return e.every((r,i)=>IB[t](n[i].parameters,r.parameters))}class Og{constructor(e,t,r){this.root=e,this.queryParams=t,this.fragment=r}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=N_(this.queryParams)),this._queryParamMap}toString(){return BJ.serialize(this)}}class co{constructor(e,t){this.segments=e,this.children=t,this.parent=null,vu(t,(r,i)=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Kb(this)}}class f0{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap||(this._parameterMap=N_(this.parameters)),this._parameterMap}toString(){return FB(this)}}function kg(n,e){return n.length===e.length&&n.every((t,r)=>t.path===e[r].path)}class SD{}class kB{parse(e){const t=new WJ(e);return new Og(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){var n;return`${`/${p0(e.root,!0)}`}${function(n){const e=Object.keys(n).map(t=>{const r=n[t];return Array.isArray(r)?r.map(i=>`${Jb(t)}=${Jb(i)}`).join("&"):`${Jb(t)}=${Jb(r)}`}).filter(t=>!!t);return e.length?`?${e.join("&")}`:""}(e.queryParams)}${"string"==typeof e.fragment?`#${n=e.fragment,encodeURI(n)}`:""}`}}const BJ=new kB;function Kb(n){return n.segments.map(e=>FB(e)).join("/")}function p0(n,e){if(!n.hasChildren())return Kb(n);if(e){const t=n.children[Zi]?p0(n.children[Zi],!1):"",r=[];return vu(n.children,(i,o)=>{o!==Zi&&r.push(`${o}:${p0(i,!1)}`)}),r.length>0?`${t}(${r.join("//")})`:t}{const t=function(n,e){let t=[];return vu(n.children,(r,i)=>{i===Zi&&(t=t.concat(e(r,i)))}),vu(n.children,(r,i)=>{i!==Zi&&(t=t.concat(e(r,i)))}),t}(n,(r,i)=>i===Zi?[p0(n.children[Zi],!1)]:[`${i}:${p0(r,!1)}`]);return 1===Object.keys(n.children).length&&null!=n.children[Zi]?`${Kb(n)}/${t[0]}`:`${Kb(n)}/(${t.join("//")})`}}function LB(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Jb(n){return LB(n).replace(/%3B/gi,";")}function MD(n){return LB(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Qb(n){return decodeURIComponent(n)}function NB(n){return Qb(n.replace(/\+/g,"%20"))}function FB(n){return`${MD(n.path)}${function(n){return Object.keys(n).map(e=>`;${MD(e)}=${MD(n[e])}`).join("")}(n.parameters)}`}const jJ=/^[^\/()?;=#]+/;function ew(n){const e=n.match(jJ);return e?e[0]:""}const GJ=/^[^=?&#]+/,HJ=/^[^?&#]+/;class WJ{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new co([],{}):new co([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(r[Zi]=new co(e,t)),r}parseSegment(){const e=ew(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new Error(`Empty path url segment cannot have parameters: '${this.remaining}'.`);return this.capture(e),new f0(Qb(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const t=ew(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){const i=ew(this.remaining);i&&(r=i,this.capture(r))}e[Qb(t)]=Qb(r)}parseQueryParam(e){const t=function(n){const e=n.match(GJ);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){const s=function(n){const e=n.match(HJ);return e?e[0]:""}(this.remaining);s&&(r=s,this.capture(r))}const i=NB(t),o=NB(r);if(e.hasOwnProperty(i)){let s=e[i];Array.isArray(s)||(s=[s],e[i]=s),s.push(o)}else e[i]=o}parseParens(e){const t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const r=ew(this.remaining),i=this.remaining[r.length];if("/"!==i&&")"!==i&&";"!==i)throw new Error(`Cannot parse url '${this.url}'`);let o;r.indexOf(":")>-1?(o=r.substr(0,r.indexOf(":")),this.capture(o),this.capture(":")):e&&(o=Zi);const s=this.parseChildren();t[o]=1===Object.keys(s).length?s[Zi]:new co([],s),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new Error(`Expected "${e}".`)}}class BB{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){const t=TD(e,this._root);return t?t.children.map(r=>r.value):[]}firstChild(e){const t=TD(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){const t=DD(e,this._root);return t.length<2?[]:t[t.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return DD(e,this._root).map(t=>t.value)}}function TD(n,e){if(n===e.value)return e;for(const t of e.children){const r=TD(n,t);if(r)return r}return null}function DD(n,e){if(n===e.value)return[e];for(const t of e.children){const r=DD(n,t);if(r.length)return r.unshift(e),r}return[]}class If{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}}function g0(n){const e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}class zB extends BB{constructor(e,t){super(e),this.snapshot=t,ID(this,e)}toString(){return this.snapshot.toString()}}function VB(n,e){const t=function(n,e){const s=new tw([],{},{},"",{},Zi,e,null,n.root,-1,{});return new jB("",new If(s,[]))}(n,e),r=new Eh([new f0("",{})]),i=new Eh({}),o=new Eh({}),s=new Eh({}),u=new Eh(""),f=new Lg(r,i,s,u,o,Zi,e,t.root);return f.snapshot=t.root,new zB(new If(f,[]),t)}class Lg{constructor(e,t,r,i,o,s,u,f){this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=o,this.outlet=s,this.component=u,this._futureSnapshot=f}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(ar(e=>N_(e)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(ar(e=>N_(e)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function UB(n,e="emptyOnly"){const t=n.pathFromRoot;let r=0;if("always"!==e)for(r=t.length-1;r>=1;){const i=t[r],o=t[r-1];if(i.routeConfig&&""===i.routeConfig.path)r--;else{if(o.component)break;r--}}return function(n){return n.reduce((e,t)=>({params:Object.assign(Object.assign({},e.params),t.params),data:Object.assign(Object.assign({},e.data),t.data),resolve:Object.assign(Object.assign({},e.resolve),t._resolvedData)}),{params:{},data:{},resolve:{}})}(t.slice(r))}class tw{constructor(e,t,r,i,o,s,u,f,g,v,E){this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=o,this.outlet=s,this.component=u,this.routeConfig=f,this._urlSegment=g,this._lastPathIndex=v,this._resolve=E}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=N_(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=N_(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(r=>r.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class jB extends BB{constructor(e,t){super(t),this.url=e,ID(this,t)}toString(){return GB(this._root)}}function ID(n,e){e.value._routerState=n,e.children.forEach(t=>ID(n,t))}function GB(n){const e=n.children.length>0?` { ${n.children.map(GB).join(", ")} } `:"";return`${n.value}${e}`}function AD(n){if(n.snapshot){const e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,zd(e.queryParams,t.queryParams)||n.queryParams.next(t.queryParams),e.fragment!==t.fragment&&n.fragment.next(t.fragment),zd(e.params,t.params)||n.params.next(t.params),function(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!zd(n[t],e[t]))return!1;return!0}(e.url,t.url)||n.url.next(t.url),zd(e.data,t.data)||n.data.next(t.data)}else n.snapshot=n._futureSnapshot,n.data.next(n._futureSnapshot.data)}function PD(n,e){return zd(n.params,e.params)&&function(n,e){return kg(n,e)&&n.every((t,r)=>zd(t.parameters,e[r].parameters))}(n.url,e.url)&&!(!n.parent!=!e.parent)&&(!n.parent||PD(n.parent,e.parent))}function nw(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){const r=t.value;r._futureSnapshot=e.value;const i=function(n,e,t){return e.children.map(r=>{for(const i of t.children)if(n.shouldReuseRoute(r.value,i.value.snapshot))return nw(n,r,i);return nw(n,r)})}(n,e,t);return new If(r,i)}{if(n.shouldAttach(e.value)){const o=n.retrieve(e.value);if(null!==o){const s=o.route;return $B(e,s),s}}const r=function(n){return new Lg(new Eh(n.url),new Eh(n.params),new Eh(n.queryParams),new Eh(n.fragment),new Eh(n.data),n.outlet,n.component,n)}(e.value),i=e.children.map(o=>nw(n,o));return new If(r,i)}}function $B(n,e){if(n.value.routeConfig!==e.value.routeConfig)throw new Error("Cannot reattach ActivatedRouteSnapshot created from a different route");if(n.children.length!==e.children.length)throw new Error("Cannot reattach ActivatedRouteSnapshot with a different number of children");e.value._futureSnapshot=n.value;for(let t=0;t<n.children.length;++t)$B(n.children[t],e.children[t])}function rw(n){return"object"==typeof n&&null!=n&&!n.outlets&&!n.segmentPath}function m0(n){return"object"==typeof n&&null!=n&&n.outlets}function RD(n,e,t,r,i){let o={};return r&&vu(r,(s,u)=>{o[u]=Array.isArray(s)?s.map(f=>`${f}`):`${s}`}),new Og(t.root===n?e:HB(t.root,n,e),o,i)}function HB(n,e,t){const r={};return vu(n.children,(i,o)=>{r[o]=i===e?t:HB(i,e,t)}),new co(n.segments,r)}class qB{constructor(e,t,r){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=r,e&&r.length>0&&rw(r[0]))throw new Error("Root segment cannot have matrix parameters");const i=r.find(m0);if(i&&i!==DB(r))throw new Error("{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class OD{constructor(e,t,r){this.segmentGroup=e,this.processChildren=t,this.index=r}}function WB(n,e,t){if(n||(n=new co([],{})),0===n.segments.length&&n.hasChildren())return iw(n,e,t);const r=function(n,e,t){let r=0,i=e;const o={match:!1,pathIndex:0,commandIndex:0};for(;i<n.segments.length;){if(r>=t.length)return o;const s=n.segments[i],u=t[r];if(m0(u))break;const f=`${u}`,g=r<t.length-1?t[r+1]:null;if(i>0&&void 0===f)break;if(f&&g&&"object"==typeof g&&void 0===g.outlets){if(!YB(f,g,s))return o;r+=2}else{if(!YB(f,{},s))return o;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}(n,e,t),i=t.slice(r.commandIndex);if(r.match&&r.pathIndex<n.segments.length){const o=new co(n.segments.slice(0,r.pathIndex),{});return o.children[Zi]=new co(n.segments.slice(r.pathIndex),n.children),iw(o,0,i)}return r.match&&0===i.length?new co(n.segments,{}):r.match&&!n.hasChildren()?kD(n,e,t):r.match?iw(n,0,i):kD(n,e,t)}function iw(n,e,t){if(0===t.length)return new co(n.segments,{});{const r=function(n){return m0(n[0])?n[0].outlets:{[Zi]:n}}(t),i={};return vu(r,(o,s)=>{"string"==typeof o&&(o=[o]),null!==o&&(i[s]=WB(n.children[s],e,o))}),vu(n.children,(o,s)=>{void 0===r[s]&&(i[s]=o)}),new co(n.segments,i)}}function kD(n,e,t){const r=n.segments.slice(0,e);let i=0;for(;i<t.length;){const o=t[i];if(m0(o)){const f=oQ(o.outlets);return new co(r,f)}if(0===i&&rw(t[0])){r.push(new f0(n.segments[e].path,XB(t[0]))),i++;continue}const s=m0(o)?o.outlets[Zi]:`${o}`,u=i<t.length-1?t[i+1]:null;s&&u&&rw(u)?(r.push(new f0(s,XB(u))),i+=2):(r.push(new f0(s,{})),i++)}return new co(r,{})}function oQ(n){const e={};return vu(n,(t,r)=>{"string"==typeof t&&(t=[t]),null!==t&&(e[r]=kD(new co([],{}),0,t))}),e}function XB(n){const e={};return vu(n,(t,r)=>e[r]=`${t}`),e}function YB(n,e,t){return n==t.path&&zd(e,t.parameters)}class aQ{constructor(e,t,r,i){this.routeReuseStrategy=e,this.futureState=t,this.currState=r,this.forwardEvent=i}activate(e){const t=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,r,e),AD(this.futureState.root),this.activateChildRoutes(t,r,e)}deactivateChildRoutes(e,t,r){const i=g0(t);e.children.forEach(o=>{const s=o.value.outlet;this.deactivateRoutes(o,i[s],r),delete i[s]}),vu(i,(o,s)=>{this.deactivateRouteAndItsChildren(o,r)})}deactivateRoutes(e,t,r){const i=e.value,o=t?t.value:null;if(i===o)if(i.component){const s=r.getContext(i.outlet);s&&this.deactivateChildRoutes(e,t,s.children)}else this.deactivateChildRoutes(e,t,r);else o&&this.deactivateRouteAndItsChildren(t,r)}deactivateRouteAndItsChildren(e,t){this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){const r=t.getContext(e.value.outlet);if(r&&r.outlet){const i=r.outlet.detach(),o=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:i,route:e,contexts:o})}}deactivateRouteAndOutlet(e,t){const r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,o=g0(e);for(const s of Object.keys(o))this.deactivateRouteAndItsChildren(o[s],i);r&&r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated(),r.attachRef=null,r.resolver=null,r.route=null)}activateChildRoutes(e,t,r){const i=g0(t);e.children.forEach(o=>{this.activateRoutes(o,i[o.value.outlet],r),this.forwardEvent(new TJ(o.value.snapshot))}),e.children.length&&this.forwardEvent(new SJ(e.value.snapshot))}activateRoutes(e,t,r){const i=e.value,o=t?t.value:null;if(AD(i),i===o)if(i.component){const s=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,t,s.children)}else this.activateChildRoutes(e,t,r);else if(i.component){const s=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){const u=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),s.children.onOutletReAttached(u.contexts),s.attachRef=u.componentRef,s.route=u.route.value,s.outlet&&s.outlet.attach(u.componentRef,u.route.value),ZB(u.route)}else{const u=function(n){for(let e=n.parent;e;e=e.parent){const t=e.routeConfig;if(t&&t._loadedConfig)return t._loadedConfig;if(t&&t.component)return null}return null}(i.snapshot),f=u?u.module.componentFactoryResolver:null;s.attachRef=null,s.route=i,s.resolver=f,s.outlet&&s.outlet.activateWith(i,f),this.activateChildRoutes(e,null,s.children)}}else this.activateChildRoutes(e,null,r)}}function ZB(n){AD(n.value),n.children.forEach(ZB)}class LD{constructor(e,t){this.routes=e,this.module=t}}function Dp(n){return"function"==typeof n}function Ng(n){return n instanceof Og}const _0=Symbol("INITIAL_VALUE");function y0(){return _p(n=>function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var t=ba(n),r=vr(n),i=sF(n),o=i.args,s=i.keys;if(0===o.length)return Ae([],t);var u=new Ie(dJ(o,t,s?function(f){return aF(s,f)}:ve));return r?u.pipe(HM(r)):u}(n.map(e=>e.pipe(Xn(1),sb(_0)))).pipe(yB((e,t)=>{let r=!1;return t.reduce((i,o,s)=>i!==_0?i:(o===_0&&(r=!0),r||!1!==o&&s!==t.length-1&&!Ng(o)?i:o),e)},_0),Vc(e=>e!==_0),ar(e=>Ng(e)?e:!0===e),Xn(1)))}let KB=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=ao({type:n,selectors:[["ng-component"]],decls:1,vars:0,template:function(t,r){1&t&&Ar(0,"router-outlet")},directives:function(){return[dw]},encapsulation:2}),n})();function JB(n,e=""){for(let t=0;t<n.length;t++){const r=n[t];pQ(r,gQ(e,r))}}function pQ(n,e){n.children&&JB(n.children,e)}function gQ(n,e){return e?n||e.path?n&&!e.path?`${n}/`:!n&&e.path?e.path:`${n}/${e.path}`:"":n}function ND(n){const e=n.children&&n.children.map(ND),t=e?Object.assign(Object.assign({},n),{children:e}):Object.assign({},n);return!t.component&&(e||t.loadChildren)&&t.outlet&&t.outlet!==Zi&&(t.component=KB),t}function Th(n){return n.outlet||Zi}function QB(n,e){const t=n.filter(r=>Th(r)===e);return t.push(...n.filter(r=>Th(r)!==e)),t}const ez={matched:!1,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};function ow(n,e,t){var r;if(""===e.path)return"full"===e.pathMatch&&(n.hasChildren()||t.length>0)?Object.assign({},ez):{matched:!0,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};const o=(e.matcher||AJ)(t,n,e);if(!o)return Object.assign({},ez);const s={};vu(o.posParams,(f,g)=>{s[g]=f.path});const u=o.consumed.length>0?Object.assign(Object.assign({},s),o.consumed[o.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:o.consumed,lastChild:o.consumed.length,parameters:u,positionalParamSegments:null!==(r=o.posParams)&&void 0!==r?r:{}}}function sw(n,e,t,r,i="corrected"){if(t.length>0&&function(n,e,t){return t.some(r=>aw(n,e,r)&&Th(r)!==Zi)}(n,t,r)){const s=new co(e,function(n,e,t,r){const i={};i[Zi]=r,r._sourceSegment=n,r._segmentIndexShift=e.length;for(const o of t)if(""===o.path&&Th(o)!==Zi){const s=new co([],{});s._sourceSegment=n,s._segmentIndexShift=e.length,i[Th(o)]=s}return i}(n,e,r,new co(t,n.children)));return s._sourceSegment=n,s._segmentIndexShift=e.length,{segmentGroup:s,slicedSegments:[]}}if(0===t.length&&function(n,e,t){return t.some(r=>aw(n,e,r))}(n,t,r)){const s=new co(n.segments,function(n,e,t,r,i,o){const s={};for(const u of r)if(aw(n,t,u)&&!i[Th(u)]){const f=new co([],{});f._sourceSegment=n,f._segmentIndexShift="legacy"===o?n.segments.length:e.length,s[Th(u)]=f}return Object.assign(Object.assign({},i),s)}(n,e,t,r,n.children,i));return s._sourceSegment=n,s._segmentIndexShift=e.length,{segmentGroup:s,slicedSegments:t}}const o=new co(n.segments,n.children);return o._sourceSegment=n,o._segmentIndexShift=e.length,{segmentGroup:o,slicedSegments:t}}function aw(n,e,t){return(!(n.hasChildren()||e.length>0)||"full"!==t.pathMatch)&&""===t.path}function tz(n,e,t,r){return!!(Th(n)===r||r!==Zi&&aw(e,t,n))&&("**"===n.path||ow(e,n,t).matched)}function nz(n,e,t){return 0===e.length&&!n.children[t]}class v0{constructor(e){this.segmentGroup=e||null}}class rz{constructor(e){this.urlTree=e}}function lw(n){return new Ie(e=>e.error(new v0(n)))}function iz(n){return new Ie(e=>e.error(new rz(n)))}function xQ(n){return new Ie(e=>e.error(new Error(`Only absolute redirects can have named outlets. redirectTo: '${n}'`)))}class EQ{constructor(e,t,r,i,o){this.configLoader=t,this.urlSerializer=r,this.urlTree=i,this.config=o,this.allowRedirects=!0,this.ngModule=e.get(Ld)}apply(){const e=sw(this.urlTree.root,[],[],this.config).segmentGroup,t=new co(e.segments,e.children);return this.expandSegmentGroup(this.ngModule,this.config,t,Zi).pipe(ar(o=>this.createUrlTree(FD(o),this.urlTree.queryParams,this.urlTree.fragment))).pipe(Tf(o=>{if(o instanceof rz)return this.allowRedirects=!1,this.match(o.urlTree);throw o instanceof v0?this.noMatchError(o):o}))}match(e){return this.expandSegmentGroup(this.ngModule,this.config,e.root,Zi).pipe(ar(i=>this.createUrlTree(FD(i),e.queryParams,e.fragment))).pipe(Tf(i=>{throw i instanceof v0?this.noMatchError(i):i}))}noMatchError(e){return new Error(`Cannot match any routes. URL Segment: '${e.segmentGroup}'`)}createUrlTree(e,t,r){const i=e.segments.length>0?new co([],{[Zi]:e}):e;return new Og(i,t,r)}expandSegmentGroup(e,t,r,i){return 0===r.segments.length&&r.hasChildren()?this.expandChildren(e,t,r).pipe(ar(o=>new co([],o))):this.expandSegment(e,r,t,r.segments,i,!0)}expandChildren(e,t,r){const i=[];for(const o of Object.keys(r.children))"primary"===o?i.unshift(o):i.push(o);return Ae(i).pipe(k_(o=>{const s=r.children[o],u=QB(t,o);return this.expandSegmentGroup(e,u,s,o).pipe(ar(f=>({segment:f,outlet:o})))}),yB((o,s)=>(o[s.outlet]=s.segment,o),{}),function(n,e){var t=arguments.length>=2;return function(r){return r.pipe(n?Vc(function(i,o){return n(i,o,r)}):ve,wD(1),t?xB(e):vB(function(){return new h0}))}}())}expandSegment(e,t,r,i,o,s){return Ae(r).pipe(k_(u=>this.expandSegmentAgainstRoute(e,t,r,u,i,o,s).pipe(Tf(g=>{if(g instanceof v0)return Jr(null);throw g}))),L_(u=>!!u),Tf((u,f)=>{if(u instanceof h0||"EmptyError"===u.name){if(nz(t,i,o))return Jr(new co([],{}));throw new v0(t)}throw u}))}expandSegmentAgainstRoute(e,t,r,i,o,s,u){return tz(i,t,o,s)?void 0===i.redirectTo?this.matchSegmentAgainstRoute(e,t,i,o,s):u&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,t,r,i,o,s):lw(t):lw(t)}expandSegmentAgainstRouteUsingRedirect(e,t,r,i,o,s){return"**"===i.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,r,i,s):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,r,i,o,s)}expandWildCardWithParamsAgainstRouteUsingRedirect(e,t,r,i){const o=this.applyRedirectCommands([],r.redirectTo,{});return r.redirectTo.startsWith("/")?iz(o):this.lineralizeSegments(r,o).pipe(bn(s=>{const u=new co(s,{});return this.expandSegment(e,u,t,s,i,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(e,t,r,i,o,s){const{matched:u,consumedSegments:f,lastChild:g,positionalParamSegments:v}=ow(t,i,o);if(!u)return lw(t);const E=this.applyRedirectCommands(f,i.redirectTo,v);return i.redirectTo.startsWith("/")?iz(E):this.lineralizeSegments(i,E).pipe(bn(T=>this.expandSegment(e,t,r,T.concat(o.slice(g)),s,!1)))}matchSegmentAgainstRoute(e,t,r,i,o){if("**"===r.path)return r.loadChildren?(r._loadedConfig?Jr(r._loadedConfig):this.configLoader.load(e.injector,r)).pipe(ar(T=>(r._loadedConfig=T,new co(i,{})))):Jr(new co(i,{}));const{matched:s,consumedSegments:u,lastChild:f}=ow(t,r,i);if(!s)return lw(t);const g=i.slice(f);return this.getChildConfig(e,r,i).pipe(bn(E=>{const T=E.module,R=E.routes,{segmentGroup:B,slicedSegments:z}=sw(t,u,g,R),G=new co(B.segments,B.children);if(0===z.length&&G.hasChildren())return this.expandChildren(T,R,G).pipe(ar(_e=>new co(u,_e)));if(0===R.length&&0===z.length)return Jr(new co(u,{}));const W=Th(r)===o;return this.expandSegment(T,G,R,z,W?Zi:o,!0).pipe(ar(ee=>new co(u.concat(ee.segments),ee.children)))}))}getChildConfig(e,t,r){return t.children?Jr(new LD(t.children,e)):t.loadChildren?void 0!==t._loadedConfig?Jr(t._loadedConfig):this.runCanLoadGuards(e.injector,t,r).pipe(bn(i=>{return i?this.configLoader.load(e.injector,t).pipe(ar(o=>(t._loadedConfig=o,o))):(n=t,new Ie(e=>e.error(CD(`Cannot load children because the guard of the route "path: '${n.path}'" returned false`))));var n})):Jr(new LD([],e))}runCanLoadGuards(e,t,r){const i=t.canLoad;return i&&0!==i.length?Jr(i.map(s=>{const u=e.get(s);let f;if((n=u)&&Dp(n.canLoad))f=u.canLoad(t,r);else{if(!Dp(u))throw new Error("Invalid CanLoad guard");f=u(t,r)}var n;return Vd(f)})).pipe(y0(),Gc(s=>{if(!Ng(s))return;const u=CD(`Redirecting to "${this.urlSerializer.serialize(s)}"`);throw u.url=s,u}),ar(s=>!0===s)):Jr(!0)}lineralizeSegments(e,t){let r=[],i=t.root;for(;;){if(r=r.concat(i.segments),0===i.numberOfChildren)return Jr(r);if(i.numberOfChildren>1||!i.children[Zi])return xQ(e.redirectTo);i=i.children[Zi]}}applyRedirectCommands(e,t,r){return this.applyRedirectCreatreUrlTree(t,this.urlSerializer.parse(t),e,r)}applyRedirectCreatreUrlTree(e,t,r,i){const o=this.createSegmentGroup(e,t.root,r,i);return new Og(o,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){const r={};return vu(e,(i,o)=>{if("string"==typeof i&&i.startsWith(":")){const u=i.substring(1);r[o]=t[u]}else r[o]=i}),r}createSegmentGroup(e,t,r,i){const o=this.createSegments(e,t.segments,r,i);let s={};return vu(t.children,(u,f)=>{s[f]=this.createSegmentGroup(e,u,r,i)}),new co(o,s)}createSegments(e,t,r,i){return t.map(o=>o.path.startsWith(":")?this.findPosParam(e,o,i):this.findOrReturn(o,r))}findPosParam(e,t,r){const i=r[t.path.substring(1)];if(!i)throw new Error(`Cannot redirect to '${e}'. Cannot find '${t.path}'.`);return i}findOrReturn(e,t){let r=0;for(const i of t){if(i.path===e.path)return t.splice(r),i;r++}return e}}function FD(n){const e={};for(const r of Object.keys(n.children)){const o=FD(n.children[r]);(o.segments.length>0||o.hasChildren())&&(e[r]=o)}return function(n){if(1===n.numberOfChildren&&n.children[Zi]){const e=n.children[Zi];return new co(n.segments.concat(e.segments),e.children)}return n}(new co(n.segments,e))}class oz{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class uw{constructor(e,t){this.component=e,this.route=t}}function MQ(n,e,t){const r=n._root;return x0(r,e?e._root:null,t,[r.value])}function cw(n,e,t){const r=function(n){if(!n)return null;for(let e=n.parent;e;e=e.parent){const t=e.routeConfig;if(t&&t._loadedConfig)return t._loadedConfig}return null}(e);return(r?r.module.injector:t).get(n)}function x0(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){const o=g0(e);return n.children.forEach(s=>{(function(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){const o=n.value,s=e?e.value:null,u=t?t.getContext(n.value.outlet):null;if(s&&o.routeConfig===s.routeConfig){const f=function(n,e,t){if("function"==typeof t)return t(n,e);switch(t){case"pathParamsChange":return!kg(n.url,e.url);case"pathParamsOrQueryParamsChange":return!kg(n.url,e.url)||!zd(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!PD(n,e)||!zd(n.queryParams,e.queryParams);case"paramsChange":default:return!PD(n,e)}}(s,o,o.routeConfig.runGuardsAndResolvers);f?i.canActivateChecks.push(new oz(r)):(o.data=s.data,o._resolvedData=s._resolvedData),x0(n,e,o.component?u?u.children:null:t,r,i),f&&u&&u.outlet&&u.outlet.isActivated&&i.canDeactivateChecks.push(new uw(u.outlet.component,s))}else s&&b0(e,u,i),i.canActivateChecks.push(new oz(r)),x0(n,null,o.component?u?u.children:null:t,r,i)})(s,o[s.value.outlet],t,r.concat([s.value]),i),delete o[s.value.outlet]}),vu(o,(s,u)=>b0(s,t.getContext(u),i)),i}function b0(n,e,t){const r=g0(n),i=n.value;vu(r,(o,s)=>{b0(o,i.component?e?e.children.getContext(s):null:e,t)}),t.canDeactivateChecks.push(new uw(i.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,i))}class zQ{}function sz(n){return new Ie(e=>e.error(n))}class UQ{constructor(e,t,r,i,o,s){this.rootComponentType=e,this.config=t,this.urlTree=r,this.url=i,this.paramsInheritanceStrategy=o,this.relativeLinkResolution=s}recognize(){const e=sw(this.urlTree.root,[],[],this.config.filter(s=>void 0===s.redirectTo),this.relativeLinkResolution).segmentGroup,t=this.processSegmentGroup(this.config,e,Zi);if(null===t)return null;const r=new tw([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},Zi,this.rootComponentType,null,this.urlTree.root,-1,{}),i=new If(r,t),o=new jB(this.url,i);return this.inheritParamsAndData(o._root),o}inheritParamsAndData(e){const t=e.value,r=UB(t,this.paramsInheritanceStrategy);t.params=Object.freeze(r.params),t.data=Object.freeze(r.data),e.children.forEach(i=>this.inheritParamsAndData(i))}processSegmentGroup(e,t,r){return 0===t.segments.length&&t.hasChildren()?this.processChildren(e,t):this.processSegment(e,t,t.segments,r)}processChildren(e,t){const r=[];for(const o of Object.keys(t.children)){const s=t.children[o],u=QB(e,o),f=this.processSegmentGroup(u,s,o);if(null===f)return null;r.push(...f)}const i=az(r);return i.sort((e,t)=>e.value.outlet===Zi?-1:t.value.outlet===Zi?1:e.value.outlet.localeCompare(t.value.outlet)),i}processSegment(e,t,r,i){for(const o of e){const s=this.processSegmentAgainstRoute(o,t,r,i);if(null!==s)return s}return nz(t,r,i)?[]:null}processSegmentAgainstRoute(e,t,r,i){if(e.redirectTo||!tz(e,t,r,i))return null;let o,s=[],u=[];if("**"===e.path){const R=r.length>0?DB(r).parameters:{};o=new tw(r,R,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,cz(e),Th(e),e.component,e,lz(t),uz(t)+r.length,hz(e))}else{const R=ow(t,e,r);if(!R.matched)return null;s=R.consumedSegments,u=r.slice(R.lastChild),o=new tw(s,R.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,cz(e),Th(e),e.component,e,lz(t),uz(t)+s.length,hz(e))}const f=(n=e).children?n.children:n.loadChildren?n._loadedConfig.routes:[],{segmentGroup:g,slicedSegments:v}=sw(t,s,u,f.filter(R=>void 0===R.redirectTo),this.relativeLinkResolution);var n;if(0===v.length&&g.hasChildren()){const R=this.processChildren(f,g);return null===R?null:[new If(o,R)]}if(0===f.length&&0===v.length)return[new If(o,[])];const E=Th(e)===i,T=this.processSegment(f,g,v,E?Zi:i);return null===T?null:[new If(o,T)]}}function $Q(n){const e=n.value.routeConfig;return e&&""===e.path&&void 0===e.redirectTo}function az(n){const e=[],t=new Set;for(const r of n){if(!$Q(r)){e.push(r);continue}const i=e.find(o=>r.value.routeConfig===o.value.routeConfig);void 0!==i?(i.children.push(...r.children),t.add(i)):e.push(r)}for(const r of t){const i=az(r.children);e.push(new If(r.value,i))}return e.filter(r=>!t.has(r))}function lz(n){let e=n;for(;e._sourceSegment;)e=e._sourceSegment;return e}function uz(n){let e=n,t=e._segmentIndexShift?e._segmentIndexShift:0;for(;e._sourceSegment;)e=e._sourceSegment,t+=e._segmentIndexShift?e._segmentIndexShift:0;return t-1}function cz(n){return n.data||{}}function hz(n){return n.resolve||{}}function BD(n){return _p(e=>{const t=n(e);return t?Ae(t).pipe(ar(()=>e)):Jr(e)})}class JQ extends class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}}{}const zD=new gr("ROUTES");class dz{constructor(e,t,r,i){this.loader=e,this.compiler=t,this.onLoadStartListener=r,this.onLoadEndListener=i}load(e,t){if(t._loader$)return t._loader$;this.onLoadStartListener&&this.onLoadStartListener(t);const i=this.loadModuleFactory(t.loadChildren).pipe(ar(o=>{this.onLoadEndListener&&this.onLoadEndListener(t);const s=o.create(e);return new LD(TB(s.injector.get(zD,void 0,or.Self|or.Optional)).map(ND),s)}),Tf(o=>{throw t._loader$=void 0,o}));return t._loader$=new fJ(i,()=>new wt).pipe(_B()),t._loader$}loadModuleFactory(e){return"string"==typeof e?Ae(this.loader.load(e)):Vd(e()).pipe(bn(t=>t instanceof CR?Jr(t):Ae(this.compiler.compileModuleAsync(t))))}}class QQ{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.children=new F_,this.attachRef=null}}class F_{constructor(){this.contexts=new Map}onChildOutletCreated(e,t){const r=this.getOrCreateContext(e);r.outlet=t,this.contexts.set(e,r)}onChildOutletDestroyed(e){const t=this.getContext(e);t&&(t.outlet=null)}onOutletDeactivated(){const e=this.contexts;return this.contexts=new Map,e}onOutletReAttached(e){this.contexts=e}getOrCreateContext(e){let t=this.getContext(e);return t||(t=new QQ,this.contexts.set(e,t)),t}getContext(e){return this.contexts.get(e)||null}}class tee{shouldProcessUrl(e){return!0}extract(e){return e}merge(e,t){return e}}function nee(n){throw n}function ree(n,e,t){return e.parse("/")}function fz(n,e){return Jr(null)}const iee={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},oee={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let xu=(()=>{class n{constructor(t,r,i,o,s,u,f,g){this.rootComponentType=t,this.urlSerializer=r,this.rootContexts=i,this.location=o,this.config=g,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.lastLocationChangeInfo=null,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new wt,this.errorHandler=nee,this.malformedUriErrorHandler=ree,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:fz,afterPreactivation:fz},this.urlHandlingStrategy=new tee,this.routeReuseStrategy=new JQ,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.ngModule=s.get(Ld),this.console=s.get(Tx);const T=s.get(si);this.isNgZoneEnabled=T instanceof si&&si.isInAngularZone(),this.resetConfig(g),this.currentUrlTree=new Og(new co([],{}),{},null),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new dz(u,f,R=>this.triggerEvent(new wB(R)),R=>this.triggerEvent(new EB(R))),this.routerState=VB(this.currentUrlTree,this.rootComponentType),this.transitions=new Eh({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}get browserPageId(){var t;return null===(t=this.location.getState())||void 0===t?void 0:t.\u0275routerPageId}setupNavigations(t){const r=this.events;return t.pipe(Vc(i=>0!==i.id),ar(i=>Object.assign(Object.assign({},i),{extractedUrl:this.urlHandlingStrategy.extract(i.rawUrl)})),_p(i=>{let o=!1,s=!1;return Jr(i).pipe(Gc(u=>{this.currentNavigation={id:u.id,initialUrl:u.currentRawUrl,extractedUrl:u.extractedUrl,trigger:u.source,extras:u.extras,previousNavigation:this.lastSuccessfulNavigation?Object.assign(Object.assign({},this.lastSuccessfulNavigation),{previousNavigation:null}):null}}),_p(u=>{const f=!this.navigated||u.extractedUrl.toString()!==this.browserUrlTree.toString();if(("reload"===this.onSameUrlNavigation||f)&&this.urlHandlingStrategy.shouldProcessUrl(u.rawUrl))return Jr(u).pipe(_p(v=>{const E=this.transitions.getValue();return r.next(new ED(v.id,this.serializeUrl(v.extractedUrl),v.source,v.restoredState)),E!==this.transitions.getValue()?Wn:Promise.resolve(v)}),function(n,e,t,r){return _p(i=>function(n,e,t,r,i){return new EQ(n,e,t,r,i).apply()}(n,e,t,i.extractedUrl,r).pipe(ar(o=>Object.assign(Object.assign({},i),{urlAfterRedirects:o}))))}(this.ngModule.injector,this.configLoader,this.urlSerializer,this.config),Gc(v=>{this.currentNavigation=Object.assign(Object.assign({},this.currentNavigation),{finalUrl:v.urlAfterRedirects})}),function(n,e,t,r,i){return bn(o=>function(n,e,t,r,i="emptyOnly",o="legacy"){try{const s=new UQ(n,e,t,r,i,o).recognize();return null===s?sz(new zQ):Jr(s)}catch(s){return sz(s)}}(n,e,o.urlAfterRedirects,t(o.urlAfterRedirects),r,i).pipe(ar(s=>Object.assign(Object.assign({},o),{targetSnapshot:s}))))}(this.rootComponentType,this.config,v=>this.serializeUrl(v),this.paramsInheritanceStrategy,this.relativeLinkResolution),Gc(v=>{"eager"===this.urlUpdateStrategy&&(v.extras.skipLocationChange||this.setBrowserUrl(v.urlAfterRedirects,v),this.browserUrlTree=v.urlAfterRedirects);const E=new vJ(v.id,this.serializeUrl(v.extractedUrl),this.serializeUrl(v.urlAfterRedirects),v.targetSnapshot);r.next(E)}));if(f&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:E,extractedUrl:T,source:R,restoredState:B,extras:z}=u,G=new ED(E,this.serializeUrl(T),R,B);r.next(G);const W=VB(T,this.rootComponentType).snapshot;return Jr(Object.assign(Object.assign({},u),{targetSnapshot:W,urlAfterRedirects:T,extras:Object.assign(Object.assign({},z),{skipLocationChange:!1,replaceUrl:!1})}))}return this.rawUrlTree=u.rawUrl,this.browserUrlTree=u.urlAfterRedirects,u.resolve(null),Wn}),BD(u=>{const{targetSnapshot:f,id:g,extractedUrl:v,rawUrl:E,extras:{skipLocationChange:T,replaceUrl:R}}=u;return this.hooks.beforePreactivation(f,{navigationId:g,appliedUrlTree:v,rawUrlTree:E,skipLocationChange:!!T,replaceUrl:!!R})}),Gc(u=>{const f=new xJ(u.id,this.serializeUrl(u.extractedUrl),this.serializeUrl(u.urlAfterRedirects),u.targetSnapshot);this.triggerEvent(f)}),ar(u=>Object.assign(Object.assign({},u),{guards:MQ(u.targetSnapshot,u.currentSnapshot,this.rootContexts)})),function(n,e){return bn(t=>{const{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:o,canDeactivateChecks:s}}=t;return 0===s.length&&0===o.length?Jr(Object.assign(Object.assign({},t),{guardsResult:!0})):function(n,e,t,r){return Ae(n).pipe(bn(i=>function(n,e,t,r,i){const o=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return o&&0!==o.length?Jr(o.map(u=>{const f=cw(u,e,i);let g;if(function(n){return n&&Dp(n.canDeactivate)}(f))g=Vd(f.canDeactivate(n,e,t,r));else{if(!Dp(f))throw new Error("Invalid CanDeactivate guard");g=Vd(f(n,e,t,r))}return g.pipe(L_())})).pipe(y0()):Jr(!0)}(i.component,i.route,t,e,r)),L_(i=>!0!==i,!0))}(s,r,i,n).pipe(bn(u=>u&&function(n){return"boolean"==typeof n}(u)?function(n,e,t,r){return Ae(e).pipe(k_(i=>KM(function(n,e){return null!==n&&e&&e(new CJ(n)),Jr(!0)}(i.route.parent,r),function(n,e){return null!==n&&e&&e(new MJ(n)),Jr(!0)}(i.route,r),function(n,e,t){const r=e[e.length-1],o=e.slice(0,e.length-1).reverse().map(s=>function(n){const e=n.routeConfig?n.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:n,guards:e}:null}(s)).filter(s=>null!==s).map(s=>VT(()=>Jr(s.guards.map(f=>{const g=cw(f,s.node,t);let v;if(function(n){return n&&Dp(n.canActivateChild)}(g))v=Vd(g.canActivateChild(r,n));else{if(!Dp(g))throw new Error("Invalid CanActivateChild guard");v=Vd(g(r,n))}return v.pipe(L_())})).pipe(y0())));return Jr(o).pipe(y0())}(n,i.path,t),function(n,e,t){const r=e.routeConfig?e.routeConfig.canActivate:null;return r&&0!==r.length?Jr(r.map(o=>VT(()=>{const s=cw(o,e,t);let u;if(function(n){return n&&Dp(n.canActivate)}(s))u=Vd(s.canActivate(e,n));else{if(!Dp(s))throw new Error("Invalid CanActivate guard");u=Vd(s(e,n))}return u.pipe(L_())}))).pipe(y0()):Jr(!0)}(n,i.route,t))),L_(i=>!0!==i,!0))}(r,o,n,e):Jr(u)),ar(u=>Object.assign(Object.assign({},t),{guardsResult:u})))})}(this.ngModule.injector,u=>this.triggerEvent(u)),Gc(u=>{if(Ng(u.guardsResult)){const g=CD(`Redirecting to "${this.serializeUrl(u.guardsResult)}"`);throw g.url=u.guardsResult,g}const f=new bJ(u.id,this.serializeUrl(u.extractedUrl),this.serializeUrl(u.urlAfterRedirects),u.targetSnapshot,!!u.guardsResult);this.triggerEvent(f)}),Vc(u=>!!u.guardsResult||(this.restoreHistory(u),this.cancelNavigationTransition(u,""),!1)),BD(u=>{if(u.guards.canActivateChecks.length)return Jr(u).pipe(Gc(f=>{const g=new wJ(f.id,this.serializeUrl(f.extractedUrl),this.serializeUrl(f.urlAfterRedirects),f.targetSnapshot);this.triggerEvent(g)}),_p(f=>{let g=!1;return Jr(f).pipe(function(n,e){return bn(t=>{const{targetSnapshot:r,guards:{canActivateChecks:i}}=t;if(!i.length)return Jr(t);let o=0;return Ae(i).pipe(k_(s=>function(n,e,t,r){return function(n,e,t,r){const i=Object.keys(n);if(0===i.length)return Jr({});const o={};return Ae(i).pipe(bn(s=>function(n,e,t,r){const i=cw(n,e,r);return Vd(i.resolve?i.resolve(e,t):i(e,t))}(n[s],e,t,r).pipe(Gc(u=>{o[s]=u}))),wD(1),bn(()=>Object.keys(o).length===i.length?Jr(o):Wn))}(n._resolve,n,e,r).pipe(ar(o=>(n._resolvedData=o,n.data=Object.assign(Object.assign({},n.data),UB(n,t).resolve),null)))}(s.route,r,n,e)),Gc(()=>o++),wD(1),bn(s=>o===i.length?Jr(t):Wn))})}(this.paramsInheritanceStrategy,this.ngModule.injector),Gc({next:()=>g=!0,complete:()=>{g||(this.restoreHistory(f),this.cancelNavigationTransition(f,"At least one route resolver didn't emit any value."))}}))}),Gc(f=>{const g=new EJ(f.id,this.serializeUrl(f.extractedUrl),this.serializeUrl(f.urlAfterRedirects),f.targetSnapshot);this.triggerEvent(g)}))}),BD(u=>{const{targetSnapshot:f,id:g,extractedUrl:v,rawUrl:E,extras:{skipLocationChange:T,replaceUrl:R}}=u;return this.hooks.afterPreactivation(f,{navigationId:g,appliedUrlTree:v,rawUrlTree:E,skipLocationChange:!!T,replaceUrl:!!R})}),ar(u=>{const f=function(n,e,t){const r=nw(n,e._root,t?t._root:void 0);return new zB(r,e)}(this.routeReuseStrategy,u.targetSnapshot,u.currentRouterState);return Object.assign(Object.assign({},u),{targetRouterState:f})}),Gc(u=>{this.currentUrlTree=u.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,u.rawUrl),this.routerState=u.targetRouterState,"deferred"===this.urlUpdateStrategy&&(u.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,u),this.browserUrlTree=u.urlAfterRedirects)}),((n,e,t)=>ar(r=>(new aQ(e,r.targetRouterState,r.currentRouterState,t).activate(n),r)))(this.rootContexts,this.routeReuseStrategy,u=>this.triggerEvent(u)),Gc({next(){o=!0},complete(){o=!0}}),function(n){return Qt(function(e,t){try{e.subscribe(t)}finally{t.add(n)}})}(()=>{if(!o&&!s){const u=`Navigation ID ${i.id} is not equal to the current navigation id ${this.navigationId}`;"replace"===this.canceledNavigationResolution?(this.restoreHistory(i),this.cancelNavigationTransition(i,u)):this.cancelNavigationTransition(i,u)}this.currentNavigation=null}),Tf(u=>{if(s=!0,function(n){return n&&n[SB]}(u)){const f=Ng(u.url);f||(this.navigated=!0,this.restoreHistory(i,!0));const g=new bB(i.id,this.serializeUrl(i.extractedUrl),u.message);r.next(g),f?setTimeout(()=>{const v=this.urlHandlingStrategy.merge(u.url,this.rawUrlTree);this.scheduleNavigation(v,"imperative",null,{skipLocationChange:i.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy},{resolve:i.resolve,reject:i.reject,promise:i.promise})},0):i.resolve(!1)}else{this.restoreHistory(i,!0);const f=new yJ(i.id,this.serializeUrl(i.extractedUrl),u);r.next(f);try{i.resolve(this.errorHandler(u))}catch(g){i.reject(g)}}return Wn}))}))}resetRootComponentType(t){this.rootComponentType=t,this.routerState.root.component=this.rootComponentType}getTransition(){const t=this.transitions.value;return t.urlAfterRedirects=this.browserUrlTree,t}setTransition(t){this.transitions.next(Object.assign(Object.assign({},this.getTransition()),t))}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(t=>{const r=this.extractLocationChangeInfoFromEvent(t);this.shouldScheduleNavigation(this.lastLocationChangeInfo,r)&&setTimeout(()=>{const{source:i,state:o,urlTree:s}=r,u={replaceUrl:!0};if(o){const f=Object.assign({},o);delete f.navigationId,delete f.\u0275routerPageId,0!==Object.keys(f).length&&(u.state=f)}this.scheduleNavigation(s,i,o,u)},0),this.lastLocationChangeInfo=r}))}extractLocationChangeInfoFromEvent(t){var r;return{source:"popstate"===t.type?"popstate":"hashchange",urlTree:this.parseUrl(t.url),state:(null===(r=t.state)||void 0===r?void 0:r.navigationId)?t.state:null,transitionId:this.getTransition().id}}shouldScheduleNavigation(t,r){if(!t)return!0;const i=r.urlTree.toString()===t.urlTree.toString();return r.transitionId!==t.transitionId||!i||!("hashchange"===r.source&&"popstate"===t.source||"popstate"===r.source&&"hashchange"===t.source)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(t){this.events.next(t)}resetConfig(t){JB(t),this.config=t.map(ND),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(t,r={}){const{relativeTo:i,queryParams:o,fragment:s,queryParamsHandling:u,preserveFragment:f}=r,g=i||this.routerState.root,v=f?this.currentUrlTree.fragment:s;let E=null;switch(u){case"merge":E=Object.assign(Object.assign({},this.currentUrlTree.queryParams),o);break;case"preserve":E=this.currentUrlTree.queryParams;break;default:E=o||null}return null!==E&&(E=this.removeEmptyProps(E)),function(n,e,t,r,i){if(0===t.length)return RD(e.root,e.root,e,r,i);const o=function(n){if("string"==typeof n[0]&&1===n.length&&"/"===n[0])return new qB(!0,0,n);let e=0,t=!1;const r=n.reduce((i,o,s)=>{if("object"==typeof o&&null!=o){if(o.outlets){const u={};return vu(o.outlets,(f,g)=>{u[g]="string"==typeof f?f.split("/"):f}),[...i,{outlets:u}]}if(o.segmentPath)return[...i,o.segmentPath]}return"string"!=typeof o?[...i,o]:0===s?(o.split("/").forEach((u,f)=>{0==f&&"."===u||(0==f&&""===u?t=!0:".."===u?e++:""!=u&&i.push(u))}),i):[...i,o]},[]);return new qB(t,e,r)}(t);if(o.toRoot())return RD(e.root,new co([],{}),e,r,i);const s=function(n,e,t){if(n.isAbsolute)return new OD(e.root,!0,0);if(-1===t.snapshot._lastPathIndex){const o=t.snapshot._urlSegment;return new OD(o,o===e.root,0)}const r=rw(n.commands[0])?0:1;return function(n,e,t){let r=n,i=e,o=t;for(;o>i;){if(o-=i,r=r.parent,!r)throw new Error("Invalid number of '../'");i=r.segments.length}return new OD(r,!1,i-o)}(t.snapshot._urlSegment,t.snapshot._lastPathIndex+r,n.numberOfDoubleDots)}(o,e,n),u=s.processChildren?iw(s.segmentGroup,s.index,o.commands):WB(s.segmentGroup,s.index,o.commands);return RD(s.segmentGroup,u,e,r,i)}(g,this.currentUrlTree,t,E,null!=v?v:null)}navigateByUrl(t,r={skipLocationChange:!1}){const i=Ng(t)?t:this.parseUrl(t),o=this.urlHandlingStrategy.merge(i,this.rawUrlTree);return this.scheduleNavigation(o,"imperative",null,r)}navigate(t,r={skipLocationChange:!1}){return function(n){for(let e=0;e<n.length;e++){const t=n[e];if(null==t)throw new Error(`The requested path contains ${t} segment at index ${e}`)}}(t),this.navigateByUrl(this.createUrlTree(t,r),r)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){let r;try{r=this.urlSerializer.parse(t)}catch(i){r=this.malformedUriErrorHandler(i,this.urlSerializer,t)}return r}isActive(t,r){let i;if(i=!0===r?Object.assign({},iee):!1===r?Object.assign({},oee):r,Ng(t))return AB(this.currentUrlTree,t,i);const o=this.parseUrl(t);return AB(this.currentUrlTree,o,i)}removeEmptyProps(t){return Object.keys(t).reduce((r,i)=>{const o=t[i];return null!=o&&(r[i]=o),r},{})}processNavigations(){this.navigations.subscribe(t=>{this.navigated=!0,this.lastSuccessfulId=t.id,this.currentPageId=t.targetPageId,this.events.next(new d0(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,t.resolve(!0)},t=>{this.console.warn("Unhandled Navigation Error: ")})}scheduleNavigation(t,r,i,o,s){var u,f;if(this.disposed)return Promise.resolve(!1);const g=this.getTransition(),v="imperative"!==r&&"imperative"===(null==g?void 0:g.source),R=(this.lastSuccessfulId===g.id||this.currentNavigation?g.rawUrl:g.urlAfterRedirects).toString()===t.toString();if(v&&R)return Promise.resolve(!0);let B,z,G;s?(B=s.resolve,z=s.reject,G=s.promise):G=new Promise((ee,_e)=>{B=ee,z=_e});const W=++this.navigationId;let H;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(i=this.location.getState()),H=i&&i.\u0275routerPageId?i.\u0275routerPageId:o.replaceUrl||o.skipLocationChange?null!==(u=this.browserPageId)&&void 0!==u?u:0:(null!==(f=this.browserPageId)&&void 0!==f?f:0)+1):H=0,this.setTransition({id:W,targetPageId:H,source:r,restoredState:i,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:t,extras:o,resolve:B,reject:z,promise:G,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),G.catch(ee=>Promise.reject(ee))}setBrowserUrl(t,r){const i=this.urlSerializer.serialize(t),o=Object.assign(Object.assign({},r.extras.state),this.generateNgRouterState(r.id,r.targetPageId));this.location.isCurrentPathEqualTo(i)||r.extras.replaceUrl?this.location.replaceState(i,"",o):this.location.go(i,"",o)}restoreHistory(t,r=!1){var i,o;if("computed"===this.canceledNavigationResolution){const s=this.currentPageId-t.targetPageId;"popstate"!==t.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==(null===(i=this.currentNavigation)||void 0===i?void 0:i.finalUrl)||0===s?this.currentUrlTree===(null===(o=this.currentNavigation)||void 0===o?void 0:o.finalUrl)&&0===s&&(this.resetState(t),this.browserUrlTree=t.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(s)}else"replace"===this.canceledNavigationResolution&&(r&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=t.currentRouterState,this.currentUrlTree=t.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}cancelNavigationTransition(t,r){const i=new bB(t.id,this.serializeUrl(t.extractedUrl),r);this.triggerEvent(i),t.resolve(!1)}generateNgRouterState(t,r){return"computed"===this.canceledNavigationResolution?{navigationId:t,\u0275routerPageId:r}:{navigationId:t}}}return n.\u0275fac=function(t){return new(t||n)(yt(nf),yt(SD),yt(F_),yt(w_),yt(mi),yt(Ix),yt(yg),yt(void 0))},n.\u0275prov=Dn({token:n,factory:n.\u0275fac}),n})(),VD=(()=>{class n{constructor(t,r,i,o,s){this.router=t,this.route=r,this.commands=[],this.onChanges=new wt,null==i&&o.setAttribute(s.nativeElement,"tabindex","0")}ngOnChanges(t){this.onChanges.next(this)}set routerLink(t){this.commands=null!=t?Array.isArray(t)?t:[t]:[]}onClick(){const t={skipLocationChange:B_(this.skipLocationChange),replaceUrl:B_(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,t),!0}get urlTree(){return this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:B_(this.preserveFragment)})}}return n.\u0275fac=function(t){return new(t||n)(Mt(xu),Mt(Lg),jp("tabindex"),Mt(bf),Mt(Po))},n.\u0275dir=Fn({type:n,selectors:[["","routerLink","",5,"a",5,"area"]],hostBindings:function(t,r){1&t&&Xs("click",function(){return r.onClick()})},inputs:{routerLink:"routerLink",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo"},features:[Lo]}),n})(),hw=(()=>{class n{constructor(t,r,i){this.router=t,this.route=r,this.locationStrategy=i,this.commands=[],this.onChanges=new wt,this.subscription=t.events.subscribe(o=>{o instanceof d0&&this.updateTargetUrlAndHref()})}set routerLink(t){this.commands=null!=t?Array.isArray(t)?t:[t]:[]}ngOnChanges(t){this.updateTargetUrlAndHref(),this.onChanges.next(this)}ngOnDestroy(){this.subscription.unsubscribe()}onClick(t,r,i,o,s){if(0!==t||r||i||o||s||"string"==typeof this.target&&"_self"!=this.target)return!0;const u={skipLocationChange:B_(this.skipLocationChange),replaceUrl:B_(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,u),!1}updateTargetUrlAndHref(){this.href=this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.urlTree))}get urlTree(){return this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:B_(this.preserveFragment)})}}return n.\u0275fac=function(t){return new(t||n)(Mt(xu),Mt(Lg),Mt(b_))},n.\u0275dir=Fn({type:n,selectors:[["a","routerLink",""],["area","routerLink",""]],hostVars:2,hostBindings:function(t,r){1&t&&Xs("click",function(o){return r.onClick(o.button,o.ctrlKey,o.shiftKey,o.altKey,o.metaKey)}),2&t&&(n_("href",r.href,Jp),nc("target",r.target))},inputs:{routerLink:"routerLink",target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo"},features:[Lo]}),n})();function B_(n){return""===n||!!n}let pz=(()=>{class n{constructor(t,r,i,o,s,u){this.router=t,this.element=r,this.renderer=i,this.cdr=o,this.link=s,this.linkWithHref=u,this.classes=[],this.isActive=!1,this.routerLinkActiveOptions={exact:!1},this.routerEventsSubscription=t.events.subscribe(f=>{f instanceof d0&&this.update()})}ngAfterContentInit(){Jr(this.links.changes,this.linksWithHrefs.changes,Jr(null)).pipe(tt()).subscribe(t=>{this.update(),this.subscribeToEachLinkOnChanges()})}subscribeToEachLinkOnChanges(){var t;null===(t=this.linkInputChangesSubscription)||void 0===t||t.unsubscribe();const r=[...this.links.toArray(),...this.linksWithHrefs.toArray(),this.link,this.linkWithHref].filter(i=>!!i).map(i=>i.onChanges);this.linkInputChangesSubscription=Ae(r).pipe(tt()).subscribe(i=>{this.isActive!==this.isLinkActive(this.router)(i)&&this.update()})}set routerLinkActive(t){const r=Array.isArray(t)?t:t.split(" ");this.classes=r.filter(i=>!!i)}ngOnChanges(t){this.update()}ngOnDestroy(){var t;this.routerEventsSubscription.unsubscribe(),null===(t=this.linkInputChangesSubscription)||void 0===t||t.unsubscribe()}update(){!this.links||!this.linksWithHrefs||!this.router.navigated||Promise.resolve().then(()=>{const t=this.hasActiveLinks();this.isActive!==t&&(this.isActive=t,this.cdr.markForCheck(),this.classes.forEach(r=>{t?this.renderer.addClass(this.element.nativeElement,r):this.renderer.removeClass(this.element.nativeElement,r)}))})}isLinkActive(t){const r=function(n){return!!n.paths}(this.routerLinkActiveOptions)?this.routerLinkActiveOptions:this.routerLinkActiveOptions.exact||!1;return i=>t.isActive(i.urlTree,r)}hasActiveLinks(){const t=this.isLinkActive(this.router);return this.link&&t(this.link)||this.linkWithHref&&t(this.linkWithHref)||this.links.some(t)||this.linksWithHrefs.some(t)}}return n.\u0275fac=function(t){return new(t||n)(Mt(xu),Mt(Po),Mt(bf),Mt(gg),Mt(VD,8),Mt(hw,8))},n.\u0275dir=Fn({type:n,selectors:[["","routerLinkActive",""]],contentQueries:function(t,r,i){if(1&t&&(jS(i,VD,5),jS(i,hw,5)),2&t){let o;p_(o=g_())&&(r.links=o),p_(o=g_())&&(r.linksWithHrefs=o)}},inputs:{routerLinkActiveOptions:"routerLinkActiveOptions",routerLinkActive:"routerLinkActive"},exportAs:["routerLinkActive"],features:[Lo]}),n})(),dw=(()=>{class n{constructor(t,r,i,o,s){this.parentContexts=t,this.location=r,this.resolver=i,this.changeDetector=s,this.activated=null,this._activatedRoute=null,this.activateEvents=new Ro,this.deactivateEvents=new Ro,this.name=o||Zi,t.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const t=this.parentContexts.getContext(this.name);t&&t.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.resolver||null))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,t}attach(t,r){this.activated=t,this._activatedRoute=r,this.location.insert(t.hostView)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,r){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=t;const s=(r=r||this.resolver).resolveComponentFactory(t._futureSnapshot.routeConfig.component),u=this.parentContexts.getOrCreateContext(this.name).children,f=new lee(t,u,this.location.injector);this.activated=this.location.createComponent(s,this.location.length,f),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return n.\u0275fac=function(t){return new(t||n)(Mt(F_),Mt(ic),Mt(kd),jp("name"),Mt(gg))},n.\u0275dir=Fn({type:n,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate"},exportAs:["outlet"]}),n})();class lee{constructor(e,t,r){this.route=e,this.childContexts=t,this.parent=r}get(e,t){return e===Lg?this.route:e===F_?this.childContexts:this.parent.get(e,t)}}class gz{}class mz{preload(e,t){return Jr(null)}}let _z=(()=>{class n{constructor(t,r,i,o,s){this.router=t,this.injector=o,this.preloadingStrategy=s,this.loader=new dz(r,i,g=>t.triggerEvent(new wB(g)),g=>t.triggerEvent(new EB(g)))}setUpPreloading(){this.subscription=this.router.events.pipe(Vc(t=>t instanceof d0),k_(()=>this.preload())).subscribe(()=>{})}preload(){const t=this.injector.get(Ld);return this.processRoutes(t,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,r){const i=[];for(const o of r)if(o.loadChildren&&!o.canLoad&&o._loadedConfig){const s=o._loadedConfig;i.push(this.processRoutes(s.module,s.routes))}else o.loadChildren&&!o.canLoad?i.push(this.preloadConfig(t,o)):o.children&&i.push(this.processRoutes(t,o.children));return Ae(i).pipe(tt(),ar(o=>{}))}preloadConfig(t,r){return this.preloadingStrategy.preload(r,()=>(r._loadedConfig?Jr(r._loadedConfig):this.loader.load(t.injector,r)).pipe(bn(o=>(r._loadedConfig=o,this.processRoutes(o.module,o.routes)))))}}return n.\u0275fac=function(t){return new(t||n)(yt(xu),yt(Ix),yt(yg),yt(mi),yt(gz))},n.\u0275prov=Dn({token:n,factory:n.\u0275fac}),n})(),UD=(()=>{class n{constructor(t,r,i={}){this.router=t,this.viewportScroller=r,this.options=i,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},i.scrollPositionRestoration=i.scrollPositionRestoration||"disabled",i.anchorScrolling=i.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(t=>{t instanceof ED?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof d0&&(this.lastId=t.id,this.scheduleScrollEvent(t,this.router.parseUrl(t.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(t=>{t instanceof CB&&(t.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,r){this.router.triggerEvent(new CB(t,"popstate"===this.lastSource?this.store[this.restoredId]:null,r))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return n.\u0275fac=function(t){return new(t||n)(yt(xu),yt(Rk),yt(void 0))},n.\u0275prov=Dn({token:n,factory:n.\u0275fac}),n})();const Fg=new gr("ROUTER_CONFIGURATION"),yz=new gr("ROUTER_FORROOT_GUARD"),cee=[w_,{provide:SD,useClass:kB},{provide:xu,useFactory:function(n,e,t,r,i,o,s,u={},f,g){const v=new xu(null,n,e,t,r,i,o,TB(s));return f&&(v.urlHandlingStrategy=f),g&&(v.routeReuseStrategy=g),function(n,e){n.errorHandler&&(e.errorHandler=n.errorHandler),n.malformedUriErrorHandler&&(e.malformedUriErrorHandler=n.malformedUriErrorHandler),n.onSameUrlNavigation&&(e.onSameUrlNavigation=n.onSameUrlNavigation),n.paramsInheritanceStrategy&&(e.paramsInheritanceStrategy=n.paramsInheritanceStrategy),n.relativeLinkResolution&&(e.relativeLinkResolution=n.relativeLinkResolution),n.urlUpdateStrategy&&(e.urlUpdateStrategy=n.urlUpdateStrategy)}(u,v),u.enableTracing&&v.events.subscribe(E=>{var T,R;null===(T=console.group)||void 0===T||T.call(console,`Router Event: ${E.constructor.name}`),console.log(E.toString()),console.log(E),null===(R=console.groupEnd)||void 0===R||R.call(console)}),v},deps:[SD,F_,w_,mi,Ix,yg,zD,Fg,[class{},new Au],[class{},new Au]]},F_,{provide:Lg,useFactory:function(n){return n.routerState.root},deps:[xu]},{provide:Ix,useClass:MH},_z,mz,class{preload(e,t){return t().pipe(Tf(()=>Jr(null)))}},{provide:Fg,useValue:{enableTracing:!1}}];function hee(){return new nM("Router",xu)}let jD=(()=>{class n{constructor(t,r){}static forRoot(t,r){return{ngModule:n,providers:[cee,vz(t),{provide:yz,useFactory:pee,deps:[[xu,new Au,new bd]]},{provide:Fg,useValue:r||{}},{provide:b_,useFactory:fee,deps:[wg,[new xd(vM),new Au],Fg]},{provide:UD,useFactory:dee,deps:[xu,Rk,Fg]},{provide:gz,useExisting:r&&r.preloadingStrategy?r.preloadingStrategy:mz},{provide:nM,multi:!0,useFactory:hee},[GD,{provide:Ov,multi:!0,useFactory:yee,deps:[GD]},{provide:xz,useFactory:vee,deps:[GD]},{provide:MO,multi:!0,useExisting:xz}]]}}static forChild(t){return{ngModule:n,providers:[vz(t)]}}}return n.\u0275fac=function(t){return new(t||n)(yt(yz,8),yt(xu,8))},n.\u0275mod=Gn({type:n}),n.\u0275inj=Gr({}),n})();function dee(n,e,t){return t.scrollOffset&&e.setOffset(t.scrollOffset),new UD(n,e,t)}function fee(n,e,t={}){return t.useHash?new qq(n,e):new gk(n,e)}function pee(n){return"guarded"}function vz(n){return[{provide:NE,multi:!0,useValue:n},{provide:zD,multi:!0,useValue:n}]}let GD=(()=>{class n{constructor(t){this.injector=t,this.initNavigation=!1,this.destroyed=!1,this.resultOfPreactivationDone=new wt}appInitializer(){return this.injector.get(Gq,Promise.resolve(null)).then(()=>{if(this.destroyed)return Promise.resolve(!0);let r=null;const i=new Promise(u=>r=u),o=this.injector.get(xu),s=this.injector.get(Fg);return"disabled"===s.initialNavigation?(o.setUpLocationChangeListener(),r(!0)):"enabled"===s.initialNavigation||"enabledBlocking"===s.initialNavigation?(o.hooks.afterPreactivation=()=>this.initNavigation?Jr(null):(this.initNavigation=!0,r(!0),this.resultOfPreactivationDone),o.initialNavigation()):r(!0),i})}bootstrapListener(t){const r=this.injector.get(Fg),i=this.injector.get(_z),o=this.injector.get(UD),s=this.injector.get(xu),u=this.injector.get(vg);t===u.components[0]&&(("enabledNonBlocking"===r.initialNavigation||void 0===r.initialNavigation)&&s.initialNavigation(),i.setUpPreloading(),o.init(),s.resetRootComponentType(u.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}ngOnDestroy(){this.destroyed=!0}}return n.\u0275fac=function(t){return new(t||n)(yt(mi))},n.\u0275prov=Dn({token:n,factory:n.\u0275fac}),n})();function yee(n){return n.appInitializer.bind(n)}function vee(n){return n.bootstrapListener.bind(n)}const xz=new gr("Router Initializer"),zl_mapbox_accessToken="pk.eyJ1Ijoic3RvdXQiLCJhIjoiY2txbXFlMzVqMGJudjJ2cWI5dzFpNm1vYyJ9.BO0opLE8ec6_bcDReMYVcQ",zl_api_url="http://localhost:8081/api",zl_ws_url="ws://localhost:8080",zl_jwt_allowedDomains="localhost:8081",zl_jwt_disallowedRoutes="";let bz=(()=>{class n{constructor(t,r){this.http=t,this.jwtHelper=r,this.jwt=localStorage.getItem("Jwt"),this.jwtPayload=this.jwtHelper.decodeToken(this.jwt)}hasValidJwt(){return!this.jwtHelper.isTokenExpired(this.jwt)}hasPrivilegedJwt(t){return!!this.jwtPayload.roles.includes(t)}decodeJwt(t){return this.jwtHelper.decodeToken(t)}authenticateByLoginCredential(t,r){const i=(new Bl).set("Content-Type","application/json");return this.http.post(`${zl_api_url}/login`,{username:t,password:r},{headers:i}).pipe(Cc())}removeJwt(){localStorage.removeItem("Jwt")}}return n.\u0275fac=function(t){return new(t||n)(yt(c0),yt(bD))},n.\u0275prov=Dn({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),bee=(()=>{class n{constructor(t,r,i){this.fb=t,this.router=r,this.authService=i,this.loginForm=this.fb.group({username:["",hF.required],password:["",hF.required]})}ngOnInit(){}login(){this.loginForm.value.username&&this.loginForm.value.password&&this.authService.authenticateByLoginCredential(this.loginForm.value.username,this.loginForm.value.password).subscribe(t=>{localStorage.setItem("Jwt",t.jwt),console.log("JWT: ",t.jwt);const r=this.authService.decodeJwt(t.jwt);localStorage.setItem("UserId",r.uid),localStorage.setItem("OrgId",r.oid),this.router.navigate("stout"!=r.oid?["/customer-home",r.oid,{uid:r.uid}]:["/support-home",{uid:r.uid,roles:r.roles}])},t=>{window.alert("Incorrect username or password. Try again."),this.router.navigateByUrl("/login")})}showReadMe(){window.alert("This is a demo version. For any question or comment regarding this app, send a message to msuh@stoutagtech.com.")}}return n.\u0275fac=function(t){return new(t||n)(Mt(rB),Mt(xu),Mt(bz))},n.\u0275cmp=ao({type:n,selectors:[["app-login"]],decls:21,vars:1,consts:[[1,"stout-logo-container"],["src","../../../assets/images/stout/stout-logo-s.jpg","alt","Stout logo",1,"stout-logo"],[3,"formGroup","ngSubmit"],[1,"input-container"],["for","uname"],["type","text","name","uname","formControlName","username","placeholder","Enter Username","required",""],["for","pwd"],["type","password","name","pwd","formControlName","password","placeholder","Enter Password","required",""],["type","submit"],[1,"auxiliary-container",2,"background-color","#f1f1f1"],["type","button",1,"cancelbtn",3,"click"],[1,"psw"],["href","#"]],template:function(t,r){1&t&&(cn(0,"div",0),Ar(1,"img",1),hn(),cn(2,"form",2),Xs("ngSubmit",function(){return r.login()}),cn(3,"div",3),cn(4,"label",4),cn(5,"b"),Zn(6,"Username"),hn(),hn(),Ar(7,"input",5),cn(8,"label",6),cn(9,"b"),Zn(10,"Password"),hn(),hn(),Ar(11,"input",7),cn(12,"button",8),Zn(13,"Login"),hn(),hn(),cn(14,"div",9),cn(15,"button",10),Xs("click",function(){return r.showReadMe()}),Zn(16,"Read Me"),hn(),cn(17,"span",11),Zn(18,"Forgot "),cn(19,"a",12),Zn(20,"password?"),hn(),hn(),hn(),hn()),2&t&&($o(2),va("formGroup",r.loginForm))},directives:[nD,qT,l0,R_,Bb,Hb,Wb],styles:["body[_ngcontent-%COMP%]{font-family:Arial,Helvetica,sans-serif}.stout-logo-container[_ngcontent-%COMP%]{display:block;text-align:center;margin:24px 0 12px}.stout-logo[_ngcontent-%COMP%]{width:25%;border-radius:30%}.input-container[_ngcontent-%COMP%]{width:28%;margin-left:36%;margin-top:48px;padding:16px}.auxiliary-container[_ngcontent-%COMP%]{display:flex;width:28%;flex-direction:row;justify-content:space-between;margin-left:36%;margin-top:24px;padding:16px}input[type=text][_ngcontent-%COMP%], input[type=password][_ngcontent-%COMP%]{display:block;width:100%;padding:12px 20px;margin:8px 0;border:1px solid #ccc;box-sizing:border-box}button[_ngcontent-%COMP%]{width:100%;padding:14px 20px;margin:8px 0;border:none;cursor:pointer;background-color:#4caf50;color:#fff}button[_ngcontent-%COMP%]:hover{opacity:.8}.cancelbtn[_ngcontent-%COMP%]{width:25%;padding:10px 18px;background-color:#f44336}span.psw[_ngcontent-%COMP%]{padding-top:16px}@media screen and (max-width: 300px){span.psw[_ngcontent-%COMP%]{display:block;float:none}.cancelbtn[_ngcontent-%COMP%]{width:100%}}"]}),n})();const wee=function(n){return["/customer-home",n,"overview-map"]},Eee=function(n){return["/customer-home",n,"cultivator-tracker"]},Cee=function(n){return["/customer-home",n,"field-viewer"]},See=function(n){return["/customer-home",n,"yield-analyzer"]},Mee=function(n){return["/customer-home",n,"cost-analyzer"]};let Tee=(()=>{class n{constructor(t,r,i,o){this.router=t,this.route=r,this.http=i,this.authService=o,this.customer_logo_path="",this.sidebar_anchors=document.getElementsByClassName("this.sidebar_anchor"),this.uid=localStorage.getItem("UserId"),this.oid=this.route.snapshot.paramMap.get("oid"),this.customer_logo_path=`../../../assets/images/${this.oid}/logo.png`}ngOnInit(){}onSignOut(){this.authService.removeJwt(),this.router.navigate(["/login"])}}return n.\u0275fac=function(t){return new(t||n)(Mt(xu),Mt(Lg),Mt(c0),Mt(bz))},n.\u0275cmp=ao({type:n,selectors:[["app-customer-home"]],decls:34,vars:18,consts:[[1,"sidebar"],[1,"customer-logo-container"],[3,"src","alt"],[1,"nav-list"],["routerLinkActive","active",3,"routerLink"],[1,"li-label"],[1,"user-profile"],[1,"material-icons",2,"vertical-align","middle","color","darkslateblue"],[1,"user-id"],[1,"signout",3,"click"],[1,"outlet"]],template:function(t,r){1&t&&(cn(0,"div",0),cn(1,"div",1),Ar(2,"img",2),hn(),cn(3,"ul",3),cn(4,"li"),cn(5,"a",4),cn(6,"span",5),Zn(7,"Overview Map"),hn(),hn(),hn(),cn(8,"li"),cn(9,"a",4),cn(10,"span",5),Zn(11,"Cultivator Tracker"),hn(),hn(),hn(),cn(12,"li"),cn(13,"a",4),cn(14,"span",5),Zn(15,"Field Viewer"),hn(),hn(),hn(),cn(16,"li"),cn(17,"a",4),cn(18,"span",5),Zn(19,"Yield Analyzer"),hn(),hn(),hn(),cn(20,"li"),cn(21,"a",4),cn(22,"span",5),Zn(23,"Cost Analyzer"),hn(),hn(),hn(),hn(),cn(24,"div",6),cn(25,"div"),cn(26,"i",7),Zn(27,"account_box"),hn(),cn(28,"span",8),Zn(29),hn(),hn(),cn(30,"div",9),Xs("click",function(){return r.onSignOut()}),Zn(31,"Sign Out"),hn(),hn(),hn(),cn(32,"div",10),Ar(33,"router-outlet"),hn()),2&t&&($o(2),e_("src",r.customer_logo_path,Jp),e_("alt",r.oid),$o(3),va("routerLink",f_(8,wee,r.oid)),$o(4),va("routerLink",f_(10,Eee,r.oid)),$o(4),va("routerLink",f_(12,Cee,r.oid)),$o(4),va("routerLink",f_(14,See,r.oid)),$o(4),va("routerLink",f_(16,Mee,r.oid)),$o(8),mv(r.uid))},directives:[hw,pz,dw],styles:[".sidebar[_ngcontent-%COMP%]{position:fixed;left:0;top:0;height:100%;width:210px;background:#dcdcdc;padding:6px;z-index:99}.sidebar[_ngcontent-%COMP%]   .nav-list[_ngcontent-%COMP%]{margin:64px 3px 16px;padding:8px 8px 64px;background:#666699}.sidebar[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{list-style:none;margin:0;padding:0}.sidebar[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:flex;height:48px;margin:8px 0;justify-content:center;align-items:center;border:1px solid #fff;text-decoration:none;transition:border .4s}.sidebar[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   .li-label[_ngcontent-%COMP%]{color:#fff;font-size:16px;white-space:nowrap;pointer-events:none;transition:font-size .4s}.sidebar[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{border:2px solid #fff}.sidebar[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:active{background-color:#b3b3cc}.sidebar[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a.active[_ngcontent-%COMP%]{background-color:#b3b3cc}.sidebar[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover   .li-label[_ngcontent-%COMP%]{font-size:18px}.sidebar[_ngcontent-%COMP%]   .customer-logo-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.sidebar[_ngcontent-%COMP%]   .customer-logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:80%;border-radius:30%}.sidebar[_ngcontent-%COMP%]   .user-profile[_ngcontent-%COMP%]{position:absolute;left:0;bottom:32px;width:100%;display:flex;flex-direction:column;justify-content:center;align-items:center}.sidebar[_ngcontent-%COMP%]   .user-profile[_ngcontent-%COMP%]{font-size:16px}.sidebar[_ngcontent-%COMP%]   .user-profile[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{transform:scale(1.6)}.sidebar[_ngcontent-%COMP%]   .user-profile[_ngcontent-%COMP%]   .user-id[_ngcontent-%COMP%]{display:inline-block;margin-left:12px}.sidebar[_ngcontent-%COMP%]   .user-profile[_ngcontent-%COMP%]   .signout[_ngcontent-%COMP%]{display:flex;width:120px;height:24px;margin:8px;padding:8px;flex-direction:column;justify-content:center;background-color:red;color:#fff;font-size:16px;text-align:center}.outlet[_ngcontent-%COMP%]{position:fixed;left:218px;top:0;width:100%;height:100%}"]}),n})(),Dee=(()=>{class n{constructor(){}ngOnInit(){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=ao({type:n,selectors:[["app-support-home"]],decls:2,vars:0,template:function(t,r){1&t&&(cn(0,"p"),Zn(1,"support-home works!"),hn())},styles:[""]}),n})();var rl=Ue(2958);function Af(n,e,t){void 0===t&&(t={});var r={type:"Feature"};return(0===t.id||t.id)&&(r.id=t.id),t.bbox&&(r.bbox=t.bbox),r.properties=e||{},r.geometry=n,r}function Bg(n,e,t){if(void 0===t&&(t={}),!n)throw new Error("coordinates is required");if(!Array.isArray(n))throw new Error("coordinates must be an Array");if(n.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!qD(n[0])||!qD(n[1]))throw new Error("coordinates must contain numbers");return Af({type:"Point",coordinates:n},e,t)}function w0(n,e,t){void 0===t&&(t={});for(var r=0,i=n;r<i.length;r++){var o=i[r];if(o.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var s=0;s<o[o.length-1].length;s++)if(o[o.length-1][s]!==o[0][s])throw new Error("First and last Position are not equivalent.")}return Af({type:"Polygon",coordinates:n},e,t)}function qD(n){return!isNaN(n)&&null!==n&&!Array.isArray(n)}function Ip(n,e,t){if(null!==n)for(var r,i,o,s,u,f,g,T,v=0,E=0,R=n.type,B="FeatureCollection"===R,z="Feature"===R,G=B?n.features.length:1,W=0;W<G;W++){u=(T=!!(g=B?n.features[W].geometry:z?n.geometry:n)&&"GeometryCollection"===g.type)?g.geometries.length:1;for(var H=0;H<u;H++){var ee=0,_e=0;if(null!==(s=T?g.geometries[H]:g)){f=s.coordinates;var ye=s.type;switch(v=!t||"Polygon"!==ye&&"MultiPolygon"!==ye?0:1,ye){case null:break;case"Point":if(!1===e(f,E,W,ee,_e))return!1;E++,ee++;break;case"LineString":case"MultiPoint":for(r=0;r<f.length;r++){if(!1===e(f[r],E,W,ee,_e))return!1;E++,"MultiPoint"===ye&&ee++}"LineString"===ye&&ee++;break;case"Polygon":case"MultiLineString":for(r=0;r<f.length;r++){for(i=0;i<f[r].length-v;i++){if(!1===e(f[r][i],E,W,ee,_e))return!1;E++}"MultiLineString"===ye&&ee++,"Polygon"===ye&&_e++}"Polygon"===ye&&ee++;break;case"MultiPolygon":for(r=0;r<f.length;r++){for(_e=0,i=0;i<f[r].length;i++){for(o=0;o<f[r][i].length-v;o++){if(!1===e(f[r][i][o],E,W,ee,_e))return!1;E++}_e++}ee++}break;case"GeometryCollection":for(r=0;r<s.geometries.length;r++)if(!1===Ip(s.geometries[r],e,t))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function fw(n,e){!function(n,e){var t,r,i,o,s,u,f,g,v,E,T=0,R="FeatureCollection"===n.type,B="Feature"===n.type,z=R?n.features.length:1;for(t=0;t<z;t++){for(g=R?n.features[t].properties:B?n.properties:{},v=R?n.features[t].bbox:B?n.bbox:void 0,E=R?n.features[t].id:B?n.id:void 0,s=(f=!!(u=R?n.features[t].geometry:B?n.geometry:n)&&"GeometryCollection"===u.type)?u.geometries.length:1,i=0;i<s;i++)if(null!==(o=f?u.geometries[i]:u))switch(o.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===e(o,T,g,v,E))return!1;break;case"GeometryCollection":for(r=0;r<o.geometries.length;r++)if(!1===e(o.geometries[r],T,g,v,E))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===e(null,T,g,v,E))return!1;T++}}(n,function(t,r,i,o,s){var f,u=null===t?null:t.type;switch(u){case null:case"Point":case"LineString":case"Polygon":return!1!==e(Af(t,i,{bbox:o,id:s}),r,0)&&void 0}switch(u){case"MultiPoint":f="Point";break;case"MultiLineString":f="LineString";break;case"MultiPolygon":f="Polygon"}for(var g=0;g<t.coordinates.length;g++)if(!1===e(Af({type:f,coordinates:t.coordinates[g]},i),r,g))return!1})}function WD(n){var e=[1/0,1/0,-1/0,-1/0];return Ip(n,function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])}),e}WD.default=WD;const XD=WD;function Tz(n){if(!n)throw new Error("coord is required");if(!Array.isArray(n)){if("Feature"===n.type&&null!==n.geometry&&"Point"===n.geometry.type)return n.geometry.coordinates;if("Point"===n.type)return n.coordinates}if(Array.isArray(n)&&n.length>=2&&!Array.isArray(n[0])&&!Array.isArray(n[1]))return n;throw new Error("coord must be GeoJSON Point or an Array of numbers")}Ue(8228);var Kee=Ue(6896);function Pz(n,e,t){if(void 0===t&&(t={}),!n)throw new Error("point is required");if(!e)throw new Error("polygon is required");var r=Tz(n),i=function(n){return"Feature"===n.type?n.geometry:n}(e),o=i.type,s=e.bbox,u=i.coordinates;if(s&&!1===function(n,e){return e[0]<=n[0]&&e[1]<=n[1]&&e[2]>=n[0]&&e[3]>=n[1]}(r,s))return!1;"Polygon"===o&&(u=[u]);for(var f=!1,g=0;g<u.length&&!f;g++)if(Rz(r,u[g][0],t.ignoreBoundary)){for(var v=!1,E=1;E<u[g].length&&!v;)Rz(r,u[g][E],!t.ignoreBoundary)&&(v=!0),E++;v||(f=!0)}return f}function Rz(n,e,t){var r=!1;e[0][0]===e[e.length-1][0]&&e[0][1]===e[e.length-1][1]&&(e=e.slice(0,e.length-1));for(var i=0,o=e.length-1;i<e.length;o=i++){var s=e[i][0],u=e[i][1],f=e[o][0],g=e[o][1];if(n[1]*(s-f)+u*(f-n[0])+g*(n[0]-s)==0&&(s-n[0])*(f-n[0])<=0&&(u-n[1])*(g-n[1])<=0)return!t;u>n[1]!=g>n[1]&&n[0]<(f-s)*(n[1]-u)/(g-u)+s&&(r=!r)}return r}var kz=new ArrayBuffer(16);new Float64Array(kz),new Uint32Array(kz),Ue(7729),function(){function n(e){this.points=e.points||[],this.duration=e.duration||1e4,this.sharpness=e.sharpness||.85,this.centers=[],this.controls=[],this.stepLength=e.stepLength||60,this.length=this.points.length,this.delay=0;for(var t=0;t<this.length;t++)this.points[t].z=this.points[t].z||0;for(t=0;t<this.length-1;t++){var r=this.points[t],i=this.points[t+1];this.centers.push({x:(r.x+i.x)/2,y:(r.y+i.y)/2,z:(r.z+i.z)/2})}for(this.controls.push([this.points[0],this.points[0]]),t=0;t<this.centers.length-1;t++){var o=this.points[t+1].x-(this.centers[t].x+this.centers[t+1].x)/2,s=this.points[t+1].y-(this.centers[t].y+this.centers[t+1].y)/2,u=this.points[t+1].z-(this.centers[t].y+this.centers[t+1].z)/2;this.controls.push([{x:(1-this.sharpness)*this.points[t+1].x+this.sharpness*(this.centers[t].x+o),y:(1-this.sharpness)*this.points[t+1].y+this.sharpness*(this.centers[t].y+s),z:(1-this.sharpness)*this.points[t+1].z+this.sharpness*(this.centers[t].z+u)},{x:(1-this.sharpness)*this.points[t+1].x+this.sharpness*(this.centers[t+1].x+o),y:(1-this.sharpness)*this.points[t+1].y+this.sharpness*(this.centers[t+1].y+s),z:(1-this.sharpness)*this.points[t+1].z+this.sharpness*(this.centers[t+1].z+u)}])}return this.controls.push([this.points[this.length-1],this.points[this.length-1]]),this.steps=this.cacheSteps(this.stepLength),this}n.prototype.cacheSteps=function(e){var t=[],r=this.pos(0);t.push(0);for(var i=0;i<this.duration;i+=10){var o=this.pos(i);Math.sqrt((o.x-r.x)*(o.x-r.x)+(o.y-r.y)*(o.y-r.y)+(o.z-r.z)*(o.z-r.z))>e&&(t.push(i),r=o)}return t},n.prototype.vector=function(e){var t=this.pos(e+10),r=this.pos(e-10);return{angle:180*Math.atan2(t.y-r.y,t.x-r.x)/3.14,speed:Math.sqrt((r.x-t.x)*(r.x-t.x)+(r.y-t.y)*(r.y-t.y)+(r.z-t.z)*(r.z-t.z))}},n.prototype.pos=function(e){var t=e-this.delay;t<0&&(t=0),t>this.duration&&(t=this.duration-1);var r=t/this.duration;if(r>=1)return this.points[this.length-1];var i=Math.floor((this.points.length-1)*r);return function(n,e,t,r,i){var o=function(n){var e=n*n;return[e*n,3*e*(1-n),3*n*(1-n)*(1-n),(1-n)*(1-n)*(1-n)]}(n);return{x:i.x*o[0]+r.x*o[1]+t.x*o[2]+e.x*o[3],y:i.y*o[0]+r.y*o[1]+t.y*o[2]+e.y*o[3],z:i.z*o[0]+r.z*o[1]+t.z*o[2]+e.z*o[3]}}((this.length-1)*r-i,this.points[i],this.controls[i][1],this.controls[i+1][0],this.points[i+1])}}();const Vz=function(n,e){void 0===e&&(e={});var t=0,r=0,i=0;return Ip(n,function(o){t+=o[0],r+=o[1],i++},!0),Bg([t/i,r/i],e.properties)},jz=function Uz(n,e){switch(void 0===e&&(e={}),function(n,e){return"FeatureCollection"===n.type?"FeatureCollection":"GeometryCollection"===n.type?"GeometryCollection":"Feature"===n.type&&null!==n.geometry?n.geometry.type:n.type}(n)){case"Point":return Bg(Tz(n),e.properties);case"Polygon":var t=[];Ip(n,function(_e){t.push(_e)});var f,g,v,E,T,R,B,z,r=Vz(n,{properties:e.properties}),i=r.geometry.coordinates,o=0,s=0,u=0,G=t.map(function(_e){return[_e[0]-i[0],_e[1]-i[1]]});for(f=0;f<t.length-1;f++)u+=z=(E=(g=G[f])[0])*(B=(v=G[f+1])[1])-(T=v[0])*(R=g[1]),o+=(E+T)*z,s+=(R+B)*z;if(0===u)return r;var H=1/(.5*u*6);return Bg([i[0]+H*o,i[1]+H*s],e.properties);default:var ee=function(n,e){void 0===e&&(e={}),e.concavity=e.concavity||1/0;var t=[];if(Ip(n,function(i){t.push([i[0],i[1]])}),!t.length)return null;var r=Kee(t,e.concavity);return r.length>3?w0([r]):null}(n);return ee?Uz(ee,{properties:e.properties}):Vz(n,{properties:e.properties})}};Ue(1604),Ue(2689);var e3=Math.PI/180,t3=180/Math.PI,S0=function(n,e){this.lon=n,this.lat=e,this.x=e3*n,this.y=e3*e};S0.prototype.view=function(){return String(this.lon).slice(0,4)+","+String(this.lat).slice(0,4)},S0.prototype.antipode=function(){return new S0(this.lon<0?180+this.lon:-1*(180-this.lon),-1*this.lat)};var n3=function(){this.coords=[],this.length=0};n3.prototype.move_to=function(n){this.length++,this.coords.push(n)};var nI=function(n){this.properties=n||{},this.geometries=[]};nI.prototype.json=function(){if(this.geometries.length<=0)return{geometry:{type:"LineString",coordinates:null},type:"Feature",properties:this.properties};if(1===this.geometries.length)return{geometry:{type:"LineString",coordinates:this.geometries[0].coords},type:"Feature",properties:this.properties};for(var n=[],e=0;e<this.geometries.length;e++)n.push(this.geometries[e].coords);return{geometry:{type:"MultiLineString",coordinates:n},type:"Feature",properties:this.properties}},nI.prototype.wkt=function(){for(var n="",e="LINESTRING(",t=function(o){e+=o[0]+" "+o[1]+","},r=0;r<this.geometries.length;r++){if(0===this.geometries[r].coords.length)return"LINESTRING(empty)";this.geometries[r].coords.forEach(t),n+=e.substring(0,e.length-1)+")"}return n};var rI=function(n,e,t){if(!n||void 0===n.x||void 0===n.y)throw new Error("GreatCircle constructor expects two args: start and end objects with x and y properties");if(!e||void 0===e.x||void 0===e.y)throw new Error("GreatCircle constructor expects two args: start and end objects with x and y properties");this.start=new S0(n.x,n.y),this.end=new S0(e.x,e.y),this.properties=t||{};var r=this.start.x-this.end.x,o=Math.pow(Math.sin((this.start.y-this.end.y)/2),2)+Math.cos(this.start.y)*Math.cos(this.end.y)*Math.pow(Math.sin(r/2),2);if(this.g=2*Math.asin(Math.sqrt(o)),this.g===Math.PI)throw new Error("it appears "+n.view()+" and "+e.view()+" are 'antipodal', e.g diametrically opposite, thus there is no single route but rather infinite");if(isNaN(this.g))throw new Error("could not calculate great circle between "+n+" and "+e)};rI.prototype.interpolate=function(n){var e=Math.sin((1-n)*this.g)/Math.sin(this.g),t=Math.sin(n*this.g)/Math.sin(this.g),r=e*Math.cos(this.start.y)*Math.cos(this.start.x)+t*Math.cos(this.end.y)*Math.cos(this.end.x),i=e*Math.cos(this.start.y)*Math.sin(this.start.x)+t*Math.cos(this.end.y)*Math.sin(this.end.x),o=e*Math.sin(this.start.y)+t*Math.sin(this.end.y),s=t3*Math.atan2(o,Math.sqrt(Math.pow(r,2)+Math.pow(i,2)));return[t3*Math.atan2(i,r),s]},rI.prototype.Arc=function(n,e){var t=[];if(!n||n<=2)t.push([this.start.lon,this.start.lat]),t.push([this.end.lon,this.end.lat]);else for(var r=1/(n-1),i=0;i<n;++i){var s=this.interpolate(r*i);t.push(s)}for(var u=!1,f=0,g=e&&e.offset?e.offset:10,v=180-g,E=-180+g,T=360-g,R=1;R<t.length;++R){var B=t[R-1][0],z=t[R][0],G=Math.abs(z-B);G>T&&(z>v&&B<E||B>v&&z<E)?u=!0:G>f&&(f=G)}var W=[];if(u&&f<g){var H=[];W.push(H);for(var ee=0;ee<t.length;++ee){var _e=parseFloat(t[ee][0]);if(ee>0&&Math.abs(_e-t[ee-1][0])>T){var ye=parseFloat(t[ee-1][0]),$e=parseFloat(t[ee-1][1]),We=parseFloat(t[ee][0]),rt=parseFloat(t[ee][1]);if(ye>-180&&ye<E&&180===We&&ee+1<t.length&&t[ee-1][0]>-180&&t[ee-1][0]<E){H.push([-180,t[ee][1]]),ee++,H.push([t[ee][0],t[ee][1]]);continue}if(ye>v&&ye<180&&-180===We&&ee+1<t.length&&t[ee-1][0]>v&&t[ee-1][0]<180){H.push([180,t[ee][1]]),ee++,H.push([t[ee][0],t[ee][1]]);continue}if(ye<E&&We>v){var ke=ye;ye=We,We=ke;var _n=$e;$e=rt,rt=_n}if(ye>v&&We<E&&(We+=360),ye<=180&&We>=180&&ye<We){var on=(180-ye)/(We-ye),zn=on*rt+(1-on)*$e;H.push([t[ee-1][0]>v?180:-180,zn]),(H=[]).push([t[ee-1][0]>v?-180:180,zn]),W.push(H)}else W.push(H=[]);H.push([_e,t[ee][1]])}else H.push([t[ee][0],t[ee][1]])}}else{var An=[];W.push(An);for(var sn=0;sn<t.length;++sn)An.push([t[sn][0],t[sn][1]])}for(var qn=new nI(this.properties),Tt=0;Tt<W.length;++Tt){var yn=new n3;qn.geometries.push(yn);for(var kn=W[Tt],Un=0;Un<kn.length;++Un)yn.move_to(kn[Un])}return qn},Ue(2978);var vi=[],xi=[],bi=[],wi=[],Ei=[],Ci=[],Si=[],Mi=[],Ti=[],Di=[],Ii=[],Ai=[],Pi=[],Ri=[],Oi=[],ki=[],Li=[],Ni=[],Fi=[],Bi=[],zi=[],Vi=[],Ui=[],ji=[];Si[85]=Di[85]=-1,Mi[85]=Ii[85]=0,Ti[85]=Ai[85]=1,Fi[85]=Vi[85]=1,Bi[85]=Ui[85]=0,zi[85]=ji[85]=1,vi[85]=wi[85]=0,xi[85]=Ei[85]=-1,bi[85]=Oi[85]=0,ki[85]=Pi[85]=0,Li[85]=Ri[85]=1,Ci[85]=Ni[85]=1,Vi[1]=Vi[169]=0,Ui[1]=Ui[169]=-1,ji[1]=ji[169]=0,Pi[1]=Pi[169]=-1,Ri[1]=Ri[169]=0,Oi[1]=Oi[169]=0,Di[4]=Di[166]=0,Ii[4]=Ii[166]=-1,Ai[4]=Ai[166]=1,ki[4]=ki[166]=1,Li[4]=Li[166]=0,Ni[4]=Ni[166]=0,Si[16]=Si[154]=0,Mi[16]=Mi[154]=1,Ti[16]=Ti[154]=1,wi[16]=wi[154]=1,Ei[16]=Ei[154]=0,Ci[16]=Ci[154]=1,Fi[64]=Fi[106]=0,Bi[64]=Bi[106]=1,zi[64]=zi[106]=0,vi[64]=vi[106]=-1,xi[64]=xi[106]=0,bi[64]=bi[106]=1,Fi[2]=Fi[168]=0,Bi[2]=Bi[168]=-1,zi[2]=zi[168]=1,Vi[2]=Vi[168]=0,Ui[2]=Ui[168]=-1,ji[2]=ji[168]=0,Pi[2]=Pi[168]=-1,Ri[2]=Ri[168]=0,Oi[2]=Oi[168]=0,ki[2]=ki[168]=-1,Li[2]=Li[168]=0,Ni[2]=Ni[168]=1,Si[8]=Si[162]=0,Mi[8]=Mi[162]=-1,Ti[8]=Ti[162]=0,Di[8]=Di[162]=0,Ii[8]=Ii[162]=-1,Ai[8]=Ai[162]=1,Pi[8]=Pi[162]=1,Ri[8]=Ri[162]=0,Oi[8]=Oi[162]=1,ki[8]=ki[162]=1,Li[8]=Li[162]=0,Ni[8]=Ni[162]=0,Si[32]=Si[138]=0,Mi[32]=Mi[138]=1,Ti[32]=Ti[138]=1,Di[32]=Di[138]=0,Ii[32]=Ii[138]=1,Ai[32]=Ai[138]=0,vi[32]=vi[138]=1,xi[32]=xi[138]=0,bi[32]=bi[138]=0,wi[32]=wi[138]=1,Ei[32]=Ei[138]=0,Ci[32]=Ci[138]=1,Vi[128]=Vi[42]=0,Ui[128]=Ui[42]=1,ji[128]=ji[42]=1,Fi[128]=Fi[42]=0,Bi[128]=Bi[42]=1,zi[128]=zi[42]=0,vi[128]=vi[42]=-1,xi[128]=xi[42]=0,bi[128]=bi[42]=1,wi[128]=wi[42]=-1,Ei[128]=Ei[42]=0,Ci[128]=Ci[42]=0,Di[5]=Di[165]=-1,Ii[5]=Ii[165]=0,Ai[5]=Ai[165]=0,Vi[5]=Vi[165]=1,Ui[5]=Ui[165]=0,ji[5]=ji[165]=0,ki[20]=ki[150]=0,Li[20]=Li[150]=1,Ni[20]=Ni[150]=1,wi[20]=wi[150]=0,Ei[20]=Ei[150]=-1,Ci[20]=Ci[150]=1,Si[80]=Si[90]=-1,Mi[80]=Mi[90]=0,Ti[80]=Ti[90]=1,Fi[80]=Fi[90]=1,Bi[80]=Bi[90]=0,zi[80]=zi[90]=1,Pi[65]=Pi[105]=0,Ri[65]=Ri[105]=1,Oi[65]=Oi[105]=0,vi[65]=vi[105]=0,xi[65]=xi[105]=-1,bi[65]=bi[105]=0,Si[160]=Si[10]=-1,Mi[160]=Mi[10]=0,Ti[160]=Ti[10]=1,Di[160]=Di[10]=-1,Ii[160]=Ii[10]=0,Ai[160]=Ai[10]=0,Vi[160]=Vi[10]=1,Ui[160]=Ui[10]=0,ji[160]=ji[10]=0,Fi[160]=Fi[10]=1,Bi[160]=Bi[10]=0,zi[160]=zi[10]=1,ki[130]=ki[40]=0,Li[130]=Li[40]=1,Ni[130]=Ni[40]=1,Pi[130]=Pi[40]=0,Ri[130]=Ri[40]=1,Oi[130]=Oi[40]=0,vi[130]=vi[40]=0,xi[130]=xi[40]=-1,bi[130]=bi[40]=0,wi[130]=wi[40]=0,Ei[130]=Ei[40]=-1,Ci[130]=Ci[40]=1,Di[37]=Di[133]=0,Ii[37]=Ii[133]=1,Ai[37]=Ai[133]=1,Vi[37]=Vi[133]=0,Ui[37]=Ui[133]=1,ji[37]=ji[133]=0,vi[37]=vi[133]=-1,xi[37]=xi[133]=0,bi[37]=bi[133]=0,wi[37]=wi[133]=1,Ei[37]=Ei[133]=0,Ci[37]=Ci[133]=0,ki[148]=ki[22]=-1,Li[148]=Li[22]=0,Ni[148]=Ni[22]=0,Vi[148]=Vi[22]=0,Ui[148]=Ui[22]=-1,ji[148]=ji[22]=1,Fi[148]=Fi[22]=0,Bi[148]=Bi[22]=1,zi[148]=zi[22]=1,wi[148]=wi[22]=-1,Ei[148]=Ei[22]=0,Ci[148]=Ci[22]=1,Si[82]=Si[88]=0,Mi[82]=Mi[88]=-1,Ti[82]=Ti[88]=1,ki[82]=ki[88]=1,Li[82]=Li[88]=0,Ni[82]=Ni[88]=1,Pi[82]=Pi[88]=-1,Ri[82]=Ri[88]=0,Oi[82]=Oi[88]=1,Fi[82]=Fi[88]=0,Bi[82]=Bi[88]=-1,zi[82]=zi[88]=0,Si[73]=Si[97]=0,Mi[73]=Mi[97]=1,Ti[73]=Ti[97]=0,Di[73]=Di[97]=0,Ii[73]=Ii[97]=-1,Ai[73]=Ai[97]=0,Pi[73]=Pi[97]=1,Ri[73]=Ri[97]=0,Oi[73]=Oi[97]=0,vi[73]=vi[97]=1,xi[73]=xi[97]=0,bi[73]=bi[97]=1,Si[145]=Si[25]=0,Mi[145]=Mi[25]=-1,Ti[145]=Ti[25]=0,Pi[145]=Pi[25]=1,Ri[145]=Ri[25]=0,Oi[145]=Oi[25]=1,Vi[145]=Vi[25]=0,Ui[145]=Ui[25]=1,ji[145]=ji[25]=1,wi[145]=wi[25]=-1,Ei[145]=Ei[25]=0,Ci[145]=Ci[25]=0,Di[70]=Di[100]=0,Ii[70]=Ii[100]=1,Ai[70]=Ai[100]=0,ki[70]=ki[100]=-1,Li[70]=Li[100]=0,Ni[70]=Ni[100]=1,Fi[70]=Fi[100]=0,Bi[70]=Bi[100]=-1,zi[70]=zi[100]=1,vi[70]=vi[100]=1,xi[70]=xi[100]=0,bi[70]=bi[100]=0,Di[101]=Di[69]=0,Ii[101]=Ii[69]=1,Ai[101]=Ai[69]=0,vi[101]=vi[69]=1,xi[101]=xi[69]=0,bi[101]=bi[69]=0,Vi[149]=Vi[21]=0,Ui[149]=Ui[21]=1,ji[149]=ji[21]=1,wi[149]=wi[21]=-1,Ei[149]=Ei[21]=0,Ci[149]=Ci[21]=0,ki[86]=ki[84]=-1,Li[86]=Li[84]=0,Ni[86]=Ni[84]=1,Fi[86]=Fi[84]=0,Bi[86]=Bi[84]=-1,zi[86]=zi[84]=1,Si[89]=Si[81]=0,Mi[89]=Mi[81]=-1,Ti[89]=Ti[81]=0,Pi[89]=Pi[81]=1,Ri[89]=Ri[81]=0,Oi[89]=Oi[81]=1,Si[96]=Si[74]=0,Mi[96]=Mi[74]=1,Ti[96]=Ti[74]=0,Di[96]=Di[74]=-1,Ii[96]=Ii[74]=0,Ai[96]=Ai[74]=1,Fi[96]=Fi[74]=1,Bi[96]=Bi[74]=0,zi[96]=zi[74]=0,vi[96]=vi[74]=1,xi[96]=xi[74]=0,bi[96]=bi[74]=1,Si[24]=Si[146]=0,Mi[24]=Mi[146]=-1,Ti[24]=Ti[146]=1,ki[24]=ki[146]=1,Li[24]=Li[146]=0,Ni[24]=Ni[146]=1,Pi[24]=Pi[146]=0,Ri[24]=Ri[146]=1,Oi[24]=Oi[146]=1,wi[24]=wi[146]=0,Ei[24]=Ei[146]=-1,Ci[24]=Ci[146]=0,Di[6]=Di[164]=-1,Ii[6]=Ii[164]=0,Ai[6]=Ai[164]=1,ki[6]=ki[164]=-1,Li[6]=Li[164]=0,Ni[6]=Ni[164]=0,Vi[6]=Vi[164]=0,Ui[6]=Ui[164]=-1,ji[6]=ji[164]=1,Fi[6]=Fi[164]=1,Bi[6]=Bi[164]=0,zi[6]=zi[164]=0,Pi[129]=Pi[41]=0,Ri[129]=Ri[41]=1,Oi[129]=Oi[41]=1,Vi[129]=Vi[41]=0,Ui[129]=Ui[41]=1,ji[129]=ji[41]=0,vi[129]=vi[41]=-1,xi[129]=xi[41]=0,bi[129]=bi[41]=0,wi[129]=wi[41]=0,Ei[129]=Ei[41]=-1,Ci[129]=Ci[41]=0,ki[66]=ki[104]=0,Li[66]=Li[104]=1,Ni[66]=Ni[104]=0,Pi[66]=Pi[104]=-1,Ri[66]=Ri[104]=0,Oi[66]=Oi[104]=1,Fi[66]=Fi[104]=0,Bi[66]=Bi[104]=-1,zi[66]=zi[104]=0,vi[66]=vi[104]=0,xi[66]=xi[104]=-1,bi[66]=bi[104]=1,Si[144]=Si[26]=-1,Mi[144]=Mi[26]=0,Ti[144]=Ti[26]=0,Vi[144]=Vi[26]=1,Ui[144]=Ui[26]=0,ji[144]=ji[26]=1,Fi[144]=Fi[26]=0,Bi[144]=Bi[26]=1,zi[144]=zi[26]=1,wi[144]=wi[26]=-1,Ei[144]=Ei[26]=0,Ci[144]=Ci[26]=1,Di[36]=Di[134]=0,Ii[36]=Ii[134]=1,Ai[36]=Ai[134]=1,ki[36]=ki[134]=0,Li[36]=Li[134]=1,Ni[36]=Ni[134]=0,vi[36]=vi[134]=0,xi[36]=xi[134]=-1,bi[36]=bi[134]=1,wi[36]=wi[134]=1,Ei[36]=Ei[134]=0,Ci[36]=Ci[134]=0,Si[9]=Si[161]=-1,Mi[9]=Mi[161]=0,Ti[9]=Ti[161]=0,Di[9]=Di[161]=0,Ii[9]=Ii[161]=-1,Ai[9]=Ai[161]=0,Pi[9]=Pi[161]=1,Ri[9]=Ri[161]=0,Oi[9]=Oi[161]=0,Vi[9]=Vi[161]=1,Ui[9]=Ui[161]=0,ji[9]=ji[161]=1,Si[136]=0,Mi[136]=1,Ti[136]=1,Di[136]=0,Ii[136]=1,Ai[136]=0,ki[136]=-1,Li[136]=0,Ni[136]=1,Pi[136]=-1,Ri[136]=0,Oi[136]=0,Vi[136]=0,Ui[136]=-1,ji[136]=0,Fi[136]=0,Bi[136]=-1,zi[136]=1,vi[136]=1,xi[136]=0,bi[136]=0,wi[136]=1,Ei[136]=0,Ci[136]=1,Si[34]=0,Mi[34]=-1,Ti[34]=0,Di[34]=0,Ii[34]=-1,Ai[34]=1,ki[34]=1,Li[34]=0,Ni[34]=0,Pi[34]=1,Ri[34]=0,Oi[34]=1,Vi[34]=0,Ui[34]=1,ji[34]=1,Fi[34]=0,Bi[34]=1,zi[34]=0,vi[34]=-1,xi[34]=0,bi[34]=1,wi[34]=-1,Ei[34]=0,Ci[34]=0,Si[35]=0,Mi[35]=1,Ti[35]=1,Di[35]=0,Ii[35]=-1,Ai[35]=1,ki[35]=1,Li[35]=0,Ni[35]=0,Pi[35]=-1,Ri[35]=0,Oi[35]=0,Vi[35]=0,Ui[35]=-1,ji[35]=0,Fi[35]=0,Bi[35]=1,zi[35]=0,vi[35]=-1,xi[35]=0,bi[35]=1,wi[35]=1,Ei[35]=0,Ci[35]=1,Si[153]=0,Mi[153]=1,Ti[153]=1,Pi[153]=-1,Ri[153]=0,Oi[153]=0,Vi[153]=0,Ui[153]=-1,ji[153]=0,wi[153]=1,Ei[153]=0,Ci[153]=1,Di[102]=0,Ii[102]=-1,Ai[102]=1,ki[102]=1,Li[102]=0,Ni[102]=0,Fi[102]=0,Bi[102]=1,zi[102]=0,vi[102]=-1,xi[102]=0,bi[102]=1,Si[155]=0,Mi[155]=-1,Ti[155]=0,Pi[155]=1,Ri[155]=0,Oi[155]=1,Vi[155]=0,Ui[155]=1,ji[155]=1,wi[155]=-1,Ei[155]=0,Ci[155]=0,Di[103]=0,Ii[103]=1,Ai[103]=0,ki[103]=-1,Li[103]=0,Ni[103]=1,Fi[103]=0,Bi[103]=-1,zi[103]=1,vi[103]=1,xi[103]=0,bi[103]=0,Si[152]=0,Mi[152]=1,Ti[152]=1,ki[152]=-1,Li[152]=0,Ni[152]=1,Pi[152]=-1,Ri[152]=0,Oi[152]=0,Vi[152]=0,Ui[152]=-1,ji[152]=0,Fi[152]=0,Bi[152]=-1,zi[152]=1,wi[152]=1,Ei[152]=0,Ci[152]=1,Si[156]=0,Mi[156]=-1,Ti[156]=1,ki[156]=1,Li[156]=0,Ni[156]=1,Pi[156]=-1,Ri[156]=0,Oi[156]=0,Vi[156]=0,Ui[156]=-1,ji[156]=0,Fi[156]=0,Bi[156]=1,zi[156]=1,wi[156]=-1,Ei[156]=0,Ci[156]=1,Si[137]=0,Mi[137]=1,Ti[137]=1,Di[137]=0,Ii[137]=1,Ai[137]=0,Pi[137]=-1,Ri[137]=0,Oi[137]=0,Vi[137]=0,Ui[137]=-1,ji[137]=0,vi[137]=1,xi[137]=0,bi[137]=0,wi[137]=1,Ei[137]=0,Ci[137]=1,Si[139]=0,Mi[139]=1,Ti[139]=1,Di[139]=0,Ii[139]=-1,Ai[139]=0,Pi[139]=1,Ri[139]=0,Oi[139]=0,Vi[139]=0,Ui[139]=1,ji[139]=0,vi[139]=-1,xi[139]=0,bi[139]=0,wi[139]=1,Ei[139]=0,Ci[139]=1,Si[98]=0,Mi[98]=-1,Ti[98]=0,Di[98]=0,Ii[98]=-1,Ai[98]=1,ki[98]=1,Li[98]=0,Ni[98]=0,Pi[98]=1,Ri[98]=0,Oi[98]=1,Fi[98]=0,Bi[98]=1,zi[98]=0,vi[98]=-1,xi[98]=0,bi[98]=1,Si[99]=0,Mi[99]=1,Ti[99]=0,Di[99]=0,Ii[99]=-1,Ai[99]=1,ki[99]=1,Li[99]=0,Ni[99]=0,Pi[99]=-1,Ri[99]=0,Oi[99]=1,Fi[99]=0,Bi[99]=-1,zi[99]=0,vi[99]=1,xi[99]=0,bi[99]=1,Di[38]=0,Ii[38]=-1,Ai[38]=1,ki[38]=1,Li[38]=0,Ni[38]=0,Vi[38]=0,Ui[38]=1,ji[38]=1,Fi[38]=0,Bi[38]=1,zi[38]=0,vi[38]=-1,xi[38]=0,bi[38]=1,wi[38]=-1,Ei[38]=0,Ci[38]=0,Di[39]=0,Ii[39]=1,Ai[39]=1,ki[39]=-1,Li[39]=0,Ni[39]=0,Vi[39]=0,Ui[39]=-1,ji[39]=1,Fi[39]=0,Bi[39]=1,zi[39]=0,vi[39]=-1,xi[39]=0,bi[39]=1,wi[39]=1,Ei[39]=0,Ci[39]=0;var aI=function(n){return[[n.bottomleft,0],[0,0],[0,n.leftbottom]]},lI=function(n){return[[1,n.rightbottom],[1,0],[n.bottomright,0]]},uI=function(n){return[[n.topright,1],[1,1],[1,n.righttop]]},cI=function(n){return[[0,n.lefttop],[0,1],[n.topleft,1]]},hI=function(n){return[[n.bottomright,0],[n.bottomleft,0],[0,n.leftbottom],[0,n.lefttop]]},dI=function(n){return[[n.bottomright,0],[n.bottomleft,0],[1,n.righttop],[1,n.rightbottom]]},fI=function(n){return[[1,n.righttop],[1,n.rightbottom],[n.topleft,1],[n.topright,1]]},pI=function(n){return[[0,n.leftbottom],[0,n.lefttop],[n.topleft,1],[n.topright,1]]},tr=[],Jn=[],Mr=[],mr=[],Br=[],Lr=[],Gi=[],Ki=[];mr[1]=Br[1]=18,mr[169]=Br[169]=18,Mr[4]=Jn[4]=12,Mr[166]=Jn[166]=12,tr[16]=Ki[16]=4,tr[154]=Ki[154]=4,Lr[64]=Gi[64]=22,Lr[106]=Gi[106]=22,Mr[2]=Lr[2]=17,mr[2]=Br[2]=18,Mr[168]=Lr[168]=17,mr[168]=Br[168]=18,tr[8]=mr[8]=9,Jn[8]=Mr[8]=12,tr[162]=mr[162]=9,Jn[162]=Mr[162]=12,tr[32]=Ki[32]=4,Jn[32]=Gi[32]=1,tr[138]=Ki[138]=4,Jn[138]=Gi[138]=1,Br[128]=Ki[128]=21,Lr[128]=Gi[128]=22,Br[42]=Ki[42]=21,Lr[42]=Gi[42]=22,Jn[5]=Br[5]=14,Jn[165]=Br[165]=14,Mr[20]=Ki[20]=6,Mr[150]=Ki[150]=6,tr[80]=Lr[80]=11,tr[90]=Lr[90]=11,mr[65]=Gi[65]=3,mr[105]=Gi[105]=3,tr[160]=Lr[160]=11,Jn[160]=Br[160]=14,tr[10]=Lr[10]=11,Jn[10]=Br[10]=14,Mr[130]=Ki[130]=6,mr[130]=Gi[130]=3,Mr[40]=Ki[40]=6,mr[40]=Gi[40]=3,Jn[101]=Gi[101]=1,Jn[69]=Gi[69]=1,Br[149]=Ki[149]=21,Br[21]=Ki[21]=21,Mr[86]=Lr[86]=17,Mr[84]=Lr[84]=17,tr[89]=mr[89]=9,tr[81]=mr[81]=9,tr[96]=Gi[96]=0,Jn[96]=Lr[96]=15,tr[74]=Gi[74]=0,Jn[74]=Lr[74]=15,tr[24]=Mr[24]=8,mr[24]=Ki[24]=7,tr[146]=Mr[146]=8,mr[146]=Ki[146]=7,Jn[6]=Lr[6]=15,Mr[6]=Br[6]=16,Jn[164]=Lr[164]=15,Mr[164]=Br[164]=16,mr[129]=Ki[129]=7,Br[129]=Gi[129]=20,mr[41]=Ki[41]=7,Br[41]=Gi[41]=20,Mr[66]=Gi[66]=2,mr[66]=Lr[66]=19,Mr[104]=Gi[104]=2,mr[104]=Lr[104]=19,tr[144]=Br[144]=10,Lr[144]=Ki[144]=23,tr[26]=Br[26]=10,Lr[26]=Ki[26]=23,Jn[36]=Ki[36]=5,Mr[36]=Gi[36]=2,Jn[134]=Ki[134]=5,Mr[134]=Gi[134]=2,tr[9]=Br[9]=10,Jn[9]=mr[9]=13,tr[161]=Br[161]=10,Jn[161]=mr[161]=13,Jn[37]=Ki[37]=5,Br[37]=Gi[37]=20,Jn[133]=Ki[133]=5,Br[133]=Gi[133]=20,Mr[148]=Br[148]=16,Lr[148]=Ki[148]=23,Mr[22]=Br[22]=16,Lr[22]=Ki[22]=23,tr[82]=Mr[82]=8,mr[82]=Lr[82]=19,tr[88]=Mr[88]=8,mr[88]=Lr[88]=19,tr[73]=Gi[73]=0,Jn[73]=mr[73]=13,tr[97]=Gi[97]=0,Jn[97]=mr[97]=13,tr[145]=mr[145]=9,Br[145]=Ki[145]=21,tr[25]=mr[25]=9,Br[25]=Ki[25]=21,Jn[70]=Gi[70]=1,Mr[70]=Lr[70]=17,Jn[100]=Gi[100]=1,Mr[100]=Lr[100]=17,tr[34]=mr[34]=9,Jn[34]=Mr[34]=12,Br[34]=Ki[34]=21,Lr[34]=Gi[34]=22,tr[136]=Ki[136]=4,Jn[136]=Gi[136]=1,Mr[136]=Lr[136]=17,mr[136]=Br[136]=18,tr[35]=Ki[35]=4,Jn[35]=Mr[35]=12,mr[35]=Br[35]=18,Lr[35]=Gi[35]=22,tr[153]=Ki[153]=4,mr[153]=Br[153]=18,Jn[102]=Mr[102]=12,Lr[102]=Gi[102]=22,tr[155]=mr[155]=9,Br[155]=Ki[155]=23,Jn[103]=Gi[103]=1,Mr[103]=Lr[103]=17,tr[152]=Ki[152]=4,Mr[152]=Lr[152]=17,mr[152]=Br[152]=18,tr[156]=Mr[156]=8,mr[156]=Br[156]=18,Lr[156]=Ki[156]=23,tr[137]=Ki[137]=4,Jn[137]=Gi[137]=1,mr[137]=Br[137]=18,tr[139]=Ki[139]=4,Jn[139]=mr[139]=13,Br[139]=Gi[139]=20,tr[98]=mr[98]=9,Jn[98]=Mr[98]=12,Lr[98]=Gi[98]=22,tr[99]=Gi[99]=0,Jn[99]=Mr[99]=12,mr[99]=Lr[99]=19,Jn[38]=Mr[38]=12,Br[38]=Ki[38]=21,Lr[38]=Gi[38]=22,Jn[39]=Ki[39]=5,Mr[39]=Br[39]=16,Lr[39]=Gi[39]=22;var Hn=[];function _I(n,e,t){return function(n){return(n>0)-(n<0)||+n}((e[0]-n[0])*(t[1]-e[1])-(t[0]-e[0])*(e[1]-n[1]))}function y3(n,e){return e.geometry.coordinates[0].every(function(t){return Pz(Bg(t),n)})}Hn[1]=Hn[169]=aI,Hn[4]=Hn[166]=lI,Hn[16]=Hn[154]=uI,Hn[64]=Hn[106]=cI,Hn[168]=Hn[2]=hI,Hn[162]=Hn[8]=dI,Hn[138]=Hn[32]=fI,Hn[42]=Hn[128]=pI,Hn[5]=Hn[165]=function(n){return[[0,0],[0,n.leftbottom],[1,n.rightbottom],[1,0]]},Hn[20]=Hn[150]=function(n){return[[1,0],[n.bottomright,0],[n.topright,1],[1,1]]},Hn[80]=Hn[90]=function(n){return[[1,1],[1,n.righttop],[0,n.lefttop],[0,1]]},Hn[65]=Hn[105]=function(n){return[[n.bottomleft,0],[0,0],[0,1],[n.topleft,1]]},Hn[160]=Hn[10]=function(n){return[[1,n.righttop],[1,n.rightbottom],[0,n.leftbottom],[0,n.lefttop]]},Hn[130]=Hn[40]=function(n){return[[n.topleft,1],[n.topright,1],[n.bottomright,0],[n.bottomleft,0]]},Hn[85]=function(){return[[0,0],[0,1],[1,1],[1,0]]},Hn[101]=Hn[69]=function(n){return[[1,n.rightbottom],[1,0],[0,0],[0,1],[n.topleft,1]]},Hn[149]=Hn[21]=function(n){return[[n.topright,1],[1,1],[1,0],[0,0],[0,n.leftbottom]]},Hn[86]=Hn[84]=function(n){return[[1,0],[n.bottomright,0],[0,n.lefttop],[0,1],[1,1]]},Hn[89]=Hn[81]=function(n){return[[1,1],[1,n.righttop],[n.bottomleft,0],[0,0],[0,1]]},Hn[96]=Hn[74]=function(n){return[[1,n.righttop],[1,n.rightbottom],[0,n.lefttop],[0,1],[n.topleft,1]]},Hn[24]=Hn[146]=function(n){return[[1,1],[1,n.righttop],[n.bottomright,0],[n.bottomleft,0],[n.topright,1]]},Hn[6]=Hn[164]=function(n){return[[1,n.rightbottom],[1,0],[n.bottomright,0],[0,n.leftbottom],[0,n.lefttop]]},Hn[129]=Hn[41]=function(n){return[[n.topright,1],[n.bottomleft,0],[0,0],[0,n.leftbottom],[n.topleft,1]]},Hn[66]=Hn[104]=function(n){return[[n.bottomright,0],[n.bottomleft,0],[0,n.lefttop],[0,1],[n.topleft,1]]},Hn[144]=Hn[26]=function(n){return[[1,1],[1,n.righttop],[0,n.leftbottom],[0,n.lefttop],[n.topright,1]]},Hn[36]=Hn[134]=function(n){return[[1,n.rightbottom],[1,0],[n.bottomright,0],[n.topleft,1],[n.topright,1]]},Hn[9]=Hn[161]=function(n){return[[1,n.righttop],[1,n.rightbottom],[n.bottomleft,0],[0,0],[0,n.leftbottom]]},Hn[37]=Hn[133]=function(n){return[[1,n.rightbottom],[1,0],[0,0],[0,n.leftbottom],[n.topleft,1],[n.topright,1]]},Hn[148]=Hn[22]=function(n){return[[1,1],[1,0],[n.bottomright,0],[0,n.leftbottom],[0,n.lefttop],[n.topright,1]]},Hn[82]=Hn[88]=function(n){return[[1,1],[1,n.righttop],[n.bottomright,0],[n.bottomleft,0],[0,n.lefttop],[0,1]]},Hn[73]=Hn[97]=function(n){return[[1,n.righttop],[1,n.rightbottom],[n.bottomleft,0],[0,0],[0,1],[n.topleft,1]]},Hn[145]=Hn[25]=function(n){return[[1,1],[1,n.righttop],[n.bottomleft,0],[0,0],[0,n.leftbottom],[n.topright,1]]},Hn[70]=Hn[100]=function(n){return[[1,n.rightbottom],[1,0],[n.bottomright,0],[0,n.lefttop],[0,1],[n.topleft,1]]},Hn[34]=function(n){return[pI(n),dI(n)]},Hn[35]=function(n){return[[1,n.righttop],[1,n.rightbottom],[n.bottomright,0],[n.bottomleft,0],[0,n.leftbottom],[0,n.lefttop],[n.topleft,1],[n.topright,1]]},Hn[136]=function(n){return[fI(n),hI(n)]},Hn[153]=function(n){return[uI(n),aI(n)]},Hn[102]=function(n){return[lI(n),cI(n)]},Hn[155]=function(n){return[[1,1],[1,n.righttop],[n.bottomleft,0],[0,0],[0,n.leftbottom],[n.topright,1]]},Hn[103]=function(n){return[[1,n.rightbottom],[1,0],[n.bottomright,0],[0,n.lefttop],[0,1],[n.topleft,1]]},Hn[152]=function(n){return[uI(n),hI(n)]},Hn[156]=function(n){return[[1,1],[1,n.righttop],[n.bottomright,0],[n.bottomleft,0],[0,n.leftbottom],[0,n.lefttop],[n.topright,1]]},Hn[137]=function(n){return[fI(n),aI(n)]},Hn[139]=function(n){return[[1,n.righttop],[1,n.rightbottom],[n.bottomleft,0],[0,0],[0,n.leftbottom],[n.topleft,1],[n.topright,1]]},Hn[98]=function(n){return[dI(n),cI(n)]},Hn[99]=function(n){return[[1,n.righttop],[1,n.rightbottom],[n.bottomright,0],[n.bottomleft,0],[0,n.lefttop],[0,1],[n.topleft,1]]},Hn[38]=function(n){return[lI(n),pI(n)]},Hn[39]=function(n){return[[1,n.rightbottom],[1,0],[n.bottomright,0],[0,n.leftbottom],[0,n.lefttop],[n.topleft,1],[n.topright,1]]};const v3=function(){function n(e){this.id=n.buildId(e),this.coordinates=e,this.innerEdges=[],this.outerEdges=[],this.outerEdgesSorted=!1}return n.buildId=function(e){return e.join(",")},n.prototype.removeInnerEdge=function(e){this.innerEdges=this.innerEdges.filter(function(t){return t.from.id!==e.from.id})},n.prototype.removeOuterEdge=function(e){this.outerEdges=this.outerEdges.filter(function(t){return t.to.id!==e.to.id})},n.prototype.addOuterEdge=function(e){this.outerEdges.push(e),this.outerEdgesSorted=!1},n.prototype.sortOuterEdges=function(){var e=this;this.outerEdgesSorted||(this.outerEdges.sort(function(t,r){var i=t.to,o=r.to;if(i.coordinates[0]-e.coordinates[0]>=0&&o.coordinates[0]-e.coordinates[0]<0)return 1;if(i.coordinates[0]-e.coordinates[0]<0&&o.coordinates[0]-e.coordinates[0]>=0)return-1;if(i.coordinates[0]-e.coordinates[0]==0&&o.coordinates[0]-e.coordinates[0]==0)return i.coordinates[1]-e.coordinates[1]>=0||o.coordinates[1]-e.coordinates[1]>=0?i.coordinates[1]-o.coordinates[1]:o.coordinates[1]-i.coordinates[1];var s=_I(e.coordinates,i.coordinates,o.coordinates);return s<0?1:s>0?-1:Math.pow(i.coordinates[0]-e.coordinates[0],2)+Math.pow(i.coordinates[1]-e.coordinates[1],2)-(Math.pow(o.coordinates[0]-e.coordinates[0],2)+Math.pow(o.coordinates[1]-e.coordinates[1],2))}),this.outerEdgesSorted=!0)},n.prototype.getOuterEdges=function(){return this.sortOuterEdges(),this.outerEdges},n.prototype.getOuterEdge=function(e){return this.sortOuterEdges(),this.outerEdges[e]},n.prototype.addInnerEdge=function(e){this.innerEdges.push(e)},n}(),ure=function(){function n(e,t){this.from=e,this.to=t,this.next=void 0,this.label=void 0,this.symetric=void 0,this.ring=void 0,this.from.addOuterEdge(this),this.to.addInnerEdge(this)}return n.prototype.getSymetric=function(){return this.symetric||(this.symetric=new n(this.to,this.from),this.symetric.symetric=this),this.symetric},n.prototype.deleteEdge=function(){this.from.removeOuterEdge(this),this.to.removeInnerEdge(this)},n.prototype.isEqual=function(e){return this.from.id===e.from.id&&this.to.id===e.to.id},n.prototype.toString=function(){return"Edge { "+this.from.id+" -> "+this.to.id+" }"},n.prototype.toLineString=function(){return function(n,e,t){if(void 0===t&&(t={}),n.length<2)throw new Error("coordinates must be an array of two or more positions");return Af({type:"LineString",coordinates:n},e,t)}([this.from.coordinates,this.to.coordinates])},n.prototype.compareTo=function(e){return _I(e.from.coordinates,e.to.coordinates,this.to.coordinates)},n}(),hre=function(){function n(){this.edges=[],this.polygon=void 0,this.envelope=void 0}return n.prototype.push=function(e){this.edges.push(e),this.polygon=this.envelope=void 0},n.prototype.get=function(e){return this.edges[e]},Object.defineProperty(n.prototype,"length",{get:function(){return this.edges.length},enumerable:!0,configurable:!0}),n.prototype.forEach=function(e){this.edges.forEach(e)},n.prototype.map=function(e){return this.edges.map(e)},n.prototype.some=function(e){return this.edges.some(e)},n.prototype.isValid=function(){return!0},n.prototype.isHole=function(){var e=this,t=this.edges.reduce(function(s,u,f){return u.from.coordinates[1]>e.edges[s].from.coordinates[1]&&(s=f),s},0),r=(0===t?this.length:t)-1,i=(t+1)%this.length,o=_I(this.edges[r].from.coordinates,this.edges[t].from.coordinates,this.edges[i].from.coordinates);return 0===o?this.edges[r].from.coordinates[0]>this.edges[i].from.coordinates[0]:o>0},n.prototype.toMultiPoint=function(){return function(n,e,t){return void 0===t&&(t={}),Af({type:"MultiPoint",coordinates:n},e,t)}(this.edges.map(function(e){return e.from.coordinates}))},n.prototype.toPolygon=function(){if(this.polygon)return this.polygon;var e=this.edges.map(function(t){return t.from.coordinates});return e.push(this.edges[0].from.coordinates),this.polygon=w0([e])},n.prototype.getEnvelope=function(){return this.envelope?this.envelope:this.envelope=function(n){return function(n,e){void 0===e&&(e={});var t=Number(n[0]),r=Number(n[1]),i=Number(n[2]),o=Number(n[3]);if(6===n.length)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");var s=[t,r];return w0([[s,[i,r],[i,o],[t,o],s]],e.properties,{bbox:n,id:e.id})}(XD(n))}(this.toPolygon())},n.findEdgeRingContaining=function(e,t){var i,o,r=e.getEnvelope();return t.forEach(function(s){var u=s.getEnvelope();if(o&&(i=o.getEnvelope()),!function(n,e){var t=n.geometry.coordinates[0].map(function(s){return s[0]}),r=n.geometry.coordinates[0].map(function(s){return s[1]}),i=e.geometry.coordinates[0].map(function(s){return s[0]}),o=e.geometry.coordinates[0].map(function(s){return s[1]});return Math.max.apply(null,t)===Math.max.apply(null,i)&&Math.max.apply(null,r)===Math.max.apply(null,o)&&Math.min.apply(null,t)===Math.min.apply(null,i)&&Math.min.apply(null,r)===Math.min.apply(null,o)}(u,r)&&y3(u,r)){for(var f=e.map(function(B){return B.from.coordinates}),g=void 0,v=function(B){s.some(function(z){return function(n,e){return n[0]===e[0]&&n[1]===e[1]}(B,z.from.coordinates)})||(g=B)},E=0,T=f;E<T.length;E++)v(T[E]);g&&s.inside(Bg(g))&&(!o||y3(i,u))&&(o=s)}}),o},n.prototype.inside=function(e){return Pz(e,this.toPolygon())},n}();function D3(n){for(var e=n,t=[];e.parent;)t.unshift(e),e=e.parent;return t}!function(){function n(){this.edges=[],this.nodes={}}n.fromGeoJson=function(e){!function(n){if(!n)throw new Error("No geojson passed");if("FeatureCollection"!==n.type&&"GeometryCollection"!==n.type&&"MultiLineString"!==n.type&&"LineString"!==n.type&&"Feature"!==n.type)throw new Error("Invalid input type '"+n.type+"'. Geojson must be FeatureCollection, GeometryCollection, LineString, MultiLineString or Feature")}(e);var t=new n;return fw(e,function(r){(function(n,e,t){if(!n)throw new Error("No feature passed");if(!n||"Feature"!==n.type||!n.geometry)throw new Error("Invalid input to "+t+", Feature with geometry required");if(!n.geometry||n.geometry.type!==e)throw new Error("Invalid input to "+t+": must be a "+e+", given "+n.geometry.type)})(r,"LineString","Graph::fromGeoJson"),function(n,e,t,r){var i=t;Ip(n,function(o,s,u,f,g){i=0===s?o:e(i,o)},void 0)}(r,function(i,o){if(i){var s=t.getNode(i),u=t.getNode(o);t.addEdge(s,u)}return o})}),t},n.prototype.getNode=function(e){var t=v3.buildId(e),r=this.nodes[t];return r||(r=this.nodes[t]=new v3(e)),r},n.prototype.addEdge=function(e,t){var r=new ure(e,t),i=r.getSymetric();this.edges.push(r),this.edges.push(i)},n.prototype.deleteDangles=function(){var e=this;Object.keys(this.nodes).map(function(t){return e.nodes[t]}).forEach(function(t){return e._removeIfDangle(t)})},n.prototype._removeIfDangle=function(e){var t=this;if(e.innerEdges.length<=1){var r=e.getOuterEdges().map(function(i){return i.to});this.removeNode(e),r.forEach(function(i){return t._removeIfDangle(i)})}},n.prototype.deleteCutEdges=function(){var e=this;this._computeNextCWEdges(),this._findLabeledEdgeRings(),this.edges.forEach(function(t){t.label===t.symetric.label&&(e.removeEdge(t.symetric),e.removeEdge(t))})},n.prototype._computeNextCWEdges=function(e){var t=this;void 0===e?Object.keys(this.nodes).forEach(function(r){return t._computeNextCWEdges(t.nodes[r])}):e.getOuterEdges().forEach(function(r,i){e.getOuterEdge((0===i?e.getOuterEdges().length:i)-1).symetric.next=r})},n.prototype._computeNextCCWEdges=function(e,t){for(var i,o,r=e.getOuterEdges(),s=r.length-1;s>=0;--s){var u=r[s],f=u.symetric,g=void 0,v=void 0;u.label===t&&(g=u),f.label===t&&(v=f),g&&v&&(v&&(o=v),g&&(o&&(o.next=g,o=void 0),i||(i=g)))}o&&(o.next=i)},n.prototype._findLabeledEdgeRings=function(){var e=[],t=0;return this.edges.forEach(function(r){if(!(r.label>=0)){e.push(r);var i=r;do{i.label=t,i=i.next}while(!r.isEqual(i));t++}}),e},n.prototype.getEdgeRings=function(){var e=this;this._computeNextCWEdges(),this.edges.forEach(function(r){r.label=void 0}),this._findLabeledEdgeRings().forEach(function(r){e._findIntersectionNodes(r).forEach(function(i){e._computeNextCCWEdges(i,r.label)})});var t=[];return this.edges.forEach(function(r){r.ring||t.push(e._findEdgeRing(r))}),t},n.prototype._findIntersectionNodes=function(e){var t=[],r=e,i=function(){var o=0;r.from.getOuterEdges().forEach(function(s){s.label===e.label&&++o}),o>1&&t.push(r.from),r=r.next};do{i()}while(!e.isEqual(r));return t},n.prototype._findEdgeRing=function(e){var t=e,r=new hre;do{r.push(t),t.ring=r,t=t.next}while(!e.isEqual(t));return r},n.prototype.removeNode=function(e){var t=this;e.getOuterEdges().forEach(function(r){return t.removeEdge(r)}),e.innerEdges.forEach(function(r){return t.removeEdge(r)}),delete this.nodes[e.id]},n.prototype.removeEdge=function(e){this.edges=this.edges.filter(function(t){return!t.isEqual(e)}),e.deleteEdge()}}(),Ue(9331),Ue(6882),Ue(3212);var xw={search:function(n,e,t,r){n.cleanDirty();var i=(r=r||{}).heuristic||xw.heuristics.manhattan,o=r.closest||!1,s=new I3(function(n){return n.f}),u=e;for(e.h=i(e,t),s.push(e);s.size()>0;){var f=s.pop();if(f===t)return D3(f);f.closed=!0;for(var g=n.neighbors(f),v=0,E=g.length;v<E;++v){var T=g[v];if(!T.closed&&!T.isWall()){var R=f.g+T.getCost(f),B=T.visited;(!B||R<T.g)&&(T.visited=!0,T.parent=f,T.h=T.h||i(T,t),T.g=R,T.f=T.g+T.h,n.markDirty(T),o&&(T.h<u.h||T.h===u.h&&T.g<u.g)&&(u=T),B?s.rescoreElement(T):s.push(T))}}}return o?D3(u):[]},heuristics:{manhattan:function(n,e){return Math.abs(e.x-n.x)+Math.abs(e.y-n.y)},diagonal:function(n,e){var r=Math.sqrt(2),i=Math.abs(e.x-n.x),o=Math.abs(e.y-n.y);return 1*(i+o)+(r-2)*Math.min(i,o)}},cleanNode:function(n){n.f=0,n.g=0,n.h=0,n.visited=!1,n.closed=!1,n.parent=null}};function V_(n,e){e=e||{},this.nodes=[],this.diagonal=!!e.diagonal,this.grid=[];for(var t=0;t<n.length;t++){this.grid[t]=[];for(var r=0,i=n[t];r<i.length;r++){var o=new bw(t,r,i[r]);this.grid[t][r]=o,this.nodes.push(o)}}this.init()}function bw(n,e,t){this.x=n,this.y=e,this.weight=t}function I3(n){this.content=[],this.scoreFunction=n}function vI(){this._=null}function ww(n){n.U=n.C=n.L=n.R=n.P=n.N=null}function T0(n,e){var t=e,r=e.R,i=t.U;i?i.L===t?i.L=r:i.R=r:n._=r,r.U=i,t.U=r,t.R=r.L,t.R&&(t.R.U=t),r.L=t}function D0(n,e){var t=e,r=e.L,i=t.U;i?i.L===t?i.L=r:i.R=r:n._=r,r.U=i,t.U=r,t.L=r.R,t.L&&(t.L.U=t),r.R=t}function A3(n){for(;n.L;)n=n.L;return n}V_.prototype.init=function(){this.dirtyNodes=[];for(var n=0;n<this.nodes.length;n++)xw.cleanNode(this.nodes[n])},V_.prototype.cleanDirty=function(){for(var n=0;n<this.dirtyNodes.length;n++)xw.cleanNode(this.dirtyNodes[n]);this.dirtyNodes=[]},V_.prototype.markDirty=function(n){this.dirtyNodes.push(n)},V_.prototype.neighbors=function(n){var e=[],t=n.x,r=n.y,i=this.grid;return i[t-1]&&i[t-1][r]&&e.push(i[t-1][r]),i[t+1]&&i[t+1][r]&&e.push(i[t+1][r]),i[t]&&i[t][r-1]&&e.push(i[t][r-1]),i[t]&&i[t][r+1]&&e.push(i[t][r+1]),this.diagonal&&(i[t-1]&&i[t-1][r-1]&&e.push(i[t-1][r-1]),i[t+1]&&i[t+1][r-1]&&e.push(i[t+1][r-1]),i[t-1]&&i[t-1][r+1]&&e.push(i[t-1][r+1]),i[t+1]&&i[t+1][r+1]&&e.push(i[t+1][r+1])),e},V_.prototype.toString=function(){for(var t,r,i,o,n=[],e=this.grid,s=0,u=e.length;s<u;s++){for(t=[],i=0,o=(r=e[s]).length;i<o;i++)t.push(r[i].weight);n.push(t.join(" "))}return n.join("\n")},bw.prototype.toString=function(){return"["+this.x+" "+this.y+"]"},bw.prototype.getCost=function(n){return n&&n.x!==this.x&&n.y!==this.y?1.41421*this.weight:this.weight},bw.prototype.isWall=function(){return 0===this.weight},I3.prototype={push:function(n){this.content.push(n),this.sinkDown(this.content.length-1)},pop:function(){var n=this.content[0],e=this.content.pop();return this.content.length>0&&(this.content[0]=e,this.bubbleUp(0)),n},remove:function(n){var e=this.content.indexOf(n),t=this.content.pop();e!==this.content.length-1&&(this.content[e]=t,this.scoreFunction(t)<this.scoreFunction(n)?this.sinkDown(e):this.bubbleUp(e))},size:function(){return this.content.length},rescoreElement:function(n){this.sinkDown(this.content.indexOf(n))},sinkDown:function(n){for(var e=this.content[n];n>0;){var t=(n+1>>1)-1,r=this.content[t];if(!(this.scoreFunction(e)<this.scoreFunction(r)))break;this.content[t]=e,this.content[n]=r,n=t}},bubbleUp:function(n){for(var e=this.content.length,t=this.content[n],r=this.scoreFunction(t);;){var u,i=n+1<<1,o=i-1,s=null;if(o<e&&(u=this.scoreFunction(this.content[o]))<r&&(s=o),i<e&&this.scoreFunction(this.content[i])<(null===s?r:u)&&(s=i),null===s)break;this.content[n]=this.content[s],this.content[s]=t,n=s}}},vI.prototype={constructor:vI,insert:function(n,e){var t,r,i;if(n){if(e.P=n,e.N=n.N,n.N&&(n.N.P=e),n.N=e,n.R){for(n=n.R;n.L;)n=n.L;n.L=e}else n.R=e;t=n}else this._?(n=A3(this._),e.P=null,e.N=n,n.P=n.L=e,t=n):(e.P=e.N=null,this._=e,t=null);for(e.L=e.R=null,e.U=t,e.C=!0,n=e;t&&t.C;)t===(r=t.U).L?(i=r.R)&&i.C?(t.C=i.C=!1,r.C=!0,n=r):(n===t.R&&(T0(this,t),t=(n=t).U),t.C=!1,r.C=!0,D0(this,r)):(i=r.L)&&i.C?(t.C=i.C=!1,r.C=!0,n=r):(n===t.L&&(D0(this,t),t=(n=t).U),t.C=!1,r.C=!0,T0(this,r)),t=n.U;this._.C=!1},remove:function(n){n.N&&(n.N.P=n.P),n.P&&(n.P.N=n.N),n.N=n.P=null;var t,o,s,e=n.U,r=n.L,i=n.R;if(o=r?i?A3(i):r:i,e?e.L===n?e.L=o:e.R=o:this._=o,r&&i?(s=o.C,o.C=n.C,o.L=r,r.U=o,o!==i?(e=o.U,o.U=n.U,e.L=n=o.R,o.R=i,i.U=o):(o.U=e,e=o,n=o.R)):(s=n.C,n=o),n&&(n.U=e),!s){if(n&&n.C)return void(n.C=!1);do{if(n===this._)break;if(n===e.L){if((t=e.R).C&&(t.C=!1,e.C=!0,T0(this,e),t=e.R),t.L&&t.L.C||t.R&&t.R.C){(!t.R||!t.R.C)&&(t.L.C=!1,t.C=!0,D0(this,t),t=e.R),t.C=e.C,e.C=t.R.C=!1,T0(this,e),n=this._;break}}else if((t=e.L).C&&(t.C=!1,e.C=!0,D0(this,e),t=e.L),t.L&&t.L.C||t.R&&t.R.C){(!t.L||!t.L.C)&&(t.R.C=!1,t.C=!0,T0(this,t),t=e.L),t.C=e.C,e.C=t.L.C=!1,D0(this,e),n=this._;break}t.C=!0,n=e,e=e.U}while(!n.C);n&&(n.C=!1)}}};const P3=vI;function I0(n,e,t,r){var i=[null,null],o=zu.push(i)-1;return i.left=n,i.right=e,t&&Ew(i,n,e,t),r&&Ew(i,e,n,r),$c[n.index].halfedges.push(o),$c[e.index].halfedges.push(o),i}function A0(n,e,t){var r=[e,t];return r.left=n,r}function Ew(n,e,t,r){n[0]||n[1]?n.left===t?n[1]=r:n[0]=r:(n[0]=r,n.left=e,n.right=t)}function Are(n,e,t,r,i){var z,o=n[0],s=n[1],u=o[0],f=o[1],E=0,T=1,R=s[0]-u,B=s[1]-f;if(z=e-u,R||!(z>0)){if(z/=R,R<0){if(z<E)return;z<T&&(T=z)}else if(R>0){if(z>T)return;z>E&&(E=z)}if(z=r-u,R||!(z<0)){if(z/=R,R<0){if(z>T)return;z>E&&(E=z)}else if(R>0){if(z<E)return;z<T&&(T=z)}if(z=t-f,B||!(z>0)){if(z/=B,B<0){if(z<E)return;z<T&&(T=z)}else if(B>0){if(z>T)return;z>E&&(E=z)}if(z=i-f,B||!(z<0)){if(z/=B,B<0){if(z>T)return;z>E&&(E=z)}else if(B>0){if(z<E)return;z<T&&(T=z)}return!(E>0)&&!(T<1)||(E>0&&(n[0]=[u+E*R,f+E*B]),T<1&&(n[1]=[u+T*R,f+T*B])),!0}}}}}function Pre(n,e,t,r,i){var o=n[1];if(o)return!0;var z,G,s=n[0],u=n.left,f=n.right,g=u[0],v=u[1],E=f[0],T=f[1],R=(g+E)/2;if(T===v){if(R<e||R>=r)return;if(g>E){if(s){if(s[1]>=i)return}else s=[R,t];o=[R,i]}else{if(s){if(s[1]<t)return}else s=[R,i];o=[R,t]}}else if(G=(v+T)/2-(z=(g-E)/(T-v))*R,z<-1||z>1)if(g>E){if(s){if(s[1]>=i)return}else s=[(t-G)/z,t];o=[(i-G)/z,i]}else{if(s){if(s[1]<t)return}else s=[(i-G)/z,i];o=[(t-G)/z,t]}else if(v<T){if(s){if(s[0]>=r)return}else s=[e,z*e+G];o=[r,z*r+G]}else{if(s){if(s[0]<e)return}else s=[r,z*r+G];o=[e,z*e+G]}return n[0]=s,n[1]=o,!0}function kre(n,e){var t=n.site,r=e.left,i=e.right;return t===i&&(i=r,r=t),i?Math.atan2(i[1]-r[1],i[0]-r[0]):(t===r?(r=e[1],i=e[0]):(r=e[0],i=e[1]),Math.atan2(r[0]-i[0],i[1]-r[1]))}function R3(n,e){return e[+(e.left!==n.site)]}function Lre(n,e){return e[+(e.left===n.site)]}var xI,O3=[];function Bre(){ww(this),this.x=this.y=this.arc=this.site=this.cy=null}function U_(n){var e=n.P,t=n.N;if(e&&t){var r=e.site,i=n.site,o=t.site;if(r!==o){var s=i[0],u=i[1],f=r[0]-s,g=r[1]-u,v=o[0]-s,E=o[1]-u,T=2*(f*E-g*v);if(!(T>=-Gre)){var R=f*f+g*g,B=v*v+E*E,z=(E*R-g*B)/T,G=(f*B-v*R)/T,W=O3.pop()||new Bre;W.arc=n,W.site=i,W.x=z+s,W.y=(W.cy=G+u)+Math.sqrt(z*z+G*G),n.circle=W;for(var H=null,ee=P0._;ee;)if(W.y<ee.y||W.y===ee.y&&W.x<=ee.x){if(!ee.L){H=ee.P;break}ee=ee.L}else{if(!ee.R){H=ee;break}ee=ee.R}P0.insert(H,W),H||(xI=W)}}}}function j_(n){var e=n.circle;e&&(e.P||(xI=e.N),P0.remove(e),O3.push(e),ww(e),n.circle=null)}var k3=[];function zre(){ww(this),this.edge=this.site=this.circle=null}function L3(n){var e=k3.pop()||new zre;return e.site=n,e}function bI(n){j_(n),G_.remove(n),k3.push(n),ww(n)}function Vre(n){var e=n.circle,t=e.x,r=e.cy,i=[t,r],o=n.P,s=n.N,u=[n];bI(n);for(var f=o;f.circle&&Math.abs(t-f.circle.x)<xa&&Math.abs(r-f.circle.cy)<xa;)o=f.P,u.unshift(f),bI(f),f=o;u.unshift(f),j_(f);for(var g=s;g.circle&&Math.abs(t-g.circle.x)<xa&&Math.abs(r-g.circle.cy)<xa;)s=g.N,u.push(g),bI(g),g=s;u.push(g),j_(g);var E,v=u.length;for(E=1;E<v;++E)Ew((g=u[E]).edge,(f=u[E-1]).site,g.site,i);(g=u[v-1]).edge=I0((f=u[0]).site,g.site,null,i),U_(f),U_(g)}function Ure(n){for(var r,i,o,s,e=n[0],t=n[1],u=G_._;u;)if((o=N3(u,t)-e)>xa)u=u.L;else{if(!((s=e-jre(u,t))>xa)){o>-xa?(r=u.P,i=u):s>-xa?(r=u,i=u.N):r=i=u;break}if(!u.R){r=u;break}u=u.R}!function(n){$c[n.index]={site:n,halfedges:[]}}(n);var f=L3(n);if(G_.insert(r,f),r||i){if(r===i)return j_(r),i=L3(r.site),G_.insert(f,i),f.edge=i.edge=I0(r.site,f.site),U_(r),void U_(i);if(!i)return void(f.edge=I0(r.site,f.site));j_(r),j_(i);var g=r.site,v=g[0],E=g[1],T=n[0]-v,R=n[1]-E,B=i.site,z=B[0]-v,G=B[1]-E,W=2*(T*G-R*z),H=T*T+R*R,ee=z*z+G*G,_e=[(G*H-R*ee)/W+v,(T*ee-z*H)/W+E];Ew(i.edge,g,B,_e),f.edge=I0(g,n,null,_e),i.edge=I0(n,B,null,_e),U_(r),U_(i)}}function N3(n,e){var t=n.site,r=t[0],i=t[1],o=i-e;if(!o)return r;var s=n.P;if(!s)return-1/0;var u=(t=s.site)[0],f=t[1],g=f-e;if(!g)return u;var v=u-r,E=1/o-1/g,T=v/g;return E?(-T+Math.sqrt(T*T-2*E*(v*v/(-2*g)-f+g/2+i-o/2)))/E+r:(r+u)/2}function jre(n,e){var t=n.N;if(t)return N3(t,e);var r=n.site;return r[1]===e?r[0]:1/0}var G_,$c,P0,zu,xa=1e-6,Gre=1e-12;function $re(n,e,t){return(n[0]-t[0])*(e[1]-n[1])-(n[0]-e[0])*(t[1]-n[1])}function Hre(n,e){return e[1]-n[1]||e[0]-n[0]}function F3(n,e){var r,i,o,t=n.sort(Hre).pop();for(zu=[],$c=new Array(n.length),G_=new P3,P0=new P3;;)if(o=xI,t&&(!o||t[1]<o.y||t[1]===o.y&&t[0]<o.x))(t[0]!==r||t[1]!==i)&&(Ure(t),r=t[0],i=t[1]),t=n.pop();else{if(!o)break;Vre(o.arc)}if(function(){for(var t,r,i,o,n=0,e=$c.length;n<e;++n)if((t=$c[n])&&(o=(r=t.halfedges).length)){var s=new Array(o),u=new Array(o);for(i=0;i<o;++i)s[i]=i,u[i]=kre(t,zu[r[i]]);for(s.sort(function(f,g){return u[g]-u[f]}),i=0;i<o;++i)u[i]=r[s[i]];for(i=0;i<o;++i)r[i]=u[i]}}(),e){var s=+e[0][0],u=+e[0][1],f=+e[1][0],g=+e[1][1];(function(n,e,t,r){for(var o,i=zu.length;i--;)Pre(o=zu[i],n,e,t,r)&&Are(o,n,e,t,r)&&(Math.abs(o[0][0]-o[1][0])>xa||Math.abs(o[0][1]-o[1][1])>xa)||delete zu[i]})(s,u,f,g),function(n,e,t,r){var o,s,u,f,g,v,E,T,R,B,z,G,i=$c.length,W=!0;for(o=0;o<i;++o)if(s=$c[o]){for(u=s.site,f=(g=s.halfedges).length;f--;)zu[g[f]]||g.splice(f,1);for(f=0,v=g.length;f<v;)z=(B=Lre(s,zu[g[f]]))[0],G=B[1],T=(E=R3(s,zu[g[++f%v]]))[0],R=E[1],(Math.abs(z-T)>xa||Math.abs(G-R)>xa)&&(g.splice(f,0,zu.push(A0(u,B,Math.abs(z-n)<xa&&r-G>xa?[n,Math.abs(T-n)<xa?R:r]:Math.abs(G-r)<xa&&t-z>xa?[Math.abs(R-r)<xa?T:t,r]:Math.abs(z-t)<xa&&G-e>xa?[t,Math.abs(T-t)<xa?R:e]:Math.abs(G-e)<xa&&z-n>xa?[Math.abs(R-e)<xa?T:n,e]:null))-1),++v);v&&(W=!1)}if(W){var H,ee,_e,ye=1/0;for(o=0,W=null;o<i;++o)(s=$c[o])&&(_e=(H=(u=s.site)[0]-n)*H+(ee=u[1]-e)*ee)<ye&&(ye=_e,W=s);if(W){var $e=[n,e],We=[n,r],rt=[t,r],ke=[t,e];W.halfedges.push(zu.push(A0(u=W.site,$e,We))-1,zu.push(A0(u,We,rt))-1,zu.push(A0(u,rt,ke))-1,zu.push(A0(u,ke,$e))-1)}}for(o=0;o<i;++o)(s=$c[o])&&(s.halfedges.length||delete $c[o])}(s,u,f,g)}this.edges=zu,this.cells=$c,G_=P0=zu=$c=null}function Ap(){return new Cw}function Cw(){this.reset()}F3.prototype={constructor:F3,polygons:function(){var n=this.edges;return this.cells.map(function(e){var t=e.halfedges.map(function(r){return R3(e,n[r])});return t.data=e.site.data,t})},triangles:function(){var n=[],e=this.edges;return this.cells.forEach(function(t,r){if(u=(o=t.halfedges).length)for(var o,u,f,i=t.site,s=-1,g=e[o[u-1]],v=g.left===i?g.right:g.left;++s<u;)f=v,v=(g=e[o[s]]).left===i?g.right:g.left,f&&v&&r<f.index&&r<v.index&&$re(i,f,v)<0&&n.push([i.data,f.data,v.data])}),n},links:function(){return this.edges.filter(function(n){return n.right}).map(function(n){return{source:n.left.data,target:n.right.data}})},find:function(n,e,t){for(var i,u,r=this,o=r._found||0,s=r.cells.length;!(u=r.cells[o]);)if(++o>=s)return null;var f=n-u.site[0],g=e-u.site[1],v=f*f+g*g;do{u=r.cells[i=o],o=null,u.halfedges.forEach(function(E){var T=r.edges[E],R=T.left;if(R!==u.site&&R||(R=T.right)){var B=n-R[0],z=e-R[1],G=B*B+z*z;G<v&&(v=G,o=R.index)}})}while(null!==o);return r._found=i,null==t||v<=t*t?u.site:null}},Ue(171),Ue(7299),Cw.prototype={constructor:Cw,reset:function(){this.s=this.t=0},add:function(n){X3(Sw,n,this.t),X3(this,Sw.s,this.s),this.s?this.t+=Sw.t:this.s=Sw.t},valueOf:function(){return this.s}};var Sw=new Cw;function X3(n,e,t){var r=n.s=e+t,i=r-e;n.t=e-(r-i)+(t-i)}var n,Fa=Math.PI,Sc=Fa/2,$_=2*Fa,ha=Fa/180,R0=(Math,Math.atan),H_=Math.atan2,Vo=Math.cos,Ji=(Math,Math,Math,Math,Math,Math.sin),Pf=(Math,Math.sqrt);Math;function q_(n){return n>1?Sc:n<-1?-Sc:Math.asin(n)}function LI(n,e){return[n>Fa?n-$_:n<-Fa?n+$_:n,e]}function bV(n,e){return n<e?-1:n>e?1:n>=e?0:NaN}Ap(),Ap(),Ap(),LI.invert=LI,1===(n=bV).length&&(n=function(n){return function(e,t){return bV(n(e),t)}}(n)),Math.sqrt(50),Math.sqrt(10),Math.sqrt(2);Ap();function eA(){}function WV(n){return function(e,t){var r=Vo(e),i=Vo(t),o=n(r*i);return[o*i*Ji(e),o*Ji(t)]}}function j0(n){return function(e,t){var r=Pf(e*e+t*t),i=n(r),o=Ji(i),s=Vo(i);return[H_(e*o,r*s),q_(r&&t*o/r)]}}function nA(n,e){return[n,e]}Ap(),Ap(),Ap(),Ap(),eA.prototype={constructor:eA,point:function(n,e){this.stream.point(n,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}},Vo(30*ha),WV(function(n){return Pf(2/(1+n))}).invert=j0(function(n){return 2*q_(n/2)}),WV(function(n){return(n=function(n){return n>1?0:n<-1?Fa:Math.acos(n)}(n))&&n/Ji(n)}).invert=j0(function(n){return n}),nA.invert=nA,j0(R0),j0(q_),j0(function(n){return 2*R0(n)});let _oe=(()=>{class n{constructor(){}ngOnInit(){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=ao({type:n,selectors:[["app-plant-details-modal"]],decls:42,vars:0,consts:[["id","plant-detail-modal","draggable","true",1,"modal"],[1,"close"],[1,"modal-content-flex"],["id","plant-detail-pict-container"],["id","plant-detail-data",2,"width","250px","height","400px","padding","8px","font-size","9px"],["id","plant-detail-metrics-button",1,"plant-button"],["id","plant-detail-environ-button",1,"plant-button"]],template:function(t,r){1&t&&(cn(0,"div",0),cn(1,"span",1),Zn(2,"\xd7"),hn(),cn(3,"div",2),Ar(4,"div",3),cn(5,"div",4),cn(6,"h3"),Zn(7,"Plant Data"),hn(),cn(8,"p"),Zn(9,"Id:"),hn(),cn(10,"p"),Zn(11,"Lot-Sublot:"),hn(),cn(12,"p"),Zn(13,"Commodity Type:"),hn(),cn(14,"p"),Zn(15,"Seed Type:"),hn(),cn(16,"p"),Zn(17,"Wet Date"),hn(),cn(18,"p"),Zn(19,"Measure Date:"),hn(),cn(20,"h3"),Zn(21,"Metrics "),cn(22,"button",5),Zn(23,"Show History"),hn(),hn(),cn(24,"p"),Zn(25,"Size:"),hn(),cn(26,"p"),Zn(27,"Health Index:"),hn(),cn(28,"p"),Zn(29,"Irregular spacing:"),hn(),cn(30,"h3"),Zn(31,"Environment "),cn(32,"button",6),Zn(33,"Show History"),hn(),hn(),cn(34,"p"),Zn(35,"Soil Moisture Content:"),hn(),cn(36,"p"),Zn(37,"Infestation:"),hn(),cn(38,"p"),Zn(39,"Disease:"),hn(),cn(40,"p"),Zn(41,"Chemical Applications:"),hn(),hn(),hn(),hn())},styles:[""]}),n})();var yoe={url:"",deserializer:function(n){return JSON.parse(n.data)},serializer:function(n){return JSON.stringify(n)}},xoe=function(n){function e(t,r){var i=n.call(this)||this;if(i._socket=null,t instanceof Ie)i.destination=r,i.source=t;else{var o=i._config=pt({},yoe);if(i._output=new wt,"string"==typeof t)o.url=t;else for(var s in t)t.hasOwnProperty(s)&&(o[s]=t[s]);if(!o.WebSocketCtor&&WebSocket)o.WebSocketCtor=WebSocket;else if(!o.WebSocketCtor)throw new Error("no WebSocket constructor can be found");i.destination=new ab}return i}return Be(e,n),e.prototype.lift=function(t){var r=new e(this._config,this.destination);return r.operator=t,r.source=this,r},e.prototype._resetState=function(){this._socket=null,this.source||(this.destination=new ab),this._output=new wt},e.prototype.multiplex=function(t,r,i){var o=this;return new Ie(function(s){try{o.next(t())}catch(f){s.error(f)}var u=o.subscribe(function(f){try{i(f)&&s.next(f)}catch(g){s.error(g)}},function(f){return s.error(f)},function(){return s.complete()});return function(){try{o.next(r())}catch(f){s.error(f)}u.unsubscribe()}})},e.prototype._connectSocket=function(){var t=this,r=this._config,i=r.WebSocketCtor,o=r.protocol,s=r.url,u=r.binaryType,f=this._output,g=null;try{g=o?new i(s,o):new i(s),this._socket=g,u&&(this._socket.binaryType=u)}catch(E){return void f.error(E)}var v=new Ce(function(){t._socket=null,g&&1===g.readyState&&g.close()});g.onopen=function(E){if(!t._socket)return g.close(),void t._resetState();var R=t._config.openObserver;R&&R.next(E);var B=t.destination;t.destination=rn.create(function(z){if(1===g.readyState)try{g.send((0,t._config.serializer)(z))}catch(W){t.destination.error(W)}},function(z){var G=t._config.closingObserver;G&&G.next(void 0),z&&z.code?g.close(z.code,z.reason):f.error(new TypeError("WebSocketSubject.error must be called with an object with an error code, and an optional reason: { code: number, reason: string }")),t._resetState()},function(){var z=t._config.closingObserver;z&&z.next(void 0),g.close(),t._resetState()}),B&&B instanceof ab&&v.add(B.subscribe(t.destination))},g.onerror=function(E){t._resetState(),f.error(E)},g.onclose=function(E){t._resetState();var T=t._config.closeObserver;T&&T.next(E),E.wasClean?f.complete():f.error(E)},g.onmessage=function(E){try{f.next((0,t._config.deserializer)(E))}catch(R){f.error(R)}}},e.prototype._subscribe=function(t){var r=this,i=this.source;return i?i.subscribe(t):(this._socket||this._connectSocket(),this._output.subscribe(t),t.add(function(){var o=r._socket;0===r._output.observers.length&&(o&&(1===o.readyState||0===o.readyState)&&o.close(),r._resetState())}),t)},e.prototype.unsubscribe=function(){var t=this._socket;t&&(1===t.readyState||0===t.readyState)&&t.close(),this._resetState(),n.prototype.unsubscribe.call(this)},e}(Qn);let o4=(()=>{class n{constructor(){this.wsSubject=function(n){return new xoe(n)}(`${zl_ws_url}`),this.cids=["2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20"],this.wsSubject.next({cultivator_ids:this.cids})}getWebsocket(){return this.wsSubject}closeWebsocket(){this.wsSubject.complete()}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Dn({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function woe(n,e){if(1&n&&(cn(0,"div",19),cn(1,"div",20),cn(2,"label"),Zn(3,"0"),hn(),Ar(4,"input",21),cn(5,"label"),Zn(6,"30"),hn(),Ar(7,"br"),cn(8,"p"),Zn(9),bx(10,"async"),hn(),hn(),hn()),2&n){const t=vf(2);$o(4),va("formControl",t.plant_size),$o(5),dg("Heatmap will show the cluster of plants the size of which is greater than ",wx(10,2,t.plant_size.valueChanges)," cm.")}}function Eoe(n,e){if(1&n&&(cn(0,"div",22),cn(1,"div",23),cn(2,"label"),Zn(3,"0"),hn(),Ar(4,"input",24),cn(5,"label"),Zn(6,"100"),hn(),Ar(7,"br"),cn(8,"p"),Zn(9),bx(10,"async"),hn(),hn(),hn()),2&n){const t=vf(2);$o(4),va("formControl",t.plant_hidx),$o(5),dg("Heatmap will show the cluster of plants the health index of which is greater than ",wx(10,2,t.plant_hidx.valueChanges),".")}}function Coe(n,e){1&n&&(cn(0,"div",25),Zn(1," The layer is not ready yet. "),hn())}function Soe(n,e){if(1&n){const t=l();cn(0,"div",12),cn(1,"div",4),Zn(2," Choose and Configure Heatmap "),hn(),cn(3,"span",13),Xs("click",function(i){return _(t),vf().onSelectMenuTab(i)}),Zn(4,"Size"),hn(),cn(5,"span",14),Xs("click",function(i){return _(t),vf().onSelectMenuTab(i)}),Zn(6,"Health"),hn(),cn(7,"span",15),Xs("click",function(i){return _(t),vf().onSelectMenuTab(i)}),Zn(8,"EDTH"),hn(),Qh(9,woe,11,4,"div",16),Qh(10,Eoe,11,4,"div",17),Qh(11,Coe,2,0,"div",18),hn()}if(2&n){const t=vf();$o(9),va("ngIf",0==t.heatmap_tab_selected_idx),$o(1),va("ngIf",1==t.heatmap_tab_selected_idx),$o(1),va("ngIf",2==t.heatmap_tab_selected_idx)}}function Moe(n,e){1&n&&(cn(0,"div",26),Ar(1,"span",27),Ar(2,"span",28),Ar(3,"span",29),Ar(4,"span",30),Ar(5,"span",31),Ar(6,"br"),cn(7,"span",32),Zn(8,"10"),hn(),cn(9,"span",32),Zn(10,"30"),hn(),cn(11,"span",32),Zn(12,"50"),hn(),cn(13,"span",32),Zn(14,"70"),hn(),cn(15,"span",32),Zn(16,"90"),hn(),Ar(17,"br"),cn(18,"span",33),Zn(19,"Crop Health Index (0-100)"),hn(),hn())}let s4=(()=>{class n{constructor(t,r,i){this.http=t,this.websocketservice=r,this.dialogservice=i,rl.accessToken=zl_mapbox_accessToken,this.center=new rl.LngLat(-121.657,36.636),this.bounds=new rl.LngLatBounds([-125,28,-64,51]),this.zoom_threshold=20,this.zoom_over_threshold=!1,this.cids=["2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20"],this.cultivator_trace_geojson=this.initCultivatorTraceGeojson(),this.cultivator_pos_geojson=this.initCultivatorPosGeojson(),this.plant_status_geojson=this.initPlantStatusGeojson(),this.lot_boundary_geojson=this.initLotBoundaryGeojson(),this.soil_condition_geojson=this.initSoilConditionGeojson(),this.heatmap_tabs=document.getElementsByClassName("menu-tab"),this.heatmap_tab_selected_idx=0,this.plant_size=new Mp(0,{updateOn:"change"}),this.plant_hidx=new Mp(0,{updateOn:"change"}),this.wsData=this.websocketservice.getWebsocket(),this.eventEmitter=new Ro}ngOnInit(){this.addInitialDataToCultivatorTraceGeojson(),this.addInitialDataToCultivatorPosGeojson()}ngAfterViewInit(){let t=new rl.Map({container:"map",style:"mapbox://styles/stout/ckrdmp6tk2mud18mkqpzfjqr8",center:this.center,maxBounds:this.bounds,zoom:14,minZoom:4,doubleClickZoom:!1});t.on("load",()=>{t.addControl(new rl.NavigationControl,"top-left"),t.addControl(new rl.ScaleControl({maxWidth:200,unit:"imperial"}),"bottom-left"),this.cultivator_trace_geojson&&t.addSource("cultivator-trace",{type:"geojson",data:this.cultivator_trace_geojson}),t.addSource("cultivator-pos",{type:"geojson",data:this.cultivator_pos_geojson}),t.addSource("lots",{type:"geojson",data:this.lot_boundary_geojson}),t.addSource("soil-condition",{type:"geojson",data:this.soil_condition_geojson}),t.addLayer({id:"cultivator-trace-line",type:"line",source:"cultivator-trace",layout:{visibility:"visible","line-join":"round","line-cap":"round"},paint:{"line-color":"#ff8000","line-width":["interpolate",["exponential",2],["zoom"],14,7,22,7],"line-opacity":["interpolate",["linear"],["zoom"],14,.4,22,1]}}),t.addLayer({id:"cultivator-pos-circle",type:"circle",source:"cultivator-pos",layout:{visibility:"visible"},paint:{"circle-radius":12,"circle-color":["step",["get","age_sec"],"rgb(255,0,0)",60,"rgb(102,0,51)",240,"rgb(51,0,26)",480,"rgb(0,0,0)"],"circle-opacity":1,"circle-stroke-color":"#ffffff","circle-stroke-width":3}}),t.addLayer({id:"cultivator-pos-symbol",type:"symbol",source:"cultivator-pos",layout:{visibility:"visible","text-field":["get","cid"],"text-size":14},paint:{"text-color":"#fff"}}),t.addLayer({id:"lots-fill",type:"fill",source:"lots",layout:{},paint:{"fill-color":"rgb(47,247,213)","fill-opacity":0}}),t.addLayer({id:"lots-line",type:"line",source:"lots",layout:{},paint:{"line-color":"rgb(255,0,0)","line-width":1}}),t.addLayer({id:"soil-condition-fill",type:"fill",source:"soil-condition",layout:{visibility:"none"},paint:{"fill-color":["step",["get","vwc"],"rgb(215,25,28)",20,"rgb(253,174,97)",40,"rgb(255,255,191)",60,"rgb(171,221,164)",80,"rgb(43,131,186)"],"fill-opacity":.5}}),t.addLayer({id:"plant-size-heat",type:"heatmap",source:"composite","source-layer":"20210630-Sp-1-2-plants-layer",maxzoom:this.zoom_threshold,layout:{visibility:"visible"},paint:{"heatmap-weight":["interpolate",["linear"],["get","diameter_cm"],0,0,30,1],"heatmap-intensity":["interpolate",["linear"],["zoom"],14,1,this.zoom_threshold,3],"heatmap-radius":["interpolate",["linear"],["zoom"],14,3,this.zoom_threshold,15],"heatmap-color":["interpolate",["linear"],["heatmap-density"],0,"rgba(236,222,239,0)",.2,"rgb(208,209,230)",.4,"rgb(166,189,219)",.6,"rgb(103,169,207)",.8,"rgb(28,144,153)"]}}),t.addLayer({id:"plant-hidx-heat",type:"heatmap",source:"composite","source-layer":"20210630-Sp-1-2-plants-layer",maxzoom:this.zoom_threshold,layout:{visibility:"none"},paint:{"heatmap-weight":["interpolate",["linear"],["get","health_index"],0,0,100,1],"heatmap-intensity":["interpolate",["linear"],["zoom"],14,1,this.zoom_threshold,3],"heatmap-radius":["interpolate",["linear"],["zoom"],14,3,this.zoom_threshold,15],"heatmap-color":["interpolate",["linear"],["heatmap-density"],0,"rgba(236,222,239,0)",.2,"rgb(208,209,230)",.4,"rgb(166,189,219)",.6,"rgb(103,169,207)",.8,"rgb(28,144,153)"]}}),t.addLayer({id:"plants-circle",type:"circle",source:"composite","source-layer":"20210630-Sp-1-2-plants-layer",minzoom:this.zoom_threshold,layout:{visibility:"visible"},paint:{"circle-radius":["interpolate",["linear"],["zoom"],this.zoom_threshold,["interpolate",["linear"],["get","diameter_cm"],1,1,30,5],22,["interpolate",["linear"],["get","diameter_cm"],1,5,30,10]],"circle-color":["step",["get","health_index"],"#ff99ff",20,"#cc99ff",40,"#99ccff",60,"#3399ff",80,"#0099ff"],"circle-opacity":.5,"circle-stroke-color":["case",["==",["get","irregular"],"false"],"#003399",["==",["get","irregular"],"true"],"#ff0000","#000"],"circle-stroke-width":3}}),t.setLayoutProperty("20210630-sp-1-2-plants-layer","visibility","none"),t.setLayoutProperty("stout-20210701-spreckels-1-2-tileset","visibility","none"),t.setLayoutProperty("stout-20210701-spreckels-1-3-tileset","visibility","none"),t.setLayoutProperty("stout-20210701-harris-1-tileset","visibility","none"),t.setLayoutProperty("stout-20210702-stout-tileset","visibility","none")}),t.on("click","lots-fill",r=>{if(r.features){let i=r.features[0],o=jz(i).geometry.coordinates;(new rl.Popup).setLngLat([o[0],o[1]]).setHTML(`<b>Lot:</b> ${i.properties?i.properties.name:null}`).addTo(t)}}),t.on("dblclick","lots-fill",r=>{if(r.features){let o=XD(r.features[0]);t.getZoom()<this.zoom_threshold&&t.fitBounds([[o[0],o[1]],[o[2],o[3]]],{padding:40})}}),t.on("click","cultivator-pos-circle",r=>{let i=[new rl.Point(r.point.x-8,r.point.y-8),new rl.Point(r.point.x+8,r.point.y+8)],o=t.queryRenderedFeatures([i[0],i[1]])[0];t.flyTo({center:[o.geometry.coordinates[0],o.geometry.coordinates[1]],zoom:19})}),t.on("click","plants-circle",r=>{if(r.features){let i=r.features[0];(new rl.Popup).setLngLat([i.geometry.coordinates[0],i.geometry.coordinates[1]]).setHTML(`<b>Commodity:</b> ${i.properties?i.properties.commodity_type:null} <br>\n\t\t\t\t\t\t\t  <b>Size:</b> ${i.properties?i.properties.diameter_cm:null} <br>\n\t\t\t\t\t\t\t  <b>Health:</b> ${i.properties?i.properties.health_index:null} <br>\n\t\t\t\t\t\t\t  <b>Irregular:</b> ${i.properties?i.properties.irregular:null}`).addTo(t)}}),t.on("dblclick","plants-circle",r=>{r.originalEvent.stopPropagation();let i=[new rl.Point(r.point.x-8,r.point.y-8),new rl.Point(r.point.x+8,r.point.y+8)],o=t.queryRenderedFeatures([i[0],i[1]])[0];o.properties&&this.displayPlantDetails(o.properties.id)}),t.on("zoom",()=>{this.zoom_over_threshold=t.getZoom()>=this.zoom_threshold}),this.wsData.subscribe(r=>{let i=this.cids.indexOf(r.cid);this.cultivator_trace_geojson.features[i].geometry.coordinates.push([r.lon,r.lat]),this.cultivator_pos_geojson.features[i].geometry.coordinates=[r.lon,r.lat],this.cultivator_pos_geojson.features[i].properties.age_sec=0,t.getSource("cultivator-trace").setData(this.cultivator_trace_geojson),t.getSource("cultivator-pos").setData(this.cultivator_pos_geojson)}),this.plant_size.valueChanges.subscribe(r=>{t.setFilter("plant-size-heat",[">=",["number",["get","diameter_cm"]],r])}),this.plant_hidx.valueChanges.subscribe(r=>{t.setFilter("plant-hidx-heat",[">=",["number",["get","health_index"]],r])}),this.eventEmitter.subscribe(r=>{switch(r){case"cultivators-visible":t.setLayoutProperty("cultivator-trace-line","visibility","visible"),t.setLayoutProperty("cultivator-pos-circle","visibility","visible"),t.setLayoutProperty("cultivator-pos-symbol","visibility","visible");break;case"cultivators-invisible":t.setLayoutProperty("cultivator-trace-line","visibility","none"),t.setLayoutProperty("cultivator-pos-circle","visibility","none"),t.setLayoutProperty("cultivator-pos-symbol","visibility","none");break;case"drone-images-visible":t.setLayoutProperty("stout-20210701-spreckels-1-2-tileset","visibility","visible"),t.setLayoutProperty("stout-20210701-spreckels-1-3-tileset","visibility","visible"),t.setLayoutProperty("stout-20210701-harris-1-tileset","visibility","visible"),t.setLayoutProperty("stout-20210702-stout-tileset","visibility","visible"),t.moveLayer("plants-circle");break;case"drone-images-invisible":t.setLayoutProperty("stout-20210701-spreckels-1-2-tileset","visibility","none"),t.setLayoutProperty("stout-20210701-spreckels-1-3-tileset","visibility","none"),t.setLayoutProperty("stout-20210701-harris-1-tileset","visibility","none"),t.setLayoutProperty("stout-20210702-stout-tileset","visibility","none");break;case"soil-condition-visible":t.setLayoutProperty("soil-condition-fill","visibility","visible");break;case"soil-condition-invisible":t.setLayoutProperty("soil-condition-fill","visibility","none");break;case"plant-size-heat":t.setLayoutProperty("plant-size-heat","visibility","visible"),t.setLayoutProperty("plant-hidx-heat","visibility","none");break;case"plant-hidx-heat":t.setLayoutProperty("plant-hidx-heat","visibility","visible"),t.setLayoutProperty("plant-size-heat","visibility","none")}})}ngOnDestroy(){}onSelectMenuItem(t){if(t.preventDefault(),t.stopPropagation(),t.target instanceof Element){switch(t.target.textContent){case"Cultivators":t.target.classList.contains("selected")?this.eventEmitter.emit("cultivators-invisible"):this.eventEmitter.emit("cultivators-visible");break;case"Drone Images":t.target.classList.contains("selected")?this.eventEmitter.emit("drone-images-invisible"):this.eventEmitter.emit("drone-images-visible");break;case"Soil Condition":t.target.classList.contains("selected")?this.eventEmitter.emit("soil-condition-invisible"):this.eventEmitter.emit("soil-condition-visible")}t.target.classList.toggle("selected")}}onSelectMenuTab(t){if(t.preventDefault(),t.stopPropagation(),t.target instanceof Element){switch(t.target.textContent){case"Size":this.heatmap_tab_selected_idx=0,this.eventEmitter.emit("plant-size-heat");break;case"Health":this.heatmap_tab_selected_idx=1,this.eventEmitter.emit("plant-hidx-heat");break;case"EDTH":this.heatmap_tab_selected_idx=2,this.eventEmitter.emit("plant-edth-heat")}for(let r=0;r<this.heatmap_tabs.length;r++)r==this.heatmap_tab_selected_idx?this.heatmap_tabs[r].classList.add("selected"):this.heatmap_tabs[r].classList.remove("selected")}}initCultivatorTraceGeojson(){let t={type:"FeatureCollection",features:[]};for(let r of this.cids){let o=JSON.parse(`\n\t\t\t\t{ \n\t\t\t\t\t"type": "Feature",\n\t\t\t\t\t"properties": {\n\t\t\t\t\t\t"cid": ${r}\n\t\t\t\t\t},\n\t\t\t\t\t"geometry": {\n\t\t\t\t\t\t"coordinates": [],\n\t\t\t\t\t\t"type": "LineString"\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t`);t.features.push(o)}return t}initCultivatorPosGeojson(){let t={type:"FeatureCollection",features:[]};for(let r of this.cids){let o=JSON.parse(`\n\t\t\t\t{ \n\t\t\t\t\t"type": "Feature",\n\t\t\t\t\t"properties": {\n\t\t\t\t\t\t"cid": ${r},\n\t\t\t\t\t\t"age_sec": 31536000\n\t\t\t\t\t},\n\t\t\t\t\t"geometry": {\n\t\t\t\t\t\t"coordinates": [],\n\t\t\t\t\t\t"type": "Point"\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t`);t.features.push(o)}return t}initPlantStatusGeojson(){return{type:"FeatureCollection",features:[]}}initLotBoundaryGeojson(){return{type:"FeatureCollection",features:[]}}initSoilConditionGeojson(){return{type:"FeatureCollection",features:[]}}addInitialDataToCultivatorTraceGeojson(){for(let t of this.cids){let r=this.cids.indexOf(t);this.http.get(`${zl_api_url}/cultivators/${t}/trace`).pipe(Cc()).subscribe(i=>{i&&(this.cultivator_trace_geojson.features[r].geometry.coordinates=i)})}}addInitialDataToCultivatorPosGeojson(){for(let t of this.cids){let r=this.cids.indexOf(t);this.http.get(`${zl_api_url}/cultivators/${t}/pos`).pipe(Cc()).subscribe(i=>{if(i){let o=(new Date).getTime()-(new Date(i.ts).getTime()-6e4*(new Date).getTimezoneOffset());this.cultivator_pos_geojson.features[r].geometry.coordinates=[i.lon,i.lat],this.cultivator_pos_geojson.features[r].properties.age_sec=o/1e3}})}}displayPlantDetails(t){let r=new Nb;r.disableClose=!0,r.autoFocus=!0,this.dialogservice.open(_oe,r)}}return n.\u0275fac=function(t){return new(t||n)(Mt(c0),Mt(o4),Mt(t0))},n.\u0275cmp=ao({type:n,selectors:[["app-overview-map"]],decls:19,vars:2,consts:[["id","map"],["map",""],["id","map-menu"],["id","overlay-selection-menu"],[2,"padding","6px","font-size","14px"],["id","cultivators",1,"menu-item","selected",3,"click"],["id","drone-images",1,"menu-item",3,"click"],["id","application",1,"menu-item",3,"click"],["id","soil-condition",1,"menu-item",3,"click"],["id","scouting",1,"menu-item",3,"click"],["id","heatmap-config-menu",4,"ngIf"],["id","circle-color-legend",4,"ngIf"],["id","heatmap-config-menu"],["id","size-heat",1,"menu-tab","selected",3,"click"],["id","hidx-heat",1,"menu-tab",3,"click"],["id","edth-heat",1,"menu-tab",3,"click"],["id","size-heat-cfg","class","menu-tab-card",4,"ngIf"],["id","hidx-heat-cfg","class","menu-tab-card",4,"ngIf"],["id","edth-heat-cfg","class","menu-tab-card",4,"ngIf"],["id","size-heat-cfg",1,"menu-tab-card"],[2,"margin","24px","text-align","center"],["type","range","min","0","max","30","step","1",3,"formControl"],["id","hidx-heat-cfg",1,"menu-tab-card"],[2,"margin","18px","text-align","center"],["type","range","min","0","max","100","step","10",3,"formControl"],["id","edth-heat-cfg",1,"menu-tab-card"],["id","circle-color-legend"],[1,"legend-key",2,"background-color","#ff99ff"],[1,"legend-key",2,"background-color","#cc99ff"],[1,"legend-key",2,"background-color","#99ccff"],[1,"legend-key",2,"background-color","#3399ff"],[1,"legend-key",2,"background-color","#0099ff"],[1,"legend-label"],[1,"legend-desc"]],template:function(t,r){1&t&&(Ar(0,"div",0,1),cn(2,"div",2),cn(3,"div",3),cn(4,"div",4),Zn(5," Select|Deselect Overlay Layers "),hn(),cn(6,"span",5),Xs("click",function(o){return r.onSelectMenuItem(o)}),Zn(7,"Cultivators"),hn(),cn(8,"span",6),Xs("click",function(o){return r.onSelectMenuItem(o)}),Zn(9,"Drone Images"),hn(),cn(10,"span",7),Xs("click",function(o){return r.onSelectMenuItem(o)}),Zn(11,"Applications"),hn(),cn(12,"span",8),Xs("click",function(o){return r.onSelectMenuItem(o)}),Zn(13,"Soil Condition"),hn(),cn(14,"span",9),Xs("click",function(o){return r.onSelectMenuItem(o)}),Zn(15,"Scouting Data"),hn(),hn(),Ar(16,"hr"),Qh(17,Soe,12,3,"div",10),hn(),Qh(18,Moe,20,0,"div",11)),2&t&&($o(17),va("ngIf",!r.zoom_over_threshold),$o(1),va("ngIf",r.zoom_over_threshold))},directives:[DM,oD,R_,Bb,aD],pipes:[PM],styles:["#map[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%}#map-menu[_ngcontent-%COMP%]{position:fixed;right:24px;top:24px;width:240px;padding:8px;background:#fff;border:1px solid rgba(0,0,0,.4);font-size:12px;z-index:1}#map-menu[_ngcontent-%COMP%]   .menu-item[_ngcontent-%COMP%]{display:block;padding:6px 0;background-color:#99f;color:#fff;border:solid 1px #fff;text-align:center;font-size:14px;text-decoration:none}#map-menu[_ngcontent-%COMP%]   .menu-tab[_ngcontent-%COMP%]{display:inline-block;width:60px;padding:6px 0;background-color:#99f;color:#fff;border:solid 1px #fff;text-align:center;font-size:14px;text-decoration:none}#map-menu[_ngcontent-%COMP%]   .menu-tab-card[_ngcontent-%COMP%]{height:300px;padding:8px;border:1px solid #8000ff}#map-menu[_ngcontent-%COMP%]   .selected[_ngcontent-%COMP%]{background-color:#8000ff;color:#fff}#circle-color-legend[_ngcontent-%COMP%]{position:fixed;right:24px;bottom:24px;padding:8px;background-color:#fff;z-index:1}#circle-color-legend[_ngcontent-%COMP%]   .legend-key[_ngcontent-%COMP%], .legend-label[_ngcontent-%COMP%]{display:block;width:48px;height:14px;float:left;text-align:center;font-size:12px}#circle-color-legend[_ngcontent-%COMP%]   .legend-desc[_ngcontent-%COMP%]{display:block;height:14px;text-align:center;font-size:12px}.mapboxgl-popup[_ngcontent-%COMP%]{max-width:200px}"]}),n})();function Kw(n,e){var t="object"==typeof e;return new Promise(function(r,i){var o=new hi({next:function(s){r(s),o.unsubscribe()},error:i,complete:function(){t?r(e.defaultValue):i(new h0)}});n.subscribe(o)})}const a4="undefined"==typeof window?function(n){return n()}:window.requestAnimationFrame;function l4(n,e,t){const r=t||(s=>Array.prototype.slice.call(s));let i=!1,o=[];return function(...s){o=r(s),i||(i=!0,a4.call(window,()=>{i=!1,n.apply(e,o)}))}}const Vu=(n,e,t)=>"start"===n?e:"end"===n?t:(e+t)/2,Ioe=function(){let n=0;return function(){return n++}}();function Wo(n){return null==n}function Zs(n){if(Array.isArray&&Array.isArray(n))return!0;const e=Object.prototype.toString.call(n);return"[object"===e.substr(0,7)&&"Array]"===e.substr(-6)}function Uo(n){return null!==n&&"[object Object]"===Object.prototype.toString.call(n)}const ol=n=>("number"==typeof n||n instanceof Number)&&isFinite(+n);function Ah(n,e){return ol(n)?n:e}function Qi(n,e){return void 0===n?e:n}const iA=(n,e)=>"string"==typeof n&&n.endsWith("%")?parseFloat(n)/100*e:+n;function Ks(n,e,t){if(n&&"function"==typeof n.call)return n.apply(t,e)}function bs(n,e,t,r){let i,o,s;if(Zs(n))if(o=n.length,r)for(i=o-1;i>=0;i--)e.call(t,n[i],i);else for(i=0;i<o;i++)e.call(t,n[i],i);else if(Uo(n))for(s=Object.keys(n),o=s.length,i=0;i<o;i++)e.call(t,n[s[i]],s[i])}function Jw(n,e){let t,r,i,o;if(!n||!e||n.length!==e.length)return!1;for(t=0,r=n.length;t<r;++t)if(i=n[t],o=e[t],i.datasetIndex!==o.datasetIndex||i.index!==o.index)return!1;return!0}function Qw(n){if(Zs(n))return n.map(Qw);if(Uo(n)){const e=Object.create(null),t=Object.keys(n),r=t.length;let i=0;for(;i<r;++i)e[t[i]]=Qw(n[t[i]]);return e}return n}function u4(n){return-1===["__proto__","prototype","constructor"].indexOf(n)}function Poe(n,e,t,r){if(!u4(n))return;const i=e[n],o=t[n];Uo(i)&&Uo(o)?G0(i,o,r):e[n]=Qw(o)}function G0(n,e,t){const r=Zs(e)?e:[e],i=r.length;if(!Uo(n))return n;const o=(t=t||{}).merger||Poe;for(let s=0;s<i;++s){if(!Uo(e=r[s]))continue;const u=Object.keys(e);for(let f=0,g=u.length;f<g;++f)o(u[f],n,e,t)}return n}function $0(n,e){return G0(n,e,{merger:Roe})}function Roe(n,e,t){if(!u4(n))return;const r=e[n],i=t[n];Uo(r)&&Uo(i)?$0(r,i):Object.prototype.hasOwnProperty.call(e,n)||(e[n]=Qw(i))}function c4(n,e){const t=n.indexOf(".",e);return-1===t?n.length:t}function Rp(n,e){if(""===e)return n;let t=0,r=c4(e,t);for(;n&&r>t;)n=n[e.substr(t,r-t)],t=r+1,r=c4(e,t);return n}function oA(n){return n.charAt(0).toUpperCase()+n.slice(1)}const Tc=n=>void 0!==n,K_=n=>"function"==typeof n,Ya=Math.PI,Ns=2*Ya,eE=Number.POSITIVE_INFINITY,sl=Ya/2,Ph=Math.log10,Hd=Math.sign;function d4(n){const e=Math.round(n);n=q0(n,e,n/1e3)?e:n;const t=Math.pow(10,Math.floor(Ph(n))),r=n/t;return(r<=1?1:r<=2?2:r<=5?5:10)*t}function J_(n){return!isNaN(parseFloat(n))&&isFinite(n)}function q0(n,e,t){return Math.abs(n-e)<t}function f4(n,e,t){let r,i,o;for(r=0,i=n.length;r<i;r++)o=n[r][t],isNaN(o)||(e.min=Math.min(e.min,o),e.max=Math.max(e.max,o))}function hd(n){return n*(Ya/180)}function sA(n){return n*(180/Ya)}function p4(n){if(!ol(n))return;let e=1,t=0;for(;Math.round(n*e)/e!==n;)e*=10,t++;return t}function dd(n){return(n%Ns+Ns)%Ns}function su(n,e,t){return Math.max(e,Math.min(t,n))}const nE=n=>0===n||1===n,g4=(n,e,t)=>-Math.pow(2,10*(n-=1))*Math.sin((n-e)*Ns/t),m4=(n,e,t)=>Math.pow(2,-10*n)*Math.sin((n-e)*Ns/t)+1,W0={linear:n=>n,easeInQuad:n=>n*n,easeOutQuad:n=>-n*(n-2),easeInOutQuad:n=>(n/=.5)<1?.5*n*n:-.5*(--n*(n-2)-1),easeInCubic:n=>n*n*n,easeOutCubic:n=>(n-=1)*n*n+1,easeInOutCubic:n=>(n/=.5)<1?.5*n*n*n:.5*((n-=2)*n*n+2),easeInQuart:n=>n*n*n*n,easeOutQuart:n=>-((n-=1)*n*n*n-1),easeInOutQuart:n=>(n/=.5)<1?.5*n*n*n*n:-.5*((n-=2)*n*n*n-2),easeInQuint:n=>n*n*n*n*n,easeOutQuint:n=>(n-=1)*n*n*n*n+1,easeInOutQuint:n=>(n/=.5)<1?.5*n*n*n*n*n:.5*((n-=2)*n*n*n*n+2),easeInSine:n=>1-Math.cos(n*sl),easeOutSine:n=>Math.sin(n*sl),easeInOutSine:n=>-.5*(Math.cos(Ya*n)-1),easeInExpo:n=>0===n?0:Math.pow(2,10*(n-1)),easeOutExpo:n=>1===n?1:1-Math.pow(2,-10*n),easeInOutExpo:n=>nE(n)?n:n<.5?.5*Math.pow(2,10*(2*n-1)):.5*(2-Math.pow(2,-10*(2*n-1))),easeInCirc:n=>n>=1?n:-(Math.sqrt(1-n*n)-1),easeOutCirc:n=>Math.sqrt(1-(n-=1)*n),easeInOutCirc:n=>(n/=.5)<1?-.5*(Math.sqrt(1-n*n)-1):.5*(Math.sqrt(1-(n-=2)*n)+1),easeInElastic:n=>nE(n)?n:g4(n,.075,.3),easeOutElastic:n=>nE(n)?n:m4(n,.075,.3),easeInOutElastic(n){const e=.1125;return nE(n)?n:n<.5?.5*g4(2*n,e,.45):.5+.5*m4(2*n-1,e,.45)},easeInBack(n){const e=1.70158;return n*n*((e+1)*n-e)},easeOutBack(n){const e=1.70158;return(n-=1)*n*((e+1)*n+e)+1},easeInOutBack(n){let e=1.70158;return(n/=.5)<1?n*n*((1+(e*=1.525))*n-e)*.5:.5*((n-=2)*n*((1+(e*=1.525))*n+e)+2)},easeInBounce:n=>1-W0.easeOutBounce(1-n),easeOutBounce(n){const e=7.5625,t=2.75;return n<1/t?e*n*n:n<2/t?e*(n-=1.5/t)*n+.75:n<2.5/t?e*(n-=2.25/t)*n+.9375:e*(n-=2.625/t)*n+.984375},easeInOutBounce:n=>n<.5?.5*W0.easeInBounce(2*n):.5*W0.easeOutBounce(2*n-1)+.5},Rh={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},lA="0123456789ABCDEF",Goe=n=>lA[15&n],$oe=n=>lA[(240&n)>>4]+lA[15&n],rE=n=>(240&n)>>4==(15&n);function X0(n){return n+.5|0}const iE=(n,e,t)=>Math.max(Math.min(n,t),e);function Y0(n){return iE(X0(2.55*n),0,255)}function Z0(n){return iE(X0(255*n),0,255)}function uA(n){return iE(X0(n/2.55)/100,0,1)}function _4(n){return iE(X0(100*n),0,100)}const Xoe=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/,Koe=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function y4(n,e,t){const r=e*Math.min(t,1-t),i=(o,s=(o+n/30)%12)=>t-r*Math.max(Math.min(s-3,9-s,1),-1);return[i(0),i(8),i(4)]}function Joe(n,e,t){const r=(i,o=(i+n/60)%6)=>t-t*e*Math.max(Math.min(o,4-o,1),0);return[r(5),r(3),r(1)]}function Qoe(n,e,t){const r=y4(n,1,.5);let i;for(e+t>1&&(i=1/(e+t),e*=i,t*=i),i=0;i<3;i++)r[i]*=1-e-t,r[i]+=e;return r}function cA(n){const t=n.r/255,r=n.g/255,i=n.b/255,o=Math.max(t,r,i),s=Math.min(t,r,i),u=(o+s)/2;let f,g,v;return o!==s&&(v=o-s,g=u>.5?v/(2-o-s):v/(o+s),f=o===t?(r-i)/v+(r<i?6:0):o===r?(i-t)/v+2:(t-r)/v+4,f=60*f+.5),[0|f,g||0,u]}function hA(n,e,t,r){return(Array.isArray(e)?n(e[0],e[1],e[2]):n(e,t,r)).map(Z0)}function dA(n,e,t){return hA(y4,n,e,t)}function v4(n){return(n%360+360)%360}const x4={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},b4={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};let oE;function sE(n,e,t){if(n){let r=cA(n);r[e]=Math.max(0,Math.min(r[e]+r[e]*t,0===e?360:1)),r=dA(r),n.r=r[0],n.g=r[1],n.b=r[2]}}function w4(n,e){return n&&Object.assign(e||{},n)}function E4(n){var e={r:0,g:0,b:0,a:255};return Array.isArray(n)?n.length>=3&&(e={r:n[0],g:n[1],b:n[2],a:255},n.length>3&&(e.a=Z0(n[3]))):(e=w4(n,{r:0,g:0,b:0,a:1})).a=Z0(e.a),e}function ase(n){return"r"===n.charAt(0)?function(n){const e=Xoe.exec(n);let r,i,o,t=255;if(e){if(e[7]!==r){const s=+e[7];t=255&(e[8]?Y0(s):255*s)}return r=+e[1],i=+e[3],o=+e[5],r=255&(e[2]?Y0(r):r),i=255&(e[4]?Y0(i):i),o=255&(e[6]?Y0(o):o),{r,g:i,b:o,a:t}}}(n):function(n){const e=Koe.exec(n);let r,t=255;if(!e)return;e[5]!==r&&(t=e[6]?Y0(+e[5]):Z0(+e[5]));const i=v4(+e[2]),o=+e[3]/100,s=+e[4]/100;return r="hwb"===e[1]?function(n,e,t){return hA(Qoe,n,e,t)}(i,o,s):"hsv"===e[1]?function(n,e,t){return hA(Joe,n,e,t)}(i,o,s):dA(i,o,s),{r:r[0],g:r[1],b:r[2],a:t}}(n)}class aE{constructor(e){if(e instanceof aE)return e;const t=typeof e;let r;"object"===t?r=E4(e):"string"===t&&(r=function(n){var t,e=n.length;return"#"===n[0]&&(4===e||5===e?t={r:255&17*Rh[n[1]],g:255&17*Rh[n[2]],b:255&17*Rh[n[3]],a:5===e?17*Rh[n[4]]:255}:(7===e||9===e)&&(t={r:Rh[n[1]]<<4|Rh[n[2]],g:Rh[n[3]]<<4|Rh[n[4]],b:Rh[n[5]]<<4|Rh[n[6]],a:9===e?Rh[n[7]]<<4|Rh[n[8]]:255})),t}(e)||function(n){oE||(oE=function(){const n={},e=Object.keys(b4),t=Object.keys(x4);let r,i,o,s,u;for(r=0;r<e.length;r++){for(s=u=e[r],i=0;i<t.length;i++)o=t[i],u=u.replace(o,x4[o]);o=parseInt(b4[s],16),n[u]=[o>>16&255,o>>8&255,255&o]}return n}(),oE.transparent=[0,0,0,0]);const e=oE[n.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:4===e.length?e[3]:255}}(e)||ase(e)),this._rgb=r,this._valid=!!r}get valid(){return this._valid}get rgb(){var e=w4(this._rgb);return e&&(e.a=uA(e.a)),e}set rgb(e){this._rgb=E4(e)}rgbString(){return this._valid?function(n){return n&&(n.a<255?`rgba(${n.r}, ${n.g}, ${n.b}, ${uA(n.a)})`:`rgb(${n.r}, ${n.g}, ${n.b})`)}(this._rgb):this._rgb}hexString(){return this._valid?function(n){var e=function(n){return rE(n.r)&&rE(n.g)&&rE(n.b)&&rE(n.a)}(n)?Goe:$oe;return n&&"#"+e(n.r)+e(n.g)+e(n.b)+(n.a<255?e(n.a):"")}(this._rgb):this._rgb}hslString(){return this._valid?function(n){if(!n)return;const e=cA(n),t=e[0],r=_4(e[1]),i=_4(e[2]);return n.a<255?`hsla(${t}, ${r}%, ${i}%, ${uA(n.a)})`:`hsl(${t}, ${r}%, ${i}%)`}(this._rgb):this._rgb}mix(e,t){const r=this;if(e){const i=r.rgb,o=e.rgb;let s;const u=t===s?.5:t,f=2*u-1,g=i.a-o.a,v=((f*g==-1?f:(f+g)/(1+f*g))+1)/2;s=1-v,i.r=255&v*i.r+s*o.r+.5,i.g=255&v*i.g+s*o.g+.5,i.b=255&v*i.b+s*o.b+.5,i.a=u*i.a+(1-u)*o.a,r.rgb=i}return r}clone(){return new aE(this.rgb)}alpha(e){return this._rgb.a=Z0(e),this}clearer(e){return this._rgb.a*=1-e,this}greyscale(){const e=this._rgb,t=X0(.3*e.r+.59*e.g+.11*e.b);return e.r=e.g=e.b=t,this}opaquer(e){return this._rgb.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return sE(this._rgb,2,e),this}darken(e){return sE(this._rgb,2,-e),this}saturate(e){return sE(this._rgb,1,e),this}desaturate(e){return sE(this._rgb,1,-e),this}rotate(e){return function(n,e){var t=cA(n);t[0]=v4(t[0]+e),t=dA(t),n.r=t[0],n.g=t[1],n.b=t[2]}(this._rgb,e),this}}function C4(n){return new aE(n)}const S4=n=>n instanceof CanvasGradient||n instanceof CanvasPattern;function M4(n){return S4(n)?n:C4(n)}function fA(n){return S4(n)?n:C4(n).saturate(.5).darken(.1).hexString()}const Gg=Object.create(null),pA=Object.create(null);function K0(n,e){if(!e)return n;const t=e.split(".");for(let r=0,i=t.length;r<i;++r){const o=t[r];n=n[o]||(n[o]=Object.create(null))}return n}function gA(n,e,t){return"string"==typeof e?G0(K0(n,e),t):G0(K0(n,""),e)}var Co=new class{constructor(e){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=t=>t.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(t,r)=>fA(r.backgroundColor),this.hoverBorderColor=(t,r)=>fA(r.borderColor),this.hoverColor=(t,r)=>fA(r.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.describe(e)}set(e,t){return gA(this,e,t)}get(e){return K0(this,e)}describe(e,t){return gA(pA,e,t)}override(e,t){return gA(Gg,e,t)}route(e,t,r,i){const o=K0(this,e),s=K0(this,r),u="_"+t;Object.defineProperties(o,{[u]:{value:o[t],writable:!0},[t]:{enumerable:!0,get(){const f=this[u],g=s[i];return Uo(f)?Object.assign({},g,f):Qi(f,g)},set(f){this[u]=f}}})}}({_scriptable:n=>!n.startsWith("on"),_indexable:n=>"events"!==n,hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}});function lE(n,e,t,r,i){let o=e[i];return o||(o=e[i]=n.measureText(i).width,t.push(i)),o>r&&(r=o),r}function cse(n,e,t,r){let i=(r=r||{}).data=r.data||{},o=r.garbageCollect=r.garbageCollect||[];r.font!==e&&(i=r.data={},o=r.garbageCollect=[],r.font=e),n.save(),n.font=e;let s=0;const u=t.length;let f,g,v,E,T;for(f=0;f<u;f++)if(E=t[f],null!=E&&!0!==Zs(E))s=lE(n,i,o,s,E);else if(Zs(E))for(g=0,v=E.length;g<v;g++)T=E[g],null!=T&&!Zs(T)&&(s=lE(n,i,o,s,T));n.restore();const R=o.length/2;if(R>t.length){for(f=0;f<R;f++)delete i[o[f]];o.splice(0,R)}return s}function $g(n,e,t){const r=n.currentDevicePixelRatio,i=0!==t?Math.max(t/2,.5):0;return Math.round((e-i)*r)/r+i}function T4(n,e){(e=e||n.getContext("2d")).save(),e.resetTransform(),e.clearRect(0,0,n.width,n.height),e.restore()}function Hg(n,e,t){return t=t||.5,!e||n&&n.x>e.left-t&&n.x<e.right+t&&n.y>e.top-t&&n.y<e.bottom+t}function cE(n,e){n.save(),n.beginPath(),n.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),n.clip()}function hE(n){n.restore()}function qg(n,e,t,r,i,o={}){const s=Zs(e)?e:[e],u=o.strokeWidth>0&&""!==o.strokeColor;let f,g;for(n.save(),n.font=i.string,function(n,e){e.translation&&n.translate(e.translation[0],e.translation[1]),Wo(e.rotation)||n.rotate(e.rotation),e.color&&(n.fillStyle=e.color),e.textAlign&&(n.textAlign=e.textAlign),e.textBaseline&&(n.textBaseline=e.textBaseline)}(n,o),f=0;f<s.length;++f)g=s[f],u&&(o.strokeColor&&(n.strokeStyle=o.strokeColor),Wo(o.strokeWidth)||(n.lineWidth=o.strokeWidth),n.strokeText(g,t,r,o.maxWidth)),n.fillText(g,t,r,o.maxWidth),pse(n,t,r,g,o),r+=i.lineHeight;n.restore()}function pse(n,e,t,r,i){if(i.strikethrough||i.underline){const o=n.measureText(r),s=e-o.actualBoundingBoxLeft,u=e+o.actualBoundingBoxRight,f=t-o.actualBoundingBoxAscent,g=t+o.actualBoundingBoxDescent,v=i.strikethrough?(f+g)/2:g;n.strokeStyle=n.fillStyle,n.beginPath(),n.lineWidth=i.decorationWidth||2,n.moveTo(s,v),n.lineTo(u,v),n.stroke()}}function dE(n,e){const{x:t,y:r,w:i,h:o,radius:s}=e;n.arc(t+s.topLeft,r+s.topLeft,s.topLeft,-sl,Ya,!0),n.lineTo(t,r+o-s.bottomLeft),n.arc(t+s.bottomLeft,r+o-s.bottomLeft,s.bottomLeft,Ya,sl,!0),n.lineTo(t+i-s.bottomRight,r+o),n.arc(t+i-s.bottomRight,r+o-s.bottomRight,s.bottomRight,sl,0,!0),n.lineTo(t+i,r+s.topRight),n.arc(t+i-s.topRight,r+s.topRight,s.topRight,0,-sl,!0),n.lineTo(t+s.topLeft,r)}const gse=new RegExp(/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/),mse=new RegExp(/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/);function _se(n,e){const t=(""+n).match(gse);if(!t||"normal"===t[1])return 1.2*e;switch(n=+t[2],t[3]){case"px":return n;case"%":n/=100}return e*n}const yse=n=>+n||0;function mA(n,e){const t={},r=Uo(e),i=r?Object.keys(e):e,o=Uo(n)?r?s=>Qi(n[s],n[e[s]]):s=>n[s]:()=>n;for(const s of i)t[s]=yse(o(s));return t}function D4(n){return mA(n,{top:"y",right:"x",bottom:"y",left:"x"})}function dc(n){const e=D4(n);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function jl(n,e){let t=Qi((n=n||{}).size,(e=e||Co.font).size);"string"==typeof t&&(t=parseInt(t,10));let r=Qi(n.style,e.style);r&&!(""+r).match(mse)&&(console.warn('Invalid font style specified: "'+r+'"'),r="");const i={family:Qi(n.family,e.family),lineHeight:_se(Qi(n.lineHeight,e.lineHeight),t),size:t,style:r,weight:Qi(n.weight,e.weight),string:""};return i.string=function(n){return!n||Wo(n.size)||Wo(n.family)?null:(n.style?n.style+" ":"")+(n.weight?n.weight+" ":"")+n.size+"px "+n.family}(i),i}function J0(n,e,t,r){let o,s,u,i=!0;for(o=0,s=n.length;o<s;++o)if(u=n[o],void 0!==u&&(void 0!==e&&"function"==typeof u&&(u=u(e),i=!1),void 0!==t&&Zs(u)&&(u=u[t%u.length],i=!1),void 0!==u))return r&&!i&&(r.cacheable=!1),u}function yA(n,e,t){t=t||(s=>n[s]<e);let o,r=n.length-1,i=0;for(;r-i>1;)o=i+r>>1,t(o)?i=o:r=o;return{lo:i,hi:r}}const Lf=(n,e,t)=>yA(n,t,r=>n[r][e]<t),xse=(n,e,t)=>yA(n,t,r=>n[r][e]>=t),I4=["push","pop","shift","splice","unshift"];function A4(n,e){const t=n._chartjs;if(!t)return;const r=t.listeners,i=r.indexOf(e);-1!==i&&r.splice(i,1),!(r.length>0)&&(I4.forEach(o=>{delete n[o]}),delete n._chartjs)}function vA(n,e=[""],t=n,r,i=(()=>n[0])){Tc(r)||(r=F4("_fallback",n));const o={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:n,_rootScopes:t,_fallback:r,_getTarget:i,override:s=>vA([s,...n],e,t,r)};return new Proxy(o,{deleteProperty:(s,u)=>(delete s[u],delete s._keys,delete n[0][u],!0),get:(s,u)=>k4(s,u,()=>function(n,e,t,r){let i;for(const o of e)if(i=F4(Ese(o,n),t),Tc(i))return O4(n,i)?xA(t,r,n,i):i}(u,e,n,s)),getOwnPropertyDescriptor:(s,u)=>Reflect.getOwnPropertyDescriptor(s._scopes[0],u),getPrototypeOf:()=>Reflect.getPrototypeOf(n[0]),has:(s,u)=>B4(s).includes(u),ownKeys:s=>B4(s),set:(s,u,f)=>((s._storage||(s._storage=i()))[u]=f,delete s[u],delete s._keys,!0)})}function Q_(n,e,t,r){const i={_cacheable:!1,_proxy:n,_context:e,_subProxy:t,_stack:new Set,_descriptors:R4(n,r),setContext:o=>Q_(n,o,t,r),override:o=>Q_(n.override(o),e,t,r)};return new Proxy(i,{deleteProperty:(o,s)=>(delete o[s],delete n[s],!0),get:(o,s,u)=>k4(o,s,()=>function(n,e,t){const{_proxy:r,_context:i,_subProxy:o,_descriptors:s}=n;let u=r[e];return K_(u)&&s.isScriptable(e)&&(u=function(n,e,t,r){const{_proxy:i,_context:o,_subProxy:s,_stack:u}=t;if(u.has(n))throw new Error("Recursion detected: "+Array.from(u).join("->")+"->"+n);return u.add(n),e=e(o,s||r),u.delete(n),Uo(e)&&(e=xA(i._scopes,i,n,e)),e}(e,u,n,t)),Zs(u)&&u.length&&(u=function(n,e,t,r){const{_proxy:i,_context:o,_subProxy:s,_descriptors:u}=t;if(Tc(o.index)&&r(n))e=e[o.index%e.length];else if(Uo(e[0])){const f=e,g=i._scopes.filter(v=>v!==f);e=[];for(const v of f){const E=xA(g,i,n,v);e.push(Q_(E,o,s&&s[n],u))}}return e}(e,u,n,s.isIndexable)),O4(e,u)&&(u=Q_(u,i,o&&o[e],s)),u}(o,s,u)),getOwnPropertyDescriptor:(o,s)=>o._descriptors.allKeys?Reflect.has(n,s)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(n,s),getPrototypeOf:()=>Reflect.getPrototypeOf(n),has:(o,s)=>Reflect.has(n,s),ownKeys:()=>Reflect.ownKeys(n),set:(o,s,u)=>(n[s]=u,delete o[s],!0)})}function R4(n,e={scriptable:!0,indexable:!0}){const{_scriptable:t=e.scriptable,_indexable:r=e.indexable,_allKeys:i=e.allKeys}=n;return{allKeys:i,scriptable:t,indexable:r,isScriptable:K_(t)?t:()=>t,isIndexable:K_(r)?r:()=>r}}const Ese=(n,e)=>n?n+oA(e):e,O4=(n,e)=>Uo(e)&&"adapters"!==n;function k4(n,e,t){let r=n[e];return Tc(r)||(r=t(),Tc(r)&&(n[e]=r)),r}function L4(n,e,t){return K_(n)?n(e,t):n}const Tse=(n,e)=>!0===n?e:"string"==typeof n?Rp(e,n):void 0;function Dse(n,e,t,r){for(const i of e){const o=Tse(t,i);if(o){n.add(o);const s=L4(o._fallback,t,o);if(Tc(s)&&s!==t&&s!==r)return s}else if(!1===o&&Tc(r)&&t!==r)return null}return!1}function xA(n,e,t,r){const i=e._rootScopes,o=L4(e._fallback,t,r),s=[...n,...i],u=new Set;u.add(r);let f=N4(u,s,t,o||t);return!(null===f||Tc(o)&&o!==t&&(f=N4(u,s,o,f),null===f))&&vA(Array.from(u),[""],i,o,()=>function(n,e,t){const r=n._getTarget();e in r||(r[e]={});const i=r[e];return Zs(i)&&Uo(t)?t:i}(e,t,r))}function N4(n,e,t,r){for(;t;)t=Dse(n,e,t,r);return t}function F4(n,e){for(const t of e){if(!t)continue;const r=t[n];if(Tc(r))return r}}function B4(n){let e=n._keys;return e||(e=n._keys=function(n){const e=new Set;for(const t of n)for(const r of Object.keys(t).filter(i=>!i.startsWith("_")))e.add(r);return Array.from(e)}(n._scopes)),e}function V4(){return"undefined"!=typeof window&&"undefined"!=typeof document}function ty(n){let e=n.parentNode;return e&&"[object ShadowRoot]"===e.toString()&&(e=e.host),e}function pE(n,e,t){let r;return"string"==typeof n?(r=parseInt(n,10),-1!==n.indexOf("%")&&(r=r/100*e.parentNode[t])):r=n,r}const gE=n=>window.getComputedStyle(n,null),Vse=["top","right","bottom","left"];function Wg(n,e,t){const r={};t=t?"-"+t:"";for(let i=0;i<4;i++){const o=Vse[i];r[o]=parseFloat(n[e+"-"+o+t])||0}return r.width=r.left+r.right,r.height=r.top+r.bottom,r}function U4(n,e){const{canvas:t,currentDevicePixelRatio:r}=e,i=gE(t),o="border-box"===i.boxSizing,s=Wg(i,"padding"),u=Wg(i,"border","width"),{x:f,y:g,box:v}=function(n,e){const t=n.native||n,r=t.touches,i=r&&r.length?r[0]:t,{offsetX:o,offsetY:s}=i;let f,g,u=!1;if(((n,e,t)=>(n>0||e>0)&&(!t||!t.shadowRoot))(o,s,t.target))f=o,g=s;else{const v=e.getBoundingClientRect();f=i.clientX-v.left,g=i.clientY-v.top,u=!0}return{x:f,y:g,box:u}}(n,t),E=s.left+(v&&u.left),T=s.top+(v&&u.top);let{width:R,height:B}=e;return o&&(R-=s.width+u.width,B-=s.height+u.height),{x:Math.round((f-E)/R*t.width/r),y:Math.round((g-T)/B*t.height/r)}}const bA=n=>Math.round(10*n)/10;function j4(n,e,t){const r=e||1,i=Math.floor(n.height*r),o=Math.floor(n.width*r);n.height=i/r,n.width=o/r;const s=n.canvas;return s.style&&(t||!s.style.height&&!s.style.width)&&(s.style.height=`${n.height}px`,s.style.width=`${n.width}px`),(n.currentDevicePixelRatio!==r||s.height!==i||s.width!==o)&&(n.currentDevicePixelRatio=r,s.height=i,s.width=o,n.ctx.setTransform(r,0,0,r,0,0),!0)}const Hse=function(){let n=!1;try{const e={get passive(){return n=!0,!1}};window.addEventListener("test",null,e),window.removeEventListener("test",null,e)}catch(e){}return n}();function G4(n,e){const t=function(n,e){return gE(n).getPropertyValue(e)}(n,e),r=t&&t.match(/^(\d+)(\.\d+)?px$/);return r?+r[1]:void 0}const $4=new Map;function Q0(n,e,t){return function(n,e){e=e||{};const t=n+JSON.stringify(e);let r=$4.get(t);return r||(r=new Intl.NumberFormat(n,e),$4.set(t,r)),r}(e,t).format(n)}var Nf=new class{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,t,r,i){const s=t.duration;t.listeners[i].forEach(u=>u({chart:e,initial:t.initial,numSteps:s,currentStep:Math.min(r-t.start,s)}))}_refresh(){const e=this;e._request||(e._running=!0,e._request=a4.call(window,()=>{e._update(),e._request=null,e._running&&e._refresh()}))}_update(e=Date.now()){const t=this;let r=0;t._charts.forEach((i,o)=>{if(!i.running||!i.items.length)return;const s=i.items;let g,u=s.length-1,f=!1;for(;u>=0;--u)g=s[u],g._active?(g._total>i.duration&&(i.duration=g._total),g.tick(e),f=!0):(s[u]=s[s.length-1],s.pop());f&&(o.draw(),t._notify(o,i,e,"progress")),s.length||(i.running=!1,t._notify(o,i,e,"complete"),i.initial=!1),r+=s.length}),t._lastDate=e,0===r&&(t._running=!1)}_getAnims(e){const t=this._charts;let r=t.get(e);return r||(r={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},t.set(e,r)),r}listen(e,t,r){this._getAnims(e).listeners[t].push(r)}add(e,t){!t||!t.length||this._getAnims(e).items.push(...t)}has(e){return this._getAnims(e).items.length>0}start(e){const t=this._charts.get(e);!t||(t.running=!0,t.start=Date.now(),t.duration=t.items.reduce((r,i)=>Math.max(r,i._duration),0),this._refresh())}running(e){if(!this._running)return!1;const t=this._charts.get(e);return!(!t||!t.running||!t.items.length)}stop(e){const t=this._charts.get(e);if(!t||!t.items.length)return;const r=t.items;let i=r.length-1;for(;i>=0;--i)r[i].cancel();t.items=[],this._notify(e,t,Date.now(),"complete")}remove(e){return this._charts.delete(e)}};const Q4="transparent",iae={boolean:(n,e,t)=>t>.5?e:n,color(n,e,t){const r=M4(n||Q4),i=r.valid&&M4(e||Q4);return i&&i.valid?i.mix(r,t).hexString():e},number:(n,e,t)=>n+(e-n)*t};class oae{constructor(e,t,r,i){const o=t[r];i=J0([e.to,i,o,e.from]);const s=J0([e.from,o,i]);this._active=!0,this._fn=e.fn||iae[e.type||typeof s],this._easing=W0[e.easing]||W0.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=t,this._prop=r,this._from=s,this._to=i,this._promises=void 0}active(){return this._active}update(e,t,r){const i=this;if(i._active){i._notify(!1);const o=i._target[i._prop],s=r-i._start,u=i._duration-s;i._start=r,i._duration=Math.floor(Math.max(u,e.duration)),i._total+=s,i._loop=!!e.loop,i._to=J0([e.to,t,o,e.from]),i._from=J0([e.from,o,t])}}cancel(){const e=this;e._active&&(e.tick(Date.now()),e._active=!1,e._notify(!1))}tick(e){const t=this,r=e-t._start,i=t._duration,o=t._prop,s=t._from,u=t._loop,f=t._to;let g;if(t._active=s!==f&&(u||r<i),!t._active)return t._target[o]=f,void t._notify(!0);r<0?t._target[o]=s:(g=r/i%2,g=u&&g>1?2-g:g,g=t._easing(Math.min(1,Math.max(0,g))),t._target[o]=t._fn(s,f,g))}wait(){const e=this._promises||(this._promises=[]);return new Promise((t,r)=>{e.push({res:t,rej:r})})}_notify(e){const t=e?"res":"rej",r=this._promises||[];for(let i=0;i<r.length;i++)r[i][t]()}}Co.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0});const lae=Object.keys(Co.animation);Co.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:n=>"onProgress"!==n&&"onComplete"!==n&&"fn"!==n}),Co.set("animations",{colors:{type:"color",properties:["color","borderColor","backgroundColor"]},numbers:{type:"number",properties:["x","y","borderWidth","radius","tension"]}}),Co.describe("animations",{_fallback:"animation"}),Co.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:n=>0|n}}}});class e5{constructor(e,t){this._chart=e,this._properties=new Map,this.configure(t)}configure(e){if(!Uo(e))return;const t=this._properties;Object.getOwnPropertyNames(e).forEach(r=>{const i=e[r];if(!Uo(i))return;const o={};for(const s of lae)o[s]=i[s];(Zs(i.properties)&&i.properties||[r]).forEach(s=>{(s===r||!t.has(s))&&t.set(s,o)})})}_animateOptions(e,t){const r=t.options,i=function(n,e){if(!e)return;let t=n.options;if(t)return t.$shared&&(n.options=t=Object.assign({},t,{$shared:!1,$animations:{}})),t;n.options=e}(e,r);if(!i)return[];const o=this._createAnimations(i,r);return r.$shared&&function(n,e){const t=[],r=Object.keys(e);for(let i=0;i<r.length;i++){const o=n[r[i]];o&&o.active()&&t.push(o.wait())}return Promise.all(t)}(e.options.$animations,r).then(()=>{e.options=r},()=>{}),o}_createAnimations(e,t){const r=this._properties,i=[],o=e.$animations||(e.$animations={}),s=Object.keys(t),u=Date.now();let f;for(f=s.length-1;f>=0;--f){const g=s[f];if("$"===g.charAt(0))continue;if("options"===g){i.push(...this._animateOptions(e,t));continue}const v=t[g];let E=o[g];const T=r.get(g);if(E){if(T&&E.active()){E.update(T,v,u);continue}E.cancel()}T&&T.duration?(o[g]=E=new oae(T,e,g,v),i.push(E)):e[g]=v}return i}update(e,t){if(0===this._properties.size)return void Object.assign(e,t);const r=this._createAnimations(e,t);return r.length?(Nf.add(this._chart,r),!0):void 0}}function t5(n,e){const t=n&&n.options||{},r=t.reverse,i=void 0===t.min?e:0,o=void 0===t.max?e:0;return{start:r?o:i,end:r?i:o}}function n5(n,e){const t=[],r=n._getSortedDatasetMetas(e);let i,o;for(i=0,o=r.length;i<o;++i)t.push(r[i].index);return t}function r5(n,e,t,r){const i=n.keys,o="single"===r.mode;let s,u,f,g;if(null!==e){for(s=0,u=i.length;s<u;++s){if(f=+i[s],f===t){if(r.all)continue;break}g=n.values[f],ol(g)&&(o||0===e||Hd(e)===Hd(g))&&(e+=g)}return e}}function i5(n,e){const t=n&&n.options.stacked;return t||void 0===t&&void 0!==e.stack}function mae(n,e,t){const r=n[e]||(n[e]={});return r[t]||(r[t]={})}function o5(n,e,t){for(const r of e.getMatchingVisibleMetas("bar").reverse()){const i=n[r.index];if(t&&i>0||!t&&i<0)return r.index}return null}function s5(n,e){const{chart:t,_cachedMeta:r}=n,i=t._stacks||(t._stacks={}),{iScale:o,vScale:s,index:u}=r,f=o.axis,g=s.axis,v=function(n,e,t){return`${n.id}.${e.id}.${t.stack||t.type}`}(o,s,r),E=e.length;let T;for(let R=0;R<E;++R){const B=e[R],{[f]:z,[g]:G}=B;T=(B._stacks||(B._stacks={}))[g]=mae(i,v,z),T[u]=G,T._top=o5(T,s,!0),T._bottom=o5(T,s,!1)}}function wA(n,e){const t=n.scales;return Object.keys(t).filter(r=>t[r].axis===e).shift()}function e1(n,e){const t=n.controller.index,r=n.vScale&&n.vScale.axis;if(r){e=e||n._parsed;for(const i of e){const o=i._stacks;if(!o||void 0===o[r]||void 0===o[r][t])return;delete o[r][t]}}}const EA=n=>"reset"===n||"none"===n,a5=(n,e)=>e?n:Object.assign({},n);let Ff=(()=>{class n{constructor(t,r){this.chart=t,this._ctx=t.ctx,this.index=r,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.$context=void 0,this._syncList=[],this.initialize()}initialize(){const t=this,r=t._cachedMeta;t.configure(),t.linkScales(),r._stacked=i5(r.vScale,r),t.addElements()}updateIndex(t){this.index!==t&&e1(this._cachedMeta),this.index=t}linkScales(){const t=this,r=t.chart,i=t._cachedMeta,o=t.getDataset(),s=(R,B,z,G)=>"x"===R?B:"r"===R?G:z,u=i.xAxisID=Qi(o.xAxisID,wA(r,"x")),f=i.yAxisID=Qi(o.yAxisID,wA(r,"y")),g=i.rAxisID=Qi(o.rAxisID,wA(r,"r")),v=i.indexAxis,E=i.iAxisID=s(v,u,f,g),T=i.vAxisID=s(v,f,u,g);i.xScale=t.getScaleForId(u),i.yScale=t.getScaleForId(f),i.rScale=t.getScaleForId(g),i.iScale=t.getScaleForId(E),i.vScale=t.getScaleForId(T)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(t){return this.chart.scales[t]}_getOtherScale(t){const r=this._cachedMeta;return t===r.iScale?r.vScale:r.iScale}reset(){this._update("reset")}_destroy(){const t=this._cachedMeta;this._data&&A4(this._data,this),t._stacked&&e1(t)}_dataCheck(){const t=this,r=t.getDataset(),i=r.data||(r.data=[]),o=t._data;if(Uo(i))t._data=function(n){const e=Object.keys(n),t=new Array(e.length);let r,i,o;for(r=0,i=e.length;r<i;++r)o=e[r],t[r]={x:o,y:n[o]};return t}(i);else if(o!==i){if(o){A4(o,t);const s=t._cachedMeta;e1(s),s._parsed=[]}i&&Object.isExtensible(i)&&function(n,e){n._chartjs?n._chartjs.listeners.push(e):(Object.defineProperty(n,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),I4.forEach(t=>{const r="_onData"+oA(t),i=n[t];Object.defineProperty(n,t,{configurable:!0,enumerable:!1,value(...o){const s=i.apply(this,o);return n._chartjs.listeners.forEach(u=>{"function"==typeof u[r]&&u[r](...o)}),s}})}))}(i,t),t._syncList=[],t._data=i}}addElements(){const t=this,r=t._cachedMeta;t._dataCheck(),t.datasetElementType&&(r.dataset=new t.datasetElementType)}buildOrUpdateElements(t){const r=this,i=r._cachedMeta,o=r.getDataset();let s=!1;r._dataCheck();const u=i._stacked;i._stacked=i5(i.vScale,i),i.stack!==o.stack&&(s=!0,e1(i),i.stack=o.stack),r._resyncElements(t),(s||u!==i._stacked)&&s5(r,i._parsed)}configure(){const t=this,r=t.chart.config,i=r.datasetScopeKeys(t._type),o=r.getOptionScopes(t.getDataset(),i,!0);t.options=r.createResolver(o,t.getContext()),t._parsing=t.options.parsing}parse(t,r){const i=this,{_cachedMeta:o,_data:s}=i,{iScale:u,_stacked:f}=o,g=u.axis;let T,R,B,v=0===t&&r===s.length||o._sorted,E=t>0&&o._parsed[t-1];if(!1===i._parsing)o._parsed=s,o._sorted=!0,B=s;else{B=Zs(s[t])?i.parseArrayData(o,s,t,r):Uo(s[t])?i.parseObjectData(o,s,t,r):i.parsePrimitiveData(o,s,t,r);const z=()=>null===R[g]||E&&R[g]<E[g];for(T=0;T<r;++T)o._parsed[T+t]=R=B[T],v&&(z()&&(v=!1),E=R);o._sorted=v}f&&s5(i,B)}parsePrimitiveData(t,r,i,o){const{iScale:s,vScale:u}=t,f=s.axis,g=u.axis,v=s.getLabels(),E=s===u,T=new Array(o);let R,B,z;for(R=0,B=o;R<B;++R)z=R+i,T[R]={[f]:E||s.parse(v[z],z),[g]:u.parse(r[z],z)};return T}parseArrayData(t,r,i,o){const{xScale:s,yScale:u}=t,f=new Array(o);let g,v,E,T;for(g=0,v=o;g<v;++g)E=g+i,T=r[E],f[g]={x:s.parse(T[0],E),y:u.parse(T[1],E)};return f}parseObjectData(t,r,i,o){const{xScale:s,yScale:u}=t,{xAxisKey:f="x",yAxisKey:g="y"}=this._parsing,v=new Array(o);let E,T,R,B;for(E=0,T=o;E<T;++E)R=E+i,B=r[R],v[E]={x:s.parse(Rp(B,f),R),y:u.parse(Rp(B,g),R)};return v}getParsed(t){return this._cachedMeta._parsed[t]}getDataElement(t){return this._cachedMeta.data[t]}applyStack(t,r,i){const s=this._cachedMeta,u=r[t.axis];return r5({keys:n5(this.chart,!0),values:r._stacks[t.axis]},u,s.index,{mode:i})}updateRangeFromParsed(t,r,i,o){const s=i[r.axis];let u=null===s?NaN:s;const f=o&&i._stacks[r.axis];o&&f&&(o.values=f,t.min=Math.min(t.min,u),t.max=Math.max(t.max,u),u=r5(o,s,this._cachedMeta.index,{all:!0})),t.min=Math.min(t.min,u),t.max=Math.max(t.max,u)}getMinMax(t,r){const i=this,o=i._cachedMeta,s=o._parsed,u=o._sorted&&t===o.iScale,f=s.length,g=i._getOtherScale(t),v=r&&o._stacked&&{keys:n5(i.chart,!0),values:null},E={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:T,max:R}=function(n){const{min:e,max:t,minDefined:r,maxDefined:i}=n.getUserBounds();return{min:r?e:Number.NEGATIVE_INFINITY,max:i?t:Number.POSITIVE_INFINITY}}(g);let B,z,G,W;function H(){return G=s[B],z=G[t.axis],W=G[g.axis],!ol(z)||T>W||R<W}for(B=0;B<f&&(H()||(i.updateRangeFromParsed(E,t,G,v),!u));++B);if(u)for(B=f-1;B>=0;--B)if(!H()){i.updateRangeFromParsed(E,t,G,v);break}return E}getAllParsedValues(t){const r=this._cachedMeta._parsed,i=[];let o,s,u;for(o=0,s=r.length;o<s;++o)u=r[o][t.axis],ol(u)&&i.push(u);return i}getMaxOverflow(){return!1}getLabelAndValue(t){const i=this._cachedMeta,o=i.iScale,s=i.vScale,u=this.getParsed(t);return{label:o?""+o.getLabelForValue(u[o.axis]):"",value:s?""+s.getLabelForValue(u[s.axis]):""}}_update(t){const r=this,i=r._cachedMeta;r.configure(),r._cachedDataOpts={},r.update(t||"default"),i._clip=function(n){let e,t,r,i;return Uo(n)?(e=n.top,t=n.right,r=n.bottom,i=n.left):e=t=r=i=n,{top:e,right:t,bottom:r,left:i,disabled:!1===n}}(Qi(r.options.clip,function(n,e,t){if(!1===t)return!1;const r=t5(n,t),i=t5(e,t);return{top:i.end,right:r.end,bottom:i.start,left:r.start}}(i.xScale,i.yScale,r.getMaxOverflow())))}update(t){}draw(){const t=this,r=t._ctx,o=t._cachedMeta,s=o.data||[],u=t.chart.chartArea,f=[],g=t._drawStart||0,v=t._drawCount||s.length-g;let E;for(o.dataset&&o.dataset.draw(r,u,g,v),E=g;E<g+v;++E){const T=s[E];T.hidden||(T.active?f.push(T):T.draw(r,u))}for(E=0;E<f.length;++E)f[E].draw(r,u)}getStyle(t,r){const i=r?"active":"default";return void 0===t&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(i):this.resolveDataElementOptions(t||0,i)}getContext(t,r,i){const o=this,s=o.getDataset();let u;if(t>=0&&t<o._cachedMeta.data.length){const f=o._cachedMeta.data[t];u=f.$context||(f.$context=function(n,e,t){return Object.assign(Object.create(n),{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:t,index:e,mode:"default",type:"data"})}(o.getContext(),t,f)),u.parsed=o.getParsed(t),u.raw=s.data[t],u.index=u.dataIndex=t}else u=o.$context||(o.$context=function(n,e){return Object.assign(Object.create(n),{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}(o.chart.getContext(),o.index)),u.dataset=s,u.index=u.datasetIndex=o.index;return u.active=!!r,u.mode=i,u}resolveDatasetElementOptions(t){return this._resolveElementOptions(this.datasetElementType.id,t)}resolveDataElementOptions(t,r){return this._resolveElementOptions(this.dataElementType.id,r,t)}_resolveElementOptions(t,r="default",i){const o=this,s="active"===r,u=o._cachedDataOpts,f=t+"-"+r,g=u[f],v=o.enableOptionSharing&&Tc(i);if(g)return a5(g,v);const E=o.chart.config,T=E.datasetElementScopeKeys(o._type,t),R=s?[`${t}Hover`,"hover",t,""]:[t,""],B=E.getOptionScopes(o.getDataset(),T),z=Object.keys(Co.elements[t]),W=E.resolveNamedOptions(B,z,()=>o.getContext(i,s),R);return W.$shared&&(W.$shared=v,u[f]=Object.freeze(a5(W,v))),W}_resolveAnimations(t,r,i){const o=this,s=o.chart,u=o._cachedDataOpts,f=`animation-${r}`,g=u[f];if(g)return g;let v;if(!1!==s.options.animation){const T=o.chart.config,R=T.datasetAnimationScopeKeys(o._type,r),B=T.getOptionScopes(o.getDataset(),R);v=T.createResolver(B,o.getContext(t,i,r))}const E=new e5(s,v&&v.animations);return v&&v._cacheable&&(u[f]=Object.freeze(E)),E}getSharedOptions(t){if(t.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},t))}includeOptions(t,r){return!r||EA(t)||this.chart._animationsDisabled}updateElement(t,r,i,o){EA(o)?Object.assign(t,i):this._resolveAnimations(r,o).update(t,i)}updateSharedOptions(t,r,i){t&&!EA(r)&&this._resolveAnimations(void 0,r).update(t,i)}_setStyle(t,r,i,o){t.active=o;const s=this.getStyle(r,o);this._resolveAnimations(r,i,o).update(t,{options:!o&&this.getSharedOptions(s)||s})}removeHoverStyle(t,r,i){this._setStyle(t,i,"active",!1)}setHoverStyle(t,r,i){this._setStyle(t,i,"active",!0)}_removeDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!1)}_setDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!0)}_resyncElements(t){const r=this,i=r._data,o=r._cachedMeta.data;for(const[g,v,E]of r._syncList)r[g](v,E);r._syncList=[];const s=o.length,u=i.length,f=Math.min(u,s);f&&r.parse(0,f),u>s?r._insertElements(s,u-s,t):u<s&&r._removeElements(u,s-u)}_insertElements(t,r,i=!0){const o=this,s=o._cachedMeta,u=s.data,f=t+r;let g;const v=E=>{for(E.length+=r,g=E.length-1;g>=f;g--)E[g]=E[g-r]};for(v(u),g=t;g<f;++g)u[g]=new o.dataElementType;o._parsing&&v(s._parsed),o.parse(t,r),i&&o.updateElements(u,t,r,"reset")}updateElements(t,r,i,o){}_removeElements(t,r){const o=this._cachedMeta;if(this._parsing){const s=o._parsed.splice(t,r);o._stacked&&e1(o,s)}o.data.splice(t,r)}_sync(t){if(this._parsing)this._syncList.push(t);else{const[r,i,o]=t;this[r](i,o)}}_onDataPush(){const t=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-t,t])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(t,r){this._sync(["_removeElements",t,r]),this._sync(["_insertElements",t,arguments.length-2])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}return n.defaults={},n})();function Yg(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}Ff.prototype.datasetElementType=null,Ff.prototype.dataElementType=null;var kae={_date:(()=>{class n{constructor(t){this.options=t||{}}formats(){return Yg()}parse(t,r){return Yg()}format(t,r){return Yg()}add(t,r,i){return Yg()}diff(t,r,i){return Yg()}startOf(t,r,i){return Yg()}endOf(t,r){return Yg()}}return n.override=function(e){Object.assign(n.prototype,e)},n})()};function t1(n,e){return"native"in n?{x:n.x,y:n.y}:U4(n,e)}function Nae(n,e,t,r){const{controller:i,data:o,_sorted:s}=n,u=i._cachedMeta.iScale;if(u&&e===u.axis&&s&&o.length){const f=u._reversePixels?xse:Lf;if(!r)return f(o,e,t);if(i._sharedOptions){const g=o[0],v="function"==typeof g.getRange&&g.getRange(e);if(v){const E=f(o,e,t-v),T=f(o,e,t+v);return{lo:E.lo,hi:T.hi}}}}return{lo:0,hi:o.length-1}}function p5(n,e,t,r,i){const o=n.getSortedVisibleDatasetMetas(),s=t[e];for(let u=0,f=o.length;u<f;++u){const{index:g,data:v}=o[u],{lo:E,hi:T}=Nae(o[u],e,s,i);for(let R=E;R<=T;++R){const B=v[R];B.skip||r(B,g,R)}}}function SA(n,e,t,r){const i=[];return Hg(e,n.chartArea,n._minPadding)&&p5(n,t,e,function(s,u,f){s.inRange(e.x,e.y,r)&&i.push({element:s,datasetIndex:u,index:f})},!0),i}function MA(n,e,t,r,i){const o=function(n){const e=-1!==n.indexOf("x"),t=-1!==n.indexOf("y");return function(r,i){const o=e?Math.abs(r.x-i.x):0,s=t?Math.abs(r.y-i.y):0;return Math.sqrt(Math.pow(o,2)+Math.pow(s,2))}}(t);let s=Number.POSITIVE_INFINITY,u=[];return Hg(e,n.chartArea,n._minPadding)&&p5(n,t,e,function(g,v,E){if(r&&!g.inRange(e.x,e.y,i))return;const T=g.getCenterPoint(i);if(!Hg(T,n.chartArea,n._minPadding)&&!g.inRange(e.x,e.y,i))return;const R=o(e,T);R<s?(u=[{element:g,datasetIndex:v,index:E}],s=R):R===s&&u.push({element:g,datasetIndex:v,index:E})}),u}function g5(n,e,t,r){const i=t1(e,n),o=[],s=t.axis,u="x"===s?"inXRange":"inYRange";let f=!1;return function(n,e){const t=n.getSortedVisibleDatasetMetas();let r,i,o;for(let s=0,u=t.length;s<u;++s){({index:r,data:i}=t[s]);for(let f=0,g=i.length;f<g;++f)o=i[f],o.skip||e(o,r,f)}}(n,(g,v,E)=>{g[u](i[s],r)&&o.push({element:g,datasetIndex:v,index:E}),g.inRange(i.x,i.y,r)&&(f=!0)}),t.intersect&&!f?[]:o}var Bae={modes:{index(n,e,t,r){const i=t1(e,n),o=t.axis||"x",s=t.intersect?SA(n,i,o,r):MA(n,i,o,!1,r),u=[];return s.length?(n.getSortedVisibleDatasetMetas().forEach(f=>{const g=s[0].index,v=f.data[g];v&&!v.skip&&u.push({element:v,datasetIndex:f.index,index:g})}),u):[]},dataset(n,e,t,r){const i=t1(e,n),o=t.axis||"xy";let s=t.intersect?SA(n,i,o,r):MA(n,i,o,!1,r);if(s.length>0){const u=s[0].datasetIndex,f=n.getDatasetMeta(u).data;s=[];for(let g=0;g<f.length;++g)s.push({element:f[g],datasetIndex:u,index:g})}return s},point:(n,e,t,r)=>SA(n,t1(e,n),t.axis||"xy",r),nearest:(n,e,t,r)=>MA(n,t1(e,n),t.axis||"xy",t.intersect,r),x:(n,e,t,r)=>(t.axis="x",g5(n,e,t,r)),y:(n,e,t,r)=>(t.axis="y",g5(n,e,t,r))}};const m5=["left","top","right","bottom"];function n1(n,e){return n.filter(t=>t.pos===e)}function _5(n,e){return n.filter(t=>-1===m5.indexOf(t.pos)&&t.box.axis===e)}function r1(n,e){return n.sort((t,r)=>{const i=e?r:t,o=e?t:r;return i.weight===o.weight?i.index-o.index:i.weight-o.weight})}function y5(n,e,t,r){return Math.max(n[t],e[t])+Math.max(n[r],e[r])}function v5(n,e){n.top=Math.max(n.top,e.top),n.left=Math.max(n.left,e.left),n.bottom=Math.max(n.bottom,e.bottom),n.right=Math.max(n.right,e.right)}function Gae(n,e,t,r){const{pos:i,box:o}=t,s=n.maxPadding;if(!Uo(i)){t.size&&(n[i]-=t.size);const E=r[t.stack]||{size:0,count:1};E.size=Math.max(E.size,t.horizontal?o.height:o.width),t.size=E.size/E.count,n[i]+=t.size}o.getPadding&&v5(s,o.getPadding());const u=Math.max(0,e.outerWidth-y5(s,n,"left","right")),f=Math.max(0,e.outerHeight-y5(s,n,"top","bottom")),g=u!==n.w,v=f!==n.h;return n.w=u,n.h=f,t.horizontal?{same:g,other:v}:{same:v,other:g}}function Hae(n,e){const t=e.maxPadding;return function(i){const o={left:0,top:0,right:0,bottom:0};return i.forEach(s=>{o[s]=Math.max(e[s],t[s])}),o}(n?["left","right"]:["top","bottom"])}function i1(n,e,t,r){const i=[];let o,s,u,f,g,v;for(o=0,s=n.length,g=0;o<s;++o){u=n[o],f=u.box,f.update(u.width||e.w,u.height||e.h,Hae(u.horizontal,e));const{same:E,other:T}=Gae(e,t,u,r);g|=E&&i.length,v=v||T,f.fullSize||i.push(u)}return g&&i1(i,e,t,r)||v}function mE(n,e,t,r,i){n.top=t,n.left=e,n.right=e+r,n.bottom=t+i,n.width=r,n.height=i}function x5(n,e,t,r){const i=t.padding;let{x:o,y:s}=e;for(const u of n){const f=u.box,g=r[u.stack]||{count:1,placed:0,weight:1},v=u.stackWeight/g.weight||1;if(u.horizontal){const E=e.w*v,T=g.size||f.height;Tc(g.start)&&(s=g.start),f.fullSize?mE(f,i.left,s,t.outerWidth-i.right-i.left,T):mE(f,e.left+g.placed,s,E,T),g.start=s,g.placed+=E,s=f.bottom}else{const E=e.h*v,T=g.size||f.width;Tc(g.start)&&(o=g.start),f.fullSize?mE(f,o,i.top,T,t.outerHeight-i.bottom-i.top):mE(f,o,e.top+g.placed,T,E),g.start=o,g.placed+=E,o=f.right}}e.x=o,e.y=s}Co.set("layout",{padding:{top:0,right:0,bottom:0,left:0}});var Uu={addBox(n,e){n.boxes||(n.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(t){e.draw(t)}}]},n.boxes.push(e)},removeBox(n,e){const t=n.boxes?n.boxes.indexOf(e):-1;-1!==t&&n.boxes.splice(t,1)},configure(n,e,t){e.fullSize=t.fullSize,e.position=t.position,e.weight=t.weight},update(n,e,t,r){if(!n)return;const i=dc(n.options.layout.padding),o=Math.max(e-i.width,0),s=Math.max(t-i.height,0),u=function(n){const e=function(n){const e=[];let t,r,i,o,s,u;for(t=0,r=(n||[]).length;t<r;++t)i=n[t],({position:o,options:{stack:s,stackWeight:u=1}}=i),e.push({index:t,box:i,pos:o,horizontal:i.isHorizontal(),weight:i.weight,stack:s&&o+s,stackWeight:u});return e}(n),t=r1(e.filter(g=>g.box.fullSize),!0),r=r1(n1(e,"left"),!0),i=r1(n1(e,"right")),o=r1(n1(e,"top"),!0),s=r1(n1(e,"bottom")),u=_5(e,"x"),f=_5(e,"y");return{fullSize:t,leftAndTop:r.concat(o),rightAndBottom:i.concat(f).concat(s).concat(u),chartArea:n1(e,"chartArea"),vertical:r.concat(i).concat(f),horizontal:o.concat(s).concat(u)}}(n.boxes),f=u.vertical,g=u.horizontal;bs(n.boxes,z=>{"function"==typeof z.beforeLayout&&z.beforeLayout()});const v=f.reduce((z,G)=>G.box.options&&!1===G.box.options.display?z:z+1,0)||1,E=Object.freeze({outerWidth:e,outerHeight:t,padding:i,availableWidth:o,availableHeight:s,vBoxMaxWidth:o/2/v,hBoxMaxHeight:s/2}),T=Object.assign({},i);v5(T,dc(r));const R=Object.assign({maxPadding:T,w:o,h:s,x:i.left,y:i.top},i),B=function(n,e){const t=function(n){const e={};for(const t of n){const{stack:r,pos:i,stackWeight:o}=t;if(!r||!m5.includes(i))continue;const s=e[r]||(e[r]={count:0,placed:0,weight:0,size:0});s.count++,s.weight+=o}return e}(n),{vBoxMaxWidth:r,hBoxMaxHeight:i}=e;let o,s,u;for(o=0,s=n.length;o<s;++o){u=n[o];const{fullSize:f}=u.box,g=t[u.stack],v=g&&u.stackWeight/g.weight;u.horizontal?(u.width=v?v*r:f&&e.availableWidth,u.height=i):(u.width=r,u.height=v?v*i:f&&e.availableHeight)}return t}(f.concat(g),E);i1(u.fullSize,R,E,B),i1(f,R,E,B),i1(g,R,E,B)&&i1(f,R,E,B),function(n){const e=n.maxPadding;function t(r){const i=Math.max(e[r]-n[r],0);return n[r]+=i,i}n.y+=t("top"),n.x+=t("left"),t("right"),t("bottom")}(R),x5(u.leftAndTop,R,E,B),R.x+=R.w,R.y+=R.h,x5(u.rightAndBottom,R,E,B),n.chartArea={left:R.left,top:R.top,right:R.left+R.w,bottom:R.top+R.h,height:R.h,width:R.w},bs(u.chartArea,z=>{const G=z.box;Object.assign(G,n.chartArea),G.update(R.w,R.h)})}};class b5{acquireContext(e,t){}releaseContext(e){return!1}addEventListener(e,t,r){}removeEventListener(e,t,r){}getDevicePixelRatio(){return 1}getMaximumSize(e,t,r,i){return t=Math.max(0,t||e.width),r=r||e.height,{width:t,height:Math.max(0,i?Math.floor(t/i):r)}}isAttached(e){return!0}}class qae extends b5{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}}const _E="$chartjs",Wae={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},w5=n=>null===n||""===n,E5=!!Hse&&{passive:!0};function Zae(n,e,t){n.canvas.removeEventListener(e,t,E5)}function Jae(n,e,t){const r=n.canvas,o=r&&ty(r)||r,s=new MutationObserver(u=>{const f=ty(o);u.forEach(g=>{for(let v=0;v<g.addedNodes.length;v++){const E=g.addedNodes[v];(E===o||E===f)&&t(g.target)}})});return s.observe(document,{childList:!0,subtree:!0}),s}function Qae(n,e,t){const r=n.canvas,i=r&&ty(r);if(!i)return;const o=new MutationObserver(s=>{s.forEach(u=>{for(let f=0;f<u.removedNodes.length;f++)if(u.removedNodes[f]===r){t();break}})});return o.observe(i,{childList:!0}),o}const o1=new Map;let C5=0;function S5(){const n=window.devicePixelRatio;n!==C5&&(C5=n,o1.forEach((e,t)=>{t.currentDevicePixelRatio!==n&&e()}))}function nle(n,e,t){const r=n.canvas,i=r&&ty(r);if(!i)return;const o=l4((u,f)=>{const g=i.clientWidth;t(u,f),g<i.clientWidth&&t()},window),s=new ResizeObserver(u=>{const f=u[0],g=f.contentRect.width,v=f.contentRect.height;0===g&&0===v||o(g,v)});return s.observe(i),function(n,e){o1.size||window.addEventListener("resize",S5),o1.set(n,e)}(n,o),s}function TA(n,e,t){t&&t.disconnect(),"resize"===e&&function(n){o1.delete(n),o1.size||window.removeEventListener("resize",S5)}(n)}function rle(n,e,t){const r=n.canvas,i=l4(o=>{null!==n.ctx&&t(function(n,e){const t=Wae[n.type]||n.type,{x:r,y:i}=U4(n,e);return{type:t,chart:e,native:n,x:void 0!==r?r:null,y:void 0!==i?i:null}}(o,n))},n,o=>{const s=o[0];return[s,s.offsetX,s.offsetY]});return function(n,e,t){n.addEventListener(e,t,E5)}(r,e,i),i}class ile extends b5{acquireContext(e,t){const r=e&&e.getContext&&e.getContext("2d");return r&&r.canvas===e?(function(n,e){const t=n.style,r=n.getAttribute("height"),i=n.getAttribute("width");if(n[_E]={initial:{height:r,width:i,style:{display:t.display,height:t.height,width:t.width}}},t.display=t.display||"block",t.boxSizing=t.boxSizing||"border-box",w5(i)){const o=G4(n,"width");void 0!==o&&(n.width=o)}if(w5(r))if(""===n.style.height)n.height=n.width/(e||2);else{const o=G4(n,"height");void 0!==o&&(n.height=o)}}(e,t),r):null}releaseContext(e){const t=e.canvas;if(!t[_E])return!1;const r=t[_E].initial;["height","width"].forEach(o=>{const s=r[o];Wo(s)?t.removeAttribute(o):t.setAttribute(o,s)});const i=r.style||{};return Object.keys(i).forEach(o=>{t.style[o]=i[o]}),t.width=t.width,delete t[_E],!0}addEventListener(e,t,r){this.removeEventListener(e,t),(e.$proxies||(e.$proxies={}))[t]=({attach:Jae,detach:Qae,resize:nle}[t]||rle)(e,t,r)}removeEventListener(e,t){const r=e.$proxies||(e.$proxies={}),i=r[t];i&&(({attach:TA,detach:TA,resize:TA}[t]||Zae)(e,t,i),r[t]=void 0)}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,t,r,i){return function(n,e,t,r){const i=gE(n),o=Wg(i,"margin"),s=pE(i.maxWidth,n,"clientWidth")||eE,u=pE(i.maxHeight,n,"clientHeight")||eE,f=function(n,e,t){let r,i;if(void 0===e||void 0===t){const o=ty(n);if(o){const s=o.getBoundingClientRect(),u=gE(o),f=Wg(u,"border","width"),g=Wg(u,"padding");e=s.width-g.width-f.width,t=s.height-g.height-f.height,r=pE(u.maxWidth,o,"clientWidth"),i=pE(u.maxHeight,o,"clientHeight")}else e=n.clientWidth,t=n.clientHeight}return{width:e,height:t,maxWidth:r||eE,maxHeight:i||eE}}(n,e,t);let{width:g,height:v}=f;if("content-box"===i.boxSizing){const E=Wg(i,"border","width"),T=Wg(i,"padding");g-=T.width+E.width,v-=T.height+E.height}return g=Math.max(0,g-o.width),v=Math.max(0,r?Math.floor(g/r):v-o.height),g=bA(Math.min(g,s,f.maxWidth)),v=bA(Math.min(v,u,f.maxHeight)),g&&!v&&(v=bA(g/2)),{width:g,height:v}}(e,t,r,i)}isAttached(e){const t=ty(e);return!(!t||!t.isConnected)}}class fd{constructor(){this.x=void 0,this.y=void 0,this.active=!1,this.options=void 0,this.$animations=void 0}tooltipPosition(e){const{x:t,y:r}=this.getProps(["x","y"],e);return{x:t,y:r}}hasValue(){return J_(this.x)&&J_(this.y)}getProps(e,t){const r=this,i=this.$animations;if(!t||!i)return r;const o={};return e.forEach(s=>{o[s]=i[s]&&i[s].active()?i[s]._to:r[s]}),o}}fd.defaults={},fd.defaultRoutes=void 0;const M5={values:n=>Zs(n)?n:""+n,numeric(n,e,t){if(0===n)return"0";const r=this.chart.options.locale;let i,o=n;if(t.length>1){const g=Math.max(Math.abs(t[0].value),Math.abs(t[t.length-1].value));(g<1e-4||g>1e15)&&(i="scientific"),o=function(n,e){let t=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(t)>=1&&n!==Math.floor(n)&&(t=n-Math.floor(n)),t}(n,t)}const s=Ph(Math.abs(o)),u=Math.max(Math.min(-1*Math.floor(s),20),0),f={notation:i,minimumFractionDigits:u,maximumFractionDigits:u};return Object.assign(f,this.options.ticks.format),Q0(n,r,f)},logarithmic(n,e,t){if(0===n)return"0";const r=n/Math.pow(10,Math.floor(Ph(n)));return 1===r||2===r||5===r?M5.numeric.call(this,n,e,t):""}};var yE={formatters:M5};function vE(n,e,t,r,i){const o=Qi(r,0),s=Math.min(Qi(i,n.length),n.length);let f,g,v,u=0;for(t=Math.ceil(t),i&&(f=i-r,t=f/Math.floor(f/t)),v=o;v<0;)u++,v=Math.round(o+u*t);for(g=Math.max(o,0);g<s;g++)g===v&&(e.push(n[g]),u++,v=Math.round(o+u*t))}Co.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",grace:0,grid:{display:!0,lineWidth:1,drawBorder:!0,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(n,e)=>e.lineWidth,tickColor:(n,e)=>e.color,offset:!1,borderDash:[],borderDashOffset:0,borderWidth:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:yE.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),Co.route("scale.ticks","color","","color"),Co.route("scale.grid","color","","borderColor"),Co.route("scale.grid","borderColor","","borderColor"),Co.route("scale.title","color","","color"),Co.describe("scale",{_fallback:!1,_scriptable:n=>!n.startsWith("before")&&!n.startsWith("after")&&"callback"!==n&&"parser"!==n,_indexable:n=>"borderDash"!==n&&"tickBorderDash"!==n}),Co.describe("scales",{_fallback:"scale"}),Co.describe("scale.ticks",{_scriptable:n=>"backdropPadding"!==n&&"callback"!==n,_indexable:n=>"backdropPadding"!==n});const T5=(n,e,t)=>"top"===e||"left"===e?n[e]+t:n[e]-t;function D5(n,e){const t=[],r=n.length/e,i=n.length;let o=0;for(;o<i;o+=r)t.push(n[Math.floor(o)]);return t}function ple(n,e,t){const r=n.ticks.length,i=Math.min(e,r-1),o=n._startPixel,s=n._endPixel,u=1e-6;let g,f=n.getPixelForTick(i);if(!(t&&(g=1===r?Math.max(f-o,s-f):0===e?(n.getPixelForTick(1)-f)/2:(f-n.getPixelForTick(i-1))/2,f+=i<e?g:-g,f<o-u||f>s+u)))return f}function s1(n){return n.drawTicks?n.tickLength:0}function I5(n,e){if(!n.display)return 0;const t=jl(n.font,e),r=dc(n.padding);return(Zs(n.text)?n.text.length:1)*t.lineHeight+r.height}function yle(n,e,t){let r=(n=>"start"===n?"left":"end"===n?"right":"center")(n);return(t&&"right"!==e||!t&&"right"===e)&&(r=(n=>"left"===n?"right":"right"===n?"left":n)(r)),r}class Zg extends fd{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){const t=this;t.options=e.setContext(t.getContext()),t.axis=e.axis,t._userMin=t.parse(e.min),t._userMax=t.parse(e.max),t._suggestedMin=t.parse(e.suggestedMin),t._suggestedMax=t.parse(e.suggestedMax)}parse(e,t){return e}getUserBounds(){let{_userMin:e,_userMax:t,_suggestedMin:r,_suggestedMax:i}=this;return e=Ah(e,Number.POSITIVE_INFINITY),t=Ah(t,Number.NEGATIVE_INFINITY),r=Ah(r,Number.POSITIVE_INFINITY),i=Ah(i,Number.NEGATIVE_INFINITY),{min:Ah(e,r),max:Ah(t,i),minDefined:ol(e),maxDefined:ol(t)}}getMinMax(e){const t=this;let u,{min:r,max:i,minDefined:o,maxDefined:s}=t.getUserBounds();if(o&&s)return{min:r,max:i};const f=t.getMatchingVisibleMetas();for(let g=0,v=f.length;g<v;++g)u=f[g].controller.getMinMax(t,e),o||(r=Math.min(r,u.min)),s||(i=Math.max(i,u.max));return{min:Ah(r,Ah(i,r)),max:Ah(i,Ah(r,i))}}getPadding(){const e=this;return{left:e.paddingLeft||0,top:e.paddingTop||0,right:e.paddingRight||0,bottom:e.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){Ks(this.options.beforeUpdate,[this])}update(e,t,r){const i=this,o=i.options.ticks,s=o.sampleSize;i.beforeUpdate(),i.maxWidth=e,i.maxHeight=t,i._margins=r=Object.assign({left:0,right:0,top:0,bottom:0},r),i.ticks=null,i._labelSizes=null,i._gridLineItems=null,i._labelItems=null,i.beforeSetDimensions(),i.setDimensions(),i.afterSetDimensions(),i._maxLength=i.isHorizontal()?i.width+r.left+r.right:i.height+r.top+r.bottom,i._dataLimitsCached||(i.beforeDataLimits(),i.determineDataLimits(),i.afterDataLimits(),i._range=function(n,e){const{min:t,max:r}=n;return{min:t-Math.abs(iA(e,t)),max:r+iA(e,r)}}(i,i.options.grace),i._dataLimitsCached=!0),i.beforeBuildTicks(),i.ticks=i.buildTicks()||[],i.afterBuildTicks();const u=s<i.ticks.length;i._convertTicksToLabels(u?D5(i.ticks,s):i.ticks),i.configure(),i.beforeCalculateLabelRotation(),i.calculateLabelRotation(),i.afterCalculateLabelRotation(),o.display&&(o.autoSkip||"auto"===o.source)&&(i.ticks=function(n,e){const t=n.options.ticks,r=t.maxTicksLimit||function(n){const e=n.options.offset,t=n._tickSize();return Math.floor(Math.min(n._length/t+(e?0:1),n._maxLength/t))}(n),i=t.major.enabled?function(n){const e=[];let t,r;for(t=0,r=n.length;t<r;t++)n[t].major&&e.push(t);return e}(e):[],o=i.length,s=i[0],u=i[o-1],f=[];if(o>r)return function(n,e,t,r){let s,i=0,o=t[0];for(r=Math.ceil(r),s=0;s<n.length;s++)s===o&&(e.push(n[s]),i++,o=t[i*r])}(e,f,i,o/r),f;const g=function(n,e,t){const r=function(n){const e=n.length;let t,r;if(e<2)return!1;for(r=n[0],t=1;t<e;++t)if(n[t]-n[t-1]!==r)return!1;return r}(n),i=e.length/t;if(!r)return Math.max(i,1);const o=function(n){const e=[],t=Math.sqrt(n);let r;for(r=1;r<t;r++)n%r==0&&(e.push(r),e.push(n/r));return t===(0|t)&&e.push(t),e.sort((i,o)=>i-o).pop(),e}(r);for(let s=0,u=o.length-1;s<u;s++){const f=o[s];if(f>i)return f}return Math.max(i,1)}(i,e,r);if(o>0){let v,E;const T=o>1?Math.round((u-s)/(o-1)):null;for(vE(e,f,g,Wo(T)?0:s-T,s),v=0,E=o-1;v<E;v++)vE(e,f,g,i[v],i[v+1]);return vE(e,f,g,u,Wo(T)?e.length:u+T),f}return vE(e,f,g),f}(i,i.ticks),i._labelSizes=null),u&&i._convertTicksToLabels(i.ticks),i.beforeFit(),i.fit(),i.afterFit(),i.afterUpdate()}configure(){const e=this;let r,i,t=e.options.reverse;e.isHorizontal()?(r=e.left,i=e.right):(r=e.top,i=e.bottom,t=!t),e._startPixel=r,e._endPixel=i,e._reversePixels=t,e._length=i-r,e._alignToPixels=e.options.alignToPixels}afterUpdate(){Ks(this.options.afterUpdate,[this])}beforeSetDimensions(){Ks(this.options.beforeSetDimensions,[this])}setDimensions(){const e=this;e.isHorizontal()?(e.width=e.maxWidth,e.left=0,e.right=e.width):(e.height=e.maxHeight,e.top=0,e.bottom=e.height),e.paddingLeft=0,e.paddingTop=0,e.paddingRight=0,e.paddingBottom=0}afterSetDimensions(){Ks(this.options.afterSetDimensions,[this])}_callHooks(e){const t=this;t.chart.notifyPlugins(e,t.getContext()),Ks(t.options[e],[t])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){Ks(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const t=this,r=t.options.ticks;let i,o,s;for(i=0,o=e.length;i<o;i++)s=e[i],s.label=Ks(r.callback,[s.value,i,e],t)}afterTickToLabelConversion(){Ks(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){Ks(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this,t=e.options,r=t.ticks,i=e.ticks.length,o=r.minRotation||0,s=r.maxRotation;let f,g,v,u=o;if(!e._isVisible()||!r.display||o>=s||i<=1||!e.isHorizontal())return void(e.labelRotation=o);const E=e._getLabelSizes(),T=E.widest.width,R=E.highest.height,B=su(e.chart.width-T,0,e.maxWidth);f=t.offset?e.maxWidth/i:B/(i-1),T+6>f&&(f=B/(i-(t.offset?.5:1)),g=e.maxHeight-s1(t.grid)-r.padding-I5(t.title,e.chart.options.font),v=Math.sqrt(T*T+R*R),u=sA(Math.min(Math.asin(su((E.highest.height+6)/f,-1,1)),Math.asin(su(g/v,-1,1))-Math.asin(su(R/v,-1,1)))),u=Math.max(o,Math.min(s,u))),e.labelRotation=u}afterCalculateLabelRotation(){Ks(this.options.afterCalculateLabelRotation,[this])}beforeFit(){Ks(this.options.beforeFit,[this])}fit(){const e=this,t={width:0,height:0},{chart:r,options:{ticks:i,title:o,grid:s}}=e,u=e._isVisible(),f=e.isHorizontal();if(u){const g=I5(o,r.options.font);if(f?(t.width=e.maxWidth,t.height=s1(s)+g):(t.height=e.maxHeight,t.width=s1(s)+g),i.display&&e.ticks.length){const{first:v,last:E,widest:T,highest:R}=e._getLabelSizes(),B=2*i.padding,z=hd(e.labelRotation),G=Math.cos(z),W=Math.sin(z);f?t.height=Math.min(e.maxHeight,t.height+(i.mirror?0:W*T.width+G*R.height)+B):t.width=Math.min(e.maxWidth,t.width+(i.mirror?0:G*T.width+W*R.height)+B),e._calculatePadding(v,E,W,G)}}e._handleMargins(),f?(e.width=e._length=r.width-e._margins.left-e._margins.right,e.height=t.height):(e.width=t.width,e.height=e._length=r.height-e._margins.top-e._margins.bottom)}_calculatePadding(e,t,r,i){const o=this,{ticks:{align:s,padding:u},position:f}=o.options,g=0!==o.labelRotation,v="top"!==f&&"x"===o.axis;if(o.isHorizontal()){const E=o.getPixelForTick(0)-o.left,T=o.right-o.getPixelForTick(o.ticks.length-1);let R=0,B=0;g?v?(R=i*e.width,B=r*t.height):(R=r*e.height,B=i*t.width):"start"===s?B=t.width:"end"===s?R=e.width:(R=e.width/2,B=t.width/2),o.paddingLeft=Math.max((R-E+u)*o.width/(o.width-E),0),o.paddingRight=Math.max((B-T+u)*o.width/(o.width-T),0)}else{let E=t.height/2,T=e.height/2;"start"===s?(E=0,T=e.height):"end"===s&&(E=t.height,T=0),o.paddingTop=E+u,o.paddingBottom=T+u}}_handleMargins(){const e=this;e._margins&&(e._margins.left=Math.max(e.paddingLeft,e._margins.left),e._margins.top=Math.max(e.paddingTop,e._margins.top),e._margins.right=Math.max(e.paddingRight,e._margins.right),e._margins.bottom=Math.max(e.paddingBottom,e._margins.bottom))}afterFit(){Ks(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:t}=this.options;return"top"===t||"bottom"===t||"x"===e}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){const t=this;let r,i;for(t.beforeTickToLabelConversion(),t.generateTickLabels(e),r=0,i=e.length;r<i;r++)Wo(e[r].label)&&(e.splice(r,1),i--,r--);t.afterTickToLabelConversion()}_getLabelSizes(){const e=this;let t=e._labelSizes;if(!t){const r=e.options.ticks.sampleSize;let i=e.ticks;r<i.length&&(i=D5(i,r)),e._labelSizes=t=e._computeLabelSizes(i,i.length)}return t}_computeLabelSizes(e,t){const{ctx:r,_longestTextCache:i}=this,o=[],s=[];let g,v,E,T,R,B,z,G,W,H,ee,u=0,f=0;for(g=0;g<t;++g){if(T=e[g].label,R=this._resolveTickFontOptions(g),r.font=B=R.string,z=i[B]=i[B]||{data:{},gc:[]},G=R.lineHeight,W=H=0,Wo(T)||Zs(T)){if(Zs(T))for(v=0,E=T.length;v<E;++v)ee=T[v],!Wo(ee)&&!Zs(ee)&&(W=lE(r,z.data,z.gc,W,ee),H+=G)}else W=lE(r,z.data,z.gc,W,T),H=G;o.push(W),s.push(H),u=Math.max(W,u),f=Math.max(H,f)}!function(n,e){bs(n,t=>{const r=t.gc,i=r.length/2;let o;if(i>e){for(o=0;o<i;++o)delete t.data[r[o]];r.splice(0,i)}})}(i,t);const _e=o.indexOf(u),ye=s.indexOf(f),$e=We=>({width:o[We]||0,height:s[We]||0});return{first:$e(0),last:$e(t-1),widest:$e(_e),highest:$e(ye),widths:o,heights:s}}getLabelForValue(e){return e}getPixelForValue(e,t){return NaN}getValueForPixel(e){}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getPixelForDecimal(e){const t=this;t._reversePixels&&(e=1-e);const r=t._startPixel+e*t._length;return function(n){return su(n,-32768,32767)}(t._alignToPixels?$g(t.chart,r,0):r)}getDecimalForPixel(e){const t=(e-this._startPixel)/this._length;return this._reversePixels?1-t:t}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:t}=this;return e<0&&t<0?t:e>0&&t>0?e:0}getContext(e){const t=this,r=t.ticks||[];if(e>=0&&e<r.length){const i=r[e];return i.$context||(i.$context=function(n,e,t){return Object.assign(Object.create(n),{tick:t,index:e,type:"tick"})}(t.getContext(),e,i))}return t.$context||(t.$context=function(n,e){return Object.assign(Object.create(n),{scale:e,type:"scale"})}(t.chart.getContext(),t))}_tickSize(){const e=this,t=e.options.ticks,r=hd(e.labelRotation),i=Math.abs(Math.cos(r)),o=Math.abs(Math.sin(r)),s=e._getLabelSizes(),u=t.autoSkipPadding||0,f=s?s.widest.width+u:0,g=s?s.highest.height+u:0;return e.isHorizontal()?g*i>f*o?f/i:g/o:g*o<f*i?g/i:f/o}_isVisible(){const e=this.options.display;return"auto"!==e?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const t=this,r=t.axis,i=t.chart,o=t.options,{grid:s,position:u}=o,f=s.offset,g=t.isHorizontal(),E=t.ticks.length+(f?1:0),T=s1(s),R=[],B=s.setContext(t.getContext()),z=B.drawBorder?B.borderWidth:0,G=z/2,W=function(Tt){return $g(i,Tt,z)};let H,ee,_e,ye,$e,We,rt,ke,_n,on,zn,An;if("top"===u)H=W(t.bottom),We=t.bottom-T,ke=H-G,on=W(e.top)+G,An=e.bottom;else if("bottom"===u)H=W(t.top),on=e.top,An=W(e.bottom)-G,We=H+G,ke=t.top+T;else if("left"===u)H=W(t.right),$e=t.right-T,rt=H-G,_n=W(e.left)+G,zn=e.right;else if("right"===u)H=W(t.left),_n=e.left,zn=W(e.right)-G,$e=H+G,rt=t.left+T;else if("x"===r){if("center"===u)H=W((e.top+e.bottom)/2+.5);else if(Uo(u)){const Tt=Object.keys(u)[0];H=W(t.chart.scales[Tt].getPixelForValue(u[Tt]))}on=e.top,An=e.bottom,We=H+G,ke=We+T}else if("y"===r){if("center"===u)H=W((e.left+e.right)/2);else if(Uo(u)){const Tt=Object.keys(u)[0];H=W(t.chart.scales[Tt].getPixelForValue(u[Tt]))}$e=H-G,rt=$e-T,_n=e.left,zn=e.right}const sn=Qi(o.ticks.maxTicksLimit,E),qn=Math.max(1,Math.ceil(E/sn));for(ee=0;ee<E;ee+=qn){const Tt=s.setContext(t.getContext(ee)),yn=Tt.lineWidth,kn=Tt.color,Un=s.borderDash||[],$i=Tt.borderDashOffset,ho=Tt.tickWidth,Hi=Tt.tickColor,ni=Tt.tickBorderDash||[],Rr=Tt.tickBorderDashOffset;_e=ple(t,ee,f),void 0!==_e&&(ye=$g(i,_e,yn),g?$e=rt=_n=zn=ye:We=ke=on=An=ye,R.push({tx1:$e,ty1:We,tx2:rt,ty2:ke,x1:_n,y1:on,x2:zn,y2:An,width:yn,color:kn,borderDash:Un,borderDashOffset:$i,tickWidth:ho,tickColor:Hi,tickBorderDash:ni,tickBorderDashOffset:Rr}))}return t._ticksLength=E,t._borderValue=H,R}_computeLabelItems(e){const t=this,r=t.axis,i=t.options,{position:o,ticks:s}=i,u=t.isHorizontal(),f=t.ticks,{align:g,crossAlign:v,padding:E,mirror:T}=s,R=s1(i.grid),B=R+E,z=T?-E:B,G=-hd(t.labelRotation),W=[];let H,ee,_e,ye,$e,We,rt,ke,_n,on,zn,An,sn="middle";if("top"===o)We=t.bottom-z,rt=t._getXAxisLabelAlignment();else if("bottom"===o)We=t.top+z,rt=t._getXAxisLabelAlignment();else if("left"===o){const Tt=t._getYAxisLabelAlignment(R);rt=Tt.textAlign,$e=Tt.x}else if("right"===o){const Tt=t._getYAxisLabelAlignment(R);rt=Tt.textAlign,$e=Tt.x}else if("x"===r){if("center"===o)We=(e.top+e.bottom)/2+B;else if(Uo(o)){const Tt=Object.keys(o)[0];We=t.chart.scales[Tt].getPixelForValue(o[Tt])+B}rt=t._getXAxisLabelAlignment()}else if("y"===r){if("center"===o)$e=(e.left+e.right)/2-B;else if(Uo(o)){const Tt=Object.keys(o)[0];$e=t.chart.scales[Tt].getPixelForValue(o[Tt])}rt=t._getYAxisLabelAlignment(R).textAlign}"y"===r&&("start"===g?sn="top":"end"===g&&(sn="bottom"));const qn=t._getLabelSizes();for(H=0,ee=f.length;H<ee;++H){_e=f[H],ye=_e.label;const Tt=s.setContext(t.getContext(H));ke=t.getPixelForTick(H)+s.labelOffset,_n=t._resolveTickFontOptions(H),on=_n.lineHeight,zn=Zs(ye)?ye.length:1;const yn=zn/2,kn=Tt.color,Un=Tt.textStrokeColor,$i=Tt.textStrokeWidth;let ho;if(u?($e=ke,An="top"===o?"near"===v||0!==G?-zn*on+on/2:"center"===v?-qn.highest.height/2-yn*on+on:on/2-qn.highest.height:"near"===v||0!==G?on/2:"center"===v?qn.highest.height/2-yn*on:qn.highest.height-zn*on,T&&(An*=-1)):(We=ke,An=(1-zn)*on/2),Tt.showLabelBackdrop){const Hi=dc(Tt.backdropPadding),ni=qn.heights[H],Rr=qn.widths[H];let cs=We+An-Hi.top,da=$e-Hi.left;switch(sn){case"middle":cs-=ni/2;break;case"bottom":cs-=ni}switch(rt){case"center":da-=Rr/2;break;case"right":da-=Rr}ho={left:da,top:cs,width:Rr+Hi.width,height:ni+Hi.height,color:Tt.backdropColor}}W.push({rotation:G,label:ye,font:_n,color:kn,strokeColor:Un,strokeWidth:$i,textOffset:An,textAlign:rt,textBaseline:sn,translation:[$e,We],backdrop:ho})}return W}_getXAxisLabelAlignment(){const{position:t,ticks:r}=this.options;if(-hd(this.labelRotation))return"top"===t?"left":"right";let o="center";return"start"===r.align?o="left":"end"===r.align&&(o="right"),o}_getYAxisLabelAlignment(e){const t=this,{position:r,ticks:{crossAlign:i,mirror:o,padding:s}}=t.options,f=e+s,g=t._getLabelSizes().widest.width;let v,E;return"left"===r?o?(E=t.right+s,"near"===i?v="left":"center"===i?(v="center",E+=g/2):(v="right",E+=g)):(E=t.right-f,"near"===i?v="right":"center"===i?(v="center",E-=g/2):(v="left",E=t.left)):"right"===r?o?(E=t.left+s,"near"===i?v="right":"center"===i?(v="center",E-=g/2):(v="left",E-=g)):(E=t.left+f,"near"===i?v="left":"center"===i?(v="center",E+=g/2):(v="right",E=t.right)):v="right",{textAlign:v,x:E}}_computeLabelArea(){const e=this;if(e.options.ticks.mirror)return;const t=e.chart,r=e.options.position;return"left"===r||"right"===r?{top:0,left:e.left,bottom:t.height,right:e.right}:"top"===r||"bottom"===r?{top:e.top,left:0,bottom:e.bottom,right:t.width}:void 0}drawBackground(){const{ctx:e,options:{backgroundColor:t},left:r,top:i,width:o,height:s}=this;t&&(e.save(),e.fillStyle=t,e.fillRect(r,i,o,s),e.restore())}getLineWidthForValue(e){const t=this,r=t.options.grid;if(!t._isVisible()||!r.display)return 0;const o=t.ticks.findIndex(s=>s.value===e);return o>=0?r.setContext(t.getContext(o)).lineWidth:0}drawGrid(e){const t=this,r=t.options.grid,i=t.ctx,o=t._gridLineItems||(t._gridLineItems=t._computeGridLineItems(e));let s,u;const f=(g,v,E)=>{!E.width||!E.color||(i.save(),i.lineWidth=E.width,i.strokeStyle=E.color,i.setLineDash(E.borderDash||[]),i.lineDashOffset=E.borderDashOffset,i.beginPath(),i.moveTo(g.x,g.y),i.lineTo(v.x,v.y),i.stroke(),i.restore())};if(r.display)for(s=0,u=o.length;s<u;++s){const g=o[s];r.drawOnChartArea&&f({x:g.x1,y:g.y1},{x:g.x2,y:g.y2},g),r.drawTicks&&f({x:g.tx1,y:g.ty1},{x:g.tx2,y:g.ty2},{color:g.tickColor,width:g.tickWidth,borderDash:g.tickBorderDash,borderDashOffset:g.tickBorderDashOffset})}}drawBorder(){const e=this,{chart:t,ctx:r,options:{grid:i}}=e,o=i.setContext(e.getContext()),s=i.drawBorder?o.borderWidth:0;if(!s)return;const u=i.setContext(e.getContext(0)).lineWidth,f=e._borderValue;let g,v,E,T;e.isHorizontal()?(g=$g(t,e.left,s)-s/2,v=$g(t,e.right,u)+u/2,E=T=f):(E=$g(t,e.top,s)-s/2,T=$g(t,e.bottom,u)+u/2,g=v=f),r.save(),r.lineWidth=o.borderWidth,r.strokeStyle=o.borderColor,r.beginPath(),r.moveTo(g,E),r.lineTo(v,T),r.stroke(),r.restore()}drawLabels(e){const t=this;if(!t.options.ticks.display)return;const i=t.ctx,o=t._computeLabelArea();o&&cE(i,o);const s=t._labelItems||(t._labelItems=t._computeLabelItems(e));let u,f;for(u=0,f=s.length;u<f;++u){const g=s[u],v=g.font,E=g.label;g.backdrop&&(i.fillStyle=g.backdrop.color,i.fillRect(g.backdrop.left,g.backdrop.top,g.backdrop.width,g.backdrop.height)),qg(i,E,0,g.textOffset,v,g)}o&&hE(i)}drawTitle(){const{ctx:e,options:{position:t,title:r,reverse:i}}=this;if(!r.display)return;const o=jl(r.font),s=dc(r.padding),u=r.align;let f=o.lineHeight/2;"bottom"===t||"center"===t||Uo(t)?(f+=s.bottom,Zs(r.text)&&(f+=o.lineHeight*(r.text.length-1))):f+=s.top;const{titleX:g,titleY:v,maxWidth:E,rotation:T}=function(n,e,t,r){const{top:i,left:o,bottom:s,right:u,chart:f}=n,{chartArea:g,scales:v}=f;let T,R,B,E=0;const z=s-i,G=u-o;if(n.isHorizontal()){if(R=Vu(r,o,u),Uo(t)){const W=Object.keys(t)[0];B=v[W].getPixelForValue(t[W])+z-e}else B="center"===t?(g.bottom+g.top)/2+z-e:T5(n,t,e);T=u-o}else{if(Uo(t)){const W=Object.keys(t)[0];R=v[W].getPixelForValue(t[W])-G+e}else R="center"===t?(g.left+g.right)/2-G+e:T5(n,t,e);B=Vu(r,s,i),E="left"===t?-sl:sl}return{titleX:R,titleY:B,maxWidth:T,rotation:E}}(this,f,t,u);qg(e,r.text,0,0,o,{color:r.color,maxWidth:E,rotation:T,textAlign:yle(u,t,i),textBaseline:"middle",translation:[g,v]})}draw(e){const t=this;!t._isVisible()||(t.drawBackground(),t.drawGrid(e),t.drawBorder(),t.drawTitle(),t.drawLabels(e))}_layers(){const e=this,t=e.options,r=t.ticks&&t.ticks.z||0,i=Qi(t.grid&&t.grid.z,-1);return e._isVisible()&&e.draw===Zg.prototype.draw?[{z:i,draw(o){e.drawBackground(),e.drawGrid(o),e.drawTitle()}},{z:i+1,draw(){e.drawBorder()}},{z:r,draw(o){e.drawLabels(o)}}]:[{z:r,draw(o){e.draw(o)}}]}getMatchingVisibleMetas(e){const t=this,r=t.chart.getSortedVisibleDatasetMetas(),i=t.axis+"AxisID",o=[];let s,u;for(s=0,u=r.length;s<u;++s){const f=r[s];f[i]===t.id&&(!e||f.type===e)&&o.push(f)}return o}_resolveTickFontOptions(e){return jl(this.options.ticks.setContext(this.getContext(e)).font)}_maxDigits(){const e=this,t=e._resolveTickFontOptions(0).lineHeight;return(e.isHorizontal()?e.width:e.height)/t}}class xE{constructor(e,t,r){this.type=e,this.scope=t,this.override=r,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const t=this,r=Object.getPrototypeOf(e);let i;(function(n){return"id"in n&&"defaults"in n})(r)&&(i=t.register(r));const o=t.items,s=e.id,u=t.scope+"."+s;if(!s)throw new Error("class does not have id: "+e);return s in o||(o[s]=e,function(n,e,t){const r=G0(Object.create(null),[t?Co.get(t):{},Co.get(e),n.defaults]);Co.set(e,r),n.defaultRoutes&&function(n,e){Object.keys(e).forEach(t=>{const r=t.split("."),i=r.pop(),o=[n].concat(r).join("."),s=e[t].split("."),u=s.pop(),f=s.join(".");Co.route(o,i,f,u)})}(e,n.defaultRoutes),n.descriptors&&Co.describe(e,n.descriptors)}(e,u,i),t.override&&Co.override(e.id,e.overrides)),u}get(e){return this.items[e]}unregister(e){const t=this.items,r=e.id,i=this.scope;r in t&&delete t[r],i&&r in Co[i]&&(delete Co[i][r],this.override&&delete Gg[r])}}var Bf=new class{constructor(){this.controllers=new xE(Ff,"datasets",!0),this.elements=new xE(fd,"elements"),this.plugins=new xE(Object,"plugins"),this.scales=new xE(Zg,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,t,r){const i=this;[...t].forEach(o=>{const s=r||i._getRegistryForType(o);r||s.isForType(o)||s===i.plugins&&o.id?i._exec(e,s,o):bs(o,u=>{const f=r||i._getRegistryForType(u);i._exec(e,f,u)})})}_exec(e,t,r){const i=oA(e);Ks(r["before"+i],[],r),t[e](r),Ks(r["after"+i],[],r)}_getRegistryForType(e){for(let t=0;t<this._typedRegistries.length;t++){const r=this._typedRegistries[t];if(r.isForType(e))return r}return this.plugins}_get(e,t,r){const i=t.get(e);if(void 0===i)throw new Error('"'+e+'" is not a registered '+r+".");return i}};class Cle{constructor(){this._init=[]}notify(e,t,r,i){const o=this;"beforeInit"===t&&(o._init=o._createDescriptors(e,!0),o._notify(o._init,e,"install"));const s=i?o._descriptors(e).filter(i):o._descriptors(e),u=o._notify(s,e,t,r);return"destroy"===t&&(o._notify(s,e,"stop"),o._notify(o._init,e,"uninstall")),u}_notify(e,t,r,i){i=i||{};for(const o of e){const s=o.plugin;if(!1===Ks(s[r],[t,i,o.options],s)&&i.cancelable)return!1}return!0}invalidate(){Wo(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const t=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),t}_createDescriptors(e,t){const r=e&&e.config,i=Qi(r.options&&r.options.plugins,{}),o=function(n){const e=[],t=Object.keys(Bf.plugins.items);for(let i=0;i<t.length;i++)e.push(Bf.getPlugin(t[i]));const r=n.plugins||[];for(let i=0;i<r.length;i++){const o=r[i];-1===e.indexOf(o)&&e.push(o)}return e}(r);return!1!==i||t?function(n,e,t,r){const i=[],o=n.getContext();for(let s=0;s<e.length;s++){const u=e[s],g=Mle(t[u.id],r);null!==g&&i.push({plugin:u,options:Dle(n.config,u,g,o)})}return i}(e,o,i,t):[]}_notifyStateChanges(e){const t=this._oldCache||[],r=this._cache,i=(o,s)=>o.filter(u=>!s.some(f=>u.plugin.id===f.plugin.id));this._notify(i(t,r),e,"stop"),this._notify(i(r,t),e,"start")}}function Mle(n,e){return e||!1!==n?!0===n?{}:n:null}function Dle(n,e,t,r){const i=n.pluginScopeKeys(e),o=n.getOptionScopes(t,i);return n.createResolver(o,r,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function DA(n,e){return((e.datasets||{})[n]||{}).indexAxis||e.indexAxis||(Co.datasets[n]||{}).indexAxis||"x"}function IA(n,e){return"x"===n||"y"===n?n:e.axis||function(n){return"top"===n||"bottom"===n?"x":"left"===n||"right"===n?"y":void 0}(e.position)||n.charAt(0).toLowerCase()}function A5(n){const e=n.options||(n.options={});e.plugins=Qi(e.plugins,{}),e.scales=function(n,e){const t=Gg[n.type]||{scales:{}},r=e.scales||{},i=DA(n.type,e),o=Object.create(null),s=Object.create(null);return Object.keys(r).forEach(u=>{const f=r[u],g=IA(u,f),v=function(n,e){return n===e?"_index_":"_value_"}(g,i),E=t.scales||{};o[g]=o[g]||u,s[u]=$0(Object.create(null),[{axis:g},f,E[g],E[v]])}),n.data.datasets.forEach(u=>{const f=u.type||n.type,g=u.indexAxis||DA(f,e),E=(Gg[f]||{}).scales||{};Object.keys(E).forEach(T=>{const R=function(n,e){let t=n;return"_index_"===n?t=e:"_value_"===n&&(t="x"===e?"y":"x"),t}(T,g),B=u[R+"AxisID"]||o[R]||R;s[B]=s[B]||Object.create(null),$0(s[B],[{axis:R},r[B],E[T]])})}),Object.keys(s).forEach(u=>{const f=s[u];$0(f,[Co.scales[f.type],Co.scale])}),s}(n,e)}function P5(n){return(n=n||{}).datasets=n.datasets||[],n.labels=n.labels||[],n}const R5=new Map,O5=new Set;function bE(n,e){let t=R5.get(n);return t||(t=e(),R5.set(n,t),O5.add(t)),t}const a1=(n,e,t)=>{const r=Rp(e,t);void 0!==r&&n.add(r)};class kle{constructor(e){this._config=function(n){return(n=n||{}).data=P5(n.data),A5(n),n}(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=P5(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),A5(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return bE(e,()=>[[`datasets.${e}`,""]])}datasetAnimationScopeKeys(e,t){return bE(`${e}.transition.${t}`,()=>[[`datasets.${e}.transitions.${t}`,`transitions.${t}`],[`datasets.${e}`,""]])}datasetElementScopeKeys(e,t){return bE(`${e}-${t}`,()=>[[`datasets.${e}.elements.${t}`,`datasets.${e}`,`elements.${t}`,""]])}pluginScopeKeys(e){const t=e.id;return bE(`${this.type}-plugin-${t}`,()=>[[`plugins.${t}`,...e.additionalOptionScopes||[]]])}_cachedScopes(e,t){const r=this._scopeCache;let i=r.get(e);return(!i||t)&&(i=new Map,r.set(e,i)),i}getOptionScopes(e,t,r){const{options:i,type:o}=this,s=this._cachedScopes(e,r),u=s.get(t);if(u)return u;const f=new Set;t.forEach(v=>{e&&(f.add(e),v.forEach(E=>a1(f,e,E))),v.forEach(E=>a1(f,i,E)),v.forEach(E=>a1(f,Gg[o]||{},E)),v.forEach(E=>a1(f,Co,E)),v.forEach(E=>a1(f,pA,E))});const g=Array.from(f);return 0===g.length&&g.push(Object.create(null)),O5.has(t)&&s.set(t,g),g}chartOptionScopes(){const{options:e,type:t}=this;return[e,Gg[t]||{},Co.datasets[t]||{},{type:t},Co,pA]}resolveNamedOptions(e,t,r,i=[""]){const o={$shared:!0},{resolver:s,subPrefixes:u}=k5(this._resolverCache,e,i);let f=s;(function(n,e){const{isScriptable:t,isIndexable:r}=R4(n);for(const i of e)if(t(i)&&K_(n[i])||r(i)&&Zs(n[i]))return!0;return!1})(s,t)&&(o.$shared=!1,f=Q_(s,r=K_(r)?r():r,this.createResolver(e,r,u)));for(const g of t)o[g]=f[g];return o}createResolver(e,t,r=[""],i){const{resolver:o}=k5(this._resolverCache,e,r);return Uo(t)?Q_(o,t,void 0,i):o}}function k5(n,e,t){let r=n.get(e);r||(r=new Map,n.set(e,r));const i=t.join();let o=r.get(i);return o||(o={resolver:vA(e,t),subPrefixes:t.filter(u=>!u.toLowerCase().includes("hover"))},r.set(i,o)),o}const Fle=["top","bottom","left","right","chartArea"];function L5(n,e){return"top"===n||"bottom"===n||-1===Fle.indexOf(n)&&"x"===e}function N5(n,e){return function(t,r){return t[n]===r[n]?t[e]-r[e]:t[n]-r[n]}}function F5(n){const e=n.chart,t=e.options.animation;e.notifyPlugins("afterRender"),Ks(t&&t.onComplete,[n],e)}function Ble(n){const e=n.chart,t=e.options.animation;Ks(t&&t.onProgress,[n],e)}function B5(n){return V4()&&"string"==typeof n?n=document.getElementById(n):n&&n.length&&(n=n[0]),n&&n.canvas&&(n=n.canvas),n}const wE={},z5=n=>{const e=B5(n);return Object.values(wE).filter(t=>t.canvas===e).pop()};class AA{constructor(e,t){const r=this,i=this.config=new kle(t),o=B5(e),s=z5(o);if(s)throw new Error("Canvas is already in use. Chart with ID '"+s.id+"' must be destroyed before the canvas can be reused.");const u=i.createResolver(i.chartOptionScopes(),r.getContext());this.platform=new(i.platform||function(n){return!V4()||"undefined"!=typeof OffscreenCanvas&&n instanceof OffscreenCanvas?qae:ile}(o));const f=r.platform.acquireContext(o,u.aspectRatio),g=f&&f.canvas,v=g&&g.height,E=g&&g.width;this.id=Ioe(),this.ctx=f,this.canvas=g,this.width=E,this.height=v,this._options=u,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new Cle,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=function(n,e){let t;return function(){return e?(clearTimeout(t),t=setTimeout(n,e)):n(),e}}(()=>this.update("resize"),u.resizeDelay||0),wE[r.id]=r,f&&g?(Nf.listen(r,"complete",F5),Nf.listen(r,"progress",Ble),r._initialize(),r.attached&&r.update()):console.error("Failed to create chart: can't acquire context from the given item")}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:t},width:r,height:i,_aspectRatio:o}=this;return Wo(e)?t&&o?o:i?r/i:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}_initialize(){const e=this;return e.notifyPlugins("beforeInit"),e.options.responsive?e.resize():j4(e,e.options.devicePixelRatio),e.bindEvents(),e.notifyPlugins("afterInit"),e}clear(){return T4(this.canvas,this.ctx),this}stop(){return Nf.stop(this),this}resize(e,t){Nf.running(this)?this._resizeBeforeDraw={width:e,height:t}:this._resize(e,t)}_resize(e,t){const r=this,i=r.options,u=r.platform.getMaximumSize(r.canvas,e,t,i.maintainAspectRatio&&r.aspectRatio),f=i.devicePixelRatio||r.platform.getDevicePixelRatio();r.width=u.width,r.height=u.height,r._aspectRatio=r.aspectRatio,j4(r,f,!0)&&(r.notifyPlugins("resize",{size:u}),Ks(i.onResize,[r,u],r),r.attached&&r._doResize()&&r.render())}ensureScalesHaveIDs(){bs(this.options.scales||{},(r,i)=>{r.id=i})}buildOrUpdateScales(){const e=this,t=e.options,r=t.scales,i=e.scales,o=Object.keys(i).reduce((u,f)=>(u[f]=!1,u),{});let s=[];r&&(s=s.concat(Object.keys(r).map(u=>{const f=r[u],g=IA(u,f),v="r"===g,E="x"===g;return{options:f,dposition:v?"chartArea":E?"bottom":"left",dtype:v?"radialLinear":E?"category":"linear"}}))),bs(s,u=>{const f=u.options,g=f.id,v=IA(g,f),E=Qi(f.type,u.dtype);(void 0===f.position||L5(f.position,v)!==L5(u.dposition))&&(f.position=u.dposition),o[g]=!0;let T=null;g in i&&i[g].type===E?T=i[g]:(T=new(Bf.getScale(E))({id:g,type:E,ctx:e.ctx,chart:e}),i[T.id]=T),T.init(f,t)}),bs(o,(u,f)=>{u||delete i[f]}),bs(i,u=>{Uu.configure(e,u,u.options),Uu.addBox(e,u)})}_updateMetasets(){const e=this,t=e._metasets,r=e.data.datasets.length,i=t.length;if(t.sort((o,s)=>o.index-s.index),i>r){for(let o=r;o<i;++o)e._destroyDatasetMeta(o);t.splice(r,i-r)}e._sortedMetasets=t.slice(0).sort(N5("order","index"))}_removeUnreferencedMetasets(){const e=this,{_metasets:t,data:{datasets:r}}=e;t.length>r.length&&delete e._stacks,t.forEach((i,o)=>{0===r.filter(s=>s===i._dataset).length&&e._destroyDatasetMeta(o)})}buildOrUpdateControllers(){const e=this,t=[],r=e.data.datasets;let i,o;for(e._removeUnreferencedMetasets(),i=0,o=r.length;i<o;i++){const s=r[i];let u=e.getDatasetMeta(i);const f=s.type||e.config.type;if(u.type&&u.type!==f&&(e._destroyDatasetMeta(i),u=e.getDatasetMeta(i)),u.type=f,u.indexAxis=s.indexAxis||DA(f,e.options),u.order=s.order||0,u.index=i,u.label=""+s.label,u.visible=e.isDatasetVisible(i),u.controller)u.controller.updateIndex(i),u.controller.linkScales();else{const g=Bf.getController(f),{datasetElementType:v,dataElementType:E}=Co.datasets[f];Object.assign(g.prototype,{dataElementType:Bf.getElement(E),datasetElementType:v&&Bf.getElement(v)}),u.controller=new g(e,i),t.push(u.controller)}}return e._updateMetasets(),t}_resetElements(){const e=this;bs(e.data.datasets,(t,r)=>{e.getDatasetMeta(r).controller.reset()},e)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const t=this,r=t.config;r.update(),t._options=r.createResolver(r.chartOptionScopes(),t.getContext()),bs(t.scales,g=>{Uu.removeBox(t,g)});const i=t._animationsDisabled=!t.options.animation;if(t.ensureScalesHaveIDs(),t.buildOrUpdateScales(),(!((n,e)=>{if(n.size!==e.size)return!1;for(const t of n)if(!e.has(t))return!1;return!0})(new Set(Object.keys(t._listeners)),new Set(t.options.events))||!!this._responsiveListeners!==t.options.responsive)&&(t.unbindEvents(),t.bindEvents()),t._plugins.invalidate(),!1===t.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0}))return;const u=t.buildOrUpdateControllers();t.notifyPlugins("beforeElementsUpdate");let f=0;for(let g=0,v=t.data.datasets.length;g<v;g++){const{controller:E}=t.getDatasetMeta(g),T=!i&&-1===u.indexOf(E);E.buildOrUpdateElements(T),f=Math.max(+E.getMaxOverflow(),f)}t._minPadding=f,t._updateLayout(f),i||bs(u,g=>{g.reset()}),t._updateDatasets(e),t.notifyPlugins("afterUpdate",{mode:e}),t._layers.sort(N5("z","_idx")),t._lastEvent&&t._eventHandler(t._lastEvent,!0),t.render()}_updateLayout(e){const t=this;if(!1===t.notifyPlugins("beforeLayout",{cancelable:!0}))return;Uu.update(t,t.width,t.height,e);const r=t.chartArea,i=r.width<=0||r.height<=0;t._layers=[],bs(t.boxes,o=>{i&&"chartArea"===o.position||(o.configure&&o.configure(),t._layers.push(...o._layers()))},t),t._layers.forEach((o,s)=>{o._idx=s}),t.notifyPlugins("afterLayout")}_updateDatasets(e){const t=this,r="function"==typeof e;if(!1!==t.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})){for(let i=0,o=t.data.datasets.length;i<o;++i)t._updateDataset(i,r?e({datasetIndex:i}):e);t.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,t){const r=this,i=r.getDatasetMeta(e),o={meta:i,index:e,mode:t,cancelable:!0};!1!==r.notifyPlugins("beforeDatasetUpdate",o)&&(i.controller._update(t),o.cancelable=!1,r.notifyPlugins("afterDatasetUpdate",o))}render(){const e=this;!1!==e.notifyPlugins("beforeRender",{cancelable:!0})&&(Nf.has(e)?e.attached&&!Nf.running(e)&&Nf.start(e):(e.draw(),F5({chart:e})))}draw(){const e=this;let t;if(e._resizeBeforeDraw){const{width:i,height:o}=e._resizeBeforeDraw;e._resize(i,o),e._resizeBeforeDraw=null}if(e.clear(),e.width<=0||e.height<=0||!1===e.notifyPlugins("beforeDraw",{cancelable:!0}))return;const r=e._layers;for(t=0;t<r.length&&r[t].z<=0;++t)r[t].draw(e.chartArea);for(e._drawDatasets();t<r.length;++t)r[t].draw(e.chartArea);e.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const r=this._sortedMetasets,i=[];let o,s;for(o=0,s=r.length;o<s;++o){const u=r[o];(!e||u.visible)&&i.push(u)}return i}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){const e=this;if(!1===e.notifyPlugins("beforeDatasetsDraw",{cancelable:!0}))return;const t=e.getSortedVisibleDatasetMetas();for(let r=t.length-1;r>=0;--r)e._drawDataset(t[r]);e.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const t=this,r=t.ctx,i=e._clip,o=!i.disabled,s=t.chartArea,u={meta:e,index:e.index,cancelable:!0};!1!==t.notifyPlugins("beforeDatasetDraw",u)&&(o&&cE(r,{left:!1===i.left?0:s.left-i.left,right:!1===i.right?t.width:s.right+i.right,top:!1===i.top?0:s.top-i.top,bottom:!1===i.bottom?t.height:s.bottom+i.bottom}),e.controller.draw(),o&&hE(r),u.cancelable=!1,t.notifyPlugins("afterDatasetDraw",u))}getElementsAtEventForMode(e,t,r,i){const o=Bae.modes[t];return"function"==typeof o?o(this,e,r,i):[]}getDatasetMeta(e){const r=this.data.datasets[e],i=this._metasets;let o=i.filter(s=>s&&s._dataset===r).pop();return o||(o={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:r&&r.order||0,index:e,_dataset:r,_parsed:[],_sorted:!1},i.push(o)),o}getContext(){return this.$context||(this.$context={chart:this,type:"chart"})}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const t=this.data.datasets[e];if(!t)return!1;const r=this.getDatasetMeta(e);return"boolean"==typeof r.hidden?!r.hidden:!t.hidden}setDatasetVisibility(e,t){this.getDatasetMeta(e).hidden=!t}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,t,r){const i=this,o=r?"show":"hide",s=i.getDatasetMeta(e),u=s.controller._resolveAnimations(void 0,o);Tc(t)?(s.data[t].hidden=!r,i.update()):(i.setDatasetVisibility(e,r),u.update(s,{visible:r}),i.update(f=>f.datasetIndex===e?o:void 0))}hide(e,t){this._updateVisibility(e,t,!1)}show(e,t){this._updateVisibility(e,t,!0)}_destroyDatasetMeta(e){const t=this,r=t._metasets&&t._metasets[e];r&&r.controller&&(r.controller._destroy(),delete t._metasets[e])}destroy(){const e=this,{canvas:t,ctx:r}=e;let i,o;for(e.stop(),Nf.remove(e),i=0,o=e.data.datasets.length;i<o;++i)e._destroyDatasetMeta(i);e.config.clearCache(),t&&(e.unbindEvents(),T4(t,r),e.platform.releaseContext(r),e.canvas=null,e.ctx=null),e.notifyPlugins("destroy"),delete wE[e.id]}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this,t=e._listeners,r=e.platform,o=function(s,u,f){s.offsetX=u,s.offsetY=f,e._eventHandler(s)};bs(e.options.events,s=>((s,u)=>{r.addEventListener(e,s,u),t[s]=u})(s,o))}bindResponsiveEvents(){const e=this;e._responsiveListeners||(e._responsiveListeners={});const t=e._responsiveListeners,r=e.platform,i=(g,v)=>{r.addEventListener(e,g,v),t[g]=v},o=(g,v)=>{t[g]&&(r.removeEventListener(e,g,v),delete t[g])},s=(g,v)=>{e.canvas&&e.resize(g,v)};let u;const f=()=>{o("attach",f),e.attached=!0,e.resize(),i("resize",s),i("detach",u)};u=()=>{e.attached=!1,o("resize",s),i("attach",f)},r.isAttached(e.canvas)?f():u()}unbindEvents(){const e=this;bs(e._listeners,(t,r)=>{e.platform.removeEventListener(e,r,t)}),e._listeners={},bs(e._responsiveListeners,(t,r)=>{e.platform.removeEventListener(e,r,t)}),e._responsiveListeners=void 0}updateHoverStyle(e,t,r){const i=r?"set":"remove";let o,s,u,f;for("dataset"===t&&(o=this.getDatasetMeta(e[0].datasetIndex),o.controller["_"+i+"DatasetHoverStyle"]()),u=0,f=e.length;u<f;++u){s=e[u];const g=s&&this.getDatasetMeta(s.datasetIndex).controller;g&&g[i+"HoverStyle"](s.element,s.datasetIndex,s.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const t=this,r=t._active||[],i=e.map(({datasetIndex:s,index:u})=>{const f=t.getDatasetMeta(s);if(!f)throw new Error("No dataset found at index "+s);return{datasetIndex:s,element:f.data[u],index:u}});!Jw(i,r)&&(t._active=i,t._updateHoverStyles(i,r))}notifyPlugins(e,t,r){return this._plugins.notify(this,e,t,r)}_updateHoverStyles(e,t,r){const i=this,o=i.options.hover,s=(g,v)=>g.filter(E=>!v.some(T=>E.datasetIndex===T.datasetIndex&&E.index===T.index)),u=s(t,e),f=r?e:s(e,t);u.length&&i.updateHoverStyle(u,o.mode,!1),f.length&&o.mode&&i.updateHoverStyle(f,o.mode,!0)}_eventHandler(e,t){const r=this,i={event:e,replay:t,cancelable:!0},o=u=>(u.options.events||this.options.events).includes(e.type);if(!1===r.notifyPlugins("beforeEvent",i,o))return;const s=r._handleEvent(e,t);return i.cancelable=!1,r.notifyPlugins("afterEvent",i,o),(s||i.changed)&&r.render(),r}_handleEvent(e,t){const r=this,{_active:i=[],options:o}=r,s=o.hover;let f=[],g=!1,v=null;return"mouseout"!==e.type&&(f=r.getElementsAtEventForMode(e,s.mode,s,t),v="click"===e.type?r._lastEvent:e),r._lastEvent=null,Hg(e,r.chartArea,r._minPadding)&&(Ks(o.onHover,[e,f,r],r),("mouseup"===e.type||"click"===e.type||"contextmenu"===e.type)&&Ks(o.onClick,[e,f,r],r)),g=!Jw(f,i),(g||t)&&(r._active=f,r._updateHoverStyles(f,i,t)),r._lastEvent=v,g}}const V5=()=>bs(AA.instances,n=>n._plugins.invalidate()),Op=!0;function U5(n,e,t){const{startAngle:r,pixelMargin:i,x:o,y:s,outerRadius:u,innerRadius:f}=e;let g=i/u;n.beginPath(),n.arc(o,s,u,r-g,t+g),f>i?(g=i/f,n.arc(o,s,f,t+g,r-g,!0)):n.arc(o,s,i,t+sl,r-sl),n.closePath(),n.clip()}function ry(n,e,t,r){return{x:t+n*Math.cos(e),y:r+n*Math.sin(e)}}function PA(n,e,t,r,i){const{x:o,y:s,startAngle:u,pixelMargin:f,innerRadius:g}=e,v=Math.max(e.outerRadius+r+t-f,0),E=g>0?g+r+t+f:0;let T=0;const R=i-u;if(r){const kn=((g>0?g-r:0)+(v>0?v-r:0))/2;T=(R-(0!==kn?R*kn/(kn+r):R))/2}const z=(R-Math.max(.001,R*v-t/Ya)/v)/2,G=u+z+T,W=i-z-T,{outerStart:H,outerEnd:ee,innerStart:_e,innerEnd:ye}=function(n,e,t,r){const i=function(n){return mA(n,["outerStart","outerEnd","innerStart","innerEnd"])}(n.options.borderRadius),o=(t-e)/2,s=Math.min(o,r*e/2),u=f=>{const g=(t-Math.min(o,f))*r/2;return su(f,0,Math.min(o,g))};return{outerStart:u(i.outerStart),outerEnd:u(i.outerEnd),innerStart:su(i.innerStart,0,s),innerEnd:su(i.innerEnd,0,s)}}(e,E,v,W-G),$e=v-H,We=v-ee,rt=G+H/$e,ke=W-ee/We,_n=E+_e,on=E+ye,zn=G+_e/_n,An=W-ye/on;if(n.beginPath(),n.arc(o,s,v,rt,ke),ee>0){const Tt=ry(We,ke,o,s);n.arc(Tt.x,Tt.y,ee,ke,W+sl)}const sn=ry(on,W,o,s);if(n.lineTo(sn.x,sn.y),ye>0){const Tt=ry(on,An,o,s);n.arc(Tt.x,Tt.y,ye,W+sl,An+Math.PI)}if(n.arc(o,s,E,W-ye/E,G+_e/E,!0),_e>0){const Tt=ry(_n,zn,o,s);n.arc(Tt.x,Tt.y,_e,zn+Math.PI,G-sl)}const qn=ry($e,G,o,s);if(n.lineTo(qn.x,qn.y),H>0){const Tt=ry($e,rt,o,s);n.arc(Tt.x,Tt.y,H,G-sl,rt)}n.closePath()}Object.defineProperties(AA,{defaults:{enumerable:Op,value:Co},instances:{enumerable:Op,value:wE},overrides:{enumerable:Op,value:Gg},registry:{enumerable:Op,value:Bf},version:{enumerable:Op,value:"3.5.1"},getChart:{enumerable:Op,value:z5},register:{enumerable:Op,value:(...n)=>{Bf.add(...n),V5()}},unregister:{enumerable:Op,value:(...n)=>{Bf.remove(...n),V5()}}});class EE extends fd{constructor(e){super(),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,e&&Object.assign(this,e)}inRange(e,t,r){const i=this.getProps(["x","y"],r),{angle:o,distance:s}=function(n,e){const t=e.x-n.x,r=e.y-n.y,i=Math.sqrt(t*t+r*r);let o=Math.atan2(r,t);return o<-.5*Ya&&(o+=Ns),{angle:o,distance:i}}(i,{x:e,y:t}),{startAngle:u,endAngle:f,innerRadius:g,outerRadius:v,circumference:E}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],r),T=this.options.spacing/2;return(E>=Ns||function(n,e,t,r){const i=dd(n),o=dd(e),s=dd(t),u=dd(o-i),f=dd(s-i),g=dd(i-o),v=dd(i-s);return i===o||i===s||r&&o===s||u>f&&g<v}(o,u,f))&&s>=g+T&&s<=v+T}getCenterPoint(e){const{x:t,y:r,startAngle:i,endAngle:o,innerRadius:s,outerRadius:u}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius","circumference"],e),{offset:f,spacing:g}=this.options,v=(i+o)/2,E=(s+u+g+f)/2;return{x:t+Math.cos(v)*E,y:r+Math.sin(v)*E}}tooltipPosition(e){return this.getCenterPoint(e)}draw(e){const t=this,{options:r,circumference:i}=t,o=(r.offset||0)/2,s=(r.spacing||0)/2;if(t.pixelMargin="inner"===r.borderAlign?.33:0,t.fullCircles=i>Ns?Math.floor(i/Ns):0,0===i||t.innerRadius<0||t.outerRadius<0)return;e.save();let u=0;if(o){u=o/2;const g=(t.startAngle+t.endAngle)/2;e.translate(Math.cos(g)*u,Math.sin(g)*u),t.circumference>=Ya&&(u=o)}e.fillStyle=r.backgroundColor,e.strokeStyle=r.borderColor;const f=function(n,e,t,r){const{fullCircles:i,startAngle:o,circumference:s}=e;let u=e.endAngle;if(i){PA(n,e,t,r,o+Ns);for(let f=0;f<i;++f)n.fill();isNaN(s)||(u=o+s%Ns,s%Ns==0&&(u+=Ns))}return PA(n,e,t,r,u),n.fill(),u}(e,t,u,s);(function(n,e,t,r,i){const{options:o}=e,s="inner"===o.borderAlign;!o.borderWidth||(s?(n.lineWidth=2*o.borderWidth,n.lineJoin="round"):(n.lineWidth=o.borderWidth,n.lineJoin="bevel"),e.fullCircles&&function(n,e,t){const{x:r,y:i,startAngle:o,pixelMargin:s,fullCircles:u}=e,f=Math.max(e.outerRadius-s,0),g=e.innerRadius+s;let v;for(t&&U5(n,e,o+Ns),n.beginPath(),n.arc(r,i,g,o+Ns,o,!0),v=0;v<u;++v)n.stroke();for(n.beginPath(),n.arc(r,i,f,o,o+Ns),v=0;v<u;++v)n.stroke()}(n,e,s),s&&U5(n,e,i),PA(n,e,t,r,i),n.stroke())})(e,t,u,s,f),e.restore()}}function H5(n,e){const{x:t,y:r,base:i,width:o,height:s}=n.getProps(["x","y","base","width","height"],e);let u,f,g,v,E;return n.horizontal?(E=s/2,u=Math.min(t,i),f=Math.max(t,i),g=r-E,v=r+E):(E=o/2,u=t-E,f=t+E,g=Math.min(r,i),v=Math.max(r,i)),{left:u,top:g,right:f,bottom:v}}function kp(n,e,t,r){return n?0:su(e,t,r)}function nue(n){const e=H5(n),t=e.right-e.left,r=e.bottom-e.top,i=function(n,e,t){const i=n.borderSkipped,o=D4(n.options.borderWidth);return{t:kp(i.top,o.top,0,t),r:kp(i.right,o.right,0,e),b:kp(i.bottom,o.bottom,0,t),l:kp(i.left,o.left,0,e)}}(n,t/2,r/2),o=function(n,e,t){const{enableBorderRadius:r}=n.getProps(["enableBorderRadius"]),i=n.options.borderRadius,o=function(n){return mA(n,["topLeft","topRight","bottomLeft","bottomRight"])}(i),s=Math.min(e,t),u=n.borderSkipped,f=r||Uo(i);return{topLeft:kp(!f||u.top||u.left,o.topLeft,0,s),topRight:kp(!f||u.top||u.right,o.topRight,0,s),bottomLeft:kp(!f||u.bottom||u.left,o.bottomLeft,0,s),bottomRight:kp(!f||u.bottom||u.right,o.bottomRight,0,s)}}(n,t/2,r/2);return{outer:{x:e.left,y:e.top,w:t,h:r,radius:o},inner:{x:e.left+i.l,y:e.top+i.t,w:t-i.l-i.r,h:r-i.t-i.b,radius:{topLeft:Math.max(0,o.topLeft-Math.max(i.t,i.l)),topRight:Math.max(0,o.topRight-Math.max(i.t,i.r)),bottomLeft:Math.max(0,o.bottomLeft-Math.max(i.b,i.l)),bottomRight:Math.max(0,o.bottomRight-Math.max(i.b,i.r))}}}}function OA(n,e,t,r){const i=null===e,o=null===t,u=n&&!(i&&o)&&H5(n,r);return u&&(i||e>=u.left&&e<=u.right)&&(o||t>=u.top&&t<=u.bottom)}function iue(n,e){n.rect(e.x,e.y,e.w,e.h)}function kA(n,e,t={}){const r=n.x!==t.x?-e:0,i=n.y!==t.y?-e:0;return{x:n.x+r,y:n.y+i,w:n.w+((n.x+n.w!==t.x+t.w?e:0)-r),h:n.h+((n.y+n.h!==t.y+t.h?e:0)-i),radius:n.radius}}EE.id="arc",EE.defaults={borderAlign:"center",borderColor:"#fff",borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0},EE.defaultRoutes={backgroundColor:"backgroundColor"};class SE extends fd{constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,e&&Object.assign(this,e)}draw(e){const t=this.options,{inner:r,outer:i}=nue(this),o=function(n){return n.topLeft||n.topRight||n.bottomLeft||n.bottomRight}(i.radius)?dE:iue,s=.33;e.save(),(i.w!==r.w||i.h!==r.h)&&(e.beginPath(),o(e,kA(i,s,r)),e.clip(),o(e,kA(r,-s,i)),e.fillStyle=t.borderColor,e.fill("evenodd")),e.beginPath(),o(e,kA(r,s,i)),e.fillStyle=t.backgroundColor,e.fill(),e.restore()}inRange(e,t,r){return OA(this,e,t,r)}inXRange(e,t){return OA(this,e,null,t)}inYRange(e,t){return OA(this,null,e,t)}getCenterPoint(e){const{x:t,y:r,base:i,horizontal:o}=this.getProps(["x","y","base","horizontal"],e);return{x:o?(t+i)/2:t,y:o?r:(r+i)/2}}getRange(e){return"x"===e?this.width/2:this.height/2}}SE.id="bar",SE.defaults={borderSkipped:"start",borderWidth:0,borderRadius:0,enableBorderRadius:!0,pointStyle:void 0},SE.defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"},new WeakMap;class DE extends Zg{constructor(e){super(e),this._startValue=void 0,this._valueRange=0}parse(e,t){if(Wo(e))return null;const r=this.getLabels();return((n,e)=>null===n?null:su(Math.round(n),0,e))(t=isFinite(t)&&r[t]===e?t:function(n,e,t){const r=n.indexOf(e);return-1===r?((n,e,t)=>"string"==typeof e?n.push(e)-1:isNaN(e)?null:t)(n,e,t):r!==n.lastIndexOf(e)?t:r}(r,e,Qi(t,e)),r.length-1)}determineDataLimits(){const e=this,{minDefined:t,maxDefined:r}=e.getUserBounds();let{min:i,max:o}=e.getMinMax(!0);"ticks"===e.options.bounds&&(t||(i=0),r||(o=e.getLabels().length-1)),e.min=i,e.max=o}buildTicks(){const e=this,t=e.min,r=e.max,i=e.options.offset,o=[];let s=e.getLabels();s=0===t&&r===s.length-1?s:s.slice(t,r+1),e._valueRange=Math.max(s.length-(i?0:1),1),e._startValue=e.min-(i?.5:0);for(let u=t;u<=r;u++)o.push({value:u});return o}getLabelForValue(e){const r=this.getLabels();return e>=0&&e<r.length?r[e]:e}configure(){const e=this;super.configure(),e.isHorizontal()||(e._reversePixels=!e._reversePixels)}getPixelForValue(e){const t=this;return"number"!=typeof e&&(e=t.parse(e)),null===e?NaN:t.getPixelForDecimal((e-t._startValue)/t._valueRange)}getPixelForTick(e){const r=this.ticks;return e<0||e>r.length-1?null:this.getPixelForValue(r[e].value)}getValueForPixel(e){const t=this;return Math.round(t._startValue+t.getDecimalForPixel(e)*t._valueRange)}getBasePixel(){return this.bottom}}function uU(n,e,{horizontal:t,minRotation:r}){const i=hd(r),o=(t?Math.sin(i):Math.cos(i))||.001;return Math.min(e/o,.75*e*(""+n).length)}DE.id="category",DE.defaults={ticks:{callback:DE.prototype.getLabelForValue}};class IE extends Zg{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,t){return Wo(e)||("number"==typeof e||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const e=this,{beginAtZero:t}=e.options,{minDefined:r,maxDefined:i}=e.getUserBounds();let{min:o,max:s}=e;const u=g=>o=r?o:g,f=g=>s=i?s:g;if(t){const g=Hd(o),v=Hd(s);g<0&&v<0?f(0):g>0&&v>0&&u(0)}if(o===s){let g=1;(s>=Number.MAX_SAFE_INTEGER||o<=Number.MIN_SAFE_INTEGER)&&(g=Math.abs(.05*s)),f(s+g),t||u(o-g)}e.min=o,e.max=s}getTickLimit(){const e=this,t=e.options.ticks;let o,{maxTicksLimit:r,stepSize:i}=t;return i?o=Math.ceil(e.max/i)-Math.floor(e.min/i)+1:(o=e.computeTickLimit(),r=r||11),r&&(o=Math.min(r,o)),o}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this,t=e.options,r=t.ticks;let i=e.getTickLimit();i=Math.max(2,i);const u=function(n,e){const t=[],{bounds:i,step:o,min:s,max:u,precision:f,count:g,maxTicks:v,maxDigits:E,includeBounds:T}=n,R=o||1,B=v-1,{min:z,max:G}=e,W=!Wo(s),H=!Wo(u),ee=!Wo(g),_e=(G-z)/(E+1);let $e,We,rt,ke,ye=d4((G-z)/B/R)*R;if(ye<1e-14&&!W&&!H)return[{value:z},{value:G}];ke=Math.ceil(G/ye)-Math.floor(z/ye),ke>B&&(ye=d4(ke*ye/B/R)*R),Wo(f)||($e=Math.pow(10,f),ye=Math.ceil(ye*$e)/$e),"ticks"===i?(We=Math.floor(z/ye)*ye,rt=Math.ceil(G/ye)*ye):(We=z,rt=G),W&&H&&o&&function(n,e){const t=Math.round(n);return t-e<=n&&t+e>=n}((u-s)/o,ye/1e3)?(ke=Math.round(Math.min((u-s)/ye,v)),ye=(u-s)/ke,We=s,rt=u):ee?(We=W?s:We,rt=H?u:rt,ke=g-1,ye=(rt-We)/ke):(ke=(rt-We)/ye,ke=q0(ke,Math.round(ke),ye/1e3)?Math.round(ke):Math.ceil(ke));const _n=Math.max(p4(ye),p4(We));$e=Math.pow(10,Wo(f)?_n:f),We=Math.round(We*$e)/$e,rt=Math.round(rt*$e)/$e;let on=0;for(W&&(T&&We!==s?(t.push({value:s}),We<s&&on++,q0(Math.round((We+on*ye)*$e)/$e,s,uU(s,_e,n))&&on++):We<s&&on++);on<ke;++on)t.push({value:Math.round((We+on*ye)*$e)/$e});return H&&T&&rt!==u?q0(t[t.length-1].value,u,uU(u,_e,n))?t[t.length-1].value=u:t.push({value:u}):(!H||rt===u)&&t.push({value:rt}),t}({maxTicks:i,bounds:t.bounds,min:t.min,max:t.max,precision:r.precision,step:r.stepSize,count:r.count,maxDigits:e._maxDigits(),horizontal:e.isHorizontal(),minRotation:r.minRotation||0,includeBounds:!1!==r.includeBounds},e._range||e);return"ticks"===t.bounds&&f4(u,e,"value"),t.reverse?(u.reverse(),e.start=e.max,e.end=e.min):(e.start=e.min,e.end=e.max),u}configure(){const e=this,t=e.ticks;let r=e.min,i=e.max;if(super.configure(),e.options.offset&&t.length){const o=(i-r)/Math.max(t.length-1,1)/2;r-=o,i+=o}e._startValue=r,e._endValue=i,e._valueRange=i-r}getLabelForValue(e){return Q0(e,this.chart.options.locale)}}class BA extends IE{determineDataLimits(){const e=this,{min:t,max:r}=e.getMinMax(!0);e.min=ol(t)?t:0,e.max=ol(r)?r:1,e.handleTickRangeOptions()}computeTickLimit(){const e=this,t=e.isHorizontal(),r=t?e.width:e.height,i=hd(e.options.ticks.minRotation),o=(t?Math.sin(i):Math.cos(i))||.001,s=e._resolveTickFontOptions(0);return Math.ceil(r/Math.min(40,s.lineHeight/o))}getPixelForValue(e){return null===e?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}function cU(n){return n/Math.pow(10,Math.floor(Ph(n)))==1}BA.id="linear",BA.defaults={ticks:{callback:yE.formatters.numeric}};class zA extends Zg{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(e,t){const r=IE.prototype.parse.apply(this,[e,t]);if(0!==r)return ol(r)&&r>0?r:null;this._zero=!0}determineDataLimits(){const e=this,{min:t,max:r}=e.getMinMax(!0);e.min=ol(t)?Math.max(0,t):null,e.max=ol(r)?Math.max(0,r):null,e.options.beginAtZero&&(e._zero=!0),e.handleTickRangeOptions()}handleTickRangeOptions(){const e=this,{minDefined:t,maxDefined:r}=e.getUserBounds();let i=e.min,o=e.max;const s=g=>i=t?i:g,u=g=>o=r?o:g,f=(g,v)=>Math.pow(10,Math.floor(Ph(g))+v);i===o&&(i<=0?(s(1),u(10)):(s(f(i,-1)),u(f(o,1)))),i<=0&&s(f(o,-1)),o<=0&&u(f(i,1)),e._zero&&e.min!==e._suggestedMin&&i===f(e.min,0)&&s(f(i,-1)),e.min=i,e.max=o}buildTicks(){const e=this,t=e.options,i=function(n,e){const t=Math.floor(Ph(e.max)),r=Math.ceil(e.max/Math.pow(10,t)),i=[];let o=Ah(n.min,Math.pow(10,Math.floor(Ph(e.min)))),s=Math.floor(Ph(o)),u=Math.floor(o/Math.pow(10,s)),f=s<0?Math.pow(10,Math.abs(s)):1;do{i.push({value:o,major:cU(o)}),++u,10===u&&(u=1,++s,f=s>=0?1:f),o=Math.round(u*Math.pow(10,s)*f)/f}while(s<t||s===t&&u<r);const g=Ah(n.max,o);return i.push({value:g,major:cU(o)}),i}({min:e._userMin,max:e._userMax},e);return"ticks"===t.bounds&&f4(i,e,"value"),t.reverse?(i.reverse(),e.start=e.max,e.end=e.min):(e.start=e.min,e.end=e.max),i}getLabelForValue(e){return void 0===e?"0":Q0(e,this.chart.options.locale)}configure(){const e=this,t=e.min;super.configure(),e._startValue=Ph(t),e._valueRange=Ph(e.max)-Ph(t)}getPixelForValue(e){const t=this;return(void 0===e||0===e)&&(e=t.min),null===e||isNaN(e)?NaN:t.getPixelForDecimal(e===t.min?0:(Ph(e)-t._startValue)/t._valueRange)}getValueForPixel(e){const t=this,r=t.getDecimalForPixel(e);return Math.pow(10,t._startValue+r*t._valueRange)}}function VA(n){const e=n.ticks;if(e.display&&n.display){const t=dc(e.backdropPadding);return Qi(e.font&&e.font.size,Co.font.size)+t.height}return 0}function Xue(n,e,t){return t=Zs(t)?t:[t],{w:cse(n,e.string,t),h:t.length*e.lineHeight}}function hU(n,e,t,r,i){return n===r||n===i?{start:e-t/2,end:e+t/2}:n<r||n>i?{start:e-t,end:e}:{start:e,end:e+t}}function Kue(n){return 0===n||180===n?"center":n<180?"left":"right"}function Jue(n,e,t){return"right"===t?n-=e:"center"===t&&(n-=e/2),n}function Que(n,e,t){return 90===t||270===t?n-=e/2:(t>270||t<90)&&(n-=e),n}function dU(n,e,t,r){const{ctx:i}=n;if(t)i.arc(n.xCenter,n.yCenter,e,0,Ns);else{let o=n.getPointPosition(0,e);i.moveTo(o.x,o.y);for(let s=1;s<r;s++)o=n.getPointPosition(s,e),i.lineTo(o.x,o.y)}}function AE(n){return J_(n)?n:0}zA.id="logarithmic",zA.defaults={ticks:{callback:yE.formatters.logarithmic,major:{enabled:!0}}};class u1 extends IE{constructor(e){super(e),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const e=this;e.width=e.maxWidth,e.height=e.maxHeight,e.paddingTop=VA(e.options)/2,e.xCenter=Math.floor(e.width/2),e.yCenter=Math.floor((e.height-e.paddingTop)/2),e.drawingArea=Math.min(e.height-e.paddingTop,e.width)/2}determineDataLimits(){const e=this,{min:t,max:r}=e.getMinMax(!1);e.min=ol(t)&&!isNaN(t)?t:0,e.max=ol(r)&&!isNaN(r)?r:0,e.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/VA(this.options))}generateTickLabels(e){const t=this;IE.prototype.generateTickLabels.call(t,e),t._pointLabels=t.getLabels().map((r,i)=>{const o=Ks(t.options.pointLabels.callback,[r,i],t);return o||0===o?o:""})}fit(){const e=this,t=e.options;t.display&&t.pointLabels.display?function(n){const e={l:0,r:n.width,t:0,b:n.height-n.paddingTop},t={},r=[],i=[],o=n.getLabels().length;for(let s=0;s<o;s++){const u=n.options.pointLabels.setContext(n.getPointLabelContext(s));i[s]=u.padding;const f=n.getPointPosition(s,n.drawingArea+i[s]),g=jl(u.font),v=Xue(n.ctx,g,n._pointLabels[s]);r[s]=v;const E=n.getIndexAngle(s),T=sA(E),R=hU(T,f.x,v.w,0,180),B=hU(T,f.y,v.h,90,270);R.start<e.l&&(e.l=R.start,t.l=E),R.end>e.r&&(e.r=R.end,t.r=E),B.start<e.t&&(e.t=B.start,t.t=E),B.end>e.b&&(e.b=B.end,t.b=E)}n._setReductions(n.drawingArea,e,t),n._pointLabelItems=function(n,e,t){const r=[],i=n.getLabels().length,o=n.options,s=VA(o),u=n.getDistanceFromCenterForValue(o.ticks.reverse?n.min:n.max);for(let f=0;f<i;f++){const v=n.getPointPosition(f,u+(0===f?s/2:0)+t[f]),E=sA(n.getIndexAngle(f)),T=e[f],R=Que(v.y,T.h,E),B=Kue(E),z=Jue(v.x,T.w,B);r.push({x:v.x,y:R,textAlign:B,left:z,top:R,right:z+T.w,bottom:R+T.h})}return r}(n,r,i)}(e):e.setCenterPoint(0,0,0,0)}_setReductions(e,t,r){const i=this;let o=t.l/Math.sin(r.l),s=Math.max(t.r-i.width,0)/Math.sin(r.r),u=-t.t/Math.cos(r.t),f=-Math.max(t.b-(i.height-i.paddingTop),0)/Math.cos(r.b);o=AE(o),s=AE(s),u=AE(u),f=AE(f),i.drawingArea=Math.max(e/2,Math.min(Math.floor(e-(o+s)/2),Math.floor(e-(u+f)/2))),i.setCenterPoint(o,s,u,f)}setCenterPoint(e,t,r,i){const o=this,f=r+o.drawingArea,g=o.height-o.paddingTop-i-o.drawingArea;o.xCenter=Math.floor((e+o.drawingArea+(o.width-t-o.drawingArea))/2+o.left),o.yCenter=Math.floor((f+g)/2+o.top+o.paddingTop)}getIndexAngle(e){return dd(e*(Ns/this.getLabels().length)+hd(this.options.startAngle||0))}getDistanceFromCenterForValue(e){const t=this;if(Wo(e))return NaN;const r=t.drawingArea/(t.max-t.min);return t.options.reverse?(t.max-e)*r:(e-t.min)*r}getValueForDistanceFromCenter(e){if(Wo(e))return NaN;const t=this,r=e/(t.drawingArea/(t.max-t.min));return t.options.reverse?t.max-r:t.min+r}getPointLabelContext(e){const t=this,r=t._pointLabels||[];if(e>=0&&e<r.length){const i=r[e];return function(n,e,t){return Object.assign(Object.create(n),{label:t,index:e,type:"pointLabel"})}(t.getContext(),e,i)}}getPointPosition(e,t){const r=this,i=r.getIndexAngle(e)-sl;return{x:Math.cos(i)*t+r.xCenter,y:Math.sin(i)*t+r.yCenter,angle:i}}getPointPositionForValue(e,t){return this.getPointPosition(e,this.getDistanceFromCenterForValue(t))}getBasePosition(e){return this.getPointPositionForValue(e||0,this.getBaseValue())}getPointLabelPosition(e){const{left:t,top:r,right:i,bottom:o}=this._pointLabelItems[e];return{left:t,top:r,right:i,bottom:o}}drawBackground(){const e=this,{backgroundColor:t,grid:{circular:r}}=e.options;if(t){const i=e.ctx;i.save(),i.beginPath(),dU(e,e.getDistanceFromCenterForValue(e._endValue),r,e.getLabels().length),i.closePath(),i.fillStyle=t,i.fill(),i.restore()}}drawGrid(){const e=this,t=e.ctx,r=e.options,{angleLines:i,grid:o}=r,s=e.getLabels().length;let u,f,g;if(r.pointLabels.display&&function(n,e){const{ctx:t,options:{pointLabels:r}}=n;for(let i=e-1;i>=0;i--){const o=r.setContext(n.getPointLabelContext(i)),s=jl(o.font),{x:u,y:f,textAlign:g,left:v,top:E,right:T,bottom:R}=n._pointLabelItems[i],{backdropColor:B}=o;if(!Wo(B)){const z=dc(o.backdropPadding);t.fillStyle=B,t.fillRect(v-z.left,E-z.top,T-v+z.width,R-E+z.height)}qg(t,n._pointLabels[i],u,f+s.lineHeight/2,s,{color:o.color,textAlign:g,textBaseline:"middle"})}}(e,s),o.display&&e.ticks.forEach((v,E)=>{if(0!==E){f=e.getDistanceFromCenterForValue(v.value);const T=o.setContext(e.getContext(E-1));!function(n,e,t,r){const i=n.ctx,o=e.circular,{color:s,lineWidth:u}=e;!o&&!r||!s||!u||t<0||(i.save(),i.strokeStyle=s,i.lineWidth=u,i.setLineDash(e.borderDash),i.lineDashOffset=e.borderDashOffset,i.beginPath(),dU(n,t,o,r),i.closePath(),i.stroke(),i.restore())}(e,T,f,s)}}),i.display){for(t.save(),u=e.getLabels().length-1;u>=0;u--){const v=i.setContext(e.getPointLabelContext(u)),{color:E,lineWidth:T}=v;!T||!E||(t.lineWidth=T,t.strokeStyle=E,t.setLineDash(v.borderDash),t.lineDashOffset=v.borderDashOffset,f=e.getDistanceFromCenterForValue(r.ticks.reverse?e.min:e.max),g=e.getPointPosition(u,f),t.beginPath(),t.moveTo(e.xCenter,e.yCenter),t.lineTo(g.x,g.y),t.stroke())}t.restore()}}drawBorder(){}drawLabels(){const e=this,t=e.ctx,r=e.options,i=r.ticks;if(!i.display)return;const o=e.getIndexAngle(0);let s,u;t.save(),t.translate(e.xCenter,e.yCenter),t.rotate(o),t.textAlign="center",t.textBaseline="middle",e.ticks.forEach((f,g)=>{if(0===g&&!r.reverse)return;const v=i.setContext(e.getContext(g)),E=jl(v.font);if(s=e.getDistanceFromCenterForValue(e.ticks[g].value),v.showLabelBackdrop){t.font=E.string,u=t.measureText(f.label).width,t.fillStyle=v.backdropColor;const T=dc(v.backdropPadding);t.fillRect(-u/2-T.left,-s-E.size/2-T.top,u+T.width,E.size+T.height)}qg(t,f.label,0,-s,E,{color:v.color})}),t.restore()}drawTitle(){}}u1.id="radialLinear",u1.defaults={display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:yE.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback:n=>n,padding:5}},u1.defaultRoutes={"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"},u1.descriptors={angleLines:{_fallback:"grid"}};const PE={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},Dc=Object.keys(PE);function rce(n,e){return n-e}function fU(n,e){if(Wo(e))return null;const t=n._adapter,{parser:r,round:i,isoWeekday:o}=n._parseOpts;let s=e;return"function"==typeof r&&(s=r(s)),ol(s)||(s="string"==typeof r?t.parse(s,r):t.parse(s)),null===s?null:(i&&(s="week"!==i||!J_(o)&&!0!==o?t.startOf(s,i):t.startOf(s,"isoWeek",o)),+s)}function pU(n,e,t,r){const i=Dc.length;for(let o=Dc.indexOf(n);o<i-1;++o){const s=PE[Dc[o]],u=s.steps?s.steps:Number.MAX_SAFE_INTEGER;if(s.common&&Math.ceil((t-e)/(u*s.size))<=r)return Dc[o]}return Dc[i-1]}function gU(n,e,t){if(t){if(t.length){const{lo:r,hi:i}=yA(t,e);n[t[r]>=e?t[r]:t[i]]=!0}}else n[e]=!0}function mU(n,e,t){const r=[],i={},o=e.length;let s,u;for(s=0;s<o;++s)u=e[s],i[u]=s,r.push({value:u,major:!1});return 0!==o&&t?function(n,e,t,r){const i=n._adapter,o=+i.startOf(e[0].value,r),s=e[e.length-1].value;let u,f;for(u=o;u<=s;u=+i.add(u,1,r))f=t[u],f>=0&&(e[f].major=!0);return e}(n,r,i,t):r}let UA=(()=>{class n extends Zg{constructor(t){super(t),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(t,r){const i=t.time||(t.time={}),o=this._adapter=new kae._date(t.adapters.date);$0(i.displayFormats,o.formats()),this._parseOpts={parser:i.parser,round:i.round,isoWeekday:i.isoWeekday},super.init(t),this._normalized=r.normalized}parse(t,r){return void 0===t?null:fU(this,t)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const t=this,r=t.options,i=t._adapter,o=r.time.unit||"day";let{min:s,max:u,minDefined:f,maxDefined:g}=t.getUserBounds();function v(E){!f&&!isNaN(E.min)&&(s=Math.min(s,E.min)),!g&&!isNaN(E.max)&&(u=Math.max(u,E.max))}(!f||!g)&&(v(t._getLabelBounds()),("ticks"!==r.bounds||"labels"!==r.ticks.source)&&v(t.getMinMax(!1))),s=ol(s)&&!isNaN(s)?s:+i.startOf(Date.now(),o),u=ol(u)&&!isNaN(u)?u:+i.endOf(Date.now(),o)+1,t.min=Math.min(s,u-1),t.max=Math.max(s+1,u)}_getLabelBounds(){const t=this.getLabelTimestamps();let r=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY;return t.length&&(r=t[0],i=t[t.length-1]),{min:r,max:i}}buildTicks(){const t=this,r=t.options,i=r.time,o=r.ticks,s="labels"===o.source?t.getLabelTimestamps():t._generate();"ticks"===r.bounds&&s.length&&(t.min=t._userMin||s[0],t.max=t._userMax||s[s.length-1]);const u=t.min,g=function(n,e,t){let r=0,i=n.length;for(;r<i&&n[r]<e;)r++;for(;i>r&&n[i-1]>t;)i--;return r>0||i<n.length?n.slice(r,i):n}(s,u,t.max);return t._unit=i.unit||(o.autoSkip?pU(i.minUnit,t.min,t.max,t._getLabelCapacity(u)):function(n,e,t,r,i){for(let o=Dc.length-1;o>=Dc.indexOf(t);o--){const s=Dc[o];if(PE[s].common&&n._adapter.diff(i,r,s)>=e-1)return s}return Dc[t?Dc.indexOf(t):0]}(t,g.length,i.minUnit,t.min,t.max)),t._majorUnit=o.major.enabled&&"year"!==t._unit?function(n){for(let e=Dc.indexOf(n)+1,t=Dc.length;e<t;++e)if(PE[Dc[e]].common)return Dc[e]}(t._unit):void 0,t.initOffsets(s),r.reverse&&g.reverse(),mU(t,g,t._majorUnit)}initOffsets(t){const r=this;let s,u,i=0,o=0;r.options.offset&&t.length&&(s=r.getDecimalForValue(t[0]),i=1===t.length?1-s:(r.getDecimalForValue(t[1])-s)/2,u=r.getDecimalForValue(t[t.length-1]),o=1===t.length?u:(u-r.getDecimalForValue(t[t.length-2]))/2);const f=t.length<3?.5:.25;i=su(i,0,f),o=su(o,0,f),r._offsets={start:i,end:o,factor:1/(i+1+o)}}_generate(){const t=this,r=t._adapter,i=t.min,o=t.max,s=t.options,u=s.time,f=u.unit||pU(u.minUnit,i,o,t._getLabelCapacity(i)),g=Qi(u.stepSize,1),v="week"===f&&u.isoWeekday,E=J_(v)||!0===v,T={};let B,z,R=i;if(E&&(R=+r.startOf(R,"isoWeek",v)),R=+r.startOf(R,E?"day":f),r.diff(o,i,f)>1e5*g)throw new Error(i+" and "+o+" are too far apart with stepSize of "+g+" "+f);const G="data"===s.ticks.source&&t.getDataTimestamps();for(B=R,z=0;B<o;B=+r.add(B,g,f),z++)gU(T,B,G);return(B===o||"ticks"===s.bounds||1===z)&&gU(T,B,G),Object.keys(T).sort((W,H)=>W-H).map(W=>+W)}getLabelForValue(t){const o=this.options.time;return this._adapter.format(t,o.tooltipFormat?o.tooltipFormat:o.displayFormats.datetime)}_tickFormatFunction(t,r,i,o){const s=this,u=s.options,f=u.time.displayFormats,g=s._unit,v=s._majorUnit,T=v&&f[v],R=i[r],z=s._adapter.format(t,o||(v&&T&&R&&R.major?T:g&&f[g])),G=u.ticks.callback;return G?Ks(G,[z,r,i],s):z}generateTickLabels(t){let r,i,o;for(r=0,i=t.length;r<i;++r)o=t[r],o.label=this._tickFormatFunction(o.value,r,t)}getDecimalForValue(t){const r=this;return null===t?NaN:(t-r.min)/(r.max-r.min)}getPixelForValue(t){const r=this,i=r._offsets,o=r.getDecimalForValue(t);return r.getPixelForDecimal((i.start+o)*i.factor)}getValueForPixel(t){const r=this,i=r._offsets,o=r.getDecimalForPixel(t)/i.factor-i.end;return r.min+o*(r.max-r.min)}_getLabelSize(t){const r=this,i=r.options.ticks,o=r.ctx.measureText(t).width,s=hd(r.isHorizontal()?i.maxRotation:i.minRotation),u=Math.cos(s),f=Math.sin(s),g=r._resolveTickFontOptions(0).size;return{w:o*u+g*f,h:o*f+g*u}}_getLabelCapacity(t){const r=this,i=r.options.time,o=i.displayFormats,s=o[i.unit]||o.millisecond,u=r._tickFormatFunction(t,0,mU(r,[t],r._majorUnit),s),f=r._getLabelSize(u),g=Math.floor(r.isHorizontal()?r.width/f.w:r.height/f.h)-1;return g>0?g:1}getDataTimestamps(){const t=this;let i,o,r=t._cache.data||[];if(r.length)return r;const s=t.getMatchingVisibleMetas();if(t._normalized&&s.length)return t._cache.data=s[0].controller.getAllParsedValues(t);for(i=0,o=s.length;i<o;++i)r=r.concat(s[i].controller.getAllParsedValues(t));return t._cache.data=t.normalize(r)}getLabelTimestamps(){const t=this,r=t._cache.labels||[];let i,o;if(r.length)return r;const s=t.getLabels();for(i=0,o=s.length;i<o;++i)r.push(fU(t,s[i]));return t._cache.labels=t._normalized?r:t.normalize(r)}normalize(t){return function(n){const e=new Set;let t,r;for(t=0,r=n.length;t<r;++t)e.add(n[t]);return e.size===r?n:Array.from(e)}(t.sort(rce))}}return n.id="time",n.defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",major:{enabled:!1}}},n})();function RE(n,e,t){let o,s,u,f,r=0,i=n.length-1;t?(e>=n[r].pos&&e<=n[i].pos&&({lo:r,hi:i}=Lf(n,"pos",e)),({pos:o,time:u}=n[r]),({pos:s,time:f}=n[i])):(e>=n[r].time&&e<=n[i].time&&({lo:r,hi:i}=Lf(n,"time",e)),({time:o,pos:u}=n[r]),({time:s,pos:f}=n[i]));const g=s-o;return g?u+(f-u)*(e-o)/g:u}class jA extends UA{constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this,t=e._getTimestampsForTable(),r=e._table=e.buildLookupTable(t);e._minPos=RE(r,e.min),e._tableRange=RE(r,e.max)-e._minPos,super.initOffsets(t)}buildLookupTable(e){const{min:t,max:r}=this,i=[],o=[];let s,u,f,g,v;for(s=0,u=e.length;s<u;++s)g=e[s],g>=t&&g<=r&&i.push(g);if(i.length<2)return[{time:t,pos:0},{time:r,pos:1}];for(s=0,u=i.length;s<u;++s)v=i[s+1],f=i[s-1],g=i[s],Math.round((v+f)/2)!==g&&o.push({time:g,pos:s/(u-1)});return o}_getTimestampsForTable(){const e=this;let t=e._cache.all||[];if(t.length)return t;const r=e.getDataTimestamps(),i=e.getLabelTimestamps();return t=r.length&&i.length?e.normalize(r.concat(i)):r.length?r:i,t=e._cache.all=t,t}getDecimalForValue(e){return(RE(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const t=this,r=t._offsets,i=t.getDecimalForPixel(e)/r.factor-r.end;return RE(t._table,i*t._tableRange+t._minPos,!0)}}jA.id="timeseries",jA.defaults=UA.defaults;let _U=(()=>{class n{constructor(){this.chart=new AA("cultivator-chart-canvas",{type:"bar",data:{datasets:this.chartDatasets,labels:this.chartLabels},options:{scales:{x:{type:"timeseries"},y:{}}}})}ngOnInit(){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=ao({type:n,selectors:[["app-cultivator-chart"]],inputs:{chartDatasets:"chartDatasets",chartLabels:"chartLabels"},decls:1,vars:0,consts:[["id","cultivator-chart-canvas"]],template:function(t,r){1&t&&Ar(0,"canvas",0)},styles:[""]}),n})();function lce(n,e){if(1&n&&(function(n,e,t){const r=l(),i=d(),o=n+20,s=i.firstCreatePass?function(n,e,t,r,i){const o=e.consts,s=la(o,r),u=ge(e,n,8,"ng-container",s);return null!==s&&nx(u,s,!0),xs(e,t,u,la(o,i)),null!==e.queries&&e.queries.elementStart(e,u),u}(o,i,r,e,t):i.data[o];j(s,!0);const u=r[o]=r[11].createComment("");up(i,r,u,s),Ha(u,r),Da(s)&&(Pt(i,r,s),Rt(i,s,r)),null!=t&&tn(r,s)}(0),Ar(1,"input",15),cn(2,"label"),Ar(3,"span",6),Zn(4),hn(),Ar(5,"br"),function(){let n=b();const e=d();ne()?Ee():(n=n.parent,j(n,!1)),e.firstCreatePass&&(Kn(e,n),ma(n)&&e.queries.elementEnd(n))}()),2&n){const t=e.$implicit;$o(1),e_("value",t),$o(3),mv(t)}}function uce(n,e){if(1&n&&(cn(0,"option",16),Zn(1),hn()),2&n){const t=e.$implicit;e_("value",t),$o(1),mv(t)}}const cce=[{path:"login",component:bee},{path:"customer-home/:oid",component:Tee,children:[{path:"overview-map",component:s4},{path:"cultivator-tracker",component:(()=>{class n{constructor(t,r,i,o){this.fb=t,this.http=r,this.websocketservice=i,this.dialogservice=o,this.chartDatasets=[],this.chartLabels=[],this.chart_to_show=!1,this.form=this.fb.group({cid:["all"],days:["5"],date:["e2e"],chart:["hide"]},{updateOn:"change"}),rl.accessToken=zl_mapbox_accessToken,this.center=new rl.LngLat(-121.657,36.636),this.bounds=new rl.LngLatBounds([-125,28,-64,51]),this.zoom_threshold=20,this.zoom_over_threshold=!1,this.cids=["2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20"],this.dseq$=new wt,this.cultivator_trace_geojson=this.initCultivatorTraceGeojson(),this.cultivator_sub_trace_geojson=this.initCultivatorSubTraceGeojson(),this.cultivator_pos_geojson=this.initCultivatorPosGeojson(),this.lot_boundary_geojson=this.initLotBoundaryGeojson(),this.wsData=this.websocketservice.getWebsocket(),this.eventEmitter=new Ro}ngOnInit(){this.addInitialDataToCultivatorTraceGeojson(),this.addInitialDataToCultivatorPosGeojson();let t=(new Date).getTime(),r=new Date(new Date(t-24*(this.form.controls.days.value-1)*3600*1e3).toString().slice(4,15)).toISOString(),i=new Date(t).toISOString(),o=this.getLocalDateSequenceInIsoDateRange(r,i);this.dseq$.next(o)}ngAfterViewInit(){let t=new rl.Map({container:"map",style:"mapbox://styles/stout/ckrdmp6tk2mud18mkqpzfjqr8",center:this.center,maxBounds:this.bounds,zoom:14,minZoom:4,doubleClickZoom:!1});t.on("load",()=>{t.addControl(new rl.NavigationControl,"top-left"),t.addControl(new rl.ScaleControl({maxWidth:200,unit:"imperial"}),"bottom-left"),t.addSource("cultivator-trace",{type:"geojson",data:this.cultivator_trace_geojson}),t.addSource("cultivator-sub-trace",{type:"geojson",data:this.cultivator_sub_trace_geojson}),t.addSource("cultivator-pos",{type:"geojson",data:this.cultivator_pos_geojson}),t.addSource("lots",{type:"geojson",data:this.lot_boundary_geojson}),t.addLayer({id:"cultivator-trace-line",type:"line",source:"cultivator-trace",layout:{visibility:"visible","line-join":"round","line-cap":"round"},paint:{"line-color":"#ff8000","line-width":["interpolate",["exponential",2],["zoom"],14,7,22,7],"line-opacity":["interpolate",["linear"],["zoom"],14,.4,22,1]}}),t.addLayer({id:"cultivator-sub-trace-line",type:"line",source:"cultivator-sub-trace",layout:{visibility:"visible","line-join":"round","line-cap":"round"},paint:{"line-color":"#ff3333","line-width":["interpolate",["exponential",2],["zoom"],14,3,22,3],"line-opacity":1}}),t.addLayer({id:"cultivator-pos-circle",type:"circle",source:"cultivator-pos",layout:{visibility:"visible"},paint:{"circle-radius":12,"circle-color":["step",["get","age_sec"],"rgb(255,0,0)",60,"rgb(102,0,51)",240,"rgb(51,0,26)",480,"rgb(0,0,0)"],"circle-opacity":1,"circle-stroke-color":"#ffffff","circle-stroke-width":3}}),t.addLayer({id:"cultivator-pos-symbol",type:"symbol",source:"cultivator-pos",layout:{visibility:"visible","text-field":["get","cid"],"text-size":14},paint:{"text-color":"#fff"}}),t.addLayer({id:"lots-fill",type:"fill",source:"lots",layout:{},paint:{"fill-color":"rgb(47,247,213)","fill-opacity":0}}),t.addLayer({id:"lots-line",type:"line",source:"lots",layout:{},paint:{"line-color":"rgb(255,0,0)","line-width":1}}),t.setLayoutProperty("20210630-sp-1-2-plants-layer","visibility","none"),t.setLayoutProperty("stout-20210701-spreckels-1-2-tileset","visibility","none"),t.setLayoutProperty("stout-20210701-spreckels-1-3-tileset","visibility","none"),t.setLayoutProperty("stout-20210701-harris-1-tileset","visibility","none"),t.setLayoutProperty("stout-20210702-stout-tileset","visibility","none")}),t.on("click","lots-fill",r=>{if(r.features){let i=r.features[0],o=jz(i).geometry.coordinates;(new rl.Popup).setLngLat([o[0],o[1]]).setHTML(`<b>Lot:</b> ${i.properties?i.properties.name:null}`).addTo(t)}}),t.on("dblclick","lots-fill",r=>{if(r.features){let o=XD(r.features[0]);t.getZoom()<this.zoom_threshold&&t.fitBounds([[o[0],o[1]],[o[2],o[3]]],{padding:40})}}),t.on("click","cultivator-pos-circle",r=>{let i=[new rl.Point(r.point.x-8,r.point.y-8),new rl.Point(r.point.x+8,r.point.y+8)],o=t.queryRenderedFeatures([i[0],i[1]])[0];t.flyTo({center:[o.geometry.coordinates[0],o.geometry.coordinates[1]],zoom:19})}),this.wsData.subscribe(r=>{let i=this.cids.indexOf(r.cid);this.cultivator_trace_geojson.features[i].geometry.coordinates.push([r.lon,r.lat]),this.cultivator_pos_geojson.features[i].geometry.coordinates=[r.lon,r.lat],this.cultivator_pos_geojson.features[i].properties.age_sec=0,t.getSource("cultivator-trace").setData(this.cultivator_trace_geojson),t.getSource("cultivator-pos").setData(this.cultivator_pos_geojson)}),this.form.controls.cid.valueChanges.subscribe(r=>{"all"!=r?(t.setFilter("cultivator-trace-line",["==",["to-string",["get","cid"]],r]),t.setFilter("cultivator-pos-circle",["==",["to-string",["get","cid"]],r]),t.setFilter("cultivator-pos-symbol",["==",["to-string",["get","cid"]],r])):(t.setFilter("cultivator-trace-line",["boolean",!0]),t.setFilter("cultivator-pos-circle",["boolean",!0]),t.setFilter("cultivator-pos-symbol",["boolean",!0]),t.flyTo({center:this.center,zoom:11}));for(let o of this.cids){let s=this.cids.indexOf(o);this.cultivator_sub_trace_geojson.features[s].geometry.coordinates=[]}t.getSource("cultivator-sub-trace").setData(this.cultivator_sub_trace_geojson)}),this.form.controls.days.valueChanges.subscribe(r=>{let o,s,u,i=(new Date).getTime();o=new Date(i-24*(r-1)*3600*1e3).toString().slice(4,15),s=new Date(o).toISOString(),u=(new Date).toISOString();let f=[];for(let E of this.cids){this.cids.indexOf(E);let R=(new Bl).set("Content-Type","application/json"),B=this.http.post(`${zl_api_url}/cultivators/${E}/trace`,{ts_begin:s,ts_end:u},{headers:R}).pipe(Cc());f.push(Kw(B))}Promise.all(f).then(E=>{E.forEach((R,B)=>{this.cultivator_trace_geojson.features[B].geometry.coordinates=R||[]}),t.getSource("cultivator-trace").setData(this.cultivator_trace_geojson)});let g=this.getLocalDateSequenceInIsoDateRange(s,u);this.dseq$.next(g);for(let E of this.cids){let T=this.cids.indexOf(E);this.cultivator_sub_trace_geojson.features[T].geometry.coordinates=[]}t.getSource("cultivator-sub-trace").setData(this.cultivator_sub_trace_geojson)}),this.form.controls.date.valueChanges.subscribe(r=>{let i=[];if("e2e"!=r){let o=new Date(r).toISOString(),s=new Date(new Date(r).getTime()+864e5-1e3).toISOString();if("all"==this.form.controls.cid.value){for(let u of this.cids){this.cids.indexOf(u);let g=(new Bl).set("Content-Type","application/json"),v=this.http.post(`${zl_api_url}/cultivators/${u}/trace`,{ts_begin:o,ts_end:s},{headers:g}).pipe(Cc());i.push(Kw(v))}Promise.all(i).then(u=>{u.forEach((g,v)=>{this.cultivator_sub_trace_geojson.features[v].geometry.coordinates=g||[]}),t.getSource("cultivator-sub-trace").setData(this.cultivator_sub_trace_geojson)})}else for(let u of this.cids){if(this.cids.indexOf(u),u==this.form.controls.cid.value){let g=(new Bl).set("Content-Type","application/json"),v=this.http.post(`${zl_api_url}/cultivators/${this.form.controls.cid.value}/trace`,{ts_begin:o,ts_end:s},{headers:g}).pipe(Cc());i.push(Kw(v))}else i.push(Promise.resolve([]));Promise.all(i).then(g=>{g.forEach((E,T)=>{this.cultivator_sub_trace_geojson.features[T].geometry.coordinates=E||[]}),t.getSource("cultivator-sub-trace").setData(this.cultivator_sub_trace_geojson)})}}else{let s,u,f,o=(new Date).getTime();s=new Date(o-24*(this.form.controls.days.value-1)*3600*1e3).toString().slice(4,15),u=new Date(s).toISOString(),f=(new Date).toISOString();for(let g of this.cids)if(this.cids.indexOf(g),g==this.form.controls.cid.value){let E=(new Bl).set("Content-Type","application/json"),T=this.http.post(`${zl_api_url}/cultivators/${g}/trace`,{ts_begin:u,ts_end:f},{headers:E}).pipe(Cc());i.push(Kw(T))}else i.push(Promise.resolve([]));Promise.all(i).then(g=>{g.forEach((E,T)=>{this.cultivator_sub_trace_geojson.features[T].geometry.coordinates=E||[]}),t.getSource("cultivator-sub-trace").setData(this.cultivator_sub_trace_geojson)})}}),this.form.controls.chart.valueChanges.subscribe(r=>{let i=this.form.controls.cid.value;switch(r){case"daily":this.chart_to_show=!0,this.chartDatasets=this.getCultivatorDistanceDatasets(i,30,"daily"),this.chartLabels=this.getTimeAxisLabels(30,"daily");break;case"hourly":this.chart_to_show=!0,this.chartDatasets=this.getCultivatorDistanceDatasets(i,72,"hourly"),this.chartLabels=this.getTimeAxisLabels(72,"hourly");break;default:this.chart_to_show=!1}})}ngOnDestroy(){}initCultivatorTraceGeojson(){let t={type:"FeatureCollection",features:[]};for(let r of this.cids){let o=JSON.parse(`\n\t\t\t\t{ \n\t\t\t\t\t"type": "Feature",\n\t\t\t\t\t"properties": {\n\t\t\t\t\t\t"cid": ${r}\n\t\t\t\t\t},\n\t\t\t\t\t"geometry": {\n\t\t\t\t\t\t"coordinates": [],\n\t\t\t\t\t\t"type": "LineString"\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t`);t.features.push(o)}return t}initCultivatorSubTraceGeojson(){let t={type:"FeatureCollection",features:[]};for(let r of this.cids){let o=JSON.parse(`\n\t\t\t\t{ \n\t\t\t\t\t"type": "Feature",\n\t\t\t\t\t"properties": {\n\t\t\t\t\t\t"cid": ${r}\n\t\t\t\t\t},\n\t\t\t\t\t"geometry": {\n\t\t\t\t\t\t"coordinates": [],\n\t\t\t\t\t\t"type": "LineString"\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t`);t.features.push(o)}return t}initCultivatorPosGeojson(){let t={type:"FeatureCollection",features:[]};for(let r of this.cids){let o=JSON.parse(`\n\t\t\t\t{ \n\t\t\t\t\t"type": "Feature",\n\t\t\t\t\t"properties": {\n\t\t\t\t\t\t"cid": ${r},\n\t\t\t\t\t\t"age_sec": 31536000\n\t\t\t\t\t},\n\t\t\t\t\t"geometry": {\n\t\t\t\t\t\t"coordinates": [],\n\t\t\t\t\t\t"type": "Point"\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t`);t.features.push(o)}return t}initLotBoundaryGeojson(){return{type:"FeatureCollection",features:[]}}addInitialDataToCultivatorTraceGeojson(){for(let t of this.cids){let r=this.cids.indexOf(t),i=(new Date).getTime(),o=new Date(new Date(i-24*(this.form.controls.days.value-1)*3600*1e3).toString().slice(4,15)).toISOString(),s=(new Date).toISOString(),u=(new Bl).set("Content-Type","application/json");this.http.post(`${zl_api_url}/cultivators/${t}/trace`,{ts_begin:o,ts_end:s},{headers:u}).pipe(Cc()).subscribe(f=>{f&&(this.cultivator_trace_geojson.features[r].geometry.coordinates=f)})}}addInitialDataToCultivatorPosGeojson(){for(let t of this.cids){let r=this.cids.indexOf(t);this.http.get(`${zl_api_url}/cultivators/${t}/pos`).pipe(Cc()).subscribe(i=>{if(i){let o=(new Date).getTime()-(new Date(i.ts).getTime()+6e4*(new Date).getTimezoneOffset());this.cultivator_pos_geojson.features[r].geometry.coordinates=[i.lon,i.lat],this.cultivator_pos_geojson.features[r].properties.age_sec=o/1e3}})}}getLocalDateSequenceInIsoDateRange(t,r){let i=[],o=new Date(t).getTime(),s=new Date(r).getTime();for(;o<=s;)i.push(new Date(o).toString().slice(4,15)),o+=864e5;return i.reverse()}getCultivatorDistanceDatasets(t,r,i){let o=[],s={data:[],label:"Daily Distance Covered"},u=(new Date).getTime();if("all"!=t)switch(i){case"daily":for(let f=r;f>0;f--){let g=new Date(new Date(u-24*(f-1)*3600*1e3).toString().slice(4,15)).toISOString(),v=new Date(new Date(g).getTime()+864e5-1e3).toISOString(),E=(new Bl).set("Content-Type","application/json");this.http.post(`${zl_api_url}/cultivators/${t}/total-distance`,{ts_begin:g,ts_end:v},{headers:E}).pipe(Cc()).subscribe(T=>{s.data.push(T)})}break;case"hourly":for(let f=r;f>0;f--){let g=new Date(new Date(u-3600*(r-1)*1e3).toString().slice(4,15)).toDateString(),v=new Date(new Date(g).getTime()+36e5-1e3).toISOString(),E=(new Bl).set("Content-Type","application/json");this.http.post(`${zl_api_url}/cultivators/${t}/hourly-distance`,{ts_begin:g,ts_end:v},{headers:E}).pipe(Cc()).subscribe(T=>{s.data.push(T.dist)})}}else switch(i){case"daily":for(let f=r;f>0;f--){let g=new Date(new Date(u-24*(f-1)*3600*1e3).toString().slice(4,15)).toISOString(),v=new Date(new Date(g).getTime()+864e5-1e3).toISOString(),E=(new Bl).set("Content-Type","application/json");this.http.post(`${zl_api_url}/cultivators/avg-total-distance`,{ts_begin:g,ts_end:v},{headers:E}).pipe(Cc()).subscribe(T=>{s.data.push(T)})}break;case"hourly":for(let f=r;f>0;f--){let g=new Date(new Date(u-3600*(r-1)*1e3).toString().slice(4,15)).toDateString(),v=new Date(new Date(g).getTime()+36e5-1e3).toISOString(),E=(new Bl).set("Content-Type","application/json");this.http.post(`${zl_api_url}/cultivators/avg-hourly-distance`,{ts_begin:g,ts_end:v},{headers:E}).pipe(Cc()).subscribe(T=>{s.data.push(T.dist)})}}return o.push(s),o}getTimeAxisLabels(t,r){return[]}}return n.\u0275fac=function(t){return new(t||n)(Mt(rB),Mt(c0),Mt(o4),Mt(t0))},n.\u0275cmp=ao({type:n,selectors:[["app-cultivator-tracker"]],viewQuery:function(t,r){if(1&t&&Cx(_U,5),2&t){let i;p_(i=g_())&&(r.chart=i.first)}},decls:53,vars:8,consts:[["id","map"],["map",""],["id","sidebar"],[3,"formGroup"],[4,"ngFor","ngForOf"],["type","radio","formControlName","cid","value","all"],[1,"blank"],["type","number","min","1","max","90","formControlName","days"],["formControlName","date"],["id","default-date-select-option","value","e2e","selected",""],[3,"value",4,"ngFor","ngForOf"],["type","radio","formControlName","chart","value","daily"],["type","radio","formControlName","chart","value","hourly"],["type","radio","formControlName","chart","value","hide"],["id","cultivator-chart","draggable","true",3,"chartDatasets","chartLabels","hidden"],["type","radio","formControlName","cid",3,"value"],[3,"value"]],template:function(t,r){1&t&&(Ar(0,"div",0,1),cn(2,"div",2),cn(3,"form",3),cn(4,"label"),Zn(5,"Select the cultivator to track:"),hn(),Ar(6,"br"),Ar(7,"br"),Qh(8,lce,6,2,"ng-container",4),Ar(9,"input",5),cn(10,"label"),Ar(11,"span",6),Zn(12,"All"),hn(),Ar(13,"br"),Ar(14,"br"),Ar(15,"br"),cn(16,"label"),Zn(17,"Specify tracking duration and, if desired, select a specific date:"),hn(),Ar(18,"br"),Ar(19,"br"),Ar(20,"input",7),cn(21,"label"),Ar(22,"span",6),Zn(23,"days"),hn(),Ar(24,"br"),Ar(25,"br"),cn(26,"select",8),cn(27,"option",9),Zn(28,"Entire Duration"),hn(),Qh(29,uce,2,2,"option",10),bx(30,"async"),hn(),Ar(31,"br"),Ar(32,"br"),cn(33,"label"),Zn(34,"Show chart?"),hn(),Ar(35,"br"),Ar(36,"br"),Ar(37,"input",11),cn(38,"label"),Ar(39,"span",6),Zn(40,"Daily Metric"),hn(),Ar(41,"br"),Ar(42,"input",12),cn(43,"label"),Ar(44,"span",6),Zn(45,"Hourly Metric"),hn(),Ar(46,"br"),Ar(47,"input",13),cn(48,"label"),Ar(49,"span",6),Zn(50,"Hide"),hn(),Ar(51,"br"),hn(),hn(),Ar(52,"app-cultivator-chart",14)),2&t&&($o(3),va("formGroup",r.form),$o(5),va("ngForOf",r.cids),$o(21),va("ngForOf",wx(30,6,r.dseq$)),$o(23),va("chartDatasets",r.chartDatasets)("chartLabels",r.chartLabels)("hidden",!r.chart_to_show))},directives:[nD,qT,l0,Mk,iD,R_,Bb,Hb,dD,hD,rD,qb,qF,XF,_U],pipes:[PM],styles:["#map[_ngcontent-%COMP%]{position:absolute;top:0;left:190px;width:100%;height:100%}#cultivator-chart[_ngcontent-%COMP%]{display:block;position:abolute;top:30%;left:30%;width:40%;height:40%;padding:16px;background-color:#d3d3d3;z-index:2}#sidebar[_ngcontent-%COMP%]{width:190px;height:100%;display:flex;align-items:center;background-color:#f2f2f2}#sidebar[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{width:100%;margin:12px;padding:12px;font-size:14px;border:2px solid #fff}#sidebar[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{margin-left:16px}#sidebar[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .blank[_ngcontent-%COMP%]{display:inline-block;width:8px}"]}),n})()},{path:"field-viewer",component:(()=>{class n{constructor(){}ngOnInit(){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=ao({type:n,selectors:[["app-field-viewer"]],decls:2,vars:0,template:function(t,r){1&t&&(cn(0,"p"),Zn(1,"field-viewer works!"),hn())},styles:[""]}),n})()},{path:"yield-analyzer",component:(()=>{class n{constructor(){}ngOnInit(){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=ao({type:n,selectors:[["app-yield-analyzer"]],decls:2,vars:0,template:function(t,r){1&t&&(cn(0,"p"),Zn(1,"yield-analyzer works!"),hn())},styles:[""]}),n})()},{path:"cost-analyzer",component:(()=>{class n{constructor(){}ngOnInit(){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=ao({type:n,selectors:[["app-cost-analyzer"]],decls:2,vars:0,template:function(t,r){1&t&&(cn(0,"p"),Zn(1,"cost-analyzer works!"),hn())},styles:[""]}),n})()},{path:"",component:s4}]},{path:"support-home",component:Dee,children:[]},{path:"",redirectTo:"/login",pathMatch:"full"},{path:"**",component:(()=>{class n{constructor(){}ngOnInit(){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=ao({type:n,selectors:[["app-page-not-found"]],decls:2,vars:0,template:function(t,r){1&t&&(cn(0,"p"),Zn(1,"page-not-found works!"),hn())},styles:[""]}),n})()}];let hce=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Gn({type:n}),n.\u0275inj=Gr({imports:[[jD.forRoot(cce)],jD]}),n})(),dce=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Gn({type:n}),n.\u0275inj=Gr({providers:[],imports:[[Zx,jD,oF,fD,gB]]}),n})(),fce=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Gn({type:n}),n.\u0275inj=Gr({imports:[[Zx]]}),n})(),pce=(()=>{class n{constructor(t){this.router=t,this.title="Angular"}ngOnInit(){this.router.navigate(["/login"])}}return n.\u0275fac=function(t){return new(t||n)(Mt(xu))},n.\u0275cmp=ao({type:n,selectors:[["app-root"]],decls:2,vars:0,template:function(t,r){1&t&&(cn(0,"div"),Ar(1,"router-outlet"),hn())},directives:[dw],styles:[""]}),n})(),_ce=(()=>{class n{intercept(t,r){return r.handle(t).pipe(function(n){var e;void 0===n&&(n=1/0);var t=(e=n&&"object"==typeof n?n:{count:n}).count,r=void 0===t?1/0:t,i=e.delay,o=e.resetOnSuccess,s=void 0!==o&&o;return r<=0?ve:Qt(function(u,f){var v,g=0,E=function(){var T=!1;v=u.subscribe(new jn(f,function(R){s&&(g=0),f.next(R)},void 0,function(R){if(g++<r){var B=function(){v?(v.unsubscribe(),v=null,E()):T=!0};if(null!=i){var z="number"==typeof i?nL(i):je(i(R,g)),G=new jn(f,function(){G.unsubscribe(),B()},function(){f.complete()});z.subscribe(G)}else B()}else f.error(R)})),T&&(v.unsubscribe(),v=null,E())};E()})}(1),Tf(i=>{let o="";return o=i.error instanceof ErrorEvent?`Error: ${i.error.message}`:`Error Code: ${i.status}\nMessage: ${i.message}`,window.alert(o),function(n,e){var t=Oe(n)?n:function(){return n},r=function(i){return i.error(t())};return new Ie(r)}(o)}))}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Dn({token:n,factory:n.\u0275fac}),n})();function yce(){return localStorage.getItem("Jwt")}let vce=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Gn({type:n,bootstrap:[pce]}),n.\u0275inj=Gr({providers:[{provide:Yb,useClass:_ce,multi:!0}],imports:[[GM,oF,fD,gB,cJ.forRoot({config:{tokenGetter:yce,allowedDomains:[zl_jwt_allowedDomains],disallowedRoutes:[zl_jwt_disallowedRoutes]}}),hce,dce,fce]]}),n})();(function(){if(OO)throw new Error("Cannot enable prod mode after platform setup.");RO=!1})(),KW().bootstrapModule(vce).catch(n=>console.error(n))}},Zt=>{Zt(Zt.s=2400)}]);